# Comparing `tmp/fastavro-1.8.1.tar.gz` & `tmp/fastavro-1.8.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "fastavro-1.8.1.tar", last modified: Mon Jul 17 22:03:36 2023, max compression
+gzip compressed data, was "fastavro-1.8.2.tar", last modified: Wed Jul 19 02:48:59 2023, max compression
```

## Comparing `fastavro-1.8.1.tar` & `fastavro-1.8.2.tar`

### file list

```diff
@@ -1,243 +1,244 @@
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.988569 fastavro-1.8.1/
--rwxr-xr-x   0 sbelden    (501) staff       (20)     1625 2019-05-08 02:19:05.000000 fastavro-1.8.1/.azure_upload.sh
--rw-r--r--   0 sbelden    (501) staff       (20)       55 2020-12-23 03:10:46.000000 fastavro-1.8.1/.flake8.cython
--rw-r--r--   0 sbelden    (501) staff       (20)    26402 2023-07-17 20:53:23.000000 fastavro-1.8.1/ChangeLog
--rw-r--r--   0 sbelden    (501) staff       (20)      333 2022-10-26 14:14:35.000000 fastavro-1.8.1/Dockerfile
--rw-r--r--   0 sbelden    (501) staff       (20)     1068 2019-05-04 22:05:46.000000 fastavro-1.8.1/LICENSE
--rw-r--r--   0 sbelden    (501) staff       (20)      559 2022-08-11 13:05:27.000000 fastavro-1.8.1/MANIFEST.in
--rw-r--r--   0 sbelden    (501) staff       (20)      812 2022-08-11 13:05:27.000000 fastavro-1.8.1/Makefile
--rw-r--r--   0 sbelden    (501) staff       (20)      563 2019-05-04 22:05:46.000000 fastavro-1.8.1/NOTICE.txt
--rw-r--r--   0 sbelden    (501) staff       (20)     5187 2023-07-17 22:03:36.988699 fastavro-1.8.1/PKG-INFO
--rw-r--r--   0 sbelden    (501) staff       (20)     3857 2023-07-17 20:43:04.000000 fastavro-1.8.1/README.md
--rw-r--r--   0 sbelden    (501) staff       (20)      522 2023-07-17 20:52:16.000000 fastavro-1.8.1/developer_requirements.txt
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.875839 fastavro-1.8.1/docs/
--rw-r--r--   0 sbelden    (501) staff       (20)     5578 2022-08-11 13:05:27.000000 fastavro-1.8.1/docs/Makefile
--rw-r--r--   0 sbelden    (501) staff       (20)     1456 2019-05-04 22:05:46.000000 fastavro-1.8.1/docs/command_line_script.rst
--rw-r--r--   0 sbelden    (501) staff       (20)     8320 2022-08-11 13:05:27.000000 fastavro-1.8.1/docs/conf.py
--rw-r--r--   0 sbelden    (501) staff       (20)     2502 2022-08-11 13:05:27.000000 fastavro-1.8.1/docs/index.rst
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.877214 fastavro-1.8.1/docs/io/
--rw-r--r--   0 sbelden    (501) staff       (20)       99 2022-08-11 13:05:27.000000 fastavro-1.8.1/docs/io/index.rst
--rw-r--r--   0 sbelden    (501) staff       (20)      107 2022-08-11 13:05:27.000000 fastavro-1.8.1/docs/io/json_decoder.rst
--rw-r--r--   0 sbelden    (501) staff       (20)      107 2022-08-11 13:05:27.000000 fastavro-1.8.1/docs/io/json_encoder.rst
--rw-r--r--   0 sbelden    (501) staff       (20)       88 2020-02-26 16:33:59.000000 fastavro-1.8.1/docs/json_reader.rst
--rw-r--r--   0 sbelden    (501) staff       (20)       91 2020-02-26 16:33:59.000000 fastavro-1.8.1/docs/json_writer.rst
--rw-r--r--   0 sbelden    (501) staff       (20)     4869 2022-08-11 13:05:27.000000 fastavro-1.8.1/docs/logical_types.rst
--rw-r--r--   0 sbelden    (501) staff       (20)      256 2021-03-20 12:25:05.000000 fastavro-1.8.1/docs/reader.rst
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.878061 fastavro-1.8.1/docs/repository/
--rw-r--r--   0 sbelden    (501) staff       (20)      116 2022-08-11 13:05:27.000000 fastavro-1.8.1/docs/repository/base.rst
--rw-r--r--   0 sbelden    (501) staff       (20)       99 2022-08-11 13:05:27.000000 fastavro-1.8.1/docs/repository/index.rst
--rw-r--r--   0 sbelden    (501) staff       (20)      405 2021-02-06 15:15:34.000000 fastavro-1.8.1/docs/schema.rst
--rw-r--r--   0 sbelden    (501) staff       (20)      174 2021-03-13 13:43:47.000000 fastavro-1.8.1/docs/utils.rst
--rw-r--r--   0 sbelden    (501) staff       (20)      149 2019-05-04 22:05:46.000000 fastavro-1.8.1/docs/validation.rst
--rw-r--r--   0 sbelden    (501) staff       (20)     3996 2022-08-11 13:05:27.000000 fastavro-1.8.1/docs/writer.rst
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.919473 fastavro-1.8.1/fastavro/
--rw-r--r--   0 sbelden    (501) staff       (20)     1750 2023-07-17 20:53:27.000000 fastavro-1.8.1/fastavro/__init__.py
--rw-r--r--   0 sbelden    (501) staff       (20)     2423 2020-12-23 03:10:46.000000 fastavro-1.8.1/fastavro/__main__.py
--rw-r--r--   0 sbelden    (501) staff       (20)   262468 2023-07-17 22:03:32.000000 fastavro-1.8.1/fastavro/_logical_readers.c
--rw-r--r--   0 sbelden    (501) staff       (20)      131 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/_logical_readers.pyi
--rw-r--r--   0 sbelden    (501) staff       (20)     2792 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/_logical_readers.pyx
--rw-r--r--   0 sbelden    (501) staff       (20)     2813 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/_logical_readers_py.py
--rw-r--r--   0 sbelden    (501) staff       (20)      131 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/_logical_readers_py.pyi
--rw-r--r--   0 sbelden    (501) staff       (20)   432466 2023-07-17 22:03:33.000000 fastavro-1.8.1/fastavro/_logical_writers.c
--rw-r--r--   0 sbelden    (501) staff       (20)       95 2020-06-22 15:51:13.000000 fastavro-1.8.1/fastavro/_logical_writers.pyi
--rw-r--r--   0 sbelden    (501) staff       (20)     8427 2022-10-06 12:45:33.000000 fastavro-1.8.1/fastavro/_logical_writers.pyx
--rw-r--r--   0 sbelden    (501) staff       (20)     7830 2022-10-06 12:45:33.000000 fastavro-1.8.1/fastavro/_logical_writers_py.py
--rw-r--r--   0 sbelden    (501) staff       (20)       95 2020-06-22 15:51:13.000000 fastavro-1.8.1/fastavro/_logical_writers_py.pyi
--rw-r--r--   0 sbelden    (501) staff       (20)  1105002 2023-07-17 22:03:33.000000 fastavro-1.8.1/fastavro/_read.c
--rw-r--r--   0 sbelden    (501) staff       (20)     2070 2023-07-06 14:53:47.000000 fastavro-1.8.1/fastavro/_read.pyi
--rw-r--r--   0 sbelden    (501) staff       (20)    34172 2023-07-06 14:53:47.000000 fastavro-1.8.1/fastavro/_read.pyx
--rw-r--r--   0 sbelden    (501) staff       (20)      703 2023-04-17 20:07:08.000000 fastavro-1.8.1/fastavro/_read_common.py
--rw-r--r--   0 sbelden    (501) staff       (20)    34680 2023-07-17 20:42:23.000000 fastavro-1.8.1/fastavro/_read_py.py
--rw-r--r--   0 sbelden    (501) staff       (20)   704771 2023-07-17 22:03:33.000000 fastavro-1.8.1/fastavro/_schema.c
--rw-r--r--   0 sbelden    (501) staff       (20)      950 2023-02-22 18:29:22.000000 fastavro-1.8.1/fastavro/_schema.pyi
--rw-r--r--   0 sbelden    (501) staff       (20)    24103 2023-05-04 14:35:44.000000 fastavro-1.8.1/fastavro/_schema.pyx
--rw-r--r--   0 sbelden    (501) staff       (20)     1421 2021-01-23 16:11:54.000000 fastavro-1.8.1/fastavro/_schema_common.py
--rw-r--r--   0 sbelden    (501) staff       (20)    33011 2023-05-04 14:35:44.000000 fastavro-1.8.1/fastavro/_schema_py.py
--rw-r--r--   0 sbelden    (501) staff       (20)   441134 2020-08-18 18:15:09.000000 fastavro-1.8.1/fastavro/_six.c
--rw-r--r--   0 sbelden    (501) staff       (20)      633 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/_validate_common.py
--rw-r--r--   0 sbelden    (501) staff       (20)   391404 2023-07-17 22:03:34.000000 fastavro-1.8.1/fastavro/_validation.c
--rw-r--r--   0 sbelden    (501) staff       (20)      338 2022-08-12 17:49:36.000000 fastavro-1.8.1/fastavro/_validation.pyi
--rw-r--r--   0 sbelden    (501) staff       (20)     9403 2022-08-15 15:33:27.000000 fastavro-1.8.1/fastavro/_validation.pyx
--rw-r--r--   0 sbelden    (501) staff       (20)    10757 2022-08-15 15:33:27.000000 fastavro-1.8.1/fastavro/_validation_py.py
--rw-r--r--   0 sbelden    (501) staff       (20)  1720429 2023-07-17 22:03:36.000000 fastavro-1.8.1/fastavro/_write.c
--rw-r--r--   0 sbelden    (501) staff       (20)     1680 2022-08-15 15:33:27.000000 fastavro-1.8.1/fastavro/_write.pyi
--rw-r--r--   0 sbelden    (501) staff       (20)    26702 2023-04-17 20:07:08.000000 fastavro-1.8.1/fastavro/_write.pyx
--rw-r--r--   0 sbelden    (501) staff       (20)      619 2023-05-03 19:57:13.000000 fastavro-1.8.1/fastavro/_write_common.py
--rw-r--r--   0 sbelden    (501) staff       (20)    26758 2023-04-17 20:07:08.000000 fastavro-1.8.1/fastavro/_write_py.py
--rw-r--r--   0 sbelden    (501) staff       (20)      853 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/const.py
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.927098 fastavro-1.8.1/fastavro/io/
--rw-r--r--   0 sbelden    (501) staff       (20)        0 2020-02-26 16:33:59.000000 fastavro-1.8.1/fastavro/io/__init__.py
--rw-r--r--   0 sbelden    (501) staff       (20)     4379 2023-07-06 14:53:47.000000 fastavro-1.8.1/fastavro/io/binary_decoder.py
--rw-r--r--   0 sbelden    (501) staff       (20)     1861 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/io/binary_encoder.py
--rw-r--r--   0 sbelden    (501) staff       (20)     6936 2023-07-06 14:53:47.000000 fastavro-1.8.1/fastavro/io/json_decoder.py
--rw-r--r--   0 sbelden    (501) staff       (20)     5674 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/io/json_encoder.py
--rw-r--r--   0 sbelden    (501) staff       (20)     4980 2022-02-25 13:49:52.000000 fastavro-1.8.1/fastavro/io/parser.py
--rw-r--r--   0 sbelden    (501) staff       (20)     2321 2021-01-22 04:19:07.000000 fastavro-1.8.1/fastavro/io/symbols.py
--rw-r--r--   0 sbelden    (501) staff       (20)     1603 2023-03-16 19:48:58.000000 fastavro-1.8.1/fastavro/json_read.py
--rw-r--r--   0 sbelden    (501) staff       (20)     2908 2022-08-15 15:33:27.000000 fastavro-1.8.1/fastavro/json_write.py
--rw-r--r--   0 sbelden    (501) staff       (20)      217 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/logical_readers.py
--rw-r--r--   0 sbelden    (501) staff       (20)      217 2020-12-23 03:10:46.000000 fastavro-1.8.1/fastavro/logical_writers.py
--rw-r--r--   0 sbelden    (501) staff       (20)        0 2020-06-22 15:51:13.000000 fastavro-1.8.1/fastavro/py.typed
--rw-r--r--   0 sbelden    (501) staff       (20)      775 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/read.py
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.928648 fastavro-1.8.1/fastavro/repository/
--rw-r--r--   0 sbelden    (501) staff       (20)      210 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/repository/__init__.py
--rw-r--r--   0 sbelden    (501) staff       (20)      185 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/repository/base.py
--rw-r--r--   0 sbelden    (501) staff       (20)      764 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/repository/flat_dict.py
--rw-r--r--   0 sbelden    (501) staff       (20)     1030 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/schema.py
--rw-r--r--   0 sbelden    (501) staff       (20)      419 2022-08-11 13:05:27.000000 fastavro-1.8.1/fastavro/types.py
--rw-r--r--   0 sbelden    (501) staff       (20)     7456 2023-02-01 14:56:04.000000 fastavro-1.8.1/fastavro/utils.py
--rw-r--r--   0 sbelden    (501) staff       (20)      422 2020-12-23 03:10:46.000000 fastavro-1.8.1/fastavro/validation.py
--rw-r--r--   0 sbelden    (501) staff       (20)      457 2021-02-27 20:10:59.000000 fastavro-1.8.1/fastavro/write.py
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.922819 fastavro-1.8.1/fastavro.egg-info/
--rw-r--r--   0 sbelden    (501) staff       (20)     5187 2023-07-17 22:03:36.000000 fastavro-1.8.1/fastavro.egg-info/PKG-INFO
--rw-r--r--   0 sbelden    (501) staff       (20)     6017 2023-07-17 22:03:36.000000 fastavro-1.8.1/fastavro.egg-info/SOURCES.txt
--rw-r--r--   0 sbelden    (501) staff       (20)        1 2023-07-17 22:03:36.000000 fastavro-1.8.1/fastavro.egg-info/dependency_links.txt
--rw-r--r--   0 sbelden    (501) staff       (20)       52 2023-07-17 22:03:36.000000 fastavro-1.8.1/fastavro.egg-info/entry_points.txt
--rw-r--r--   0 sbelden    (501) staff       (20)        1 2023-07-07 19:14:17.000000 fastavro-1.8.1/fastavro.egg-info/not-zip-safe
--rw-r--r--   0 sbelden    (501) staff       (20)       96 2023-07-17 22:03:36.000000 fastavro-1.8.1/fastavro.egg-info/requires.txt
--rw-r--r--   0 sbelden    (501) staff       (20)        9 2023-07-17 22:03:36.000000 fastavro-1.8.1/fastavro.egg-info/top_level.txt
--rw-r--r--   0 sbelden    (501) staff       (20)       99 2023-04-17 20:07:08.000000 fastavro-1.8.1/mypy.ini
--rwxr-xr-x   0 sbelden    (501) staff       (20)     1210 2023-07-17 20:43:04.000000 fastavro-1.8.1/publish.sh
--rw-r--r--   0 sbelden    (501) staff       (20)      206 2023-07-17 20:43:20.000000 fastavro-1.8.1/pyproject.toml
--rwxr-xr-x   0 sbelden    (501) staff       (20)       31 2019-05-04 22:05:46.000000 fastavro-1.8.1/pytest.ini
--rw-r--r--   0 sbelden    (501) staff       (20)      710 2023-07-17 20:43:04.000000 fastavro-1.8.1/run-tests.cmd
--rwxr-xr-x   0 sbelden    (501) staff       (20)     1050 2023-07-17 20:43:04.000000 fastavro-1.8.1/run-tests.sh
--rw-r--r--   0 sbelden    (501) staff       (20)      105 2023-07-17 22:03:36.989088 fastavro-1.8.1/setup.cfg
--rw-r--r--   0 sbelden    (501) staff       (20)     2747 2023-07-17 20:43:04.000000 fastavro-1.8.1/setup.py
--rwxr-xr-x   0 sbelden    (501) staff       (20)      169 2023-03-08 22:33:06.000000 fastavro-1.8.1/tag.sh
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.944288 fastavro-1.8.1/tests/
--rw-r--r--   0 sbelden    (501) staff       (20)        0 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/__init__.py
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.966331 fastavro-1.8.1/tests/avro-files/
--rw-r--r--   0 sbelden    (501) staff       (20)       55 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/Child.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)       56 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/Child1.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      179 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/Parent.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      130 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/ParentMissingChild.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      447 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/a_triple_pair.avro
--rw-r--r--   0 sbelden    (501) staff       (20)       79 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/bool.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/class org.apache.avro.tool.TestDataFileTools.seperators.avro
--rw-r--r--   0 sbelden    (501) staff       (20)       89 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/class org.apache.avro.tool.TestDataFileTools.testWrite.deflate.avro
--rw-r--r--   0 sbelden    (501) staff       (20)       84 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/class org.apache.avro.tool.TestDataFileTools.testWrite.plain.avro
--rw-r--r--   0 sbelden    (501) staff       (20)       56 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/class org.apache.avro.tool.TestDataFileTools.zerojsonvalues.avro
--rw-r--r--   0 sbelden    (501) staff       (20)     3293 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/deflate.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      276 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/double_float.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      234 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/error-type.avro
--rw-r--r--   0 sbelden    (501) staff       (20)     8453 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/java-generated-uuid.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      299 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/lines.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      403 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/m.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      139 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/no-fields.avro
--rw-r--r--   0 sbelden    (501) staff       (20)     3285 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/null.avro
--rw-r--r--   0 sbelden    (501) staff       (20)       68 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/org.apache.avro.tool.TestDataFileTools.avro
--rwxr-xr-x   0 sbelden    (501) staff       (20)      321 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/part-00000.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      218 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/recursive.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      162 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/request.avro
--rw-r--r--   0 sbelden    (501) staff       (20)       89 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/response.avro
--rw-r--r--   0 sbelden    (501) staff       (20)     3296 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/snappy.avro
--rw-r--r--   0 sbelden    (501) staff       (20)    12556 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/test-deflate-0.avro
--rw-r--r--   0 sbelden    (501) staff       (20)    11906 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/test-deflate-1-A.avro
--rw-r--r--   0 sbelden    (501) staff       (20)    12546 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/test-deflate-1.avro
--rw-r--r--   0 sbelden    (501) staff       (20)    11906 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/test-deflate-3-A.avro
--rw-r--r--   0 sbelden    (501) staff       (20)     6112 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/test-deflate-6-B.avro
--rw-r--r--   0 sbelden    (501) staff       (20)    12546 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/test-deflate-9.avro
--rw-r--r--   0 sbelden    (501) staff       (20)     6522 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/test-null-B.avro
--rw-r--r--   0 sbelden    (501) staff       (20)    13289 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/test-null.avro
--rw-r--r--   0 sbelden    (501) staff       (20)    13677 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/test-snappy.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      182 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/test.avro
--rw-r--r--   0 sbelden    (501) staff       (20)       51 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/testDataFileMeta.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      690 2022-08-11 13:05:27.000000 fastavro-1.8.1/tests/avro-files/weather-legacy-generated.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      696 2022-08-11 13:05:27.000000 fastavro-1.8.1/tests/avro-files/weather-legacy-with-names.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      330 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/weather-snappy.avro
--rwxr-xr-x   0 sbelden    (501) staff       (20)      335 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/weather-sorted.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      358 2019-05-04 22:05:46.000000 fastavro-1.8.1/tests/avro-files/weather.avro
--rw-r--r--   0 sbelden    (501) staff       (20)      999 2021-03-13 13:43:47.000000 fastavro-1.8.1/tests/conftest.py
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.968479 fastavro-1.8.1/tests/load_schema_test/
--rw-r--r--   0 sbelden    (501) staff       (20)      189 2020-07-11 18:46:51.000000 fastavro-1.8.1/tests/load_schema_test/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      126 2020-07-11 18:46:51.000000 fastavro-1.8.1/tests/load_schema_test/B.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-07-11 18:46:51.000000 fastavro-1.8.1/tests/load_schema_test/C.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-07-11 18:46:51.000000 fastavro-1.8.1/tests/load_schema_test/D.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.970825 fastavro-1.8.1/tests/load_schema_test_10/
--rw-r--r--   0 sbelden    (501) staff       (20)      189 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_10/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_10/B.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      189 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_10/C.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_10/D.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.973046 fastavro-1.8.1/tests/load_schema_test_11/
--rw-r--r--   0 sbelden    (501) staff       (20)      135 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_11/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)       99 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_11/B.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      135 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_11/C.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_11/D.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_11/E.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.973464 fastavro-1.8.1/tests/load_schema_test_12/
--rw-r--r--   0 sbelden    (501) staff       (20)      143 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_12/A.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.974363 fastavro-1.8.1/tests/load_schema_test_12/com/
--rw-r--r--   0 sbelden    (501) staff       (20)      137 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_12/com/B.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      187 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_12/com/C.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.975321 fastavro-1.8.1/tests/load_schema_test_12/com/namespace/
--rw-r--r--   0 sbelden    (501) staff       (20)      140 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_12/com/namespace/D.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      140 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_12/com/namespace/E.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.976300 fastavro-1.8.1/tests/load_schema_test_13/
--rw-r--r--   0 sbelden    (501) staff       (20)        3 2021-04-16 21:12:43.000000 fastavro-1.8.1/tests/load_schema_test_13/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-04-16 21:12:43.000000 fastavro-1.8.1/tests/load_schema_test_13/B.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.976848 fastavro-1.8.1/tests/load_schema_test_14/
--rw-r--r--   0 sbelden    (501) staff       (20)        8 2021-04-16 21:12:43.000000 fastavro-1.8.1/tests/load_schema_test_14/A.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.978035 fastavro-1.8.1/tests/load_schema_test_15/
--rw-r--r--   0 sbelden    (501) staff       (20)       10 2021-04-16 21:12:43.000000 fastavro-1.8.1/tests/load_schema_test_15/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-04-16 21:12:43.000000 fastavro-1.8.1/tests/load_schema_test_15/B.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-04-16 21:12:43.000000 fastavro-1.8.1/tests/load_schema_test_15/C.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.978927 fastavro-1.8.1/tests/load_schema_test_16/
--rw-r--r--   0 sbelden    (501) staff       (20)      225 2022-08-11 13:05:27.000000 fastavro-1.8.1/tests/load_schema_test_16/namespace.match.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      120 2022-08-11 13:05:27.000000 fastavro-1.8.1/tests/load_schema_test_16/namespace.team.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.980182 fastavro-1.8.1/tests/load_schema_test_2/
--rw-r--r--   0 sbelden    (501) staff       (20)      294 2020-07-11 18:46:51.000000 fastavro-1.8.1/tests/load_schema_test_2/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      126 2020-07-11 18:46:51.000000 fastavro-1.8.1/tests/load_schema_test_2/B.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-07-11 18:46:51.000000 fastavro-1.8.1/tests/load_schema_test_2/C.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.981644 fastavro-1.8.1/tests/load_schema_test_3/
--rw-r--r--   0 sbelden    (501) staff       (20)      189 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/load_schema_test_3/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      126 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/load_schema_test_3/B.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/load_schema_test_3/C.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.982732 fastavro-1.8.1/tests/load_schema_test_4/
--rw-r--r--   0 sbelden    (501) staff       (20)      189 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/load_schema_test_4/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/load_schema_test_4/B.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      126 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/load_schema_test_4/C.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.983473 fastavro-1.8.1/tests/load_schema_test_5/
--rw-r--r--   0 sbelden    (501) staff       (20)      170 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/load_schema_test_5/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/load_schema_test_5/B.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.984195 fastavro-1.8.1/tests/load_schema_test_6/
--rw-r--r--   0 sbelden    (501) staff       (20)      173 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/load_schema_test_6/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/load_schema_test_6/B.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.984957 fastavro-1.8.1/tests/load_schema_test_7/
--rw-r--r--   0 sbelden    (501) staff       (20)      129 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_7/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      116 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_7/namespace.B.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.986060 fastavro-1.8.1/tests/load_schema_test_8/
--rw-r--r--   0 sbelden    (501) staff       (20)      165 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_8/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      102 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_8/namespace.B.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      110 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_8/namespace.C.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.987117 fastavro-1.8.1/tests/load_schema_test_9/
--rw-r--r--   0 sbelden    (501) staff       (20)      165 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_9/A.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)       65 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_9/namespace.B.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)       65 2021-01-22 04:19:07.000000 fastavro-1.8.1/tests/load_schema_test_9/namespace.C.avsc
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.987449 fastavro-1.8.1/tests/repository/
-drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-17 22:03:36.988225 fastavro-1.8.1/tests/repository/flat_dict_test/
--rw-r--r--   0 sbelden    (501) staff       (20)       11 2022-08-11 13:05:27.000000 fastavro-1.8.1/tests/repository/flat_dict_test/InvalidJson.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)      111 2022-08-11 13:05:27.000000 fastavro-1.8.1/tests/repository/flat_dict_test/Valid.avsc
--rw-r--r--   0 sbelden    (501) staff       (20)     1153 2022-08-11 13:05:27.000000 fastavro-1.8.1/tests/repository/test_flat_dict.py
--rw-r--r--   0 sbelden    (501) staff       (20)     3678 2021-03-13 13:43:47.000000 fastavro-1.8.1/tests/test_aliases.py
--rw-r--r--   0 sbelden    (501) staff       (20)     2185 2022-08-11 13:05:27.000000 fastavro-1.8.1/tests/test_appendable.py
--rw-r--r--   0 sbelden    (501) staff       (20)     2533 2023-02-01 14:55:54.000000 fastavro-1.8.1/tests/test_block_reader.py
--rw-r--r--   0 sbelden    (501) staff       (20)    14428 2021-01-22 17:21:26.000000 fastavro-1.8.1/tests/test_canonical_form.py
--rw-r--r--   0 sbelden    (501) staff       (20)     4768 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/test_complex.py
--rw-r--r--   0 sbelden    (501) staff       (20)     5623 2022-08-11 13:05:27.000000 fastavro-1.8.1/tests/test_compression.py
--rw-r--r--   0 sbelden    (501) staff       (20)    98878 2023-07-17 20:43:04.000000 fastavro-1.8.1/tests/test_fastavro.py
--rw-r--r--   0 sbelden    (501) staff       (20)    33787 2021-01-23 16:11:54.000000 fastavro-1.8.1/tests/test_fingerprint.py
--rw-r--r--   0 sbelden    (501) staff       (20)    27597 2023-07-06 14:53:47.000000 fastavro-1.8.1/tests/test_json.py
--rw-r--r--   0 sbelden    (501) staff       (20)    16587 2022-10-26 14:14:35.000000 fastavro-1.8.1/tests/test_logical_types.py
--rw-r--r--   0 sbelden    (501) staff       (20)     3483 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/test_main_cli.py
--rw-r--r--   0 sbelden    (501) staff       (20)     2229 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/test_promotion.py
--rw-r--r--   0 sbelden    (501) staff       (20)    40285 2023-05-04 14:35:44.000000 fastavro-1.8.1/tests/test_schema.py
--rw-r--r--   0 sbelden    (501) staff       (20)    22495 2023-02-01 14:56:44.000000 fastavro-1.8.1/tests/test_schema_evolution.py
--rw-r--r--   0 sbelden    (501) staff       (20)     8733 2023-07-06 14:53:47.000000 fastavro-1.8.1/tests/test_schemaless.py
--rw-r--r--   0 sbelden    (501) staff       (20)     1224 2021-03-13 13:43:47.000000 fastavro-1.8.1/tests/test_str_py3.py
--rw-r--r--   0 sbelden    (501) staff       (20)     7148 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/test_timezone.py
--rw-r--r--   0 sbelden    (501) staff       (20)     2653 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/test_types.py
--rw-r--r--   0 sbelden    (501) staff       (20)     4503 2022-05-21 05:36:47.000000 fastavro-1.8.1/tests/test_utils.py
--rw-r--r--   0 sbelden    (501) staff       (20)    15273 2022-08-12 17:49:36.000000 fastavro-1.8.1/tests/test_validation.py
--rw-r--r--   0 sbelden    (501) staff       (20)     1653 2020-12-23 03:10:46.000000 fastavro-1.8.1/tests/test_write_block.py
--rw-r--r--   0 sbelden    (501) staff       (20)      248 2023-07-17 20:43:04.000000 fastavro-1.8.1/tox.ini
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:59.010411 fastavro-1.8.2/
+-rwxr-xr-x   0 sbelden    (501) staff       (20)     1625 2019-05-08 02:19:05.000000 fastavro-1.8.2/.azure_upload.sh
+-rw-r--r--   0 sbelden    (501) staff       (20)       55 2020-12-23 03:10:46.000000 fastavro-1.8.2/.flake8.cython
+-rw-r--r--   0 sbelden    (501) staff       (20)    26495 2023-07-18 21:31:56.000000 fastavro-1.8.2/ChangeLog
+-rw-r--r--   0 sbelden    (501) staff       (20)      333 2022-10-26 14:14:35.000000 fastavro-1.8.2/Dockerfile
+-rw-r--r--   0 sbelden    (501) staff       (20)     1068 2019-05-04 22:05:46.000000 fastavro-1.8.2/LICENSE
+-rw-r--r--   0 sbelden    (501) staff       (20)      559 2022-08-11 13:05:27.000000 fastavro-1.8.2/MANIFEST.in
+-rw-r--r--   0 sbelden    (501) staff       (20)      812 2022-08-11 13:05:27.000000 fastavro-1.8.2/Makefile
+-rw-r--r--   0 sbelden    (501) staff       (20)      563 2019-05-04 22:05:46.000000 fastavro-1.8.2/NOTICE.txt
+-rw-r--r--   0 sbelden    (501) staff       (20)     5187 2023-07-19 02:48:59.010611 fastavro-1.8.2/PKG-INFO
+-rw-r--r--   0 sbelden    (501) staff       (20)     3857 2023-07-17 20:43:04.000000 fastavro-1.8.2/README.md
+-rw-r--r--   0 sbelden    (501) staff       (20)      522 2023-07-17 20:52:16.000000 fastavro-1.8.2/developer_requirements.txt
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.855832 fastavro-1.8.2/docs/
+-rw-r--r--   0 sbelden    (501) staff       (20)     5578 2022-08-11 13:05:27.000000 fastavro-1.8.2/docs/Makefile
+-rw-r--r--   0 sbelden    (501) staff       (20)     1456 2019-05-04 22:05:46.000000 fastavro-1.8.2/docs/command_line_script.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)     8320 2022-08-11 13:05:27.000000 fastavro-1.8.2/docs/conf.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     2502 2022-08-11 13:05:27.000000 fastavro-1.8.2/docs/index.rst
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.857910 fastavro-1.8.2/docs/io/
+-rw-r--r--   0 sbelden    (501) staff       (20)       99 2022-08-11 13:05:27.000000 fastavro-1.8.2/docs/io/index.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)      107 2022-08-11 13:05:27.000000 fastavro-1.8.2/docs/io/json_decoder.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)      107 2022-08-11 13:05:27.000000 fastavro-1.8.2/docs/io/json_encoder.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)       88 2020-02-26 16:33:59.000000 fastavro-1.8.2/docs/json_reader.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)       91 2020-02-26 16:33:59.000000 fastavro-1.8.2/docs/json_writer.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)     4869 2022-08-11 13:05:27.000000 fastavro-1.8.2/docs/logical_types.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)      256 2021-03-20 12:25:05.000000 fastavro-1.8.2/docs/reader.rst
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.859438 fastavro-1.8.2/docs/repository/
+-rw-r--r--   0 sbelden    (501) staff       (20)      116 2022-08-11 13:05:27.000000 fastavro-1.8.2/docs/repository/base.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)       99 2022-08-11 13:05:27.000000 fastavro-1.8.2/docs/repository/index.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)      405 2021-02-06 15:15:34.000000 fastavro-1.8.2/docs/schema.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)      174 2021-03-13 13:43:47.000000 fastavro-1.8.2/docs/utils.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)      149 2019-05-04 22:05:46.000000 fastavro-1.8.2/docs/validation.rst
+-rw-r--r--   0 sbelden    (501) staff       (20)     3996 2022-08-11 13:05:27.000000 fastavro-1.8.2/docs/writer.rst
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.914379 fastavro-1.8.2/fastavro/
+-rw-r--r--   0 sbelden    (501) staff       (20)     1750 2023-07-18 21:30:08.000000 fastavro-1.8.2/fastavro/__init__.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     2423 2020-12-23 03:10:46.000000 fastavro-1.8.2/fastavro/__main__.py
+-rw-r--r--   0 sbelden    (501) staff       (20)   262468 2023-07-19 02:48:55.000000 fastavro-1.8.2/fastavro/_logical_readers.c
+-rw-r--r--   0 sbelden    (501) staff       (20)      131 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/_logical_readers.pyi
+-rw-r--r--   0 sbelden    (501) staff       (20)     2792 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/_logical_readers.pyx
+-rw-r--r--   0 sbelden    (501) staff       (20)     2813 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/_logical_readers_py.py
+-rw-r--r--   0 sbelden    (501) staff       (20)      131 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/_logical_readers_py.pyi
+-rw-r--r--   0 sbelden    (501) staff       (20)   432466 2023-07-19 02:48:55.000000 fastavro-1.8.2/fastavro/_logical_writers.c
+-rw-r--r--   0 sbelden    (501) staff       (20)       95 2020-06-22 15:51:13.000000 fastavro-1.8.2/fastavro/_logical_writers.pyi
+-rw-r--r--   0 sbelden    (501) staff       (20)     8427 2022-10-06 12:45:33.000000 fastavro-1.8.2/fastavro/_logical_writers.pyx
+-rw-r--r--   0 sbelden    (501) staff       (20)     7830 2022-10-06 12:45:33.000000 fastavro-1.8.2/fastavro/_logical_writers_py.py
+-rw-r--r--   0 sbelden    (501) staff       (20)       95 2020-06-22 15:51:13.000000 fastavro-1.8.2/fastavro/_logical_writers_py.pyi
+-rw-r--r--   0 sbelden    (501) staff       (20)  1115074 2023-07-19 02:48:55.000000 fastavro-1.8.2/fastavro/_read.c
+-rw-r--r--   0 sbelden    (501) staff       (20)     2070 2023-07-06 14:53:47.000000 fastavro-1.8.2/fastavro/_read.pyi
+-rw-r--r--   0 sbelden    (501) staff       (20)    34708 2023-07-18 21:19:40.000000 fastavro-1.8.2/fastavro/_read.pyx
+-rw-r--r--   0 sbelden    (501) staff       (20)      703 2023-04-17 20:07:08.000000 fastavro-1.8.2/fastavro/_read_common.py
+-rw-r--r--   0 sbelden    (501) staff       (20)    35245 2023-07-18 21:19:40.000000 fastavro-1.8.2/fastavro/_read_py.py
+-rw-r--r--   0 sbelden    (501) staff       (20)   704771 2023-07-19 02:48:56.000000 fastavro-1.8.2/fastavro/_schema.c
+-rw-r--r--   0 sbelden    (501) staff       (20)      950 2023-02-22 18:29:22.000000 fastavro-1.8.2/fastavro/_schema.pyi
+-rw-r--r--   0 sbelden    (501) staff       (20)    24103 2023-05-04 14:35:44.000000 fastavro-1.8.2/fastavro/_schema.pyx
+-rw-r--r--   0 sbelden    (501) staff       (20)     1421 2021-01-23 16:11:54.000000 fastavro-1.8.2/fastavro/_schema_common.py
+-rw-r--r--   0 sbelden    (501) staff       (20)    33011 2023-05-04 14:35:44.000000 fastavro-1.8.2/fastavro/_schema_py.py
+-rw-r--r--   0 sbelden    (501) staff       (20)   441134 2020-08-18 18:15:09.000000 fastavro-1.8.2/fastavro/_six.c
+-rw-r--r--   0 sbelden    (501) staff       (20)      633 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/_validate_common.py
+-rw-r--r--   0 sbelden    (501) staff       (20)   391404 2023-07-19 02:48:56.000000 fastavro-1.8.2/fastavro/_validation.c
+-rw-r--r--   0 sbelden    (501) staff       (20)      338 2022-08-12 17:49:36.000000 fastavro-1.8.2/fastavro/_validation.pyi
+-rw-r--r--   0 sbelden    (501) staff       (20)     9403 2022-08-15 15:33:27.000000 fastavro-1.8.2/fastavro/_validation.pyx
+-rw-r--r--   0 sbelden    (501) staff       (20)    10757 2022-08-15 15:33:27.000000 fastavro-1.8.2/fastavro/_validation_py.py
+-rw-r--r--   0 sbelden    (501) staff       (20)  1720429 2023-07-19 02:48:58.000000 fastavro-1.8.2/fastavro/_write.c
+-rw-r--r--   0 sbelden    (501) staff       (20)     1680 2022-08-15 15:33:27.000000 fastavro-1.8.2/fastavro/_write.pyi
+-rw-r--r--   0 sbelden    (501) staff       (20)    26702 2023-04-17 20:07:08.000000 fastavro-1.8.2/fastavro/_write.pyx
+-rw-r--r--   0 sbelden    (501) staff       (20)      619 2023-05-03 19:57:13.000000 fastavro-1.8.2/fastavro/_write_common.py
+-rw-r--r--   0 sbelden    (501) staff       (20)    26758 2023-04-17 20:07:08.000000 fastavro-1.8.2/fastavro/_write_py.py
+-rw-r--r--   0 sbelden    (501) staff       (20)      853 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/const.py
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.925695 fastavro-1.8.2/fastavro/io/
+-rw-r--r--   0 sbelden    (501) staff       (20)        0 2020-02-26 16:33:59.000000 fastavro-1.8.2/fastavro/io/__init__.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     4379 2023-07-06 14:53:47.000000 fastavro-1.8.2/fastavro/io/binary_decoder.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     1861 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/io/binary_encoder.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     6936 2023-07-06 14:53:47.000000 fastavro-1.8.2/fastavro/io/json_decoder.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     5674 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/io/json_encoder.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     4980 2022-02-25 13:49:52.000000 fastavro-1.8.2/fastavro/io/parser.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     2321 2021-01-22 04:19:07.000000 fastavro-1.8.2/fastavro/io/symbols.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     1603 2023-03-16 19:48:58.000000 fastavro-1.8.2/fastavro/json_read.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     2908 2022-08-15 15:33:27.000000 fastavro-1.8.2/fastavro/json_write.py
+-rw-r--r--   0 sbelden    (501) staff       (20)      217 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/logical_readers.py
+-rw-r--r--   0 sbelden    (501) staff       (20)      217 2020-12-23 03:10:46.000000 fastavro-1.8.2/fastavro/logical_writers.py
+-rw-r--r--   0 sbelden    (501) staff       (20)        0 2020-06-22 15:51:13.000000 fastavro-1.8.2/fastavro/py.typed
+-rw-r--r--   0 sbelden    (501) staff       (20)      775 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/read.py
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.928997 fastavro-1.8.2/fastavro/repository/
+-rw-r--r--   0 sbelden    (501) staff       (20)      210 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/repository/__init__.py
+-rw-r--r--   0 sbelden    (501) staff       (20)      185 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/repository/base.py
+-rw-r--r--   0 sbelden    (501) staff       (20)      764 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/repository/flat_dict.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     1030 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/schema.py
+-rw-r--r--   0 sbelden    (501) staff       (20)      419 2022-08-11 13:05:27.000000 fastavro-1.8.2/fastavro/types.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     7456 2023-02-01 14:56:04.000000 fastavro-1.8.2/fastavro/utils.py
+-rw-r--r--   0 sbelden    (501) staff       (20)      422 2020-12-23 03:10:46.000000 fastavro-1.8.2/fastavro/validation.py
+-rw-r--r--   0 sbelden    (501) staff       (20)      457 2021-02-27 20:10:59.000000 fastavro-1.8.2/fastavro/write.py
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.919344 fastavro-1.8.2/fastavro.egg-info/
+-rw-r--r--   0 sbelden    (501) staff       (20)     5187 2023-07-19 02:48:58.000000 fastavro-1.8.2/fastavro.egg-info/PKG-INFO
+-rw-r--r--   0 sbelden    (501) staff       (20)     6037 2023-07-19 02:48:58.000000 fastavro-1.8.2/fastavro.egg-info/SOURCES.txt
+-rw-r--r--   0 sbelden    (501) staff       (20)        1 2023-07-19 02:48:58.000000 fastavro-1.8.2/fastavro.egg-info/dependency_links.txt
+-rw-r--r--   0 sbelden    (501) staff       (20)       52 2023-07-19 02:48:58.000000 fastavro-1.8.2/fastavro.egg-info/entry_points.txt
+-rw-r--r--   0 sbelden    (501) staff       (20)        1 2023-07-19 02:48:58.000000 fastavro-1.8.2/fastavro.egg-info/not-zip-safe
+-rw-r--r--   0 sbelden    (501) staff       (20)       96 2023-07-19 02:48:58.000000 fastavro-1.8.2/fastavro.egg-info/requires.txt
+-rw-r--r--   0 sbelden    (501) staff       (20)        9 2023-07-19 02:48:58.000000 fastavro-1.8.2/fastavro.egg-info/top_level.txt
+-rw-r--r--   0 sbelden    (501) staff       (20)       99 2023-04-17 20:07:08.000000 fastavro-1.8.2/mypy.ini
+-rwxr-xr-x   0 sbelden    (501) staff       (20)     1210 2023-07-17 20:43:04.000000 fastavro-1.8.2/publish.sh
+-rw-r--r--   0 sbelden    (501) staff       (20)      206 2023-07-17 20:43:20.000000 fastavro-1.8.2/pyproject.toml
+-rwxr-xr-x   0 sbelden    (501) staff       (20)       31 2019-05-04 22:05:46.000000 fastavro-1.8.2/pytest.ini
+-rw-r--r--   0 sbelden    (501) staff       (20)      710 2023-07-17 20:43:04.000000 fastavro-1.8.2/run-tests.cmd
+-rwxr-xr-x   0 sbelden    (501) staff       (20)     1050 2023-07-17 20:43:04.000000 fastavro-1.8.2/run-tests.sh
+-rw-r--r--   0 sbelden    (501) staff       (20)      105 2023-07-19 02:48:59.011269 fastavro-1.8.2/setup.cfg
+-rw-r--r--   0 sbelden    (501) staff       (20)     2747 2023-07-17 20:43:04.000000 fastavro-1.8.2/setup.py
+-rwxr-xr-x   0 sbelden    (501) staff       (20)      169 2023-03-08 22:33:06.000000 fastavro-1.8.2/tag.sh
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.950496 fastavro-1.8.2/tests/
+-rw-r--r--   0 sbelden    (501) staff       (20)        0 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/__init__.py
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.977434 fastavro-1.8.2/tests/avro-files/
+-rw-r--r--   0 sbelden    (501) staff       (20)       55 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/Child.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)       56 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/Child1.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      179 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/Parent.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      130 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/ParentMissingChild.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      447 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/a_triple_pair.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)       79 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/bool.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/class org.apache.avro.tool.TestDataFileTools.seperators.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)       89 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/class org.apache.avro.tool.TestDataFileTools.testWrite.deflate.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)       84 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/class org.apache.avro.tool.TestDataFileTools.testWrite.plain.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)       56 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/class org.apache.avro.tool.TestDataFileTools.zerojsonvalues.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)     3293 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/deflate.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      276 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/double_float.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      234 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/error-type.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)     8453 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/java-generated-uuid.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      299 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/lines.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      403 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/m.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      139 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/no-fields.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)     3285 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/null.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)       68 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/org.apache.avro.tool.TestDataFileTools.avro
+-rwxr-xr-x   0 sbelden    (501) staff       (20)      321 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/part-00000.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      218 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/recursive.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      162 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/request.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)       89 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/response.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)     3296 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/snappy.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)    12556 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/test-deflate-0.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)    11906 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/test-deflate-1-A.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)    12546 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/test-deflate-1.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)    11906 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/test-deflate-3-A.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)     6112 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/test-deflate-6-B.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)    12546 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/test-deflate-9.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)     6522 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/test-null-B.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)    13289 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/test-null.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)    13677 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/test-snappy.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      182 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/test.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)       51 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/testDataFileMeta.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      690 2022-08-11 13:05:27.000000 fastavro-1.8.2/tests/avro-files/weather-legacy-generated.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      696 2022-08-11 13:05:27.000000 fastavro-1.8.2/tests/avro-files/weather-legacy-with-names.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      330 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/weather-snappy.avro
+-rwxr-xr-x   0 sbelden    (501) staff       (20)      335 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/weather-sorted.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      358 2019-05-04 22:05:46.000000 fastavro-1.8.2/tests/avro-files/weather.avro
+-rw-r--r--   0 sbelden    (501) staff       (20)      999 2021-03-13 13:43:47.000000 fastavro-1.8.2/tests/conftest.py
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.980221 fastavro-1.8.2/tests/load_schema_test/
+-rw-r--r--   0 sbelden    (501) staff       (20)      189 2020-07-11 18:46:51.000000 fastavro-1.8.2/tests/load_schema_test/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      126 2020-07-11 18:46:51.000000 fastavro-1.8.2/tests/load_schema_test/B.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-07-11 18:46:51.000000 fastavro-1.8.2/tests/load_schema_test/C.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-07-11 18:46:51.000000 fastavro-1.8.2/tests/load_schema_test/D.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.983118 fastavro-1.8.2/tests/load_schema_test_10/
+-rw-r--r--   0 sbelden    (501) staff       (20)      189 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_10/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_10/B.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      189 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_10/C.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_10/D.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.986343 fastavro-1.8.2/tests/load_schema_test_11/
+-rw-r--r--   0 sbelden    (501) staff       (20)      135 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_11/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)       99 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_11/B.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      135 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_11/C.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_11/D.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_11/E.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.987019 fastavro-1.8.2/tests/load_schema_test_12/
+-rw-r--r--   0 sbelden    (501) staff       (20)      143 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_12/A.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.988269 fastavro-1.8.2/tests/load_schema_test_12/com/
+-rw-r--r--   0 sbelden    (501) staff       (20)      137 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_12/com/B.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      187 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_12/com/C.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.989467 fastavro-1.8.2/tests/load_schema_test_12/com/namespace/
+-rw-r--r--   0 sbelden    (501) staff       (20)      140 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_12/com/namespace/D.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      140 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_12/com/namespace/E.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.991014 fastavro-1.8.2/tests/load_schema_test_13/
+-rw-r--r--   0 sbelden    (501) staff       (20)        3 2021-04-16 21:12:43.000000 fastavro-1.8.2/tests/load_schema_test_13/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-04-16 21:12:43.000000 fastavro-1.8.2/tests/load_schema_test_13/B.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.991832 fastavro-1.8.2/tests/load_schema_test_14/
+-rw-r--r--   0 sbelden    (501) staff       (20)        8 2021-04-16 21:12:43.000000 fastavro-1.8.2/tests/load_schema_test_14/A.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.993778 fastavro-1.8.2/tests/load_schema_test_15/
+-rw-r--r--   0 sbelden    (501) staff       (20)       10 2021-04-16 21:12:43.000000 fastavro-1.8.2/tests/load_schema_test_15/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-04-16 21:12:43.000000 fastavro-1.8.2/tests/load_schema_test_15/B.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2021-04-16 21:12:43.000000 fastavro-1.8.2/tests/load_schema_test_15/C.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.995223 fastavro-1.8.2/tests/load_schema_test_16/
+-rw-r--r--   0 sbelden    (501) staff       (20)      225 2022-08-11 13:05:27.000000 fastavro-1.8.2/tests/load_schema_test_16/namespace.match.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      120 2022-08-11 13:05:27.000000 fastavro-1.8.2/tests/load_schema_test_16/namespace.team.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.997072 fastavro-1.8.2/tests/load_schema_test_2/
+-rw-r--r--   0 sbelden    (501) staff       (20)      294 2020-07-11 18:46:51.000000 fastavro-1.8.2/tests/load_schema_test_2/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      126 2020-07-11 18:46:51.000000 fastavro-1.8.2/tests/load_schema_test_2/B.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-07-11 18:46:51.000000 fastavro-1.8.2/tests/load_schema_test_2/C.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:58.999260 fastavro-1.8.2/tests/load_schema_test_3/
+-rw-r--r--   0 sbelden    (501) staff       (20)      189 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/load_schema_test_3/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      126 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/load_schema_test_3/B.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/load_schema_test_3/C.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:59.001143 fastavro-1.8.2/tests/load_schema_test_4/
+-rw-r--r--   0 sbelden    (501) staff       (20)      189 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/load_schema_test_4/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/load_schema_test_4/B.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      126 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/load_schema_test_4/C.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:59.002388 fastavro-1.8.2/tests/load_schema_test_5/
+-rw-r--r--   0 sbelden    (501) staff       (20)      170 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/load_schema_test_5/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/load_schema_test_5/B.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:59.003511 fastavro-1.8.2/tests/load_schema_test_6/
+-rw-r--r--   0 sbelden    (501) staff       (20)      173 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/load_schema_test_6/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      106 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/load_schema_test_6/B.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:59.004649 fastavro-1.8.2/tests/load_schema_test_7/
+-rw-r--r--   0 sbelden    (501) staff       (20)      129 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_7/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      116 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_7/namespace.B.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:59.006449 fastavro-1.8.2/tests/load_schema_test_8/
+-rw-r--r--   0 sbelden    (501) staff       (20)      165 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_8/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      102 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_8/namespace.B.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      110 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_8/namespace.C.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:59.008206 fastavro-1.8.2/tests/load_schema_test_9/
+-rw-r--r--   0 sbelden    (501) staff       (20)      165 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_9/A.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)       65 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_9/namespace.B.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)       65 2021-01-22 04:19:07.000000 fastavro-1.8.2/tests/load_schema_test_9/namespace.C.avsc
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:59.008761 fastavro-1.8.2/tests/repository/
+drwxr-xr-x   0 sbelden    (501) staff       (20)        0 2023-07-19 02:48:59.009869 fastavro-1.8.2/tests/repository/flat_dict_test/
+-rw-r--r--   0 sbelden    (501) staff       (20)       11 2022-08-11 13:05:27.000000 fastavro-1.8.2/tests/repository/flat_dict_test/InvalidJson.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)      111 2022-08-11 13:05:27.000000 fastavro-1.8.2/tests/repository/flat_dict_test/Valid.avsc
+-rw-r--r--   0 sbelden    (501) staff       (20)     1153 2022-08-11 13:05:27.000000 fastavro-1.8.2/tests/repository/test_flat_dict.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     3678 2021-03-13 13:43:47.000000 fastavro-1.8.2/tests/test_aliases.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     2185 2022-08-11 13:05:27.000000 fastavro-1.8.2/tests/test_appendable.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     2533 2023-02-01 14:55:54.000000 fastavro-1.8.2/tests/test_block_reader.py
+-rw-r--r--   0 sbelden    (501) staff       (20)    14428 2021-01-22 17:21:26.000000 fastavro-1.8.2/tests/test_canonical_form.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     4768 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/test_complex.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     5623 2022-08-11 13:05:27.000000 fastavro-1.8.2/tests/test_compression.py
+-rw-r--r--   0 sbelden    (501) staff       (20)   100647 2023-07-18 21:19:40.000000 fastavro-1.8.2/tests/test_fastavro.py
+-rw-r--r--   0 sbelden    (501) staff       (20)    33787 2021-01-23 16:11:54.000000 fastavro-1.8.2/tests/test_fingerprint.py
+-rw-r--r--   0 sbelden    (501) staff       (20)    27597 2023-07-06 14:53:47.000000 fastavro-1.8.2/tests/test_json.py
+-rw-r--r--   0 sbelden    (501) staff       (20)    16587 2022-10-26 14:14:35.000000 fastavro-1.8.2/tests/test_logical_types.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     3483 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/test_main_cli.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     2220 2023-07-18 21:19:40.000000 fastavro-1.8.2/tests/test_match.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     2229 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/test_promotion.py
+-rw-r--r--   0 sbelden    (501) staff       (20)    40285 2023-05-04 14:35:44.000000 fastavro-1.8.2/tests/test_schema.py
+-rw-r--r--   0 sbelden    (501) staff       (20)    22495 2023-02-01 14:56:44.000000 fastavro-1.8.2/tests/test_schema_evolution.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     8733 2023-07-06 14:53:47.000000 fastavro-1.8.2/tests/test_schemaless.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     1224 2021-03-13 13:43:47.000000 fastavro-1.8.2/tests/test_str_py3.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     7148 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/test_timezone.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     2653 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/test_types.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     4503 2022-05-21 05:36:47.000000 fastavro-1.8.2/tests/test_utils.py
+-rw-r--r--   0 sbelden    (501) staff       (20)    15273 2022-08-12 17:49:36.000000 fastavro-1.8.2/tests/test_validation.py
+-rw-r--r--   0 sbelden    (501) staff       (20)     1653 2020-12-23 03:10:46.000000 fastavro-1.8.2/tests/test_write_block.py
+-rw-r--r--   0 sbelden    (501) staff       (20)      248 2023-07-17 20:43:04.000000 fastavro-1.8.2/tox.ini
```

### Comparing `fastavro-1.8.1/.azure_upload.sh` & `fastavro-1.8.2/.azure_upload.sh`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/ChangeLog` & `fastavro-1.8.2/ChangeLog`

 * *Files 0% similar despite different names*

```diff
@@ -1,7 +1,10 @@
+2023-07-18 version 1.8.2
+* Fix issue with aliasing referenced schemas (@SerikDM in PR #704)
+
 2023-07-17 version 1.8.1
 * Pin Cython<3 to fix breakage
 
 2023-07-06 version 1.8.0
 * Add ability to override unicode decode errors (@scottbelden in PR #696)
 
 2023-05-04 version 1.7.4
```

### Comparing `fastavro-1.8.1/LICENSE` & `fastavro-1.8.2/LICENSE`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/MANIFEST.in` & `fastavro-1.8.2/MANIFEST.in`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/Makefile` & `fastavro-1.8.2/Makefile`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/NOTICE.txt` & `fastavro-1.8.2/NOTICE.txt`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/PKG-INFO` & `fastavro-1.8.2/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: fastavro
-Version: 1.8.1
+Version: 1.8.2
 Summary: Fast read/write of AVRO files
 Home-page: https://github.com/fastavro/fastavro
 Author: Miki Tebeka
 Author-email: miki.tebeka@gmail.com
 License: MIT
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
```

### Comparing `fastavro-1.8.1/README.md` & `fastavro-1.8.2/README.md`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/developer_requirements.txt` & `fastavro-1.8.2/developer_requirements.txt`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/docs/Makefile` & `fastavro-1.8.2/docs/Makefile`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/docs/command_line_script.rst` & `fastavro-1.8.2/docs/command_line_script.rst`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/docs/conf.py` & `fastavro-1.8.2/docs/conf.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/docs/index.rst` & `fastavro-1.8.2/docs/index.rst`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/docs/logical_types.rst` & `fastavro-1.8.2/docs/logical_types.rst`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/docs/writer.rst` & `fastavro-1.8.2/docs/writer.rst`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/__init__.py` & `fastavro-1.8.2/fastavro/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -36,15 +36,15 @@
         {u'station': u'012650-99999', u'temp': 111, u'time': 1433275478},
     ]
 
     with open('weather.avro', 'wb') as out:
         writer(out, schema, records)
 """
 
-__version_info__ = (1, 8, 1)
+__version_info__ = (1, 8, 2)
 __version__ = "%s.%s.%s" % __version_info__
 
 
 import fastavro.read
 import fastavro.write
 import fastavro.schema
 import fastavro.validation
```

### Comparing `fastavro-1.8.1/fastavro/__main__.py` & `fastavro-1.8.2/fastavro/__main__.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_logical_readers.c` & `fastavro-1.8.2/fastavro/_logical_readers.c`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_logical_readers.pyx` & `fastavro-1.8.2/fastavro/_logical_readers.pyx`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_logical_readers_py.py` & `fastavro-1.8.2/fastavro/_logical_readers_py.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_logical_writers.c` & `fastavro-1.8.2/fastavro/_logical_writers.c`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_logical_writers.pyx` & `fastavro-1.8.2/fastavro/_logical_writers.pyx`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_logical_writers_py.py` & `fastavro-1.8.2/fastavro/_logical_writers_py.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_read.c` & `fastavro-1.8.2/fastavro/_read.c`

 * *Files 0% similar despite different names*

```diff
@@ -1007,116 +1007,116 @@
 struct __pyx_opt_args_8fastavro_5_read_read_union;
 struct __pyx_opt_args_8fastavro_5_read_read_record;
 struct __pyx_opt_args_8fastavro_5_read__read_data;
 struct __pyx_opt_args_8fastavro_5_read_schemaless_reader;
 struct __pyx_defaults;
 typedef struct __pyx_defaults __pyx_defaults;
 
-/* "fastavro/_read.pyx":195
+/* "fastavro/_read.pyx":203
  * 
  * 
  * cdef union float_uint32:             # <<<<<<<<<<<<<<
  *     float f
  *     uint32 n
  */
 union __pyx_t_8fastavro_5_read_float_uint32 {
   float f;
   __pyx_t_8fastavro_5_read_uint32 n;
 };
 
-/* "fastavro/_read.pyx":230
+/* "fastavro/_read.pyx":238
  * 
  * 
  * cdef union double_ulong64:             # <<<<<<<<<<<<<<
  *     double d
  *     ulong64 n
  */
 union __pyx_t_8fastavro_5_read_double_ulong64 {
   double d;
   __pyx_t_8fastavro_5_read_ulong64 n;
 };
 
-/* "fastavro/_read.pyx":284
+/* "fastavro/_read.pyx":292
  * 
  * 
  * cpdef unicode read_utf8(fo, handle_unicode_errors="strict"):             # <<<<<<<<<<<<<<
  *     """A string is encoded as a long followed by that many bytes of UTF-8
  *     encoded character data.
  */
 struct __pyx_opt_args_8fastavro_5_read_read_utf8 {
   int __pyx_n;
   PyObject *handle_unicode_errors;
 };
 
-/* "fastavro/_read.pyx":338
+/* "fastavro/_read.pyx":346
  * 
  * cpdef read_array(
  *     fo,             # <<<<<<<<<<<<<<
  *     writer_schema,
  *     named_schemas,
  */
 struct __pyx_opt_args_8fastavro_5_read_read_array {
   int __pyx_n;
   PyObject *reader_schema;
   PyObject *options;
 };
 
-/* "fastavro/_read.pyx":419
+/* "fastavro/_read.pyx":427
  * 
  * cpdef read_map(
  *     fo,             # <<<<<<<<<<<<<<
  *     writer_schema,
  *     named_schemas,
  */
 struct __pyx_opt_args_8fastavro_5_read_read_map {
   int __pyx_n;
   PyObject *reader_schema;
   PyObject *options;
 };
 
-/* "fastavro/_read.pyx":501
+/* "fastavro/_read.pyx":509
  * 
  * cpdef read_union(
  *     fo,             # <<<<<<<<<<<<<<
  *     writer_schema,
  *     named_schemas,
  */
 struct __pyx_opt_args_8fastavro_5_read_read_union {
   int __pyx_n;
   PyObject *reader_schema;
   PyObject *options;
 };
 
-/* "fastavro/_read.pyx":578
+/* "fastavro/_read.pyx":586
  * 
  * cpdef read_record(
  *     fo,             # <<<<<<<<<<<<<<
  *     writer_schema,
  *     named_schemas,
  */
 struct __pyx_opt_args_8fastavro_5_read_read_record {
   int __pyx_n;
   PyObject *reader_schema;
   PyObject *options;
 };
 
-/* "fastavro/_read.pyx":671
+/* "fastavro/_read.pyx":679
  * 
  * cpdef _read_data(
  *     fo,             # <<<<<<<<<<<<<<
  *     writer_schema,
  *     named_schemas,
  */
 struct __pyx_opt_args_8fastavro_5_read__read_data {
   int __pyx_n;
   PyObject *reader_schema;
   PyObject *options;
 };
 
-/* "fastavro/_read.pyx":1100
+/* "fastavro/_read.pyx":1112
  * 
  * cpdef schemaless_reader(
  *     fo,             # <<<<<<<<<<<<<<
  *     writer_schema,
  *     reader_schema=None,
  */
 struct __pyx_opt_args_8fastavro_5_read_schemaless_reader {
@@ -1126,15 +1126,15 @@
   PyObject *return_record_name_override;
   PyObject *handle_unicode_errors;
 };
 struct __pyx_defaults {
   PyObject *__pyx_arg_options;
 };
 
-/* "fastavro/_read.pyx":881
+/* "fastavro/_read.pyx":893
  * 
  * 
  * def _iter_avro_records(             # <<<<<<<<<<<<<<
  *     fo,
  *     header,
  */
 struct __pyx_obj_8fastavro_5_read___pyx_scope_struct___iter_avro_records {
@@ -1153,15 +1153,15 @@
   PyObject *__pyx_v_writer_schema;
   __pyx_t_8fastavro_5_read_long64 __pyx_t_0;
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
   __pyx_t_8fastavro_5_read_int32 __pyx_t_2;
 };
 
 
-/* "fastavro/_read.pyx":915
+/* "fastavro/_read.pyx":927
  * 
  * 
  * def _iter_avro_blocks(             # <<<<<<<<<<<<<<
  *     fo,
  *     header,
  */
 struct __pyx_obj_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks {
@@ -1178,15 +1178,15 @@
   PyObject *__pyx_v_reader_schema;
   PyObject *__pyx_v_size;
   PyObject *__pyx_v_sync_marker;
   PyObject *__pyx_v_writer_schema;
 };
 
 
-/* "fastavro/_read.pyx":972
+/* "fastavro/_read.pyx":984
  *         self.options = options
  * 
  *     def __iter__(self):             # <<<<<<<<<<<<<<
  *         for i in range(self.num_records):
  *             yield _read_data(
  */
 struct __pyx_obj_8fastavro_5_read___pyx_scope_struct_2___iter__ {
@@ -1398,52 +1398,25 @@
 
 /* BytesEquals.proto */
 static CYTHON_INLINE int __Pyx_PyBytes_Equals(PyObject* s1, PyObject* s2, int equals);
 
 /* UnicodeEquals.proto */
 static CYTHON_INLINE int __Pyx_PyUnicode_Equals(PyObject* s1, PyObject* s2, int equals);
 
-/* RaiseArgTupleInvalid.proto */
-static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
-    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
-
-/* RaiseDoubleKeywords.proto */
-static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);
-
-/* ParseKeywords.proto */
-static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
-    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
-    const char* function_name);
-
-/* PyObjectFormatSimple.proto */
-#if CYTHON_COMPILING_IN_PYPY
-    #define __Pyx_PyObject_FormatSimple(s, f) (\
-        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
-        PyObject_Format(s, f))
-#elif PY_MAJOR_VERSION < 3
-    #define __Pyx_PyObject_FormatSimple(s, f) (\
-        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
-        likely(PyString_CheckExact(s)) ? PyUnicode_FromEncodedObject(s, NULL, "strict") :\
-        PyObject_Format(s, f))
-#elif CYTHON_USE_TYPE_SLOTS
-    #define __Pyx_PyObject_FormatSimple(s, f) (\
-        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
-        likely(PyLong_CheckExact(s)) ? PyLong_Type.tp_str(s) :\
-        likely(PyFloat_CheckExact(s)) ? PyFloat_Type.tp_str(s) :\
-        PyObject_Format(s, f))
+/* DictGetItem.proto */
+#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
+static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key);
+#define __Pyx_PyObject_Dict_GetItem(obj, name)\
+    (likely(PyDict_CheckExact(obj)) ?\
+     __Pyx_PyDict_GetItem(obj, name) : PyObject_GetItem(obj, name))
 #else
-    #define __Pyx_PyObject_FormatSimple(s, f) (\
-        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
-        PyObject_Format(s, f))
+#define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
+#define __Pyx_PyObject_Dict_GetItem(obj, name)  PyObject_GetItem(obj, name)
 #endif
 
-/* JoinPyUnicode.proto */
-static PyObject* __Pyx_PyUnicode_Join(PyObject* value_tuple, Py_ssize_t value_count, Py_ssize_t result_ulength,
-                                      Py_UCS4 max_char);
-
 /* PyCFunctionFastCall.proto */
 #if CYTHON_FAST_PYCCALL
 static CYTHON_INLINE PyObject *__Pyx_PyCFunction_FastCall(PyObject *func, PyObject **args, Py_ssize_t nargs);
 #else
 #define __Pyx_PyCFunction_FastCall(func, args, nargs)  (assert(0), NULL)
 #endif
 
@@ -1492,28 +1465,55 @@
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
 #endif
 
 /* PyObjectCallOneArg.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);
 
-/* RaiseException.proto */
-static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);
+/* RaiseArgTupleInvalid.proto */
+static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
+    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
 
-/* DictGetItem.proto */
-#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
-static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key);
-#define __Pyx_PyObject_Dict_GetItem(obj, name)\
-    (likely(PyDict_CheckExact(obj)) ?\
-     __Pyx_PyDict_GetItem(obj, name) : PyObject_GetItem(obj, name))
+/* RaiseDoubleKeywords.proto */
+static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);
+
+/* ParseKeywords.proto */
+static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
+    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
+    const char* function_name);
+
+/* PyObjectFormatSimple.proto */
+#if CYTHON_COMPILING_IN_PYPY
+    #define __Pyx_PyObject_FormatSimple(s, f) (\
+        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
+        PyObject_Format(s, f))
+#elif PY_MAJOR_VERSION < 3
+    #define __Pyx_PyObject_FormatSimple(s, f) (\
+        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
+        likely(PyString_CheckExact(s)) ? PyUnicode_FromEncodedObject(s, NULL, "strict") :\
+        PyObject_Format(s, f))
+#elif CYTHON_USE_TYPE_SLOTS
+    #define __Pyx_PyObject_FormatSimple(s, f) (\
+        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
+        likely(PyLong_CheckExact(s)) ? PyLong_Type.tp_str(s) :\
+        likely(PyFloat_CheckExact(s)) ? PyFloat_Type.tp_str(s) :\
+        PyObject_Format(s, f))
 #else
-#define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
-#define __Pyx_PyObject_Dict_GetItem(obj, name)  PyObject_GetItem(obj, name)
+    #define __Pyx_PyObject_FormatSimple(s, f) (\
+        likely(PyUnicode_CheckExact(s)) ? (Py_INCREF(s), s) :\
+        PyObject_Format(s, f))
 #endif
 
+/* JoinPyUnicode.proto */
+static PyObject* __Pyx_PyUnicode_Join(PyObject* value_tuple, Py_ssize_t value_count, Py_ssize_t result_ulength,
+                                      Py_UCS4 max_char);
+
+/* RaiseException.proto */
+static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);
+
 /* PySequenceContains.proto */
 static CYTHON_INLINE int __Pyx_PySequence_ContainsTF(PyObject* item, PyObject* seq, int eq) {
     int result = PySequence_Contains(seq, item);
     return unlikely(result < 0) ? result : (result == (eq == Py_EQ));
 }
 
 /* GetItemInt.proto */
@@ -1943,16 +1943,17 @@
 static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);
 
 
 /* Module declarations from 'fastavro._read' */
 static PyTypeObject *__pyx_ptype_8fastavro_5_read___pyx_scope_struct___iter_avro_records = 0;
 static PyTypeObject *__pyx_ptype_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks = 0;
 static PyTypeObject *__pyx_ptype_8fastavro_5_read___pyx_scope_struct_2___iter__ = 0;
-static PyObject *__pyx_f_8fastavro_5_read_match_types(PyObject *, PyObject *, int __pyx_skip_dispatch); /*proto*/
-static PyObject *__pyx_f_8fastavro_5_read_match_schemas(PyObject *, PyObject *, int __pyx_skip_dispatch); /*proto*/
+static PyObject *__pyx_f_8fastavro_5_read__default_named_schemas(int __pyx_skip_dispatch); /*proto*/
+static PyObject *__pyx_f_8fastavro_5_read_match_types(PyObject *, PyObject *, PyObject *, int __pyx_skip_dispatch); /*proto*/
+static PyObject *__pyx_f_8fastavro_5_read_match_schemas(PyObject *, PyObject *, PyObject *, int __pyx_skip_dispatch); /*proto*/
 static CYTHON_INLINE PyObject *__pyx_f_8fastavro_5_read_read_null(PyObject *, int __pyx_skip_dispatch); /*proto*/
 static CYTHON_INLINE PyObject *__pyx_f_8fastavro_5_read_skip_null(PyObject *, int __pyx_skip_dispatch); /*proto*/
 static CYTHON_INLINE PyObject *__pyx_f_8fastavro_5_read_read_boolean(PyObject *, int __pyx_skip_dispatch); /*proto*/
 static CYTHON_INLINE PyObject *__pyx_f_8fastavro_5_read_skip_boolean(PyObject *, int __pyx_skip_dispatch); /*proto*/
 static __pyx_t_8fastavro_5_read_long64 __pyx_f_8fastavro_5_read_read_long(PyObject *, int __pyx_skip_dispatch); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_long(PyObject *, int __pyx_skip_dispatch); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_int(PyObject *, int __pyx_skip_dispatch); /*proto*/
@@ -2414,68 +2415,69 @@
 static PyObject *__pyx_n_u_xz;
 static PyObject *__pyx_n_s_xz_read_block;
 static PyObject *__pyx_n_s_zlib;
 static PyObject *__pyx_n_s_zstandard;
 static PyObject *__pyx_n_u_zstandard;
 static PyObject *__pyx_n_s_zstandard_read_block;
 static PyObject *__pyx_n_s_zstd;
-static PyObject *__pyx_pf_8fastavro_5_read_match_types(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_writer_type, PyObject *__pyx_v_reader_type); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_2match_schemas(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_w_schema, PyObject *__pyx_v_r_schema); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_4read_null(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_6skip_null(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_8read_boolean(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_10skip_boolean(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_12read_long(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_14skip_long(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_16skip_int(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_18read_float(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_20skip_float(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_22read_double(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_24skip_double(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_26read_bytes(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_28skip_bytes(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_30read_utf8(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_handle_unicode_errors); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_32skip_utf8(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_34read_fixed(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_36skip_fixed(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_38read_enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_reader_schema); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_40skip_enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_42read_array(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_44skip_array(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_46read_map(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_48skip_map(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_50read_union(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_52skip_union(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_54read_record(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_56skip_record(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_58maybe_promote(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_writer_type, PyObject *__pyx_v_reader_type); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_60_read_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_62_skip_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_64skip_sync(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_sync_marker); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_66null_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_68deflate_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_70bzip2_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_72xz_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_74snappy_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_76zstandard_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_78lz4_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_80_iter_avro_records(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_header, PyObject *__pyx_v_codec, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_83_iter_avro_blocks(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_header, PyObject *__pyx_v_codec, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read__default_named_schemas(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_2match_types(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_writer_type, PyObject *__pyx_v_reader_type, PyObject *__pyx_v_named_schemas); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_4match_schemas(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_w_schema, PyObject *__pyx_v_r_schema, PyObject *__pyx_v_named_schemas); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_6read_null(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_8skip_null(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_10read_boolean(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_12skip_boolean(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_14read_long(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_16skip_long(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_18skip_int(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_20read_float(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_22skip_float(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_24read_double(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_26skip_double(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_28read_bytes(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_30skip_bytes(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_32read_utf8(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_handle_unicode_errors); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_34skip_utf8(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_36read_fixed(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_38skip_fixed(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_40read_enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_reader_schema); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_42skip_enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_44read_array(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_46skip_array(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_48read_map(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_50skip_map(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_52read_union(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_54skip_union(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_56read_record(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_58skip_record(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_60maybe_promote(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_writer_type, PyObject *__pyx_v_reader_type); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_62_read_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_64_skip_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_66skip_sync(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_sync_marker); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_68null_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_70deflate_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_72bzip2_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_74xz_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_76snappy_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_78zstandard_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_80lz4_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_82_iter_avro_records(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_header, PyObject *__pyx_v_codec, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_85_iter_avro_blocks(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_header, PyObject *__pyx_v_codec, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
 static PyObject *__pyx_pf_8fastavro_5_read_5Block___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_bytes_, PyObject *__pyx_v_num_records, PyObject *__pyx_v_codec, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_offset, PyObject *__pyx_v_size, PyObject *__pyx_v_options); /* proto */
 static PyObject *__pyx_pf_8fastavro_5_read_5Block_2__iter__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_8fastavro_5_read_5Block_5__str__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_90__defaults__(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_92__defaults__(CYTHON_UNUSED PyObject *__pyx_self); /* proto */
 static PyObject *__pyx_pf_8fastavro_5_read_11file_reader___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options); /* proto */
 static PyObject *__pyx_pf_8fastavro_5_read_11file_reader_2schema(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_8fastavro_5_read_11file_reader_4__iter__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_8fastavro_5_read_11file_reader_6__next__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_8fastavro_5_read_6reader___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_return_record_name, PyObject *__pyx_v_return_record_name_override, PyObject *__pyx_v_handle_unicode_errors); /* proto */
 static PyObject *__pyx_pf_8fastavro_5_read_12block_reader___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_return_record_name, PyObject *__pyx_v_return_record_name_override, PyObject *__pyx_v_handle_unicode_errors); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_86schemaless_reader(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_return_record_name, PyObject *__pyx_v_return_record_name_override, PyObject *__pyx_v_handle_unicode_errors); /* proto */
-static PyObject *__pyx_pf_8fastavro_5_read_88is_avro(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_path_or_buffer); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_88schemaless_reader(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_return_record_name, PyObject *__pyx_v_return_record_name_override, PyObject *__pyx_v_handle_unicode_errors); /* proto */
+static PyObject *__pyx_pf_8fastavro_5_read_90is_avro(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_path_or_buffer); /* proto */
 static PyObject *__pyx_tp_new_8fastavro_5_read___pyx_scope_struct___iter_avro_records(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_8fastavro_5_read___pyx_scope_struct_2___iter__(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static __Pyx_CachedCFunction __pyx_umethod_PyDict_Type_get = {0, &__pyx_n_s_get, 0, 0, 0};
 static PyObject *__pyx_int_1;
 static PyObject *__pyx_int_4;
 static PyObject *__pyx_int_8;
@@ -2520,21 +2522,123 @@
 static PyObject *__pyx_codeobj__36;
 static PyObject *__pyx_codeobj__39;
 /* Late includes */
 
 /* "fastavro/_read.pyx":46
  * 
  * 
- * cpdef match_types(writer_type, reader_type):             # <<<<<<<<<<<<<<
+ * cpdef _default_named_schemas():             # <<<<<<<<<<<<<<
+ *     return {"writer": {}, "reader": {}}
+ * 
+ */
+
+static PyObject *__pyx_pw_8fastavro_5_read_1_default_named_schemas(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_f_8fastavro_5_read__default_named_schemas(CYTHON_UNUSED int __pyx_skip_dispatch) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  PyObject *__pyx_t_2 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("_default_named_schemas", 0);
+
+  /* "fastavro/_read.pyx":47
+ * 
+ * cpdef _default_named_schemas():
+ *     return {"writer": {}, "reader": {}}             # <<<<<<<<<<<<<<
+ * 
+ * 
+ */
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 47, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 47, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_writer, __pyx_t_2) < 0) __PYX_ERR(0, 47, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 47, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_reader, __pyx_t_2) < 0) __PYX_ERR(0, 47, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* "fastavro/_read.pyx":46
+ * 
+ * 
+ * cpdef _default_named_schemas():             # <<<<<<<<<<<<<<
+ *     return {"writer": {}, "reader": {}}
+ * 
+ */
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_XDECREF(__pyx_t_2);
+  __Pyx_AddTraceback("fastavro._read._default_named_schemas", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = 0;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* Python wrapper */
+static PyObject *__pyx_pw_8fastavro_5_read_1_default_named_schemas(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_1_default_named_schemas(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
+  PyObject *__pyx_r = 0;
+  __Pyx_RefNannyDeclarations
+  __Pyx_RefNannySetupContext("_default_named_schemas (wrapper)", 0);
+  __pyx_r = __pyx_pf_8fastavro_5_read__default_named_schemas(__pyx_self);
+
+  /* function exit code */
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+static PyObject *__pyx_pf_8fastavro_5_read__default_named_schemas(CYTHON_UNUSED PyObject *__pyx_self) {
+  PyObject *__pyx_r = NULL;
+  __Pyx_RefNannyDeclarations
+  PyObject *__pyx_t_1 = NULL;
+  int __pyx_lineno = 0;
+  const char *__pyx_filename = NULL;
+  int __pyx_clineno = 0;
+  __Pyx_RefNannySetupContext("_default_named_schemas", 0);
+  __Pyx_XDECREF(__pyx_r);
+  __pyx_t_1 = __pyx_f_8fastavro_5_read__default_named_schemas(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_r = __pyx_t_1;
+  __pyx_t_1 = 0;
+  goto __pyx_L0;
+
+  /* function exit code */
+  __pyx_L1_error:;
+  __Pyx_XDECREF(__pyx_t_1);
+  __Pyx_AddTraceback("fastavro._read._default_named_schemas", __pyx_clineno, __pyx_lineno, __pyx_filename);
+  __pyx_r = NULL;
+  __pyx_L0:;
+  __Pyx_XGIVEREF(__pyx_r);
+  __Pyx_RefNannyFinishContext();
+  return __pyx_r;
+}
+
+/* "fastavro/_read.pyx":50
+ * 
+ * 
+ * cpdef match_types(writer_type, reader_type, named_schemas):             # <<<<<<<<<<<<<<
  *     if isinstance(writer_type, list) or isinstance(reader_type, list):
  *         return True
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_1match_types(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8fastavro_5_read_match_types(PyObject *__pyx_v_writer_type, PyObject *__pyx_v_reader_type, CYTHON_UNUSED int __pyx_skip_dispatch) {
+static PyObject *__pyx_pw_8fastavro_5_read_3match_types(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8fastavro_5_read_match_types(PyObject *__pyx_v_writer_type, PyObject *__pyx_v_reader_type, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch) {
+  PyObject *__pyx_v_writer_schema = NULL;
+  PyObject *__pyx_v_reader_schema = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
@@ -2545,17 +2649,17 @@
   PyObject *__pyx_t_10 = NULL;
   int __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("match_types", 0);
 
-  /* "fastavro/_read.pyx":47
+  /* "fastavro/_read.pyx":51
  * 
- * cpdef match_types(writer_type, reader_type):
+ * cpdef match_types(writer_type, reader_type, named_schemas):
  *     if isinstance(writer_type, list) or isinstance(reader_type, list):             # <<<<<<<<<<<<<<
  *         return True
  *     if isinstance(writer_type, dict) or isinstance(reader_type, dict):
  */
   __pyx_t_2 = PyList_Check(__pyx_v_writer_type); 
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (!__pyx_t_3) {
@@ -2565,119 +2669,119 @@
   }
   __pyx_t_3 = PyList_Check(__pyx_v_reader_type); 
   __pyx_t_2 = (__pyx_t_3 != 0);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":48
- * cpdef match_types(writer_type, reader_type):
+    /* "fastavro/_read.pyx":52
+ * cpdef match_types(writer_type, reader_type, named_schemas):
  *     if isinstance(writer_type, list) or isinstance(reader_type, list):
  *         return True             # <<<<<<<<<<<<<<
  *     if isinstance(writer_type, dict) or isinstance(reader_type, dict):
  *         try:
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_True);
     __pyx_r = Py_True;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":47
+    /* "fastavro/_read.pyx":51
  * 
- * cpdef match_types(writer_type, reader_type):
+ * cpdef match_types(writer_type, reader_type, named_schemas):
  *     if isinstance(writer_type, list) or isinstance(reader_type, list):             # <<<<<<<<<<<<<<
  *         return True
  *     if isinstance(writer_type, dict) or isinstance(reader_type, dict):
  */
   }
 
-  /* "fastavro/_read.pyx":49
+  /* "fastavro/_read.pyx":53
  *     if isinstance(writer_type, list) or isinstance(reader_type, list):
  *         return True
  *     if isinstance(writer_type, dict) or isinstance(reader_type, dict):             # <<<<<<<<<<<<<<
  *         try:
- *             return match_schemas(writer_type, reader_type)
+ *             return match_schemas(writer_type, reader_type, named_schemas)
  */
   __pyx_t_2 = PyDict_Check(__pyx_v_writer_type); 
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (!__pyx_t_3) {
   } else {
     __pyx_t_1 = __pyx_t_3;
     goto __pyx_L7_bool_binop_done;
   }
   __pyx_t_3 = PyDict_Check(__pyx_v_reader_type); 
   __pyx_t_2 = (__pyx_t_3 != 0);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L7_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":50
+    /* "fastavro/_read.pyx":54
  *         return True
  *     if isinstance(writer_type, dict) or isinstance(reader_type, dict):
  *         try:             # <<<<<<<<<<<<<<
- *             return match_schemas(writer_type, reader_type)
+ *             return match_schemas(writer_type, reader_type, named_schemas)
  *         except SchemaResolutionError:
  */
     {
       __Pyx_PyThreadState_declare
       __Pyx_PyThreadState_assign
       __Pyx_ExceptionSave(&__pyx_t_4, &__pyx_t_5, &__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_4);
       __Pyx_XGOTREF(__pyx_t_5);
       __Pyx_XGOTREF(__pyx_t_6);
       /*try:*/ {
 
-        /* "fastavro/_read.pyx":51
+        /* "fastavro/_read.pyx":55
  *     if isinstance(writer_type, dict) or isinstance(reader_type, dict):
  *         try:
- *             return match_schemas(writer_type, reader_type)             # <<<<<<<<<<<<<<
+ *             return match_schemas(writer_type, reader_type, named_schemas)             # <<<<<<<<<<<<<<
  *         except SchemaResolutionError:
  *             return False
  */
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_7 = __pyx_f_8fastavro_5_read_match_schemas(__pyx_v_writer_type, __pyx_v_reader_type, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 51, __pyx_L9_error)
+        __pyx_t_7 = __pyx_f_8fastavro_5_read_match_schemas(__pyx_v_writer_type, __pyx_v_reader_type, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 55, __pyx_L9_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_r = __pyx_t_7;
         __pyx_t_7 = 0;
         goto __pyx_L13_try_return;
 
-        /* "fastavro/_read.pyx":50
+        /* "fastavro/_read.pyx":54
  *         return True
  *     if isinstance(writer_type, dict) or isinstance(reader_type, dict):
  *         try:             # <<<<<<<<<<<<<<
- *             return match_schemas(writer_type, reader_type)
+ *             return match_schemas(writer_type, reader_type, named_schemas)
  *         except SchemaResolutionError:
  */
       }
       __pyx_L9_error:;
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "fastavro/_read.pyx":52
+      /* "fastavro/_read.pyx":56
  *         try:
- *             return match_schemas(writer_type, reader_type)
+ *             return match_schemas(writer_type, reader_type, named_schemas)
  *         except SchemaResolutionError:             # <<<<<<<<<<<<<<
  *             return False
  *     if writer_type == reader_type:
  */
       __Pyx_ErrFetch(&__pyx_t_7, &__pyx_t_8, &__pyx_t_9);
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 52, __pyx_L11_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 56, __pyx_L11_except_error)
       __Pyx_GOTREF(__pyx_t_10);
       __pyx_t_11 = __Pyx_PyErr_GivenExceptionMatches(__pyx_t_7, __pyx_t_10);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_ErrRestore(__pyx_t_7, __pyx_t_8, __pyx_t_9);
       __pyx_t_7 = 0; __pyx_t_8 = 0; __pyx_t_9 = 0;
       if (__pyx_t_11) {
         __Pyx_AddTraceback("fastavro._read.match_types", __pyx_clineno, __pyx_lineno, __pyx_filename);
-        if (__Pyx_GetException(&__pyx_t_9, &__pyx_t_8, &__pyx_t_7) < 0) __PYX_ERR(0, 52, __pyx_L11_except_error)
+        if (__Pyx_GetException(&__pyx_t_9, &__pyx_t_8, &__pyx_t_7) < 0) __PYX_ERR(0, 56, __pyx_L11_except_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_GOTREF(__pyx_t_7);
 
-        /* "fastavro/_read.pyx":53
- *             return match_schemas(writer_type, reader_type)
+        /* "fastavro/_read.pyx":57
+ *             return match_schemas(writer_type, reader_type, named_schemas)
  *         except SchemaResolutionError:
  *             return False             # <<<<<<<<<<<<<<
  *     if writer_type == reader_type:
  *         return True
  */
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(Py_False);
@@ -2686,19 +2790,19 @@
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         goto __pyx_L12_except_return;
       }
       goto __pyx_L11_except_error;
       __pyx_L11_except_error:;
 
-      /* "fastavro/_read.pyx":50
+      /* "fastavro/_read.pyx":54
  *         return True
  *     if isinstance(writer_type, dict) or isinstance(reader_type, dict):
  *         try:             # <<<<<<<<<<<<<<
- *             return match_schemas(writer_type, reader_type)
+ *             return match_schemas(writer_type, reader_type, named_schemas)
  *         except SchemaResolutionError:
  */
       __Pyx_XGIVEREF(__pyx_t_4);
       __Pyx_XGIVEREF(__pyx_t_5);
       __Pyx_XGIVEREF(__pyx_t_6);
       __Pyx_ExceptionReset(__pyx_t_4, __pyx_t_5, __pyx_t_6);
       goto __pyx_L1_error;
@@ -2712,333 +2816,441 @@
       __Pyx_XGIVEREF(__pyx_t_4);
       __Pyx_XGIVEREF(__pyx_t_5);
       __Pyx_XGIVEREF(__pyx_t_6);
       __Pyx_ExceptionReset(__pyx_t_4, __pyx_t_5, __pyx_t_6);
       goto __pyx_L0;
     }
 
-    /* "fastavro/_read.pyx":49
+    /* "fastavro/_read.pyx":53
  *     if isinstance(writer_type, list) or isinstance(reader_type, list):
  *         return True
  *     if isinstance(writer_type, dict) or isinstance(reader_type, dict):             # <<<<<<<<<<<<<<
  *         try:
- *             return match_schemas(writer_type, reader_type)
+ *             return match_schemas(writer_type, reader_type, named_schemas)
  */
   }
 
-  /* "fastavro/_read.pyx":54
+  /* "fastavro/_read.pyx":58
  *         except SchemaResolutionError:
  *             return False
  *     if writer_type == reader_type:             # <<<<<<<<<<<<<<
  *         return True
  *     # promotion cases
  */
-  __pyx_t_7 = PyObject_RichCompare(__pyx_v_writer_type, __pyx_v_reader_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 54, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __pyx_t_7 = PyObject_RichCompare(__pyx_v_writer_type, __pyx_v_reader_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 58, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 58, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":55
+    /* "fastavro/_read.pyx":59
  *             return False
  *     if writer_type == reader_type:
  *         return True             # <<<<<<<<<<<<<<
  *     # promotion cases
  *     elif writer_type == "int" and reader_type in ["long", "float", "double"]:
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_True);
     __pyx_r = Py_True;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":54
+    /* "fastavro/_read.pyx":58
  *         except SchemaResolutionError:
  *             return False
  *     if writer_type == reader_type:             # <<<<<<<<<<<<<<
  *         return True
  *     # promotion cases
  */
   }
 
-  /* "fastavro/_read.pyx":57
+  /* "fastavro/_read.pyx":61
  *         return True
  *     # promotion cases
  *     elif writer_type == "int" and reader_type in ["long", "float", "double"]:             # <<<<<<<<<<<<<<
  *         return True
  *     elif writer_type == "long" and reader_type in ["float", "double"]:
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_int, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 57, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_int, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 61, __pyx_L1_error)
   if (__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L18_bool_binop_done;
   }
   __Pyx_INCREF(__pyx_v_reader_type);
   __pyx_t_7 = __pyx_v_reader_type;
-  __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_long, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 57, __pyx_L1_error)
+  __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_long, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 61, __pyx_L1_error)
   if (!__pyx_t_3) {
   } else {
     __pyx_t_2 = __pyx_t_3;
     goto __pyx_L20_bool_binop_done;
   }
-  __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 57, __pyx_L1_error)
+  __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 61, __pyx_L1_error)
   if (!__pyx_t_3) {
   } else {
     __pyx_t_2 = __pyx_t_3;
     goto __pyx_L20_bool_binop_done;
   }
-  __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 57, __pyx_L1_error)
+  __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 61, __pyx_L1_error)
   __pyx_t_2 = __pyx_t_3;
   __pyx_L20_bool_binop_done:;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_3 = (__pyx_t_2 != 0);
   __pyx_t_1 = __pyx_t_3;
   __pyx_L18_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":58
+    /* "fastavro/_read.pyx":62
  *     # promotion cases
  *     elif writer_type == "int" and reader_type in ["long", "float", "double"]:
  *         return True             # <<<<<<<<<<<<<<
  *     elif writer_type == "long" and reader_type in ["float", "double"]:
  *         return True
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_True);
     __pyx_r = Py_True;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":57
+    /* "fastavro/_read.pyx":61
  *         return True
  *     # promotion cases
  *     elif writer_type == "int" and reader_type in ["long", "float", "double"]:             # <<<<<<<<<<<<<<
  *         return True
  *     elif writer_type == "long" and reader_type in ["float", "double"]:
  */
   }
 
-  /* "fastavro/_read.pyx":59
+  /* "fastavro/_read.pyx":63
  *     elif writer_type == "int" and reader_type in ["long", "float", "double"]:
  *         return True
  *     elif writer_type == "long" and reader_type in ["float", "double"]:             # <<<<<<<<<<<<<<
  *         return True
  *     elif writer_type == "float" and reader_type == "double":
  */
-  __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_long, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 59, __pyx_L1_error)
+  __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_long, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 63, __pyx_L1_error)
   if (__pyx_t_3) {
   } else {
     __pyx_t_1 = __pyx_t_3;
     goto __pyx_L23_bool_binop_done;
   }
   __Pyx_INCREF(__pyx_v_reader_type);
   __pyx_t_7 = __pyx_v_reader_type;
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 59, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 63, __pyx_L1_error)
   if (!__pyx_t_2) {
   } else {
     __pyx_t_3 = __pyx_t_2;
     goto __pyx_L25_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 59, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 63, __pyx_L1_error)
   __pyx_t_3 = __pyx_t_2;
   __pyx_L25_bool_binop_done:;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_2 = (__pyx_t_3 != 0);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L23_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":60
+    /* "fastavro/_read.pyx":64
  *         return True
  *     elif writer_type == "long" and reader_type in ["float", "double"]:
  *         return True             # <<<<<<<<<<<<<<
  *     elif writer_type == "float" and reader_type == "double":
  *         return True
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_True);
     __pyx_r = Py_True;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":59
+    /* "fastavro/_read.pyx":63
  *     elif writer_type == "int" and reader_type in ["long", "float", "double"]:
  *         return True
  *     elif writer_type == "long" and reader_type in ["float", "double"]:             # <<<<<<<<<<<<<<
  *         return True
  *     elif writer_type == "float" and reader_type == "double":
  */
   }
 
-  /* "fastavro/_read.pyx":61
+  /* "fastavro/_read.pyx":65
  *     elif writer_type == "long" and reader_type in ["float", "double"]:
  *         return True
  *     elif writer_type == "float" and reader_type == "double":             # <<<<<<<<<<<<<<
  *         return True
  *     elif writer_type == "string" and reader_type == "bytes":
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 61, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 65, __pyx_L1_error)
   if (__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L27_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 61, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 65, __pyx_L1_error)
   __pyx_t_1 = __pyx_t_2;
   __pyx_L27_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":62
+    /* "fastavro/_read.pyx":66
  *         return True
  *     elif writer_type == "float" and reader_type == "double":
  *         return True             # <<<<<<<<<<<<<<
  *     elif writer_type == "string" and reader_type == "bytes":
  *         return True
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_True);
     __pyx_r = Py_True;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":61
+    /* "fastavro/_read.pyx":65
  *     elif writer_type == "long" and reader_type in ["float", "double"]:
  *         return True
  *     elif writer_type == "float" and reader_type == "double":             # <<<<<<<<<<<<<<
  *         return True
  *     elif writer_type == "string" and reader_type == "bytes":
  */
   }
 
-  /* "fastavro/_read.pyx":63
+  /* "fastavro/_read.pyx":67
  *     elif writer_type == "float" and reader_type == "double":
  *         return True
  *     elif writer_type == "string" and reader_type == "bytes":             # <<<<<<<<<<<<<<
  *         return True
  *     elif writer_type == "bytes" and reader_type == "string":
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 63, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 67, __pyx_L1_error)
   if (__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L29_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 63, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 67, __pyx_L1_error)
   __pyx_t_1 = __pyx_t_2;
   __pyx_L29_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":64
+    /* "fastavro/_read.pyx":68
  *         return True
  *     elif writer_type == "string" and reader_type == "bytes":
  *         return True             # <<<<<<<<<<<<<<
  *     elif writer_type == "bytes" and reader_type == "string":
  *         return True
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_True);
     __pyx_r = Py_True;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":63
+    /* "fastavro/_read.pyx":67
  *     elif writer_type == "float" and reader_type == "double":
  *         return True
  *     elif writer_type == "string" and reader_type == "bytes":             # <<<<<<<<<<<<<<
  *         return True
  *     elif writer_type == "bytes" and reader_type == "string":
  */
   }
 
-  /* "fastavro/_read.pyx":65
+  /* "fastavro/_read.pyx":69
  *     elif writer_type == "string" and reader_type == "bytes":
  *         return True
  *     elif writer_type == "bytes" and reader_type == "string":             # <<<<<<<<<<<<<<
  *         return True
- *     return False
+ *     writer_schema = named_schemas["writer"].get(writer_type)
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 65, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 69, __pyx_L1_error)
   if (__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L31_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 65, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 69, __pyx_L1_error)
   __pyx_t_1 = __pyx_t_2;
   __pyx_L31_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":66
+    /* "fastavro/_read.pyx":70
  *         return True
  *     elif writer_type == "bytes" and reader_type == "string":
  *         return True             # <<<<<<<<<<<<<<
- *     return False
- * 
+ *     writer_schema = named_schemas["writer"].get(writer_type)
+ *     reader_schema = named_schemas["reader"].get(reader_type)
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(Py_True);
     __pyx_r = Py_True;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":65
+    /* "fastavro/_read.pyx":69
  *     elif writer_type == "string" and reader_type == "bytes":
  *         return True
  *     elif writer_type == "bytes" and reader_type == "string":             # <<<<<<<<<<<<<<
  *         return True
- *     return False
+ *     writer_schema = named_schemas["writer"].get(writer_type)
  */
   }
 
-  /* "fastavro/_read.pyx":67
+  /* "fastavro/_read.pyx":71
  *     elif writer_type == "bytes" and reader_type == "string":
  *         return True
+ *     writer_schema = named_schemas["writer"].get(writer_type)             # <<<<<<<<<<<<<<
+ *     reader_schema = named_schemas["reader"].get(reader_type)
+ *     if writer_schema is not None and reader_schema is not None:
+ */
+  __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_writer); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_8);
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_get); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_9);
+  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+  __pyx_t_8 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
+    __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_9);
+    if (likely(__pyx_t_8)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
+      __Pyx_INCREF(__pyx_t_8);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_9, function);
+    }
+  }
+  __pyx_t_7 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_8, __pyx_v_writer_type) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_writer_type);
+  __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 71, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+  __pyx_v_writer_schema = __pyx_t_7;
+  __pyx_t_7 = 0;
+
+  /* "fastavro/_read.pyx":72
+ *         return True
+ *     writer_schema = named_schemas["writer"].get(writer_type)
+ *     reader_schema = named_schemas["reader"].get(reader_type)             # <<<<<<<<<<<<<<
+ *     if writer_schema is not None and reader_schema is not None:
+ *         return match_types(writer_schema, reader_schema, named_schemas)
+ */
+  __pyx_t_9 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_reader); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_9);
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_get); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_8);
+  __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
+  __pyx_t_9 = NULL;
+  if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
+    __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
+    if (likely(__pyx_t_9)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
+      __Pyx_INCREF(__pyx_t_9);
+      __Pyx_INCREF(function);
+      __Pyx_DECREF_SET(__pyx_t_8, function);
+    }
+  }
+  __pyx_t_7 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_v_reader_type) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_reader_type);
+  __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 72, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_7);
+  __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
+  __pyx_v_reader_schema = __pyx_t_7;
+  __pyx_t_7 = 0;
+
+  /* "fastavro/_read.pyx":73
+ *     writer_schema = named_schemas["writer"].get(writer_type)
+ *     reader_schema = named_schemas["reader"].get(reader_type)
+ *     if writer_schema is not None and reader_schema is not None:             # <<<<<<<<<<<<<<
+ *         return match_types(writer_schema, reader_schema, named_schemas)
+ *     return False
+ */
+  __pyx_t_2 = (__pyx_v_writer_schema != Py_None);
+  __pyx_t_3 = (__pyx_t_2 != 0);
+  if (__pyx_t_3) {
+  } else {
+    __pyx_t_1 = __pyx_t_3;
+    goto __pyx_L34_bool_binop_done;
+  }
+  __pyx_t_3 = (__pyx_v_reader_schema != Py_None);
+  __pyx_t_2 = (__pyx_t_3 != 0);
+  __pyx_t_1 = __pyx_t_2;
+  __pyx_L34_bool_binop_done:;
+  if (__pyx_t_1) {
+
+    /* "fastavro/_read.pyx":74
+ *     reader_schema = named_schemas["reader"].get(reader_type)
+ *     if writer_schema is not None and reader_schema is not None:
+ *         return match_types(writer_schema, reader_schema, named_schemas)             # <<<<<<<<<<<<<<
+ *     return False
+ * 
+ */
+    __Pyx_XDECREF(__pyx_r);
+    __pyx_t_7 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_writer_schema, __pyx_v_reader_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 74, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_7);
+    __pyx_r = __pyx_t_7;
+    __pyx_t_7 = 0;
+    goto __pyx_L0;
+
+    /* "fastavro/_read.pyx":73
+ *     writer_schema = named_schemas["writer"].get(writer_type)
+ *     reader_schema = named_schemas["reader"].get(reader_type)
+ *     if writer_schema is not None and reader_schema is not None:             # <<<<<<<<<<<<<<
+ *         return match_types(writer_schema, reader_schema, named_schemas)
+ *     return False
+ */
+  }
+
+  /* "fastavro/_read.pyx":75
+ *     if writer_schema is not None and reader_schema is not None:
+ *         return match_types(writer_schema, reader_schema, named_schemas)
  *     return False             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(Py_False);
   __pyx_r = Py_False;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":46
+  /* "fastavro/_read.pyx":50
  * 
  * 
- * cpdef match_types(writer_type, reader_type):             # <<<<<<<<<<<<<<
+ * cpdef match_types(writer_type, reader_type, named_schemas):             # <<<<<<<<<<<<<<
  *     if isinstance(writer_type, list) or isinstance(reader_type, list):
  *         return True
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_10);
   __Pyx_AddTraceback("fastavro._read.match_types", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
+  __Pyx_XDECREF(__pyx_v_writer_schema);
+  __Pyx_XDECREF(__pyx_v_reader_schema);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_1match_types(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_1match_types(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_3match_types(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_3match_types(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_writer_type = 0;
   PyObject *__pyx_v_reader_type = 0;
+  PyObject *__pyx_v_named_schemas = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("match_types (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_writer_type,&__pyx_n_s_reader_type,0};
-    PyObject* values[2] = {0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_writer_type,&__pyx_n_s_reader_type,&__pyx_n_s_named_schemas,0};
+    PyObject* values[3] = {0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
@@ -3047,54 +3259,62 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_type)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_type)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("match_types", 1, 2, 2, 1); __PYX_ERR(0, 46, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("match_types", 1, 3, 3, 1); __PYX_ERR(0, 50, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("match_types", 1, 3, 3, 2); __PYX_ERR(0, 50, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "match_types") < 0)) __PYX_ERR(0, 46, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "match_types") < 0)) __PYX_ERR(0, 50, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_writer_type = values[0];
     __pyx_v_reader_type = values[1];
+    __pyx_v_named_schemas = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("match_types", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 46, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("match_types", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 50, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.match_types", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_match_types(__pyx_self, __pyx_v_writer_type, __pyx_v_reader_type);
+  __pyx_r = __pyx_pf_8fastavro_5_read_2match_types(__pyx_self, __pyx_v_writer_type, __pyx_v_reader_type, __pyx_v_named_schemas);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_match_types(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_writer_type, PyObject *__pyx_v_reader_type) {
+static PyObject *__pyx_pf_8fastavro_5_read_2match_types(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_writer_type, PyObject *__pyx_v_reader_type, PyObject *__pyx_v_named_schemas) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("match_types", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_writer_type, __pyx_v_reader_type, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_writer_type, __pyx_v_reader_type, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 50, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -3103,24 +3323,24 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":70
+/* "fastavro/_read.pyx":78
  * 
  * 
- * cpdef match_schemas(w_schema, r_schema):             # <<<<<<<<<<<<<<
+ * cpdef match_schemas(w_schema, r_schema, named_schemas):             # <<<<<<<<<<<<<<
  *     error_msg = f"Schema mismatch: {w_schema} is not {r_schema}"
  *     if isinstance(w_schema, list):
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_3match_schemas(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_f_8fastavro_5_read_match_schemas(PyObject *__pyx_v_w_schema, PyObject *__pyx_v_r_schema, CYTHON_UNUSED int __pyx_skip_dispatch) {
+static PyObject *__pyx_pw_8fastavro_5_read_5match_schemas(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_f_8fastavro_5_read_match_schemas(PyObject *__pyx_v_w_schema, PyObject *__pyx_v_r_schema, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_v_error_msg = NULL;
   PyObject *__pyx_v_schema = NULL;
   PyObject *__pyx_v_w_type = NULL;
   PyObject *__pyx_v_r_type = NULL;
   PyObject *__pyx_v_w_unqual_name = NULL;
   PyObject *__pyx_v_r_unqual_name = NULL;
   PyObject *__pyx_r = NULL;
@@ -3139,568 +3359,568 @@
   int __pyx_t_12;
   PyObject *__pyx_t_13 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("match_schemas", 0);
 
-  /* "fastavro/_read.pyx":71
+  /* "fastavro/_read.pyx":79
  * 
- * cpdef match_schemas(w_schema, r_schema):
+ * cpdef match_schemas(w_schema, r_schema, named_schemas):
  *     error_msg = f"Schema mismatch: {w_schema} is not {r_schema}"             # <<<<<<<<<<<<<<
  *     if isinstance(w_schema, list):
  *         # If the writer is a union, checks will happen in read_union after the
  */
-  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 71, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_3 = 127;
   __Pyx_INCREF(__pyx_kp_u_Schema_mismatch);
   __pyx_t_2 += 17;
   __Pyx_GIVEREF(__pyx_kp_u_Schema_mismatch);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_Schema_mismatch);
-  __pyx_t_4 = __Pyx_PyObject_FormatSimple(__pyx_v_w_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 71, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_FormatSimple(__pyx_v_w_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 79, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u_is_not);
   __pyx_t_2 += 8;
   __Pyx_GIVEREF(__pyx_kp_u_is_not);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u_is_not);
-  __pyx_t_4 = __Pyx_PyObject_FormatSimple(__pyx_v_r_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 71, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_FormatSimple(__pyx_v_r_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 79, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_1, 4, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 71, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_1, 4, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 79, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_error_msg = ((PyObject*)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "fastavro/_read.pyx":72
- * cpdef match_schemas(w_schema, r_schema):
+  /* "fastavro/_read.pyx":80
+ * cpdef match_schemas(w_schema, r_schema, named_schemas):
  *     error_msg = f"Schema mismatch: {w_schema} is not {r_schema}"
  *     if isinstance(w_schema, list):             # <<<<<<<<<<<<<<
  *         # If the writer is a union, checks will happen in read_union after the
  *         # correct schema is known
  */
   __pyx_t_5 = PyList_Check(__pyx_v_w_schema); 
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
 
-    /* "fastavro/_read.pyx":75
+    /* "fastavro/_read.pyx":83
  *         # If the writer is a union, checks will happen in read_union after the
  *         # correct schema is known
  *         return r_schema             # <<<<<<<<<<<<<<
  *     elif isinstance(r_schema, list):
  *         # If the reader is a union, ensure one of the new schemas is the same
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_v_r_schema);
     __pyx_r = __pyx_v_r_schema;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":72
- * cpdef match_schemas(w_schema, r_schema):
+    /* "fastavro/_read.pyx":80
+ * cpdef match_schemas(w_schema, r_schema, named_schemas):
  *     error_msg = f"Schema mismatch: {w_schema} is not {r_schema}"
  *     if isinstance(w_schema, list):             # <<<<<<<<<<<<<<
  *         # If the writer is a union, checks will happen in read_union after the
  *         # correct schema is known
  */
   }
 
-  /* "fastavro/_read.pyx":76
+  /* "fastavro/_read.pyx":84
  *         # correct schema is known
  *         return r_schema
  *     elif isinstance(r_schema, list):             # <<<<<<<<<<<<<<
  *         # If the reader is a union, ensure one of the new schemas is the same
  *         # as the writer
  */
   __pyx_t_6 = PyList_Check(__pyx_v_r_schema); 
   __pyx_t_5 = (__pyx_t_6 != 0);
   if (__pyx_t_5) {
 
-    /* "fastavro/_read.pyx":79
+    /* "fastavro/_read.pyx":87
  *         # If the reader is a union, ensure one of the new schemas is the same
  *         # as the writer
  *         for schema in r_schema:             # <<<<<<<<<<<<<<
- *             if match_types(w_schema, schema):
+ *             if match_types(w_schema, schema, named_schemas):
  *                 return schema
  */
     if (likely(PyList_CheckExact(__pyx_v_r_schema)) || PyTuple_CheckExact(__pyx_v_r_schema)) {
       __pyx_t_4 = __pyx_v_r_schema; __Pyx_INCREF(__pyx_t_4); __pyx_t_2 = 0;
       __pyx_t_7 = NULL;
     } else {
-      __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_r_schema); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 79, __pyx_L1_error)
+      __pyx_t_2 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_v_r_schema); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 87, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_7 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 79, __pyx_L1_error)
+      __pyx_t_7 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 87, __pyx_L1_error)
     }
     for (;;) {
       if (likely(!__pyx_t_7)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 79, __pyx_L1_error)
+          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 87, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 87, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         } else {
           if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 79, __pyx_L1_error)
+          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_2); __Pyx_INCREF(__pyx_t_1); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 87, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 87, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         }
       } else {
         __pyx_t_1 = __pyx_t_7(__pyx_t_4);
         if (unlikely(!__pyx_t_1)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 79, __pyx_L1_error)
+            else __PYX_ERR(0, 87, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_1);
       }
       __Pyx_XDECREF_SET(__pyx_v_schema, __pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "fastavro/_read.pyx":80
+      /* "fastavro/_read.pyx":88
  *         # as the writer
  *         for schema in r_schema:
- *             if match_types(w_schema, schema):             # <<<<<<<<<<<<<<
+ *             if match_types(w_schema, schema, named_schemas):             # <<<<<<<<<<<<<<
  *                 return schema
  *         else:
  */
-      __pyx_t_1 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_w_schema, __pyx_v_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 80, __pyx_L1_error)
+      __pyx_t_1 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_w_schema, __pyx_v_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 88, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 80, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 88, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (__pyx_t_5) {
 
-        /* "fastavro/_read.pyx":81
+        /* "fastavro/_read.pyx":89
  *         for schema in r_schema:
- *             if match_types(w_schema, schema):
+ *             if match_types(w_schema, schema, named_schemas):
  *                 return schema             # <<<<<<<<<<<<<<
  *         else:
  *             raise SchemaResolutionError(error_msg)
  */
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_v_schema);
         __pyx_r = __pyx_v_schema;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         goto __pyx_L0;
 
-        /* "fastavro/_read.pyx":80
+        /* "fastavro/_read.pyx":88
  *         # as the writer
  *         for schema in r_schema:
- *             if match_types(w_schema, schema):             # <<<<<<<<<<<<<<
+ *             if match_types(w_schema, schema, named_schemas):             # <<<<<<<<<<<<<<
  *                 return schema
  *         else:
  */
       }
 
-      /* "fastavro/_read.pyx":79
+      /* "fastavro/_read.pyx":87
  *         # If the reader is a union, ensure one of the new schemas is the same
  *         # as the writer
  *         for schema in r_schema:             # <<<<<<<<<<<<<<
- *             if match_types(w_schema, schema):
+ *             if match_types(w_schema, schema, named_schemas):
  *                 return schema
  */
     }
     /*else*/ {
 
-      /* "fastavro/_read.pyx":83
+      /* "fastavro/_read.pyx":91
  *                 return schema
  *         else:
  *             raise SchemaResolutionError(error_msg)             # <<<<<<<<<<<<<<
  *     else:
  *         # Check for dicts as primitive types are just strings
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 83, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 91, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_9 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
         __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
         if (likely(__pyx_t_9)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
           __Pyx_INCREF(__pyx_t_9);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_8, function);
         }
       }
       __pyx_t_1 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_v_error_msg) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_error_msg);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 83, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_Raise(__pyx_t_1, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __PYX_ERR(0, 83, __pyx_L1_error)
+      __PYX_ERR(0, 91, __pyx_L1_error)
     }
 
-    /* "fastavro/_read.pyx":79
+    /* "fastavro/_read.pyx":87
  *         # If the reader is a union, ensure one of the new schemas is the same
  *         # as the writer
  *         for schema in r_schema:             # <<<<<<<<<<<<<<
- *             if match_types(w_schema, schema):
+ *             if match_types(w_schema, schema, named_schemas):
  *                 return schema
  */
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastavro/_read.pyx":76
+    /* "fastavro/_read.pyx":84
  *         # correct schema is known
  *         return r_schema
  *     elif isinstance(r_schema, list):             # <<<<<<<<<<<<<<
  *         # If the reader is a union, ensure one of the new schemas is the same
  *         # as the writer
  */
   }
 
-  /* "fastavro/_read.pyx":86
+  /* "fastavro/_read.pyx":94
  *     else:
  *         # Check for dicts as primitive types are just strings
  *         if isinstance(w_schema, dict):             # <<<<<<<<<<<<<<
  *             w_type = w_schema["type"]
  *         else:
  */
   /*else*/ {
     __pyx_t_5 = PyDict_Check(__pyx_v_w_schema); 
     __pyx_t_6 = (__pyx_t_5 != 0);
     if (__pyx_t_6) {
 
-      /* "fastavro/_read.pyx":87
+      /* "fastavro/_read.pyx":95
  *         # Check for dicts as primitive types are just strings
  *         if isinstance(w_schema, dict):
  *             w_type = w_schema["type"]             # <<<<<<<<<<<<<<
  *         else:
  *             w_type = w_schema
  */
-      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 87, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 95, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_v_w_type = __pyx_t_4;
       __pyx_t_4 = 0;
 
-      /* "fastavro/_read.pyx":86
+      /* "fastavro/_read.pyx":94
  *     else:
  *         # Check for dicts as primitive types are just strings
  *         if isinstance(w_schema, dict):             # <<<<<<<<<<<<<<
  *             w_type = w_schema["type"]
  *         else:
  */
       goto __pyx_L9;
     }
 
-    /* "fastavro/_read.pyx":89
+    /* "fastavro/_read.pyx":97
  *             w_type = w_schema["type"]
  *         else:
  *             w_type = w_schema             # <<<<<<<<<<<<<<
  *         if isinstance(r_schema, dict):
  *             r_type = r_schema["type"]
  */
     /*else*/ {
       __Pyx_INCREF(__pyx_v_w_schema);
       __pyx_v_w_type = __pyx_v_w_schema;
     }
     __pyx_L9:;
 
-    /* "fastavro/_read.pyx":90
+    /* "fastavro/_read.pyx":98
  *         else:
  *             w_type = w_schema
  *         if isinstance(r_schema, dict):             # <<<<<<<<<<<<<<
  *             r_type = r_schema["type"]
  *         else:
  */
     __pyx_t_6 = PyDict_Check(__pyx_v_r_schema); 
     __pyx_t_5 = (__pyx_t_6 != 0);
     if (__pyx_t_5) {
 
-      /* "fastavro/_read.pyx":91
+      /* "fastavro/_read.pyx":99
  *             w_type = w_schema
  *         if isinstance(r_schema, dict):
  *             r_type = r_schema["type"]             # <<<<<<<<<<<<<<
  *         else:
  *             r_type = r_schema
  */
-      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 91, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 99, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_v_r_type = __pyx_t_4;
       __pyx_t_4 = 0;
 
-      /* "fastavro/_read.pyx":90
+      /* "fastavro/_read.pyx":98
  *         else:
  *             w_type = w_schema
  *         if isinstance(r_schema, dict):             # <<<<<<<<<<<<<<
  *             r_type = r_schema["type"]
  *         else:
  */
       goto __pyx_L10;
     }
 
-    /* "fastavro/_read.pyx":93
+    /* "fastavro/_read.pyx":101
  *             r_type = r_schema["type"]
  *         else:
  *             r_type = r_schema             # <<<<<<<<<<<<<<
  * 
  *         if w_type == r_type == "map":
  */
     /*else*/ {
       __Pyx_INCREF(__pyx_v_r_schema);
       __pyx_v_r_type = __pyx_v_r_schema;
     }
     __pyx_L10:;
 
-    /* "fastavro/_read.pyx":95
+    /* "fastavro/_read.pyx":103
  *             r_type = r_schema
  * 
  *         if w_type == r_type == "map":             # <<<<<<<<<<<<<<
- *             if match_types(w_schema["values"], r_schema["values"]):
+ *             if match_types(w_schema["values"], r_schema["values"], named_schemas):
  *                 return r_schema
  */
-    __pyx_t_4 = PyObject_RichCompare(__pyx_v_w_type, __pyx_v_r_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 95, __pyx_L1_error)
+    __pyx_t_4 = PyObject_RichCompare(__pyx_v_w_type, __pyx_v_r_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)
     if (__Pyx_PyObject_IsTrue(__pyx_t_4)) {
       __Pyx_DECREF(__pyx_t_4);
-      __pyx_t_4 = PyObject_RichCompare(__pyx_v_r_type, __pyx_n_u_map, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 95, __pyx_L1_error)
+      __pyx_t_4 = PyObject_RichCompare(__pyx_v_r_type, __pyx_n_u_map, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)
     }
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 95, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 103, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     if (__pyx_t_5) {
 
-      /* "fastavro/_read.pyx":96
+      /* "fastavro/_read.pyx":104
  * 
  *         if w_type == r_type == "map":
- *             if match_types(w_schema["values"], r_schema["values"]):             # <<<<<<<<<<<<<<
+ *             if match_types(w_schema["values"], r_schema["values"], named_schemas):             # <<<<<<<<<<<<<<
  *                 return r_schema
  *         elif w_type == r_type == "array":
  */
-      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 96, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 104, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 96, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_8 = __pyx_f_8fastavro_5_read_match_types(__pyx_t_4, __pyx_t_1, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 96, __pyx_L1_error)
+      __pyx_t_8 = __pyx_f_8fastavro_5_read_match_types(__pyx_t_4, __pyx_t_1, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 104, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 96, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 104, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       if (__pyx_t_5) {
 
-        /* "fastavro/_read.pyx":97
+        /* "fastavro/_read.pyx":105
  *         if w_type == r_type == "map":
- *             if match_types(w_schema["values"], r_schema["values"]):
+ *             if match_types(w_schema["values"], r_schema["values"], named_schemas):
  *                 return r_schema             # <<<<<<<<<<<<<<
  *         elif w_type == r_type == "array":
- *             if match_types(w_schema["items"], r_schema["items"]):
+ *             if match_types(w_schema["items"], r_schema["items"], named_schemas):
  */
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_v_r_schema);
         __pyx_r = __pyx_v_r_schema;
         goto __pyx_L0;
 
-        /* "fastavro/_read.pyx":96
+        /* "fastavro/_read.pyx":104
  * 
  *         if w_type == r_type == "map":
- *             if match_types(w_schema["values"], r_schema["values"]):             # <<<<<<<<<<<<<<
+ *             if match_types(w_schema["values"], r_schema["values"], named_schemas):             # <<<<<<<<<<<<<<
  *                 return r_schema
  *         elif w_type == r_type == "array":
  */
       }
 
-      /* "fastavro/_read.pyx":95
+      /* "fastavro/_read.pyx":103
  *             r_type = r_schema
  * 
  *         if w_type == r_type == "map":             # <<<<<<<<<<<<<<
- *             if match_types(w_schema["values"], r_schema["values"]):
+ *             if match_types(w_schema["values"], r_schema["values"], named_schemas):
  *                 return r_schema
  */
       goto __pyx_L11;
     }
 
-    /* "fastavro/_read.pyx":98
- *             if match_types(w_schema["values"], r_schema["values"]):
+    /* "fastavro/_read.pyx":106
+ *             if match_types(w_schema["values"], r_schema["values"], named_schemas):
  *                 return r_schema
  *         elif w_type == r_type == "array":             # <<<<<<<<<<<<<<
- *             if match_types(w_schema["items"], r_schema["items"]):
+ *             if match_types(w_schema["items"], r_schema["items"], named_schemas):
  *                 return r_schema
  */
-    __pyx_t_8 = PyObject_RichCompare(__pyx_v_w_type, __pyx_v_r_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 98, __pyx_L1_error)
+    __pyx_t_8 = PyObject_RichCompare(__pyx_v_w_type, __pyx_v_r_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 106, __pyx_L1_error)
     if (__Pyx_PyObject_IsTrue(__pyx_t_8)) {
       __Pyx_DECREF(__pyx_t_8);
-      __pyx_t_8 = PyObject_RichCompare(__pyx_v_r_type, __pyx_n_u_array, Py_EQ); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 98, __pyx_L1_error)
+      __pyx_t_8 = PyObject_RichCompare(__pyx_v_r_type, __pyx_n_u_array, Py_EQ); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 106, __pyx_L1_error)
     }
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 98, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 106, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     if (__pyx_t_5) {
 
-      /* "fastavro/_read.pyx":99
+      /* "fastavro/_read.pyx":107
  *                 return r_schema
  *         elif w_type == r_type == "array":
- *             if match_types(w_schema["items"], r_schema["items"]):             # <<<<<<<<<<<<<<
+ *             if match_types(w_schema["items"], r_schema["items"], named_schemas):             # <<<<<<<<<<<<<<
  *                 return r_schema
  *         elif w_type in NAMED_TYPES and r_type in NAMED_TYPES:
  */
-      __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 99, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 107, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __pyx_f_8fastavro_5_read_match_types(__pyx_t_8, __pyx_t_1, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 99, __pyx_L1_error)
+      __pyx_t_4 = __pyx_f_8fastavro_5_read_match_types(__pyx_t_8, __pyx_t_1, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 107, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 99, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 107, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       if (__pyx_t_5) {
 
-        /* "fastavro/_read.pyx":100
+        /* "fastavro/_read.pyx":108
  *         elif w_type == r_type == "array":
- *             if match_types(w_schema["items"], r_schema["items"]):
+ *             if match_types(w_schema["items"], r_schema["items"], named_schemas):
  *                 return r_schema             # <<<<<<<<<<<<<<
  *         elif w_type in NAMED_TYPES and r_type in NAMED_TYPES:
  *             if w_type == r_type == "fixed" and w_schema["size"] != r_schema["size"]:
  */
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_v_r_schema);
         __pyx_r = __pyx_v_r_schema;
         goto __pyx_L0;
 
-        /* "fastavro/_read.pyx":99
+        /* "fastavro/_read.pyx":107
  *                 return r_schema
  *         elif w_type == r_type == "array":
- *             if match_types(w_schema["items"], r_schema["items"]):             # <<<<<<<<<<<<<<
+ *             if match_types(w_schema["items"], r_schema["items"], named_schemas):             # <<<<<<<<<<<<<<
  *                 return r_schema
  *         elif w_type in NAMED_TYPES and r_type in NAMED_TYPES:
  */
       }
 
-      /* "fastavro/_read.pyx":98
- *             if match_types(w_schema["values"], r_schema["values"]):
+      /* "fastavro/_read.pyx":106
+ *             if match_types(w_schema["values"], r_schema["values"], named_schemas):
  *                 return r_schema
  *         elif w_type == r_type == "array":             # <<<<<<<<<<<<<<
- *             if match_types(w_schema["items"], r_schema["items"]):
+ *             if match_types(w_schema["items"], r_schema["items"], named_schemas):
  *                 return r_schema
  */
       goto __pyx_L11;
     }
 
-    /* "fastavro/_read.pyx":101
- *             if match_types(w_schema["items"], r_schema["items"]):
+    /* "fastavro/_read.pyx":109
+ *             if match_types(w_schema["items"], r_schema["items"], named_schemas):
  *                 return r_schema
  *         elif w_type in NAMED_TYPES and r_type in NAMED_TYPES:             # <<<<<<<<<<<<<<
  *             if w_type == r_type == "fixed" and w_schema["size"] != r_schema["size"]:
  *                 raise SchemaResolutionError(
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_NAMED_TYPES); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 101, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_NAMED_TYPES); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_v_w_type, __pyx_t_4, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 101, __pyx_L1_error)
+    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_v_w_type, __pyx_t_4, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 109, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_10 = (__pyx_t_6 != 0);
     if (__pyx_t_10) {
     } else {
       __pyx_t_5 = __pyx_t_10;
       goto __pyx_L14_bool_binop_done;
     }
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_NAMED_TYPES); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 101, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_NAMED_TYPES); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 109, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_v_r_type, __pyx_t_4, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 101, __pyx_L1_error)
+    __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_v_r_type, __pyx_t_4, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 109, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_6 = (__pyx_t_10 != 0);
     __pyx_t_5 = __pyx_t_6;
     __pyx_L14_bool_binop_done:;
     if (__pyx_t_5) {
 
-      /* "fastavro/_read.pyx":102
+      /* "fastavro/_read.pyx":110
  *                 return r_schema
  *         elif w_type in NAMED_TYPES and r_type in NAMED_TYPES:
  *             if w_type == r_type == "fixed" and w_schema["size"] != r_schema["size"]:             # <<<<<<<<<<<<<<
  *                 raise SchemaResolutionError(
  *                     f"Schema mismatch: {w_schema} size is different than {r_schema} size"
  */
-      __pyx_t_4 = PyObject_RichCompare(__pyx_v_w_type, __pyx_v_r_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __pyx_t_4 = PyObject_RichCompare(__pyx_v_w_type, __pyx_v_r_type, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 110, __pyx_L1_error)
       if (__Pyx_PyObject_IsTrue(__pyx_t_4)) {
         __Pyx_DECREF(__pyx_t_4);
-        __pyx_t_4 = PyObject_RichCompare(__pyx_v_r_type, __pyx_n_u_fixed, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 102, __pyx_L1_error)
+        __pyx_t_4 = PyObject_RichCompare(__pyx_v_r_type, __pyx_n_u_fixed, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 110, __pyx_L1_error)
       }
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 110, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       if (__pyx_t_6) {
       } else {
         __pyx_t_5 = __pyx_t_6;
         goto __pyx_L17_bool_binop_done;
       }
-      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 110, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_8 = PyObject_RichCompare(__pyx_t_4, __pyx_t_1, Py_NE); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __pyx_t_8 = PyObject_RichCompare(__pyx_t_4, __pyx_t_1, Py_NE); __Pyx_XGOTREF(__pyx_t_8); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 110, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 102, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 110, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_5 = __pyx_t_6;
       __pyx_L17_bool_binop_done:;
       if (unlikely(__pyx_t_5)) {
 
-        /* "fastavro/_read.pyx":103
+        /* "fastavro/_read.pyx":111
  *         elif w_type in NAMED_TYPES and r_type in NAMED_TYPES:
  *             if w_type == r_type == "fixed" and w_schema["size"] != r_schema["size"]:
  *                 raise SchemaResolutionError(             # <<<<<<<<<<<<<<
  *                     f"Schema mismatch: {w_schema} size is different than {r_schema} size"
  *                 )
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 103, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
 
-        /* "fastavro/_read.pyx":104
+        /* "fastavro/_read.pyx":112
  *             if w_type == r_type == "fixed" and w_schema["size"] != r_schema["size"]:
  *                 raise SchemaResolutionError(
  *                     f"Schema mismatch: {w_schema} size is different than {r_schema} size"             # <<<<<<<<<<<<<<
  *                 )
  * 
  */
-        __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 104, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 112, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __pyx_t_2 = 0;
         __pyx_t_3 = 127;
         __Pyx_INCREF(__pyx_kp_u_Schema_mismatch);
         __pyx_t_2 += 17;
         __Pyx_GIVEREF(__pyx_kp_u_Schema_mismatch);
         PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_kp_u_Schema_mismatch);
-        __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_v_w_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 104, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_v_w_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 112, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) : __pyx_t_3;
         __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_9);
         __Pyx_GIVEREF(__pyx_t_9);
         PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_9);
         __pyx_t_9 = 0;
         __Pyx_INCREF(__pyx_kp_u_size_is_different_than);
         __pyx_t_2 += 24;
         __Pyx_GIVEREF(__pyx_kp_u_size_is_different_than);
         PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_kp_u_size_is_different_than);
-        __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_v_r_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 104, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_FormatSimple(__pyx_v_r_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 112, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_9) : __pyx_t_3;
         __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_9);
         __Pyx_GIVEREF(__pyx_t_9);
         PyTuple_SET_ITEM(__pyx_t_4, 3, __pyx_t_9);
         __pyx_t_9 = 0;
         __Pyx_INCREF(__pyx_kp_u_size_2);
         __pyx_t_2 += 5;
         __Pyx_GIVEREF(__pyx_kp_u_size_2);
         PyTuple_SET_ITEM(__pyx_t_4, 4, __pyx_kp_u_size_2);
-        __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_4, 5, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 104, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyUnicode_Join(__pyx_t_4, 5, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 112, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
           if (likely(__pyx_t_4)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -3708,124 +3928,124 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_1, function);
           }
         }
         __pyx_t_8 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_9);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-        if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 103, __pyx_L1_error)
+        if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 111, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_Raise(__pyx_t_8, 0, 0, 0);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __PYX_ERR(0, 103, __pyx_L1_error)
+        __PYX_ERR(0, 111, __pyx_L1_error)
 
-        /* "fastavro/_read.pyx":102
+        /* "fastavro/_read.pyx":110
  *                 return r_schema
  *         elif w_type in NAMED_TYPES and r_type in NAMED_TYPES:
  *             if w_type == r_type == "fixed" and w_schema["size"] != r_schema["size"]:             # <<<<<<<<<<<<<<
  *                 raise SchemaResolutionError(
  *                     f"Schema mismatch: {w_schema} size is different than {r_schema} size"
  */
       }
 
-      /* "fastavro/_read.pyx":107
+      /* "fastavro/_read.pyx":115
  *                 )
  * 
  *             w_unqual_name = w_schema["name"].split(".")[-1]             # <<<<<<<<<<<<<<
  *             r_unqual_name = r_schema["name"].split(".")[-1]
  *             if w_unqual_name == r_unqual_name or w_schema["name"] in r_schema.get(
  */
-      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 115, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 107, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_split); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 115, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_9))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_9);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
           __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_9, function);
         }
       }
       __pyx_t_8 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_1, __pyx_kp_u_) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_kp_u_);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 107, __pyx_L1_error)
+      if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 115, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_GetItemInt(__pyx_t_8, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 107, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_GetItemInt(__pyx_t_8, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 115, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_v_w_unqual_name = __pyx_t_9;
       __pyx_t_9 = 0;
 
-      /* "fastavro/_read.pyx":108
+      /* "fastavro/_read.pyx":116
  * 
  *             w_unqual_name = w_schema["name"].split(".")[-1]
  *             r_unqual_name = r_schema["name"].split(".")[-1]             # <<<<<<<<<<<<<<
  *             if w_unqual_name == r_unqual_name or w_schema["name"] in r_schema.get(
  *                 "aliases", []
  */
-      __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 108, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 116, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_8 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_8)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_8);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_9 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_8, __pyx_kp_u_) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_kp_u_);
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 108, __pyx_L1_error)
+      if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 116, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_9, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_9, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __pyx_v_r_unqual_name = __pyx_t_1;
       __pyx_t_1 = 0;
 
-      /* "fastavro/_read.pyx":109
+      /* "fastavro/_read.pyx":117
  *             w_unqual_name = w_schema["name"].split(".")[-1]
  *             r_unqual_name = r_schema["name"].split(".")[-1]
  *             if w_unqual_name == r_unqual_name or w_schema["name"] in r_schema.get(             # <<<<<<<<<<<<<<
  *                 "aliases", []
  *             ):
  */
-      __pyx_t_1 = PyObject_RichCompare(__pyx_v_w_unqual_name, __pyx_v_r_unqual_name, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 109, __pyx_L1_error)
+      __pyx_t_1 = PyObject_RichCompare(__pyx_v_w_unqual_name, __pyx_v_r_unqual_name, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 117, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (!__pyx_t_6) {
       } else {
         __pyx_t_5 = __pyx_t_6;
         goto __pyx_L20_bool_binop_done;
       }
-      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_w_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_r_schema, __pyx_n_s_get); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 109, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_r_schema, __pyx_n_s_get); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 117, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
 
-      /* "fastavro/_read.pyx":110
+      /* "fastavro/_read.pyx":118
  *             r_unqual_name = r_schema["name"].split(".")[-1]
  *             if w_unqual_name == r_unqual_name or w_schema["name"] in r_schema.get(
  *                 "aliases", []             # <<<<<<<<<<<<<<
  *             ):
  *                 return r_schema
  */
-      __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 110, __pyx_L1_error)
+      __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 118, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_11 = NULL;
       __pyx_t_12 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
         __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_8);
         if (likely(__pyx_t_11)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
@@ -3834,236 +4054,236 @@
           __Pyx_DECREF_SET(__pyx_t_8, function);
           __pyx_t_12 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_8)) {
         PyObject *__pyx_temp[3] = {__pyx_t_11, __pyx_n_u_aliases, __pyx_t_4};
-        __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 109, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 117, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_8)) {
         PyObject *__pyx_temp[3] = {__pyx_t_11, __pyx_n_u_aliases, __pyx_t_4};
-        __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 109, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_12, 2+__pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 117, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       {
-        __pyx_t_13 = PyTuple_New(2+__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 109, __pyx_L1_error)
+        __pyx_t_13 = PyTuple_New(2+__pyx_t_12); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 117, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_13);
         if (__pyx_t_11) {
           __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_13, 0, __pyx_t_11); __pyx_t_11 = NULL;
         }
         __Pyx_INCREF(__pyx_n_u_aliases);
         __Pyx_GIVEREF(__pyx_n_u_aliases);
         PyTuple_SET_ITEM(__pyx_t_13, 0+__pyx_t_12, __pyx_n_u_aliases);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_13, 1+__pyx_t_12, __pyx_t_4);
         __pyx_t_4 = 0;
-        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_13, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 109, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_13, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 117, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
         __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       }
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_t_9, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 109, __pyx_L1_error)
+      __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_t_9, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 117, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-      /* "fastavro/_read.pyx":109
+      /* "fastavro/_read.pyx":117
  *             w_unqual_name = w_schema["name"].split(".")[-1]
  *             r_unqual_name = r_schema["name"].split(".")[-1]
  *             if w_unqual_name == r_unqual_name or w_schema["name"] in r_schema.get(             # <<<<<<<<<<<<<<
  *                 "aliases", []
  *             ):
  */
       __pyx_t_10 = (__pyx_t_6 != 0);
       __pyx_t_5 = __pyx_t_10;
       __pyx_L20_bool_binop_done:;
       if (__pyx_t_5) {
 
-        /* "fastavro/_read.pyx":112
+        /* "fastavro/_read.pyx":120
  *                 "aliases", []
  *             ):
  *                 return r_schema             # <<<<<<<<<<<<<<
  *         elif w_type not in AVRO_TYPES and r_type in NAMED_TYPES:
- *             if match_types(w_type, r_schema["name"]):
+ *             if match_types(w_type, r_schema["name"], named_schemas):
  */
         __Pyx_XDECREF(__pyx_r);
         __Pyx_INCREF(__pyx_v_r_schema);
         __pyx_r = __pyx_v_r_schema;
         goto __pyx_L0;
 
-        /* "fastavro/_read.pyx":109
+        /* "fastavro/_read.pyx":117
  *             w_unqual_name = w_schema["name"].split(".")[-1]
  *             r_unqual_name = r_schema["name"].split(".")[-1]
  *             if w_unqual_name == r_unqual_name or w_schema["name"] in r_schema.get(             # <<<<<<<<<<<<<<
  *                 "aliases", []
  *             ):
  */
       }
 
-      /* "fastavro/_read.pyx":101
- *             if match_types(w_schema["items"], r_schema["items"]):
+      /* "fastavro/_read.pyx":109
+ *             if match_types(w_schema["items"], r_schema["items"], named_schemas):
  *                 return r_schema
  *         elif w_type in NAMED_TYPES and r_type in NAMED_TYPES:             # <<<<<<<<<<<<<<
  *             if w_type == r_type == "fixed" and w_schema["size"] != r_schema["size"]:
  *                 raise SchemaResolutionError(
  */
       goto __pyx_L11;
     }
 
-    /* "fastavro/_read.pyx":113
+    /* "fastavro/_read.pyx":121
  *             ):
  *                 return r_schema
  *         elif w_type not in AVRO_TYPES and r_type in NAMED_TYPES:             # <<<<<<<<<<<<<<
- *             if match_types(w_type, r_schema["name"]):
+ *             if match_types(w_type, r_schema["name"], named_schemas):
  *                 return r_schema["name"]
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_AVRO_TYPES); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 113, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_AVRO_TYPES); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 121, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_v_w_type, __pyx_t_9, Py_NE)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 113, __pyx_L1_error)
+    __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_v_w_type, __pyx_t_9, Py_NE)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 121, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_6 = (__pyx_t_10 != 0);
     if (__pyx_t_6) {
     } else {
       __pyx_t_5 = __pyx_t_6;
       goto __pyx_L22_bool_binop_done;
     }
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_NAMED_TYPES); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 113, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_NAMED_TYPES); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 121, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_v_r_type, __pyx_t_9, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 113, __pyx_L1_error)
+    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_v_r_type, __pyx_t_9, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 121, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __pyx_t_10 = (__pyx_t_6 != 0);
     __pyx_t_5 = __pyx_t_10;
     __pyx_L22_bool_binop_done:;
     if (__pyx_t_5) {
 
-      /* "fastavro/_read.pyx":114
+      /* "fastavro/_read.pyx":122
  *                 return r_schema
  *         elif w_type not in AVRO_TYPES and r_type in NAMED_TYPES:
- *             if match_types(w_type, r_schema["name"]):             # <<<<<<<<<<<<<<
+ *             if match_types(w_type, r_schema["name"], named_schemas):             # <<<<<<<<<<<<<<
  *                 return r_schema["name"]
- *         elif match_types(w_type, r_type):
+ *         elif match_types(w_type, r_type, named_schemas):
  */
-      __pyx_t_9 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 114, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 122, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_1 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_w_type, __pyx_t_9, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)
+      __pyx_t_1 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_w_type, __pyx_t_9, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 122, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 114, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 122, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (__pyx_t_5) {
 
-        /* "fastavro/_read.pyx":115
+        /* "fastavro/_read.pyx":123
  *         elif w_type not in AVRO_TYPES and r_type in NAMED_TYPES:
- *             if match_types(w_type, r_schema["name"]):
+ *             if match_types(w_type, r_schema["name"], named_schemas):
  *                 return r_schema["name"]             # <<<<<<<<<<<<<<
- *         elif match_types(w_type, r_type):
+ *         elif match_types(w_type, r_type, named_schemas):
  *             return r_schema
  */
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 115, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_r_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 123, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_r = __pyx_t_1;
         __pyx_t_1 = 0;
         goto __pyx_L0;
 
-        /* "fastavro/_read.pyx":114
+        /* "fastavro/_read.pyx":122
  *                 return r_schema
  *         elif w_type not in AVRO_TYPES and r_type in NAMED_TYPES:
- *             if match_types(w_type, r_schema["name"]):             # <<<<<<<<<<<<<<
+ *             if match_types(w_type, r_schema["name"], named_schemas):             # <<<<<<<<<<<<<<
  *                 return r_schema["name"]
- *         elif match_types(w_type, r_type):
+ *         elif match_types(w_type, r_type, named_schemas):
  */
       }
 
-      /* "fastavro/_read.pyx":113
+      /* "fastavro/_read.pyx":121
  *             ):
  *                 return r_schema
  *         elif w_type not in AVRO_TYPES and r_type in NAMED_TYPES:             # <<<<<<<<<<<<<<
- *             if match_types(w_type, r_schema["name"]):
+ *             if match_types(w_type, r_schema["name"], named_schemas):
  *                 return r_schema["name"]
  */
       goto __pyx_L11;
     }
 
-    /* "fastavro/_read.pyx":116
- *             if match_types(w_type, r_schema["name"]):
+    /* "fastavro/_read.pyx":124
+ *             if match_types(w_type, r_schema["name"], named_schemas):
  *                 return r_schema["name"]
- *         elif match_types(w_type, r_type):             # <<<<<<<<<<<<<<
+ *         elif match_types(w_type, r_type, named_schemas):             # <<<<<<<<<<<<<<
  *             return r_schema
  *         raise SchemaResolutionError(error_msg)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_w_type, __pyx_v_r_type, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_w_type, __pyx_v_r_type, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 116, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 124, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_5) {
 
-      /* "fastavro/_read.pyx":117
+      /* "fastavro/_read.pyx":125
  *                 return r_schema["name"]
- *         elif match_types(w_type, r_type):
+ *         elif match_types(w_type, r_type, named_schemas):
  *             return r_schema             # <<<<<<<<<<<<<<
  *         raise SchemaResolutionError(error_msg)
  * 
  */
       __Pyx_XDECREF(__pyx_r);
       __Pyx_INCREF(__pyx_v_r_schema);
       __pyx_r = __pyx_v_r_schema;
       goto __pyx_L0;
 
-      /* "fastavro/_read.pyx":116
- *             if match_types(w_type, r_schema["name"]):
+      /* "fastavro/_read.pyx":124
+ *             if match_types(w_type, r_schema["name"], named_schemas):
  *                 return r_schema["name"]
- *         elif match_types(w_type, r_type):             # <<<<<<<<<<<<<<
+ *         elif match_types(w_type, r_type, named_schemas):             # <<<<<<<<<<<<<<
  *             return r_schema
  *         raise SchemaResolutionError(error_msg)
  */
     }
     __pyx_L11:;
 
-    /* "fastavro/_read.pyx":118
- *         elif match_types(w_type, r_type):
+    /* "fastavro/_read.pyx":126
+ *         elif match_types(w_type, r_type, named_schemas):
  *             return r_schema
  *         raise SchemaResolutionError(error_msg)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 118, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 126, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_9);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_9, function);
       }
     }
     __pyx_t_1 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_8, __pyx_v_error_msg) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_v_error_msg);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 118, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 126, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 118, __pyx_L1_error)
+    __PYX_ERR(0, 126, __pyx_L1_error)
   }
 
-  /* "fastavro/_read.pyx":70
+  /* "fastavro/_read.pyx":78
  * 
  * 
- * cpdef match_schemas(w_schema, r_schema):             # <<<<<<<<<<<<<<
+ * cpdef match_schemas(w_schema, r_schema, named_schemas):             # <<<<<<<<<<<<<<
  *     error_msg = f"Schema mismatch: {w_schema} is not {r_schema}"
  *     if isinstance(w_schema, list):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -4083,31 +4303,34 @@
   __Pyx_XDECREF(__pyx_v_r_unqual_name);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_3match_schemas(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_3match_schemas(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_5match_schemas(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_5match_schemas(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_w_schema = 0;
   PyObject *__pyx_v_r_schema = 0;
+  PyObject *__pyx_v_named_schemas = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("match_schemas (wrapper)", 0);
   {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_w_schema,&__pyx_n_s_r_schema,0};
-    PyObject* values[2] = {0,0};
+    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_w_schema,&__pyx_n_s_r_schema,&__pyx_n_s_named_schemas,0};
+    PyObject* values[3] = {0,0,0};
     if (unlikely(__pyx_kwds)) {
       Py_ssize_t kw_args;
       const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
       switch (pos_args) {
+        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
+        CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         CYTHON_FALLTHROUGH;
         case  0: break;
         default: goto __pyx_L5_argtuple_error;
       }
@@ -4116,54 +4339,62 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_w_schema)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_r_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("match_schemas", 1, 2, 2, 1); __PYX_ERR(0, 70, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("match_schemas", 1, 3, 3, 1); __PYX_ERR(0, 78, __pyx_L3_error)
+        }
+        CYTHON_FALLTHROUGH;
+        case  2:
+        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
+        else {
+          __Pyx_RaiseArgtupleInvalid("match_schemas", 1, 3, 3, 2); __PYX_ERR(0, 78, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "match_schemas") < 0)) __PYX_ERR(0, 70, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "match_schemas") < 0)) __PYX_ERR(0, 78, __pyx_L3_error)
       }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
+    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
+      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_w_schema = values[0];
     __pyx_v_r_schema = values[1];
+    __pyx_v_named_schemas = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("match_schemas", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 70, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("match_schemas", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 78, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.match_schemas", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_2match_schemas(__pyx_self, __pyx_v_w_schema, __pyx_v_r_schema);
+  __pyx_r = __pyx_pf_8fastavro_5_read_4match_schemas(__pyx_self, __pyx_v_w_schema, __pyx_v_r_schema, __pyx_v_named_schemas);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_2match_schemas(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_w_schema, PyObject *__pyx_v_r_schema) {
+static PyObject *__pyx_pf_8fastavro_5_read_4match_schemas(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_w_schema, PyObject *__pyx_v_r_schema, PyObject *__pyx_v_named_schemas) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("match_schemas", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_match_schemas(__pyx_v_w_schema, __pyx_v_r_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 70, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_match_schemas(__pyx_v_w_schema, __pyx_v_r_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 78, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4172,40 +4403,40 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":121
+/* "fastavro/_read.pyx":129
  * 
  * 
  * cpdef inline read_null(fo):             # <<<<<<<<<<<<<<
  *     """null is written as zero bytes."""
  *     return None
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_5read_null(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_7read_null(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static CYTHON_INLINE PyObject *__pyx_f_8fastavro_5_read_read_null(CYTHON_UNUSED PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_null", 0);
 
-  /* "fastavro/_read.pyx":123
+  /* "fastavro/_read.pyx":131
  * cpdef inline read_null(fo):
  *     """null is written as zero bytes."""
  *     return None             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":121
+  /* "fastavro/_read.pyx":129
  * 
  * 
  * cpdef inline read_null(fo):             # <<<<<<<<<<<<<<
  *     """null is written as zero bytes."""
  *     return None
  */
 
@@ -4213,37 +4444,37 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_5read_null(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_4read_null[] = "null is written as zero bytes.";
-static PyObject *__pyx_pw_8fastavro_5_read_5read_null(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_7read_null(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_6read_null[] = "null is written as zero bytes.";
+static PyObject *__pyx_pw_8fastavro_5_read_7read_null(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_null (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_4read_null(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_6read_null(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_4read_null(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_6read_null(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_null", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_null(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_null(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 129, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4252,59 +4483,59 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":126
+/* "fastavro/_read.pyx":134
  * 
  * 
  * cpdef inline skip_null(fo):             # <<<<<<<<<<<<<<
  *     """null is written as zero bytes."""
  *     pass
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_7skip_null(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_9skip_null(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static CYTHON_INLINE PyObject *__pyx_f_8fastavro_5_read_skip_null(CYTHON_UNUSED PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("skip_null", 0);
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_7skip_null(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_6skip_null[] = "null is written as zero bytes.";
-static PyObject *__pyx_pw_8fastavro_5_read_7skip_null(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_9skip_null(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_8skip_null[] = "null is written as zero bytes.";
+static PyObject *__pyx_pw_8fastavro_5_read_9skip_null(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("skip_null (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_6skip_null(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_8skip_null(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_6skip_null(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_8skip_null(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_null", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_null(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 126, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_null(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4313,23 +4544,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":131
+/* "fastavro/_read.pyx":139
  * 
  * 
  * cpdef inline read_boolean(fo):             # <<<<<<<<<<<<<<
  *     """A boolean is written as a single byte whose value is either 0 (false) or
  *     1 (true).
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_9read_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_11read_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static CYTHON_INLINE PyObject *__pyx_f_8fastavro_5_read_read_boolean(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   unsigned char __pyx_v_ch_temp;
   PyObject *__pyx_v_bytes_temp = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
@@ -4338,110 +4569,110 @@
   int __pyx_t_5;
   char __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_boolean", 0);
 
-  /* "fastavro/_read.pyx":136
+  /* "fastavro/_read.pyx":144
  *     """
  *     cdef unsigned char ch_temp
  *     cdef bytes bytes_temp = fo.read(1)             # <<<<<<<<<<<<<<
  *     if len(bytes_temp) == 1:
  *         # technically 0x01 == true and 0x00 == false, but many languages will
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 136, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 144, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_int_1);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 136, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 136, __pyx_L1_error)
+  if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 144, __pyx_L1_error)
   __pyx_v_bytes_temp = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":137
+  /* "fastavro/_read.pyx":145
  *     cdef unsigned char ch_temp
  *     cdef bytes bytes_temp = fo.read(1)
  *     if len(bytes_temp) == 1:             # <<<<<<<<<<<<<<
  *         # technically 0x01 == true and 0x00 == false, but many languages will
  *         # cast anything other than 0 to True and only 0 to False
  */
   if (unlikely(__pyx_v_bytes_temp == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(0, 137, __pyx_L1_error)
+    __PYX_ERR(0, 145, __pyx_L1_error)
   }
-  __pyx_t_4 = PyBytes_GET_SIZE(__pyx_v_bytes_temp); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 137, __pyx_L1_error)
+  __pyx_t_4 = PyBytes_GET_SIZE(__pyx_v_bytes_temp); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 145, __pyx_L1_error)
   __pyx_t_5 = ((__pyx_t_4 == 1) != 0);
   if (likely(__pyx_t_5)) {
 
-    /* "fastavro/_read.pyx":140
+    /* "fastavro/_read.pyx":148
  *         # technically 0x01 == true and 0x00 == false, but many languages will
  *         # cast anything other than 0 to True and only 0 to False
  *         ch_temp = bytes_temp[0]             # <<<<<<<<<<<<<<
  *         return ch_temp != 0
  *     else:
  */
     if (unlikely(__pyx_v_bytes_temp == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 140, __pyx_L1_error)
+      __PYX_ERR(0, 148, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_PyBytes_GetItemInt(__pyx_v_bytes_temp, 0, 1); if (unlikely(__pyx_t_6 == ((char)((char)-1)) && PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyBytes_GetItemInt(__pyx_v_bytes_temp, 0, 1); if (unlikely(__pyx_t_6 == ((char)((char)-1)) && PyErr_Occurred())) __PYX_ERR(0, 148, __pyx_L1_error)
     __pyx_v_ch_temp = __pyx_t_6;
 
-    /* "fastavro/_read.pyx":141
+    /* "fastavro/_read.pyx":149
  *         # cast anything other than 0 to True and only 0 to False
  *         ch_temp = bytes_temp[0]
  *         return ch_temp != 0             # <<<<<<<<<<<<<<
  *     else:
  *         raise ReadError
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_v_ch_temp != 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 141, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyBool_FromLong((__pyx_v_ch_temp != 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":137
+    /* "fastavro/_read.pyx":145
  *     cdef unsigned char ch_temp
  *     cdef bytes bytes_temp = fo.read(1)
  *     if len(bytes_temp) == 1:             # <<<<<<<<<<<<<<
  *         # technically 0x01 == true and 0x00 == false, but many languages will
  *         # cast anything other than 0 to True and only 0 to False
  */
   }
 
-  /* "fastavro/_read.pyx":143
+  /* "fastavro/_read.pyx":151
  *         return ch_temp != 0
  *     else:
  *         raise ReadError             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_ReadError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 143, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_ReadError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 143, __pyx_L1_error)
+    __PYX_ERR(0, 151, __pyx_L1_error)
   }
 
-  /* "fastavro/_read.pyx":131
+  /* "fastavro/_read.pyx":139
  * 
  * 
  * cpdef inline read_boolean(fo):             # <<<<<<<<<<<<<<
  *     """A boolean is written as a single byte whose value is either 0 (false) or
  *     1 (true).
  */
 
@@ -4456,37 +4687,37 @@
   __Pyx_XDECREF(__pyx_v_bytes_temp);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_9read_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_8read_boolean[] = "A boolean is written as a single byte whose value is either 0 (false) or\n    1 (true).\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_9read_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_11read_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_10read_boolean[] = "A boolean is written as a single byte whose value is either 0 (false) or\n    1 (true).\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_11read_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_boolean (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_8read_boolean(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_10read_boolean(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_8read_boolean(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_10read_boolean(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_boolean", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_boolean(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 131, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_boolean(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4495,61 +4726,61 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":146
+/* "fastavro/_read.pyx":154
  * 
  * 
  * cpdef inline skip_boolean(fo):             # <<<<<<<<<<<<<<
  *     """A boolean is written as a single byte whose value is either 0 (false) or
  *     1 (true).
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_11skip_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_13skip_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static CYTHON_INLINE PyObject *__pyx_f_8fastavro_5_read_skip_boolean(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_boolean", 0);
 
-  /* "fastavro/_read.pyx":150
+  /* "fastavro/_read.pyx":158
  *     1 (true).
  *     """
  *     fo.read(1)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 150, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 158, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_int_1);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 150, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 158, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":146
+  /* "fastavro/_read.pyx":154
  * 
  * 
  * cpdef inline skip_boolean(fo):             # <<<<<<<<<<<<<<
  *     """A boolean is written as a single byte whose value is either 0 (false) or
  *     1 (true).
  */
 
@@ -4565,37 +4796,37 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_11skip_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_10skip_boolean[] = "A boolean is written as a single byte whose value is either 0 (false) or\n    1 (true).\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_11skip_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_13skip_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_12skip_boolean[] = "A boolean is written as a single byte whose value is either 0 (false) or\n    1 (true).\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_13skip_boolean(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("skip_boolean (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_10skip_boolean(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_12skip_boolean(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_10skip_boolean(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_12skip_boolean(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_boolean", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_boolean(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 146, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_boolean(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4604,23 +4835,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":153
+/* "fastavro/_read.pyx":161
  * 
  * 
  * cpdef long64 read_long(fo) except? -1:             # <<<<<<<<<<<<<<
  *     """int and long values are written using variable-length, zig-zag
  *     coding."""
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_13read_long(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_15read_long(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static __pyx_t_8fastavro_5_read_long64 __pyx_f_8fastavro_5_read_read_long(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __pyx_t_8fastavro_5_read_ulong64 __pyx_v_b;
   __pyx_t_8fastavro_5_read_ulong64 __pyx_v_n;
   __pyx_t_8fastavro_5_read_int32 __pyx_v_shift;
   PyObject *__pyx_v_c = 0;
   __pyx_t_8fastavro_5_read_long64 __pyx_r;
   __Pyx_RefNannyDeclarations
@@ -4631,187 +4862,187 @@
   int __pyx_t_5;
   char __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_long", 0);
 
-  /* "fastavro/_read.pyx":159
+  /* "fastavro/_read.pyx":167
  *     cdef ulong64 n
  *     cdef int32 shift
  *     cdef bytes c = fo.read(1)             # <<<<<<<<<<<<<<
  * 
  *     # We do EOF checking only here, since most reader start here
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 159, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 167, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_int_1);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 159, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 167, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 159, __pyx_L1_error)
+  if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 167, __pyx_L1_error)
   __pyx_v_c = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":162
+  /* "fastavro/_read.pyx":170
  * 
  *     # We do EOF checking only here, since most reader start here
  *     if not c:             # <<<<<<<<<<<<<<
  *         raise StopIteration
  * 
  */
   __pyx_t_4 = (__pyx_v_c != Py_None)&&(PyBytes_GET_SIZE(__pyx_v_c) != 0);
   __pyx_t_5 = ((!__pyx_t_4) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "fastavro/_read.pyx":163
+    /* "fastavro/_read.pyx":171
  *     # We do EOF checking only here, since most reader start here
  *     if not c:
  *         raise StopIteration             # <<<<<<<<<<<<<<
  * 
  *     b = <unsigned char>(c[0])
  */
     __Pyx_Raise(__pyx_builtin_StopIteration, 0, 0, 0);
-    __PYX_ERR(0, 163, __pyx_L1_error)
+    __PYX_ERR(0, 171, __pyx_L1_error)
 
-    /* "fastavro/_read.pyx":162
+    /* "fastavro/_read.pyx":170
  * 
  *     # We do EOF checking only here, since most reader start here
  *     if not c:             # <<<<<<<<<<<<<<
  *         raise StopIteration
  * 
  */
   }
 
-  /* "fastavro/_read.pyx":165
+  /* "fastavro/_read.pyx":173
  *         raise StopIteration
  * 
  *     b = <unsigned char>(c[0])             # <<<<<<<<<<<<<<
  *     n = b & 0x7F
  *     shift = 7
  */
   if (unlikely(__pyx_v_c == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-    __PYX_ERR(0, 165, __pyx_L1_error)
+    __PYX_ERR(0, 173, __pyx_L1_error)
   }
-  __pyx_t_6 = __Pyx_PyBytes_GetItemInt(__pyx_v_c, 0, 1); if (unlikely(__pyx_t_6 == ((char)((char)-1)) && PyErr_Occurred())) __PYX_ERR(0, 165, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyBytes_GetItemInt(__pyx_v_c, 0, 1); if (unlikely(__pyx_t_6 == ((char)((char)-1)) && PyErr_Occurred())) __PYX_ERR(0, 173, __pyx_L1_error)
   __pyx_v_b = ((unsigned char)__pyx_t_6);
 
-  /* "fastavro/_read.pyx":166
+  /* "fastavro/_read.pyx":174
  * 
  *     b = <unsigned char>(c[0])
  *     n = b & 0x7F             # <<<<<<<<<<<<<<
  *     shift = 7
  * 
  */
   __pyx_v_n = (__pyx_v_b & 0x7F);
 
-  /* "fastavro/_read.pyx":167
+  /* "fastavro/_read.pyx":175
  *     b = <unsigned char>(c[0])
  *     n = b & 0x7F
  *     shift = 7             # <<<<<<<<<<<<<<
  * 
  *     while (b & 0x80) != 0:
  */
   __pyx_v_shift = 7;
 
-  /* "fastavro/_read.pyx":169
+  /* "fastavro/_read.pyx":177
  *     shift = 7
  * 
  *     while (b & 0x80) != 0:             # <<<<<<<<<<<<<<
  *         c = fo.read(1)
  *         b = <unsigned char>(c[0])
  */
   while (1) {
     __pyx_t_5 = (((__pyx_v_b & 0x80) != 0) != 0);
     if (!__pyx_t_5) break;
 
-    /* "fastavro/_read.pyx":170
+    /* "fastavro/_read.pyx":178
  * 
  *     while (b & 0x80) != 0:
  *         c = fo.read(1)             # <<<<<<<<<<<<<<
  *         b = <unsigned char>(c[0])
  *         n |= (b & 0x7F) << shift
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 170, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 178, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_int_1);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 170, __pyx_L1_error)
+    if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 178, __pyx_L1_error)
     __Pyx_DECREF_SET(__pyx_v_c, ((PyObject*)__pyx_t_1));
     __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":171
+    /* "fastavro/_read.pyx":179
  *     while (b & 0x80) != 0:
  *         c = fo.read(1)
  *         b = <unsigned char>(c[0])             # <<<<<<<<<<<<<<
  *         n |= (b & 0x7F) << shift
  *         shift += 7
  */
     if (unlikely(__pyx_v_c == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 171, __pyx_L1_error)
+      __PYX_ERR(0, 179, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_PyBytes_GetItemInt(__pyx_v_c, 0, 1); if (unlikely(__pyx_t_6 == ((char)((char)-1)) && PyErr_Occurred())) __PYX_ERR(0, 171, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyBytes_GetItemInt(__pyx_v_c, 0, 1); if (unlikely(__pyx_t_6 == ((char)((char)-1)) && PyErr_Occurred())) __PYX_ERR(0, 179, __pyx_L1_error)
     __pyx_v_b = ((unsigned char)__pyx_t_6);
 
-    /* "fastavro/_read.pyx":172
+    /* "fastavro/_read.pyx":180
  *         c = fo.read(1)
  *         b = <unsigned char>(c[0])
  *         n |= (b & 0x7F) << shift             # <<<<<<<<<<<<<<
  *         shift += 7
  * 
  */
     __pyx_v_n = (__pyx_v_n | ((__pyx_v_b & 0x7F) << __pyx_v_shift));
 
-    /* "fastavro/_read.pyx":173
+    /* "fastavro/_read.pyx":181
  *         b = <unsigned char>(c[0])
  *         n |= (b & 0x7F) << shift
  *         shift += 7             # <<<<<<<<<<<<<<
  * 
  *     return (n >> 1) ^ -(n & 1)
  */
     __pyx_v_shift = (__pyx_v_shift + 7);
   }
 
-  /* "fastavro/_read.pyx":175
+  /* "fastavro/_read.pyx":183
  *         shift += 7
  * 
  *     return (n >> 1) ^ -(n & 1)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_r = ((__pyx_v_n >> 1) ^ (-(__pyx_v_n & 1)));
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":153
+  /* "fastavro/_read.pyx":161
  * 
  * 
  * cpdef long64 read_long(fo) except? -1:             # <<<<<<<<<<<<<<
  *     """int and long values are written using variable-length, zig-zag
  *     coding."""
  */
 
@@ -4825,39 +5056,39 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_c);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_13read_long(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_12read_long[] = "int and long values are written using variable-length, zig-zag\n    coding.";
-static PyObject *__pyx_pw_8fastavro_5_read_13read_long(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_15read_long(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_14read_long[] = "int and long values are written using variable-length, zig-zag\n    coding.";
+static PyObject *__pyx_pw_8fastavro_5_read_15read_long(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_long (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_12read_long(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_14read_long(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_12read_long(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_14read_long(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_long", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 153, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 153, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 161, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 161, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4866,23 +5097,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":178
+/* "fastavro/_read.pyx":186
  * 
  * 
  * cpdef skip_long(fo):             # <<<<<<<<<<<<<<
  *     """int and long values are written using variable-length, zig-zag
  *     coding."""
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_15skip_long(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_17skip_long(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_long(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __pyx_t_8fastavro_5_read_ulong64 __pyx_v_b;
   PyObject *__pyx_v_c = 0;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
@@ -4890,111 +5121,111 @@
   char __pyx_t_4;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_long", 0);
 
-  /* "fastavro/_read.pyx":182
+  /* "fastavro/_read.pyx":190
  *     coding."""
  *     cdef ulong64 b
  *     cdef bytes c = fo.read(1)             # <<<<<<<<<<<<<<
  * 
  *     b = <unsigned char>(c[0])
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 182, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 190, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_int_1);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 182, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 190, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 182, __pyx_L1_error)
+  if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 190, __pyx_L1_error)
   __pyx_v_c = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":184
+  /* "fastavro/_read.pyx":192
  *     cdef bytes c = fo.read(1)
  * 
  *     b = <unsigned char>(c[0])             # <<<<<<<<<<<<<<
  * 
  *     while (b & 0x80) != 0:
  */
   if (unlikely(__pyx_v_c == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-    __PYX_ERR(0, 184, __pyx_L1_error)
+    __PYX_ERR(0, 192, __pyx_L1_error)
   }
-  __pyx_t_4 = __Pyx_PyBytes_GetItemInt(__pyx_v_c, 0, 1); if (unlikely(__pyx_t_4 == ((char)((char)-1)) && PyErr_Occurred())) __PYX_ERR(0, 184, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyBytes_GetItemInt(__pyx_v_c, 0, 1); if (unlikely(__pyx_t_4 == ((char)((char)-1)) && PyErr_Occurred())) __PYX_ERR(0, 192, __pyx_L1_error)
   __pyx_v_b = ((unsigned char)__pyx_t_4);
 
-  /* "fastavro/_read.pyx":186
+  /* "fastavro/_read.pyx":194
  *     b = <unsigned char>(c[0])
  * 
  *     while (b & 0x80) != 0:             # <<<<<<<<<<<<<<
  *         c = fo.read(1)
  *         b = <unsigned char>(c[0])
  */
   while (1) {
     __pyx_t_5 = (((__pyx_v_b & 0x80) != 0) != 0);
     if (!__pyx_t_5) break;
 
-    /* "fastavro/_read.pyx":187
+    /* "fastavro/_read.pyx":195
  * 
  *     while (b & 0x80) != 0:
  *         c = fo.read(1)             # <<<<<<<<<<<<<<
  *         b = <unsigned char>(c[0])
  * 
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 187, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 195, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_int_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_int_1);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 187, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 195, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 187, __pyx_L1_error)
+    if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 195, __pyx_L1_error)
     __Pyx_DECREF_SET(__pyx_v_c, ((PyObject*)__pyx_t_1));
     __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":188
+    /* "fastavro/_read.pyx":196
  *     while (b & 0x80) != 0:
  *         c = fo.read(1)
  *         b = <unsigned char>(c[0])             # <<<<<<<<<<<<<<
  * 
  * 
  */
     if (unlikely(__pyx_v_c == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
-      __PYX_ERR(0, 188, __pyx_L1_error)
+      __PYX_ERR(0, 196, __pyx_L1_error)
     }
-    __pyx_t_4 = __Pyx_PyBytes_GetItemInt(__pyx_v_c, 0, 1); if (unlikely(__pyx_t_4 == ((char)((char)-1)) && PyErr_Occurred())) __PYX_ERR(0, 188, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyBytes_GetItemInt(__pyx_v_c, 0, 1); if (unlikely(__pyx_t_4 == ((char)((char)-1)) && PyErr_Occurred())) __PYX_ERR(0, 196, __pyx_L1_error)
     __pyx_v_b = ((unsigned char)__pyx_t_4);
   }
 
-  /* "fastavro/_read.pyx":178
+  /* "fastavro/_read.pyx":186
  * 
  * 
  * cpdef skip_long(fo):             # <<<<<<<<<<<<<<
  *     """int and long values are written using variable-length, zig-zag
  *     coding."""
  */
 
@@ -5011,37 +5242,37 @@
   __Pyx_XDECREF(__pyx_v_c);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_15skip_long(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_14skip_long[] = "int and long values are written using variable-length, zig-zag\n    coding.";
-static PyObject *__pyx_pw_8fastavro_5_read_15skip_long(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_17skip_long(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_16skip_long[] = "int and long values are written using variable-length, zig-zag\n    coding.";
+static PyObject *__pyx_pw_8fastavro_5_read_17skip_long(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("skip_long (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_14skip_long(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_16skip_long(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_14skip_long(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_16skip_long(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_long", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_long(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_long(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 186, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5050,44 +5281,44 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":191
+/* "fastavro/_read.pyx":199
  * 
  * 
  * cpdef skip_int(fo):             # <<<<<<<<<<<<<<
  *     skip_long(fo)
  * 
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_17skip_int(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_19skip_int(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_int(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_int", 0);
 
-  /* "fastavro/_read.pyx":192
+  /* "fastavro/_read.pyx":200
  * 
  * cpdef skip_int(fo):
  *     skip_long(fo)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_long(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 192, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_long(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":191
+  /* "fastavro/_read.pyx":199
  * 
  * 
  * cpdef skip_int(fo):             # <<<<<<<<<<<<<<
  *     skip_long(fo)
  * 
  */
 
@@ -5101,36 +5332,36 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_17skip_int(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_17skip_int(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_19skip_int(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_19skip_int(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("skip_int (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_16skip_int(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_18skip_int(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_16skip_int(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_18skip_int(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_int", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_int(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 191, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_int(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5139,23 +5370,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":200
+/* "fastavro/_read.pyx":208
  * 
  * 
  * cpdef read_float(fo):             # <<<<<<<<<<<<<<
  *     """A float is written as 4 bytes.
  * 
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_19read_float(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_21read_float(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_read_float(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_v_data = 0;
   unsigned char __pyx_v_ch_data[4];
   union __pyx_t_8fastavro_5_read_float_uint32 __pyx_v_fi;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
@@ -5165,119 +5396,119 @@
   int __pyx_t_5;
   unsigned char *__pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_float", 0);
 
-  /* "fastavro/_read.pyx":209
+  /* "fastavro/_read.pyx":217
  *     cdef unsigned char ch_data[4]
  *     cdef float_uint32 fi
  *     data = fo.read(4)             # <<<<<<<<<<<<<<
  *     if len(data) == 4:
  *         ch_data[:4] = data
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 209, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 217, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_int_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_int_4);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 209, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 217, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 209, __pyx_L1_error)
+  if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 217, __pyx_L1_error)
   __pyx_v_data = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":210
+  /* "fastavro/_read.pyx":218
  *     cdef float_uint32 fi
  *     data = fo.read(4)
  *     if len(data) == 4:             # <<<<<<<<<<<<<<
  *         ch_data[:4] = data
  *         fi.n = (ch_data[0]
  */
   if (unlikely(__pyx_v_data == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(0, 210, __pyx_L1_error)
+    __PYX_ERR(0, 218, __pyx_L1_error)
   }
-  __pyx_t_4 = PyBytes_GET_SIZE(__pyx_v_data); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 210, __pyx_L1_error)
+  __pyx_t_4 = PyBytes_GET_SIZE(__pyx_v_data); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 218, __pyx_L1_error)
   __pyx_t_5 = ((__pyx_t_4 == 4) != 0);
   if (likely(__pyx_t_5)) {
 
-    /* "fastavro/_read.pyx":211
+    /* "fastavro/_read.pyx":219
  *     data = fo.read(4)
  *     if len(data) == 4:
  *         ch_data[:4] = data             # <<<<<<<<<<<<<<
  *         fi.n = (ch_data[0]
  *                 | (ch_data[1] << 8)
  */
     if (unlikely(__pyx_v_data == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-      __PYX_ERR(0, 211, __pyx_L1_error)
+      __PYX_ERR(0, 219, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_PyBytes_AsWritableUString(__pyx_v_data); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) __PYX_ERR(0, 211, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyBytes_AsWritableUString(__pyx_v_data); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) __PYX_ERR(0, 219, __pyx_L1_error)
     memcpy(&(__pyx_v_ch_data[0]), __pyx_t_6, sizeof(__pyx_v_ch_data[0]) * (4 - 0));
 
-    /* "fastavro/_read.pyx":212
+    /* "fastavro/_read.pyx":220
  *     if len(data) == 4:
  *         ch_data[:4] = data
  *         fi.n = (ch_data[0]             # <<<<<<<<<<<<<<
  *                 | (ch_data[1] << 8)
  *                 | (ch_data[2] << 16)
  */
     __pyx_v_fi.n = ((((__pyx_v_ch_data[0]) | ((__pyx_v_ch_data[1]) << 8)) | ((__pyx_v_ch_data[2]) << 16)) | ((__pyx_v_ch_data[3]) << 24));
 
-    /* "fastavro/_read.pyx":216
+    /* "fastavro/_read.pyx":224
  *                 | (ch_data[2] << 16)
  *                 | (ch_data[3] << 24))
  *         return fi.f             # <<<<<<<<<<<<<<
  *     else:
  *         raise ReadError
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_fi.f); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 216, __pyx_L1_error)
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_fi.f); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":210
+    /* "fastavro/_read.pyx":218
  *     cdef float_uint32 fi
  *     data = fo.read(4)
  *     if len(data) == 4:             # <<<<<<<<<<<<<<
  *         ch_data[:4] = data
  *         fi.n = (ch_data[0]
  */
   }
 
-  /* "fastavro/_read.pyx":218
+  /* "fastavro/_read.pyx":226
  *         return fi.f
  *     else:
  *         raise ReadError             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_ReadError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 218, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_ReadError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 218, __pyx_L1_error)
+    __PYX_ERR(0, 226, __pyx_L1_error)
   }
 
-  /* "fastavro/_read.pyx":200
+  /* "fastavro/_read.pyx":208
  * 
  * 
  * cpdef read_float(fo):             # <<<<<<<<<<<<<<
  *     """A float is written as 4 bytes.
  * 
  */
 
@@ -5292,37 +5523,37 @@
   __Pyx_XDECREF(__pyx_v_data);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_19read_float(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_18read_float[] = "A float is written as 4 bytes.\n\n    The float is converted into a 32-bit integer using a method equivalent to\n    Java's floatToIntBits and then encoded in little-endian format.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_19read_float(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_21read_float(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_20read_float[] = "A float is written as 4 bytes.\n\n    The float is converted into a 32-bit integer using a method equivalent to\n    Java's floatToIntBits and then encoded in little-endian format.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_21read_float(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_float (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_18read_float(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_20read_float(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_18read_float(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_20read_float(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_float", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_float(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 200, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_float(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5331,61 +5562,61 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":221
+/* "fastavro/_read.pyx":229
  * 
  * 
  * cpdef skip_float(fo):             # <<<<<<<<<<<<<<
  *     """A float is written as 4 bytes.
  * 
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_21skip_float(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_23skip_float(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_float(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_float", 0);
 
-  /* "fastavro/_read.pyx":227
+  /* "fastavro/_read.pyx":235
  *     Java's floatToIntBits and then encoded in little-endian format.
  *     """
  *     fo.read(4)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 227, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_int_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_int_4);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 227, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":221
+  /* "fastavro/_read.pyx":229
  * 
  * 
  * cpdef skip_float(fo):             # <<<<<<<<<<<<<<
  *     """A float is written as 4 bytes.
  * 
  */
 
@@ -5401,37 +5632,37 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_21skip_float(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_20skip_float[] = "A float is written as 4 bytes.\n\n    The float is converted into a 32-bit integer using a method equivalent to\n    Java's floatToIntBits and then encoded in little-endian format.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_21skip_float(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_23skip_float(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_22skip_float[] = "A float is written as 4 bytes.\n\n    The float is converted into a 32-bit integer using a method equivalent to\n    Java's floatToIntBits and then encoded in little-endian format.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_23skip_float(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("skip_float (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_20skip_float(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_22skip_float(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_20skip_float(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_22skip_float(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_float", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_float(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 221, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_float(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 229, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5440,23 +5671,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":235
+/* "fastavro/_read.pyx":243
  * 
  * 
  * cpdef read_double(fo):             # <<<<<<<<<<<<<<
  *     """A double is written as 8 bytes.
  * 
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_23read_double(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_25read_double(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_read_double(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_v_data = 0;
   unsigned char __pyx_v_ch_data[8];
   union __pyx_t_8fastavro_5_read_double_ulong64 __pyx_v_dl;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
@@ -5466,119 +5697,119 @@
   int __pyx_t_5;
   unsigned char *__pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_double", 0);
 
-  /* "fastavro/_read.pyx":244
+  /* "fastavro/_read.pyx":252
  *     cdef unsigned char ch_data[8]
  *     cdef double_ulong64 dl
  *     data = fo.read(8)             # <<<<<<<<<<<<<<
  *     if len(data) == 8:
  *         ch_data[:8] = data
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 244, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 252, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_int_8) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_int_8);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 252, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 244, __pyx_L1_error)
+  if (!(likely(PyBytes_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "bytes", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 252, __pyx_L1_error)
   __pyx_v_data = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":245
+  /* "fastavro/_read.pyx":253
  *     cdef double_ulong64 dl
  *     data = fo.read(8)
  *     if len(data) == 8:             # <<<<<<<<<<<<<<
  *         ch_data[:8] = data
  *         dl.n = (ch_data[0]
  */
   if (unlikely(__pyx_v_data == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "object of type 'NoneType' has no len()");
-    __PYX_ERR(0, 245, __pyx_L1_error)
+    __PYX_ERR(0, 253, __pyx_L1_error)
   }
-  __pyx_t_4 = PyBytes_GET_SIZE(__pyx_v_data); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 245, __pyx_L1_error)
+  __pyx_t_4 = PyBytes_GET_SIZE(__pyx_v_data); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 253, __pyx_L1_error)
   __pyx_t_5 = ((__pyx_t_4 == 8) != 0);
   if (likely(__pyx_t_5)) {
 
-    /* "fastavro/_read.pyx":246
+    /* "fastavro/_read.pyx":254
  *     data = fo.read(8)
  *     if len(data) == 8:
  *         ch_data[:8] = data             # <<<<<<<<<<<<<<
  *         dl.n = (ch_data[0]
  *                 | (<ulong64>(ch_data[1]) << 8)
  */
     if (unlikely(__pyx_v_data == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "expected bytes, NoneType found");
-      __PYX_ERR(0, 246, __pyx_L1_error)
+      __PYX_ERR(0, 254, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_PyBytes_AsWritableUString(__pyx_v_data); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) __PYX_ERR(0, 246, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyBytes_AsWritableUString(__pyx_v_data); if (unlikely((!__pyx_t_6) && PyErr_Occurred())) __PYX_ERR(0, 254, __pyx_L1_error)
     memcpy(&(__pyx_v_ch_data[0]), __pyx_t_6, sizeof(__pyx_v_ch_data[0]) * (8 - 0));
 
-    /* "fastavro/_read.pyx":247
+    /* "fastavro/_read.pyx":255
  *     if len(data) == 8:
  *         ch_data[:8] = data
  *         dl.n = (ch_data[0]             # <<<<<<<<<<<<<<
  *                 | (<ulong64>(ch_data[1]) << 8)
  *                 | (<ulong64>(ch_data[2]) << 16)
  */
     __pyx_v_dl.n = ((((((((__pyx_v_ch_data[0]) | (((__pyx_t_8fastavro_5_read_ulong64)(__pyx_v_ch_data[1])) << 8)) | (((__pyx_t_8fastavro_5_read_ulong64)(__pyx_v_ch_data[2])) << 16)) | (((__pyx_t_8fastavro_5_read_ulong64)(__pyx_v_ch_data[3])) << 24)) | (((__pyx_t_8fastavro_5_read_ulong64)(__pyx_v_ch_data[4])) << 32)) | (((__pyx_t_8fastavro_5_read_ulong64)(__pyx_v_ch_data[5])) << 40)) | (((__pyx_t_8fastavro_5_read_ulong64)(__pyx_v_ch_data[6])) << 48)) | (((__pyx_t_8fastavro_5_read_ulong64)(__pyx_v_ch_data[7])) << 56));
 
-    /* "fastavro/_read.pyx":255
+    /* "fastavro/_read.pyx":263
  *                 | (<ulong64>(ch_data[6]) << 48)
  *                 | (<ulong64>(ch_data[7]) << 56))
  *         return dl.d             # <<<<<<<<<<<<<<
  *     else:
  *         raise ReadError
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_dl.d); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 255, __pyx_L1_error)
+    __pyx_t_1 = PyFloat_FromDouble(__pyx_v_dl.d); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 263, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":245
+    /* "fastavro/_read.pyx":253
  *     cdef double_ulong64 dl
  *     data = fo.read(8)
  *     if len(data) == 8:             # <<<<<<<<<<<<<<
  *         ch_data[:8] = data
  *         dl.n = (ch_data[0]
  */
   }
 
-  /* "fastavro/_read.pyx":257
+  /* "fastavro/_read.pyx":265
  *         return dl.d
  *     else:
  *         raise ReadError             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_ReadError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_ReadError); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 257, __pyx_L1_error)
+    __PYX_ERR(0, 265, __pyx_L1_error)
   }
 
-  /* "fastavro/_read.pyx":235
+  /* "fastavro/_read.pyx":243
  * 
  * 
  * cpdef read_double(fo):             # <<<<<<<<<<<<<<
  *     """A double is written as 8 bytes.
  * 
  */
 
@@ -5593,37 +5824,37 @@
   __Pyx_XDECREF(__pyx_v_data);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_23read_double(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_22read_double[] = "A double is written as 8 bytes.\n\n    The double is converted into a 64-bit integer using a method equivalent to\n    Java's doubleToLongBits and then encoded in little-endian format.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_23read_double(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_25read_double(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_24read_double[] = "A double is written as 8 bytes.\n\n    The double is converted into a 64-bit integer using a method equivalent to\n    Java's doubleToLongBits and then encoded in little-endian format.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_25read_double(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_double (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_22read_double(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_24read_double(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_22read_double(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_24read_double(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_double", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_double(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_double(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 243, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5632,61 +5863,61 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":260
+/* "fastavro/_read.pyx":268
  * 
  * 
  * cpdef skip_double(fo):             # <<<<<<<<<<<<<<
  *     """A double is written as 8 bytes.
  * 
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_25skip_double(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_27skip_double(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_double(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_double", 0);
 
-  /* "fastavro/_read.pyx":266
+  /* "fastavro/_read.pyx":274
  *     Java's doubleToLongBits and then encoded in little-endian format.
  *     """
  *     fo.read(8)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 266, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_int_8) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_int_8);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 266, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":260
+  /* "fastavro/_read.pyx":268
  * 
  * 
  * cpdef skip_double(fo):             # <<<<<<<<<<<<<<
  *     """A double is written as 8 bytes.
  * 
  */
 
@@ -5702,37 +5933,37 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_25skip_double(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_24skip_double[] = "A double is written as 8 bytes.\n\n    The double is converted into a 64-bit integer using a method equivalent to\n    Java's doubleToLongBits and then encoded in little-endian format.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_25skip_double(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_27skip_double(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_26skip_double[] = "A double is written as 8 bytes.\n\n    The double is converted into a 64-bit integer using a method equivalent to\n    Java's doubleToLongBits and then encoded in little-endian format.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_27skip_double(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("skip_double (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_24skip_double(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_26skip_double(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_24skip_double(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_26skip_double(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_double", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_double(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_double(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5741,23 +5972,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":269
+/* "fastavro/_read.pyx":277
  * 
  * 
  * cpdef read_bytes(fo):             # <<<<<<<<<<<<<<
  *     """Bytes are encoded as a long followed by that many bytes of data."""
  *     cdef long64 size = read_long(fo)
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_27read_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_29read_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_read_bytes(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __pyx_t_8fastavro_5_read_long64 __pyx_v_size;
   PyObject *__pyx_v_out = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
@@ -5769,133 +6000,133 @@
   Py_UCS4 __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_bytes", 0);
 
-  /* "fastavro/_read.pyx":271
+  /* "fastavro/_read.pyx":279
  * cpdef read_bytes(fo):
  *     """Bytes are encoded as a long followed by that many bytes of data."""
  *     cdef long64 size = read_long(fo)             # <<<<<<<<<<<<<<
  *     out =  fo.read(<long>size)
  *     if len(out) != size:
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 271, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 279, __pyx_L1_error)
   __pyx_v_size = __pyx_t_1;
 
-  /* "fastavro/_read.pyx":272
+  /* "fastavro/_read.pyx":280
  *     """Bytes are encoded as a long followed by that many bytes of data."""
  *     cdef long64 size = read_long(fo)
  *     out =  fo.read(<long>size)             # <<<<<<<<<<<<<<
  *     if len(out) != size:
  *         raise EOFError(f"Expected {size} bytes, read {len(out)}")
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 272, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 280, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_From_long(((long)__pyx_v_size)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 272, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_long(((long)__pyx_v_size)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 280, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 272, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 280, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_out = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":273
+  /* "fastavro/_read.pyx":281
  *     cdef long64 size = read_long(fo)
  *     out =  fo.read(<long>size)
  *     if len(out) != size:             # <<<<<<<<<<<<<<
  *         raise EOFError(f"Expected {size} bytes, read {len(out)}")
  *     return out
  */
-  __pyx_t_6 = PyObject_Length(__pyx_v_out); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 273, __pyx_L1_error)
+  __pyx_t_6 = PyObject_Length(__pyx_v_out); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 281, __pyx_L1_error)
   __pyx_t_7 = ((__pyx_t_6 != __pyx_v_size) != 0);
   if (unlikely(__pyx_t_7)) {
 
-    /* "fastavro/_read.pyx":274
+    /* "fastavro/_read.pyx":282
  *     out =  fo.read(<long>size)
  *     if len(out) != size:
  *         raise EOFError(f"Expected {size} bytes, read {len(out)}")             # <<<<<<<<<<<<<<
  *     return out
  * 
  */
-    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 282, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_6 = 0;
     __pyx_t_8 = 127;
     __Pyx_INCREF(__pyx_kp_u_Expected);
     __pyx_t_6 += 9;
     __Pyx_GIVEREF(__pyx_kp_u_Expected);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_Expected);
-    __pyx_t_3 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 274, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 282, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_FormatSimple(__pyx_t_3, __pyx_empty_unicode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 274, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_FormatSimple(__pyx_t_3, __pyx_empty_unicode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 282, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_8 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) > __pyx_t_8) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) : __pyx_t_8;
     __pyx_t_6 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
     __pyx_t_4 = 0;
     __Pyx_INCREF(__pyx_kp_u_bytes_read);
     __pyx_t_6 += 13;
     __Pyx_GIVEREF(__pyx_kp_u_bytes_read);
     PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_bytes_read);
-    __pyx_t_9 = PyObject_Length(__pyx_v_out); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 274, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_9, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 274, __pyx_L1_error)
+    __pyx_t_9 = PyObject_Length(__pyx_v_out); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 282, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_9, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 282, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_6 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_t_4);
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_2, 4, __pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 274, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyUnicode_Join(__pyx_t_2, 4, __pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 282, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_EOFError, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_EOFError, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 282, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 274, __pyx_L1_error)
+    __PYX_ERR(0, 282, __pyx_L1_error)
 
-    /* "fastavro/_read.pyx":273
+    /* "fastavro/_read.pyx":281
  *     cdef long64 size = read_long(fo)
  *     out =  fo.read(<long>size)
  *     if len(out) != size:             # <<<<<<<<<<<<<<
  *         raise EOFError(f"Expected {size} bytes, read {len(out)}")
  *     return out
  */
   }
 
-  /* "fastavro/_read.pyx":275
+  /* "fastavro/_read.pyx":283
  *     if len(out) != size:
  *         raise EOFError(f"Expected {size} bytes, read {len(out)}")
  *     return out             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_out);
   __pyx_r = __pyx_v_out;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":269
+  /* "fastavro/_read.pyx":277
  * 
  * 
  * cpdef read_bytes(fo):             # <<<<<<<<<<<<<<
  *     """Bytes are encoded as a long followed by that many bytes of data."""
  *     cdef long64 size = read_long(fo)
  */
 
@@ -5911,37 +6142,37 @@
   __Pyx_XDECREF(__pyx_v_out);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_27read_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_26read_bytes[] = "Bytes are encoded as a long followed by that many bytes of data.";
-static PyObject *__pyx_pw_8fastavro_5_read_27read_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_29read_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_28read_bytes[] = "Bytes are encoded as a long followed by that many bytes of data.";
+static PyObject *__pyx_pw_8fastavro_5_read_29read_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_bytes (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_26read_bytes(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_28read_bytes(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_26read_bytes(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_28read_bytes(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_bytes", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 269, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5950,77 +6181,77 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":278
+/* "fastavro/_read.pyx":286
  * 
  * 
  * cpdef skip_bytes(fo):             # <<<<<<<<<<<<<<
  *     """Bytes are encoded as a long followed by that many bytes of data."""
  *     cdef long64 size = read_long(fo)
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_29skip_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_31skip_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_bytes(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __pyx_t_8fastavro_5_read_long64 __pyx_v_size;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_bytes", 0);
 
-  /* "fastavro/_read.pyx":280
+  /* "fastavro/_read.pyx":288
  * cpdef skip_bytes(fo):
  *     """Bytes are encoded as a long followed by that many bytes of data."""
  *     cdef long64 size = read_long(fo)             # <<<<<<<<<<<<<<
  *     fo.read(<long>size)
  * 
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 280, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 288, __pyx_L1_error)
   __pyx_v_size = __pyx_t_1;
 
-  /* "fastavro/_read.pyx":281
+  /* "fastavro/_read.pyx":289
  *     """Bytes are encoded as a long followed by that many bytes of data."""
  *     cdef long64 size = read_long(fo)
  *     fo.read(<long>size)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 281, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_From_long(((long)__pyx_v_size)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 281, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_long(((long)__pyx_v_size)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 281, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":278
+  /* "fastavro/_read.pyx":286
  * 
  * 
  * cpdef skip_bytes(fo):             # <<<<<<<<<<<<<<
  *     """Bytes are encoded as a long followed by that many bytes of data."""
  *     cdef long64 size = read_long(fo)
  */
 
@@ -6037,37 +6268,37 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_29skip_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_28skip_bytes[] = "Bytes are encoded as a long followed by that many bytes of data.";
-static PyObject *__pyx_pw_8fastavro_5_read_29skip_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_31skip_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_30skip_bytes[] = "Bytes are encoded as a long followed by that many bytes of data.";
+static PyObject *__pyx_pw_8fastavro_5_read_31skip_bytes(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("skip_bytes (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_28skip_bytes(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_30skip_bytes(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_28skip_bytes(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_30skip_bytes(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_bytes", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -6076,23 +6307,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":284
+/* "fastavro/_read.pyx":292
  * 
  * 
  * cpdef unicode read_utf8(fo, handle_unicode_errors="strict"):             # <<<<<<<<<<<<<<
  *     """A string is encoded as a long followed by that many bytes of UTF-8
  *     encoded character data.
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_31read_utf8(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_33read_utf8(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_read_utf8(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8fastavro_5_read_read_utf8 *__pyx_optional_args) {
   PyObject *__pyx_v_handle_unicode_errors = ((PyObject *)__pyx_n_u_strict);
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
@@ -6102,40 +6333,40 @@
   __Pyx_RefNannySetupContext("read_utf8", 0);
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_handle_unicode_errors = __pyx_optional_args->handle_unicode_errors;
     }
   }
 
-  /* "fastavro/_read.pyx":288
+  /* "fastavro/_read.pyx":296
  *     encoded character data.
  *     """
  *     return read_bytes(fo).decode(errors=handle_unicode_errors)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_decode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_decode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_errors, __pyx_v_handle_unicode_errors) < 0) __PYX_ERR(0, 288, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 288, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_errors, __pyx_v_handle_unicode_errors) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_3)->tp_name), 0))) __PYX_ERR(0, 288, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_3)->tp_name), 0))) __PYX_ERR(0, 296, __pyx_L1_error)
   __pyx_r = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":284
+  /* "fastavro/_read.pyx":292
  * 
  * 
  * cpdef unicode read_utf8(fo, handle_unicode_errors="strict"):             # <<<<<<<<<<<<<<
  *     """A string is encoded as a long followed by that many bytes of UTF-8
  *     encoded character data.
  */
 
@@ -6149,17 +6380,17 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_31read_utf8(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_30read_utf8[] = "A string is encoded as a long followed by that many bytes of UTF-8\n    encoded character data.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_31read_utf8(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_33read_utf8(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_32read_utf8[] = "A string is encoded as a long followed by that many bytes of UTF-8\n    encoded character data.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_33read_utf8(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_handle_unicode_errors = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -6188,15 +6419,15 @@
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_handle_unicode_errors);
           if (value) { values[1] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_utf8") < 0)) __PYX_ERR(0, 284, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_utf8") < 0)) __PYX_ERR(0, 292, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
@@ -6204,40 +6435,40 @@
       }
     }
     __pyx_v_fo = values[0];
     __pyx_v_handle_unicode_errors = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_utf8", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 284, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_utf8", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 292, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.read_utf8", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_30read_utf8(__pyx_self, __pyx_v_fo, __pyx_v_handle_unicode_errors);
+  __pyx_r = __pyx_pf_8fastavro_5_read_32read_utf8(__pyx_self, __pyx_v_fo, __pyx_v_handle_unicode_errors);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_30read_utf8(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_handle_unicode_errors) {
+static PyObject *__pyx_pf_8fastavro_5_read_32read_utf8(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_handle_unicode_errors) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8fastavro_5_read_read_utf8 __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_utf8", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.handle_unicode_errors = __pyx_v_handle_unicode_errors;
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_utf8(__pyx_v_fo, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_utf8(__pyx_v_fo, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -6246,44 +6477,44 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":291
+/* "fastavro/_read.pyx":299
  * 
  * 
  * cpdef skip_utf8(fo):             # <<<<<<<<<<<<<<
  *     """A string is encoded as a long followed by that many bytes of UTF-8
  *     encoded character data.
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_33skip_utf8(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_35skip_utf8(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_utf8(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_utf8", 0);
 
-  /* "fastavro/_read.pyx":295
+  /* "fastavro/_read.pyx":303
  *     encoded character data.
  *     """
  *     skip_bytes(fo)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":291
+  /* "fastavro/_read.pyx":299
  * 
  * 
  * cpdef skip_utf8(fo):             # <<<<<<<<<<<<<<
  *     """A string is encoded as a long followed by that many bytes of UTF-8
  *     encoded character data.
  */
 
@@ -6297,37 +6528,37 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_33skip_utf8(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_32skip_utf8[] = "A string is encoded as a long followed by that many bytes of UTF-8\n    encoded character data.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_33skip_utf8(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_35skip_utf8(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_34skip_utf8[] = "A string is encoded as a long followed by that many bytes of UTF-8\n    encoded character data.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_35skip_utf8(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("skip_utf8 (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_32skip_utf8(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_34skip_utf8(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_32skip_utf8(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_34skip_utf8(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_utf8", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_utf8(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_utf8(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 299, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -6336,23 +6567,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":298
+/* "fastavro/_read.pyx":306
  * 
  * 
  * cpdef read_fixed(fo, writer_schema):             # <<<<<<<<<<<<<<
  *     """Fixed instances are encoded using the number of bytes declared in the
  *     schema."""
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_35read_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_37read_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_read_fixed(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_v_out = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
@@ -6362,131 +6593,131 @@
   Py_UCS4 __pyx_t_7;
   Py_ssize_t __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_fixed", 0);
 
-  /* "fastavro/_read.pyx":301
+  /* "fastavro/_read.pyx":309
  *     """Fixed instances are encoded using the number of bytes declared in the
  *     schema."""
  *     out = fo.read(writer_schema["size"])             # <<<<<<<<<<<<<<
  *     if len(out) != writer_schema["size"]:
  *         raise EOFError(f"Expected {writer_schema['size']} bytes, read {len(out)}")
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 301, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 301, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 301, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 309, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_out = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":302
+  /* "fastavro/_read.pyx":310
  *     schema."""
  *     out = fo.read(writer_schema["size"])
  *     if len(out) != writer_schema["size"]:             # <<<<<<<<<<<<<<
  *         raise EOFError(f"Expected {writer_schema['size']} bytes, read {len(out)}")
  *     return out
  */
-  __pyx_t_5 = PyObject_Length(__pyx_v_out); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 302, __pyx_L1_error)
-  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_v_out); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 310, __pyx_L1_error)
+  __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_NE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_t_1, __pyx_t_2, Py_NE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 310, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 310, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (unlikely(__pyx_t_6)) {
 
-    /* "fastavro/_read.pyx":303
+    /* "fastavro/_read.pyx":311
  *     out = fo.read(writer_schema["size"])
  *     if len(out) != writer_schema["size"]:
  *         raise EOFError(f"Expected {writer_schema['size']} bytes, read {len(out)}")             # <<<<<<<<<<<<<<
  *     return out
  * 
  */
-    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 311, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_5 = 0;
     __pyx_t_7 = 127;
     __Pyx_INCREF(__pyx_kp_u_Expected);
     __pyx_t_5 += 9;
     __Pyx_GIVEREF(__pyx_kp_u_Expected);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_kp_u_Expected);
-    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 311, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_t_2, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_t_2, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 311, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_7 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1) > __pyx_t_7) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_1) : __pyx_t_7;
     __pyx_t_5 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
     __pyx_t_1 = 0;
     __Pyx_INCREF(__pyx_kp_u_bytes_read);
     __pyx_t_5 += 13;
     __Pyx_GIVEREF(__pyx_kp_u_bytes_read);
     PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_kp_u_bytes_read);
-    __pyx_t_8 = PyObject_Length(__pyx_v_out); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 303, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_8, 0, ' ', 'd'); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_8 = PyObject_Length(__pyx_v_out); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 311, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_8, 0, ' ', 'd'); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 311, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_5 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyUnicode_Join(__pyx_t_3, 4, __pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyUnicode_Join(__pyx_t_3, 4, __pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 311, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_EOFError, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_EOFError, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 311, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __PYX_ERR(0, 303, __pyx_L1_error)
+    __PYX_ERR(0, 311, __pyx_L1_error)
 
-    /* "fastavro/_read.pyx":302
+    /* "fastavro/_read.pyx":310
  *     schema."""
  *     out = fo.read(writer_schema["size"])
  *     if len(out) != writer_schema["size"]:             # <<<<<<<<<<<<<<
  *         raise EOFError(f"Expected {writer_schema['size']} bytes, read {len(out)}")
  *     return out
  */
   }
 
-  /* "fastavro/_read.pyx":304
+  /* "fastavro/_read.pyx":312
  *     if len(out) != writer_schema["size"]:
  *         raise EOFError(f"Expected {writer_schema['size']} bytes, read {len(out)}")
  *     return out             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_out);
   __pyx_r = __pyx_v_out;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":298
+  /* "fastavro/_read.pyx":306
  * 
  * 
  * cpdef read_fixed(fo, writer_schema):             # <<<<<<<<<<<<<<
  *     """Fixed instances are encoded using the number of bytes declared in the
  *     schema."""
  */
 
@@ -6502,17 +6733,17 @@
   __Pyx_XDECREF(__pyx_v_out);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_35read_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_34read_fixed[] = "Fixed instances are encoded using the number of bytes declared in the\n    schema.";
-static PyObject *__pyx_pw_8fastavro_5_read_35read_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_37read_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_36read_fixed[] = "Fixed instances are encoded using the number of bytes declared in the\n    schema.";
+static PyObject *__pyx_pw_8fastavro_5_read_37read_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -6536,54 +6767,54 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_fixed", 1, 2, 2, 1); __PYX_ERR(0, 298, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_fixed", 1, 2, 2, 1); __PYX_ERR(0, 306, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_fixed") < 0)) __PYX_ERR(0, 298, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_fixed") < 0)) __PYX_ERR(0, 306, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_fo = values[0];
     __pyx_v_writer_schema = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_fixed", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 298, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_fixed", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 306, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.read_fixed", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_34read_fixed(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema);
+  __pyx_r = __pyx_pf_8fastavro_5_read_36read_fixed(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_34read_fixed(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema) {
+static PyObject *__pyx_pf_8fastavro_5_read_36read_fixed(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_fixed", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_fixed(__pyx_v_fo, __pyx_v_writer_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 298, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_fixed(__pyx_v_fo, __pyx_v_writer_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -6592,65 +6823,65 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":307
+/* "fastavro/_read.pyx":315
  * 
  * 
  * cpdef skip_fixed(fo, writer_schema):             # <<<<<<<<<<<<<<
  *     """Fixed instances are encoded using the number of bytes declared in the
  *     schema."""
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_37skip_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_39skip_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_fixed(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_fixed", 0);
 
-  /* "fastavro/_read.pyx":310
+  /* "fastavro/_read.pyx":318
  *     """Fixed instances are encoded using the number of bytes declared in the
  *     schema."""
  *     fo.read(writer_schema["size"])             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 318, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 310, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 318, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":307
+  /* "fastavro/_read.pyx":315
  * 
  * 
  * cpdef skip_fixed(fo, writer_schema):             # <<<<<<<<<<<<<<
  *     """Fixed instances are encoded using the number of bytes declared in the
  *     schema."""
  */
 
@@ -6667,17 +6898,17 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_37skip_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_36skip_fixed[] = "Fixed instances are encoded using the number of bytes declared in the\n    schema.";
-static PyObject *__pyx_pw_8fastavro_5_read_37skip_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_39skip_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_38skip_fixed[] = "Fixed instances are encoded using the number of bytes declared in the\n    schema.";
+static PyObject *__pyx_pw_8fastavro_5_read_39skip_fixed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -6701,54 +6932,54 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("skip_fixed", 1, 2, 2, 1); __PYX_ERR(0, 307, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("skip_fixed", 1, 2, 2, 1); __PYX_ERR(0, 315, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_fixed") < 0)) __PYX_ERR(0, 307, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_fixed") < 0)) __PYX_ERR(0, 315, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_fo = values[0];
     __pyx_v_writer_schema = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("skip_fixed", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 307, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("skip_fixed", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 315, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.skip_fixed", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_36skip_fixed(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema);
+  __pyx_r = __pyx_pf_8fastavro_5_read_38skip_fixed(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_36skip_fixed(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema) {
+static PyObject *__pyx_pf_8fastavro_5_read_38skip_fixed(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_fixed", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_fixed(__pyx_v_fo, __pyx_v_writer_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_fixed(__pyx_v_fo, __pyx_v_writer_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 315, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -6757,23 +6988,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":313
+/* "fastavro/_read.pyx":321
  * 
  * 
  * cpdef read_enum(fo, writer_schema, reader_schema):             # <<<<<<<<<<<<<<
  *     """An enum is encoded by a int, representing the zero-based position of the
  *     symbol in the schema.
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_39read_enum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_41read_enum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_read_enum(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_reader_schema, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __pyx_t_8fastavro_5_read_long64 __pyx_v_index;
   PyObject *__pyx_v_symbol = NULL;
   PyObject *__pyx_v_default = NULL;
   PyObject *__pyx_v_symlist = NULL;
   PyObject *__pyx_v_msg = NULL;
   PyObject *__pyx_r = NULL;
@@ -6788,218 +7019,218 @@
   Py_ssize_t __pyx_t_8;
   Py_UCS4 __pyx_t_9;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_enum", 0);
 
-  /* "fastavro/_read.pyx":317
+  /* "fastavro/_read.pyx":325
  *     symbol in the schema.
  *     """
  *     index = read_long(fo)             # <<<<<<<<<<<<<<
  *     symbol = writer_schema["symbols"][index]
  *     if reader_schema and symbol not in reader_schema["symbols"]:
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 317, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 325, __pyx_L1_error)
   __pyx_v_index = __pyx_t_1;
 
-  /* "fastavro/_read.pyx":318
+  /* "fastavro/_read.pyx":326
  *     """
  *     index = read_long(fo)
  *     symbol = writer_schema["symbols"][index]             # <<<<<<<<<<<<<<
  *     if reader_schema and symbol not in reader_schema["symbols"]:
  *         default = reader_schema.get("default")
  */
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_symbols); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 318, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_symbols); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 326, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_index, __pyx_t_8fastavro_5_read_long64, 1, __Pyx_PyInt_From_PY_LONG_LONG, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 318, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_2, __pyx_v_index, __pyx_t_8fastavro_5_read_long64, 1, __Pyx_PyInt_From_PY_LONG_LONG, 0, 1, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 326, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_symbol = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastavro/_read.pyx":319
+  /* "fastavro/_read.pyx":327
  *     index = read_long(fo)
  *     symbol = writer_schema["symbols"][index]
  *     if reader_schema and symbol not in reader_schema["symbols"]:             # <<<<<<<<<<<<<<
  *         default = reader_schema.get("default")
  *         if default:
  */
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 319, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 327, __pyx_L1_error)
   if (__pyx_t_5) {
   } else {
     __pyx_t_4 = __pyx_t_5;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_reader_schema, __pyx_n_u_symbols); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 319, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_reader_schema, __pyx_n_u_symbols); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_v_symbol, __pyx_t_3, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 319, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_v_symbol, __pyx_t_3, Py_NE)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_6 = (__pyx_t_5 != 0);
   __pyx_t_4 = __pyx_t_6;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":320
+    /* "fastavro/_read.pyx":328
  *     symbol = writer_schema["symbols"][index]
  *     if reader_schema and symbol not in reader_schema["symbols"]:
  *         default = reader_schema.get("default")             # <<<<<<<<<<<<<<
  *         if default:
  *             return default
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_reader_schema, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_reader_schema, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 328, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_3 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_7, __pyx_n_u_default) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_n_u_default);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 320, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 328, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_default = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "fastavro/_read.pyx":321
+    /* "fastavro/_read.pyx":329
  *     if reader_schema and symbol not in reader_schema["symbols"]:
  *         default = reader_schema.get("default")
  *         if default:             # <<<<<<<<<<<<<<
  *             return default
  *         else:
  */
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_default); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 321, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_default); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 329, __pyx_L1_error)
     if (likely(__pyx_t_4)) {
 
-      /* "fastavro/_read.pyx":322
+      /* "fastavro/_read.pyx":330
  *         default = reader_schema.get("default")
  *         if default:
  *             return default             # <<<<<<<<<<<<<<
  *         else:
  *             symlist = reader_schema["symbols"]
  */
       __Pyx_XDECREF(__pyx_r);
       __Pyx_INCREF(__pyx_v_default);
       __pyx_r = __pyx_v_default;
       goto __pyx_L0;
 
-      /* "fastavro/_read.pyx":321
+      /* "fastavro/_read.pyx":329
  *     if reader_schema and symbol not in reader_schema["symbols"]:
  *         default = reader_schema.get("default")
  *         if default:             # <<<<<<<<<<<<<<
  *             return default
  *         else:
  */
     }
 
-    /* "fastavro/_read.pyx":324
+    /* "fastavro/_read.pyx":332
  *             return default
  *         else:
  *             symlist = reader_schema["symbols"]             # <<<<<<<<<<<<<<
  *             msg = f"{symbol} not found in reader symbol list {symlist}"
  *             raise SchemaResolutionError(msg)
  */
     /*else*/ {
-      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_reader_schema, __pyx_n_u_symbols); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_reader_schema, __pyx_n_u_symbols); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_v_symlist = __pyx_t_3;
       __pyx_t_3 = 0;
 
-      /* "fastavro/_read.pyx":325
+      /* "fastavro/_read.pyx":333
  *         else:
  *             symlist = reader_schema["symbols"]
  *             msg = f"{symbol} not found in reader symbol list {symlist}"             # <<<<<<<<<<<<<<
  *             raise SchemaResolutionError(msg)
  *     return symbol
  */
-      __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 333, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_8 = 0;
       __pyx_t_9 = 127;
-      __pyx_t_2 = __Pyx_PyObject_FormatSimple(__pyx_v_symbol, __pyx_empty_unicode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_FormatSimple(__pyx_v_symbol, __pyx_empty_unicode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 333, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_9 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) > __pyx_t_9) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) : __pyx_t_9;
       __pyx_t_8 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
       __pyx_t_2 = 0;
       __Pyx_INCREF(__pyx_kp_u_not_found_in_reader_symbol_list);
       __pyx_t_8 += 33;
       __Pyx_GIVEREF(__pyx_kp_u_not_found_in_reader_symbol_list);
       PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_kp_u_not_found_in_reader_symbol_list);
-      __pyx_t_2 = __Pyx_PyObject_FormatSimple(__pyx_v_symlist, __pyx_empty_unicode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_FormatSimple(__pyx_v_symlist, __pyx_empty_unicode); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 333, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_9 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) > __pyx_t_9) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_2) : __pyx_t_9;
       __pyx_t_8 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_2);
       __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyUnicode_Join(__pyx_t_3, 3, __pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyUnicode_Join(__pyx_t_3, 3, __pyx_t_8, __pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 333, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_v_msg = ((PyObject*)__pyx_t_2);
       __pyx_t_2 = 0;
 
-      /* "fastavro/_read.pyx":326
+      /* "fastavro/_read.pyx":334
  *             symlist = reader_schema["symbols"]
  *             msg = f"{symbol} not found in reader symbol list {symlist}"
  *             raise SchemaResolutionError(msg)             # <<<<<<<<<<<<<<
  *     return symbol
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 326, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 334, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_7 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_7)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
           __Pyx_INCREF(__pyx_t_7);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
       __pyx_t_2 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_7, __pyx_v_msg) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_msg);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 326, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 334, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_Raise(__pyx_t_2, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __PYX_ERR(0, 326, __pyx_L1_error)
+      __PYX_ERR(0, 334, __pyx_L1_error)
     }
 
-    /* "fastavro/_read.pyx":319
+    /* "fastavro/_read.pyx":327
  *     index = read_long(fo)
  *     symbol = writer_schema["symbols"][index]
  *     if reader_schema and symbol not in reader_schema["symbols"]:             # <<<<<<<<<<<<<<
  *         default = reader_schema.get("default")
  *         if default:
  */
   }
 
-  /* "fastavro/_read.pyx":327
+  /* "fastavro/_read.pyx":335
  *             msg = f"{symbol} not found in reader symbol list {symlist}"
  *             raise SchemaResolutionError(msg)
  *     return symbol             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_symbol);
   __pyx_r = __pyx_v_symbol;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":313
+  /* "fastavro/_read.pyx":321
  * 
  * 
  * cpdef read_enum(fo, writer_schema, reader_schema):             # <<<<<<<<<<<<<<
  *     """An enum is encoded by a int, representing the zero-based position of the
  *     symbol in the schema.
  */
 
@@ -7017,17 +7248,17 @@
   __Pyx_XDECREF(__pyx_v_msg);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_39read_enum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_38read_enum[] = "An enum is encoded by a int, representing the zero-based position of the\n    symbol in the schema.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_39read_enum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_41read_enum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_40read_enum[] = "An enum is encoded by a int, representing the zero-based position of the\n    symbol in the schema.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_41read_enum(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_reader_schema = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -7054,62 +7285,62 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_enum", 1, 3, 3, 1); __PYX_ERR(0, 313, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_enum", 1, 3, 3, 1); __PYX_ERR(0, 321, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_enum", 1, 3, 3, 2); __PYX_ERR(0, 313, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_enum", 1, 3, 3, 2); __PYX_ERR(0, 321, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_enum") < 0)) __PYX_ERR(0, 313, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_enum") < 0)) __PYX_ERR(0, 321, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_fo = values[0];
     __pyx_v_writer_schema = values[1];
     __pyx_v_reader_schema = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_enum", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 313, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_enum", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 321, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.read_enum", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_38read_enum(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_reader_schema);
+  __pyx_r = __pyx_pf_8fastavro_5_read_40read_enum(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_reader_schema);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_38read_enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_reader_schema) {
+static PyObject *__pyx_pf_8fastavro_5_read_40read_enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_reader_schema) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_enum", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_enum(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_reader_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 313, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_enum(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_reader_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -7118,42 +7349,42 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":330
+/* "fastavro/_read.pyx":338
  * 
  * 
  * cpdef skip_enum(fo):             # <<<<<<<<<<<<<<
  *     """An enum is encoded by a int, representing the zero-based position of the
  *     symbol in the schema.
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_41skip_enum(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_43skip_enum(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_enum(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_enum", 0);
 
-  /* "fastavro/_read.pyx":334
+  /* "fastavro/_read.pyx":342
  *     symbol in the schema.
  *     """
  *     read_long(fo)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 334, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 342, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":330
+  /* "fastavro/_read.pyx":338
  * 
  * 
  * cpdef skip_enum(fo):             # <<<<<<<<<<<<<<
  *     """An enum is encoded by a int, representing the zero-based position of the
  *     symbol in the schema.
  */
 
@@ -7166,37 +7397,37 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_41skip_enum(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_40skip_enum[] = "An enum is encoded by a int, representing the zero-based position of the\n    symbol in the schema.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_41skip_enum(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_43skip_enum(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_42skip_enum[] = "An enum is encoded by a int, representing the zero-based position of the\n    symbol in the schema.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_43skip_enum(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("skip_enum (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_40skip_enum(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_42skip_enum(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_40skip_enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_42skip_enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_enum", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_enum(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 330, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_enum(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -7205,26 +7436,26 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":337
+/* "fastavro/_read.pyx":345
  * 
  * 
  * cpdef read_array(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_43read_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_45read_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_read_array(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8fastavro_5_read_read_array *__pyx_optional_args) {
 
-  /* "fastavro/_read.pyx":341
+  /* "fastavro/_read.pyx":349
  *     writer_schema,
  *     named_schemas,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     options={},
  * ):
  */
   PyObject *__pyx_v_reader_schema = ((PyObject *)Py_None);
@@ -7252,220 +7483,220 @@
       __pyx_v_reader_schema = __pyx_optional_args->reader_schema;
       if (__pyx_optional_args->__pyx_n > 1) {
         __pyx_v_options = __pyx_optional_args->options;
       }
     }
   }
 
-  /* "fastavro/_read.pyx":358
+  /* "fastavro/_read.pyx":366
  *     cdef long64 i
  * 
  *     read_items = []             # <<<<<<<<<<<<<<
  * 
  *     block_count = read_long(fo)
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 358, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 366, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_read_items = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":360
+  /* "fastavro/_read.pyx":368
  *     read_items = []
  * 
  *     block_count = read_long(fo)             # <<<<<<<<<<<<<<
  * 
  *     while block_count != 0:
  */
-  __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 360, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 368, __pyx_L1_error)
   __pyx_v_block_count = __pyx_t_2;
 
-  /* "fastavro/_read.pyx":362
+  /* "fastavro/_read.pyx":370
  *     block_count = read_long(fo)
  * 
  *     while block_count != 0:             # <<<<<<<<<<<<<<
  *         if block_count < 0:
  *             block_count = -block_count
  */
   while (1) {
     __pyx_t_3 = ((__pyx_v_block_count != 0) != 0);
     if (!__pyx_t_3) break;
 
-    /* "fastavro/_read.pyx":363
+    /* "fastavro/_read.pyx":371
  * 
  *     while block_count != 0:
  *         if block_count < 0:             # <<<<<<<<<<<<<<
  *             block_count = -block_count
  *             # Read block size, unused
  */
     __pyx_t_3 = ((__pyx_v_block_count < 0) != 0);
     if (__pyx_t_3) {
 
-      /* "fastavro/_read.pyx":364
+      /* "fastavro/_read.pyx":372
  *     while block_count != 0:
  *         if block_count < 0:
  *             block_count = -block_count             # <<<<<<<<<<<<<<
  *             # Read block size, unused
  *             read_long(fo)
  */
       __pyx_v_block_count = (-__pyx_v_block_count);
 
-      /* "fastavro/_read.pyx":366
+      /* "fastavro/_read.pyx":374
  *             block_count = -block_count
  *             # Read block size, unused
  *             read_long(fo)             # <<<<<<<<<<<<<<
  * 
  *         if reader_schema:
  */
-      __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 366, __pyx_L1_error)
+      __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 374, __pyx_L1_error)
 
-      /* "fastavro/_read.pyx":363
+      /* "fastavro/_read.pyx":371
  * 
  *     while block_count != 0:
  *         if block_count < 0:             # <<<<<<<<<<<<<<
  *             block_count = -block_count
  *             # Read block size, unused
  */
     }
 
-    /* "fastavro/_read.pyx":368
+    /* "fastavro/_read.pyx":376
  *             read_long(fo)
  * 
  *         if reader_schema:             # <<<<<<<<<<<<<<
  *             for i in range(block_count):
  *                 read_items.append(_read_data(
  */
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 368, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 376, __pyx_L1_error)
     if (__pyx_t_3) {
 
-      /* "fastavro/_read.pyx":369
+      /* "fastavro/_read.pyx":377
  * 
  *         if reader_schema:
  *             for i in range(block_count):             # <<<<<<<<<<<<<<
  *                 read_items.append(_read_data(
  *                     fo,
  */
       __pyx_t_2 = __pyx_v_block_count;
       __pyx_t_4 = __pyx_t_2;
       for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
         __pyx_v_i = __pyx_t_5;
 
-        /* "fastavro/_read.pyx":372
+        /* "fastavro/_read.pyx":380
  *                 read_items.append(_read_data(
  *                     fo,
  *                     writer_schema["items"],             # <<<<<<<<<<<<<<
  *                     named_schemas,
  *                     reader_schema["items"],
  */
-        __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 372, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 380, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
 
-        /* "fastavro/_read.pyx":374
+        /* "fastavro/_read.pyx":382
  *                     writer_schema["items"],
  *                     named_schemas,
  *                     reader_schema["items"],             # <<<<<<<<<<<<<<
  *                     options,
  *                 ))
  */
-        __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_v_reader_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 374, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_v_reader_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 382, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
 
-        /* "fastavro/_read.pyx":370
+        /* "fastavro/_read.pyx":378
  *         if reader_schema:
  *             for i in range(block_count):
  *                 read_items.append(_read_data(             # <<<<<<<<<<<<<<
  *                     fo,
  *                     writer_schema["items"],
  */
         __pyx_t_8.__pyx_n = 2;
         __pyx_t_8.reader_schema = __pyx_t_6;
         __pyx_t_8.options = __pyx_v_options;
-        __pyx_t_7 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_1, __pyx_v_named_schemas, 0, &__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 370, __pyx_L1_error)
+        __pyx_t_7 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_1, __pyx_v_named_schemas, 0, &__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 378, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_read_items, __pyx_t_7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 370, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_read_items, __pyx_t_7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 378, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       }
 
-      /* "fastavro/_read.pyx":368
+      /* "fastavro/_read.pyx":376
  *             read_long(fo)
  * 
  *         if reader_schema:             # <<<<<<<<<<<<<<
  *             for i in range(block_count):
  *                 read_items.append(_read_data(
  */
       goto __pyx_L6;
     }
 
-    /* "fastavro/_read.pyx":378
+    /* "fastavro/_read.pyx":386
  *                 ))
  *         else:
  *             for i in range(block_count):             # <<<<<<<<<<<<<<
  *                 read_items.append(_read_data(
  *                     fo,
  */
     /*else*/ {
       __pyx_t_2 = __pyx_v_block_count;
       __pyx_t_4 = __pyx_t_2;
       for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
         __pyx_v_i = __pyx_t_5;
 
-        /* "fastavro/_read.pyx":381
+        /* "fastavro/_read.pyx":389
  *                 read_items.append(_read_data(
  *                     fo,
  *                     writer_schema["items"],             # <<<<<<<<<<<<<<
  *                     named_schemas,
  *                     None,
  */
-        __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 381, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 389, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
 
-        /* "fastavro/_read.pyx":379
+        /* "fastavro/_read.pyx":387
  *         else:
  *             for i in range(block_count):
  *                 read_items.append(_read_data(             # <<<<<<<<<<<<<<
  *                     fo,
  *                     writer_schema["items"],
  */
         __pyx_t_8.__pyx_n = 2;
         __pyx_t_8.reader_schema = Py_None;
         __pyx_t_8.options = __pyx_v_options;
-        __pyx_t_6 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_7, __pyx_v_named_schemas, 0, &__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 379, __pyx_L1_error)
+        __pyx_t_6 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_7, __pyx_v_named_schemas, 0, &__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 387, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_read_items, __pyx_t_6); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 379, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_read_items, __pyx_t_6); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 387, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       }
     }
     __pyx_L6:;
 
-    /* "fastavro/_read.pyx":386
+    /* "fastavro/_read.pyx":394
  *                     options,
  *                 ))
  *         block_count = read_long(fo)             # <<<<<<<<<<<<<<
  * 
  *     return read_items
  */
-    __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 386, __pyx_L1_error)
+    __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 394, __pyx_L1_error)
     __pyx_v_block_count = __pyx_t_2;
   }
 
-  /* "fastavro/_read.pyx":388
+  /* "fastavro/_read.pyx":396
  *         block_count = read_long(fo)
  * 
  *     return read_items             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_read_items);
   __pyx_r = __pyx_v_read_items;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":337
+  /* "fastavro/_read.pyx":345
  * 
  * 
  * cpdef read_array(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
@@ -7480,17 +7711,17 @@
   __Pyx_XDECREF(__pyx_v_read_items);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_43read_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_42read_array[] = "Arrays are encoded as a series of blocks.\n\n    Each block consists of a long count value, followed by that many array\n    items.  A block with count zero indicates the end of the array.  Each item\n    is encoded per the array's item schema.\n\n    If a block's count is negative, then the count is followed immediately by a\n    long block size, indicating the number of bytes in the block.  The actual\n    count in this case is the absolute value of the count written.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_43read_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_45read_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_44read_array[] = "Arrays are encoded as a series of blocks.\n\n    Each block consists of a long count value, followed by that many array\n    items.  A block with count zero indicates the end of the array.  Each item\n    is encoded per the array's item schema.\n\n    If a block's count is negative, then the count is followed immediately by a\n    long block size, indicating the number of bytes in the block.  The actual\n    count in this case is the absolute value of the count written.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_45read_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   PyObject *__pyx_v_reader_schema = 0;
   PyObject *__pyx_v_options = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -7498,15 +7729,15 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_array (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_fo,&__pyx_n_s_writer_schema,&__pyx_n_s_named_schemas,&__pyx_n_s_reader_schema,&__pyx_n_s_options,0};
     PyObject* values[5] = {0,0,0,0,0};
 
-    /* "fastavro/_read.pyx":341
+    /* "fastavro/_read.pyx":349
  *     writer_schema,
  *     named_schemas,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     options={},
  * ):
  */
     values[3] = ((PyObject *)Py_None);
@@ -7533,21 +7764,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_array", 0, 3, 5, 1); __PYX_ERR(0, 337, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_array", 0, 3, 5, 1); __PYX_ERR(0, 345, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_array", 0, 3, 5, 2); __PYX_ERR(0, 337, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_array", 0, 3, 5, 2); __PYX_ERR(0, 345, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -7555,15 +7786,15 @@
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_options);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_array") < 0)) __PYX_ERR(0, 337, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_array") < 0)) __PYX_ERR(0, 345, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
@@ -7578,49 +7809,49 @@
     __pyx_v_writer_schema = values[1];
     __pyx_v_named_schemas = values[2];
     __pyx_v_reader_schema = values[3];
     __pyx_v_options = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_array", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 337, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_array", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 345, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.read_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_42read_array(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
+  __pyx_r = __pyx_pf_8fastavro_5_read_44read_array(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
 
-  /* "fastavro/_read.pyx":337
+  /* "fastavro/_read.pyx":345
  * 
  * 
  * cpdef read_array(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_42read_array(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
+static PyObject *__pyx_pf_8fastavro_5_read_44read_array(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8fastavro_5_read_read_array __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_array", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.reader_schema = __pyx_v_reader_schema;
   __pyx_t_2.options = __pyx_v_options;
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_array(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 337, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_array(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 345, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -7629,23 +7860,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":391
+/* "fastavro/_read.pyx":399
  * 
  * 
  * cpdef skip_array(fo, writer_schema, named_schemas):             # <<<<<<<<<<<<<<
  *     """Arrays are encoded as a series of blocks.
  * 
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_45skip_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_47skip_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_array(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __pyx_t_8fastavro_5_read_long64 __pyx_v_block_count;
   CYTHON_UNUSED __pyx_t_8fastavro_5_read_long64 __pyx_v_i;
   __pyx_t_8fastavro_5_read_long64 __pyx_v_block_size;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
@@ -7657,136 +7888,136 @@
   __pyx_t_8fastavro_5_read_long64 __pyx_t_7;
   __pyx_t_8fastavro_5_read_long64 __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_array", 0);
 
-  /* "fastavro/_read.pyx":405
+  /* "fastavro/_read.pyx":413
  *     cdef long64 i
  * 
  *     block_count = read_long(fo)             # <<<<<<<<<<<<<<
  * 
  *     while block_count != 0:
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 405, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 413, __pyx_L1_error)
   __pyx_v_block_count = __pyx_t_1;
 
-  /* "fastavro/_read.pyx":407
+  /* "fastavro/_read.pyx":415
  *     block_count = read_long(fo)
  * 
  *     while block_count != 0:             # <<<<<<<<<<<<<<
  *         if block_count < 0:
  *             block_size = read_long(fo)
  */
   while (1) {
     __pyx_t_2 = ((__pyx_v_block_count != 0) != 0);
     if (!__pyx_t_2) break;
 
-    /* "fastavro/_read.pyx":408
+    /* "fastavro/_read.pyx":416
  * 
  *     while block_count != 0:
  *         if block_count < 0:             # <<<<<<<<<<<<<<
  *             block_size = read_long(fo)
  *             fo.read(block_size)
  */
     __pyx_t_2 = ((__pyx_v_block_count < 0) != 0);
     if (__pyx_t_2) {
 
-      /* "fastavro/_read.pyx":409
+      /* "fastavro/_read.pyx":417
  *     while block_count != 0:
  *         if block_count < 0:
  *             block_size = read_long(fo)             # <<<<<<<<<<<<<<
  *             fo.read(block_size)
  *         else:
  */
-      __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 409, __pyx_L1_error)
+      __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 417, __pyx_L1_error)
       __pyx_v_block_size = __pyx_t_1;
 
-      /* "fastavro/_read.pyx":410
+      /* "fastavro/_read.pyx":418
  *         if block_count < 0:
  *             block_size = read_long(fo)
  *             fo.read(block_size)             # <<<<<<<<<<<<<<
  *         else:
  *             for i in range(block_count):
  */
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 410, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 418, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_block_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 410, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_block_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 418, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_t_6 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 410, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 418, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "fastavro/_read.pyx":408
+      /* "fastavro/_read.pyx":416
  * 
  *     while block_count != 0:
  *         if block_count < 0:             # <<<<<<<<<<<<<<
  *             block_size = read_long(fo)
  *             fo.read(block_size)
  */
       goto __pyx_L5;
     }
 
-    /* "fastavro/_read.pyx":412
+    /* "fastavro/_read.pyx":420
  *             fo.read(block_size)
  *         else:
  *             for i in range(block_count):             # <<<<<<<<<<<<<<
  *                 _skip_data(fo, writer_schema["items"], named_schemas)
  * 
  */
     /*else*/ {
       __pyx_t_1 = __pyx_v_block_count;
       __pyx_t_7 = __pyx_t_1;
       for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
         __pyx_v_i = __pyx_t_8;
 
-        /* "fastavro/_read.pyx":413
+        /* "fastavro/_read.pyx":421
  *         else:
  *             for i in range(block_count):
  *                 _skip_data(fo, writer_schema["items"], named_schemas)             # <<<<<<<<<<<<<<
  * 
  *         block_count = read_long(fo)
  */
-        __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 413, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_items); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 421, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_3, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 413, __pyx_L1_error)
+        __pyx_t_4 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_3, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 421, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       }
     }
     __pyx_L5:;
 
-    /* "fastavro/_read.pyx":415
+    /* "fastavro/_read.pyx":423
  *                 _skip_data(fo, writer_schema["items"], named_schemas)
  * 
  *         block_count = read_long(fo)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 415, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 423, __pyx_L1_error)
     __pyx_v_block_count = __pyx_t_1;
   }
 
-  /* "fastavro/_read.pyx":391
+  /* "fastavro/_read.pyx":399
  * 
  * 
  * cpdef skip_array(fo, writer_schema, named_schemas):             # <<<<<<<<<<<<<<
  *     """Arrays are encoded as a series of blocks.
  * 
  */
 
@@ -7803,17 +8034,17 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_45skip_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_44skip_array[] = "Arrays are encoded as a series of blocks.\n\n    Each block consists of a long count value, followed by that many array\n    items.  A block with count zero indicates the end of the array.  Each item\n    is encoded per the array's item schema.\n\n    If a block's count is negative, then the count is followed immediately by a\n    long block size, indicating the number of bytes in the block.  The actual\n    count in this case is the absolute value of the count written.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_45skip_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_47skip_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_46skip_array[] = "Arrays are encoded as a series of blocks.\n\n    Each block consists of a long count value, followed by that many array\n    items.  A block with count zero indicates the end of the array.  Each item\n    is encoded per the array's item schema.\n\n    If a block's count is negative, then the count is followed immediately by a\n    long block size, indicating the number of bytes in the block.  The actual\n    count in this case is the absolute value of the count written.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_47skip_array(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -7840,62 +8071,62 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("skip_array", 1, 3, 3, 1); __PYX_ERR(0, 391, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("skip_array", 1, 3, 3, 1); __PYX_ERR(0, 399, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("skip_array", 1, 3, 3, 2); __PYX_ERR(0, 391, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("skip_array", 1, 3, 3, 2); __PYX_ERR(0, 399, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_array") < 0)) __PYX_ERR(0, 391, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_array") < 0)) __PYX_ERR(0, 399, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_fo = values[0];
     __pyx_v_writer_schema = values[1];
     __pyx_v_named_schemas = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("skip_array", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 391, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("skip_array", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 399, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.skip_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_44skip_array(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas);
+  __pyx_r = __pyx_pf_8fastavro_5_read_46skip_array(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_44skip_array(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas) {
+static PyObject *__pyx_pf_8fastavro_5_read_46skip_array(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_array", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_array(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 391, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_array(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -7904,26 +8135,26 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":418
+/* "fastavro/_read.pyx":426
  * 
  * 
  * cpdef read_map(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_47read_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_49read_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_read_map(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8fastavro_5_read_read_map *__pyx_optional_args) {
 
-  /* "fastavro/_read.pyx":422
+  /* "fastavro/_read.pyx":430
  *     writer_schema,
  *     named_schemas,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     options={},
  * ):
  */
   PyObject *__pyx_v_reader_schema = ((PyObject *)Py_None);
@@ -7952,260 +8183,260 @@
       __pyx_v_reader_schema = __pyx_optional_args->reader_schema;
       if (__pyx_optional_args->__pyx_n > 1) {
         __pyx_v_options = __pyx_optional_args->options;
       }
     }
   }
 
-  /* "fastavro/_read.pyx":440
+  /* "fastavro/_read.pyx":448
  *     cdef unicode key
  * 
  *     read_items = {}             # <<<<<<<<<<<<<<
  *     block_count = read_long(fo)
  *     while block_count != 0:
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_read_items = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":441
+  /* "fastavro/_read.pyx":449
  * 
  *     read_items = {}
  *     block_count = read_long(fo)             # <<<<<<<<<<<<<<
  *     while block_count != 0:
  *         if block_count < 0:
  */
-  __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L1_error)
   __pyx_v_block_count = __pyx_t_2;
 
-  /* "fastavro/_read.pyx":442
+  /* "fastavro/_read.pyx":450
  *     read_items = {}
  *     block_count = read_long(fo)
  *     while block_count != 0:             # <<<<<<<<<<<<<<
  *         if block_count < 0:
  *             block_count = -block_count
  */
   while (1) {
     __pyx_t_3 = ((__pyx_v_block_count != 0) != 0);
     if (!__pyx_t_3) break;
 
-    /* "fastavro/_read.pyx":443
+    /* "fastavro/_read.pyx":451
  *     block_count = read_long(fo)
  *     while block_count != 0:
  *         if block_count < 0:             # <<<<<<<<<<<<<<
  *             block_count = -block_count
  *             # Read block size, unused
  */
     __pyx_t_3 = ((__pyx_v_block_count < 0) != 0);
     if (__pyx_t_3) {
 
-      /* "fastavro/_read.pyx":444
+      /* "fastavro/_read.pyx":452
  *     while block_count != 0:
  *         if block_count < 0:
  *             block_count = -block_count             # <<<<<<<<<<<<<<
  *             # Read block size, unused
  *             read_long(fo)
  */
       __pyx_v_block_count = (-__pyx_v_block_count);
 
-      /* "fastavro/_read.pyx":446
+      /* "fastavro/_read.pyx":454
  *             block_count = -block_count
  *             # Read block size, unused
  *             read_long(fo)             # <<<<<<<<<<<<<<
  * 
  *         if reader_schema:
  */
-      __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 446, __pyx_L1_error)
+      __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 454, __pyx_L1_error)
 
-      /* "fastavro/_read.pyx":443
+      /* "fastavro/_read.pyx":451
  *     block_count = read_long(fo)
  *     while block_count != 0:
  *         if block_count < 0:             # <<<<<<<<<<<<<<
  *             block_count = -block_count
  *             # Read block size, unused
  */
     }
 
-    /* "fastavro/_read.pyx":448
+    /* "fastavro/_read.pyx":456
  *             read_long(fo)
  * 
  *         if reader_schema:             # <<<<<<<<<<<<<<
  *             for i in range(block_count):
  *                 key = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  */
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 448, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 456, __pyx_L1_error)
     if (__pyx_t_3) {
 
-      /* "fastavro/_read.pyx":449
+      /* "fastavro/_read.pyx":457
  * 
  *         if reader_schema:
  *             for i in range(block_count):             # <<<<<<<<<<<<<<
  *                 key = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  *                 read_items[key] = _read_data(
  */
       __pyx_t_2 = __pyx_v_block_count;
       __pyx_t_4 = __pyx_t_2;
       for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
         __pyx_v_i = __pyx_t_5;
 
-        /* "fastavro/_read.pyx":450
+        /* "fastavro/_read.pyx":458
  *         if reader_schema:
  *             for i in range(block_count):
  *                 key = read_utf8(fo, options.get("handle_unicode_errors", "strict"))             # <<<<<<<<<<<<<<
  *                 read_items[key] = _read_data(
  *                     fo,
  */
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_options, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_options, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 458, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 450, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 458, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_t_7.__pyx_n = 1;
         __pyx_t_7.handle_unicode_errors = __pyx_t_6;
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_utf8(__pyx_v_fo, 0, &__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_utf8(__pyx_v_fo, 0, &__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 458, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_XDECREF_SET(__pyx_v_key, ((PyObject*)__pyx_t_1));
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":453
+        /* "fastavro/_read.pyx":461
  *                 read_items[key] = _read_data(
  *                     fo,
  *                     writer_schema["values"],             # <<<<<<<<<<<<<<
  *                     named_schemas,
  *                     reader_schema["values"],
  */
-        __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 461, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
 
-        /* "fastavro/_read.pyx":455
+        /* "fastavro/_read.pyx":463
  *                     writer_schema["values"],
  *                     named_schemas,
  *                     reader_schema["values"],             # <<<<<<<<<<<<<<
  *                     options,
  *                 )
  */
-        __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_v_reader_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 455, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_v_reader_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 463, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
 
-        /* "fastavro/_read.pyx":451
+        /* "fastavro/_read.pyx":459
  *             for i in range(block_count):
  *                 key = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  *                 read_items[key] = _read_data(             # <<<<<<<<<<<<<<
  *                     fo,
  *                     writer_schema["values"],
  */
         __pyx_t_9.__pyx_n = 2;
         __pyx_t_9.reader_schema = __pyx_t_6;
         __pyx_t_9.options = __pyx_v_options;
-        __pyx_t_8 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_1, __pyx_v_named_schemas, 0, &__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 451, __pyx_L1_error)
+        __pyx_t_8 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_1, __pyx_v_named_schemas, 0, &__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 459, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_v_read_items, __pyx_v_key, __pyx_t_8) < 0)) __PYX_ERR(0, 451, __pyx_L1_error)
+        if (unlikely(PyDict_SetItem(__pyx_v_read_items, __pyx_v_key, __pyx_t_8) < 0)) __PYX_ERR(0, 459, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       }
 
-      /* "fastavro/_read.pyx":448
+      /* "fastavro/_read.pyx":456
  *             read_long(fo)
  * 
  *         if reader_schema:             # <<<<<<<<<<<<<<
  *             for i in range(block_count):
  *                 key = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  */
       goto __pyx_L6;
     }
 
-    /* "fastavro/_read.pyx":459
+    /* "fastavro/_read.pyx":467
  *                 )
  *         else:
  *             for i in range(block_count):             # <<<<<<<<<<<<<<
  *                 key = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  *                 read_items[key] = _read_data(
  */
     /*else*/ {
       __pyx_t_2 = __pyx_v_block_count;
       __pyx_t_4 = __pyx_t_2;
       for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
         __pyx_v_i = __pyx_t_5;
 
-        /* "fastavro/_read.pyx":460
+        /* "fastavro/_read.pyx":468
  *         else:
  *             for i in range(block_count):
  *                 key = read_utf8(fo, options.get("handle_unicode_errors", "strict"))             # <<<<<<<<<<<<<<
  *                 read_items[key] = _read_data(
  *                     fo,
  */
-        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_options, __pyx_n_s_get); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 460, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_options, __pyx_n_s_get); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 468, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 460, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 468, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __pyx_t_7.__pyx_n = 1;
         __pyx_t_7.handle_unicode_errors = __pyx_t_6;
-        __pyx_t_8 = __pyx_f_8fastavro_5_read_read_utf8(__pyx_v_fo, 0, &__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 460, __pyx_L1_error)
+        __pyx_t_8 = __pyx_f_8fastavro_5_read_read_utf8(__pyx_v_fo, 0, &__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 468, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_XDECREF_SET(__pyx_v_key, ((PyObject*)__pyx_t_8));
         __pyx_t_8 = 0;
 
-        /* "fastavro/_read.pyx":463
+        /* "fastavro/_read.pyx":471
  *                 read_items[key] = _read_data(
  *                     fo,
  *                     writer_schema["values"],             # <<<<<<<<<<<<<<
  *                     named_schemas,
  *                     None,
  */
-        __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 463, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 471, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
 
-        /* "fastavro/_read.pyx":461
+        /* "fastavro/_read.pyx":469
  *             for i in range(block_count):
  *                 key = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  *                 read_items[key] = _read_data(             # <<<<<<<<<<<<<<
  *                     fo,
  *                     writer_schema["values"],
  */
         __pyx_t_9.__pyx_n = 2;
         __pyx_t_9.reader_schema = Py_None;
         __pyx_t_9.options = __pyx_v_options;
-        __pyx_t_6 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_8, __pyx_v_named_schemas, 0, &__pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 461, __pyx_L1_error)
+        __pyx_t_6 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_8, __pyx_v_named_schemas, 0, &__pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 469, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        if (unlikely(PyDict_SetItem(__pyx_v_read_items, __pyx_v_key, __pyx_t_6) < 0)) __PYX_ERR(0, 461, __pyx_L1_error)
+        if (unlikely(PyDict_SetItem(__pyx_v_read_items, __pyx_v_key, __pyx_t_6) < 0)) __PYX_ERR(0, 469, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       }
     }
     __pyx_L6:;
 
-    /* "fastavro/_read.pyx":468
+    /* "fastavro/_read.pyx":476
  *                     options,
  *                 )
  *         block_count = read_long(fo)             # <<<<<<<<<<<<<<
  * 
  *     return read_items
  */
-    __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 468, __pyx_L1_error)
+    __pyx_t_2 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_2 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 476, __pyx_L1_error)
     __pyx_v_block_count = __pyx_t_2;
   }
 
-  /* "fastavro/_read.pyx":470
+  /* "fastavro/_read.pyx":478
  *         block_count = read_long(fo)
  * 
  *     return read_items             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_read_items);
   __pyx_r = __pyx_v_read_items;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":418
+  /* "fastavro/_read.pyx":426
  * 
  * 
  * cpdef read_map(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
@@ -8221,17 +8452,17 @@
   __Pyx_XDECREF(__pyx_v_key);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_47read_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_46read_map[] = "Maps are encoded as a series of blocks.\n\n    Each block consists of a long count value, followed by that many key/value\n    pairs.  A block with count zero indicates the end of the map.  Each item is\n    encoded per the map's value schema.\n\n    If a block's count is negative, then the count is followed immediately by a\n    long block size, indicating the number of bytes in the block.  The actual\n    count in this case is the absolute value of the count written.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_47read_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_49read_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_48read_map[] = "Maps are encoded as a series of blocks.\n\n    Each block consists of a long count value, followed by that many key/value\n    pairs.  A block with count zero indicates the end of the map.  Each item is\n    encoded per the map's value schema.\n\n    If a block's count is negative, then the count is followed immediately by a\n    long block size, indicating the number of bytes in the block.  The actual\n    count in this case is the absolute value of the count written.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_49read_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   PyObject *__pyx_v_reader_schema = 0;
   PyObject *__pyx_v_options = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -8239,15 +8470,15 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_map (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_fo,&__pyx_n_s_writer_schema,&__pyx_n_s_named_schemas,&__pyx_n_s_reader_schema,&__pyx_n_s_options,0};
     PyObject* values[5] = {0,0,0,0,0};
 
-    /* "fastavro/_read.pyx":422
+    /* "fastavro/_read.pyx":430
  *     writer_schema,
  *     named_schemas,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     options={},
  * ):
  */
     values[3] = ((PyObject *)Py_None);
@@ -8274,21 +8505,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_map", 0, 3, 5, 1); __PYX_ERR(0, 418, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_map", 0, 3, 5, 1); __PYX_ERR(0, 426, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_map", 0, 3, 5, 2); __PYX_ERR(0, 418, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_map", 0, 3, 5, 2); __PYX_ERR(0, 426, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -8296,15 +8527,15 @@
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_options);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_map") < 0)) __PYX_ERR(0, 418, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_map") < 0)) __PYX_ERR(0, 426, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
@@ -8319,49 +8550,49 @@
     __pyx_v_writer_schema = values[1];
     __pyx_v_named_schemas = values[2];
     __pyx_v_reader_schema = values[3];
     __pyx_v_options = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_map", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 418, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_map", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 426, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.read_map", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_46read_map(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
+  __pyx_r = __pyx_pf_8fastavro_5_read_48read_map(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
 
-  /* "fastavro/_read.pyx":418
+  /* "fastavro/_read.pyx":426
  * 
  * 
  * cpdef read_map(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_46read_map(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
+static PyObject *__pyx_pf_8fastavro_5_read_48read_map(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8fastavro_5_read_read_map __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_map", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.reader_schema = __pyx_v_reader_schema;
   __pyx_t_2.options = __pyx_v_options;
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_map(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_map(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -8370,23 +8601,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":473
+/* "fastavro/_read.pyx":481
  * 
  * 
  * cpdef skip_map(fo, writer_schema, named_schemas):             # <<<<<<<<<<<<<<
  *     """Maps are encoded as a series of blocks.
  * 
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_49skip_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_51skip_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_map(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __pyx_t_8fastavro_5_read_long64 __pyx_v_block_count;
   CYTHON_UNUSED __pyx_t_8fastavro_5_read_long64 __pyx_v_i;
   __pyx_t_8fastavro_5_read_long64 __pyx_v_block_size;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
@@ -8398,147 +8629,147 @@
   __pyx_t_8fastavro_5_read_long64 __pyx_t_7;
   __pyx_t_8fastavro_5_read_long64 __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_map", 0);
 
-  /* "fastavro/_read.pyx":487
+  /* "fastavro/_read.pyx":495
  *     cdef long64 i
  * 
  *     block_count = read_long(fo)             # <<<<<<<<<<<<<<
  *     while block_count != 0:
  *         if block_count < 0:
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 487, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 495, __pyx_L1_error)
   __pyx_v_block_count = __pyx_t_1;
 
-  /* "fastavro/_read.pyx":488
+  /* "fastavro/_read.pyx":496
  * 
  *     block_count = read_long(fo)
  *     while block_count != 0:             # <<<<<<<<<<<<<<
  *         if block_count < 0:
  *             block_size = read_long(fo)
  */
   while (1) {
     __pyx_t_2 = ((__pyx_v_block_count != 0) != 0);
     if (!__pyx_t_2) break;
 
-    /* "fastavro/_read.pyx":489
+    /* "fastavro/_read.pyx":497
  *     block_count = read_long(fo)
  *     while block_count != 0:
  *         if block_count < 0:             # <<<<<<<<<<<<<<
  *             block_size = read_long(fo)
  *             fo.read(block_size)
  */
     __pyx_t_2 = ((__pyx_v_block_count < 0) != 0);
     if (__pyx_t_2) {
 
-      /* "fastavro/_read.pyx":490
+      /* "fastavro/_read.pyx":498
  *     while block_count != 0:
  *         if block_count < 0:
  *             block_size = read_long(fo)             # <<<<<<<<<<<<<<
  *             fo.read(block_size)
  *         else:
  */
-      __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 490, __pyx_L1_error)
+      __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 498, __pyx_L1_error)
       __pyx_v_block_size = __pyx_t_1;
 
-      /* "fastavro/_read.pyx":491
+      /* "fastavro/_read.pyx":499
  *         if block_count < 0:
  *             block_size = read_long(fo)
  *             fo.read(block_size)             # <<<<<<<<<<<<<<
  *         else:
  *             for i in range(block_count):
  */
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 491, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 499, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_block_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 491, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_block_size); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 499, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_t_6 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 499, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "fastavro/_read.pyx":489
+      /* "fastavro/_read.pyx":497
  *     block_count = read_long(fo)
  *     while block_count != 0:
  *         if block_count < 0:             # <<<<<<<<<<<<<<
  *             block_size = read_long(fo)
  *             fo.read(block_size)
  */
       goto __pyx_L5;
     }
 
-    /* "fastavro/_read.pyx":493
+    /* "fastavro/_read.pyx":501
  *             fo.read(block_size)
  *         else:
  *             for i in range(block_count):             # <<<<<<<<<<<<<<
  *                 skip_utf8(fo)
  *                 _skip_data(fo, writer_schema["values"], named_schemas)
  */
     /*else*/ {
       __pyx_t_1 = __pyx_v_block_count;
       __pyx_t_7 = __pyx_t_1;
       for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
         __pyx_v_i = __pyx_t_8;
 
-        /* "fastavro/_read.pyx":494
+        /* "fastavro/_read.pyx":502
  *         else:
  *             for i in range(block_count):
  *                 skip_utf8(fo)             # <<<<<<<<<<<<<<
  *                 _skip_data(fo, writer_schema["values"], named_schemas)
  * 
  */
-        __pyx_t_3 = __pyx_f_8fastavro_5_read_skip_utf8(__pyx_v_fo, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 494, __pyx_L1_error)
+        __pyx_t_3 = __pyx_f_8fastavro_5_read_skip_utf8(__pyx_v_fo, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 502, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-        /* "fastavro/_read.pyx":495
+        /* "fastavro/_read.pyx":503
  *             for i in range(block_count):
  *                 skip_utf8(fo)
  *                 _skip_data(fo, writer_schema["values"], named_schemas)             # <<<<<<<<<<<<<<
  * 
  *         block_count = read_long(fo)
  */
-        __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_values); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 503, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_3, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 495, __pyx_L1_error)
+        __pyx_t_4 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_3, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 503, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       }
     }
     __pyx_L5:;
 
-    /* "fastavro/_read.pyx":497
+    /* "fastavro/_read.pyx":505
  *                 _skip_data(fo, writer_schema["values"], named_schemas)
  * 
  *         block_count = read_long(fo)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 497, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 505, __pyx_L1_error)
     __pyx_v_block_count = __pyx_t_1;
   }
 
-  /* "fastavro/_read.pyx":473
+  /* "fastavro/_read.pyx":481
  * 
  * 
  * cpdef skip_map(fo, writer_schema, named_schemas):             # <<<<<<<<<<<<<<
  *     """Maps are encoded as a series of blocks.
  * 
  */
 
@@ -8555,17 +8786,17 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_49skip_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_48skip_map[] = "Maps are encoded as a series of blocks.\n\n    Each block consists of a long count value, followed by that many key/value\n    pairs.  A block with count zero indicates the end of the map.  Each item is\n    encoded per the map's value schema.\n\n    If a block's count is negative, then the count is followed immediately by a\n    long block size, indicating the number of bytes in the block.  The actual\n    count in this case is the absolute value of the count written.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_49skip_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_51skip_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_50skip_map[] = "Maps are encoded as a series of blocks.\n\n    Each block consists of a long count value, followed by that many key/value\n    pairs.  A block with count zero indicates the end of the map.  Each item is\n    encoded per the map's value schema.\n\n    If a block's count is negative, then the count is followed immediately by a\n    long block size, indicating the number of bytes in the block.  The actual\n    count in this case is the absolute value of the count written.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_51skip_map(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -8592,62 +8823,62 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("skip_map", 1, 3, 3, 1); __PYX_ERR(0, 473, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("skip_map", 1, 3, 3, 1); __PYX_ERR(0, 481, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("skip_map", 1, 3, 3, 2); __PYX_ERR(0, 473, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("skip_map", 1, 3, 3, 2); __PYX_ERR(0, 481, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_map") < 0)) __PYX_ERR(0, 473, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_map") < 0)) __PYX_ERR(0, 481, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_fo = values[0];
     __pyx_v_writer_schema = values[1];
     __pyx_v_named_schemas = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("skip_map", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 473, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("skip_map", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 481, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.skip_map", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_48skip_map(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas);
+  __pyx_r = __pyx_pf_8fastavro_5_read_50skip_map(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_48skip_map(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas) {
+static PyObject *__pyx_pf_8fastavro_5_read_50skip_map(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_map", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_map(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_map(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -8656,26 +8887,26 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":500
+/* "fastavro/_read.pyx":508
  * 
  * 
  * cpdef read_union(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_51read_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_53read_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_read_union(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8fastavro_5_read_read_union *__pyx_optional_args) {
 
-  /* "fastavro/_read.pyx":504
+  /* "fastavro/_read.pyx":512
  *     writer_schema,
  *     named_schemas,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     options={}
  * ):
  */
   PyObject *__pyx_v_reader_schema = ((PyObject *)Py_None);
@@ -8708,640 +8939,640 @@
       __pyx_v_reader_schema = __pyx_optional_args->reader_schema;
       if (__pyx_optional_args->__pyx_n > 1) {
         __pyx_v_options = __pyx_optional_args->options;
       }
     }
   }
 
-  /* "fastavro/_read.pyx":513
+  /* "fastavro/_read.pyx":521
  *     """
  *     # schema resolution
  *     index = read_long(fo)             # <<<<<<<<<<<<<<
  *     idx_schema = writer_schema[index]
  * 
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 513, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 521, __pyx_L1_error)
   __pyx_v_index = __pyx_t_1;
 
-  /* "fastavro/_read.pyx":514
+  /* "fastavro/_read.pyx":522
  *     # schema resolution
  *     index = read_long(fo)
  *     idx_schema = writer_schema[index]             # <<<<<<<<<<<<<<
  * 
  *     if reader_schema:
  */
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_writer_schema, __pyx_v_index, __pyx_t_8fastavro_5_read_long64, 1, __Pyx_PyInt_From_PY_LONG_LONG, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 514, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_writer_schema, __pyx_v_index, __pyx_t_8fastavro_5_read_long64, 1, __Pyx_PyInt_From_PY_LONG_LONG, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_v_idx_schema = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":516
+  /* "fastavro/_read.pyx":524
  *     idx_schema = writer_schema[index]
  * 
  *     if reader_schema:             # <<<<<<<<<<<<<<
  *         # Handle case where the reader schema is just a single type (not union)
  *         if not isinstance(reader_schema, list):
  */
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 516, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 524, __pyx_L1_error)
   if (__pyx_t_3) {
 
-    /* "fastavro/_read.pyx":518
+    /* "fastavro/_read.pyx":526
  *     if reader_schema:
  *         # Handle case where the reader schema is just a single type (not union)
  *         if not isinstance(reader_schema, list):             # <<<<<<<<<<<<<<
- *             if match_types(idx_schema, reader_schema):
+ *             if match_types(idx_schema, reader_schema, named_schemas):
  *                 return _read_data(
  */
     __pyx_t_3 = PyList_Check(__pyx_v_reader_schema); 
     __pyx_t_4 = ((!(__pyx_t_3 != 0)) != 0);
     if (__pyx_t_4) {
 
-      /* "fastavro/_read.pyx":519
+      /* "fastavro/_read.pyx":527
  *         # Handle case where the reader schema is just a single type (not union)
  *         if not isinstance(reader_schema, list):
- *             if match_types(idx_schema, reader_schema):             # <<<<<<<<<<<<<<
+ *             if match_types(idx_schema, reader_schema, named_schemas):             # <<<<<<<<<<<<<<
  *                 return _read_data(
  *                     fo,
  */
-      __pyx_t_2 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_idx_schema, __pyx_v_reader_schema, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 519, __pyx_L1_error)
+      __pyx_t_2 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_idx_schema, __pyx_v_reader_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 527, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 519, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 527, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":520
+        /* "fastavro/_read.pyx":528
  *         if not isinstance(reader_schema, list):
- *             if match_types(idx_schema, reader_schema):
+ *             if match_types(idx_schema, reader_schema, named_schemas):
  *                 return _read_data(             # <<<<<<<<<<<<<<
  *                     fo,
  *                     idx_schema,
  */
         __Pyx_XDECREF(__pyx_r);
 
-        /* "fastavro/_read.pyx":525
+        /* "fastavro/_read.pyx":533
  *                     named_schemas,
  *                     reader_schema,
  *                     options,             # <<<<<<<<<<<<<<
  *                 )
  *         else:
  */
         __pyx_t_5.__pyx_n = 2;
         __pyx_t_5.reader_schema = __pyx_v_reader_schema;
         __pyx_t_5.options = __pyx_v_options;
-        __pyx_t_2 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 520, __pyx_L1_error)
+        __pyx_t_2 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 528, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __pyx_r = __pyx_t_2;
         __pyx_t_2 = 0;
         goto __pyx_L0;
 
-        /* "fastavro/_read.pyx":519
+        /* "fastavro/_read.pyx":527
  *         # Handle case where the reader schema is just a single type (not union)
  *         if not isinstance(reader_schema, list):
- *             if match_types(idx_schema, reader_schema):             # <<<<<<<<<<<<<<
+ *             if match_types(idx_schema, reader_schema, named_schemas):             # <<<<<<<<<<<<<<
  *                 return _read_data(
  *                     fo,
  */
       }
 
-      /* "fastavro/_read.pyx":518
+      /* "fastavro/_read.pyx":526
  *     if reader_schema:
  *         # Handle case where the reader schema is just a single type (not union)
  *         if not isinstance(reader_schema, list):             # <<<<<<<<<<<<<<
- *             if match_types(idx_schema, reader_schema):
+ *             if match_types(idx_schema, reader_schema, named_schemas):
  *                 return _read_data(
  */
       goto __pyx_L4;
     }
 
-    /* "fastavro/_read.pyx":528
+    /* "fastavro/_read.pyx":536
  *                 )
  *         else:
  *             for schema in reader_schema:             # <<<<<<<<<<<<<<
- *                 if match_types(idx_schema, schema):
+ *                 if match_types(idx_schema, schema, named_schemas):
  *                     return _read_data(
  */
     /*else*/ {
       if (likely(PyList_CheckExact(__pyx_v_reader_schema)) || PyTuple_CheckExact(__pyx_v_reader_schema)) {
         __pyx_t_2 = __pyx_v_reader_schema; __Pyx_INCREF(__pyx_t_2); __pyx_t_6 = 0;
         __pyx_t_7 = NULL;
       } else {
-        __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_reader_schema); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 528, __pyx_L1_error)
+        __pyx_t_6 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_v_reader_schema); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 536, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 528, __pyx_L1_error)
+        __pyx_t_7 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 536, __pyx_L1_error)
       }
       for (;;) {
         if (likely(!__pyx_t_7)) {
           if (likely(PyList_CheckExact(__pyx_t_2))) {
             if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_2)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_8 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 528, __pyx_L1_error)
+            __pyx_t_8 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 536, __pyx_L1_error)
             #else
-            __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 528, __pyx_L1_error)
+            __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 536, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_8);
             #endif
           } else {
             if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 528, __pyx_L1_error)
+            __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_6); __Pyx_INCREF(__pyx_t_8); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 536, __pyx_L1_error)
             #else
-            __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 528, __pyx_L1_error)
+            __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 536, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_8);
             #endif
           }
         } else {
           __pyx_t_8 = __pyx_t_7(__pyx_t_2);
           if (unlikely(!__pyx_t_8)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 528, __pyx_L1_error)
+              else __PYX_ERR(0, 536, __pyx_L1_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_8);
         }
         __Pyx_XDECREF_SET(__pyx_v_schema, __pyx_t_8);
         __pyx_t_8 = 0;
 
-        /* "fastavro/_read.pyx":529
+        /* "fastavro/_read.pyx":537
  *         else:
  *             for schema in reader_schema:
- *                 if match_types(idx_schema, schema):             # <<<<<<<<<<<<<<
+ *                 if match_types(idx_schema, schema, named_schemas):             # <<<<<<<<<<<<<<
  *                     return _read_data(
  *                         fo,
  */
-        __pyx_t_8 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_idx_schema, __pyx_v_schema, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 529, __pyx_L1_error)
+        __pyx_t_8 = __pyx_f_8fastavro_5_read_match_types(__pyx_v_idx_schema, __pyx_v_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 537, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 529, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 537, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         if (__pyx_t_4) {
 
-          /* "fastavro/_read.pyx":530
+          /* "fastavro/_read.pyx":538
  *             for schema in reader_schema:
- *                 if match_types(idx_schema, schema):
+ *                 if match_types(idx_schema, schema, named_schemas):
  *                     return _read_data(             # <<<<<<<<<<<<<<
  *                         fo,
  *                         idx_schema,
  */
           __Pyx_XDECREF(__pyx_r);
 
-          /* "fastavro/_read.pyx":535
+          /* "fastavro/_read.pyx":543
  *                         named_schemas,
  *                         schema,
  *                         options,             # <<<<<<<<<<<<<<
  *                     )
  *         msg = f"schema mismatch: {writer_schema} not found in {reader_schema}"
  */
           __pyx_t_5.__pyx_n = 2;
           __pyx_t_5.reader_schema = __pyx_v_schema;
           __pyx_t_5.options = __pyx_v_options;
-          __pyx_t_8 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 530, __pyx_L1_error)
+          __pyx_t_8 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 538, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __pyx_r = __pyx_t_8;
           __pyx_t_8 = 0;
           __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
           goto __pyx_L0;
 
-          /* "fastavro/_read.pyx":529
+          /* "fastavro/_read.pyx":537
  *         else:
  *             for schema in reader_schema:
- *                 if match_types(idx_schema, schema):             # <<<<<<<<<<<<<<
+ *                 if match_types(idx_schema, schema, named_schemas):             # <<<<<<<<<<<<<<
  *                     return _read_data(
  *                         fo,
  */
         }
 
-        /* "fastavro/_read.pyx":528
+        /* "fastavro/_read.pyx":536
  *                 )
  *         else:
  *             for schema in reader_schema:             # <<<<<<<<<<<<<<
- *                 if match_types(idx_schema, schema):
+ *                 if match_types(idx_schema, schema, named_schemas):
  *                     return _read_data(
  */
       }
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __pyx_L4:;
 
-    /* "fastavro/_read.pyx":537
+    /* "fastavro/_read.pyx":545
  *                         options,
  *                     )
  *         msg = f"schema mismatch: {writer_schema} not found in {reader_schema}"             # <<<<<<<<<<<<<<
  *         raise SchemaResolutionError(msg)
  *     else:
  */
-    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 537, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 545, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_6 = 0;
     __pyx_t_9 = 127;
     __Pyx_INCREF(__pyx_kp_u_schema_mismatch);
     __pyx_t_6 += 17;
     __Pyx_GIVEREF(__pyx_kp_u_schema_mismatch);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_kp_u_schema_mismatch);
-    __pyx_t_8 = __Pyx_PyObject_FormatSimple(__pyx_v_writer_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 537, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_FormatSimple(__pyx_v_writer_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 545, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_9 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_8) > __pyx_t_9) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_8) : __pyx_t_9;
     __pyx_t_6 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_8);
     __pyx_t_8 = 0;
     __Pyx_INCREF(__pyx_kp_u_not_found_in);
     __pyx_t_6 += 14;
     __Pyx_GIVEREF(__pyx_kp_u_not_found_in);
     PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_u_not_found_in);
-    __pyx_t_8 = __Pyx_PyObject_FormatSimple(__pyx_v_reader_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 537, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_FormatSimple(__pyx_v_reader_schema, __pyx_empty_unicode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 545, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_9 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_8) > __pyx_t_9) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_8) : __pyx_t_9;
     __pyx_t_6 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_2, 3, __pyx_t_8);
     __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyUnicode_Join(__pyx_t_2, 4, __pyx_t_6, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 537, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyUnicode_Join(__pyx_t_2, 4, __pyx_t_6, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 545, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_msg = ((PyObject*)__pyx_t_8);
     __pyx_t_8 = 0;
 
-    /* "fastavro/_read.pyx":538
+    /* "fastavro/_read.pyx":546
  *                     )
  *         msg = f"schema mismatch: {writer_schema} not found in {reader_schema}"
  *         raise SchemaResolutionError(msg)             # <<<<<<<<<<<<<<
  *     else:
  *         return_record_name_override = options.get("return_record_name_override")
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 538, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 546, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_8 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_10, __pyx_v_msg) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_msg);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 538, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 546, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_Raise(__pyx_t_8, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __PYX_ERR(0, 538, __pyx_L1_error)
+    __PYX_ERR(0, 546, __pyx_L1_error)
 
-    /* "fastavro/_read.pyx":516
+    /* "fastavro/_read.pyx":524
  *     idx_schema = writer_schema[index]
  * 
  *     if reader_schema:             # <<<<<<<<<<<<<<
  *         # Handle case where the reader schema is just a single type (not union)
  *         if not isinstance(reader_schema, list):
  */
   }
 
-  /* "fastavro/_read.pyx":540
+  /* "fastavro/_read.pyx":548
  *         raise SchemaResolutionError(msg)
  *     else:
  *         return_record_name_override = options.get("return_record_name_override")             # <<<<<<<<<<<<<<
  *         return_record_name = options.get("return_record_name")
  *         if return_record_name_override and is_nullable_union(writer_schema):
  */
   /*else*/ {
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_options, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 540, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_options, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 548, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_8 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_10, __pyx_n_u_return_record_name_override) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_n_u_return_record_name_override);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 540, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 548, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_return_record_name_override = __pyx_t_8;
     __pyx_t_8 = 0;
 
-    /* "fastavro/_read.pyx":541
+    /* "fastavro/_read.pyx":549
  *     else:
  *         return_record_name_override = options.get("return_record_name_override")
  *         return_record_name = options.get("return_record_name")             # <<<<<<<<<<<<<<
  *         if return_record_name_override and is_nullable_union(writer_schema):
  *             return _read_data(fo, idx_schema, named_schemas, None, options)
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_options, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 541, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_options, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 549, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_8 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_10, __pyx_n_u_return_record_name) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_n_u_return_record_name);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 541, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 549, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_return_record_name = __pyx_t_8;
     __pyx_t_8 = 0;
 
-    /* "fastavro/_read.pyx":542
+    /* "fastavro/_read.pyx":550
  *         return_record_name_override = options.get("return_record_name_override")
  *         return_record_name = options.get("return_record_name")
  *         if return_record_name_override and is_nullable_union(writer_schema):             # <<<<<<<<<<<<<<
  *             return _read_data(fo, idx_schema, named_schemas, None, options)
  *         elif return_record_name and extract_record_type(idx_schema) == "record":
  */
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_return_record_name_override); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 542, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_return_record_name_override); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 550, __pyx_L1_error)
     if (__pyx_t_3) {
     } else {
       __pyx_t_4 = __pyx_t_3;
       goto __pyx_L10_bool_binop_done;
     }
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_is_nullable_union); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 542, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_is_nullable_union); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 550, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_8 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_10, __pyx_v_writer_schema) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_writer_schema);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 542, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 550, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 542, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 550, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_t_4 = __pyx_t_3;
     __pyx_L10_bool_binop_done:;
     if (__pyx_t_4) {
 
-      /* "fastavro/_read.pyx":543
+      /* "fastavro/_read.pyx":551
  *         return_record_name = options.get("return_record_name")
  *         if return_record_name_override and is_nullable_union(writer_schema):
  *             return _read_data(fo, idx_schema, named_schemas, None, options)             # <<<<<<<<<<<<<<
  *         elif return_record_name and extract_record_type(idx_schema) == "record":
  *             return (
  */
       __Pyx_XDECREF(__pyx_r);
       __pyx_t_5.__pyx_n = 2;
       __pyx_t_5.reader_schema = Py_None;
       __pyx_t_5.options = __pyx_v_options;
-      __pyx_t_8 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 543, __pyx_L1_error)
+      __pyx_t_8 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 551, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_r = __pyx_t_8;
       __pyx_t_8 = 0;
       goto __pyx_L0;
 
-      /* "fastavro/_read.pyx":542
+      /* "fastavro/_read.pyx":550
  *         return_record_name_override = options.get("return_record_name_override")
  *         return_record_name = options.get("return_record_name")
  *         if return_record_name_override and is_nullable_union(writer_schema):             # <<<<<<<<<<<<<<
  *             return _read_data(fo, idx_schema, named_schemas, None, options)
  *         elif return_record_name and extract_record_type(idx_schema) == "record":
  */
     }
 
-    /* "fastavro/_read.pyx":544
+    /* "fastavro/_read.pyx":552
  *         if return_record_name_override and is_nullable_union(writer_schema):
  *             return _read_data(fo, idx_schema, named_schemas, None, options)
  *         elif return_record_name and extract_record_type(idx_schema) == "record":             # <<<<<<<<<<<<<<
  *             return (
  *                 idx_schema["name"],
  */
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_return_record_name); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 544, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_return_record_name); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 552, __pyx_L1_error)
     if (__pyx_t_3) {
     } else {
       __pyx_t_4 = __pyx_t_3;
       goto __pyx_L12_bool_binop_done;
     }
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_extract_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 544, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_extract_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 552, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_8 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_10, __pyx_v_idx_schema) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_idx_schema);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 544, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 552, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_record, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 544, __pyx_L1_error)
+    __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_record, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 552, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_t_4 = __pyx_t_3;
     __pyx_L12_bool_binop_done:;
     if (__pyx_t_4) {
 
-      /* "fastavro/_read.pyx":545
+      /* "fastavro/_read.pyx":553
  *             return _read_data(fo, idx_schema, named_schemas, None, options)
  *         elif return_record_name and extract_record_type(idx_schema) == "record":
  *             return (             # <<<<<<<<<<<<<<
  *                 idx_schema["name"],
  *                 _read_data(
  */
       __Pyx_XDECREF(__pyx_r);
 
-      /* "fastavro/_read.pyx":546
+      /* "fastavro/_read.pyx":554
  *         elif return_record_name and extract_record_type(idx_schema) == "record":
  *             return (
  *                 idx_schema["name"],             # <<<<<<<<<<<<<<
  *                 _read_data(
  *                     fo,
  */
-      __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_idx_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 546, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_idx_schema, __pyx_n_u_name); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 554, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
 
-      /* "fastavro/_read.pyx":547
+      /* "fastavro/_read.pyx":555
  *             return (
  *                 idx_schema["name"],
  *                 _read_data(             # <<<<<<<<<<<<<<
  *                     fo,
  *                     idx_schema,
  */
       __pyx_t_5.__pyx_n = 2;
       __pyx_t_5.reader_schema = Py_None;
       __pyx_t_5.options = __pyx_v_options;
-      __pyx_t_2 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 547, __pyx_L1_error)
+      __pyx_t_2 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 555, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
 
-      /* "fastavro/_read.pyx":546
+      /* "fastavro/_read.pyx":554
  *         elif return_record_name and extract_record_type(idx_schema) == "record":
  *             return (
  *                 idx_schema["name"],             # <<<<<<<<<<<<<<
  *                 _read_data(
  *                     fo,
  */
-      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 546, __pyx_L1_error)
+      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 554, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_2);
       __pyx_t_8 = 0;
       __pyx_t_2 = 0;
       __pyx_r = __pyx_t_10;
       __pyx_t_10 = 0;
       goto __pyx_L0;
 
-      /* "fastavro/_read.pyx":544
+      /* "fastavro/_read.pyx":552
  *         if return_record_name_override and is_nullable_union(writer_schema):
  *             return _read_data(fo, idx_schema, named_schemas, None, options)
  *         elif return_record_name and extract_record_type(idx_schema) == "record":             # <<<<<<<<<<<<<<
  *             return (
  *                 idx_schema["name"],
  */
     }
 
-    /* "fastavro/_read.pyx":555
+    /* "fastavro/_read.pyx":563
  *                 )
  *             )
  *         elif return_record_name and extract_record_type(idx_schema) not in AVRO_TYPES:             # <<<<<<<<<<<<<<
  *             # idx_schema is a named type
  *             return (
  */
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_return_record_name); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 555, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_return_record_name); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 563, __pyx_L1_error)
     if (__pyx_t_3) {
     } else {
       __pyx_t_4 = __pyx_t_3;
       goto __pyx_L14_bool_binop_done;
     }
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_extract_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 555, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_extract_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 563, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_10 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_8, __pyx_v_idx_schema) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_idx_schema);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 555, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 563, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_AVRO_TYPES); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 555, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_AVRO_TYPES); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 563, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_t_10, __pyx_t_2, Py_NE)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 555, __pyx_L1_error)
+    __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_t_10, __pyx_t_2, Py_NE)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 563, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_11 = (__pyx_t_3 != 0);
     __pyx_t_4 = __pyx_t_11;
     __pyx_L14_bool_binop_done:;
     if (__pyx_t_4) {
 
-      /* "fastavro/_read.pyx":557
+      /* "fastavro/_read.pyx":565
  *         elif return_record_name and extract_record_type(idx_schema) not in AVRO_TYPES:
  *             # idx_schema is a named type
  *             return (             # <<<<<<<<<<<<<<
  *                 named_schemas["writer"][idx_schema]["name"],
  *                 _read_data(fo, idx_schema, named_schemas, None, options)
  */
       __Pyx_XDECREF(__pyx_r);
 
-      /* "fastavro/_read.pyx":558
+      /* "fastavro/_read.pyx":566
  *             # idx_schema is a named type
  *             return (
  *                 named_schemas["writer"][idx_schema]["name"],             # <<<<<<<<<<<<<<
  *                 _read_data(fo, idx_schema, named_schemas, None, options)
  *             )
  */
-      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_writer); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 558, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_writer); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_idx_schema); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 558, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_v_idx_schema); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 566, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_10, __pyx_n_u_name); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 558, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_10, __pyx_n_u_name); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-      /* "fastavro/_read.pyx":559
+      /* "fastavro/_read.pyx":567
  *             return (
  *                 named_schemas["writer"][idx_schema]["name"],
  *                 _read_data(fo, idx_schema, named_schemas, None, options)             # <<<<<<<<<<<<<<
  *             )
  * 
  */
       __pyx_t_5.__pyx_n = 2;
       __pyx_t_5.reader_schema = Py_None;
       __pyx_t_5.options = __pyx_v_options;
-      __pyx_t_10 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 559, __pyx_L1_error)
+      __pyx_t_10 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 567, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
 
-      /* "fastavro/_read.pyx":558
+      /* "fastavro/_read.pyx":566
  *             # idx_schema is a named type
  *             return (
  *                 named_schemas["writer"][idx_schema]["name"],             # <<<<<<<<<<<<<<
  *                 _read_data(fo, idx_schema, named_schemas, None, options)
  *             )
  */
-      __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 558, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 566, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_10);
       PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_10);
       __pyx_t_2 = 0;
       __pyx_t_10 = 0;
       __pyx_r = __pyx_t_8;
       __pyx_t_8 = 0;
       goto __pyx_L0;
 
-      /* "fastavro/_read.pyx":555
+      /* "fastavro/_read.pyx":563
  *                 )
  *             )
  *         elif return_record_name and extract_record_type(idx_schema) not in AVRO_TYPES:             # <<<<<<<<<<<<<<
  *             # idx_schema is a named type
  *             return (
  */
     }
 
-    /* "fastavro/_read.pyx":563
+    /* "fastavro/_read.pyx":571
  * 
  *         else:
  *             return _read_data(fo, idx_schema, named_schemas, None, options)             # <<<<<<<<<<<<<<
  * 
  * 
  */
     /*else*/ {
       __Pyx_XDECREF(__pyx_r);
       __pyx_t_5.__pyx_n = 2;
       __pyx_t_5.reader_schema = Py_None;
       __pyx_t_5.options = __pyx_v_options;
-      __pyx_t_8 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 563, __pyx_L1_error)
+      __pyx_t_8 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_idx_schema, __pyx_v_named_schemas, 0, &__pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 571, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_r = __pyx_t_8;
       __pyx_t_8 = 0;
       goto __pyx_L0;
     }
   }
 
-  /* "fastavro/_read.pyx":500
+  /* "fastavro/_read.pyx":508
  * 
  * 
  * cpdef read_union(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
@@ -9360,17 +9591,17 @@
   __Pyx_XDECREF(__pyx_v_return_record_name);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_51read_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_50read_union[] = "A union is encoded by first writing a long value indicating the\n    zero-based position within the union of the schema of its value.\n\n    The value is then encoded per the indicated schema within the union.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_51read_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_53read_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_52read_union[] = "A union is encoded by first writing a long value indicating the\n    zero-based position within the union of the schema of its value.\n\n    The value is then encoded per the indicated schema within the union.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_53read_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   PyObject *__pyx_v_reader_schema = 0;
   PyObject *__pyx_v_options = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -9378,15 +9609,15 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_union (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_fo,&__pyx_n_s_writer_schema,&__pyx_n_s_named_schemas,&__pyx_n_s_reader_schema,&__pyx_n_s_options,0};
     PyObject* values[5] = {0,0,0,0,0};
 
-    /* "fastavro/_read.pyx":504
+    /* "fastavro/_read.pyx":512
  *     writer_schema,
  *     named_schemas,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     options={}
  * ):
  */
     values[3] = ((PyObject *)Py_None);
@@ -9413,21 +9644,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_union", 0, 3, 5, 1); __PYX_ERR(0, 500, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_union", 0, 3, 5, 1); __PYX_ERR(0, 508, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_union", 0, 3, 5, 2); __PYX_ERR(0, 500, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_union", 0, 3, 5, 2); __PYX_ERR(0, 508, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -9435,15 +9666,15 @@
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_options);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_union") < 0)) __PYX_ERR(0, 500, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_union") < 0)) __PYX_ERR(0, 508, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
@@ -9458,49 +9689,49 @@
     __pyx_v_writer_schema = values[1];
     __pyx_v_named_schemas = values[2];
     __pyx_v_reader_schema = values[3];
     __pyx_v_options = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_union", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 500, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_union", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 508, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.read_union", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_50read_union(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
+  __pyx_r = __pyx_pf_8fastavro_5_read_52read_union(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
 
-  /* "fastavro/_read.pyx":500
+  /* "fastavro/_read.pyx":508
  * 
  * 
  * cpdef read_union(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_50read_union(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
+static PyObject *__pyx_pf_8fastavro_5_read_52read_union(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8fastavro_5_read_read_union __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_union", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.reader_schema = __pyx_v_reader_schema;
   __pyx_t_2.options = __pyx_v_options;
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_union(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 500, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_union(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -9509,60 +9740,60 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":566
+/* "fastavro/_read.pyx":574
  * 
  * 
  * cpdef skip_union(fo, writer_schema, named_schemas):             # <<<<<<<<<<<<<<
  *     """A union is encoded by first writing a long value indicating the
  *     zero-based position within the union of the schema of its value.
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_53skip_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_55skip_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_union(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __pyx_t_8fastavro_5_read_long64 __pyx_v_index;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_union", 0);
 
-  /* "fastavro/_read.pyx":573
+  /* "fastavro/_read.pyx":581
  *     """
  *     # schema resolution
  *     index = read_long(fo)             # <<<<<<<<<<<<<<
  *     _skip_data(fo, writer_schema[index], named_schemas)
  * 
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 573, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 581, __pyx_L1_error)
   __pyx_v_index = __pyx_t_1;
 
-  /* "fastavro/_read.pyx":574
+  /* "fastavro/_read.pyx":582
  *     # schema resolution
  *     index = read_long(fo)
  *     _skip_data(fo, writer_schema[index], named_schemas)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_writer_schema, __pyx_v_index, __pyx_t_8fastavro_5_read_long64, 1, __Pyx_PyInt_From_PY_LONG_LONG, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_writer_schema, __pyx_v_index, __pyx_t_8fastavro_5_read_long64, 1, __Pyx_PyInt_From_PY_LONG_LONG, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 582, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_2, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 574, __pyx_L1_error)
+  __pyx_t_3 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_2, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 582, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "fastavro/_read.pyx":566
+  /* "fastavro/_read.pyx":574
  * 
  * 
  * cpdef skip_union(fo, writer_schema, named_schemas):             # <<<<<<<<<<<<<<
  *     """A union is encoded by first writing a long value indicating the
  *     zero-based position within the union of the schema of its value.
  */
 
@@ -9577,17 +9808,17 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_53skip_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_52skip_union[] = "A union is encoded by first writing a long value indicating the\n    zero-based position within the union of the schema of its value.\n\n    The value is then encoded per the indicated schema within the union.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_53skip_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_55skip_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_54skip_union[] = "A union is encoded by first writing a long value indicating the\n    zero-based position within the union of the schema of its value.\n\n    The value is then encoded per the indicated schema within the union.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_55skip_union(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -9614,62 +9845,62 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("skip_union", 1, 3, 3, 1); __PYX_ERR(0, 566, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("skip_union", 1, 3, 3, 1); __PYX_ERR(0, 574, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("skip_union", 1, 3, 3, 2); __PYX_ERR(0, 566, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("skip_union", 1, 3, 3, 2); __PYX_ERR(0, 574, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_union") < 0)) __PYX_ERR(0, 566, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_union") < 0)) __PYX_ERR(0, 574, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_fo = values[0];
     __pyx_v_writer_schema = values[1];
     __pyx_v_named_schemas = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("skip_union", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 566, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("skip_union", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 574, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.skip_union", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_52skip_union(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas);
+  __pyx_r = __pyx_pf_8fastavro_5_read_54skip_union(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_52skip_union(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas) {
+static PyObject *__pyx_pf_8fastavro_5_read_54skip_union(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_union", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_union(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_union(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 574, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -9678,26 +9909,26 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":577
+/* "fastavro/_read.pyx":585
  * 
  * 
  * cpdef read_record(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_55read_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_57read_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_read_record(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8fastavro_5_read_read_record *__pyx_optional_args) {
 
-  /* "fastavro/_read.pyx":581
+  /* "fastavro/_read.pyx":589
  *     writer_schema,
  *     named_schemas,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     options={},
  * ):
  */
   PyObject *__pyx_v_reader_schema = ((PyObject *)Py_None);
@@ -9740,237 +9971,237 @@
       __pyx_v_reader_schema = __pyx_optional_args->reader_schema;
       if (__pyx_optional_args->__pyx_n > 1) {
         __pyx_v_options = __pyx_optional_args->options;
       }
     }
   }
 
-  /* "fastavro/_read.pyx":602
+  /* "fastavro/_read.pyx":610
  *          field's value is unset.
  *     """
  *     record = {}             # <<<<<<<<<<<<<<
  *     if reader_schema is None:
  *         for field in writer_schema["fields"]:
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 602, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_record = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":603
+  /* "fastavro/_read.pyx":611
  *     """
  *     record = {}
  *     if reader_schema is None:             # <<<<<<<<<<<<<<
  *         for field in writer_schema["fields"]:
  *             record[field["name"]] = _read_data(
  */
   __pyx_t_2 = (__pyx_v_reader_schema == Py_None);
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (__pyx_t_3) {
 
-    /* "fastavro/_read.pyx":604
+    /* "fastavro/_read.pyx":612
  *     record = {}
  *     if reader_schema is None:
  *         for field in writer_schema["fields"]:             # <<<<<<<<<<<<<<
  *             record[field["name"]] = _read_data(
  *                 fo,
  */
-    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_fields); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 604, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_fields); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
       __pyx_t_4 = __pyx_t_1; __Pyx_INCREF(__pyx_t_4); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 604, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 612, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 604, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_4)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 612, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_4))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 604, __pyx_L1_error)
+          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 612, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 604, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_4)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 604, __pyx_L1_error)
+          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_4, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 612, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 604, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_4, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         }
       } else {
         __pyx_t_1 = __pyx_t_6(__pyx_t_4);
         if (unlikely(!__pyx_t_1)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 604, __pyx_L1_error)
+            else __PYX_ERR(0, 612, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_1);
       }
       __Pyx_XDECREF_SET(__pyx_v_field, __pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "fastavro/_read.pyx":607
+      /* "fastavro/_read.pyx":615
  *             record[field["name"]] = _read_data(
  *                 fo,
  *                 field["type"],             # <<<<<<<<<<<<<<
  *                 named_schemas,
  *                 None,
  */
-      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 607, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 615, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
 
-      /* "fastavro/_read.pyx":605
+      /* "fastavro/_read.pyx":613
  *     if reader_schema is None:
  *         for field in writer_schema["fields"]:
  *             record[field["name"]] = _read_data(             # <<<<<<<<<<<<<<
  *                 fo,
  *                 field["type"],
  */
       __pyx_t_8.__pyx_n = 2;
       __pyx_t_8.reader_schema = Py_None;
       __pyx_t_8.options = __pyx_v_options;
-      __pyx_t_7 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_1, __pyx_v_named_schemas, 0, &__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __pyx_t_7 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_1, __pyx_v_named_schemas, 0, &__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 613, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_name); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 613, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (unlikely(PyDict_SetItem(__pyx_v_record, __pyx_t_1, __pyx_t_7) < 0)) __PYX_ERR(0, 605, __pyx_L1_error)
+      if (unlikely(PyDict_SetItem(__pyx_v_record, __pyx_t_1, __pyx_t_7) < 0)) __PYX_ERR(0, 613, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "fastavro/_read.pyx":604
+      /* "fastavro/_read.pyx":612
  *     record = {}
  *     if reader_schema is None:
  *         for field in writer_schema["fields"]:             # <<<<<<<<<<<<<<
  *             record[field["name"]] = _read_data(
  *                 fo,
  */
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastavro/_read.pyx":603
+    /* "fastavro/_read.pyx":611
  *     """
  *     record = {}
  *     if reader_schema is None:             # <<<<<<<<<<<<<<
  *         for field in writer_schema["fields"]:
  *             record[field["name"]] = _read_data(
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":613
+  /* "fastavro/_read.pyx":621
  *             )
  *     else:
  *         readers_field_dict = {}             # <<<<<<<<<<<<<<
  *         aliases_field_dict = {}
  *         for f in reader_schema["fields"]:
  */
   /*else*/ {
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 613, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_v_readers_field_dict = ((PyObject*)__pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "fastavro/_read.pyx":614
+    /* "fastavro/_read.pyx":622
  *     else:
  *         readers_field_dict = {}
  *         aliases_field_dict = {}             # <<<<<<<<<<<<<<
  *         for f in reader_schema["fields"]:
  *             readers_field_dict[f["name"]] = f
  */
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 614, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_v_aliases_field_dict = ((PyObject*)__pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "fastavro/_read.pyx":615
+    /* "fastavro/_read.pyx":623
  *         readers_field_dict = {}
  *         aliases_field_dict = {}
  *         for f in reader_schema["fields"]:             # <<<<<<<<<<<<<<
  *             readers_field_dict[f["name"]] = f
  *             for alias in f.get("aliases", []):
  */
-    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_reader_schema, __pyx_n_u_fields); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_reader_schema, __pyx_n_u_fields); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
       __pyx_t_7 = __pyx_t_4; __Pyx_INCREF(__pyx_t_7); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 615, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 623, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_6 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 615, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 623, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_7))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_7)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 615, __pyx_L1_error)
+          __pyx_t_4 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 623, __pyx_L1_error)
           #else
-          __pyx_t_4 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
+          __pyx_t_4 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 615, __pyx_L1_error)
+          __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_5); __Pyx_INCREF(__pyx_t_4); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 623, __pyx_L1_error)
           #else
-          __pyx_t_4 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
+          __pyx_t_4 = PySequence_ITEM(__pyx_t_7, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           #endif
         }
       } else {
         __pyx_t_4 = __pyx_t_6(__pyx_t_7);
         if (unlikely(!__pyx_t_4)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 615, __pyx_L1_error)
+            else __PYX_ERR(0, 623, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_4);
       }
       __Pyx_XDECREF_SET(__pyx_v_f, __pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "fastavro/_read.pyx":616
+      /* "fastavro/_read.pyx":624
  *         aliases_field_dict = {}
  *         for f in reader_schema["fields"]:
  *             readers_field_dict[f["name"]] = f             # <<<<<<<<<<<<<<
  *             for alias in f.get("aliases", []):
  *                 aliases_field_dict[alias] = f
  */
-      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_f, __pyx_n_u_name); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 616, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_f, __pyx_n_u_name); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (unlikely(PyDict_SetItem(__pyx_v_readers_field_dict, __pyx_t_4, __pyx_v_f) < 0)) __PYX_ERR(0, 616, __pyx_L1_error)
+      if (unlikely(PyDict_SetItem(__pyx_v_readers_field_dict, __pyx_t_4, __pyx_v_f) < 0)) __PYX_ERR(0, 624, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "fastavro/_read.pyx":617
+      /* "fastavro/_read.pyx":625
  *         for f in reader_schema["fields"]:
  *             readers_field_dict[f["name"]] = f
  *             for alias in f.get("aliases", []):             # <<<<<<<<<<<<<<
  *                 aliases_field_dict[alias] = f
  * 
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 617, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_f, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 617, __pyx_L1_error)
+      __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 625, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __pyx_t_10 = NULL;
       __pyx_t_11 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -9979,540 +10210,540 @@
           __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_11 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_n_u_aliases, __pyx_t_9};
-        __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 617, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 625, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_n_u_aliases, __pyx_t_9};
-        __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 617, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 625, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       } else
       #endif
       {
-        __pyx_t_12 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 617, __pyx_L1_error)
+        __pyx_t_12 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 625, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_12);
         if (__pyx_t_10) {
           __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
         }
         __Pyx_INCREF(__pyx_n_u_aliases);
         __Pyx_GIVEREF(__pyx_n_u_aliases);
         PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_n_u_aliases);
         __Pyx_GIVEREF(__pyx_t_9);
         PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_9);
         __pyx_t_9 = 0;
-        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_12, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 617, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_12, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 625, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (likely(PyList_CheckExact(__pyx_t_4)) || PyTuple_CheckExact(__pyx_t_4)) {
         __pyx_t_1 = __pyx_t_4; __Pyx_INCREF(__pyx_t_1); __pyx_t_13 = 0;
         __pyx_t_14 = NULL;
       } else {
-        __pyx_t_13 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 617, __pyx_L1_error)
+        __pyx_t_13 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_14 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 617, __pyx_L1_error)
+        __pyx_t_14 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 625, __pyx_L1_error)
       }
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       for (;;) {
         if (likely(!__pyx_t_14)) {
           if (likely(PyList_CheckExact(__pyx_t_1))) {
             if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_1)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 617, __pyx_L1_error)
+            __pyx_t_4 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 625, __pyx_L1_error)
             #else
-            __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 617, __pyx_L1_error)
+            __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 625, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_4);
             #endif
           } else {
             if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 617, __pyx_L1_error)
+            __pyx_t_4 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_13); __Pyx_INCREF(__pyx_t_4); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 625, __pyx_L1_error)
             #else
-            __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 617, __pyx_L1_error)
+            __pyx_t_4 = PySequence_ITEM(__pyx_t_1, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 625, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_4);
             #endif
           }
         } else {
           __pyx_t_4 = __pyx_t_14(__pyx_t_1);
           if (unlikely(!__pyx_t_4)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 617, __pyx_L1_error)
+              else __PYX_ERR(0, 625, __pyx_L1_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_4);
         }
         __Pyx_XDECREF_SET(__pyx_v_alias, __pyx_t_4);
         __pyx_t_4 = 0;
 
-        /* "fastavro/_read.pyx":618
+        /* "fastavro/_read.pyx":626
  *             readers_field_dict[f["name"]] = f
  *             for alias in f.get("aliases", []):
  *                 aliases_field_dict[alias] = f             # <<<<<<<<<<<<<<
  * 
  *         for field in writer_schema["fields"]:
  */
-        if (unlikely(PyDict_SetItem(__pyx_v_aliases_field_dict, __pyx_v_alias, __pyx_v_f) < 0)) __PYX_ERR(0, 618, __pyx_L1_error)
+        if (unlikely(PyDict_SetItem(__pyx_v_aliases_field_dict, __pyx_v_alias, __pyx_v_f) < 0)) __PYX_ERR(0, 626, __pyx_L1_error)
 
-        /* "fastavro/_read.pyx":617
+        /* "fastavro/_read.pyx":625
  *         for f in reader_schema["fields"]:
  *             readers_field_dict[f["name"]] = f
  *             for alias in f.get("aliases", []):             # <<<<<<<<<<<<<<
  *                 aliases_field_dict[alias] = f
  * 
  */
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "fastavro/_read.pyx":615
+      /* "fastavro/_read.pyx":623
  *         readers_field_dict = {}
  *         aliases_field_dict = {}
  *         for f in reader_schema["fields"]:             # <<<<<<<<<<<<<<
  *             readers_field_dict[f["name"]] = f
  *             for alias in f.get("aliases", []):
  */
     }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "fastavro/_read.pyx":620
+    /* "fastavro/_read.pyx":628
  *                 aliases_field_dict[alias] = f
  * 
  *         for field in writer_schema["fields"]:             # <<<<<<<<<<<<<<
  *             readers_field = readers_field_dict.get(
  *                 field["name"],
  */
-    __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_fields); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 620, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_fields); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 628, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
       __pyx_t_1 = __pyx_t_7; __Pyx_INCREF(__pyx_t_1); __pyx_t_5 = 0;
       __pyx_t_6 = NULL;
     } else {
-      __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)
+      __pyx_t_5 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 628, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 620, __pyx_L1_error)
+      __pyx_t_6 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 628, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     for (;;) {
       if (likely(!__pyx_t_6)) {
         if (likely(PyList_CheckExact(__pyx_t_1))) {
           if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 620, __pyx_L1_error)
+          __pyx_t_7 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 628, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 620, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 628, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         } else {
           if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 620, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_5); __Pyx_INCREF(__pyx_t_7); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 628, __pyx_L1_error)
           #else
-          __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 620, __pyx_L1_error)
+          __pyx_t_7 = PySequence_ITEM(__pyx_t_1, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 628, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           #endif
         }
       } else {
         __pyx_t_7 = __pyx_t_6(__pyx_t_1);
         if (unlikely(!__pyx_t_7)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 620, __pyx_L1_error)
+            else __PYX_ERR(0, 628, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_7);
       }
       __Pyx_XDECREF_SET(__pyx_v_field, __pyx_t_7);
       __pyx_t_7 = 0;
 
-      /* "fastavro/_read.pyx":622
+      /* "fastavro/_read.pyx":630
  *         for field in writer_schema["fields"]:
  *             readers_field = readers_field_dict.get(
  *                 field["name"],             # <<<<<<<<<<<<<<
  *                 aliases_field_dict.get(field["name"]),
  *             )
  */
-      __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_name); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 622, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_name); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 630, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "fastavro/_read.pyx":623
+      /* "fastavro/_read.pyx":631
  *             readers_field = readers_field_dict.get(
  *                 field["name"],
  *                 aliases_field_dict.get(field["name"]),             # <<<<<<<<<<<<<<
  *             )
  *             if readers_field:
  */
-      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_name); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_name); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_12 = __Pyx_PyDict_GetItemDefault(__pyx_v_aliases_field_dict, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 623, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyDict_GetItemDefault(__pyx_v_aliases_field_dict, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 631, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "fastavro/_read.pyx":621
+      /* "fastavro/_read.pyx":629
  * 
  *         for field in writer_schema["fields"]:
  *             readers_field = readers_field_dict.get(             # <<<<<<<<<<<<<<
  *                 field["name"],
  *                 aliases_field_dict.get(field["name"]),
  */
-      __pyx_t_4 = __Pyx_PyDict_GetItemDefault(__pyx_v_readers_field_dict, __pyx_t_7, __pyx_t_12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_GetItemDefault(__pyx_v_readers_field_dict, __pyx_t_7, __pyx_t_12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 629, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __Pyx_XDECREF_SET(__pyx_v_readers_field, __pyx_t_4);
       __pyx_t_4 = 0;
 
-      /* "fastavro/_read.pyx":625
+      /* "fastavro/_read.pyx":633
  *                 aliases_field_dict.get(field["name"]),
  *             )
  *             if readers_field:             # <<<<<<<<<<<<<<
  *                 record[readers_field["name"]] = _read_data(
  *                     fo,
  */
-      __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_readers_field); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 625, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_v_readers_field); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 633, __pyx_L1_error)
       if (__pyx_t_3) {
 
-        /* "fastavro/_read.pyx":628
+        /* "fastavro/_read.pyx":636
  *                 record[readers_field["name"]] = _read_data(
  *                     fo,
  *                     field["type"],             # <<<<<<<<<<<<<<
  *                     named_schemas,
  *                     readers_field["type"],
  */
-        __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 636, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
 
-        /* "fastavro/_read.pyx":630
+        /* "fastavro/_read.pyx":638
  *                     field["type"],
  *                     named_schemas,
  *                     readers_field["type"],             # <<<<<<<<<<<<<<
  *                     options,
  *                 )
  */
-        __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_v_readers_field, __pyx_n_u_type); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 630, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_v_readers_field, __pyx_n_u_type); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 638, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_12);
 
-        /* "fastavro/_read.pyx":626
+        /* "fastavro/_read.pyx":634
  *             )
  *             if readers_field:
  *                 record[readers_field["name"]] = _read_data(             # <<<<<<<<<<<<<<
  *                     fo,
  *                     field["type"],
  */
         __pyx_t_8.__pyx_n = 2;
         __pyx_t_8.reader_schema = __pyx_t_12;
         __pyx_t_8.options = __pyx_v_options;
-        __pyx_t_7 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_4, __pyx_v_named_schemas, 0, &__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 626, __pyx_L1_error)
+        __pyx_t_7 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_4, __pyx_v_named_schemas, 0, &__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 634, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-        __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_v_readers_field, __pyx_n_u_name); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 626, __pyx_L1_error)
+        __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_v_readers_field, __pyx_n_u_name); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 634, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_12);
-        if (unlikely(PyDict_SetItem(__pyx_v_record, __pyx_t_12, __pyx_t_7) < 0)) __PYX_ERR(0, 626, __pyx_L1_error)
+        if (unlikely(PyDict_SetItem(__pyx_v_record, __pyx_t_12, __pyx_t_7) < 0)) __PYX_ERR(0, 634, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-        /* "fastavro/_read.pyx":625
+        /* "fastavro/_read.pyx":633
  *                 aliases_field_dict.get(field["name"]),
  *             )
  *             if readers_field:             # <<<<<<<<<<<<<<
  *                 record[readers_field["name"]] = _read_data(
  *                     fo,
  */
         goto __pyx_L12;
       }
 
-      /* "fastavro/_read.pyx":634
+      /* "fastavro/_read.pyx":642
  *                 )
  *             else:
  *                 _skip_data(fo, field["type"], named_schemas)             # <<<<<<<<<<<<<<
  * 
  *         # fill in default values
  */
       /*else*/ {
-        __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_type); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 634, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_type); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 642, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_12 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_7, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 634, __pyx_L1_error)
+        __pyx_t_12 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_7, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 642, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_12);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       }
       __pyx_L12:;
 
-      /* "fastavro/_read.pyx":620
+      /* "fastavro/_read.pyx":628
  *                 aliases_field_dict[alias] = f
  * 
  *         for field in writer_schema["fields"]:             # <<<<<<<<<<<<<<
  *             readers_field = readers_field_dict.get(
  *                 field["name"],
  */
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":637
+    /* "fastavro/_read.pyx":645
  * 
  *         # fill in default values
  *         if len(readers_field_dict) > len(record):             # <<<<<<<<<<<<<<
  *             writer_fields = [f["name"] for f in writer_schema["fields"]]
  *             for f_name, field in readers_field_dict.items():
  */
-    __pyx_t_5 = PyDict_Size(__pyx_v_readers_field_dict); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 637, __pyx_L1_error)
-    __pyx_t_13 = PyDict_Size(__pyx_v_record); if (unlikely(__pyx_t_13 == ((Py_ssize_t)-1))) __PYX_ERR(0, 637, __pyx_L1_error)
+    __pyx_t_5 = PyDict_Size(__pyx_v_readers_field_dict); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 645, __pyx_L1_error)
+    __pyx_t_13 = PyDict_Size(__pyx_v_record); if (unlikely(__pyx_t_13 == ((Py_ssize_t)-1))) __PYX_ERR(0, 645, __pyx_L1_error)
     __pyx_t_3 = ((__pyx_t_5 > __pyx_t_13) != 0);
     if (__pyx_t_3) {
 
-      /* "fastavro/_read.pyx":638
+      /* "fastavro/_read.pyx":646
  *         # fill in default values
  *         if len(readers_field_dict) > len(record):
  *             writer_fields = [f["name"] for f in writer_schema["fields"]]             # <<<<<<<<<<<<<<
  *             for f_name, field in readers_field_dict.items():
  *                 if f_name not in writer_fields and f_name not in record:
  */
       { /* enter inner scope */
-        __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 638, __pyx_L16_error)
+        __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 646, __pyx_L16_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_fields); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 638, __pyx_L16_error)
+        __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_fields); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 646, __pyx_L16_error)
         __Pyx_GOTREF(__pyx_t_12);
         if (likely(PyList_CheckExact(__pyx_t_12)) || PyTuple_CheckExact(__pyx_t_12)) {
           __pyx_t_7 = __pyx_t_12; __Pyx_INCREF(__pyx_t_7); __pyx_t_13 = 0;
           __pyx_t_6 = NULL;
         } else {
-          __pyx_t_13 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 638, __pyx_L16_error)
+          __pyx_t_13 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_12); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 646, __pyx_L16_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __pyx_t_6 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 638, __pyx_L16_error)
+          __pyx_t_6 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 646, __pyx_L16_error)
         }
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         for (;;) {
           if (likely(!__pyx_t_6)) {
             if (likely(PyList_CheckExact(__pyx_t_7))) {
               if (__pyx_t_13 >= PyList_GET_SIZE(__pyx_t_7)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_12 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_13); __Pyx_INCREF(__pyx_t_12); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 638, __pyx_L16_error)
+              __pyx_t_12 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_13); __Pyx_INCREF(__pyx_t_12); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 646, __pyx_L16_error)
               #else
-              __pyx_t_12 = PySequence_ITEM(__pyx_t_7, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 638, __pyx_L16_error)
+              __pyx_t_12 = PySequence_ITEM(__pyx_t_7, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 646, __pyx_L16_error)
               __Pyx_GOTREF(__pyx_t_12);
               #endif
             } else {
               if (__pyx_t_13 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_12 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_13); __Pyx_INCREF(__pyx_t_12); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 638, __pyx_L16_error)
+              __pyx_t_12 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_13); __Pyx_INCREF(__pyx_t_12); __pyx_t_13++; if (unlikely(0 < 0)) __PYX_ERR(0, 646, __pyx_L16_error)
               #else
-              __pyx_t_12 = PySequence_ITEM(__pyx_t_7, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 638, __pyx_L16_error)
+              __pyx_t_12 = PySequence_ITEM(__pyx_t_7, __pyx_t_13); __pyx_t_13++; if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 646, __pyx_L16_error)
               __Pyx_GOTREF(__pyx_t_12);
               #endif
             }
           } else {
             __pyx_t_12 = __pyx_t_6(__pyx_t_7);
             if (unlikely(!__pyx_t_12)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 638, __pyx_L16_error)
+                else __PYX_ERR(0, 646, __pyx_L16_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_12);
           }
           __Pyx_XDECREF_SET(__pyx_7genexpr__pyx_v_f, __pyx_t_12);
           __pyx_t_12 = 0;
-          __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_7genexpr__pyx_v_f, __pyx_n_u_name); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 638, __pyx_L16_error)
+          __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_7genexpr__pyx_v_f, __pyx_n_u_name); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 646, __pyx_L16_error)
           __Pyx_GOTREF(__pyx_t_12);
-          if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_12))) __PYX_ERR(0, 638, __pyx_L16_error)
+          if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_12))) __PYX_ERR(0, 646, __pyx_L16_error)
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
         }
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_XDECREF(__pyx_7genexpr__pyx_v_f); __pyx_7genexpr__pyx_v_f = 0;
         goto __pyx_L19_exit_scope;
         __pyx_L16_error:;
         __Pyx_XDECREF(__pyx_7genexpr__pyx_v_f); __pyx_7genexpr__pyx_v_f = 0;
         goto __pyx_L1_error;
         __pyx_L19_exit_scope:;
       } /* exit inner scope */
       __pyx_v_writer_fields = ((PyObject*)__pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "fastavro/_read.pyx":639
+      /* "fastavro/_read.pyx":647
  *         if len(readers_field_dict) > len(record):
  *             writer_fields = [f["name"] for f in writer_schema["fields"]]
  *             for f_name, field in readers_field_dict.items():             # <<<<<<<<<<<<<<
  *                 if f_name not in writer_fields and f_name not in record:
  *                     if "default" in field:
  */
       __pyx_t_13 = 0;
-      __pyx_t_7 = __Pyx_dict_iterator(__pyx_v_readers_field_dict, 1, __pyx_n_s_items, (&__pyx_t_5), (&__pyx_t_11)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 639, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_dict_iterator(__pyx_v_readers_field_dict, 1, __pyx_n_s_items, (&__pyx_t_5), (&__pyx_t_11)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 647, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_XDECREF(__pyx_t_1);
       __pyx_t_1 = __pyx_t_7;
       __pyx_t_7 = 0;
       while (1) {
         __pyx_t_15 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_5, &__pyx_t_13, &__pyx_t_7, &__pyx_t_12, NULL, __pyx_t_11);
         if (unlikely(__pyx_t_15 == 0)) break;
-        if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 639, __pyx_L1_error)
+        if (unlikely(__pyx_t_15 == -1)) __PYX_ERR(0, 647, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_GOTREF(__pyx_t_12);
         __Pyx_XDECREF_SET(__pyx_v_f_name, __pyx_t_7);
         __pyx_t_7 = 0;
         __Pyx_XDECREF_SET(__pyx_v_field, __pyx_t_12);
         __pyx_t_12 = 0;
 
-        /* "fastavro/_read.pyx":640
+        /* "fastavro/_read.pyx":648
  *             writer_fields = [f["name"] for f in writer_schema["fields"]]
  *             for f_name, field in readers_field_dict.items():
  *                 if f_name not in writer_fields and f_name not in record:             # <<<<<<<<<<<<<<
  *                     if "default" in field:
  *                         record[field["name"]] = field["default"]
  */
-        __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_v_f_name, __pyx_v_writer_fields, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 640, __pyx_L1_error)
+        __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_v_f_name, __pyx_v_writer_fields, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 648, __pyx_L1_error)
         __pyx_t_16 = (__pyx_t_2 != 0);
         if (__pyx_t_16) {
         } else {
           __pyx_t_3 = __pyx_t_16;
           goto __pyx_L23_bool_binop_done;
         }
-        __pyx_t_16 = (__Pyx_PyDict_ContainsTF(__pyx_v_f_name, __pyx_v_record, Py_NE)); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 640, __pyx_L1_error)
+        __pyx_t_16 = (__Pyx_PyDict_ContainsTF(__pyx_v_f_name, __pyx_v_record, Py_NE)); if (unlikely(__pyx_t_16 < 0)) __PYX_ERR(0, 648, __pyx_L1_error)
         __pyx_t_2 = (__pyx_t_16 != 0);
         __pyx_t_3 = __pyx_t_2;
         __pyx_L23_bool_binop_done:;
         if (__pyx_t_3) {
 
-          /* "fastavro/_read.pyx":641
+          /* "fastavro/_read.pyx":649
  *             for f_name, field in readers_field_dict.items():
  *                 if f_name not in writer_fields and f_name not in record:
  *                     if "default" in field:             # <<<<<<<<<<<<<<
  *                         record[field["name"]] = field["default"]
  *                     else:
  */
-          __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_default, __pyx_v_field, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 641, __pyx_L1_error)
+          __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_default, __pyx_v_field, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 649, __pyx_L1_error)
           __pyx_t_2 = (__pyx_t_3 != 0);
           if (likely(__pyx_t_2)) {
 
-            /* "fastavro/_read.pyx":642
+            /* "fastavro/_read.pyx":650
  *                 if f_name not in writer_fields and f_name not in record:
  *                     if "default" in field:
  *                         record[field["name"]] = field["default"]             # <<<<<<<<<<<<<<
  *                     else:
  *                         msg = f"No default value for {field['name']}"
  */
-            __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_default); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 642, __pyx_L1_error)
+            __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_default); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 650, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
-            __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_name); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 642, __pyx_L1_error)
+            __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_name); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 650, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_7);
-            if (unlikely(PyDict_SetItem(__pyx_v_record, __pyx_t_7, __pyx_t_12) < 0)) __PYX_ERR(0, 642, __pyx_L1_error)
+            if (unlikely(PyDict_SetItem(__pyx_v_record, __pyx_t_7, __pyx_t_12) < 0)) __PYX_ERR(0, 650, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-            /* "fastavro/_read.pyx":641
+            /* "fastavro/_read.pyx":649
  *             for f_name, field in readers_field_dict.items():
  *                 if f_name not in writer_fields and f_name not in record:
  *                     if "default" in field:             # <<<<<<<<<<<<<<
  *                         record[field["name"]] = field["default"]
  *                     else:
  */
             goto __pyx_L25;
           }
 
-          /* "fastavro/_read.pyx":644
+          /* "fastavro/_read.pyx":652
  *                         record[field["name"]] = field["default"]
  *                     else:
  *                         msg = f"No default value for {field['name']}"             # <<<<<<<<<<<<<<
  *                         raise SchemaResolutionError(msg)
  * 
  */
           /*else*/ {
-            __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_name); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 644, __pyx_L1_error)
+            __pyx_t_12 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_name); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 652, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
-            __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_12, __pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 644, __pyx_L1_error)
+            __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_12, __pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 652, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_7);
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-            __pyx_t_12 = __Pyx_PyUnicode_Concat(__pyx_kp_u_No_default_value_for, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 644, __pyx_L1_error)
+            __pyx_t_12 = __Pyx_PyUnicode_Concat(__pyx_kp_u_No_default_value_for, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 652, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
             __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
             __pyx_v_msg = ((PyObject*)__pyx_t_12);
             __pyx_t_12 = 0;
 
-            /* "fastavro/_read.pyx":645
+            /* "fastavro/_read.pyx":653
  *                     else:
  *                         msg = f"No default value for {field['name']}"
  *                         raise SchemaResolutionError(msg)             # <<<<<<<<<<<<<<
  * 
  *     return record
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 645, __pyx_L1_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_SchemaResolutionError); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 653, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_7);
             __pyx_t_4 = NULL;
             if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
               __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
               if (likely(__pyx_t_4)) {
                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
                 __Pyx_INCREF(__pyx_t_4);
                 __Pyx_INCREF(function);
                 __Pyx_DECREF_SET(__pyx_t_7, function);
               }
             }
             __pyx_t_12 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_4, __pyx_v_msg) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_msg);
             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-            if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 645, __pyx_L1_error)
+            if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 653, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_12);
             __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
             __Pyx_Raise(__pyx_t_12, 0, 0, 0);
             __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-            __PYX_ERR(0, 645, __pyx_L1_error)
+            __PYX_ERR(0, 653, __pyx_L1_error)
           }
           __pyx_L25:;
 
-          /* "fastavro/_read.pyx":640
+          /* "fastavro/_read.pyx":648
  *             writer_fields = [f["name"] for f in writer_schema["fields"]]
  *             for f_name, field in readers_field_dict.items():
  *                 if f_name not in writer_fields and f_name not in record:             # <<<<<<<<<<<<<<
  *                     if "default" in field:
  *                         record[field["name"]] = field["default"]
  */
         }
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "fastavro/_read.pyx":637
+      /* "fastavro/_read.pyx":645
  * 
  *         # fill in default values
  *         if len(readers_field_dict) > len(record):             # <<<<<<<<<<<<<<
  *             writer_fields = [f["name"] for f in writer_schema["fields"]]
  *             for f_name, field in readers_field_dict.items():
  */
     }
   }
   __pyx_L3:;
 
-  /* "fastavro/_read.pyx":647
+  /* "fastavro/_read.pyx":655
  *                         raise SchemaResolutionError(msg)
  * 
  *     return record             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_record);
   __pyx_r = __pyx_v_record;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":577
+  /* "fastavro/_read.pyx":585
  * 
  * 
  * cpdef read_record(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
@@ -10540,17 +10771,17 @@
   __Pyx_XDECREF(__pyx_7genexpr__pyx_v_f);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_55read_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_54read_record[] = "A record is encoded by encoding the values of its fields in the order\n    that they are declared. In other words, a record is encoded as just the\n    concatenation of the encodings of its fields.  Field values are encoded per\n    their schema.\n\n    Schema Resolution:\n     * the ordering of fields may be different: fields are matched by name.\n     * schemas for fields with the same name in both records are resolved\n         recursively.\n     * if the writer's record contains a field with a name not present in the\n         reader's record, the writer's value for that field is ignored.\n     * if the reader's record schema has a field that contains a default value,\n         and writer's schema does not have a field with the same name, then the\n         reader should use the default value from its field.\n     * if the reader's record schema has a field with no default value, and\n         writer's schema does not have a field with the same name, then the\n         field's value is unset.\n    ";
-static PyObject *__pyx_pw_8fastavro_5_read_55read_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_57read_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_56read_record[] = "A record is encoded by encoding the values of its fields in the order\n    that they are declared. In other words, a record is encoded as just the\n    concatenation of the encodings of its fields.  Field values are encoded per\n    their schema.\n\n    Schema Resolution:\n     * the ordering of fields may be different: fields are matched by name.\n     * schemas for fields with the same name in both records are resolved\n         recursively.\n     * if the writer's record contains a field with a name not present in the\n         reader's record, the writer's value for that field is ignored.\n     * if the reader's record schema has a field that contains a default value,\n         and writer's schema does not have a field with the same name, then the\n         reader should use the default value from its field.\n     * if the reader's record schema has a field with no default value, and\n         writer's schema does not have a field with the same name, then the\n         field's value is unset.\n    ";
+static PyObject *__pyx_pw_8fastavro_5_read_57read_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   PyObject *__pyx_v_reader_schema = 0;
   PyObject *__pyx_v_options = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -10558,15 +10789,15 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("read_record (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_fo,&__pyx_n_s_writer_schema,&__pyx_n_s_named_schemas,&__pyx_n_s_reader_schema,&__pyx_n_s_options,0};
     PyObject* values[5] = {0,0,0,0,0};
 
-    /* "fastavro/_read.pyx":581
+    /* "fastavro/_read.pyx":589
  *     writer_schema,
  *     named_schemas,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     options={},
  * ):
  */
     values[3] = ((PyObject *)Py_None);
@@ -10593,21 +10824,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_record", 0, 3, 5, 1); __PYX_ERR(0, 577, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_record", 0, 3, 5, 1); __PYX_ERR(0, 585, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("read_record", 0, 3, 5, 2); __PYX_ERR(0, 577, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("read_record", 0, 3, 5, 2); __PYX_ERR(0, 585, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -10615,15 +10846,15 @@
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_options);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_record") < 0)) __PYX_ERR(0, 577, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "read_record") < 0)) __PYX_ERR(0, 585, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
@@ -10638,49 +10869,49 @@
     __pyx_v_writer_schema = values[1];
     __pyx_v_named_schemas = values[2];
     __pyx_v_reader_schema = values[3];
     __pyx_v_options = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("read_record", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 577, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("read_record", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 585, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.read_record", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_54read_record(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
+  __pyx_r = __pyx_pf_8fastavro_5_read_56read_record(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
 
-  /* "fastavro/_read.pyx":577
+  /* "fastavro/_read.pyx":585
  * 
  * 
  * cpdef read_record(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_54read_record(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
+static PyObject *__pyx_pf_8fastavro_5_read_56read_record(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8fastavro_5_read_read_record __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("read_record", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.reader_schema = __pyx_v_reader_schema;
   __pyx_t_2.options = __pyx_v_options;
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_record(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 577, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_record(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 585, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -10689,114 +10920,114 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":650
+/* "fastavro/_read.pyx":658
  * 
  * 
  * cpdef skip_record(fo, writer_schema, named_schemas):             # <<<<<<<<<<<<<<
  *     for field in writer_schema["fields"]:
  *         _skip_data(fo, field["type"], named_schemas)
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_57skip_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_59skip_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_record(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_v_field = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   Py_ssize_t __pyx_t_3;
   PyObject *(*__pyx_t_4)(PyObject *);
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_record", 0);
 
-  /* "fastavro/_read.pyx":651
+  /* "fastavro/_read.pyx":659
  * 
  * cpdef skip_record(fo, writer_schema, named_schemas):
  *     for field in writer_schema["fields"]:             # <<<<<<<<<<<<<<
  *         _skip_data(fo, field["type"], named_schemas)
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_fields); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 651, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_writer_schema, __pyx_n_u_fields); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 651, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 659, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 651, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 659, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 651, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 659, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 651, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 651, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 659, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 651, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 651, __pyx_L1_error)
+          else __PYX_ERR(0, 659, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_field, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":652
+    /* "fastavro/_read.pyx":660
  * cpdef skip_record(fo, writer_schema, named_schemas):
  *     for field in writer_schema["fields"]:
  *         _skip_data(fo, field["type"], named_schemas)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 652, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_field, __pyx_n_u_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_1, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 652, __pyx_L1_error)
+    __pyx_t_5 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_1, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 660, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "fastavro/_read.pyx":651
+    /* "fastavro/_read.pyx":659
  * 
  * cpdef skip_record(fo, writer_schema, named_schemas):
  *     for field in writer_schema["fields"]:             # <<<<<<<<<<<<<<
  *         _skip_data(fo, field["type"], named_schemas)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":650
+  /* "fastavro/_read.pyx":658
  * 
  * 
  * cpdef skip_record(fo, writer_schema, named_schemas):             # <<<<<<<<<<<<<<
  *     for field in writer_schema["fields"]:
  *         _skip_data(fo, field["type"], named_schemas)
  */
 
@@ -10813,16 +11044,16 @@
   __Pyx_XDECREF(__pyx_v_field);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_57skip_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_57skip_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_59skip_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_59skip_record(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -10849,62 +11080,62 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("skip_record", 1, 3, 3, 1); __PYX_ERR(0, 650, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("skip_record", 1, 3, 3, 1); __PYX_ERR(0, 658, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("skip_record", 1, 3, 3, 2); __PYX_ERR(0, 650, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("skip_record", 1, 3, 3, 2); __PYX_ERR(0, 658, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_record") < 0)) __PYX_ERR(0, 650, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_record") < 0)) __PYX_ERR(0, 658, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_fo = values[0];
     __pyx_v_writer_schema = values[1];
     __pyx_v_named_schemas = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("skip_record", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 650, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("skip_record", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 658, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.skip_record", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_56skip_record(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas);
+  __pyx_r = __pyx_pf_8fastavro_5_read_58skip_record(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_56skip_record(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas) {
+static PyObject *__pyx_pf_8fastavro_5_read_58skip_record(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_record", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_record(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 650, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_record(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 658, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -10913,281 +11144,281 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":655
+/* "fastavro/_read.pyx":663
  * 
  * 
  * cpdef maybe_promote(data, writer_type, reader_type):             # <<<<<<<<<<<<<<
  *     if writer_type == "int":
  *         # No need to promote to long since they are the same type in Python
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_59maybe_promote(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_61maybe_promote(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_maybe_promote(PyObject *__pyx_v_data, PyObject *__pyx_v_writer_type, PyObject *__pyx_v_reader_type, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("maybe_promote", 0);
 
-  /* "fastavro/_read.pyx":656
+  /* "fastavro/_read.pyx":664
  * 
  * cpdef maybe_promote(data, writer_type, reader_type):
  *     if writer_type == "int":             # <<<<<<<<<<<<<<
  *         # No need to promote to long since they are the same type in Python
  *         if reader_type == "float" or reader_type == "double":
  */
-  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_int, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 656, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_int, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 664, __pyx_L1_error)
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":658
+    /* "fastavro/_read.pyx":666
  *     if writer_type == "int":
  *         # No need to promote to long since they are the same type in Python
  *         if reader_type == "float" or reader_type == "double":             # <<<<<<<<<<<<<<
  *             return float(data)
  *     if writer_type == "long":
  */
-    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 658, __pyx_L1_error)
+    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 666, __pyx_L1_error)
     if (!__pyx_t_2) {
     } else {
       __pyx_t_1 = __pyx_t_2;
       goto __pyx_L5_bool_binop_done;
     }
-    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 658, __pyx_L1_error)
+    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 666, __pyx_L1_error)
     __pyx_t_1 = __pyx_t_2;
     __pyx_L5_bool_binop_done:;
     if (__pyx_t_1) {
 
-      /* "fastavro/_read.pyx":659
+      /* "fastavro/_read.pyx":667
  *         # No need to promote to long since they are the same type in Python
  *         if reader_type == "float" or reader_type == "double":
  *             return float(data)             # <<<<<<<<<<<<<<
  *     if writer_type == "long":
  *         if reader_type == "float" or reader_type == "double":
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_3 = __Pyx_PyNumber_Float(__pyx_v_data); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 659, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyNumber_Float(__pyx_v_data); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 667, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_r = __pyx_t_3;
       __pyx_t_3 = 0;
       goto __pyx_L0;
 
-      /* "fastavro/_read.pyx":658
+      /* "fastavro/_read.pyx":666
  *     if writer_type == "int":
  *         # No need to promote to long since they are the same type in Python
  *         if reader_type == "float" or reader_type == "double":             # <<<<<<<<<<<<<<
  *             return float(data)
  *     if writer_type == "long":
  */
     }
 
-    /* "fastavro/_read.pyx":656
+    /* "fastavro/_read.pyx":664
  * 
  * cpdef maybe_promote(data, writer_type, reader_type):
  *     if writer_type == "int":             # <<<<<<<<<<<<<<
  *         # No need to promote to long since they are the same type in Python
  *         if reader_type == "float" or reader_type == "double":
  */
   }
 
-  /* "fastavro/_read.pyx":660
+  /* "fastavro/_read.pyx":668
  *         if reader_type == "float" or reader_type == "double":
  *             return float(data)
  *     if writer_type == "long":             # <<<<<<<<<<<<<<
  *         if reader_type == "float" or reader_type == "double":
  *             return float(data)
  */
-  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_long, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 660, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_long, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 668, __pyx_L1_error)
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":661
+    /* "fastavro/_read.pyx":669
  *             return float(data)
  *     if writer_type == "long":
  *         if reader_type == "float" or reader_type == "double":             # <<<<<<<<<<<<<<
  *             return float(data)
  *     if writer_type == "string" and reader_type == "bytes":
  */
-    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 661, __pyx_L1_error)
+    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 669, __pyx_L1_error)
     if (!__pyx_t_2) {
     } else {
       __pyx_t_1 = __pyx_t_2;
       goto __pyx_L9_bool_binop_done;
     }
-    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 661, __pyx_L1_error)
+    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 669, __pyx_L1_error)
     __pyx_t_1 = __pyx_t_2;
     __pyx_L9_bool_binop_done:;
     if (__pyx_t_1) {
 
-      /* "fastavro/_read.pyx":662
+      /* "fastavro/_read.pyx":670
  *     if writer_type == "long":
  *         if reader_type == "float" or reader_type == "double":
  *             return float(data)             # <<<<<<<<<<<<<<
  *     if writer_type == "string" and reader_type == "bytes":
  *         return data.encode()
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_3 = __Pyx_PyNumber_Float(__pyx_v_data); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyNumber_Float(__pyx_v_data); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 670, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_r = __pyx_t_3;
       __pyx_t_3 = 0;
       goto __pyx_L0;
 
-      /* "fastavro/_read.pyx":661
+      /* "fastavro/_read.pyx":669
  *             return float(data)
  *     if writer_type == "long":
  *         if reader_type == "float" or reader_type == "double":             # <<<<<<<<<<<<<<
  *             return float(data)
  *     if writer_type == "string" and reader_type == "bytes":
  */
     }
 
-    /* "fastavro/_read.pyx":660
+    /* "fastavro/_read.pyx":668
  *         if reader_type == "float" or reader_type == "double":
  *             return float(data)
  *     if writer_type == "long":             # <<<<<<<<<<<<<<
  *         if reader_type == "float" or reader_type == "double":
  *             return float(data)
  */
   }
 
-  /* "fastavro/_read.pyx":663
+  /* "fastavro/_read.pyx":671
  *         if reader_type == "float" or reader_type == "double":
  *             return float(data)
  *     if writer_type == "string" and reader_type == "bytes":             # <<<<<<<<<<<<<<
  *         return data.encode()
  *     if writer_type == "bytes" and reader_type == "string":
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 663, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 671, __pyx_L1_error)
   if (__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L12_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 663, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 671, __pyx_L1_error)
   __pyx_t_1 = __pyx_t_2;
   __pyx_L12_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":664
+    /* "fastavro/_read.pyx":672
  *             return float(data)
  *     if writer_type == "string" and reader_type == "bytes":
  *         return data.encode()             # <<<<<<<<<<<<<<
  *     if writer_type == "bytes" and reader_type == "string":
  *         return data.decode()
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_data, __pyx_n_s_encode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 664, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_data, __pyx_n_s_encode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 664, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":663
+    /* "fastavro/_read.pyx":671
  *         if reader_type == "float" or reader_type == "double":
  *             return float(data)
  *     if writer_type == "string" and reader_type == "bytes":             # <<<<<<<<<<<<<<
  *         return data.encode()
  *     if writer_type == "bytes" and reader_type == "string":
  */
   }
 
-  /* "fastavro/_read.pyx":665
+  /* "fastavro/_read.pyx":673
  *     if writer_type == "string" and reader_type == "bytes":
  *         return data.encode()
  *     if writer_type == "bytes" and reader_type == "string":             # <<<<<<<<<<<<<<
  *         return data.decode()
  *     return data
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 665, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_writer_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 673, __pyx_L1_error)
   if (__pyx_t_2) {
   } else {
     __pyx_t_1 = __pyx_t_2;
     goto __pyx_L15_bool_binop_done;
   }
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 665, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_reader_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 673, __pyx_L1_error)
   __pyx_t_1 = __pyx_t_2;
   __pyx_L15_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastavro/_read.pyx":666
+    /* "fastavro/_read.pyx":674
  *         return data.encode()
  *     if writer_type == "bytes" and reader_type == "string":
  *         return data.decode()             # <<<<<<<<<<<<<<
  *     return data
  * 
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_data, __pyx_n_s_decode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 666, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_data, __pyx_n_s_decode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 666, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 674, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":665
+    /* "fastavro/_read.pyx":673
  *     if writer_type == "string" and reader_type == "bytes":
  *         return data.encode()
  *     if writer_type == "bytes" and reader_type == "string":             # <<<<<<<<<<<<<<
  *         return data.decode()
  *     return data
  */
   }
 
-  /* "fastavro/_read.pyx":667
+  /* "fastavro/_read.pyx":675
  *     if writer_type == "bytes" and reader_type == "string":
  *         return data.decode()
  *     return data             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_data);
   __pyx_r = __pyx_v_data;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":655
+  /* "fastavro/_read.pyx":663
  * 
  * 
  * cpdef maybe_promote(data, writer_type, reader_type):             # <<<<<<<<<<<<<<
  *     if writer_type == "int":
  *         # No need to promote to long since they are the same type in Python
  */
 
@@ -11201,16 +11432,16 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_59maybe_promote(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_59maybe_promote(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_61maybe_promote(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_61maybe_promote(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_data = 0;
   PyObject *__pyx_v_writer_type = 0;
   PyObject *__pyx_v_reader_type = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -11237,62 +11468,62 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_data)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_type)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("maybe_promote", 1, 3, 3, 1); __PYX_ERR(0, 655, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("maybe_promote", 1, 3, 3, 1); __PYX_ERR(0, 663, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_type)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("maybe_promote", 1, 3, 3, 2); __PYX_ERR(0, 655, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("maybe_promote", 1, 3, 3, 2); __PYX_ERR(0, 663, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "maybe_promote") < 0)) __PYX_ERR(0, 655, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "maybe_promote") < 0)) __PYX_ERR(0, 663, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_data = values[0];
     __pyx_v_writer_type = values[1];
     __pyx_v_reader_type = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("maybe_promote", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 655, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("maybe_promote", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 663, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.maybe_promote", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_58maybe_promote(__pyx_self, __pyx_v_data, __pyx_v_writer_type, __pyx_v_reader_type);
+  __pyx_r = __pyx_pf_8fastavro_5_read_60maybe_promote(__pyx_self, __pyx_v_data, __pyx_v_writer_type, __pyx_v_reader_type);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_58maybe_promote(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_writer_type, PyObject *__pyx_v_reader_type) {
+static PyObject *__pyx_pf_8fastavro_5_read_60maybe_promote(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_writer_type, PyObject *__pyx_v_reader_type) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("maybe_promote", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_maybe_promote(__pyx_v_data, __pyx_v_writer_type, __pyx_v_reader_type, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_maybe_promote(__pyx_v_data, __pyx_v_writer_type, __pyx_v_reader_type, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -11301,26 +11532,26 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":670
+/* "fastavro/_read.pyx":678
  * 
  * 
  * cpdef _read_data(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_61_read_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_63_read_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read__read_data(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8fastavro_5_read__read_data *__pyx_optional_args) {
 
-  /* "fastavro/_read.pyx":674
+  /* "fastavro/_read.pyx":682
  *     writer_schema,
  *     named_schemas,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     options={},
  * ):
  */
   PyObject *__pyx_v_reader_schema = ((PyObject *)Py_None);
@@ -11361,622 +11592,622 @@
       if (__pyx_optional_args->__pyx_n > 1) {
         __pyx_v_options = __pyx_optional_args->options;
       }
     }
   }
   __Pyx_INCREF(__pyx_v_reader_schema);
 
-  /* "fastavro/_read.pyx":679
+  /* "fastavro/_read.pyx":687
  *     """Read data from file object according to schema."""
  * 
  *     record_type = extract_record_type(writer_schema)             # <<<<<<<<<<<<<<
  * 
  *     if reader_schema:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_extract_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 679, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_extract_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 687, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_writer_schema) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_writer_schema);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 679, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 687, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_record_type = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":681
+  /* "fastavro/_read.pyx":689
  *     record_type = extract_record_type(writer_schema)
  * 
  *     if reader_schema:             # <<<<<<<<<<<<<<
- *         reader_schema = match_schemas(writer_schema, reader_schema)
- * 
+ *         reader_schema = match_schemas(
+ *             writer_schema,
  */
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 681, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 689, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":682
+    /* "fastavro/_read.pyx":690
  * 
  *     if reader_schema:
- *         reader_schema = match_schemas(writer_schema, reader_schema)             # <<<<<<<<<<<<<<
- * 
- *     try:
+ *         reader_schema = match_schemas(             # <<<<<<<<<<<<<<
+ *             writer_schema,
+ *             reader_schema,
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_match_schemas(__pyx_v_writer_schema, __pyx_v_reader_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 682, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_match_schemas(__pyx_v_writer_schema, __pyx_v_reader_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF_SET(__pyx_v_reader_schema, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":681
+    /* "fastavro/_read.pyx":689
  *     record_type = extract_record_type(writer_schema)
  * 
  *     if reader_schema:             # <<<<<<<<<<<<<<
- *         reader_schema = match_schemas(writer_schema, reader_schema)
- * 
+ *         reader_schema = match_schemas(
+ *             writer_schema,
  */
   }
 
-  /* "fastavro/_read.pyx":684
- *         reader_schema = match_schemas(writer_schema, reader_schema)
+  /* "fastavro/_read.pyx":696
+ *         )
  * 
  *     try:             # <<<<<<<<<<<<<<
  *         if record_type == "null":
  *             data = read_null(fo)
  */
   {
     __Pyx_PyThreadState_declare
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7);
     __Pyx_XGOTREF(__pyx_t_5);
     __Pyx_XGOTREF(__pyx_t_6);
     __Pyx_XGOTREF(__pyx_t_7);
     /*try:*/ {
 
-      /* "fastavro/_read.pyx":685
+      /* "fastavro/_read.pyx":697
  * 
  *     try:
  *         if record_type == "null":             # <<<<<<<<<<<<<<
  *             data = read_null(fo)
  *         elif record_type == "string":
  */
-      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_null, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 685, __pyx_L4_error)
+      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_null, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 697, __pyx_L4_error)
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":686
+        /* "fastavro/_read.pyx":698
  *     try:
  *         if record_type == "null":
  *             data = read_null(fo)             # <<<<<<<<<<<<<<
  *         elif record_type == "string":
  *             data = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  */
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_null(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 686, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_null(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":685
+        /* "fastavro/_read.pyx":697
  * 
  *     try:
  *         if record_type == "null":             # <<<<<<<<<<<<<<
  *             data = read_null(fo)
  *         elif record_type == "string":
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":687
+      /* "fastavro/_read.pyx":699
  *         if record_type == "null":
  *             data = read_null(fo)
  *         elif record_type == "string":             # <<<<<<<<<<<<<<
  *             data = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  *         elif record_type == "int" or record_type == "long":
  */
-      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 687, __pyx_L4_error)
+      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 699, __pyx_L4_error)
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":688
+        /* "fastavro/_read.pyx":700
  *             data = read_null(fo)
  *         elif record_type == "string":
  *             data = read_utf8(fo, options.get("handle_unicode_errors", "strict"))             # <<<<<<<<<<<<<<
  *         elif record_type == "int" or record_type == "long":
  *             data = read_long(fo)
  */
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_options, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 688, __pyx_L4_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_options, __pyx_n_s_get); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 688, __pyx_L4_error)
+        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 700, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_t_8.__pyx_n = 1;
         __pyx_t_8.handle_unicode_errors = __pyx_t_2;
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_utf8(__pyx_v_fo, 0, &__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 688, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_utf8(__pyx_v_fo, 0, &__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":687
+        /* "fastavro/_read.pyx":699
  *         if record_type == "null":
  *             data = read_null(fo)
  *         elif record_type == "string":             # <<<<<<<<<<<<<<
  *             data = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  *         elif record_type == "int" or record_type == "long":
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":689
+      /* "fastavro/_read.pyx":701
  *         elif record_type == "string":
  *             data = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  *         elif record_type == "int" or record_type == "long":             # <<<<<<<<<<<<<<
  *             data = read_long(fo)
  *         elif record_type == "float":
  */
-      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_int, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 689, __pyx_L4_error)
+      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_int, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 701, __pyx_L4_error)
       if (!__pyx_t_9) {
       } else {
         __pyx_t_4 = __pyx_t_9;
         goto __pyx_L11_bool_binop_done;
       }
-      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_long, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 689, __pyx_L4_error)
+      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_long, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 701, __pyx_L4_error)
       __pyx_t_4 = __pyx_t_9;
       __pyx_L11_bool_binop_done:;
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":690
+        /* "fastavro/_read.pyx":702
  *             data = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  *         elif record_type == "int" or record_type == "long":
  *             data = read_long(fo)             # <<<<<<<<<<<<<<
  *         elif record_type == "float":
  *             data = read_float(fo)
  */
-        __pyx_t_10 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_10 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 690, __pyx_L4_error)
-        __pyx_t_1 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L4_error)
+        __pyx_t_10 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_10 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 702, __pyx_L4_error)
+        __pyx_t_1 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 702, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":689
+        /* "fastavro/_read.pyx":701
  *         elif record_type == "string":
  *             data = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
  *         elif record_type == "int" or record_type == "long":             # <<<<<<<<<<<<<<
  *             data = read_long(fo)
  *         elif record_type == "float":
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":691
+      /* "fastavro/_read.pyx":703
  *         elif record_type == "int" or record_type == "long":
  *             data = read_long(fo)
  *         elif record_type == "float":             # <<<<<<<<<<<<<<
  *             data = read_float(fo)
  *         elif record_type == "double":
  */
-      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 691, __pyx_L4_error)
+      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 703, __pyx_L4_error)
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":692
+        /* "fastavro/_read.pyx":704
  *             data = read_long(fo)
  *         elif record_type == "float":
  *             data = read_float(fo)             # <<<<<<<<<<<<<<
  *         elif record_type == "double":
  *             data = read_double(fo)
  */
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_float(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 692, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_float(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 704, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":691
+        /* "fastavro/_read.pyx":703
  *         elif record_type == "int" or record_type == "long":
  *             data = read_long(fo)
  *         elif record_type == "float":             # <<<<<<<<<<<<<<
  *             data = read_float(fo)
  *         elif record_type == "double":
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":693
+      /* "fastavro/_read.pyx":705
  *         elif record_type == "float":
  *             data = read_float(fo)
  *         elif record_type == "double":             # <<<<<<<<<<<<<<
  *             data = read_double(fo)
  *         elif record_type == "boolean":
  */
-      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 693, __pyx_L4_error)
+      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 705, __pyx_L4_error)
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":694
+        /* "fastavro/_read.pyx":706
  *             data = read_float(fo)
  *         elif record_type == "double":
  *             data = read_double(fo)             # <<<<<<<<<<<<<<
  *         elif record_type == "boolean":
  *             data = read_boolean(fo)
  */
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_double(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 694, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_double(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 706, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":693
+        /* "fastavro/_read.pyx":705
  *         elif record_type == "float":
  *             data = read_float(fo)
  *         elif record_type == "double":             # <<<<<<<<<<<<<<
  *             data = read_double(fo)
  *         elif record_type == "boolean":
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":695
+      /* "fastavro/_read.pyx":707
  *         elif record_type == "double":
  *             data = read_double(fo)
  *         elif record_type == "boolean":             # <<<<<<<<<<<<<<
  *             data = read_boolean(fo)
  *         elif record_type == "bytes":
  */
-      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_boolean, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 695, __pyx_L4_error)
+      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_boolean, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 707, __pyx_L4_error)
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":696
+        /* "fastavro/_read.pyx":708
  *             data = read_double(fo)
  *         elif record_type == "boolean":
  *             data = read_boolean(fo)             # <<<<<<<<<<<<<<
  *         elif record_type == "bytes":
  *             data = read_bytes(fo)
  */
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_boolean(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_boolean(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 708, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":695
+        /* "fastavro/_read.pyx":707
  *         elif record_type == "double":
  *             data = read_double(fo)
  *         elif record_type == "boolean":             # <<<<<<<<<<<<<<
  *             data = read_boolean(fo)
  *         elif record_type == "bytes":
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":697
+      /* "fastavro/_read.pyx":709
  *         elif record_type == "boolean":
  *             data = read_boolean(fo)
  *         elif record_type == "bytes":             # <<<<<<<<<<<<<<
  *             data = read_bytes(fo)
  *         elif record_type == "fixed":
  */
-      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 697, __pyx_L4_error)
+      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 709, __pyx_L4_error)
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":698
+        /* "fastavro/_read.pyx":710
  *             data = read_boolean(fo)
  *         elif record_type == "bytes":
  *             data = read_bytes(fo)             # <<<<<<<<<<<<<<
  *         elif record_type == "fixed":
  *             data = read_fixed(fo, writer_schema)
  */
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 710, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":697
+        /* "fastavro/_read.pyx":709
  *         elif record_type == "boolean":
  *             data = read_boolean(fo)
  *         elif record_type == "bytes":             # <<<<<<<<<<<<<<
  *             data = read_bytes(fo)
  *         elif record_type == "fixed":
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":699
+      /* "fastavro/_read.pyx":711
  *         elif record_type == "bytes":
  *             data = read_bytes(fo)
  *         elif record_type == "fixed":             # <<<<<<<<<<<<<<
  *             data = read_fixed(fo, writer_schema)
  *         elif record_type == "enum":
  */
-      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_fixed, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 699, __pyx_L4_error)
+      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_fixed, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 711, __pyx_L4_error)
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":700
+        /* "fastavro/_read.pyx":712
  *             data = read_bytes(fo)
  *         elif record_type == "fixed":
  *             data = read_fixed(fo, writer_schema)             # <<<<<<<<<<<<<<
  *         elif record_type == "enum":
  *             data = read_enum(fo, writer_schema, reader_schema)
  */
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_fixed(__pyx_v_fo, __pyx_v_writer_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_fixed(__pyx_v_fo, __pyx_v_writer_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":699
+        /* "fastavro/_read.pyx":711
  *         elif record_type == "bytes":
  *             data = read_bytes(fo)
  *         elif record_type == "fixed":             # <<<<<<<<<<<<<<
  *             data = read_fixed(fo, writer_schema)
  *         elif record_type == "enum":
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":701
+      /* "fastavro/_read.pyx":713
  *         elif record_type == "fixed":
  *             data = read_fixed(fo, writer_schema)
  *         elif record_type == "enum":             # <<<<<<<<<<<<<<
  *             data = read_enum(fo, writer_schema, reader_schema)
  *         elif record_type == "array":
  */
-      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_enum, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 701, __pyx_L4_error)
+      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_enum, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 713, __pyx_L4_error)
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":702
+        /* "fastavro/_read.pyx":714
  *             data = read_fixed(fo, writer_schema)
  *         elif record_type == "enum":
  *             data = read_enum(fo, writer_schema, reader_schema)             # <<<<<<<<<<<<<<
  *         elif record_type == "array":
  *             data = read_array(
  */
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_enum(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_reader_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 702, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_enum(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_reader_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":701
+        /* "fastavro/_read.pyx":713
  *         elif record_type == "fixed":
  *             data = read_fixed(fo, writer_schema)
  *         elif record_type == "enum":             # <<<<<<<<<<<<<<
  *             data = read_enum(fo, writer_schema, reader_schema)
  *         elif record_type == "array":
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":703
+      /* "fastavro/_read.pyx":715
  *         elif record_type == "enum":
  *             data = read_enum(fo, writer_schema, reader_schema)
  *         elif record_type == "array":             # <<<<<<<<<<<<<<
  *             data = read_array(
  *                 fo,
  */
-      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_array, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 703, __pyx_L4_error)
+      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_array, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 715, __pyx_L4_error)
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":704
+        /* "fastavro/_read.pyx":716
  *             data = read_enum(fo, writer_schema, reader_schema)
  *         elif record_type == "array":
  *             data = read_array(             # <<<<<<<<<<<<<<
  *                 fo,
  *                 writer_schema,
  */
         __pyx_t_11.__pyx_n = 2;
         __pyx_t_11.reader_schema = __pyx_v_reader_schema;
         __pyx_t_11.options = __pyx_v_options;
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_array(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 704, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_array(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 716, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":703
+        /* "fastavro/_read.pyx":715
  *         elif record_type == "enum":
  *             data = read_enum(fo, writer_schema, reader_schema)
  *         elif record_type == "array":             # <<<<<<<<<<<<<<
  *             data = read_array(
  *                 fo,
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":711
+      /* "fastavro/_read.pyx":723
  *                 options,
  *             )
  *         elif record_type == "map":             # <<<<<<<<<<<<<<
  *             data = read_map(
  *                 fo,
  */
-      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_map, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 711, __pyx_L4_error)
+      __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_map, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 723, __pyx_L4_error)
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":712
+        /* "fastavro/_read.pyx":724
  *             )
  *         elif record_type == "map":
  *             data = read_map(             # <<<<<<<<<<<<<<
  *                 fo,
  *                 writer_schema,
  */
         __pyx_t_12.__pyx_n = 2;
         __pyx_t_12.reader_schema = __pyx_v_reader_schema;
         __pyx_t_12.options = __pyx_v_options;
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_map(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 712, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_map(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 724, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":711
+        /* "fastavro/_read.pyx":723
  *                 options,
  *             )
  *         elif record_type == "map":             # <<<<<<<<<<<<<<
  *             data = read_map(
  *                 fo,
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":719
+      /* "fastavro/_read.pyx":731
  *                 options,
  *             )
  *         elif record_type == "union" or record_type == "error_union":             # <<<<<<<<<<<<<<
  *             data = read_union(
  *                 fo,
  */
-      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_union, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 719, __pyx_L4_error)
+      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_union, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 731, __pyx_L4_error)
       if (!__pyx_t_9) {
       } else {
         __pyx_t_4 = __pyx_t_9;
         goto __pyx_L13_bool_binop_done;
       }
-      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_error_union, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 719, __pyx_L4_error)
+      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_error_union, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 731, __pyx_L4_error)
       __pyx_t_4 = __pyx_t_9;
       __pyx_L13_bool_binop_done:;
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":720
+        /* "fastavro/_read.pyx":732
  *             )
  *         elif record_type == "union" or record_type == "error_union":
  *             data = read_union(             # <<<<<<<<<<<<<<
  *                 fo,
  *                 writer_schema,
  */
         __pyx_t_13.__pyx_n = 2;
         __pyx_t_13.reader_schema = __pyx_v_reader_schema;
         __pyx_t_13.options = __pyx_v_options;
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_union(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_13); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_union(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_13); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 732, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":719
+        /* "fastavro/_read.pyx":731
  *                 options,
  *             )
  *         elif record_type == "union" or record_type == "error_union":             # <<<<<<<<<<<<<<
  *             data = read_union(
  *                 fo,
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":727
+      /* "fastavro/_read.pyx":739
  *                 options,
  *             )
  *         elif record_type == "record" or record_type == "error":             # <<<<<<<<<<<<<<
  *             data = read_record(
  *                 fo,
  */
-      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_record, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 727, __pyx_L4_error)
+      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_record, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 739, __pyx_L4_error)
       if (!__pyx_t_9) {
       } else {
         __pyx_t_4 = __pyx_t_9;
         goto __pyx_L15_bool_binop_done;
       }
-      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_error, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 727, __pyx_L4_error)
+      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_error, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 739, __pyx_L4_error)
       __pyx_t_4 = __pyx_t_9;
       __pyx_L15_bool_binop_done:;
       if (__pyx_t_4) {
 
-        /* "fastavro/_read.pyx":728
+        /* "fastavro/_read.pyx":740
  *             )
  *         elif record_type == "record" or record_type == "error":
  *             data = read_record(             # <<<<<<<<<<<<<<
  *                 fo,
  *                 writer_schema,
  */
         __pyx_t_14.__pyx_n = 2;
         __pyx_t_14.reader_schema = __pyx_v_reader_schema;
         __pyx_t_14.options = __pyx_v_options;
-        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_record(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 728, __pyx_L4_error)
+        __pyx_t_1 = __pyx_f_8fastavro_5_read_read_record(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_14); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __pyx_v_data = __pyx_t_1;
         __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":727
+        /* "fastavro/_read.pyx":739
  *                 options,
  *             )
  *         elif record_type == "record" or record_type == "error":             # <<<<<<<<<<<<<<
  *             data = read_record(
  *                 fo,
  */
         goto __pyx_L10;
       }
 
-      /* "fastavro/_read.pyx":736
+      /* "fastavro/_read.pyx":748
  *             )
  *         else:
  *             return _read_data(             # <<<<<<<<<<<<<<
  *                 fo,
  *                 named_schemas["writer"][record_type],
  */
       /*else*/ {
         __Pyx_XDECREF(__pyx_r);
 
-        /* "fastavro/_read.pyx":738
+        /* "fastavro/_read.pyx":750
  *             return _read_data(
  *                 fo,
  *                 named_schemas["writer"][record_type],             # <<<<<<<<<<<<<<
  *                 named_schemas,
  *                 named_schemas["reader"].get(reader_schema),
  */
-        __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_writer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L4_error)
+        __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_writer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L4_error)
+        __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-        /* "fastavro/_read.pyx":740
+        /* "fastavro/_read.pyx":752
  *                 named_schemas["writer"][record_type],
  *                 named_schemas,
  *                 named_schemas["reader"].get(reader_schema),             # <<<<<<<<<<<<<<
  *                 options,
  *             )
  */
-        __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_reader); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 740, __pyx_L4_error)
+        __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_reader); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 752, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_get); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 740, __pyx_L4_error)
+        __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_get); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 752, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_15);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_t_3 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_15))) {
           __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_15);
           if (likely(__pyx_t_3)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_15);
             __Pyx_INCREF(__pyx_t_3);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_15, function);
           }
         }
         __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_15, __pyx_t_3, __pyx_v_reader_schema) : __Pyx_PyObject_CallOneArg(__pyx_t_15, __pyx_v_reader_schema);
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L4_error)
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 752, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
 
-        /* "fastavro/_read.pyx":736
+        /* "fastavro/_read.pyx":748
  *             )
  *         else:
  *             return _read_data(             # <<<<<<<<<<<<<<
  *                 fo,
  *                 named_schemas["writer"][record_type],
  */
         __pyx_t_16.__pyx_n = 2;
         __pyx_t_16.reader_schema = __pyx_t_1;
         __pyx_t_16.options = __pyx_v_options;
-        __pyx_t_15 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_2, __pyx_v_named_schemas, 0, &__pyx_t_16); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 736, __pyx_L4_error)
+        __pyx_t_15 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_t_2, __pyx_v_named_schemas, 0, &__pyx_t_16); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 748, __pyx_L4_error)
         __Pyx_GOTREF(__pyx_t_15);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_r = __pyx_t_15;
         __pyx_t_15 = 0;
         goto __pyx_L8_try_return;
       }
       __pyx_L10:;
 
-      /* "fastavro/_read.pyx":684
- *         reader_schema = match_schemas(writer_schema, reader_schema)
+      /* "fastavro/_read.pyx":696
+ *         )
  * 
  *     try:             # <<<<<<<<<<<<<<
  *         if record_type == "null":
  *             data = read_null(fo)
  */
     }
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
@@ -11985,83 +12216,83 @@
     goto __pyx_L9_try_end;
     __pyx_L4_error:;
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "fastavro/_read.pyx":743
+    /* "fastavro/_read.pyx":755
  *                 options,
  *             )
  *     except ReadError:             # <<<<<<<<<<<<<<
  *         raise EOFError(f"cannot read {record_type} from {fo}")
  * 
  */
     __Pyx_ErrFetch(&__pyx_t_15, &__pyx_t_1, &__pyx_t_2);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_ReadError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L6_except_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_ReadError); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 755, __pyx_L6_except_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_17 = __Pyx_PyErr_GivenExceptionMatches(__pyx_t_15, __pyx_t_3);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_ErrRestore(__pyx_t_15, __pyx_t_1, __pyx_t_2);
     __pyx_t_15 = 0; __pyx_t_1 = 0; __pyx_t_2 = 0;
     if (__pyx_t_17) {
       __Pyx_AddTraceback("fastavro._read._read_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_1, &__pyx_t_15) < 0) __PYX_ERR(0, 743, __pyx_L6_except_error)
+      if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_1, &__pyx_t_15) < 0) __PYX_ERR(0, 755, __pyx_L6_except_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GOTREF(__pyx_t_15);
 
-      /* "fastavro/_read.pyx":744
+      /* "fastavro/_read.pyx":756
  *             )
  *     except ReadError:
  *         raise EOFError(f"cannot read {record_type} from {fo}")             # <<<<<<<<<<<<<<
  * 
  *     if "logicalType" in writer_schema:
  */
-      __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 744, __pyx_L6_except_error)
+      __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 756, __pyx_L6_except_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_18 = 0;
       __pyx_t_19 = 127;
       __Pyx_INCREF(__pyx_kp_u_cannot_read);
       __pyx_t_18 += 12;
       __Pyx_GIVEREF(__pyx_kp_u_cannot_read);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_kp_u_cannot_read);
-      __pyx_t_20 = __Pyx_PyObject_FormatSimple(__pyx_v_record_type, __pyx_empty_unicode); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 744, __pyx_L6_except_error)
+      __pyx_t_20 = __Pyx_PyObject_FormatSimple(__pyx_v_record_type, __pyx_empty_unicode); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 756, __pyx_L6_except_error)
       __Pyx_GOTREF(__pyx_t_20);
       __pyx_t_19 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_20) > __pyx_t_19) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_20) : __pyx_t_19;
       __pyx_t_18 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_20);
       __Pyx_GIVEREF(__pyx_t_20);
       PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_20);
       __pyx_t_20 = 0;
       __Pyx_INCREF(__pyx_kp_u_from);
       __pyx_t_18 += 6;
       __Pyx_GIVEREF(__pyx_kp_u_from);
       PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_kp_u_from);
-      __pyx_t_20 = __Pyx_PyObject_FormatSimple(__pyx_v_fo, __pyx_empty_unicode); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 744, __pyx_L6_except_error)
+      __pyx_t_20 = __Pyx_PyObject_FormatSimple(__pyx_v_fo, __pyx_empty_unicode); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 756, __pyx_L6_except_error)
       __Pyx_GOTREF(__pyx_t_20);
       __pyx_t_19 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_20) > __pyx_t_19) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_20) : __pyx_t_19;
       __pyx_t_18 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_20);
       __Pyx_GIVEREF(__pyx_t_20);
       PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_t_20);
       __pyx_t_20 = 0;
-      __pyx_t_20 = __Pyx_PyUnicode_Join(__pyx_t_3, 4, __pyx_t_18, __pyx_t_19); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 744, __pyx_L6_except_error)
+      __pyx_t_20 = __Pyx_PyUnicode_Join(__pyx_t_3, 4, __pyx_t_18, __pyx_t_19); if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 756, __pyx_L6_except_error)
       __Pyx_GOTREF(__pyx_t_20);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_EOFError, __pyx_t_20); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 744, __pyx_L6_except_error)
+      __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_EOFError, __pyx_t_20); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 756, __pyx_L6_except_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_20); __pyx_t_20 = 0;
       __Pyx_Raise(__pyx_t_3, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __PYX_ERR(0, 744, __pyx_L6_except_error)
+      __PYX_ERR(0, 756, __pyx_L6_except_error)
     }
     goto __pyx_L6_except_error;
     __pyx_L6_except_error:;
 
-    /* "fastavro/_read.pyx":684
- *         reader_schema = match_schemas(writer_schema, reader_schema)
+    /* "fastavro/_read.pyx":696
+ *         )
  * 
  *     try:             # <<<<<<<<<<<<<<
  *         if record_type == "null":
  *             data = read_null(fo)
  */
     __Pyx_XGIVEREF(__pyx_t_5);
     __Pyx_XGIVEREF(__pyx_t_6);
@@ -12073,93 +12304,93 @@
     __Pyx_XGIVEREF(__pyx_t_6);
     __Pyx_XGIVEREF(__pyx_t_7);
     __Pyx_ExceptionReset(__pyx_t_5, __pyx_t_6, __pyx_t_7);
     goto __pyx_L0;
     __pyx_L9_try_end:;
   }
 
-  /* "fastavro/_read.pyx":746
+  /* "fastavro/_read.pyx":758
  *         raise EOFError(f"cannot read {record_type} from {fo}")
  * 
  *     if "logicalType" in writer_schema:             # <<<<<<<<<<<<<<
  *         logical_type = extract_logical_type(writer_schema)
  *         fn = LOGICAL_READERS.get(logical_type)
  */
-  __pyx_t_4 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_logicalType, __pyx_v_writer_schema, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 746, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_logicalType, __pyx_v_writer_schema, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 758, __pyx_L1_error)
   __pyx_t_9 = (__pyx_t_4 != 0);
   if (__pyx_t_9) {
 
-    /* "fastavro/_read.pyx":747
+    /* "fastavro/_read.pyx":759
  * 
  *     if "logicalType" in writer_schema:
  *         logical_type = extract_logical_type(writer_schema)             # <<<<<<<<<<<<<<
  *         fn = LOGICAL_READERS.get(logical_type)
  *         if fn:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_extract_logical_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 747, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_extract_logical_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_15 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_v_writer_schema) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_writer_schema);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 747, __pyx_L1_error)
+    if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 759, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_logical_type = __pyx_t_15;
     __pyx_t_15 = 0;
 
-    /* "fastavro/_read.pyx":748
+    /* "fastavro/_read.pyx":760
  *     if "logicalType" in writer_schema:
  *         logical_type = extract_logical_type(writer_schema)
  *         fn = LOGICAL_READERS.get(logical_type)             # <<<<<<<<<<<<<<
  *         if fn:
  *             return fn(data, writer_schema, reader_schema)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_LOGICAL_READERS); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 748, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_LOGICAL_READERS); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 760, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 748, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_get); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 760, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_15 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1, __pyx_v_logical_type) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_logical_type);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 748, __pyx_L1_error)
+    if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 760, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_fn = __pyx_t_15;
     __pyx_t_15 = 0;
 
-    /* "fastavro/_read.pyx":749
+    /* "fastavro/_read.pyx":761
  *         logical_type = extract_logical_type(writer_schema)
  *         fn = LOGICAL_READERS.get(logical_type)
  *         if fn:             # <<<<<<<<<<<<<<
  *             return fn(data, writer_schema, reader_schema)
  * 
  */
-    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_v_fn); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 749, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_v_fn); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 761, __pyx_L1_error)
     if (__pyx_t_9) {
 
-      /* "fastavro/_read.pyx":750
+      /* "fastavro/_read.pyx":762
  *         fn = LOGICAL_READERS.get(logical_type)
  *         if fn:
  *             return fn(data, writer_schema, reader_schema)             # <<<<<<<<<<<<<<
  * 
  *     if reader_schema is not None:
  */
       __Pyx_XDECREF(__pyx_r);
@@ -12175,152 +12406,152 @@
           __Pyx_DECREF_SET(__pyx_t_2, function);
           __pyx_t_17 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_2)) {
         PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_v_data, __pyx_v_writer_schema, __pyx_v_reader_schema};
-        __pyx_t_15 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_17, 3+__pyx_t_17); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 750, __pyx_L1_error)
+        __pyx_t_15 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_17, 3+__pyx_t_17); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 762, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_15);
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
         PyObject *__pyx_temp[4] = {__pyx_t_1, __pyx_v_data, __pyx_v_writer_schema, __pyx_v_reader_schema};
-        __pyx_t_15 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_17, 3+__pyx_t_17); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 750, __pyx_L1_error)
+        __pyx_t_15 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_17, 3+__pyx_t_17); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 762, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_GOTREF(__pyx_t_15);
       } else
       #endif
       {
-        __pyx_t_3 = PyTuple_New(3+__pyx_t_17); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_New(3+__pyx_t_17); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 762, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (__pyx_t_1) {
           __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
         }
         __Pyx_INCREF(__pyx_v_data);
         __Pyx_GIVEREF(__pyx_v_data);
         PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_17, __pyx_v_data);
         __Pyx_INCREF(__pyx_v_writer_schema);
         __Pyx_GIVEREF(__pyx_v_writer_schema);
         PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_17, __pyx_v_writer_schema);
         __Pyx_INCREF(__pyx_v_reader_schema);
         __Pyx_GIVEREF(__pyx_v_reader_schema);
         PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_17, __pyx_v_reader_schema);
-        __pyx_t_15 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 750, __pyx_L1_error)
+        __pyx_t_15 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 762, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_15);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_r = __pyx_t_15;
       __pyx_t_15 = 0;
       goto __pyx_L0;
 
-      /* "fastavro/_read.pyx":749
+      /* "fastavro/_read.pyx":761
  *         logical_type = extract_logical_type(writer_schema)
  *         fn = LOGICAL_READERS.get(logical_type)
  *         if fn:             # <<<<<<<<<<<<<<
  *             return fn(data, writer_schema, reader_schema)
  * 
  */
     }
 
-    /* "fastavro/_read.pyx":746
+    /* "fastavro/_read.pyx":758
  *         raise EOFError(f"cannot read {record_type} from {fo}")
  * 
  *     if "logicalType" in writer_schema:             # <<<<<<<<<<<<<<
  *         logical_type = extract_logical_type(writer_schema)
  *         fn = LOGICAL_READERS.get(logical_type)
  */
   }
 
-  /* "fastavro/_read.pyx":752
+  /* "fastavro/_read.pyx":764
  *             return fn(data, writer_schema, reader_schema)
  * 
  *     if reader_schema is not None:             # <<<<<<<<<<<<<<
  *         return maybe_promote(
  *             data,
  */
   __pyx_t_9 = (__pyx_v_reader_schema != Py_None);
   __pyx_t_4 = (__pyx_t_9 != 0);
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":753
+    /* "fastavro/_read.pyx":765
  * 
  *     if reader_schema is not None:
  *         return maybe_promote(             # <<<<<<<<<<<<<<
  *             data,
  *             record_type,
  */
     __Pyx_XDECREF(__pyx_r);
 
-    /* "fastavro/_read.pyx":756
+    /* "fastavro/_read.pyx":768
  *             data,
  *             record_type,
  *             extract_record_type(reader_schema)             # <<<<<<<<<<<<<<
  *         )
  *     else:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_extract_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 756, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_extract_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_15 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_reader_schema) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_reader_schema);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 756, __pyx_L1_error)
+    if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 768, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "fastavro/_read.pyx":753
+    /* "fastavro/_read.pyx":765
  * 
  *     if reader_schema is not None:
  *         return maybe_promote(             # <<<<<<<<<<<<<<
  *             data,
  *             record_type,
  */
-    __pyx_t_2 = __pyx_f_8fastavro_5_read_maybe_promote(__pyx_v_data, __pyx_v_record_type, __pyx_t_15, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 753, __pyx_L1_error)
+    __pyx_t_2 = __pyx_f_8fastavro_5_read_maybe_promote(__pyx_v_data, __pyx_v_record_type, __pyx_t_15, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 765, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
 
-    /* "fastavro/_read.pyx":752
+    /* "fastavro/_read.pyx":764
  *             return fn(data, writer_schema, reader_schema)
  * 
  *     if reader_schema is not None:             # <<<<<<<<<<<<<<
  *         return maybe_promote(
  *             data,
  */
   }
 
-  /* "fastavro/_read.pyx":759
+  /* "fastavro/_read.pyx":771
  *         )
  *     else:
  *         return data             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_v_data);
     __pyx_r = __pyx_v_data;
     goto __pyx_L0;
   }
 
-  /* "fastavro/_read.pyx":670
+  /* "fastavro/_read.pyx":678
  * 
  * 
  * cpdef _read_data(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
@@ -12341,17 +12572,17 @@
   __Pyx_XDECREF(__pyx_v_reader_schema);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_61_read_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_60_read_data[] = "Read data from file object according to schema.";
-static PyObject *__pyx_pw_8fastavro_5_read_61_read_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_63_read_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_62_read_data[] = "Read data from file object according to schema.";
+static PyObject *__pyx_pw_8fastavro_5_read_63_read_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   PyObject *__pyx_v_reader_schema = 0;
   PyObject *__pyx_v_options = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
@@ -12359,15 +12590,15 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("_read_data (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_fo,&__pyx_n_s_writer_schema,&__pyx_n_s_named_schemas,&__pyx_n_s_reader_schema,&__pyx_n_s_options,0};
     PyObject* values[5] = {0,0,0,0,0};
 
-    /* "fastavro/_read.pyx":674
+    /* "fastavro/_read.pyx":682
  *     writer_schema,
  *     named_schemas,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     options={},
  * ):
  */
     values[3] = ((PyObject *)Py_None);
@@ -12394,21 +12625,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_read_data", 0, 3, 5, 1); __PYX_ERR(0, 670, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_read_data", 0, 3, 5, 1); __PYX_ERR(0, 678, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_read_data", 0, 3, 5, 2); __PYX_ERR(0, 670, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_read_data", 0, 3, 5, 2); __PYX_ERR(0, 678, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -12416,15 +12647,15 @@
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_options);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_read_data") < 0)) __PYX_ERR(0, 670, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_read_data") < 0)) __PYX_ERR(0, 678, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
@@ -12439,49 +12670,49 @@
     __pyx_v_writer_schema = values[1];
     __pyx_v_named_schemas = values[2];
     __pyx_v_reader_schema = values[3];
     __pyx_v_options = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_read_data", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 670, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_read_data", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 678, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read._read_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_60_read_data(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
+  __pyx_r = __pyx_pf_8fastavro_5_read_62_read_data(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
 
-  /* "fastavro/_read.pyx":670
+  /* "fastavro/_read.pyx":678
  * 
  * 
  * cpdef _read_data(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_60_read_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
+static PyObject *__pyx_pf_8fastavro_5_read_62_read_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8fastavro_5_read__read_data __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_read_data", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.reader_schema = __pyx_v_reader_schema;
   __pyx_t_2.options = __pyx_v_options;
-  __pyx_t_1 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 670, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -12490,512 +12721,512 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":762
+/* "fastavro/_read.pyx":774
  * 
  * 
  * cpdef _skip_data(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_63_skip_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_65_skip_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read__skip_data(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_v_record_type = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_skip_data", 0);
 
-  /* "fastavro/_read.pyx":767
+  /* "fastavro/_read.pyx":779
  *     named_schemas,
  * ):
  *     record_type = extract_record_type(writer_schema)             # <<<<<<<<<<<<<<
  * 
  *     if record_type == "null":
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_extract_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 767, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_extract_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 779, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_writer_schema) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_writer_schema);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 767, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_record_type = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":769
+  /* "fastavro/_read.pyx":781
  *     record_type = extract_record_type(writer_schema)
  * 
  *     if record_type == "null":             # <<<<<<<<<<<<<<
  *         skip_null(fo)
  *     elif record_type == "string":
  */
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_null, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 769, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_null, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 781, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":770
+    /* "fastavro/_read.pyx":782
  * 
  *     if record_type == "null":
  *         skip_null(fo)             # <<<<<<<<<<<<<<
  *     elif record_type == "string":
  *         skip_utf8(fo)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_null(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 770, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_null(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 782, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":769
+    /* "fastavro/_read.pyx":781
  *     record_type = extract_record_type(writer_schema)
  * 
  *     if record_type == "null":             # <<<<<<<<<<<<<<
  *         skip_null(fo)
  *     elif record_type == "string":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":771
+  /* "fastavro/_read.pyx":783
  *     if record_type == "null":
  *         skip_null(fo)
  *     elif record_type == "string":             # <<<<<<<<<<<<<<
  *         skip_utf8(fo)
  *     elif record_type == "int" or record_type == "long":
  */
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 771, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_string, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 783, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":772
+    /* "fastavro/_read.pyx":784
  *         skip_null(fo)
  *     elif record_type == "string":
  *         skip_utf8(fo)             # <<<<<<<<<<<<<<
  *     elif record_type == "int" or record_type == "long":
  *         skip_long(fo)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_utf8(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_utf8(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 784, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":771
+    /* "fastavro/_read.pyx":783
  *     if record_type == "null":
  *         skip_null(fo)
  *     elif record_type == "string":             # <<<<<<<<<<<<<<
  *         skip_utf8(fo)
  *     elif record_type == "int" or record_type == "long":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":773
+  /* "fastavro/_read.pyx":785
  *     elif record_type == "string":
  *         skip_utf8(fo)
  *     elif record_type == "int" or record_type == "long":             # <<<<<<<<<<<<<<
  *         skip_long(fo)
  *     elif record_type == "float":
  */
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_int, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 773, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_int, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 785, __pyx_L1_error)
   if (!__pyx_t_5) {
   } else {
     __pyx_t_4 = __pyx_t_5;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_long, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 773, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_long, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 785, __pyx_L1_error)
   __pyx_t_4 = __pyx_t_5;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":774
+    /* "fastavro/_read.pyx":786
  *         skip_utf8(fo)
  *     elif record_type == "int" or record_type == "long":
  *         skip_long(fo)             # <<<<<<<<<<<<<<
  *     elif record_type == "float":
  *         skip_float(fo)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_long(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 774, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_long(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":773
+    /* "fastavro/_read.pyx":785
  *     elif record_type == "string":
  *         skip_utf8(fo)
  *     elif record_type == "int" or record_type == "long":             # <<<<<<<<<<<<<<
  *         skip_long(fo)
  *     elif record_type == "float":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":775
+  /* "fastavro/_read.pyx":787
  *     elif record_type == "int" or record_type == "long":
  *         skip_long(fo)
  *     elif record_type == "float":             # <<<<<<<<<<<<<<
  *         skip_float(fo)
  *     elif record_type == "double":
  */
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 775, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_float, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 787, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":776
+    /* "fastavro/_read.pyx":788
  *         skip_long(fo)
  *     elif record_type == "float":
  *         skip_float(fo)             # <<<<<<<<<<<<<<
  *     elif record_type == "double":
  *         skip_double(fo)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_float(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 776, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_float(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":775
+    /* "fastavro/_read.pyx":787
  *     elif record_type == "int" or record_type == "long":
  *         skip_long(fo)
  *     elif record_type == "float":             # <<<<<<<<<<<<<<
  *         skip_float(fo)
  *     elif record_type == "double":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":777
+  /* "fastavro/_read.pyx":789
  *     elif record_type == "float":
  *         skip_float(fo)
  *     elif record_type == "double":             # <<<<<<<<<<<<<<
  *         skip_double(fo)
  *     elif record_type == "boolean":
  */
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 777, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_double, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 789, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":778
+    /* "fastavro/_read.pyx":790
  *         skip_float(fo)
  *     elif record_type == "double":
  *         skip_double(fo)             # <<<<<<<<<<<<<<
  *     elif record_type == "boolean":
  *         skip_boolean(fo)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_double(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_double(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 790, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":777
+    /* "fastavro/_read.pyx":789
  *     elif record_type == "float":
  *         skip_float(fo)
  *     elif record_type == "double":             # <<<<<<<<<<<<<<
  *         skip_double(fo)
  *     elif record_type == "boolean":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":779
+  /* "fastavro/_read.pyx":791
  *     elif record_type == "double":
  *         skip_double(fo)
  *     elif record_type == "boolean":             # <<<<<<<<<<<<<<
  *         skip_boolean(fo)
  *     elif record_type == "bytes":
  */
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_boolean, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 779, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_boolean, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 791, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":780
+    /* "fastavro/_read.pyx":792
  *         skip_double(fo)
  *     elif record_type == "boolean":
  *         skip_boolean(fo)             # <<<<<<<<<<<<<<
  *     elif record_type == "bytes":
  *         skip_bytes(fo)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_boolean(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_boolean(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 792, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":779
+    /* "fastavro/_read.pyx":791
  *     elif record_type == "double":
  *         skip_double(fo)
  *     elif record_type == "boolean":             # <<<<<<<<<<<<<<
  *         skip_boolean(fo)
  *     elif record_type == "bytes":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":781
+  /* "fastavro/_read.pyx":793
  *     elif record_type == "boolean":
  *         skip_boolean(fo)
  *     elif record_type == "bytes":             # <<<<<<<<<<<<<<
  *         skip_bytes(fo)
  *     elif record_type == "fixed":
  */
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 781, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_bytes, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 793, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":782
+    /* "fastavro/_read.pyx":794
  *         skip_boolean(fo)
  *     elif record_type == "bytes":
  *         skip_bytes(fo)             # <<<<<<<<<<<<<<
  *     elif record_type == "fixed":
  *         skip_fixed(fo, writer_schema)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 782, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":781
+    /* "fastavro/_read.pyx":793
  *     elif record_type == "boolean":
  *         skip_boolean(fo)
  *     elif record_type == "bytes":             # <<<<<<<<<<<<<<
  *         skip_bytes(fo)
  *     elif record_type == "fixed":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":783
+  /* "fastavro/_read.pyx":795
  *     elif record_type == "bytes":
  *         skip_bytes(fo)
  *     elif record_type == "fixed":             # <<<<<<<<<<<<<<
  *         skip_fixed(fo, writer_schema)
  *     elif record_type == "enum":
  */
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_fixed, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 783, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_fixed, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 795, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":784
+    /* "fastavro/_read.pyx":796
  *         skip_bytes(fo)
  *     elif record_type == "fixed":
  *         skip_fixed(fo, writer_schema)             # <<<<<<<<<<<<<<
  *     elif record_type == "enum":
  *         skip_enum(fo)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_fixed(__pyx_v_fo, __pyx_v_writer_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 784, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_fixed(__pyx_v_fo, __pyx_v_writer_schema, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 796, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":783
+    /* "fastavro/_read.pyx":795
  *     elif record_type == "bytes":
  *         skip_bytes(fo)
  *     elif record_type == "fixed":             # <<<<<<<<<<<<<<
  *         skip_fixed(fo, writer_schema)
  *     elif record_type == "enum":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":785
+  /* "fastavro/_read.pyx":797
  *     elif record_type == "fixed":
  *         skip_fixed(fo, writer_schema)
  *     elif record_type == "enum":             # <<<<<<<<<<<<<<
  *         skip_enum(fo)
  *     elif record_type == "array":
  */
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_enum, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 785, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_enum, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 797, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":786
+    /* "fastavro/_read.pyx":798
  *         skip_fixed(fo, writer_schema)
  *     elif record_type == "enum":
  *         skip_enum(fo)             # <<<<<<<<<<<<<<
  *     elif record_type == "array":
  *         skip_array(fo, writer_schema, named_schemas)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_enum(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_enum(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 798, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":785
+    /* "fastavro/_read.pyx":797
  *     elif record_type == "fixed":
  *         skip_fixed(fo, writer_schema)
  *     elif record_type == "enum":             # <<<<<<<<<<<<<<
  *         skip_enum(fo)
  *     elif record_type == "array":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":787
+  /* "fastavro/_read.pyx":799
  *     elif record_type == "enum":
  *         skip_enum(fo)
  *     elif record_type == "array":             # <<<<<<<<<<<<<<
  *         skip_array(fo, writer_schema, named_schemas)
  *     elif record_type == "map":
  */
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_array, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 787, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_array, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 799, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":788
+    /* "fastavro/_read.pyx":800
  *         skip_enum(fo)
  *     elif record_type == "array":
  *         skip_array(fo, writer_schema, named_schemas)             # <<<<<<<<<<<<<<
  *     elif record_type == "map":
  *         skip_map(fo, writer_schema, named_schemas)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_array(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_array(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 800, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":787
+    /* "fastavro/_read.pyx":799
  *     elif record_type == "enum":
  *         skip_enum(fo)
  *     elif record_type == "array":             # <<<<<<<<<<<<<<
  *         skip_array(fo, writer_schema, named_schemas)
  *     elif record_type == "map":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":789
+  /* "fastavro/_read.pyx":801
  *     elif record_type == "array":
  *         skip_array(fo, writer_schema, named_schemas)
  *     elif record_type == "map":             # <<<<<<<<<<<<<<
  *         skip_map(fo, writer_schema, named_schemas)
  *     elif record_type == "union" or record_type == "error_union":
  */
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_map, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 789, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_map, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 801, __pyx_L1_error)
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":790
+    /* "fastavro/_read.pyx":802
  *         skip_array(fo, writer_schema, named_schemas)
  *     elif record_type == "map":
  *         skip_map(fo, writer_schema, named_schemas)             # <<<<<<<<<<<<<<
  *     elif record_type == "union" or record_type == "error_union":
  *         skip_union(fo, writer_schema, named_schemas)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_map(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 790, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_map(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 802, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":789
+    /* "fastavro/_read.pyx":801
  *     elif record_type == "array":
  *         skip_array(fo, writer_schema, named_schemas)
  *     elif record_type == "map":             # <<<<<<<<<<<<<<
  *         skip_map(fo, writer_schema, named_schemas)
  *     elif record_type == "union" or record_type == "error_union":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":791
+  /* "fastavro/_read.pyx":803
  *     elif record_type == "map":
  *         skip_map(fo, writer_schema, named_schemas)
  *     elif record_type == "union" or record_type == "error_union":             # <<<<<<<<<<<<<<
  *         skip_union(fo, writer_schema, named_schemas)
  *     elif record_type == "record" or record_type == "error":
  */
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_union, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 791, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_union, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 803, __pyx_L1_error)
   if (!__pyx_t_5) {
   } else {
     __pyx_t_4 = __pyx_t_5;
     goto __pyx_L6_bool_binop_done;
   }
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_error_union, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 791, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_error_union, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 803, __pyx_L1_error)
   __pyx_t_4 = __pyx_t_5;
   __pyx_L6_bool_binop_done:;
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":792
+    /* "fastavro/_read.pyx":804
  *         skip_map(fo, writer_schema, named_schemas)
  *     elif record_type == "union" or record_type == "error_union":
  *         skip_union(fo, writer_schema, named_schemas)             # <<<<<<<<<<<<<<
  *     elif record_type == "record" or record_type == "error":
  *         skip_record(fo, writer_schema, named_schemas)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_union(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 792, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_union(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":791
+    /* "fastavro/_read.pyx":803
  *     elif record_type == "map":
  *         skip_map(fo, writer_schema, named_schemas)
  *     elif record_type == "union" or record_type == "error_union":             # <<<<<<<<<<<<<<
  *         skip_union(fo, writer_schema, named_schemas)
  *     elif record_type == "record" or record_type == "error":
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":793
+  /* "fastavro/_read.pyx":805
  *     elif record_type == "union" or record_type == "error_union":
  *         skip_union(fo, writer_schema, named_schemas)
  *     elif record_type == "record" or record_type == "error":             # <<<<<<<<<<<<<<
  *         skip_record(fo, writer_schema, named_schemas)
  *     else:
  */
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_record, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 793, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_record, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 805, __pyx_L1_error)
   if (!__pyx_t_5) {
   } else {
     __pyx_t_4 = __pyx_t_5;
     goto __pyx_L8_bool_binop_done;
   }
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_error, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 793, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_record_type, __pyx_n_u_error, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 805, __pyx_L1_error)
   __pyx_t_4 = __pyx_t_5;
   __pyx_L8_bool_binop_done:;
   if (__pyx_t_4) {
 
-    /* "fastavro/_read.pyx":794
+    /* "fastavro/_read.pyx":806
  *         skip_union(fo, writer_schema, named_schemas)
  *     elif record_type == "record" or record_type == "error":
  *         skip_record(fo, writer_schema, named_schemas)             # <<<<<<<<<<<<<<
  *     else:
  *         _skip_data(fo, named_schemas["writer"][record_type], named_schemas)
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_record(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_record(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 806, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":793
+    /* "fastavro/_read.pyx":805
  *     elif record_type == "union" or record_type == "error_union":
  *         skip_union(fo, writer_schema, named_schemas)
  *     elif record_type == "record" or record_type == "error":             # <<<<<<<<<<<<<<
  *         skip_record(fo, writer_schema, named_schemas)
  *     else:
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":796
+  /* "fastavro/_read.pyx":808
  *         skip_record(fo, writer_schema, named_schemas)
  *     else:
  *         _skip_data(fo, named_schemas["writer"][record_type], named_schemas)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
-    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_writer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 796, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_writer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 796, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_record_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_2, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 796, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_t_2, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 808, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
   __pyx_L3:;
 
-  /* "fastavro/_read.pyx":762
+  /* "fastavro/_read.pyx":774
  * 
  * 
  * cpdef _skip_data(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
@@ -13012,16 +13243,16 @@
   __Pyx_XDECREF(__pyx_v_record_type);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_63_skip_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_63_skip_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_65_skip_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_65_skip_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -13048,62 +13279,62 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_skip_data", 1, 3, 3, 1); __PYX_ERR(0, 762, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_skip_data", 1, 3, 3, 1); __PYX_ERR(0, 774, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_skip_data", 1, 3, 3, 2); __PYX_ERR(0, 762, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_skip_data", 1, 3, 3, 2); __PYX_ERR(0, 774, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_skip_data") < 0)) __PYX_ERR(0, 762, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_skip_data") < 0)) __PYX_ERR(0, 774, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_fo = values[0];
     __pyx_v_writer_schema = values[1];
     __pyx_v_named_schemas = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_skip_data", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 762, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_skip_data", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 774, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read._skip_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_62_skip_data(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas);
+  __pyx_r = __pyx_pf_8fastavro_5_read_64_skip_data(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_62_skip_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas) {
+static PyObject *__pyx_pf_8fastavro_5_read_64_skip_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_skip_data", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 762, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read__skip_data(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 774, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -13112,92 +13343,92 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":799
+/* "fastavro/_read.pyx":811
  * 
  * 
  * cpdef skip_sync(fo, sync_marker):             # <<<<<<<<<<<<<<
  *     """Skip an expected sync marker, complaining if it doesn't match"""
  *     if fo.read(SYNC_SIZE) != sync_marker:
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_65skip_sync(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_67skip_sync(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_skip_sync(PyObject *__pyx_v_fo, PyObject *__pyx_v_sync_marker, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_sync", 0);
 
-  /* "fastavro/_read.pyx":801
+  /* "fastavro/_read.pyx":813
  * cpdef skip_sync(fo, sync_marker):
  *     """Skip an expected sync marker, complaining if it doesn't match"""
  *     if fo.read(SYNC_SIZE) != sync_marker:             # <<<<<<<<<<<<<<
  *         raise ValueError("expected sync marker not found")
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_SYNC_SIZE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_SYNC_SIZE); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 801, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_v_sync_marker, Py_NE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_v_sync_marker, Py_NE); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (unlikely(__pyx_t_5)) {
 
-    /* "fastavro/_read.pyx":802
+    /* "fastavro/_read.pyx":814
  *     """Skip an expected sync marker, complaining if it doesn't match"""
  *     if fo.read(SYNC_SIZE) != sync_marker:
  *         raise ValueError("expected sync marker not found")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 802, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__8, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 814, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __PYX_ERR(0, 802, __pyx_L1_error)
+    __PYX_ERR(0, 814, __pyx_L1_error)
 
-    /* "fastavro/_read.pyx":801
+    /* "fastavro/_read.pyx":813
  * cpdef skip_sync(fo, sync_marker):
  *     """Skip an expected sync marker, complaining if it doesn't match"""
  *     if fo.read(SYNC_SIZE) != sync_marker:             # <<<<<<<<<<<<<<
  *         raise ValueError("expected sync marker not found")
  * 
  */
   }
 
-  /* "fastavro/_read.pyx":799
+  /* "fastavro/_read.pyx":811
  * 
  * 
  * cpdef skip_sync(fo, sync_marker):             # <<<<<<<<<<<<<<
  *     """Skip an expected sync marker, complaining if it doesn't match"""
  *     if fo.read(SYNC_SIZE) != sync_marker:
  */
 
@@ -13214,17 +13445,17 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_65skip_sync(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_8fastavro_5_read_64skip_sync[] = "Skip an expected sync marker, complaining if it doesn't match";
-static PyObject *__pyx_pw_8fastavro_5_read_65skip_sync(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_67skip_sync(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_8fastavro_5_read_66skip_sync[] = "Skip an expected sync marker, complaining if it doesn't match";
+static PyObject *__pyx_pw_8fastavro_5_read_67skip_sync(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_sync_marker = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
@@ -13248,54 +13479,54 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sync_marker)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("skip_sync", 1, 2, 2, 1); __PYX_ERR(0, 799, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("skip_sync", 1, 2, 2, 1); __PYX_ERR(0, 811, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_sync") < 0)) __PYX_ERR(0, 799, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "skip_sync") < 0)) __PYX_ERR(0, 811, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_fo = values[0];
     __pyx_v_sync_marker = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("skip_sync", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 799, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("skip_sync", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 811, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.skip_sync", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_64skip_sync(__pyx_self, __pyx_v_fo, __pyx_v_sync_marker);
+  __pyx_r = __pyx_pf_8fastavro_5_read_66skip_sync(__pyx_self, __pyx_v_fo, __pyx_v_sync_marker);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_64skip_sync(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_sync_marker) {
+static PyObject *__pyx_pf_8fastavro_5_read_66skip_sync(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_sync_marker) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("skip_sync", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_sync(__pyx_v_fo, __pyx_v_sync_marker, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 799, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_sync(__pyx_v_fo, __pyx_v_sync_marker, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 811, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -13304,68 +13535,68 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":805
+/* "fastavro/_read.pyx":817
  * 
  * 
  * cpdef null_read_block(fo):             # <<<<<<<<<<<<<<
  *     """Read block in "null" codec."""
  *     return BytesIO(read_bytes(fo))
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_67null_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_69null_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_null_read_block(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("null_read_block", 0);
 
-  /* "fastavro/_read.pyx":807
+  /* "fastavro/_read.pyx":819
  * cpdef null_read_block(fo):
  *     """Read block in "null" codec."""
  *     return BytesIO(read_bytes(fo))             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 807, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 807, __pyx_L1_error)
+  __pyx_t_3 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 807, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":805
+  /* "fastavro/_read.pyx":817
  * 
  * 
  * cpdef null_read_block(fo):             # <<<<<<<<<<<<<<
  *     """Read block in "null" codec."""
  *     return BytesIO(read_bytes(fo))
  */
 
@@ -13380,37 +13611,37 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_67null_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_66null_read_block[] = "Read block in \"null\" codec.";
-static PyObject *__pyx_pw_8fastavro_5_read_67null_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_69null_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_68null_read_block[] = "Read block in \"null\" codec.";
+static PyObject *__pyx_pw_8fastavro_5_read_69null_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("null_read_block (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_66null_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_68null_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_66null_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_68null_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("null_read_block", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_null_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 805, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_null_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 817, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -13419,23 +13650,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":810
+/* "fastavro/_read.pyx":822
  * 
  * 
  * cpdef deflate_read_block(fo):             # <<<<<<<<<<<<<<
  *     """Read block in "deflate" codec."""
  *     data = read_bytes(fo)
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_69deflate_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_71deflate_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_deflate_read_block(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_v_data = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
@@ -13443,72 +13674,72 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("deflate_read_block", 0);
 
-  /* "fastavro/_read.pyx":812
+  /* "fastavro/_read.pyx":824
  * cpdef deflate_read_block(fo):
  *     """Read block in "deflate" codec."""
  *     data = read_bytes(fo)             # <<<<<<<<<<<<<<
  *     # -15 is the log of the window size; negative indicates "raw" (no
  *     # zlib headers) decompression.  See zlib.h.
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 812, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 824, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_data = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":815
+  /* "fastavro/_read.pyx":827
  *     # -15 is the log of the window size; negative indicates "raw" (no
  *     # zlib headers) decompression.  See zlib.h.
  *     return BytesIO(zlib.decompressobj(-15).decompress(data))             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 815, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 827, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_zlib); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 815, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_zlib); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 827, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_decompressobj); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 815, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_decompressobj); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 827, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_int_neg_15) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_int_neg_15);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 815, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 827, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_decompress); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 815, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_decompress); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 827, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_4, __pyx_v_data) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_data);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 815, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 827, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -13516,22 +13747,22 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 815, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 827, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":810
+  /* "fastavro/_read.pyx":822
  * 
  * 
  * cpdef deflate_read_block(fo):             # <<<<<<<<<<<<<<
  *     """Read block in "deflate" codec."""
  *     data = read_bytes(fo)
  */
 
@@ -13549,37 +13780,37 @@
   __Pyx_XDECREF(__pyx_v_data);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_69deflate_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_68deflate_read_block[] = "Read block in \"deflate\" codec.";
-static PyObject *__pyx_pw_8fastavro_5_read_69deflate_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_71deflate_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_70deflate_read_block[] = "Read block in \"deflate\" codec.";
+static PyObject *__pyx_pw_8fastavro_5_read_71deflate_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("deflate_read_block (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_68deflate_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_70deflate_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_68deflate_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_70deflate_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("deflate_read_block", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_deflate_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_deflate_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 822, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -13588,77 +13819,77 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":818
+/* "fastavro/_read.pyx":830
  * 
  * 
  * cpdef bzip2_read_block(fo):             # <<<<<<<<<<<<<<
  *     """Read block in "bzip2" codec."""
  *     data = read_bytes(fo)
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_71bzip2_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_73bzip2_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_bzip2_read_block(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_v_data = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("bzip2_read_block", 0);
 
-  /* "fastavro/_read.pyx":820
+  /* "fastavro/_read.pyx":832
  * cpdef bzip2_read_block(fo):
  *     """Read block in "bzip2" codec."""
  *     data = read_bytes(fo)             # <<<<<<<<<<<<<<
  *     return BytesIO(bz2.decompress(data))
  * 
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 820, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_bytes(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 832, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_data = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":821
+  /* "fastavro/_read.pyx":833
  *     """Read block in "bzip2" codec."""
  *     data = read_bytes(fo)
  *     return BytesIO(bz2.decompress(data))             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 821, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 833, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_bz2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 821, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_bz2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 833, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_decompress); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 821, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_decompress); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 833, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_v_data) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_data);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 821, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 833, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -13666,22 +13897,22 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 821, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 833, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":818
+  /* "fastavro/_read.pyx":830
  * 
  * 
  * cpdef bzip2_read_block(fo):             # <<<<<<<<<<<<<<
  *     """Read block in "bzip2" codec."""
  *     data = read_bytes(fo)
  */
 
@@ -13698,37 +13929,37 @@
   __Pyx_XDECREF(__pyx_v_data);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_71bzip2_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static char __pyx_doc_8fastavro_5_read_70bzip2_read_block[] = "Read block in \"bzip2\" codec.";
-static PyObject *__pyx_pw_8fastavro_5_read_71bzip2_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_73bzip2_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static char __pyx_doc_8fastavro_5_read_72bzip2_read_block[] = "Read block in \"bzip2\" codec.";
+static PyObject *__pyx_pw_8fastavro_5_read_73bzip2_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("bzip2_read_block (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_70bzip2_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_72bzip2_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_70bzip2_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_72bzip2_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("bzip2_read_block", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_bzip2_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 818, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_bzip2_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 830, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -13737,23 +13968,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":824
+/* "fastavro/_read.pyx":836
  * 
  * 
  * cpdef xz_read_block(fo):             # <<<<<<<<<<<<<<
  *     length = read_long(fo)
  *     data = fo.read(length)
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_73xz_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_75xz_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_xz_read_block(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __pyx_t_8fastavro_5_read_long64 __pyx_v_length;
   PyObject *__pyx_v_data = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
@@ -13762,82 +13993,82 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("xz_read_block", 0);
 
-  /* "fastavro/_read.pyx":825
+  /* "fastavro/_read.pyx":837
  * 
  * cpdef xz_read_block(fo):
  *     length = read_long(fo)             # <<<<<<<<<<<<<<
  *     data = fo.read(length)
  *     return BytesIO(lzma.decompress(data))
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 825, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 837, __pyx_L1_error)
   __pyx_v_length = __pyx_t_1;
 
-  /* "fastavro/_read.pyx":826
+  /* "fastavro/_read.pyx":838
  * cpdef xz_read_block(fo):
  *     length = read_long(fo)
  *     data = fo.read(length)             # <<<<<<<<<<<<<<
  *     return BytesIO(lzma.decompress(data))
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 826, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 826, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 826, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 838, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_data = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":827
+  /* "fastavro/_read.pyx":839
  *     length = read_long(fo)
  *     data = fo.read(length)
  *     return BytesIO(lzma.decompress(data))             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 827, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_lzma); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 827, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_lzma); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_decompress); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 827, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_decompress); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_v_data) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_data);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 827, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -13845,22 +14076,22 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 827, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 839, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":824
+  /* "fastavro/_read.pyx":836
  * 
  * 
  * cpdef xz_read_block(fo):             # <<<<<<<<<<<<<<
  *     length = read_long(fo)
  *     data = fo.read(length)
  */
 
@@ -13877,36 +14108,36 @@
   __Pyx_XDECREF(__pyx_v_data);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_73xz_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_73xz_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_75xz_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_75xz_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("xz_read_block (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_72xz_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_74xz_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_72xz_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_74xz_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("xz_read_block", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_xz_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 824, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_xz_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -13915,23 +14146,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":838
+/* "fastavro/_read.pyx":850
  * 
  * 
  * cpdef snappy_read_block(fo):             # <<<<<<<<<<<<<<
  *     length = read_long(fo)
  *     data = fo.read(length - 4)
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_75snappy_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_77snappy_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_snappy_read_block(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_v_length = NULL;
   PyObject *__pyx_v_data = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
@@ -13940,111 +14171,111 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("snappy_read_block", 0);
 
-  /* "fastavro/_read.pyx":839
+  /* "fastavro/_read.pyx":851
  * 
  * cpdef snappy_read_block(fo):
  *     length = read_long(fo)             # <<<<<<<<<<<<<<
  *     data = fo.read(length - 4)
  *     fo.read(4)  # CRC
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 839, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 839, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_v_length = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":840
+  /* "fastavro/_read.pyx":852
  * cpdef snappy_read_block(fo):
  *     length = read_long(fo)
  *     data = fo.read(length - 4)             # <<<<<<<<<<<<<<
  *     fo.read(4)  # CRC
  *     return BytesIO(snappy.decompress(data))
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 840, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_v_length, __pyx_int_4, 4, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 840, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_v_length, __pyx_int_4, 4, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 840, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 852, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_data = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":841
+  /* "fastavro/_read.pyx":853
  *     length = read_long(fo)
  *     data = fo.read(length - 4)
  *     fo.read(4)  # CRC             # <<<<<<<<<<<<<<
  *     return BytesIO(snappy.decompress(data))
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 841, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_int_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_int_4);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 841, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 853, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":842
+  /* "fastavro/_read.pyx":854
  *     data = fo.read(length - 4)
  *     fo.read(4)  # CRC
  *     return BytesIO(snappy.decompress(data))             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 854, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_snappy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_snappy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 854, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_decompress); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_decompress); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 854, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_v_data) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_data);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 842, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 854, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -14052,22 +14283,22 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 854, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":838
+  /* "fastavro/_read.pyx":850
  * 
  * 
  * cpdef snappy_read_block(fo):             # <<<<<<<<<<<<<<
  *     length = read_long(fo)
  *     data = fo.read(length - 4)
  */
 
@@ -14085,36 +14316,36 @@
   __Pyx_XDECREF(__pyx_v_data);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_75snappy_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_75snappy_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_77snappy_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_77snappy_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("snappy_read_block (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_74snappy_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_76snappy_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_74snappy_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_76snappy_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("snappy_read_block", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_snappy_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_snappy_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -14123,23 +14354,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":853
+/* "fastavro/_read.pyx":865
  * 
  * 
  * cpdef zstandard_read_block(fo):             # <<<<<<<<<<<<<<
  *     length = read_long(fo)
  *     data = fo.read(length)
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_77zstandard_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_79zstandard_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_zstandard_read_block(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __pyx_t_8fastavro_5_read_long64 __pyx_v_length;
   PyObject *__pyx_v_data = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
@@ -14150,118 +14381,118 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("zstandard_read_block", 0);
 
-  /* "fastavro/_read.pyx":854
+  /* "fastavro/_read.pyx":866
  * 
  * cpdef zstandard_read_block(fo):
  *     length = read_long(fo)             # <<<<<<<<<<<<<<
  *     data = fo.read(length)
  *     return BytesIO(zstd.ZstdDecompressor().decompressobj().decompress(data))
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 854, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 866, __pyx_L1_error)
   __pyx_v_length = __pyx_t_1;
 
-  /* "fastavro/_read.pyx":855
+  /* "fastavro/_read.pyx":867
  * cpdef zstandard_read_block(fo):
  *     length = read_long(fo)
  *     data = fo.read(length)             # <<<<<<<<<<<<<<
  *     return BytesIO(zstd.ZstdDecompressor().decompressobj().decompress(data))
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 867, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 855, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 867, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 855, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 867, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_data = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":856
+  /* "fastavro/_read.pyx":868
  *     length = read_long(fo)
  *     data = fo.read(length)
  *     return BytesIO(zstd.ZstdDecompressor().decompressobj().decompress(data))             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 856, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_zstd); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 856, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_zstd); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_ZstdDecompressor); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 856, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_ZstdDecompressor); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_7 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_8);
     if (likely(__pyx_t_7)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
       __Pyx_INCREF(__pyx_t_7);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_8, function);
     }
   }
   __pyx_t_6 = (__pyx_t_7) ? __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_7) : __Pyx_PyObject_CallNoArg(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 856, __pyx_L1_error)
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_decompressobj); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 856, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_decompressobj); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_8);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_8, function);
     }
   }
   __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 856, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_decompress); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 856, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_decompress); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_8);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_8, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_5, __pyx_v_data) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_data);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 856, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __pyx_t_8 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_8)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -14269,22 +14500,22 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_8, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 856, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":853
+  /* "fastavro/_read.pyx":865
  * 
  * 
  * cpdef zstandard_read_block(fo):             # <<<<<<<<<<<<<<
  *     length = read_long(fo)
  *     data = fo.read(length)
  */
 
@@ -14303,36 +14534,36 @@
   __Pyx_XDECREF(__pyx_v_data);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_77zstandard_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_77zstandard_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_79zstandard_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_79zstandard_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("zstandard_read_block (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_76zstandard_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_78zstandard_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_76zstandard_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_78zstandard_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("zstandard_read_block", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_zstandard_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 853, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_zstandard_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 865, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -14341,23 +14572,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":867
+/* "fastavro/_read.pyx":879
  * 
  * 
  * cpdef lz4_read_block(fo):             # <<<<<<<<<<<<<<
  *     length = read_long(fo)
  *     data = fo.read(length)
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_79lz4_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_81lz4_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_lz4_read_block(PyObject *__pyx_v_fo, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __pyx_t_8fastavro_5_read_long64 __pyx_v_length;
   PyObject *__pyx_v_data = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __pyx_t_8fastavro_5_read_long64 __pyx_t_1;
   PyObject *__pyx_t_2 = NULL;
@@ -14366,85 +14597,85 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("lz4_read_block", 0);
 
-  /* "fastavro/_read.pyx":868
+  /* "fastavro/_read.pyx":880
  * 
  * cpdef lz4_read_block(fo):
  *     length = read_long(fo)             # <<<<<<<<<<<<<<
  *     data = fo.read(length)
  *     return BytesIO(lz4.block.decompress(data))
  */
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 868, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_read_long(__pyx_v_fo, 0); if (unlikely(__pyx_t_1 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 880, __pyx_L1_error)
   __pyx_v_length = __pyx_t_1;
 
-  /* "fastavro/_read.pyx":869
+  /* "fastavro/_read.pyx":881
  * cpdef lz4_read_block(fo):
  *     length = read_long(fo)
  *     data = fo.read(length)             # <<<<<<<<<<<<<<
  *     return BytesIO(lz4.block.decompress(data))
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 869, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fo, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 881, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 869, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_v_length); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 881, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 869, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 881, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_data = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":870
+  /* "fastavro/_read.pyx":882
  *     length = read_long(fo)
  *     data = fo.read(length)
  *     return BytesIO(lz4.block.decompress(data))             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 870, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BytesIO); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_lz4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 870, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_lz4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_block); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 870, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_block); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_decompress); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 870, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_decompress); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_4 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_v_data) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_data);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 870, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -14452,22 +14683,22 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 870, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":867
+  /* "fastavro/_read.pyx":879
  * 
  * 
  * cpdef lz4_read_block(fo):             # <<<<<<<<<<<<<<
  *     length = read_long(fo)
  *     data = fo.read(length)
  */
 
@@ -14484,36 +14715,36 @@
   __Pyx_XDECREF(__pyx_v_data);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_79lz4_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_79lz4_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pw_8fastavro_5_read_81lz4_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_81lz4_read_block(PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("lz4_read_block (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_78lz4_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
+  __pyx_r = __pyx_pf_8fastavro_5_read_80lz4_read_block(__pyx_self, ((PyObject *)__pyx_v_fo));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_78lz4_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
+static PyObject *__pyx_pf_8fastavro_5_read_80lz4_read_block(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("lz4_read_block", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_lz4_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 867, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_lz4_read_block(__pyx_v_fo, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 879, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -14521,28 +14752,28 @@
   __Pyx_AddTraceback("fastavro._read.lz4_read_block", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-static PyObject *__pyx_gb_8fastavro_5_read_82generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+static PyObject *__pyx_gb_8fastavro_5_read_84generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "fastavro/_read.pyx":881
+/* "fastavro/_read.pyx":893
  * 
  * 
  * def _iter_avro_records(             # <<<<<<<<<<<<<<
  *     fo,
  *     header,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_81_iter_avro_records(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_8fastavro_5_read_81_iter_avro_records = {"_iter_avro_records", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_81_iter_avro_records, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_8fastavro_5_read_81_iter_avro_records(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_83_iter_avro_records(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_8fastavro_5_read_83_iter_avro_records = {"_iter_avro_records", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_83_iter_avro_records, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_8fastavro_5_read_83_iter_avro_records(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_header = 0;
   PyObject *__pyx_v_codec = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   PyObject *__pyx_v_reader_schema = 0;
   PyObject *__pyx_v_options = 0;
@@ -14581,49 +14812,49 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_header)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 1); __PYX_ERR(0, 881, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 1); __PYX_ERR(0, 893, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_codec)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 2); __PYX_ERR(0, 881, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 2); __PYX_ERR(0, 893, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 3); __PYX_ERR(0, 881, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 3); __PYX_ERR(0, 893, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 4); __PYX_ERR(0, 881, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 4); __PYX_ERR(0, 893, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 5); __PYX_ERR(0, 881, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 5); __PYX_ERR(0, 893, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_options)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 6); __PYX_ERR(0, 881, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, 6); __PYX_ERR(0, 893, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_iter_avro_records") < 0)) __PYX_ERR(0, 881, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_iter_avro_records") < 0)) __PYX_ERR(0, 893, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -14638,40 +14869,40 @@
     __pyx_v_writer_schema = values[3];
     __pyx_v_named_schemas = values[4];
     __pyx_v_reader_schema = values[5];
     __pyx_v_options = values[6];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 881, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_iter_avro_records", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 893, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read._iter_avro_records", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_80_iter_avro_records(__pyx_self, __pyx_v_fo, __pyx_v_header, __pyx_v_codec, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
+  __pyx_r = __pyx_pf_8fastavro_5_read_82_iter_avro_records(__pyx_self, __pyx_v_fo, __pyx_v_header, __pyx_v_codec, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_80_iter_avro_records(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_header, PyObject *__pyx_v_codec, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
+static PyObject *__pyx_pf_8fastavro_5_read_82_iter_avro_records(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_header, PyObject *__pyx_v_codec, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
   struct __pyx_obj_8fastavro_5_read___pyx_scope_struct___iter_avro_records *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_iter_avro_records", 0);
   __pyx_cur_scope = (struct __pyx_obj_8fastavro_5_read___pyx_scope_struct___iter_avro_records *)__pyx_tp_new_8fastavro_5_read___pyx_scope_struct___iter_avro_records(__pyx_ptype_8fastavro_5_read___pyx_scope_struct___iter_avro_records, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_8fastavro_5_read___pyx_scope_struct___iter_avro_records *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 881, __pyx_L1_error)
+    __PYX_ERR(0, 893, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_fo = __pyx_v_fo;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_fo);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_fo);
   __pyx_cur_scope->__pyx_v_header = __pyx_v_header;
@@ -14689,15 +14920,15 @@
   __pyx_cur_scope->__pyx_v_reader_schema = __pyx_v_reader_schema;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_reader_schema);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_reader_schema);
   __pyx_cur_scope->__pyx_v_options = __pyx_v_options;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_options);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_options);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_8fastavro_5_read_82generator, __pyx_codeobj__9, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter_avro_records, __pyx_n_s_iter_avro_records, __pyx_n_s_fastavro__read); if (unlikely(!gen)) __PYX_ERR(0, 881, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_8fastavro_5_read_84generator, __pyx_codeobj__9, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter_avro_records, __pyx_n_s_iter_avro_records, __pyx_n_s_fastavro__read); if (unlikely(!gen)) __PYX_ERR(0, 893, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -14705,15 +14936,15 @@
   __pyx_r = NULL;
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_gb_8fastavro_5_read_82generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+static PyObject *__pyx_gb_8fastavro_5_read_84generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
   struct __pyx_obj_8fastavro_5_read___pyx_scope_struct___iter_avro_records *__pyx_cur_scope = ((struct __pyx_obj_8fastavro_5_read___pyx_scope_struct___iter_avro_records *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
@@ -14731,128 +14962,128 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L9_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 881, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 893, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":892
+  /* "fastavro/_read.pyx":904
  *     cdef int32 i
  * 
  *     sync_marker = header["sync"]             # <<<<<<<<<<<<<<
  * 
  *     read_block = BLOCK_READERS.get(codec)
  */
-  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_cur_scope->__pyx_v_header, __pyx_n_u_sync); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_cur_scope->__pyx_v_header, __pyx_n_u_sync); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 904, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_sync_marker = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":894
+  /* "fastavro/_read.pyx":906
  *     sync_marker = header["sync"]
  * 
  *     read_block = BLOCK_READERS.get(codec)             # <<<<<<<<<<<<<<
  *     if not read_block:
  *         raise ValueError(f"Unrecognized codec: {codec}")
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 894, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 906, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_get); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 894, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_get); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 906, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_cur_scope->__pyx_v_codec) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_cur_scope->__pyx_v_codec);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 894, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 906, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_read_block = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":895
+  /* "fastavro/_read.pyx":907
  * 
  *     read_block = BLOCK_READERS.get(codec)
  *     if not read_block:             # <<<<<<<<<<<<<<
  *         raise ValueError(f"Unrecognized codec: {codec}")
  * 
  */
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_read_block); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_read_block); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 907, __pyx_L1_error)
   __pyx_t_5 = ((!__pyx_t_4) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "fastavro/_read.pyx":896
+    /* "fastavro/_read.pyx":908
  *     read_block = BLOCK_READERS.get(codec)
  *     if not read_block:
  *         raise ValueError(f"Unrecognized codec: {codec}")             # <<<<<<<<<<<<<<
  * 
  *     block_count = 0
  */
-    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_cur_scope->__pyx_v_codec, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 896, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_cur_scope->__pyx_v_codec, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 908, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Unrecognized_codec, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 896, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Unrecognized_codec, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 896, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 908, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 896, __pyx_L1_error)
+    __PYX_ERR(0, 908, __pyx_L1_error)
 
-    /* "fastavro/_read.pyx":895
+    /* "fastavro/_read.pyx":907
  * 
  *     read_block = BLOCK_READERS.get(codec)
  *     if not read_block:             # <<<<<<<<<<<<<<
  *         raise ValueError(f"Unrecognized codec: {codec}")
  * 
  */
   }
 
-  /* "fastavro/_read.pyx":898
+  /* "fastavro/_read.pyx":910
  *         raise ValueError(f"Unrecognized codec: {codec}")
  * 
  *     block_count = 0             # <<<<<<<<<<<<<<
  *     while True:
  *         block_count = read_long(fo)
  */
   __pyx_cur_scope->__pyx_v_block_count = 0;
 
-  /* "fastavro/_read.pyx":899
+  /* "fastavro/_read.pyx":911
  * 
  *     block_count = 0
  *     while True:             # <<<<<<<<<<<<<<
  *         block_count = read_long(fo)
  *         block_fo = read_block(fo)
  */
   while (1) {
 
-    /* "fastavro/_read.pyx":900
+    /* "fastavro/_read.pyx":912
  *     block_count = 0
  *     while True:
  *         block_count = read_long(fo)             # <<<<<<<<<<<<<<
  *         block_fo = read_block(fo)
  * 
  */
-    __pyx_t_6 = __pyx_f_8fastavro_5_read_read_long(__pyx_cur_scope->__pyx_v_fo, 0); if (unlikely(__pyx_t_6 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 900, __pyx_L1_error)
+    __pyx_t_6 = __pyx_f_8fastavro_5_read_read_long(__pyx_cur_scope->__pyx_v_fo, 0); if (unlikely(__pyx_t_6 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 912, __pyx_L1_error)
     __pyx_cur_scope->__pyx_v_block_count = __pyx_t_6;
 
-    /* "fastavro/_read.pyx":901
+    /* "fastavro/_read.pyx":913
  *     while True:
  *         block_count = read_long(fo)
  *         block_fo = read_block(fo)             # <<<<<<<<<<<<<<
  * 
  *         for i in range(block_count):
  */
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_read_block);
@@ -14864,45 +15095,45 @@
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_cur_scope->__pyx_v_fo) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_cur_scope->__pyx_v_fo);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 901, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 913, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_block_fo);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_block_fo, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":903
+    /* "fastavro/_read.pyx":915
  *         block_fo = read_block(fo)
  * 
  *         for i in range(block_count):             # <<<<<<<<<<<<<<
  *             yield _read_data(
  *                 block_fo,
  */
     __pyx_t_6 = __pyx_cur_scope->__pyx_v_block_count;
     __pyx_t_7 = __pyx_t_6;
     for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
       __pyx_cur_scope->__pyx_v_i = __pyx_t_8;
 
-      /* "fastavro/_read.pyx":904
+      /* "fastavro/_read.pyx":916
  * 
  *         for i in range(block_count):
  *             yield _read_data(             # <<<<<<<<<<<<<<
  *                 block_fo,
  *                 writer_schema,
  */
       __pyx_t_9.__pyx_n = 2;
       __pyx_t_9.reader_schema = __pyx_cur_scope->__pyx_v_reader_schema;
       __pyx_t_9.options = __pyx_cur_scope->__pyx_v_options;
-      __pyx_t_1 = __pyx_f_8fastavro_5_read__read_data(__pyx_cur_scope->__pyx_v_block_fo, __pyx_cur_scope->__pyx_v_writer_schema, __pyx_cur_scope->__pyx_v_named_schemas, 0, &__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 904, __pyx_L1_error)
+      __pyx_t_1 = __pyx_f_8fastavro_5_read__read_data(__pyx_cur_scope->__pyx_v_block_fo, __pyx_cur_scope->__pyx_v_writer_schema, __pyx_cur_scope->__pyx_v_named_schemas, 0, &__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 916, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_r = __pyx_t_1;
       __pyx_t_1 = 0;
       __pyx_cur_scope->__pyx_t_0 = __pyx_t_6;
       __pyx_cur_scope->__pyx_t_1 = __pyx_t_7;
       __pyx_cur_scope->__pyx_t_2 = __pyx_t_8;
       __Pyx_XGIVEREF(__pyx_r);
@@ -14911,31 +15142,31 @@
       /* return from generator, yielding value */
       __pyx_generator->resume_label = 1;
       return __pyx_r;
       __pyx_L9_resume_from_yield:;
       __pyx_t_6 = __pyx_cur_scope->__pyx_t_0;
       __pyx_t_7 = __pyx_cur_scope->__pyx_t_1;
       __pyx_t_8 = __pyx_cur_scope->__pyx_t_2;
-      if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 904, __pyx_L1_error)
+      if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 916, __pyx_L1_error)
     }
 
-    /* "fastavro/_read.pyx":912
+    /* "fastavro/_read.pyx":924
  *             )
  * 
  *         skip_sync(fo, sync_marker)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_sync(__pyx_cur_scope->__pyx_v_fo, __pyx_cur_scope->__pyx_v_sync_marker, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 912, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_8fastavro_5_read_skip_sync(__pyx_cur_scope->__pyx_v_fo, __pyx_cur_scope->__pyx_v_sync_marker, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 924, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "fastavro/_read.pyx":881
+  /* "fastavro/_read.pyx":893
  * 
  * 
  * def _iter_avro_records(             # <<<<<<<<<<<<<<
  *     fo,
  *     header,
  */
 
@@ -14953,28 +15184,28 @@
   __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-static PyObject *__pyx_gb_8fastavro_5_read_85generator1(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
+static PyObject *__pyx_gb_8fastavro_5_read_87generator1(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "fastavro/_read.pyx":915
+/* "fastavro/_read.pyx":927
  * 
  * 
  * def _iter_avro_blocks(             # <<<<<<<<<<<<<<
  *     fo,
  *     header,
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_84_iter_avro_blocks(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_8fastavro_5_read_84_iter_avro_blocks = {"_iter_avro_blocks", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_84_iter_avro_blocks, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_8fastavro_5_read_84_iter_avro_blocks(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_86_iter_avro_blocks(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_8fastavro_5_read_86_iter_avro_blocks = {"_iter_avro_blocks", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_86_iter_avro_blocks, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_8fastavro_5_read_86_iter_avro_blocks(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_header = 0;
   PyObject *__pyx_v_codec = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_named_schemas = 0;
   PyObject *__pyx_v_reader_schema = 0;
   PyObject *__pyx_v_options = 0;
@@ -15013,49 +15244,49 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_header)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 1); __PYX_ERR(0, 915, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 1); __PYX_ERR(0, 927, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_codec)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 2); __PYX_ERR(0, 915, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 2); __PYX_ERR(0, 927, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 3); __PYX_ERR(0, 915, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 3); __PYX_ERR(0, 927, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 4); __PYX_ERR(0, 915, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 4); __PYX_ERR(0, 927, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 5); __PYX_ERR(0, 915, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 5); __PYX_ERR(0, 927, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_options)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 6); __PYX_ERR(0, 915, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, 6); __PYX_ERR(0, 927, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_iter_avro_blocks") < 0)) __PYX_ERR(0, 915, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_iter_avro_blocks") < 0)) __PYX_ERR(0, 927, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -15070,40 +15301,40 @@
     __pyx_v_writer_schema = values[3];
     __pyx_v_named_schemas = values[4];
     __pyx_v_reader_schema = values[5];
     __pyx_v_options = values[6];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 915, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_iter_avro_blocks", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 927, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read._iter_avro_blocks", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_83_iter_avro_blocks(__pyx_self, __pyx_v_fo, __pyx_v_header, __pyx_v_codec, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
+  __pyx_r = __pyx_pf_8fastavro_5_read_85_iter_avro_blocks(__pyx_self, __pyx_v_fo, __pyx_v_header, __pyx_v_codec, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_reader_schema, __pyx_v_options);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_83_iter_avro_blocks(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_header, PyObject *__pyx_v_codec, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
+static PyObject *__pyx_pf_8fastavro_5_read_85_iter_avro_blocks(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_header, PyObject *__pyx_v_codec, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_named_schemas, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_options) {
   struct __pyx_obj_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks *__pyx_cur_scope;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_iter_avro_blocks", 0);
   __pyx_cur_scope = (struct __pyx_obj_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks *)__pyx_tp_new_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks(__pyx_ptype_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 915, __pyx_L1_error)
+    __PYX_ERR(0, 927, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_fo = __pyx_v_fo;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_fo);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_fo);
   __pyx_cur_scope->__pyx_v_header = __pyx_v_header;
@@ -15121,15 +15352,15 @@
   __pyx_cur_scope->__pyx_v_reader_schema = __pyx_v_reader_schema;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_reader_schema);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_reader_schema);
   __pyx_cur_scope->__pyx_v_options = __pyx_v_options;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_options);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_options);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_8fastavro_5_read_85generator1, __pyx_codeobj__10, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter_avro_blocks, __pyx_n_s_iter_avro_blocks, __pyx_n_s_fastavro__read); if (unlikely(!gen)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_8fastavro_5_read_87generator1, __pyx_codeobj__10, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter_avro_blocks, __pyx_n_s_iter_avro_blocks, __pyx_n_s_fastavro__read); if (unlikely(!gen)) __PYX_ERR(0, 927, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -15137,15 +15368,15 @@
   __pyx_r = NULL;
   __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_gb_8fastavro_5_read_85generator1(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
+static PyObject *__pyx_gb_8fastavro_5_read_87generator1(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
 {
   struct __pyx_obj_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks *__pyx_cur_scope = ((struct __pyx_obj_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks *)__pyx_generator->closure);
   PyObject *__pyx_r = NULL;
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_t_4;
@@ -15166,162 +15397,162 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L17_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 915, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 927, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":924
+  /* "fastavro/_read.pyx":936
  *     options,
  * ):
  *     sync_marker = header["sync"]             # <<<<<<<<<<<<<<
  * 
  *     read_block = BLOCK_READERS.get(codec)
  */
-  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_cur_scope->__pyx_v_header, __pyx_n_u_sync); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 924, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_cur_scope->__pyx_v_header, __pyx_n_u_sync); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 936, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_sync_marker = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":926
+  /* "fastavro/_read.pyx":938
  *     sync_marker = header["sync"]
  * 
  *     read_block = BLOCK_READERS.get(codec)             # <<<<<<<<<<<<<<
  *     if not read_block:
  *         raise ValueError(f"Unrecognized codec: {codec}")
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 926, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 938, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_get); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 926, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_get); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 938, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_cur_scope->__pyx_v_codec) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_cur_scope->__pyx_v_codec);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __pyx_cur_scope->__pyx_v_read_block = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":927
+  /* "fastavro/_read.pyx":939
  * 
  *     read_block = BLOCK_READERS.get(codec)
  *     if not read_block:             # <<<<<<<<<<<<<<
  *         raise ValueError(f"Unrecognized codec: {codec}")
  * 
  */
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_read_block); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 927, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_cur_scope->__pyx_v_read_block); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 939, __pyx_L1_error)
   __pyx_t_5 = ((!__pyx_t_4) != 0);
   if (unlikely(__pyx_t_5)) {
 
-    /* "fastavro/_read.pyx":928
+    /* "fastavro/_read.pyx":940
  *     read_block = BLOCK_READERS.get(codec)
  *     if not read_block:
  *         raise ValueError(f"Unrecognized codec: {codec}")             # <<<<<<<<<<<<<<
  * 
  *     while True:
  */
-    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_cur_scope->__pyx_v_codec, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 928, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_FormatSimple(__pyx_cur_scope->__pyx_v_codec, __pyx_empty_unicode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 940, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Unrecognized_codec, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 928, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyUnicode_Concat(__pyx_kp_u_Unrecognized_codec, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 940, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 928, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_ValueError, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 940, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_Raise(__pyx_t_1, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __PYX_ERR(0, 928, __pyx_L1_error)
+    __PYX_ERR(0, 940, __pyx_L1_error)
 
-    /* "fastavro/_read.pyx":927
+    /* "fastavro/_read.pyx":939
  * 
  *     read_block = BLOCK_READERS.get(codec)
  *     if not read_block:             # <<<<<<<<<<<<<<
  *         raise ValueError(f"Unrecognized codec: {codec}")
  * 
  */
   }
 
-  /* "fastavro/_read.pyx":930
+  /* "fastavro/_read.pyx":942
  *         raise ValueError(f"Unrecognized codec: {codec}")
  * 
  *     while True:             # <<<<<<<<<<<<<<
  *         offset = fo.tell()
  *         try:
  */
   while (1) {
 
-    /* "fastavro/_read.pyx":931
+    /* "fastavro/_read.pyx":943
  * 
  *     while True:
  *         offset = fo.tell()             # <<<<<<<<<<<<<<
  *         try:
  *             num_block_records = read_long(fo)
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_fo, __pyx_n_s_tell); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 931, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_fo, __pyx_n_s_tell); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 943, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 931, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_offset);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_offset, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":932
+    /* "fastavro/_read.pyx":944
  *     while True:
  *         offset = fo.tell()
  *         try:             # <<<<<<<<<<<<<<
  *             num_block_records = read_long(fo)
  *         except StopIteration:
  */
     {
       __Pyx_ExceptionSave(&__pyx_t_6, &__pyx_t_7, &__pyx_t_8);
       __Pyx_XGOTREF(__pyx_t_6);
       __Pyx_XGOTREF(__pyx_t_7);
       __Pyx_XGOTREF(__pyx_t_8);
       /*try:*/ {
 
-        /* "fastavro/_read.pyx":933
+        /* "fastavro/_read.pyx":945
  *         offset = fo.tell()
  *         try:
  *             num_block_records = read_long(fo)             # <<<<<<<<<<<<<<
  *         except StopIteration:
  *             return
  */
-        __pyx_t_9 = __pyx_f_8fastavro_5_read_read_long(__pyx_cur_scope->__pyx_v_fo, 0); if (unlikely(__pyx_t_9 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 933, __pyx_L7_error)
+        __pyx_t_9 = __pyx_f_8fastavro_5_read_read_long(__pyx_cur_scope->__pyx_v_fo, 0); if (unlikely(__pyx_t_9 == ((__pyx_t_8fastavro_5_read_long64)-1LL) && PyErr_Occurred())) __PYX_ERR(0, 945, __pyx_L7_error)
         __pyx_cur_scope->__pyx_v_num_block_records = __pyx_t_9;
 
-        /* "fastavro/_read.pyx":932
+        /* "fastavro/_read.pyx":944
  *     while True:
  *         offset = fo.tell()
  *         try:             # <<<<<<<<<<<<<<
  *             num_block_records = read_long(fo)
  *         except StopIteration:
  */
       }
@@ -15330,30 +15561,30 @@
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       goto __pyx_L14_try_end;
       __pyx_L7_error:;
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "fastavro/_read.pyx":934
+      /* "fastavro/_read.pyx":946
  *         try:
  *             num_block_records = read_long(fo)
  *         except StopIteration:             # <<<<<<<<<<<<<<
  *             return
  * 
  */
       __pyx_t_10 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_StopIteration);
       if (__pyx_t_10) {
         __Pyx_AddTraceback("fastavro._read._iter_avro_blocks", __pyx_clineno, __pyx_lineno, __pyx_filename);
-        if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_2) < 0) __PYX_ERR(0, 934, __pyx_L9_except_error)
+        if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_3, &__pyx_t_2) < 0) __PYX_ERR(0, 946, __pyx_L9_except_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_GOTREF(__pyx_t_2);
 
-        /* "fastavro/_read.pyx":935
+        /* "fastavro/_read.pyx":947
  *             num_block_records = read_long(fo)
  *         except StopIteration:
  *             return             # <<<<<<<<<<<<<<
  * 
  *         block_bytes = read_block(fo)
  */
         __Pyx_XDECREF(__pyx_r);
@@ -15362,15 +15593,15 @@
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         goto __pyx_L10_except_return;
       }
       goto __pyx_L9_except_error;
       __pyx_L9_except_error:;
 
-      /* "fastavro/_read.pyx":932
+      /* "fastavro/_read.pyx":944
  *     while True:
  *         offset = fo.tell()
  *         try:             # <<<<<<<<<<<<<<
  *             num_block_records = read_long(fo)
  *         except StopIteration:
  */
       __Pyx_XGIVEREF(__pyx_t_6);
@@ -15383,15 +15614,15 @@
       __Pyx_XGIVEREF(__pyx_t_7);
       __Pyx_XGIVEREF(__pyx_t_8);
       __Pyx_ExceptionReset(__pyx_t_6, __pyx_t_7, __pyx_t_8);
       goto __pyx_L0;
       __pyx_L14_try_end:;
     }
 
-    /* "fastavro/_read.pyx":937
+    /* "fastavro/_read.pyx":949
  *             return
  * 
  *         block_bytes = read_block(fo)             # <<<<<<<<<<<<<<
  * 
  *         skip_sync(fo, sync_marker)
  */
     __Pyx_INCREF(__pyx_cur_scope->__pyx_v_read_block);
@@ -15403,86 +15634,86 @@
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_cur_scope->__pyx_v_fo) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_cur_scope->__pyx_v_fo);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 949, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_block_bytes);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_block_bytes, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "fastavro/_read.pyx":939
+    /* "fastavro/_read.pyx":951
  *         block_bytes = read_block(fo)
  * 
  *         skip_sync(fo, sync_marker)             # <<<<<<<<<<<<<<
  * 
  *         size = fo.tell() - offset
  */
-    __pyx_t_2 = __pyx_f_8fastavro_5_read_skip_sync(__pyx_cur_scope->__pyx_v_fo, __pyx_cur_scope->__pyx_v_sync_marker, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 939, __pyx_L1_error)
+    __pyx_t_2 = __pyx_f_8fastavro_5_read_skip_sync(__pyx_cur_scope->__pyx_v_fo, __pyx_cur_scope->__pyx_v_sync_marker, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 951, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "fastavro/_read.pyx":941
+    /* "fastavro/_read.pyx":953
  *         skip_sync(fo, sync_marker)
  * 
  *         size = fo.tell() - offset             # <<<<<<<<<<<<<<
  * 
  *         yield Block(
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_fo, __pyx_n_s_tell); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 941, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_fo, __pyx_n_s_tell); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 953, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 941, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 953, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Subtract(__pyx_t_2, __pyx_cur_scope->__pyx_v_offset); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 941, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Subtract(__pyx_t_2, __pyx_cur_scope->__pyx_v_offset); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 953, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_size);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_size, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "fastavro/_read.pyx":943
+    /* "fastavro/_read.pyx":955
  *         size = fo.tell() - offset
  * 
  *         yield Block(             # <<<<<<<<<<<<<<
  *             block_bytes, num_block_records, codec, reader_schema,
  *             writer_schema, named_schemas, offset, size, options,
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_Block); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 943, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_Block); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
 
-    /* "fastavro/_read.pyx":944
+    /* "fastavro/_read.pyx":956
  * 
  *         yield Block(
  *             block_bytes, num_block_records, codec, reader_schema,             # <<<<<<<<<<<<<<
  *             writer_schema, named_schemas, offset, size, options,
  *         )
  */
-    __pyx_t_1 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_cur_scope->__pyx_v_num_block_records); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 944, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_PY_LONG_LONG(__pyx_cur_scope->__pyx_v_num_block_records); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 956, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
 
-    /* "fastavro/_read.pyx":945
+    /* "fastavro/_read.pyx":957
  *         yield Block(
  *             block_bytes, num_block_records, codec, reader_schema,
  *             writer_schema, named_schemas, offset, size, options,             # <<<<<<<<<<<<<<
  *         )
  * 
  */
     __pyx_t_11 = NULL;
@@ -15496,31 +15727,31 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_10 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[10] = {__pyx_t_11, __pyx_cur_scope->__pyx_v_block_bytes, __pyx_t_1, __pyx_cur_scope->__pyx_v_codec, __pyx_cur_scope->__pyx_v_reader_schema, __pyx_cur_scope->__pyx_v_writer_schema, __pyx_cur_scope->__pyx_v_named_schemas, __pyx_cur_scope->__pyx_v_offset, __pyx_cur_scope->__pyx_v_size, __pyx_cur_scope->__pyx_v_options};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 9+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 943, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 9+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[10] = {__pyx_t_11, __pyx_cur_scope->__pyx_v_block_bytes, __pyx_t_1, __pyx_cur_scope->__pyx_v_codec, __pyx_cur_scope->__pyx_v_reader_schema, __pyx_cur_scope->__pyx_v_writer_schema, __pyx_cur_scope->__pyx_v_named_schemas, __pyx_cur_scope->__pyx_v_offset, __pyx_cur_scope->__pyx_v_size, __pyx_cur_scope->__pyx_v_options};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 9+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 943, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 9+__pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     {
-      __pyx_t_12 = PyTuple_New(9+__pyx_t_10); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 943, __pyx_L1_error)
+      __pyx_t_12 = PyTuple_New(9+__pyx_t_10); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 955, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       if (__pyx_t_11) {
         __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
       }
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_block_bytes);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_block_bytes);
       PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_10, __pyx_cur_scope->__pyx_v_block_bytes);
@@ -15544,33 +15775,33 @@
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_size);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_size);
       PyTuple_SET_ITEM(__pyx_t_12, 7+__pyx_t_10, __pyx_cur_scope->__pyx_v_size);
       __Pyx_INCREF(__pyx_cur_scope->__pyx_v_options);
       __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_options);
       PyTuple_SET_ITEM(__pyx_t_12, 8+__pyx_t_10, __pyx_cur_scope->__pyx_v_options);
       __pyx_t_1 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 943, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     __Pyx_XGIVEREF(__pyx_r);
     __Pyx_RefNannyFinishContext();
     __Pyx_Coroutine_ResetAndClearException(__pyx_generator);
     /* return from generator, yielding value */
     __pyx_generator->resume_label = 1;
     return __pyx_r;
     __pyx_L17_resume_from_yield:;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 943, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 955, __pyx_L1_error)
   }
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "fastavro/_read.pyx":915
+  /* "fastavro/_read.pyx":927
  * 
  * 
  * def _iter_avro_blocks(             # <<<<<<<<<<<<<<
  *     fo,
  *     header,
  */
 
@@ -15591,15 +15822,15 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":950
+/* "fastavro/_read.pyx":962
  * 
  * class Block:
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         bytes_,
  */
 
@@ -15658,67 +15889,67 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_bytes_2)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 1); __PYX_ERR(0, 950, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 1); __PYX_ERR(0, 962, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_records)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 2); __PYX_ERR(0, 950, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 2); __PYX_ERR(0, 962, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_codec)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 3); __PYX_ERR(0, 950, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 3); __PYX_ERR(0, 962, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 4); __PYX_ERR(0, 950, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 4); __PYX_ERR(0, 962, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 5); __PYX_ERR(0, 950, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 5); __PYX_ERR(0, 962, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_named_schemas)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 6); __PYX_ERR(0, 950, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 6); __PYX_ERR(0, 962, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_offset)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 7); __PYX_ERR(0, 950, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 7); __PYX_ERR(0, 962, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_size)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 8); __PYX_ERR(0, 950, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 8); __PYX_ERR(0, 962, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  9:
         if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_options)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 9); __PYX_ERR(0, 950, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, 9); __PYX_ERR(0, 962, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 950, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 962, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 10) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -15739,15 +15970,15 @@
     __pyx_v_named_schemas = values[6];
     __pyx_v_offset = values[7];
     __pyx_v_size = values[8];
     __pyx_v_options = values[9];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 950, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 10, 10, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 962, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.Block.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_8fastavro_5_read_5Block___init__(__pyx_self, __pyx_v_self, __pyx_v_bytes_, __pyx_v_num_records, __pyx_v_codec, __pyx_v_reader_schema, __pyx_v_writer_schema, __pyx_v_named_schemas, __pyx_v_offset, __pyx_v_size, __pyx_v_options);
 
@@ -15760,96 +15991,96 @@
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "fastavro/_read.pyx":962
+  /* "fastavro/_read.pyx":974
  *         options,
  *     ):
  *         self.bytes_ = bytes_             # <<<<<<<<<<<<<<
  *         self.num_records = num_records
  *         self.codec = codec
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_bytes_2, __pyx_v_bytes_) < 0) __PYX_ERR(0, 962, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_bytes_2, __pyx_v_bytes_) < 0) __PYX_ERR(0, 974, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":963
+  /* "fastavro/_read.pyx":975
  *     ):
  *         self.bytes_ = bytes_
  *         self.num_records = num_records             # <<<<<<<<<<<<<<
  *         self.codec = codec
  *         self.reader_schema = reader_schema
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_records, __pyx_v_num_records) < 0) __PYX_ERR(0, 963, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_records, __pyx_v_num_records) < 0) __PYX_ERR(0, 975, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":964
+  /* "fastavro/_read.pyx":976
  *         self.bytes_ = bytes_
  *         self.num_records = num_records
  *         self.codec = codec             # <<<<<<<<<<<<<<
  *         self.reader_schema = reader_schema
  *         self.writer_schema = writer_schema
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_codec, __pyx_v_codec) < 0) __PYX_ERR(0, 964, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_codec, __pyx_v_codec) < 0) __PYX_ERR(0, 976, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":965
+  /* "fastavro/_read.pyx":977
  *         self.num_records = num_records
  *         self.codec = codec
  *         self.reader_schema = reader_schema             # <<<<<<<<<<<<<<
  *         self.writer_schema = writer_schema
  *         self._named_schemas = named_schemas
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_reader_schema, __pyx_v_reader_schema) < 0) __PYX_ERR(0, 965, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_reader_schema, __pyx_v_reader_schema) < 0) __PYX_ERR(0, 977, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":966
+  /* "fastavro/_read.pyx":978
  *         self.codec = codec
  *         self.reader_schema = reader_schema
  *         self.writer_schema = writer_schema             # <<<<<<<<<<<<<<
  *         self._named_schemas = named_schemas
  *         self.offset = offset
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_writer_schema, __pyx_v_writer_schema) < 0) __PYX_ERR(0, 966, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_writer_schema, __pyx_v_writer_schema) < 0) __PYX_ERR(0, 978, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":967
+  /* "fastavro/_read.pyx":979
  *         self.reader_schema = reader_schema
  *         self.writer_schema = writer_schema
  *         self._named_schemas = named_schemas             # <<<<<<<<<<<<<<
  *         self.offset = offset
  *         self.size = size
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2, __pyx_v_named_schemas) < 0) __PYX_ERR(0, 967, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2, __pyx_v_named_schemas) < 0) __PYX_ERR(0, 979, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":968
+  /* "fastavro/_read.pyx":980
  *         self.writer_schema = writer_schema
  *         self._named_schemas = named_schemas
  *         self.offset = offset             # <<<<<<<<<<<<<<
  *         self.size = size
  *         self.options = options
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_offset, __pyx_v_offset) < 0) __PYX_ERR(0, 968, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_offset, __pyx_v_offset) < 0) __PYX_ERR(0, 980, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":969
+  /* "fastavro/_read.pyx":981
  *         self._named_schemas = named_schemas
  *         self.offset = offset
  *         self.size = size             # <<<<<<<<<<<<<<
  *         self.options = options
  * 
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_size, __pyx_v_size) < 0) __PYX_ERR(0, 969, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_size, __pyx_v_size) < 0) __PYX_ERR(0, 981, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":970
+  /* "fastavro/_read.pyx":982
  *         self.offset = offset
  *         self.size = size
  *         self.options = options             # <<<<<<<<<<<<<<
  * 
  *     def __iter__(self):
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_options, __pyx_v_options) < 0) __PYX_ERR(0, 970, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_options, __pyx_v_options) < 0) __PYX_ERR(0, 982, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":950
+  /* "fastavro/_read.pyx":962
  * 
  * class Block:
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         bytes_,
  */
 
@@ -15862,15 +16093,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 static PyObject *__pyx_gb_8fastavro_5_read_5Block_4generator2(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
 
-/* "fastavro/_read.pyx":972
+/* "fastavro/_read.pyx":984
  *         self.options = options
  * 
  *     def __iter__(self):             # <<<<<<<<<<<<<<
  *         for i in range(self.num_records):
  *             yield _read_data(
  */
 
@@ -15896,23 +16127,23 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__iter__", 0);
   __pyx_cur_scope = (struct __pyx_obj_8fastavro_5_read___pyx_scope_struct_2___iter__ *)__pyx_tp_new_8fastavro_5_read___pyx_scope_struct_2___iter__(__pyx_ptype_8fastavro_5_read___pyx_scope_struct_2___iter__, __pyx_empty_tuple, NULL);
   if (unlikely(!__pyx_cur_scope)) {
     __pyx_cur_scope = ((struct __pyx_obj_8fastavro_5_read___pyx_scope_struct_2___iter__ *)Py_None);
     __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 972, __pyx_L1_error)
+    __PYX_ERR(0, 984, __pyx_L1_error)
   } else {
     __Pyx_GOTREF(__pyx_cur_scope);
   }
   __pyx_cur_scope->__pyx_v_self = __pyx_v_self;
   __Pyx_INCREF(__pyx_cur_scope->__pyx_v_self);
   __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_self);
   {
-    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_8fastavro_5_read_5Block_4generator2, __pyx_codeobj__11, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter, __pyx_n_s_Block___iter, __pyx_n_s_fastavro__read); if (unlikely(!gen)) __PYX_ERR(0, 972, __pyx_L1_error)
+    __pyx_CoroutineObject *gen = __Pyx_Generator_New((__pyx_coroutine_body_t) __pyx_gb_8fastavro_5_read_5Block_4generator2, __pyx_codeobj__11, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter, __pyx_n_s_Block___iter, __pyx_n_s_fastavro__read); if (unlikely(!gen)) __PYX_ERR(0, 984, __pyx_L1_error)
     __Pyx_DECREF(__pyx_cur_scope);
     __Pyx_RefNannyFinishContext();
     return (PyObject *) gen;
   }
 
   /* function exit code */
   __pyx_L1_error:;
@@ -15947,134 +16178,134 @@
     case 0: goto __pyx_L3_first_run;
     case 1: goto __pyx_L6_resume_from_yield;
     default: /* CPython raises the right error here */
     __Pyx_RefNannyFinishContext();
     return NULL;
   }
   __pyx_L3_first_run:;
-  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 972, __pyx_L1_error)
+  if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 984, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":973
+  /* "fastavro/_read.pyx":985
  * 
  *     def __iter__(self):
  *         for i in range(self.num_records):             # <<<<<<<<<<<<<<
  *             yield _read_data(
  *                 self.bytes_,
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_num_records); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 973, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_num_records); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 973, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 985, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
     __pyx_t_1 = __pyx_t_2; __Pyx_INCREF(__pyx_t_1); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 973, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 973, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 985, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 973, __pyx_L1_error)
+        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 985, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 973, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 973, __pyx_L1_error)
+        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 985, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 973, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_1, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 985, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       }
     } else {
       __pyx_t_2 = __pyx_t_4(__pyx_t_1);
       if (unlikely(!__pyx_t_2)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 973, __pyx_L1_error)
+          else __PYX_ERR(0, 985, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_2);
     }
     __Pyx_XGOTREF(__pyx_cur_scope->__pyx_v_i);
     __Pyx_XDECREF_SET(__pyx_cur_scope->__pyx_v_i, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "fastavro/_read.pyx":975
+    /* "fastavro/_read.pyx":987
  *         for i in range(self.num_records):
  *             yield _read_data(
  *                 self.bytes_,             # <<<<<<<<<<<<<<
  *                 self.writer_schema,
  *                 self._named_schemas,
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_bytes_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 975, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_bytes_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 987, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
 
-    /* "fastavro/_read.pyx":976
+    /* "fastavro/_read.pyx":988
  *             yield _read_data(
  *                 self.bytes_,
  *                 self.writer_schema,             # <<<<<<<<<<<<<<
  *                 self._named_schemas,
  *                 self.reader_schema,
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_writer_schema); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 976, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_writer_schema); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 988, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
 
-    /* "fastavro/_read.pyx":977
+    /* "fastavro/_read.pyx":989
  *                 self.bytes_,
  *                 self.writer_schema,
  *                 self._named_schemas,             # <<<<<<<<<<<<<<
  *                 self.reader_schema,
  *                 self.options,
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_named_schemas_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 977, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_named_schemas_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 989, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
 
-    /* "fastavro/_read.pyx":978
+    /* "fastavro/_read.pyx":990
  *                 self.writer_schema,
  *                 self._named_schemas,
  *                 self.reader_schema,             # <<<<<<<<<<<<<<
  *                 self.options,
  *             )
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_reader_schema); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 978, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_reader_schema); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 990, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
 
-    /* "fastavro/_read.pyx":979
+    /* "fastavro/_read.pyx":991
  *                 self._named_schemas,
  *                 self.reader_schema,
  *                 self.options,             # <<<<<<<<<<<<<<
  *             )
  * 
  */
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_options); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 979, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_cur_scope->__pyx_v_self, __pyx_n_s_options); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 991, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
 
-    /* "fastavro/_read.pyx":974
+    /* "fastavro/_read.pyx":986
  *     def __iter__(self):
  *         for i in range(self.num_records):
  *             yield _read_data(             # <<<<<<<<<<<<<<
  *                 self.bytes_,
  *                 self.writer_schema,
  */
     __pyx_t_10.__pyx_n = 2;
     __pyx_t_10.reader_schema = __pyx_t_7;
     __pyx_t_10.options = __pyx_t_8;
-    __pyx_t_9 = __pyx_f_8fastavro_5_read__read_data(__pyx_t_2, __pyx_t_5, __pyx_t_6, 0, &__pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 974, __pyx_L1_error)
+    __pyx_t_9 = __pyx_f_8fastavro_5_read__read_data(__pyx_t_2, __pyx_t_5, __pyx_t_6, 0, &__pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 986, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_r = __pyx_t_9;
@@ -16091,28 +16322,28 @@
     return __pyx_r;
     __pyx_L6_resume_from_yield:;
     __pyx_t_1 = __pyx_cur_scope->__pyx_t_0;
     __pyx_cur_scope->__pyx_t_0 = 0;
     __Pyx_XGOTREF(__pyx_t_1);
     __pyx_t_3 = __pyx_cur_scope->__pyx_t_1;
     __pyx_t_4 = __pyx_cur_scope->__pyx_t_2;
-    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 974, __pyx_L1_error)
+    if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 986, __pyx_L1_error)
 
-    /* "fastavro/_read.pyx":973
+    /* "fastavro/_read.pyx":985
  * 
  *     def __iter__(self):
  *         for i in range(self.num_records):             # <<<<<<<<<<<<<<
  *             yield _read_data(
  *                 self.bytes_,
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);
 
-  /* "fastavro/_read.pyx":972
+  /* "fastavro/_read.pyx":984
  *         self.options = options
  * 
  *     def __iter__(self):             # <<<<<<<<<<<<<<
  *         for i in range(self.num_records):
  *             yield _read_data(
  */
 
@@ -16135,15 +16366,15 @@
   #endif
   __pyx_generator->resume_label = -1;
   __Pyx_Coroutine_clear((PyObject*)__pyx_generator);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":982
+/* "fastavro/_read.pyx":994
  *             )
  * 
  *     def __str__(self):             # <<<<<<<<<<<<<<
  *         return (
  *             f"Avro block: {len(self.bytes_)} bytes, {self.num_records} records, "
  */
 
@@ -16172,135 +16403,135 @@
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__str__", 0);
 
-  /* "fastavro/_read.pyx":983
+  /* "fastavro/_read.pyx":995
  * 
  *     def __str__(self):
  *         return (             # <<<<<<<<<<<<<<
  *             f"Avro block: {len(self.bytes_)} bytes, {self.num_records} records, "
  *             + f"codec: {self.codec}, position {self.offset}+{self.size}"
  */
   __Pyx_XDECREF(__pyx_r);
 
-  /* "fastavro/_read.pyx":984
+  /* "fastavro/_read.pyx":996
  *     def __str__(self):
  *         return (
  *             f"Avro block: {len(self.bytes_)} bytes, {self.num_records} records, "             # <<<<<<<<<<<<<<
  *             + f"codec: {self.codec}, position {self.offset}+{self.size}"
  *         )
  */
-  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 984, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 996, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_3 = 127;
   __Pyx_INCREF(__pyx_kp_u_Avro_block);
   __pyx_t_2 += 12;
   __Pyx_GIVEREF(__pyx_kp_u_Avro_block);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_Avro_block);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_bytes_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 984, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_bytes_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 996, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 984, __pyx_L1_error)
+  __pyx_t_5 = PyObject_Length(__pyx_t_4); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 996, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_5, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 984, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyUnicode_From_Py_ssize_t(__pyx_t_5, 0, ' ', 'd'); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 996, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u_bytes_3);
   __pyx_t_2 += 8;
   __Pyx_GIVEREF(__pyx_kp_u_bytes_3);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u_bytes_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_records); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 984, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_records); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 996, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 984, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 996, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_6) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_t_6);
   __pyx_t_6 = 0;
   __Pyx_INCREF(__pyx_kp_u_records);
   __pyx_t_2 += 10;
   __Pyx_GIVEREF(__pyx_kp_u_records);
   PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_kp_u_records);
-  __pyx_t_6 = __Pyx_PyUnicode_Join(__pyx_t_1, 5, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 984, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyUnicode_Join(__pyx_t_1, 5, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 996, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":985
+  /* "fastavro/_read.pyx":997
  *         return (
  *             f"Avro block: {len(self.bytes_)} bytes, {self.num_records} records, "
  *             + f"codec: {self.codec}, position {self.offset}+{self.size}"             # <<<<<<<<<<<<<<
  *         )
  * 
  */
-  __pyx_t_1 = PyTuple_New(6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_3 = 127;
   __Pyx_INCREF(__pyx_kp_u_codec_2);
   __pyx_t_2 += 7;
   __Pyx_GIVEREF(__pyx_kp_u_codec_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_codec_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_codec); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 985, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_codec); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 985, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_7);
   __pyx_t_7 = 0;
   __Pyx_INCREF(__pyx_kp_u_position);
   __pyx_t_2 += 11;
   __Pyx_GIVEREF(__pyx_kp_u_position);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u_position);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_offset); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 985, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_offset); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_FormatSimple(__pyx_t_7, __pyx_empty_unicode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 985, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_FormatSimple(__pyx_t_7, __pyx_empty_unicode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u__12);
   __pyx_t_2 += 1;
   __Pyx_GIVEREF(__pyx_kp_u__12);
   PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_kp_u__12);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 985, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_size); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 985, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_7) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_1, 5, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyUnicode_Join(__pyx_t_1, 6, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 985, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyUnicode_Join(__pyx_t_1, 6, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyUnicode_Concat(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 997, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":982
+  /* "fastavro/_read.pyx":994
  *             )
  * 
  *     def __str__(self):             # <<<<<<<<<<<<<<
  *         return (
  *             f"Avro block: {len(self.bytes_)} bytes, {self.num_records} records, "
  */
 
@@ -16314,41 +16545,41 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":990
+/* "fastavro/_read.pyx":1002
  * 
  * class file_reader:
  *     def __init__(self, fo, reader_schema=None, options={}):             # <<<<<<<<<<<<<<
  *         self.fo = fo
  *         self.options = options
  */
 
-static PyObject *__pyx_pf_8fastavro_5_read_90__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
+static PyObject *__pyx_pf_8fastavro_5_read_92__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__defaults__", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1002, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(((PyObject *)Py_None));
   __Pyx_GIVEREF(((PyObject *)Py_None));
   PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)Py_None));
   __Pyx_INCREF(__Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_options);
   __Pyx_GIVEREF(__Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_options);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_self)->__pyx_arg_options);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 990, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1002, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(Py_None);
   __Pyx_GIVEREF(Py_None);
   PyTuple_SET_ITEM(__pyx_t_2, 1, Py_None);
   __pyx_t_1 = 0;
@@ -16408,15 +16639,15 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 4, 1); __PYX_ERR(0, 990, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 4, 1); __PYX_ERR(0, 1002, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema);
           if (value) { values[2] = value; kw_args--; }
         }
@@ -16424,15 +16655,15 @@
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_options);
           if (value) { values[3] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 990, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1002, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
@@ -16445,15 +16676,15 @@
     __pyx_v_self = values[0];
     __pyx_v_fo = values[1];
     __pyx_v_reader_schema = values[2];
     __pyx_v_options = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 990, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1002, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.file_reader.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_8fastavro_5_read_11file_reader___init__(__pyx_self, __pyx_v_self, __pyx_v_fo, __pyx_v_reader_schema, __pyx_v_options);
 
@@ -16483,33 +16714,33 @@
   int __pyx_t_13;
   int __pyx_t_14;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "fastavro/_read.pyx":991
+  /* "fastavro/_read.pyx":1003
  * class file_reader:
  *     def __init__(self, fo, reader_schema=None, options={}):
  *         self.fo = fo             # <<<<<<<<<<<<<<
  *         self.options = options
  *         try:
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_fo, __pyx_v_fo) < 0) __PYX_ERR(0, 991, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_fo, __pyx_v_fo) < 0) __PYX_ERR(0, 1003, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":992
+  /* "fastavro/_read.pyx":1004
  *     def __init__(self, fo, reader_schema=None, options={}):
  *         self.fo = fo
  *         self.options = options             # <<<<<<<<<<<<<<
  *         try:
  *             self._header = _read_data(self.fo, HEADER_SCHEMA, {}, None, self.options)
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_options, __pyx_v_options) < 0) __PYX_ERR(0, 992, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_options, __pyx_v_options) < 0) __PYX_ERR(0, 1004, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":993
+  /* "fastavro/_read.pyx":1005
  *         self.fo = fo
  *         self.options = options
  *         try:             # <<<<<<<<<<<<<<
  *             self._header = _read_data(self.fo, HEADER_SCHEMA, {}, None, self.options)
  *         except (StopIteration, EOFError):
  */
   {
@@ -16517,42 +16748,42 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_1, &__pyx_t_2, &__pyx_t_3);
     __Pyx_XGOTREF(__pyx_t_1);
     __Pyx_XGOTREF(__pyx_t_2);
     __Pyx_XGOTREF(__pyx_t_3);
     /*try:*/ {
 
-      /* "fastavro/_read.pyx":994
+      /* "fastavro/_read.pyx":1006
  *         self.options = options
  *         try:
  *             self._header = _read_data(self.fo, HEADER_SCHEMA, {}, None, self.options)             # <<<<<<<<<<<<<<
  *         except (StopIteration, EOFError):
  *             raise ValueError("cannot read header - is it an avro file?")
  */
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_fo); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 994, __pyx_L3_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_fo); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1006, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_HEADER_SCHEMA); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 994, __pyx_L3_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_HEADER_SCHEMA); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1006, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 994, __pyx_L3_error)
+      __pyx_t_6 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1006, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_options); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 994, __pyx_L3_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_options); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1006, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_7);
       __pyx_t_9.__pyx_n = 2;
       __pyx_t_9.reader_schema = Py_None;
       __pyx_t_9.options = __pyx_t_7;
-      __pyx_t_8 = __pyx_f_8fastavro_5_read__read_data(__pyx_t_4, __pyx_t_5, __pyx_t_6, 0, &__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 994, __pyx_L3_error)
+      __pyx_t_8 = __pyx_f_8fastavro_5_read__read_data(__pyx_t_4, __pyx_t_5, __pyx_t_6, 0, &__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1006, __pyx_L3_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_header_2, __pyx_t_8) < 0) __PYX_ERR(0, 994, __pyx_L3_error)
+      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_header_2, __pyx_t_8) < 0) __PYX_ERR(0, 1006, __pyx_L3_error)
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-      /* "fastavro/_read.pyx":993
+      /* "fastavro/_read.pyx":1005
  *         self.fo = fo
  *         self.options = options
  *         try:             # <<<<<<<<<<<<<<
  *             self._header = _read_data(self.fo, HEADER_SCHEMA, {}, None, self.options)
  *         except (StopIteration, EOFError):
  */
     }
@@ -16563,160 +16794,160 @@
     __pyx_L3_error:;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastavro/_read.pyx":995
+    /* "fastavro/_read.pyx":1007
  *         try:
  *             self._header = _read_data(self.fo, HEADER_SCHEMA, {}, None, self.options)
  *         except (StopIteration, EOFError):             # <<<<<<<<<<<<<<
  *             raise ValueError("cannot read header - is it an avro file?")
  * 
  */
     __pyx_t_10 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_StopIteration) || __Pyx_PyErr_ExceptionMatches(__pyx_builtin_EOFError);
     if (__pyx_t_10) {
       __Pyx_AddTraceback("fastavro._read.file_reader.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_8, &__pyx_t_7, &__pyx_t_6) < 0) __PYX_ERR(0, 995, __pyx_L5_except_error)
+      if (__Pyx_GetException(&__pyx_t_8, &__pyx_t_7, &__pyx_t_6) < 0) __PYX_ERR(0, 1007, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_GOTREF(__pyx_t_6);
 
-      /* "fastavro/_read.pyx":996
+      /* "fastavro/_read.pyx":1008
  *             self._header = _read_data(self.fo, HEADER_SCHEMA, {}, None, self.options)
  *         except (StopIteration, EOFError):
  *             raise ValueError("cannot read header - is it an avro file?")             # <<<<<<<<<<<<<<
  * 
  *         # `meta` values are bytes. So, the actual decoding has to be external.
  */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 996, __pyx_L5_except_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__13, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1008, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_Raise(__pyx_t_5, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __PYX_ERR(0, 996, __pyx_L5_except_error)
+      __PYX_ERR(0, 1008, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
 
-    /* "fastavro/_read.pyx":993
+    /* "fastavro/_read.pyx":1005
  *         self.fo = fo
  *         self.options = options
  *         try:             # <<<<<<<<<<<<<<
  *             self._header = _read_data(self.fo, HEADER_SCHEMA, {}, None, self.options)
  *         except (StopIteration, EOFError):
  */
     __Pyx_XGIVEREF(__pyx_t_1);
     __Pyx_XGIVEREF(__pyx_t_2);
     __Pyx_XGIVEREF(__pyx_t_3);
     __Pyx_ExceptionReset(__pyx_t_1, __pyx_t_2, __pyx_t_3);
     goto __pyx_L1_error;
     __pyx_L8_try_end:;
   }
 
-  /* "fastavro/_read.pyx":999
+  /* "fastavro/_read.pyx":1011
  * 
  *         # `meta` values are bytes. So, the actual decoding has to be external.
  *         self.metadata = {             # <<<<<<<<<<<<<<
  *             k: v.decode() for k, v in self._header["meta"].items()
  *         }
  */
   { /* enter inner scope */
-    __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 999, __pyx_L13_error)
+    __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1011, __pyx_L13_error)
     __Pyx_GOTREF(__pyx_t_6);
 
-    /* "fastavro/_read.pyx":1000
+    /* "fastavro/_read.pyx":1012
  *         # `meta` values are bytes. So, the actual decoding has to be external.
  *         self.metadata = {
  *             k: v.decode() for k, v in self._header["meta"].items()             # <<<<<<<<<<<<<<
  *         }
  * 
  */
     __pyx_t_11 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_header_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1000, __pyx_L13_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_header_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1012, __pyx_L13_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_8, __pyx_n_u_meta); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1000, __pyx_L13_error)
+    __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_8, __pyx_n_u_meta); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1012, __pyx_L13_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     if (unlikely(__pyx_t_5 == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "items");
-      __PYX_ERR(0, 1000, __pyx_L13_error)
+      __PYX_ERR(0, 1012, __pyx_L13_error)
     }
-    __pyx_t_8 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_items, (&__pyx_t_12), (&__pyx_t_10)); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1000, __pyx_L13_error)
+    __pyx_t_8 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_items, (&__pyx_t_12), (&__pyx_t_10)); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1012, __pyx_L13_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF(__pyx_t_7);
     __pyx_t_7 = __pyx_t_8;
     __pyx_t_8 = 0;
     while (1) {
       __pyx_t_13 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_12, &__pyx_t_11, &__pyx_t_8, &__pyx_t_5, NULL, __pyx_t_10);
       if (unlikely(__pyx_t_13 == 0)) break;
-      if (unlikely(__pyx_t_13 == -1)) __PYX_ERR(0, 1000, __pyx_L13_error)
+      if (unlikely(__pyx_t_13 == -1)) __PYX_ERR(0, 1012, __pyx_L13_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_XDECREF_SET(__pyx_8genexpr1__pyx_v_k, __pyx_t_8);
       __pyx_t_8 = 0;
       __Pyx_XDECREF_SET(__pyx_8genexpr1__pyx_v_v, __pyx_t_5);
       __pyx_t_5 = 0;
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_8genexpr1__pyx_v_v, __pyx_n_s_decode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1000, __pyx_L13_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_8genexpr1__pyx_v_v, __pyx_n_s_decode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1012, __pyx_L13_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_8);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
           __Pyx_INCREF(__pyx_t_4);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_8, function);
         }
       }
       __pyx_t_5 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_8);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1000, __pyx_L13_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1012, __pyx_L13_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (unlikely(PyDict_SetItem(__pyx_t_6, (PyObject*)__pyx_8genexpr1__pyx_v_k, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 1000, __pyx_L13_error)
+      if (unlikely(PyDict_SetItem(__pyx_t_6, (PyObject*)__pyx_8genexpr1__pyx_v_k, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 1012, __pyx_L13_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_k); __pyx_8genexpr1__pyx_v_k = 0;
     __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_v); __pyx_8genexpr1__pyx_v_v = 0;
     goto __pyx_L16_exit_scope;
     __pyx_L13_error:;
     __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_k); __pyx_8genexpr1__pyx_v_k = 0;
     __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_v); __pyx_8genexpr1__pyx_v_v = 0;
     goto __pyx_L1_error;
     __pyx_L16_exit_scope:;
   } /* exit inner scope */
 
-  /* "fastavro/_read.pyx":999
+  /* "fastavro/_read.pyx":1011
  * 
  *         # `meta` values are bytes. So, the actual decoding has to be external.
  *         self.metadata = {             # <<<<<<<<<<<<<<
  *             k: v.decode() for k, v in self._header["meta"].items()
  *         }
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_metadata, __pyx_t_6) < 0) __PYX_ERR(0, 999, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_metadata, __pyx_t_6) < 0) __PYX_ERR(0, 1011, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "fastavro/_read.pyx":1003
+  /* "fastavro/_read.pyx":1015
  *         }
  * 
  *         self._schema = json.loads(self.metadata["avro.schema"])             # <<<<<<<<<<<<<<
  *         self.codec = self.metadata.get("avro.codec", "null")
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_json); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1003, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_json); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_loads); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1003, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_loads); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_metadata); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1003, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_metadata); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_t_7, __pyx_kp_u_avro_schema); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1003, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_t_7, __pyx_kp_u_avro_schema); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_7 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_7)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -16724,279 +16955,271 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_6 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_8);
   __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1003, __pyx_L1_error)
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_schema, __pyx_t_6) < 0) __PYX_ERR(0, 1003, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_schema, __pyx_t_6) < 0) __PYX_ERR(0, 1015, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "fastavro/_read.pyx":1004
+  /* "fastavro/_read.pyx":1016
  * 
  *         self._schema = json.loads(self.metadata["avro.schema"])
  *         self.codec = self.metadata.get("avro.codec", "null")             # <<<<<<<<<<<<<<
  * 
- *         self._named_schemas = {"writer": {}, "reader": {}}
+ *         self._named_schemas = _default_named_schemas()
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_metadata); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1004, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_metadata); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1016, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_get); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1004, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_get); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1016, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1004, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1016, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_codec, __pyx_t_6) < 0) __PYX_ERR(0, 1004, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_codec, __pyx_t_6) < 0) __PYX_ERR(0, 1016, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "fastavro/_read.pyx":1006
+  /* "fastavro/_read.pyx":1018
  *         self.codec = self.metadata.get("avro.codec", "null")
  * 
- *         self._named_schemas = {"writer": {}, "reader": {}}             # <<<<<<<<<<<<<<
+ *         self._named_schemas = _default_named_schemas()             # <<<<<<<<<<<<<<
  *         if reader_schema:
  *             self.reader_schema = parse_schema(
  */
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1006, __pyx_L1_error)
+  __pyx_t_6 = __pyx_f_8fastavro_5_read__default_named_schemas(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1018, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1006, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_writer, __pyx_t_5) < 0) __PYX_ERR(0, 1006, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1006, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_u_reader, __pyx_t_5) < 0) __PYX_ERR(0, 1006, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2, __pyx_t_6) < 0) __PYX_ERR(0, 1006, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2, __pyx_t_6) < 0) __PYX_ERR(0, 1018, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "fastavro/_read.pyx":1007
+  /* "fastavro/_read.pyx":1019
  * 
- *         self._named_schemas = {"writer": {}, "reader": {}}
+ *         self._named_schemas = _default_named_schemas()
  *         if reader_schema:             # <<<<<<<<<<<<<<
  *             self.reader_schema = parse_schema(
  *                 reader_schema, self._named_schemas["reader"], _write_hint=False
  */
-  __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 1007, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_14 < 0)) __PYX_ERR(0, 1019, __pyx_L1_error)
   if (__pyx_t_14) {
 
-    /* "fastavro/_read.pyx":1008
- *         self._named_schemas = {"writer": {}, "reader": {}}
+    /* "fastavro/_read.pyx":1020
+ *         self._named_schemas = _default_named_schemas()
  *         if reader_schema:
  *             self.reader_schema = parse_schema(             # <<<<<<<<<<<<<<
  *                 reader_schema, self._named_schemas["reader"], _write_hint=False
  *             )
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_parse_schema); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1008, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_parse_schema); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1020, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
 
-    /* "fastavro/_read.pyx":1009
+    /* "fastavro/_read.pyx":1021
  *         if reader_schema:
  *             self.reader_schema = parse_schema(
  *                 reader_schema, self._named_schemas["reader"], _write_hint=False             # <<<<<<<<<<<<<<
  *             )
  *             # Older avro files created before we were more strict about
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1021, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_t_5, __pyx_n_u_reader); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_t_5, __pyx_n_u_reader); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "fastavro/_read.pyx":1008
- *         self._named_schemas = {"writer": {}, "reader": {}}
+    /* "fastavro/_read.pyx":1020
+ *         self._named_schemas = _default_named_schemas()
  *         if reader_schema:
  *             self.reader_schema = parse_schema(             # <<<<<<<<<<<<<<
  *                 reader_schema, self._named_schemas["reader"], _write_hint=False
  *             )
  */
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1008, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1020, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_v_reader_schema);
     __Pyx_GIVEREF(__pyx_v_reader_schema);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_reader_schema);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_8);
     __pyx_t_8 = 0;
 
-    /* "fastavro/_read.pyx":1009
+    /* "fastavro/_read.pyx":1021
  *         if reader_schema:
  *             self.reader_schema = parse_schema(
  *                 reader_schema, self._named_schemas["reader"], _write_hint=False             # <<<<<<<<<<<<<<
  *             )
  *             # Older avro files created before we were more strict about
  */
-    __pyx_t_8 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1009, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_write_hint, Py_False) < 0) __PYX_ERR(0, 1009, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_write_hint, Py_False) < 0) __PYX_ERR(0, 1021, __pyx_L1_error)
 
-    /* "fastavro/_read.pyx":1008
- *         self._named_schemas = {"writer": {}, "reader": {}}
+    /* "fastavro/_read.pyx":1020
+ *         self._named_schemas = _default_named_schemas()
  *         if reader_schema:
  *             self.reader_schema = parse_schema(             # <<<<<<<<<<<<<<
  *                 reader_schema, self._named_schemas["reader"], _write_hint=False
  *             )
  */
-    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1008, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1020, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_reader_schema, __pyx_t_7) < 0) __PYX_ERR(0, 1008, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_reader_schema, __pyx_t_7) < 0) __PYX_ERR(0, 1020, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "fastavro/_read.pyx":1016
+    /* "fastavro/_read.pyx":1028
  *             # provides a reader schema that passes parsing, we will ignore those
  *             # default errors
  *             ignore_default_error = True             # <<<<<<<<<<<<<<
  *         else:
  *             self.reader_schema = None
  */
     __pyx_v_ignore_default_error = 1;
 
-    /* "fastavro/_read.pyx":1007
+    /* "fastavro/_read.pyx":1019
  * 
- *         self._named_schemas = {"writer": {}, "reader": {}}
+ *         self._named_schemas = _default_named_schemas()
  *         if reader_schema:             # <<<<<<<<<<<<<<
  *             self.reader_schema = parse_schema(
  *                 reader_schema, self._named_schemas["reader"], _write_hint=False
  */
     goto __pyx_L17;
   }
 
-  /* "fastavro/_read.pyx":1018
+  /* "fastavro/_read.pyx":1030
  *             ignore_default_error = True
  *         else:
  *             self.reader_schema = None             # <<<<<<<<<<<<<<
  *             ignore_default_error = False
  * 
  */
   /*else*/ {
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_reader_schema, Py_None) < 0) __PYX_ERR(0, 1018, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_reader_schema, Py_None) < 0) __PYX_ERR(0, 1030, __pyx_L1_error)
 
-    /* "fastavro/_read.pyx":1019
+    /* "fastavro/_read.pyx":1031
  *         else:
  *             self.reader_schema = None
  *             ignore_default_error = False             # <<<<<<<<<<<<<<
  * 
  *         self.writer_schema = parse_schema(
  */
     __pyx_v_ignore_default_error = 0;
   }
   __pyx_L17:;
 
-  /* "fastavro/_read.pyx":1021
+  /* "fastavro/_read.pyx":1033
  *             ignore_default_error = False
  * 
  *         self.writer_schema = parse_schema(             # <<<<<<<<<<<<<<
  *             self._schema,
  *             self._named_schemas["writer"],
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_parse_schema); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_parse_schema); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1033, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
 
-  /* "fastavro/_read.pyx":1022
+  /* "fastavro/_read.pyx":1034
  * 
  *         self.writer_schema = parse_schema(
  *             self._schema,             # <<<<<<<<<<<<<<
  *             self._named_schemas["writer"],
  *             _write_hint=False,
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_schema); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1022, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_schema); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1034, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
 
-  /* "fastavro/_read.pyx":1023
+  /* "fastavro/_read.pyx":1035
  *         self.writer_schema = parse_schema(
  *             self._schema,
  *             self._named_schemas["writer"],             # <<<<<<<<<<<<<<
  *             _write_hint=False,
  *             _force=True,
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1023, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1035, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_t_5, __pyx_n_u_writer); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1023, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_t_5, __pyx_n_u_writer); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1035, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastavro/_read.pyx":1021
+  /* "fastavro/_read.pyx":1033
  *             ignore_default_error = False
  * 
  *         self.writer_schema = parse_schema(             # <<<<<<<<<<<<<<
  *             self._schema,
  *             self._named_schemas["writer"],
  */
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1033, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_8);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_8);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_6);
   __pyx_t_8 = 0;
   __pyx_t_6 = 0;
 
-  /* "fastavro/_read.pyx":1024
+  /* "fastavro/_read.pyx":1036
  *             self._schema,
  *             self._named_schemas["writer"],
  *             _write_hint=False,             # <<<<<<<<<<<<<<
  *             _force=True,
  *             _ignore_default_error=ignore_default_error,
  */
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1024, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1036, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_write_hint, Py_False) < 0) __PYX_ERR(0, 1024, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_write_hint, Py_False) < 0) __PYX_ERR(0, 1036, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1025
+  /* "fastavro/_read.pyx":1037
  *             self._named_schemas["writer"],
  *             _write_hint=False,
  *             _force=True,             # <<<<<<<<<<<<<<
  *             _ignore_default_error=ignore_default_error,
  *         )
  */
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_force, Py_True) < 0) __PYX_ERR(0, 1024, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_force, Py_True) < 0) __PYX_ERR(0, 1036, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1026
+  /* "fastavro/_read.pyx":1038
  *             _write_hint=False,
  *             _force=True,
  *             _ignore_default_error=ignore_default_error,             # <<<<<<<<<<<<<<
  *         )
  * 
  */
-  __pyx_t_8 = __Pyx_PyBool_FromLong(__pyx_v_ignore_default_error); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyBool_FromLong(__pyx_v_ignore_default_error); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1038, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_ignore_default_error, __pyx_t_8) < 0) __PYX_ERR(0, 1024, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_ignore_default_error, __pyx_t_8) < 0) __PYX_ERR(0, 1036, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "fastavro/_read.pyx":1021
+  /* "fastavro/_read.pyx":1033
  *             ignore_default_error = False
  * 
  *         self.writer_schema = parse_schema(             # <<<<<<<<<<<<<<
  *             self._schema,
  *             self._named_schemas["writer"],
  */
-  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1021, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1033, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_writer_schema, __pyx_t_8) < 0) __PYX_ERR(0, 1021, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_writer_schema, __pyx_t_8) < 0) __PYX_ERR(0, 1033, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "fastavro/_read.pyx":1029
+  /* "fastavro/_read.pyx":1041
  *         )
  * 
  *         self._elems = None             # <<<<<<<<<<<<<<
  * 
  *     @property
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_elems, Py_None) < 0) __PYX_ERR(0, 1029, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_elems, Py_None) < 0) __PYX_ERR(0, 1041, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":990
+  /* "fastavro/_read.pyx":1002
  * 
  * class file_reader:
  *     def __init__(self, fo, reader_schema=None, options={}):             # <<<<<<<<<<<<<<
  *         self.fo = fo
  *         self.options = options
  */
 
@@ -17015,15 +17238,15 @@
   __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_k);
   __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_v);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":1032
+/* "fastavro/_read.pyx":1044
  * 
  *     @property
  *     def schema(self):             # <<<<<<<<<<<<<<
  *         import warnings
  *         warnings.warn(
  */
 
@@ -17048,63 +17271,63 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("schema", 0);
 
-  /* "fastavro/_read.pyx":1033
+  /* "fastavro/_read.pyx":1045
  *     @property
  *     def schema(self):
  *         import warnings             # <<<<<<<<<<<<<<
  *         warnings.warn(
  *             "The 'schema' attribute is deprecated. Please use 'writer_schema'",
  */
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_warnings, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1033, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_warnings, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1045, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_warnings = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":1034
+  /* "fastavro/_read.pyx":1046
  *     def schema(self):
  *         import warnings
  *         warnings.warn(             # <<<<<<<<<<<<<<
  *             "The 'schema' attribute is deprecated. Please use 'writer_schema'",
  *             DeprecationWarning,
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_warnings, __pyx_n_s_warn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_warnings, __pyx_n_s_warn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1046, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
 
-  /* "fastavro/_read.pyx":1036
+  /* "fastavro/_read.pyx":1048
  *         warnings.warn(
  *             "The 'schema' attribute is deprecated. Please use 'writer_schema'",
  *             DeprecationWarning,             # <<<<<<<<<<<<<<
  *         )
  *         return self._schema
  */
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1034, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1046, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":1038
+  /* "fastavro/_read.pyx":1050
  *             DeprecationWarning,
  *         )
  *         return self._schema             # <<<<<<<<<<<<<<
  * 
  *     def __iter__(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_schema); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1038, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_schema); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1050, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":1032
+  /* "fastavro/_read.pyx":1044
  * 
  *     @property
  *     def schema(self):             # <<<<<<<<<<<<<<
  *         import warnings
  *         warnings.warn(
  */
 
@@ -17117,15 +17340,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_warnings);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":1040
+/* "fastavro/_read.pyx":1052
  *         return self._schema
  * 
  *     def __iter__(self):             # <<<<<<<<<<<<<<
  *         if not self._elems:
  *             raise NotImplementedError
  */
 
@@ -17150,62 +17373,62 @@
   int __pyx_t_2;
   int __pyx_t_3;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__iter__", 0);
 
-  /* "fastavro/_read.pyx":1041
+  /* "fastavro/_read.pyx":1053
  * 
  *     def __iter__(self):
  *         if not self._elems:             # <<<<<<<<<<<<<<
  *             raise NotImplementedError
  *         return self._elems
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_elems); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_elems); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1053, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_3 = ((!__pyx_t_2) != 0);
   if (unlikely(__pyx_t_3)) {
 
-    /* "fastavro/_read.pyx":1042
+    /* "fastavro/_read.pyx":1054
  *     def __iter__(self):
  *         if not self._elems:
  *             raise NotImplementedError             # <<<<<<<<<<<<<<
  *         return self._elems
  * 
  */
     __Pyx_Raise(__pyx_builtin_NotImplementedError, 0, 0, 0);
-    __PYX_ERR(0, 1042, __pyx_L1_error)
+    __PYX_ERR(0, 1054, __pyx_L1_error)
 
-    /* "fastavro/_read.pyx":1041
+    /* "fastavro/_read.pyx":1053
  * 
  *     def __iter__(self):
  *         if not self._elems:             # <<<<<<<<<<<<<<
  *             raise NotImplementedError
  *         return self._elems
  */
   }
 
-  /* "fastavro/_read.pyx":1043
+  /* "fastavro/_read.pyx":1055
  *         if not self._elems:
  *             raise NotImplementedError
  *         return self._elems             # <<<<<<<<<<<<<<
  * 
  *     def __next__(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_elems); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1043, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_elems); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":1040
+  /* "fastavro/_read.pyx":1052
  *         return self._schema
  * 
  *     def __iter__(self):             # <<<<<<<<<<<<<<
  *         if not self._elems:
  *             raise NotImplementedError
  */
 
@@ -17216,15 +17439,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":1045
+/* "fastavro/_read.pyx":1057
  *         return self._elems
  * 
  *     def __next__(self):             # <<<<<<<<<<<<<<
  *         return next(self._elems)
  * 
  */
 
@@ -17248,32 +17471,32 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__next__", 0);
 
-  /* "fastavro/_read.pyx":1046
+  /* "fastavro/_read.pyx":1058
  * 
  *     def __next__(self):
  *         return next(self._elems)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_elems); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1046, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_elems); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyIter_Next(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1046, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyIter_Next(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1058, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":1045
+  /* "fastavro/_read.pyx":1057
  *         return self._elems
  * 
  *     def __next__(self):             # <<<<<<<<<<<<<<
  *         return next(self._elems)
  * 
  */
 
@@ -17285,15 +17508,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":1050
+/* "fastavro/_read.pyx":1062
  * 
  * class reader(file_reader):
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         fo,
  */
 
@@ -17313,33 +17536,33 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_fo,&__pyx_n_s_reader_schema,&__pyx_n_s_return_record_name,&__pyx_n_s_return_record_name_override,&__pyx_n_s_handle_unicode_errors,0};
     PyObject* values[6] = {0,0,0,0,0,0};
 
-    /* "fastavro/_read.pyx":1053
+    /* "fastavro/_read.pyx":1065
  *         self,
  *         fo,
  *         reader_schema=None,             # <<<<<<<<<<<<<<
  *         return_record_name=False,
  *         return_record_name_override=False,
  */
     values[2] = ((PyObject *)((PyObject *)Py_None));
 
-    /* "fastavro/_read.pyx":1054
+    /* "fastavro/_read.pyx":1066
  *         fo,
  *         reader_schema=None,
  *         return_record_name=False,             # <<<<<<<<<<<<<<
  *         return_record_name_override=False,
  *         handle_unicode_errors="strict",
  */
     values[3] = ((PyObject *)((PyObject *)Py_False));
 
-    /* "fastavro/_read.pyx":1055
+    /* "fastavro/_read.pyx":1067
  *         reader_schema=None,
  *         return_record_name=False,
  *         return_record_name_override=False,             # <<<<<<<<<<<<<<
  *         handle_unicode_errors="strict",
  *     ):
  */
     values[4] = ((PyObject *)((PyObject *)Py_False));
@@ -17368,15 +17591,15 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 6, 1); __PYX_ERR(0, 1050, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 6, 1); __PYX_ERR(0, 1062, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema);
           if (value) { values[2] = value; kw_args--; }
         }
@@ -17396,15 +17619,15 @@
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_handle_unicode_errors);
           if (value) { values[5] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1050, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1062, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
@@ -17423,23 +17646,23 @@
     __pyx_v_reader_schema = values[2];
     __pyx_v_return_record_name = values[3];
     __pyx_v_return_record_name_override = values[4];
     __pyx_v_handle_unicode_errors = values[5];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1050, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1062, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.reader.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_8fastavro_5_read_6reader___init__(__pyx_self, __pyx_v_self, __pyx_v_fo, __pyx_v_reader_schema, __pyx_v_return_record_name, __pyx_v_return_record_name_override, __pyx_v_handle_unicode_errors);
 
-  /* "fastavro/_read.pyx":1050
+  /* "fastavro/_read.pyx":1062
  * 
  * class reader(file_reader):
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         fo,
  */
 
@@ -17465,67 +17688,67 @@
   PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "fastavro/_read.pyx":1059
+  /* "fastavro/_read.pyx":1071
  *     ):
  *         options = {
  *             "return_record_name": return_record_name,             # <<<<<<<<<<<<<<
  *             "return_record_name_override": return_record_name_override,
  *             "handle_unicode_errors": handle_unicode_errors,
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1071, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name, __pyx_v_return_record_name) < 0) __PYX_ERR(0, 1059, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name, __pyx_v_return_record_name) < 0) __PYX_ERR(0, 1071, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1060
+  /* "fastavro/_read.pyx":1072
  *         options = {
  *             "return_record_name": return_record_name,
  *             "return_record_name_override": return_record_name_override,             # <<<<<<<<<<<<<<
  *             "handle_unicode_errors": handle_unicode_errors,
  *         }
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name_override, __pyx_v_return_record_name_override) < 0) __PYX_ERR(0, 1059, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name_override, __pyx_v_return_record_name_override) < 0) __PYX_ERR(0, 1071, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1061
+  /* "fastavro/_read.pyx":1073
  *             "return_record_name": return_record_name,
  *             "return_record_name_override": return_record_name_override,
  *             "handle_unicode_errors": handle_unicode_errors,             # <<<<<<<<<<<<<<
  *         }
  *         super().__init__(fo, reader_schema, options)
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_handle_unicode_errors, __pyx_v_handle_unicode_errors) < 0) __PYX_ERR(0, 1059, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_handle_unicode_errors, __pyx_v_handle_unicode_errors) < 0) __PYX_ERR(0, 1071, __pyx_L1_error)
   __pyx_v_options = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":1063
+  /* "fastavro/_read.pyx":1075
  *             "handle_unicode_errors": handle_unicode_errors,
  *         }
  *         super().__init__(fo, reader_schema, options)             # <<<<<<<<<<<<<<
  * 
  *         self._elems = _iter_avro_records(self.fo,
  */
   __pyx_t_2 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_2) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1063, __pyx_L1_error) }
+  if (!__pyx_t_2) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1075, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1075, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_self);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1075, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_init); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_init); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1075, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
@@ -17535,119 +17758,119 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_v_fo, __pyx_v_reader_schema, __pyx_v_options};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1075, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_v_fo, __pyx_v_reader_schema, __pyx_v_options};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1075, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1063, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1075, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_2) {
       __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
     }
     __Pyx_INCREF(__pyx_v_fo);
     __Pyx_GIVEREF(__pyx_v_fo);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_fo);
     __Pyx_INCREF(__pyx_v_reader_schema);
     __Pyx_GIVEREF(__pyx_v_reader_schema);
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_reader_schema);
     __Pyx_INCREF(__pyx_v_options);
     __Pyx_GIVEREF(__pyx_v_options);
     PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_4, __pyx_v_options);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1075, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":1065
+  /* "fastavro/_read.pyx":1077
  *         super().__init__(fo, reader_schema, options)
  * 
  *         self._elems = _iter_avro_records(self.fo,             # <<<<<<<<<<<<<<
  *                                          self._header,
  *                                          self.codec,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_iter_avro_records); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1065, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_iter_avro_records); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_fo); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1065, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_fo); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
 
-  /* "fastavro/_read.pyx":1066
+  /* "fastavro/_read.pyx":1078
  * 
  *         self._elems = _iter_avro_records(self.fo,
  *                                          self._header,             # <<<<<<<<<<<<<<
  *                                          self.codec,
  *                                          self.writer_schema,
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_header_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1066, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_header_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "fastavro/_read.pyx":1067
+  /* "fastavro/_read.pyx":1079
  *         self._elems = _iter_avro_records(self.fo,
  *                                          self._header,
  *                                          self.codec,             # <<<<<<<<<<<<<<
  *                                          self.writer_schema,
  *                                          self._named_schemas,
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_codec); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1067, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_codec); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1079, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
 
-  /* "fastavro/_read.pyx":1068
+  /* "fastavro/_read.pyx":1080
  *                                          self._header,
  *                                          self.codec,
  *                                          self.writer_schema,             # <<<<<<<<<<<<<<
  *                                          self._named_schemas,
  *                                          self.reader_schema,
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_writer_schema); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1068, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_writer_schema); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1080, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
 
-  /* "fastavro/_read.pyx":1069
+  /* "fastavro/_read.pyx":1081
  *                                          self.codec,
  *                                          self.writer_schema,
  *                                          self._named_schemas,             # <<<<<<<<<<<<<<
  *                                          self.reader_schema,
  *                                          self.options)
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1069, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1081, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
 
-  /* "fastavro/_read.pyx":1070
+  /* "fastavro/_read.pyx":1082
  *                                          self.writer_schema,
  *                                          self._named_schemas,
  *                                          self.reader_schema,             # <<<<<<<<<<<<<<
  *                                          self.options)
  * 
  */
-  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reader_schema); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1070, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reader_schema); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
 
-  /* "fastavro/_read.pyx":1071
+  /* "fastavro/_read.pyx":1083
  *                                          self._named_schemas,
  *                                          self.reader_schema,
  *                                          self.options)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_options); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1071, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_options); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1083, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __pyx_t_11 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_11)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -17656,43 +17879,43 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[8] = {__pyx_t_11, __pyx_t_5, __pyx_t_2, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 7+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 7+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[8] = {__pyx_t_11, __pyx_t_5, __pyx_t_2, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 7+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 7+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   } else
   #endif
   {
-    __pyx_t_12 = PyTuple_New(7+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1065, __pyx_L1_error)
+    __pyx_t_12 = PyTuple_New(7+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1077, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     if (__pyx_t_11) {
       __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_4, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_2);
@@ -17710,31 +17933,31 @@
     __pyx_t_5 = 0;
     __pyx_t_2 = 0;
     __pyx_t_6 = 0;
     __pyx_t_7 = 0;
     __pyx_t_8 = 0;
     __pyx_t_9 = 0;
     __pyx_t_10 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "fastavro/_read.pyx":1065
+  /* "fastavro/_read.pyx":1077
  *         super().__init__(fo, reader_schema, options)
  * 
  *         self._elems = _iter_avro_records(self.fo,             # <<<<<<<<<<<<<<
  *                                          self._header,
  *                                          self.codec,
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_elems, __pyx_t_1) < 0) __PYX_ERR(0, 1065, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_elems, __pyx_t_1) < 0) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":1050
+  /* "fastavro/_read.pyx":1062
  * 
  * class reader(file_reader):
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         fo,
  */
 
@@ -17758,15 +17981,15 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_options);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":1075
+/* "fastavro/_read.pyx":1087
  * 
  * class block_reader(file_reader):
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         fo,
  */
 
@@ -17786,33 +18009,33 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_fo,&__pyx_n_s_reader_schema,&__pyx_n_s_return_record_name,&__pyx_n_s_return_record_name_override,&__pyx_n_s_handle_unicode_errors,0};
     PyObject* values[6] = {0,0,0,0,0,0};
 
-    /* "fastavro/_read.pyx":1078
+    /* "fastavro/_read.pyx":1090
  *         self,
  *         fo,
  *         reader_schema=None,             # <<<<<<<<<<<<<<
  *         return_record_name=False,
  *         return_record_name_override=False,
  */
     values[2] = ((PyObject *)((PyObject *)Py_None));
 
-    /* "fastavro/_read.pyx":1079
+    /* "fastavro/_read.pyx":1091
  *         fo,
  *         reader_schema=None,
  *         return_record_name=False,             # <<<<<<<<<<<<<<
  *         return_record_name_override=False,
  *         handle_unicode_errors="strict",
  */
     values[3] = ((PyObject *)((PyObject *)Py_False));
 
-    /* "fastavro/_read.pyx":1080
+    /* "fastavro/_read.pyx":1092
  *         reader_schema=None,
  *         return_record_name=False,
  *         return_record_name_override=False,             # <<<<<<<<<<<<<<
  *         handle_unicode_errors="strict",
  *     ):
  */
     values[4] = ((PyObject *)((PyObject *)Py_False));
@@ -17841,15 +18064,15 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 6, 1); __PYX_ERR(0, 1075, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 6, 1); __PYX_ERR(0, 1087, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema);
           if (value) { values[2] = value; kw_args--; }
         }
@@ -17869,15 +18092,15 @@
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_handle_unicode_errors);
           if (value) { values[5] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1075, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 1087, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
@@ -17896,23 +18119,23 @@
     __pyx_v_reader_schema = values[2];
     __pyx_v_return_record_name = values[3];
     __pyx_v_return_record_name_override = values[4];
     __pyx_v_handle_unicode_errors = values[5];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1075, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1087, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.block_reader.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_8fastavro_5_read_12block_reader___init__(__pyx_self, __pyx_v_self, __pyx_v_fo, __pyx_v_reader_schema, __pyx_v_return_record_name, __pyx_v_return_record_name_override, __pyx_v_handle_unicode_errors);
 
-  /* "fastavro/_read.pyx":1075
+  /* "fastavro/_read.pyx":1087
  * 
  * class block_reader(file_reader):
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         fo,
  */
 
@@ -17938,67 +18161,67 @@
   PyObject *__pyx_t_11 = NULL;
   PyObject *__pyx_t_12 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "fastavro/_read.pyx":1084
+  /* "fastavro/_read.pyx":1096
  *     ):
  *         options = {
  *             "return_record_name": return_record_name,             # <<<<<<<<<<<<<<
  *             "return_record_name_override": return_record_name_override,
  *             "handle_unicode_errors": handle_unicode_errors,
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1084, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1096, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name, __pyx_v_return_record_name) < 0) __PYX_ERR(0, 1084, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name, __pyx_v_return_record_name) < 0) __PYX_ERR(0, 1096, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1085
+  /* "fastavro/_read.pyx":1097
  *         options = {
  *             "return_record_name": return_record_name,
  *             "return_record_name_override": return_record_name_override,             # <<<<<<<<<<<<<<
  *             "handle_unicode_errors": handle_unicode_errors,
  *         }
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name_override, __pyx_v_return_record_name_override) < 0) __PYX_ERR(0, 1084, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name_override, __pyx_v_return_record_name_override) < 0) __PYX_ERR(0, 1096, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1086
+  /* "fastavro/_read.pyx":1098
  *             "return_record_name": return_record_name,
  *             "return_record_name_override": return_record_name_override,
  *             "handle_unicode_errors": handle_unicode_errors,             # <<<<<<<<<<<<<<
  *         }
  *         super().__init__(fo, reader_schema, options)
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_handle_unicode_errors, __pyx_v_handle_unicode_errors) < 0) __PYX_ERR(0, 1084, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_handle_unicode_errors, __pyx_v_handle_unicode_errors) < 0) __PYX_ERR(0, 1096, __pyx_L1_error)
   __pyx_v_options = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":1088
+  /* "fastavro/_read.pyx":1100
  *             "handle_unicode_errors": handle_unicode_errors,
  *         }
  *         super().__init__(fo, reader_schema, options)             # <<<<<<<<<<<<<<
  * 
  *         self._elems = _iter_avro_blocks(self.fo,
  */
   __pyx_t_2 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_2) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1088, __pyx_L1_error) }
+  if (!__pyx_t_2) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 1100, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1100, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_self);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1088, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1100, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_init); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_init); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1100, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
@@ -18008,119 +18231,119 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_v_fo, __pyx_v_reader_schema, __pyx_v_options};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_2, __pyx_v_fo, __pyx_v_reader_schema, __pyx_v_options};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1088, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(3+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1100, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_2) {
       __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2); __pyx_t_2 = NULL;
     }
     __Pyx_INCREF(__pyx_v_fo);
     __Pyx_GIVEREF(__pyx_v_fo);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_fo);
     __Pyx_INCREF(__pyx_v_reader_schema);
     __Pyx_GIVEREF(__pyx_v_reader_schema);
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_reader_schema);
     __Pyx_INCREF(__pyx_v_options);
     __Pyx_GIVEREF(__pyx_v_options);
     PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_4, __pyx_v_options);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":1090
+  /* "fastavro/_read.pyx":1102
  *         super().__init__(fo, reader_schema, options)
  * 
  *         self._elems = _iter_avro_blocks(self.fo,             # <<<<<<<<<<<<<<
  *                                         self._header,
  *                                         self.codec,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_iter_avro_blocks); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1090, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_iter_avro_blocks); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1102, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_fo); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1090, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_fo); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1102, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
 
-  /* "fastavro/_read.pyx":1091
+  /* "fastavro/_read.pyx":1103
  * 
  *         self._elems = _iter_avro_blocks(self.fo,
  *                                         self._header,             # <<<<<<<<<<<<<<
  *                                         self.codec,
  *                                         self.writer_schema,
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_header_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1091, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_header_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "fastavro/_read.pyx":1092
+  /* "fastavro/_read.pyx":1104
  *         self._elems = _iter_avro_blocks(self.fo,
  *                                         self._header,
  *                                         self.codec,             # <<<<<<<<<<<<<<
  *                                         self.writer_schema,
  *                                         self._named_schemas,
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_codec); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1092, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_codec); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
 
-  /* "fastavro/_read.pyx":1093
+  /* "fastavro/_read.pyx":1105
  *                                         self._header,
  *                                         self.codec,
  *                                         self.writer_schema,             # <<<<<<<<<<<<<<
  *                                         self._named_schemas,
  *                                         self.reader_schema,
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_writer_schema); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1093, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_writer_schema); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1105, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
 
-  /* "fastavro/_read.pyx":1094
+  /* "fastavro/_read.pyx":1106
  *                                         self.codec,
  *                                         self.writer_schema,
  *                                         self._named_schemas,             # <<<<<<<<<<<<<<
  *                                         self.reader_schema,
  *                                         self.options)
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1094, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_named_schemas_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1106, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
 
-  /* "fastavro/_read.pyx":1095
+  /* "fastavro/_read.pyx":1107
  *                                         self.writer_schema,
  *                                         self._named_schemas,
  *                                         self.reader_schema,             # <<<<<<<<<<<<<<
  *                                         self.options)
  * 
  */
-  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reader_schema); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1095, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reader_schema); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
 
-  /* "fastavro/_read.pyx":1096
+  /* "fastavro/_read.pyx":1108
  *                                         self._named_schemas,
  *                                         self.reader_schema,
  *                                         self.options)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_options); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1096, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_options); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __pyx_t_11 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_11)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -18129,43 +18352,43 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[8] = {__pyx_t_11, __pyx_t_5, __pyx_t_2, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 7+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1090, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 7+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1102, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[8] = {__pyx_t_11, __pyx_t_5, __pyx_t_2, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 7+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1090, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_4, 7+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1102, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   } else
   #endif
   {
-    __pyx_t_12 = PyTuple_New(7+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1090, __pyx_L1_error)
+    __pyx_t_12 = PyTuple_New(7+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1102, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     if (__pyx_t_11) {
       __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_4, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_2);
@@ -18183,31 +18406,31 @@
     __pyx_t_5 = 0;
     __pyx_t_2 = 0;
     __pyx_t_6 = 0;
     __pyx_t_7 = 0;
     __pyx_t_8 = 0;
     __pyx_t_9 = 0;
     __pyx_t_10 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1090, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_12, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1102, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "fastavro/_read.pyx":1090
+  /* "fastavro/_read.pyx":1102
  *         super().__init__(fo, reader_schema, options)
  * 
  *         self._elems = _iter_avro_blocks(self.fo,             # <<<<<<<<<<<<<<
  *                                         self._header,
  *                                         self.codec,
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_elems, __pyx_t_1) < 0) __PYX_ERR(0, 1090, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_elems, __pyx_t_1) < 0) __PYX_ERR(0, 1102, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":1075
+  /* "fastavro/_read.pyx":1087
  * 
  * class block_reader(file_reader):
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         fo,
  */
 
@@ -18231,44 +18454,44 @@
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_options);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":1099
+/* "fastavro/_read.pyx":1111
  * 
  * 
  * cpdef schemaless_reader(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_87schemaless_reader(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_89schemaless_reader(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_schemaless_reader(PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8fastavro_5_read_schemaless_reader *__pyx_optional_args) {
 
-  /* "fastavro/_read.pyx":1102
+  /* "fastavro/_read.pyx":1114
  *     fo,
  *     writer_schema,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     return_record_name=False,
  *     return_record_name_override=False,
  */
   PyObject *__pyx_v_reader_schema = ((PyObject *)Py_None);
 
-  /* "fastavro/_read.pyx":1103
+  /* "fastavro/_read.pyx":1115
  *     writer_schema,
  *     reader_schema=None,
  *     return_record_name=False,             # <<<<<<<<<<<<<<
  *     return_record_name_override=False,
  *     handle_unicode_errors="strict",
  */
   PyObject *__pyx_v_return_record_name = ((PyObject *)Py_False);
 
-  /* "fastavro/_read.pyx":1104
+  /* "fastavro/_read.pyx":1116
  *     reader_schema=None,
  *     return_record_name=False,
  *     return_record_name_override=False,             # <<<<<<<<<<<<<<
  *     handle_unicode_errors="strict",
  * ):
  */
   PyObject *__pyx_v_return_record_name_override = ((PyObject *)Py_False);
@@ -18302,75 +18525,67 @@
         }
       }
     }
   }
   __Pyx_INCREF(__pyx_v_writer_schema);
   __Pyx_INCREF(__pyx_v_reader_schema);
 
-  /* "fastavro/_read.pyx":1107
+  /* "fastavro/_read.pyx":1119
  *     handle_unicode_errors="strict",
  * ):
  *     if writer_schema == reader_schema:             # <<<<<<<<<<<<<<
  *         # No need for the reader schema if they are the same
  *         reader_schema = None
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_writer_schema, __pyx_v_reader_schema, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1107, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_writer_schema, __pyx_v_reader_schema, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1119, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1119, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "fastavro/_read.pyx":1109
+    /* "fastavro/_read.pyx":1121
  *     if writer_schema == reader_schema:
  *         # No need for the reader schema if they are the same
  *         reader_schema = None             # <<<<<<<<<<<<<<
  * 
- *     named_schemas = {"writer": {}, "reader": {}}
+ *     named_schemas = _default_named_schemas()
  */
     __Pyx_INCREF(Py_None);
     __Pyx_DECREF_SET(__pyx_v_reader_schema, Py_None);
 
-    /* "fastavro/_read.pyx":1107
+    /* "fastavro/_read.pyx":1119
  *     handle_unicode_errors="strict",
  * ):
  *     if writer_schema == reader_schema:             # <<<<<<<<<<<<<<
  *         # No need for the reader schema if they are the same
  *         reader_schema = None
  */
   }
 
-  /* "fastavro/_read.pyx":1111
+  /* "fastavro/_read.pyx":1123
  *         reader_schema = None
  * 
- *     named_schemas = {"writer": {}, "reader": {}}             # <<<<<<<<<<<<<<
+ *     named_schemas = _default_named_schemas()             # <<<<<<<<<<<<<<
  *     writer_schema = parse_schema(writer_schema, named_schemas["writer"])
  * 
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1111, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read__default_named_schemas(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1111, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_writer, __pyx_t_3) < 0) __PYX_ERR(0, 1111, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1111, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_reader, __pyx_t_3) < 0) __PYX_ERR(0, 1111, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_v_named_schemas = ((PyObject*)__pyx_t_1);
+  __pyx_v_named_schemas = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":1112
+  /* "fastavro/_read.pyx":1124
  * 
- *     named_schemas = {"writer": {}, "reader": {}}
+ *     named_schemas = _default_named_schemas()
  *     writer_schema = parse_schema(writer_schema, named_schemas["writer"])             # <<<<<<<<<<<<<<
  * 
  *     if reader_schema:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_parse_schema); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1112, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_parse_schema); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyDict_GetItem(__pyx_v_named_schemas, __pyx_n_u_writer); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1112, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_writer); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   __pyx_t_6 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -18379,69 +18594,69 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_6 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_writer_schema, __pyx_t_4};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1112, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_writer_schema, __pyx_t_4};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1112, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   {
-    __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1112, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     if (__pyx_t_5) {
       __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
     }
     __Pyx_INCREF(__pyx_v_writer_schema);
     __Pyx_GIVEREF(__pyx_v_writer_schema);
     PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_writer_schema);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_4);
     __pyx_t_4 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1112, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1124, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_writer_schema, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":1114
+  /* "fastavro/_read.pyx":1126
  *     writer_schema = parse_schema(writer_schema, named_schemas["writer"])
  * 
  *     if reader_schema:             # <<<<<<<<<<<<<<
  *         reader_schema = parse_schema(reader_schema, named_schemas["reader"])
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1114, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_reader_schema); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1126, __pyx_L1_error)
   if (__pyx_t_2) {
 
-    /* "fastavro/_read.pyx":1115
+    /* "fastavro/_read.pyx":1127
  * 
  *     if reader_schema:
  *         reader_schema = parse_schema(reader_schema, named_schemas["reader"])             # <<<<<<<<<<<<<<
  * 
  *     options = {
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_parse_schema); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1115, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_parse_schema); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1127, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_7 = __Pyx_PyDict_GetItem(__pyx_v_named_schemas, __pyx_n_u_reader); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1115, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Dict_GetItem(__pyx_v_named_schemas, __pyx_n_u_reader); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1127, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_4 = NULL;
     __pyx_t_6 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -18450,115 +18665,115 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_6 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_reader_schema, __pyx_t_7};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1127, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_reader_schema, __pyx_t_7};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1127, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_5 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1115, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1127, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       if (__pyx_t_4) {
         __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
       }
       __Pyx_INCREF(__pyx_v_reader_schema);
       __Pyx_GIVEREF(__pyx_v_reader_schema);
       PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_6, __pyx_v_reader_schema);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_6, __pyx_t_7);
       __pyx_t_7 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1127, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF_SET(__pyx_v_reader_schema, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastavro/_read.pyx":1114
+    /* "fastavro/_read.pyx":1126
  *     writer_schema = parse_schema(writer_schema, named_schemas["writer"])
  * 
  *     if reader_schema:             # <<<<<<<<<<<<<<
  *         reader_schema = parse_schema(reader_schema, named_schemas["reader"])
  * 
  */
   }
 
-  /* "fastavro/_read.pyx":1118
+  /* "fastavro/_read.pyx":1130
  * 
  *     options = {
  *         "return_record_name": return_record_name,             # <<<<<<<<<<<<<<
  *         "return_record_name_override": return_record_name_override,
  *         "handle_unicode_errors": handle_unicode_errors,
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1118, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1130, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name, __pyx_v_return_record_name) < 0) __PYX_ERR(0, 1118, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name, __pyx_v_return_record_name) < 0) __PYX_ERR(0, 1130, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1119
+  /* "fastavro/_read.pyx":1131
  *     options = {
  *         "return_record_name": return_record_name,
  *         "return_record_name_override": return_record_name_override,             # <<<<<<<<<<<<<<
  *         "handle_unicode_errors": handle_unicode_errors,
  *     }
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name_override, __pyx_v_return_record_name_override) < 0) __PYX_ERR(0, 1118, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_return_record_name_override, __pyx_v_return_record_name_override) < 0) __PYX_ERR(0, 1130, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1120
+  /* "fastavro/_read.pyx":1132
  *         "return_record_name": return_record_name,
  *         "return_record_name_override": return_record_name_override,
  *         "handle_unicode_errors": handle_unicode_errors,             # <<<<<<<<<<<<<<
  *     }
  *     return _read_data(
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_handle_unicode_errors, __pyx_v_handle_unicode_errors) < 0) __PYX_ERR(0, 1118, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_u_handle_unicode_errors, __pyx_v_handle_unicode_errors) < 0) __PYX_ERR(0, 1130, __pyx_L1_error)
   __pyx_v_options = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":1122
+  /* "fastavro/_read.pyx":1134
  *         "handle_unicode_errors": handle_unicode_errors,
  *     }
  *     return _read_data(             # <<<<<<<<<<<<<<
  *         fo,
  *         writer_schema,
  */
   __Pyx_XDECREF(__pyx_r);
 
-  /* "fastavro/_read.pyx":1127
+  /* "fastavro/_read.pyx":1139
  *         named_schemas,
  *         reader_schema,
  *         options,             # <<<<<<<<<<<<<<
  *     )
  * 
  */
   __pyx_t_8.__pyx_n = 2;
   __pyx_t_8.reader_schema = __pyx_v_reader_schema;
   __pyx_t_8.options = __pyx_v_options;
-  __pyx_t_1 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1122, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read__read_data(__pyx_v_fo, __pyx_v_writer_schema, __pyx_v_named_schemas, 0, &__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1134, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "fastavro/_read.pyx":1099
+  /* "fastavro/_read.pyx":1111
  * 
  * 
  * cpdef schemaless_reader(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
@@ -18578,16 +18793,16 @@
   __Pyx_XDECREF(__pyx_v_reader_schema);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_87schemaless_reader(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_87schemaless_reader(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_8fastavro_5_read_89schemaless_reader(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_89schemaless_reader(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_fo = 0;
   PyObject *__pyx_v_writer_schema = 0;
   PyObject *__pyx_v_reader_schema = 0;
   PyObject *__pyx_v_return_record_name = 0;
   PyObject *__pyx_v_return_record_name_override = 0;
   PyObject *__pyx_v_handle_unicode_errors = 0;
   int __pyx_lineno = 0;
@@ -18596,33 +18811,33 @@
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("schemaless_reader (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_fo,&__pyx_n_s_writer_schema,&__pyx_n_s_reader_schema,&__pyx_n_s_return_record_name,&__pyx_n_s_return_record_name_override,&__pyx_n_s_handle_unicode_errors,0};
     PyObject* values[6] = {0,0,0,0,0,0};
 
-    /* "fastavro/_read.pyx":1102
+    /* "fastavro/_read.pyx":1114
  *     fo,
  *     writer_schema,
  *     reader_schema=None,             # <<<<<<<<<<<<<<
  *     return_record_name=False,
  *     return_record_name_override=False,
  */
     values[2] = ((PyObject *)Py_None);
 
-    /* "fastavro/_read.pyx":1103
+    /* "fastavro/_read.pyx":1115
  *     writer_schema,
  *     reader_schema=None,
  *     return_record_name=False,             # <<<<<<<<<<<<<<
  *     return_record_name_override=False,
  *     handle_unicode_errors="strict",
  */
     values[3] = ((PyObject *)Py_False);
 
-    /* "fastavro/_read.pyx":1104
+    /* "fastavro/_read.pyx":1116
  *     reader_schema=None,
  *     return_record_name=False,
  *     return_record_name_override=False,             # <<<<<<<<<<<<<<
  *     handle_unicode_errors="strict",
  * ):
  */
     values[4] = ((PyObject *)Py_False);
@@ -18651,15 +18866,15 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fo)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_writer_schema)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("schemaless_reader", 0, 2, 6, 1); __PYX_ERR(0, 1099, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("schemaless_reader", 0, 2, 6, 1); __PYX_ERR(0, 1111, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reader_schema);
           if (value) { values[2] = value; kw_args--; }
         }
@@ -18679,15 +18894,15 @@
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_handle_unicode_errors);
           if (value) { values[5] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "schemaless_reader") < 0)) __PYX_ERR(0, 1099, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "schemaless_reader") < 0)) __PYX_ERR(0, 1111, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
@@ -18706,51 +18921,51 @@
     __pyx_v_reader_schema = values[2];
     __pyx_v_return_record_name = values[3];
     __pyx_v_return_record_name_override = values[4];
     __pyx_v_handle_unicode_errors = values[5];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("schemaless_reader", 0, 2, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1099, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("schemaless_reader", 0, 2, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1111, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastavro._read.schemaless_reader", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_8fastavro_5_read_86schemaless_reader(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_reader_schema, __pyx_v_return_record_name, __pyx_v_return_record_name_override, __pyx_v_handle_unicode_errors);
+  __pyx_r = __pyx_pf_8fastavro_5_read_88schemaless_reader(__pyx_self, __pyx_v_fo, __pyx_v_writer_schema, __pyx_v_reader_schema, __pyx_v_return_record_name, __pyx_v_return_record_name_override, __pyx_v_handle_unicode_errors);
 
-  /* "fastavro/_read.pyx":1099
+  /* "fastavro/_read.pyx":1111
  * 
  * 
  * cpdef schemaless_reader(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_86schemaless_reader(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_return_record_name, PyObject *__pyx_v_return_record_name_override, PyObject *__pyx_v_handle_unicode_errors) {
+static PyObject *__pyx_pf_8fastavro_5_read_88schemaless_reader(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_fo, PyObject *__pyx_v_writer_schema, PyObject *__pyx_v_reader_schema, PyObject *__pyx_v_return_record_name, PyObject *__pyx_v_return_record_name_override, PyObject *__pyx_v_handle_unicode_errors) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   struct __pyx_opt_args_8fastavro_5_read_schemaless_reader __pyx_t_2;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("schemaless_reader", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 4;
   __pyx_t_2.reader_schema = __pyx_v_reader_schema;
   __pyx_t_2.return_record_name = __pyx_v_return_record_name;
   __pyx_t_2.return_record_name_override = __pyx_v_return_record_name_override;
   __pyx_t_2.handle_unicode_errors = __pyx_v_handle_unicode_errors;
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_schemaless_reader(__pyx_v_fo, __pyx_v_writer_schema, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_schemaless_reader(__pyx_v_fo, __pyx_v_writer_schema, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1111, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -18759,23 +18974,23 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastavro/_read.pyx":1131
+/* "fastavro/_read.pyx":1143
  * 
  * 
  * cpdef is_avro(path_or_buffer):             # <<<<<<<<<<<<<<
  *     if isinstance(path_or_buffer, str):
  *         fp = open(path_or_buffer, "rb")
  */
 
-static PyObject *__pyx_pw_8fastavro_5_read_89is_avro(PyObject *__pyx_self, PyObject *__pyx_v_path_or_buffer); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_91is_avro(PyObject *__pyx_self, PyObject *__pyx_v_path_or_buffer); /*proto*/
 static PyObject *__pyx_f_8fastavro_5_read_is_avro(PyObject *__pyx_v_path_or_buffer, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_v_fp = NULL;
   int __pyx_v_close;
   PyObject *__pyx_v_header = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
@@ -18795,148 +19010,148 @@
   PyObject *__pyx_t_15 = NULL;
   PyObject *__pyx_t_16 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_avro", 0);
 
-  /* "fastavro/_read.pyx":1132
+  /* "fastavro/_read.pyx":1144
  * 
  * cpdef is_avro(path_or_buffer):
  *     if isinstance(path_or_buffer, str):             # <<<<<<<<<<<<<<
  *         fp = open(path_or_buffer, "rb")
  *         close = True
  */
   __pyx_t_1 = PyUnicode_Check(__pyx_v_path_or_buffer); 
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "fastavro/_read.pyx":1133
+    /* "fastavro/_read.pyx":1145
  * cpdef is_avro(path_or_buffer):
  *     if isinstance(path_or_buffer, str):
  *         fp = open(path_or_buffer, "rb")             # <<<<<<<<<<<<<<
  *         close = True
  *     else:
  */
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1133, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1145, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_path_or_buffer);
     __Pyx_GIVEREF(__pyx_v_path_or_buffer);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_path_or_buffer);
     __Pyx_INCREF(__pyx_n_u_rb);
     __Pyx_GIVEREF(__pyx_n_u_rb);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_n_u_rb);
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1133, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_open, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1145, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_fp = __pyx_t_4;
     __pyx_t_4 = 0;
 
-    /* "fastavro/_read.pyx":1134
+    /* "fastavro/_read.pyx":1146
  *     if isinstance(path_or_buffer, str):
  *         fp = open(path_or_buffer, "rb")
  *         close = True             # <<<<<<<<<<<<<<
  *     else:
  *         fp = path_or_buffer
  */
     __pyx_v_close = 1;
 
-    /* "fastavro/_read.pyx":1132
+    /* "fastavro/_read.pyx":1144
  * 
  * cpdef is_avro(path_or_buffer):
  *     if isinstance(path_or_buffer, str):             # <<<<<<<<<<<<<<
  *         fp = open(path_or_buffer, "rb")
  *         close = True
  */
     goto __pyx_L3;
   }
 
-  /* "fastavro/_read.pyx":1136
+  /* "fastavro/_read.pyx":1148
  *         close = True
  *     else:
  *         fp = path_or_buffer             # <<<<<<<<<<<<<<
  *         close = False
  * 
  */
   /*else*/ {
     __Pyx_INCREF(__pyx_v_path_or_buffer);
     __pyx_v_fp = __pyx_v_path_or_buffer;
 
-    /* "fastavro/_read.pyx":1137
+    /* "fastavro/_read.pyx":1149
  *     else:
  *         fp = path_or_buffer
  *         close = False             # <<<<<<<<<<<<<<
  * 
  *     try:
  */
     __pyx_v_close = 0;
   }
   __pyx_L3:;
 
-  /* "fastavro/_read.pyx":1139
+  /* "fastavro/_read.pyx":1151
  *         close = False
  * 
  *     try:             # <<<<<<<<<<<<<<
  *         header = fp.read(len(MAGIC))
  *         return header == MAGIC
  */
   /*try:*/ {
 
-    /* "fastavro/_read.pyx":1140
+    /* "fastavro/_read.pyx":1152
  * 
  *     try:
  *         header = fp.read(len(MAGIC))             # <<<<<<<<<<<<<<
  *         return header == MAGIC
  *     finally:
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fp, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1140, __pyx_L5_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_fp, __pyx_n_s_read); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1152, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_MAGIC); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1140, __pyx_L5_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_MAGIC); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1152, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyObject_Length(__pyx_t_5); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1140, __pyx_L5_error)
+    __pyx_t_6 = PyObject_Length(__pyx_t_5); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1152, __pyx_L5_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1140, __pyx_L5_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1152, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_7, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1140, __pyx_L5_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1152, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_header = __pyx_t_4;
     __pyx_t_4 = 0;
 
-    /* "fastavro/_read.pyx":1141
+    /* "fastavro/_read.pyx":1153
  *     try:
  *         header = fp.read(len(MAGIC))
  *         return header == MAGIC             # <<<<<<<<<<<<<<
  *     finally:
  *         if close:
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_MAGIC); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1141, __pyx_L5_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_MAGIC); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1153, __pyx_L5_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_header, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1141, __pyx_L5_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_v_header, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1153, __pyx_L5_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L4_return;
   }
 
-  /* "fastavro/_read.pyx":1143
+  /* "fastavro/_read.pyx":1155
  *         return header == MAGIC
  *     finally:
  *         if close:             # <<<<<<<<<<<<<<
  *             fp.close()
  */
   /*finally:*/ {
     __pyx_L5_error:;
@@ -18957,39 +19172,39 @@
       __Pyx_XGOTREF(__pyx_t_15);
       __Pyx_XGOTREF(__pyx_t_16);
       __pyx_t_8 = __pyx_lineno; __pyx_t_9 = __pyx_clineno; __pyx_t_10 = __pyx_filename;
       {
         __pyx_t_2 = (__pyx_v_close != 0);
         if (__pyx_t_2) {
 
-          /* "fastavro/_read.pyx":1144
+          /* "fastavro/_read.pyx":1156
  *     finally:
  *         if close:
  *             fp.close()             # <<<<<<<<<<<<<<
  */
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fp, __pyx_n_s_close); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1144, __pyx_L8_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fp, __pyx_n_s_close); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1156, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_4);
           __pyx_t_5 = NULL;
           if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
             if (likely(__pyx_t_5)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
               __Pyx_INCREF(__pyx_t_5);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_4, function);
             }
           }
           __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1144, __pyx_L8_error)
+          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1156, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-          /* "fastavro/_read.pyx":1143
+          /* "fastavro/_read.pyx":1155
  *         return header == MAGIC
  *     finally:
  *         if close:             # <<<<<<<<<<<<<<
  *             fp.close()
  */
         }
       }
@@ -19021,52 +19236,52 @@
     }
     __pyx_L4_return: {
       __pyx_t_16 = __pyx_r;
       __pyx_r = 0;
       __pyx_t_2 = (__pyx_v_close != 0);
       if (__pyx_t_2) {
 
-        /* "fastavro/_read.pyx":1144
+        /* "fastavro/_read.pyx":1156
  *     finally:
  *         if close:
  *             fp.close()             # <<<<<<<<<<<<<<
  */
-        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fp, __pyx_n_s_close); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1144, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fp, __pyx_n_s_close); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1156, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __pyx_t_5 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_5)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
             __Pyx_INCREF(__pyx_t_5);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_4, function);
           }
         }
         __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1144, __pyx_L1_error)
+        if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1156, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-        /* "fastavro/_read.pyx":1143
+        /* "fastavro/_read.pyx":1155
  *         return header == MAGIC
  *     finally:
  *         if close:             # <<<<<<<<<<<<<<
  *             fp.close()
  */
       }
       __pyx_r = __pyx_t_16;
       __pyx_t_16 = 0;
       goto __pyx_L0;
     }
   }
 
-  /* "fastavro/_read.pyx":1131
+  /* "fastavro/_read.pyx":1143
  * 
  * 
  * cpdef is_avro(path_or_buffer):             # <<<<<<<<<<<<<<
  *     if isinstance(path_or_buffer, str):
  *         fp = open(path_or_buffer, "rb")
  */
 
@@ -19083,36 +19298,36 @@
   __Pyx_XDECREF(__pyx_v_header);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
-static PyObject *__pyx_pw_8fastavro_5_read_89is_avro(PyObject *__pyx_self, PyObject *__pyx_v_path_or_buffer); /*proto*/
-static PyObject *__pyx_pw_8fastavro_5_read_89is_avro(PyObject *__pyx_self, PyObject *__pyx_v_path_or_buffer) {
+static PyObject *__pyx_pw_8fastavro_5_read_91is_avro(PyObject *__pyx_self, PyObject *__pyx_v_path_or_buffer); /*proto*/
+static PyObject *__pyx_pw_8fastavro_5_read_91is_avro(PyObject *__pyx_self, PyObject *__pyx_v_path_or_buffer) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("is_avro (wrapper)", 0);
-  __pyx_r = __pyx_pf_8fastavro_5_read_88is_avro(__pyx_self, ((PyObject *)__pyx_v_path_or_buffer));
+  __pyx_r = __pyx_pf_8fastavro_5_read_90is_avro(__pyx_self, ((PyObject *)__pyx_v_path_or_buffer));
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_8fastavro_5_read_88is_avro(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_path_or_buffer) {
+static PyObject *__pyx_pf_8fastavro_5_read_90is_avro(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_path_or_buffer) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("is_avro", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_8fastavro_5_read_is_avro(__pyx_v_path_or_buffer, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1131, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_8fastavro_5_read_is_avro(__pyx_v_path_or_buffer, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1143, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -19537,56 +19752,57 @@
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
   0, /*tp_pypy_flags*/
   #endif
 };
 
 static PyMethodDef __pyx_methods[] = {
-  {"match_types", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_1match_types, METH_VARARGS|METH_KEYWORDS, 0},
-  {"match_schemas", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_3match_schemas, METH_VARARGS|METH_KEYWORDS, 0},
-  {"read_null", (PyCFunction)__pyx_pw_8fastavro_5_read_5read_null, METH_O, __pyx_doc_8fastavro_5_read_4read_null},
-  {"skip_null", (PyCFunction)__pyx_pw_8fastavro_5_read_7skip_null, METH_O, __pyx_doc_8fastavro_5_read_6skip_null},
-  {"read_boolean", (PyCFunction)__pyx_pw_8fastavro_5_read_9read_boolean, METH_O, __pyx_doc_8fastavro_5_read_8read_boolean},
-  {"skip_boolean", (PyCFunction)__pyx_pw_8fastavro_5_read_11skip_boolean, METH_O, __pyx_doc_8fastavro_5_read_10skip_boolean},
-  {"read_long", (PyCFunction)__pyx_pw_8fastavro_5_read_13read_long, METH_O, __pyx_doc_8fastavro_5_read_12read_long},
-  {"skip_long", (PyCFunction)__pyx_pw_8fastavro_5_read_15skip_long, METH_O, __pyx_doc_8fastavro_5_read_14skip_long},
-  {"skip_int", (PyCFunction)__pyx_pw_8fastavro_5_read_17skip_int, METH_O, 0},
-  {"read_float", (PyCFunction)__pyx_pw_8fastavro_5_read_19read_float, METH_O, __pyx_doc_8fastavro_5_read_18read_float},
-  {"skip_float", (PyCFunction)__pyx_pw_8fastavro_5_read_21skip_float, METH_O, __pyx_doc_8fastavro_5_read_20skip_float},
-  {"read_double", (PyCFunction)__pyx_pw_8fastavro_5_read_23read_double, METH_O, __pyx_doc_8fastavro_5_read_22read_double},
-  {"skip_double", (PyCFunction)__pyx_pw_8fastavro_5_read_25skip_double, METH_O, __pyx_doc_8fastavro_5_read_24skip_double},
-  {"read_bytes", (PyCFunction)__pyx_pw_8fastavro_5_read_27read_bytes, METH_O, __pyx_doc_8fastavro_5_read_26read_bytes},
-  {"skip_bytes", (PyCFunction)__pyx_pw_8fastavro_5_read_29skip_bytes, METH_O, __pyx_doc_8fastavro_5_read_28skip_bytes},
-  {"read_utf8", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_31read_utf8, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_30read_utf8},
-  {"skip_utf8", (PyCFunction)__pyx_pw_8fastavro_5_read_33skip_utf8, METH_O, __pyx_doc_8fastavro_5_read_32skip_utf8},
-  {"read_fixed", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_35read_fixed, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_34read_fixed},
-  {"skip_fixed", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_37skip_fixed, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_36skip_fixed},
-  {"read_enum", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_39read_enum, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_38read_enum},
-  {"skip_enum", (PyCFunction)__pyx_pw_8fastavro_5_read_41skip_enum, METH_O, __pyx_doc_8fastavro_5_read_40skip_enum},
-  {"read_array", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_43read_array, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_42read_array},
-  {"skip_array", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_45skip_array, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_44skip_array},
-  {"read_map", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_47read_map, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_46read_map},
-  {"skip_map", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_49skip_map, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_48skip_map},
-  {"read_union", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_51read_union, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_50read_union},
-  {"skip_union", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_53skip_union, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_52skip_union},
-  {"read_record", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_55read_record, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_54read_record},
-  {"skip_record", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_57skip_record, METH_VARARGS|METH_KEYWORDS, 0},
-  {"maybe_promote", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_59maybe_promote, METH_VARARGS|METH_KEYWORDS, 0},
-  {"_read_data", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_61_read_data, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_60_read_data},
-  {"_skip_data", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_63_skip_data, METH_VARARGS|METH_KEYWORDS, 0},
-  {"skip_sync", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_65skip_sync, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_64skip_sync},
-  {"null_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_67null_read_block, METH_O, __pyx_doc_8fastavro_5_read_66null_read_block},
-  {"deflate_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_69deflate_read_block, METH_O, __pyx_doc_8fastavro_5_read_68deflate_read_block},
-  {"bzip2_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_71bzip2_read_block, METH_O, __pyx_doc_8fastavro_5_read_70bzip2_read_block},
-  {"xz_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_73xz_read_block, METH_O, 0},
-  {"snappy_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_75snappy_read_block, METH_O, 0},
-  {"zstandard_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_77zstandard_read_block, METH_O, 0},
-  {"lz4_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_79lz4_read_block, METH_O, 0},
-  {"schemaless_reader", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_87schemaless_reader, METH_VARARGS|METH_KEYWORDS, 0},
-  {"is_avro", (PyCFunction)__pyx_pw_8fastavro_5_read_89is_avro, METH_O, 0},
+  {"_default_named_schemas", (PyCFunction)__pyx_pw_8fastavro_5_read_1_default_named_schemas, METH_NOARGS, 0},
+  {"match_types", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_3match_types, METH_VARARGS|METH_KEYWORDS, 0},
+  {"match_schemas", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_5match_schemas, METH_VARARGS|METH_KEYWORDS, 0},
+  {"read_null", (PyCFunction)__pyx_pw_8fastavro_5_read_7read_null, METH_O, __pyx_doc_8fastavro_5_read_6read_null},
+  {"skip_null", (PyCFunction)__pyx_pw_8fastavro_5_read_9skip_null, METH_O, __pyx_doc_8fastavro_5_read_8skip_null},
+  {"read_boolean", (PyCFunction)__pyx_pw_8fastavro_5_read_11read_boolean, METH_O, __pyx_doc_8fastavro_5_read_10read_boolean},
+  {"skip_boolean", (PyCFunction)__pyx_pw_8fastavro_5_read_13skip_boolean, METH_O, __pyx_doc_8fastavro_5_read_12skip_boolean},
+  {"read_long", (PyCFunction)__pyx_pw_8fastavro_5_read_15read_long, METH_O, __pyx_doc_8fastavro_5_read_14read_long},
+  {"skip_long", (PyCFunction)__pyx_pw_8fastavro_5_read_17skip_long, METH_O, __pyx_doc_8fastavro_5_read_16skip_long},
+  {"skip_int", (PyCFunction)__pyx_pw_8fastavro_5_read_19skip_int, METH_O, 0},
+  {"read_float", (PyCFunction)__pyx_pw_8fastavro_5_read_21read_float, METH_O, __pyx_doc_8fastavro_5_read_20read_float},
+  {"skip_float", (PyCFunction)__pyx_pw_8fastavro_5_read_23skip_float, METH_O, __pyx_doc_8fastavro_5_read_22skip_float},
+  {"read_double", (PyCFunction)__pyx_pw_8fastavro_5_read_25read_double, METH_O, __pyx_doc_8fastavro_5_read_24read_double},
+  {"skip_double", (PyCFunction)__pyx_pw_8fastavro_5_read_27skip_double, METH_O, __pyx_doc_8fastavro_5_read_26skip_double},
+  {"read_bytes", (PyCFunction)__pyx_pw_8fastavro_5_read_29read_bytes, METH_O, __pyx_doc_8fastavro_5_read_28read_bytes},
+  {"skip_bytes", (PyCFunction)__pyx_pw_8fastavro_5_read_31skip_bytes, METH_O, __pyx_doc_8fastavro_5_read_30skip_bytes},
+  {"read_utf8", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_33read_utf8, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_32read_utf8},
+  {"skip_utf8", (PyCFunction)__pyx_pw_8fastavro_5_read_35skip_utf8, METH_O, __pyx_doc_8fastavro_5_read_34skip_utf8},
+  {"read_fixed", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_37read_fixed, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_36read_fixed},
+  {"skip_fixed", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_39skip_fixed, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_38skip_fixed},
+  {"read_enum", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_41read_enum, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_40read_enum},
+  {"skip_enum", (PyCFunction)__pyx_pw_8fastavro_5_read_43skip_enum, METH_O, __pyx_doc_8fastavro_5_read_42skip_enum},
+  {"read_array", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_45read_array, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_44read_array},
+  {"skip_array", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_47skip_array, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_46skip_array},
+  {"read_map", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_49read_map, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_48read_map},
+  {"skip_map", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_51skip_map, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_50skip_map},
+  {"read_union", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_53read_union, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_52read_union},
+  {"skip_union", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_55skip_union, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_54skip_union},
+  {"read_record", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_57read_record, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_56read_record},
+  {"skip_record", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_59skip_record, METH_VARARGS|METH_KEYWORDS, 0},
+  {"maybe_promote", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_61maybe_promote, METH_VARARGS|METH_KEYWORDS, 0},
+  {"_read_data", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_63_read_data, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_62_read_data},
+  {"_skip_data", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_65_skip_data, METH_VARARGS|METH_KEYWORDS, 0},
+  {"skip_sync", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_67skip_sync, METH_VARARGS|METH_KEYWORDS, __pyx_doc_8fastavro_5_read_66skip_sync},
+  {"null_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_69null_read_block, METH_O, __pyx_doc_8fastavro_5_read_68null_read_block},
+  {"deflate_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_71deflate_read_block, METH_O, __pyx_doc_8fastavro_5_read_70deflate_read_block},
+  {"bzip2_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_73bzip2_read_block, METH_O, __pyx_doc_8fastavro_5_read_72bzip2_read_block},
+  {"xz_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_75xz_read_block, METH_O, 0},
+  {"snappy_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_77snappy_read_block, METH_O, 0},
+  {"zstandard_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_79zstandard_read_block, METH_O, 0},
+  {"lz4_read_block", (PyCFunction)__pyx_pw_8fastavro_5_read_81lz4_read_block, METH_O, 0},
+  {"schemaless_reader", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_8fastavro_5_read_89schemaless_reader, METH_VARARGS|METH_KEYWORDS, 0},
+  {"is_avro", (PyCFunction)__pyx_pw_8fastavro_5_read_91is_avro, METH_O, 0},
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
 static int __pyx_pymod_exec__read(PyObject* module); /*proto*/
@@ -19838,267 +20054,267 @@
   {&__pyx_n_s_zstandard, __pyx_k_zstandard, sizeof(__pyx_k_zstandard), 0, 0, 1, 1},
   {&__pyx_n_u_zstandard, __pyx_k_zstandard, sizeof(__pyx_k_zstandard), 0, 1, 0, 1},
   {&__pyx_n_s_zstandard_read_block, __pyx_k_zstandard_read_block, sizeof(__pyx_k_zstandard_read_block), 0, 0, 1, 1},
   {&__pyx_n_s_zstd, __pyx_k_zstd, sizeof(__pyx_k_zstd), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(0, 847, __pyx_L1_error)
-  __pyx_builtin_property = __Pyx_GetBuiltinName(__pyx_n_s_property); if (!__pyx_builtin_property) __PYX_ERR(0, 1031, __pyx_L1_error)
-  __pyx_builtin_StopIteration = __Pyx_GetBuiltinName(__pyx_n_s_StopIteration); if (!__pyx_builtin_StopIteration) __PYX_ERR(0, 163, __pyx_L1_error)
-  __pyx_builtin_EOFError = __Pyx_GetBuiltinName(__pyx_n_s_EOFError); if (!__pyx_builtin_EOFError) __PYX_ERR(0, 274, __pyx_L1_error)
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 369, __pyx_L1_error)
-  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(0, 802, __pyx_L1_error)
-  __pyx_builtin_DeprecationWarning = __Pyx_GetBuiltinName(__pyx_n_s_DeprecationWarning); if (!__pyx_builtin_DeprecationWarning) __PYX_ERR(0, 1036, __pyx_L1_error)
-  __pyx_builtin_NotImplementedError = __Pyx_GetBuiltinName(__pyx_n_s_NotImplementedError); if (!__pyx_builtin_NotImplementedError) __PYX_ERR(0, 1042, __pyx_L1_error)
-  __pyx_builtin_super = __Pyx_GetBuiltinName(__pyx_n_s_super); if (!__pyx_builtin_super) __PYX_ERR(0, 1063, __pyx_L1_error)
-  __pyx_builtin_open = __Pyx_GetBuiltinName(__pyx_n_s_open); if (!__pyx_builtin_open) __PYX_ERR(0, 1133, __pyx_L1_error)
+  __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(0, 859, __pyx_L1_error)
+  __pyx_builtin_property = __Pyx_GetBuiltinName(__pyx_n_s_property); if (!__pyx_builtin_property) __PYX_ERR(0, 1043, __pyx_L1_error)
+  __pyx_builtin_StopIteration = __Pyx_GetBuiltinName(__pyx_n_s_StopIteration); if (!__pyx_builtin_StopIteration) __PYX_ERR(0, 171, __pyx_L1_error)
+  __pyx_builtin_EOFError = __Pyx_GetBuiltinName(__pyx_n_s_EOFError); if (!__pyx_builtin_EOFError) __PYX_ERR(0, 282, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 377, __pyx_L1_error)
+  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_builtin_DeprecationWarning = __Pyx_GetBuiltinName(__pyx_n_s_DeprecationWarning); if (!__pyx_builtin_DeprecationWarning) __PYX_ERR(0, 1048, __pyx_L1_error)
+  __pyx_builtin_NotImplementedError = __Pyx_GetBuiltinName(__pyx_n_s_NotImplementedError); if (!__pyx_builtin_NotImplementedError) __PYX_ERR(0, 1054, __pyx_L1_error)
+  __pyx_builtin_super = __Pyx_GetBuiltinName(__pyx_n_s_super); if (!__pyx_builtin_super) __PYX_ERR(0, 1075, __pyx_L1_error)
+  __pyx_builtin_open = __Pyx_GetBuiltinName(__pyx_n_s_open); if (!__pyx_builtin_open) __PYX_ERR(0, 1145, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "fastavro/_read.pyx":450
+  /* "fastavro/_read.pyx":458
  *         if reader_schema:
  *             for i in range(block_count):
  *                 key = read_utf8(fo, options.get("handle_unicode_errors", "strict"))             # <<<<<<<<<<<<<<
  *                 read_items[key] = _read_data(
  *                     fo,
  */
-  __pyx_tuple__4 = PyTuple_Pack(2, __pyx_n_u_handle_unicode_errors, __pyx_n_u_strict); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 450, __pyx_L1_error)
+  __pyx_tuple__4 = PyTuple_Pack(2, __pyx_n_u_handle_unicode_errors, __pyx_n_u_strict); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 458, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__4);
   __Pyx_GIVEREF(__pyx_tuple__4);
 
-  /* "fastavro/_read.pyx":802
+  /* "fastavro/_read.pyx":814
  *     """Skip an expected sync marker, complaining if it doesn't match"""
  *     if fo.read(SYNC_SIZE) != sync_marker:
  *         raise ValueError("expected sync marker not found")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_kp_u_expected_sync_marker_not_found); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_kp_u_expected_sync_marker_not_found); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__8);
   __Pyx_GIVEREF(__pyx_tuple__8);
 
-  /* "fastavro/_read.pyx":996
+  /* "fastavro/_read.pyx":1008
  *             self._header = _read_data(self.fo, HEADER_SCHEMA, {}, None, self.options)
  *         except (StopIteration, EOFError):
  *             raise ValueError("cannot read header - is it an avro file?")             # <<<<<<<<<<<<<<
  * 
  *         # `meta` values are bytes. So, the actual decoding has to be external.
  */
-  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_u_cannot_read_header_is_it_an_avro); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 996, __pyx_L1_error)
+  __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_u_cannot_read_header_is_it_an_avro); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 1008, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__13);
   __Pyx_GIVEREF(__pyx_tuple__13);
 
-  /* "fastavro/_read.pyx":1004
+  /* "fastavro/_read.pyx":1016
  * 
  *         self._schema = json.loads(self.metadata["avro.schema"])
  *         self.codec = self.metadata.get("avro.codec", "null")             # <<<<<<<<<<<<<<
  * 
- *         self._named_schemas = {"writer": {}, "reader": {}}
+ *         self._named_schemas = _default_named_schemas()
  */
-  __pyx_tuple__14 = PyTuple_Pack(2, __pyx_kp_u_avro_codec, __pyx_n_u_null); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 1004, __pyx_L1_error)
+  __pyx_tuple__14 = PyTuple_Pack(2, __pyx_kp_u_avro_codec, __pyx_n_u_null); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 1016, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__14);
   __Pyx_GIVEREF(__pyx_tuple__14);
 
-  /* "fastavro/_read.pyx":1034
+  /* "fastavro/_read.pyx":1046
  *     def schema(self):
  *         import warnings
  *         warnings.warn(             # <<<<<<<<<<<<<<
  *             "The 'schema' attribute is deprecated. Please use 'writer_schema'",
  *             DeprecationWarning,
  */
-  __pyx_tuple__15 = PyTuple_Pack(2, __pyx_kp_u_The_schema_attribute_is_deprecat, __pyx_builtin_DeprecationWarning); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 1034, __pyx_L1_error)
+  __pyx_tuple__15 = PyTuple_Pack(2, __pyx_kp_u_The_schema_attribute_is_deprecat, __pyx_builtin_DeprecationWarning); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 1046, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__15);
   __Pyx_GIVEREF(__pyx_tuple__15);
 
   /* "fastavro/_read.pyx":33
  * 
  * decimal_context = Context()
  * epoch = datetime(1970, 1, 1, tzinfo=timezone.utc)             # <<<<<<<<<<<<<<
  * epoch_naive = datetime(1970, 1, 1)
  * 
  */
   __pyx_tuple__16 = PyTuple_Pack(3, __pyx_int_1970, __pyx_int_1, __pyx_int_1); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 33, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__16);
   __Pyx_GIVEREF(__pyx_tuple__16);
 
-  /* "fastavro/_read.pyx":848
+  /* "fastavro/_read.pyx":860
  *     import snappy
  * except ImportError:
  *     BLOCK_READERS["snappy"] = missing_codec_lib("snappy", "python-snappy")             # <<<<<<<<<<<<<<
  * else:
  *     BLOCK_READERS["snappy"] = snappy_read_block
  */
-  __pyx_tuple__17 = PyTuple_Pack(2, __pyx_n_u_snappy, __pyx_kp_u_python_snappy); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 848, __pyx_L1_error)
+  __pyx_tuple__17 = PyTuple_Pack(2, __pyx_n_u_snappy, __pyx_kp_u_python_snappy); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 860, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__17);
   __Pyx_GIVEREF(__pyx_tuple__17);
 
-  /* "fastavro/_read.pyx":862
+  /* "fastavro/_read.pyx":874
  *     import zstandard as zstd
  * except ImportError:
  *     BLOCK_READERS["zstandard"] = missing_codec_lib("zstandard", "zstandard")             # <<<<<<<<<<<<<<
  * else:
  *     BLOCK_READERS["zstandard"] = zstandard_read_block
  */
-  __pyx_tuple__18 = PyTuple_Pack(2, __pyx_n_u_zstandard, __pyx_n_u_zstandard); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 862, __pyx_L1_error)
+  __pyx_tuple__18 = PyTuple_Pack(2, __pyx_n_u_zstandard, __pyx_n_u_zstandard); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 874, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__18);
   __Pyx_GIVEREF(__pyx_tuple__18);
 
-  /* "fastavro/_read.pyx":876
+  /* "fastavro/_read.pyx":888
  *     import lz4.block
  * except ImportError:
  *     BLOCK_READERS["lz4"] = missing_codec_lib("lz4", "lz4")             # <<<<<<<<<<<<<<
  * else:
  *     BLOCK_READERS["lz4"] = lz4_read_block
  */
-  __pyx_tuple__19 = PyTuple_Pack(2, __pyx_n_u_lz4, __pyx_n_u_lz4); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 876, __pyx_L1_error)
+  __pyx_tuple__19 = PyTuple_Pack(2, __pyx_n_u_lz4, __pyx_n_u_lz4); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 888, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__19);
   __Pyx_GIVEREF(__pyx_tuple__19);
 
-  /* "fastavro/_read.pyx":881
+  /* "fastavro/_read.pyx":893
  * 
  * 
  * def _iter_avro_records(             # <<<<<<<<<<<<<<
  *     fo,
  *     header,
  */
-  __pyx_tuple__20 = PyTuple_Pack(12, __pyx_n_s_fo, __pyx_n_s_header, __pyx_n_s_codec, __pyx_n_s_writer_schema, __pyx_n_s_named_schemas, __pyx_n_s_reader_schema, __pyx_n_s_options, __pyx_n_s_i, __pyx_n_s_sync_marker, __pyx_n_s_read_block, __pyx_n_s_block_count, __pyx_n_s_block_fo); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 881, __pyx_L1_error)
+  __pyx_tuple__20 = PyTuple_Pack(12, __pyx_n_s_fo, __pyx_n_s_header, __pyx_n_s_codec, __pyx_n_s_writer_schema, __pyx_n_s_named_schemas, __pyx_n_s_reader_schema, __pyx_n_s_options, __pyx_n_s_i, __pyx_n_s_sync_marker, __pyx_n_s_read_block, __pyx_n_s_block_count, __pyx_n_s_block_fo); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 893, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__20);
   __Pyx_GIVEREF(__pyx_tuple__20);
-  __pyx_codeobj__9 = (PyObject*)__Pyx_PyCode_New(7, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__20, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_iter_avro_records, 881, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 881, __pyx_L1_error)
+  __pyx_codeobj__9 = (PyObject*)__Pyx_PyCode_New(7, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__20, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_iter_avro_records, 893, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 893, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":915
+  /* "fastavro/_read.pyx":927
  * 
  * 
  * def _iter_avro_blocks(             # <<<<<<<<<<<<<<
  *     fo,
  *     header,
  */
-  __pyx_tuple__21 = PyTuple_Pack(13, __pyx_n_s_fo, __pyx_n_s_header, __pyx_n_s_codec, __pyx_n_s_writer_schema, __pyx_n_s_named_schemas, __pyx_n_s_reader_schema, __pyx_n_s_options, __pyx_n_s_sync_marker, __pyx_n_s_read_block, __pyx_n_s_offset, __pyx_n_s_num_block_records, __pyx_n_s_block_bytes, __pyx_n_s_size); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 915, __pyx_L1_error)
+  __pyx_tuple__21 = PyTuple_Pack(13, __pyx_n_s_fo, __pyx_n_s_header, __pyx_n_s_codec, __pyx_n_s_writer_schema, __pyx_n_s_named_schemas, __pyx_n_s_reader_schema, __pyx_n_s_options, __pyx_n_s_sync_marker, __pyx_n_s_read_block, __pyx_n_s_offset, __pyx_n_s_num_block_records, __pyx_n_s_block_bytes, __pyx_n_s_size); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 927, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__21);
   __Pyx_GIVEREF(__pyx_tuple__21);
-  __pyx_codeobj__10 = (PyObject*)__Pyx_PyCode_New(7, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_iter_avro_blocks, 915, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__10)) __PYX_ERR(0, 915, __pyx_L1_error)
+  __pyx_codeobj__10 = (PyObject*)__Pyx_PyCode_New(7, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_iter_avro_blocks, 927, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__10)) __PYX_ERR(0, 927, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":950
+  /* "fastavro/_read.pyx":962
  * 
  * class Block:
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         bytes_,
  */
-  __pyx_tuple__22 = PyTuple_Pack(10, __pyx_n_s_self, __pyx_n_s_bytes_2, __pyx_n_s_num_records, __pyx_n_s_codec, __pyx_n_s_reader_schema, __pyx_n_s_writer_schema, __pyx_n_s_named_schemas, __pyx_n_s_offset, __pyx_n_s_size, __pyx_n_s_options); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 950, __pyx_L1_error)
+  __pyx_tuple__22 = PyTuple_Pack(10, __pyx_n_s_self, __pyx_n_s_bytes_2, __pyx_n_s_num_records, __pyx_n_s_codec, __pyx_n_s_reader_schema, __pyx_n_s_writer_schema, __pyx_n_s_named_schemas, __pyx_n_s_offset, __pyx_n_s_size, __pyx_n_s_options); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 962, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__22);
   __Pyx_GIVEREF(__pyx_tuple__22);
-  __pyx_codeobj__23 = (PyObject*)__Pyx_PyCode_New(10, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__22, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_init, 950, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(0, 950, __pyx_L1_error)
+  __pyx_codeobj__23 = (PyObject*)__Pyx_PyCode_New(10, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__22, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_init, 962, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(0, 962, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":972
+  /* "fastavro/_read.pyx":984
  *         self.options = options
  * 
  *     def __iter__(self):             # <<<<<<<<<<<<<<
  *         for i in range(self.num_records):
  *             yield _read_data(
  */
-  __pyx_tuple__24 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_i); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 972, __pyx_L1_error)
+  __pyx_tuple__24 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_i); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 984, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__24);
   __Pyx_GIVEREF(__pyx_tuple__24);
-  __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_iter, 972, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 972, __pyx_L1_error)
+  __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_iter, 984, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 984, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":982
+  /* "fastavro/_read.pyx":994
  *             )
  * 
  *     def __str__(self):             # <<<<<<<<<<<<<<
  *         return (
  *             f"Avro block: {len(self.bytes_)} bytes, {self.num_records} records, "
  */
-  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 982, __pyx_L1_error)
+  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 994, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__25);
   __Pyx_GIVEREF(__pyx_tuple__25);
-  __pyx_codeobj__26 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_str, 982, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__26)) __PYX_ERR(0, 982, __pyx_L1_error)
+  __pyx_codeobj__26 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_str, 994, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__26)) __PYX_ERR(0, 994, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":990
+  /* "fastavro/_read.pyx":1002
  * 
  * class file_reader:
  *     def __init__(self, fo, reader_schema=None, options={}):             # <<<<<<<<<<<<<<
  *         self.fo = fo
  *         self.options = options
  */
-  __pyx_tuple__27 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_fo, __pyx_n_s_reader_schema, __pyx_n_s_options, __pyx_n_s_ignore_default_error_2, __pyx_n_s_k, __pyx_n_s_v); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 990, __pyx_L1_error)
+  __pyx_tuple__27 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_fo, __pyx_n_s_reader_schema, __pyx_n_s_options, __pyx_n_s_ignore_default_error_2, __pyx_n_s_k, __pyx_n_s_v); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 1002, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__27);
   __Pyx_GIVEREF(__pyx_tuple__27);
-  __pyx_codeobj__28 = (PyObject*)__Pyx_PyCode_New(4, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_init, 990, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 990, __pyx_L1_error)
+  __pyx_codeobj__28 = (PyObject*)__Pyx_PyCode_New(4, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_init, 1002, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 1002, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1032
+  /* "fastavro/_read.pyx":1044
  * 
  *     @property
  *     def schema(self):             # <<<<<<<<<<<<<<
  *         import warnings
  *         warnings.warn(
  */
-  __pyx_tuple__29 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_warnings); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 1032, __pyx_L1_error)
+  __pyx_tuple__29 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_warnings); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 1044, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__29);
   __Pyx_GIVEREF(__pyx_tuple__29);
-  __pyx_codeobj__30 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_schema_2, 1032, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 1032, __pyx_L1_error)
+  __pyx_codeobj__30 = (PyObject*)__Pyx_PyCode_New(1, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_schema_2, 1044, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 1044, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1040
+  /* "fastavro/_read.pyx":1052
  *         return self._schema
  * 
  *     def __iter__(self):             # <<<<<<<<<<<<<<
  *         if not self._elems:
  *             raise NotImplementedError
  */
-  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 1052, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__31);
   __Pyx_GIVEREF(__pyx_tuple__31);
-  __pyx_codeobj__32 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_iter, 1040, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_codeobj__32 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_iter, 1052, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 1052, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1045
+  /* "fastavro/_read.pyx":1057
  *         return self._elems
  * 
  *     def __next__(self):             # <<<<<<<<<<<<<<
  *         return next(self._elems)
  * 
  */
-  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 1045, __pyx_L1_error)
+  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_n_s_self); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 1057, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__33);
   __Pyx_GIVEREF(__pyx_tuple__33);
-  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_next, 1045, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 1045, __pyx_L1_error)
+  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_next, 1057, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 1057, __pyx_L1_error)
 
-  /* "fastavro/_read.pyx":1050
+  /* "fastavro/_read.pyx":1062
  * 
  * class reader(file_reader):
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         fo,
  */
-  __pyx_tuple__35 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_fo, __pyx_n_s_reader_schema, __pyx_n_s_return_record_name, __pyx_n_s_return_record_name_override, __pyx_n_s_handle_unicode_errors, __pyx_n_s_options); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 1050, __pyx_L1_error)
+  __pyx_tuple__35 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_fo, __pyx_n_s_reader_schema, __pyx_n_s_return_record_name, __pyx_n_s_return_record_name_override, __pyx_n_s_handle_unicode_errors, __pyx_n_s_options); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__35);
   __Pyx_GIVEREF(__pyx_tuple__35);
-  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(6, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_init, 1050, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 1050, __pyx_L1_error)
-  __pyx_tuple__37 = PyTuple_Pack(4, ((PyObject *)Py_None), ((PyObject *)Py_False), ((PyObject *)Py_False), ((PyObject*)__pyx_n_u_strict)); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 1050, __pyx_L1_error)
+  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(6, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_init, 1062, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_tuple__37 = PyTuple_Pack(4, ((PyObject *)Py_None), ((PyObject *)Py_False), ((PyObject *)Py_False), ((PyObject*)__pyx_n_u_strict)); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__37);
   __Pyx_GIVEREF(__pyx_tuple__37);
 
-  /* "fastavro/_read.pyx":1075
+  /* "fastavro/_read.pyx":1087
  * 
  * class block_reader(file_reader):
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         fo,
  */
-  __pyx_tuple__38 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_fo, __pyx_n_s_reader_schema, __pyx_n_s_return_record_name, __pyx_n_s_return_record_name_override, __pyx_n_s_handle_unicode_errors, __pyx_n_s_options); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 1075, __pyx_L1_error)
+  __pyx_tuple__38 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_fo, __pyx_n_s_reader_schema, __pyx_n_s_return_record_name, __pyx_n_s_return_record_name_override, __pyx_n_s_handle_unicode_errors, __pyx_n_s_options); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 1087, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__38);
   __Pyx_GIVEREF(__pyx_tuple__38);
-  __pyx_codeobj__39 = (PyObject*)__Pyx_PyCode_New(6, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_init, 1075, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 1075, __pyx_L1_error)
-  __pyx_tuple__40 = PyTuple_Pack(4, ((PyObject *)Py_None), ((PyObject *)Py_False), ((PyObject *)Py_False), ((PyObject*)__pyx_n_u_strict)); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 1075, __pyx_L1_error)
+  __pyx_codeobj__39 = (PyObject*)__Pyx_PyCode_New(6, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_fastavro__read_pyx, __pyx_n_s_init, 1087, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 1087, __pyx_L1_error)
+  __pyx_tuple__40 = PyTuple_Pack(4, ((PyObject *)Py_None), ((PyObject *)Py_False), ((PyObject *)Py_False), ((PyObject*)__pyx_n_u_strict)); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 1087, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__40);
   __Pyx_GIVEREF(__pyx_tuple__40);
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
@@ -20152,31 +20368,31 @@
 static int __Pyx_modinit_type_init_code(void) {
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
-  if (PyType_Ready(&__pyx_type_8fastavro_5_read___pyx_scope_struct___iter_avro_records) < 0) __PYX_ERR(0, 881, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_8fastavro_5_read___pyx_scope_struct___iter_avro_records) < 0) __PYX_ERR(0, 893, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_8fastavro_5_read___pyx_scope_struct___iter_avro_records.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8fastavro_5_read___pyx_scope_struct___iter_avro_records.tp_dictoffset && __pyx_type_8fastavro_5_read___pyx_scope_struct___iter_avro_records.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_8fastavro_5_read___pyx_scope_struct___iter_avro_records.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_8fastavro_5_read___pyx_scope_struct___iter_avro_records = &__pyx_type_8fastavro_5_read___pyx_scope_struct___iter_avro_records;
-  if (PyType_Ready(&__pyx_type_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks) < 0) __PYX_ERR(0, 915, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks) < 0) __PYX_ERR(0, 927, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks.tp_dictoffset && __pyx_type_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks = &__pyx_type_8fastavro_5_read___pyx_scope_struct_1__iter_avro_blocks;
-  if (PyType_Ready(&__pyx_type_8fastavro_5_read___pyx_scope_struct_2___iter__) < 0) __PYX_ERR(0, 972, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_8fastavro_5_read___pyx_scope_struct_2___iter__) < 0) __PYX_ERR(0, 984, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_8fastavro_5_read___pyx_scope_struct_2___iter__.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_8fastavro_5_read___pyx_scope_struct_2___iter__.tp_dictoffset && __pyx_type_8fastavro_5_read___pyx_scope_struct_2___iter__.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_8fastavro_5_read___pyx_scope_struct_2___iter__.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   __pyx_ptype_8fastavro_5_read___pyx_scope_struct_2___iter__ = &__pyx_type_8fastavro_5_read___pyx_scope_struct_2___iter__;
@@ -20769,197 +20985,197 @@
   __Pyx_GOTREF(__pyx_t_3);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_ReadError, __pyx_t_3) < 0) __PYX_ERR(0, 42, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":342
+  /* "fastavro/_read.pyx":350
  *     named_schemas,
  *     reader_schema=None,
  *     options={},             # <<<<<<<<<<<<<<
  * ):
  *     """Arrays are encoded as a series of blocks.
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 342, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_k__2 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":337
+  /* "fastavro/_read.pyx":345
  * 
  * 
  * cpdef read_array(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 342, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_k__2 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":423
+  /* "fastavro/_read.pyx":431
  *     named_schemas,
  *     reader_schema=None,
  *     options={},             # <<<<<<<<<<<<<<
  * ):
  *     """Maps are encoded as a series of blocks.
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 423, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_k__3 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":418
+  /* "fastavro/_read.pyx":426
  * 
  * 
  * cpdef read_map(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 423, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_k__3 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":505
+  /* "fastavro/_read.pyx":513
  *     named_schemas,
  *     reader_schema=None,
  *     options={}             # <<<<<<<<<<<<<<
  * ):
  *     """A union is encoded by first writing a long value indicating the
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 505, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 513, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_k__5 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":500
+  /* "fastavro/_read.pyx":508
  * 
  * 
  * cpdef read_union(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 505, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 513, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_k__5 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":582
+  /* "fastavro/_read.pyx":590
  *     named_schemas,
  *     reader_schema=None,
  *     options={},             # <<<<<<<<<<<<<<
  * ):
  *     """A record is encoded by encoding the values of its fields in the order
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 582, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 590, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_k__6 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":577
+  /* "fastavro/_read.pyx":585
  * 
  * 
  * cpdef read_record(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 582, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 590, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_k__6 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":675
+  /* "fastavro/_read.pyx":683
  *     named_schemas,
  *     reader_schema=None,
  *     options={},             # <<<<<<<<<<<<<<
  * ):
  *     """Read data from file object according to schema."""
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 675, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 683, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_k__7 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":670
+  /* "fastavro/_read.pyx":678
  * 
  * 
  * cpdef _read_data(             # <<<<<<<<<<<<<<
  *     fo,
  *     writer_schema,
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 675, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 683, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_k__7 = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":831
+  /* "fastavro/_read.pyx":843
  * 
  * BLOCK_READERS = {
  *     "null": null_read_block,             # <<<<<<<<<<<<<<
  *     "deflate": deflate_read_block,
  *     "bzip2": bzip2_read_block,
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_null_read_block); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_null_read_block); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_null, __pyx_t_4) < 0) __PYX_ERR(0, 831, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_null, __pyx_t_4) < 0) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "fastavro/_read.pyx":832
+  /* "fastavro/_read.pyx":844
  * BLOCK_READERS = {
  *     "null": null_read_block,
  *     "deflate": deflate_read_block,             # <<<<<<<<<<<<<<
  *     "bzip2": bzip2_read_block,
  *     "xz": xz_read_block,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_deflate_read_block); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 832, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_deflate_read_block); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 844, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_deflate, __pyx_t_4) < 0) __PYX_ERR(0, 831, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_deflate, __pyx_t_4) < 0) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "fastavro/_read.pyx":833
+  /* "fastavro/_read.pyx":845
  *     "null": null_read_block,
  *     "deflate": deflate_read_block,
  *     "bzip2": bzip2_read_block,             # <<<<<<<<<<<<<<
  *     "xz": xz_read_block,
  * }
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_bzip2_read_block); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 833, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_bzip2_read_block); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 845, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_bzip2, __pyx_t_4) < 0) __PYX_ERR(0, 831, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_bzip2, __pyx_t_4) < 0) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "fastavro/_read.pyx":834
+  /* "fastavro/_read.pyx":846
  *     "deflate": deflate_read_block,
  *     "bzip2": bzip2_read_block,
  *     "xz": xz_read_block,             # <<<<<<<<<<<<<<
  * }
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_xz_read_block); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 834, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_xz_read_block); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 846, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_xz, __pyx_t_4) < 0) __PYX_ERR(0, 831, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_u_xz, __pyx_t_4) < 0) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_BLOCK_READERS, __pyx_t_2) < 0) __PYX_ERR(0, 830, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_BLOCK_READERS, __pyx_t_2) < 0) __PYX_ERR(0, 842, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":845
+  /* "fastavro/_read.pyx":857
  * 
  * 
  * try:             # <<<<<<<<<<<<<<
  *     import snappy
  * except ImportError:
  */
   {
@@ -20967,102 +21183,102 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7);
     __Pyx_XGOTREF(__pyx_t_5);
     __Pyx_XGOTREF(__pyx_t_6);
     __Pyx_XGOTREF(__pyx_t_7);
     /*try:*/ {
 
-      /* "fastavro/_read.pyx":846
+      /* "fastavro/_read.pyx":858
  * 
  * try:
  *     import snappy             # <<<<<<<<<<<<<<
  * except ImportError:
  *     BLOCK_READERS["snappy"] = missing_codec_lib("snappy", "python-snappy")
  */
-      __pyx_t_2 = __Pyx_Import(__pyx_n_s_snappy, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 846, __pyx_L2_error)
+      __pyx_t_2 = __Pyx_Import(__pyx_n_s_snappy, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 858, __pyx_L2_error)
       __Pyx_GOTREF(__pyx_t_2);
-      if (PyDict_SetItem(__pyx_d, __pyx_n_s_snappy, __pyx_t_2) < 0) __PYX_ERR(0, 846, __pyx_L2_error)
+      if (PyDict_SetItem(__pyx_d, __pyx_n_s_snappy, __pyx_t_2) < 0) __PYX_ERR(0, 858, __pyx_L2_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "fastavro/_read.pyx":845
+      /* "fastavro/_read.pyx":857
  * 
  * 
  * try:             # <<<<<<<<<<<<<<
  *     import snappy
  * except ImportError:
  */
     }
 
-    /* "fastavro/_read.pyx":850
+    /* "fastavro/_read.pyx":862
  *     BLOCK_READERS["snappy"] = missing_codec_lib("snappy", "python-snappy")
  * else:
  *     BLOCK_READERS["snappy"] = snappy_read_block             # <<<<<<<<<<<<<<
  * 
  * 
  */
     /*else:*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_snappy_read_block); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 850, __pyx_L4_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_snappy_read_block); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 862, __pyx_L4_except_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 850, __pyx_L4_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 862, __pyx_L4_except_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_n_u_snappy, __pyx_t_2) < 0)) __PYX_ERR(0, 850, __pyx_L4_except_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_n_u_snappy, __pyx_t_2) < 0)) __PYX_ERR(0, 862, __pyx_L4_except_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     goto __pyx_L7_try_end;
     __pyx_L2_error:;
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastavro/_read.pyx":847
+    /* "fastavro/_read.pyx":859
  * try:
  *     import snappy
  * except ImportError:             # <<<<<<<<<<<<<<
  *     BLOCK_READERS["snappy"] = missing_codec_lib("snappy", "python-snappy")
  * else:
  */
     __pyx_t_8 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_ImportError);
     if (__pyx_t_8) {
       __Pyx_AddTraceback("fastavro._read", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_4, &__pyx_t_1) < 0) __PYX_ERR(0, 847, __pyx_L4_except_error)
+      if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_4, &__pyx_t_1) < 0) __PYX_ERR(0, 859, __pyx_L4_except_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GOTREF(__pyx_t_1);
 
-      /* "fastavro/_read.pyx":848
+      /* "fastavro/_read.pyx":860
  *     import snappy
  * except ImportError:
  *     BLOCK_READERS["snappy"] = missing_codec_lib("snappy", "python-snappy")             # <<<<<<<<<<<<<<
  * else:
  *     BLOCK_READERS["snappy"] = snappy_read_block
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_missing_codec_lib); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 848, __pyx_L4_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_missing_codec_lib); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 860, __pyx_L4_except_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 848, __pyx_L4_except_error)
+      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 860, __pyx_L4_except_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 848, __pyx_L4_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 860, __pyx_L4_except_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_n_u_snappy, __pyx_t_9) < 0)) __PYX_ERR(0, 848, __pyx_L4_except_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_n_u_snappy, __pyx_t_9) < 0)) __PYX_ERR(0, 860, __pyx_L4_except_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       goto __pyx_L3_exception_handled;
     }
     goto __pyx_L4_except_error;
     __pyx_L4_except_error:;
 
-    /* "fastavro/_read.pyx":845
+    /* "fastavro/_read.pyx":857
  * 
  * 
  * try:             # <<<<<<<<<<<<<<
  *     import snappy
  * except ImportError:
  */
     __Pyx_XGIVEREF(__pyx_t_5);
@@ -21074,15 +21290,15 @@
     __Pyx_XGIVEREF(__pyx_t_5);
     __Pyx_XGIVEREF(__pyx_t_6);
     __Pyx_XGIVEREF(__pyx_t_7);
     __Pyx_ExceptionReset(__pyx_t_5, __pyx_t_6, __pyx_t_7);
     __pyx_L7_try_end:;
   }
 
-  /* "fastavro/_read.pyx":859
+  /* "fastavro/_read.pyx":871
  * 
  * 
  * try:             # <<<<<<<<<<<<<<
  *     import zstandard as zstd
  * except ImportError:
  */
   {
@@ -21090,103 +21306,103 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_7, &__pyx_t_6, &__pyx_t_5);
     __Pyx_XGOTREF(__pyx_t_7);
     __Pyx_XGOTREF(__pyx_t_6);
     __Pyx_XGOTREF(__pyx_t_5);
     /*try:*/ {
 
-      /* "fastavro/_read.pyx":860
+      /* "fastavro/_read.pyx":872
  * 
  * try:
  *     import zstandard as zstd             # <<<<<<<<<<<<<<
  * except ImportError:
  *     BLOCK_READERS["zstandard"] = missing_codec_lib("zstandard", "zstandard")
  */
-      __pyx_t_1 = __Pyx_Import(__pyx_n_s_zstandard, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 860, __pyx_L10_error)
+      __pyx_t_1 = __Pyx_Import(__pyx_n_s_zstandard, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L10_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (PyDict_SetItem(__pyx_d, __pyx_n_s_zstd, __pyx_t_1) < 0) __PYX_ERR(0, 860, __pyx_L10_error)
+      if (PyDict_SetItem(__pyx_d, __pyx_n_s_zstd, __pyx_t_1) < 0) __PYX_ERR(0, 872, __pyx_L10_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "fastavro/_read.pyx":859
+      /* "fastavro/_read.pyx":871
  * 
  * 
  * try:             # <<<<<<<<<<<<<<
  *     import zstandard as zstd
  * except ImportError:
  */
     }
 
-    /* "fastavro/_read.pyx":864
+    /* "fastavro/_read.pyx":876
  *     BLOCK_READERS["zstandard"] = missing_codec_lib("zstandard", "zstandard")
  * else:
  *     BLOCK_READERS["zstandard"] = zstandard_read_block             # <<<<<<<<<<<<<<
  * 
  * 
  */
     /*else:*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_zstandard_read_block); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 864, __pyx_L12_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_zstandard_read_block); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L12_except_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 864, __pyx_L12_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 876, __pyx_L12_except_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_n_u_zstandard, __pyx_t_1) < 0)) __PYX_ERR(0, 864, __pyx_L12_except_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_n_u_zstandard, __pyx_t_1) < 0)) __PYX_ERR(0, 876, __pyx_L12_except_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     goto __pyx_L15_try_end;
     __pyx_L10_error:;
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "fastavro/_read.pyx":861
+    /* "fastavro/_read.pyx":873
  * try:
  *     import zstandard as zstd
  * except ImportError:             # <<<<<<<<<<<<<<
  *     BLOCK_READERS["zstandard"] = missing_codec_lib("zstandard", "zstandard")
  * else:
  */
     __pyx_t_8 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_ImportError);
     if (__pyx_t_8) {
       __Pyx_AddTraceback("fastavro._read", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_4, &__pyx_t_2) < 0) __PYX_ERR(0, 861, __pyx_L12_except_error)
+      if (__Pyx_GetException(&__pyx_t_1, &__pyx_t_4, &__pyx_t_2) < 0) __PYX_ERR(0, 873, __pyx_L12_except_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GOTREF(__pyx_t_2);
 
-      /* "fastavro/_read.pyx":862
+      /* "fastavro/_read.pyx":874
  *     import zstandard as zstd
  * except ImportError:
  *     BLOCK_READERS["zstandard"] = missing_codec_lib("zstandard", "zstandard")             # <<<<<<<<<<<<<<
  * else:
  *     BLOCK_READERS["zstandard"] = zstandard_read_block
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_missing_codec_lib); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 862, __pyx_L12_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_missing_codec_lib); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 874, __pyx_L12_except_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 862, __pyx_L12_except_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 874, __pyx_L12_except_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 862, __pyx_L12_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 874, __pyx_L12_except_error)
       __Pyx_GOTREF(__pyx_t_9);
-      if (unlikely(PyObject_SetItem(__pyx_t_9, __pyx_n_u_zstandard, __pyx_t_3) < 0)) __PYX_ERR(0, 862, __pyx_L12_except_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_9, __pyx_n_u_zstandard, __pyx_t_3) < 0)) __PYX_ERR(0, 874, __pyx_L12_except_error)
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       goto __pyx_L11_exception_handled;
     }
     goto __pyx_L12_except_error;
     __pyx_L12_except_error:;
 
-    /* "fastavro/_read.pyx":859
+    /* "fastavro/_read.pyx":871
  * 
  * 
  * try:             # <<<<<<<<<<<<<<
  *     import zstandard as zstd
  * except ImportError:
  */
     __Pyx_XGIVEREF(__pyx_t_7);
@@ -21198,15 +21414,15 @@
     __Pyx_XGIVEREF(__pyx_t_7);
     __Pyx_XGIVEREF(__pyx_t_6);
     __Pyx_XGIVEREF(__pyx_t_5);
     __Pyx_ExceptionReset(__pyx_t_7, __pyx_t_6, __pyx_t_5);
     __pyx_L15_try_end:;
   }
 
-  /* "fastavro/_read.pyx":873
+  /* "fastavro/_read.pyx":885
  * 
  * 
  * try:             # <<<<<<<<<<<<<<
  *     import lz4.block
  * except ImportError:
  */
   {
@@ -21214,103 +21430,103 @@
     __Pyx_PyThreadState_assign
     __Pyx_ExceptionSave(&__pyx_t_5, &__pyx_t_6, &__pyx_t_7);
     __Pyx_XGOTREF(__pyx_t_5);
     __Pyx_XGOTREF(__pyx_t_6);
     __Pyx_XGOTREF(__pyx_t_7);
     /*try:*/ {
 
-      /* "fastavro/_read.pyx":874
+      /* "fastavro/_read.pyx":886
  * 
  * try:
  *     import lz4.block             # <<<<<<<<<<<<<<
  * except ImportError:
  *     BLOCK_READERS["lz4"] = missing_codec_lib("lz4", "lz4")
  */
-      __pyx_t_2 = __Pyx_Import(__pyx_n_s_lz4_block, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 874, __pyx_L18_error)
+      __pyx_t_2 = __Pyx_Import(__pyx_n_s_lz4_block, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 886, __pyx_L18_error)
       __Pyx_GOTREF(__pyx_t_2);
-      if (PyDict_SetItem(__pyx_d, __pyx_n_s_lz4, __pyx_t_2) < 0) __PYX_ERR(0, 874, __pyx_L18_error)
+      if (PyDict_SetItem(__pyx_d, __pyx_n_s_lz4, __pyx_t_2) < 0) __PYX_ERR(0, 886, __pyx_L18_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "fastavro/_read.pyx":873
+      /* "fastavro/_read.pyx":885
  * 
  * 
  * try:             # <<<<<<<<<<<<<<
  *     import lz4.block
  * except ImportError:
  */
     }
 
-    /* "fastavro/_read.pyx":878
+    /* "fastavro/_read.pyx":890
  *     BLOCK_READERS["lz4"] = missing_codec_lib("lz4", "lz4")
  * else:
  *     BLOCK_READERS["lz4"] = lz4_read_block             # <<<<<<<<<<<<<<
  * 
  * 
  */
     /*else:*/ {
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_lz4_read_block); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 878, __pyx_L20_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_lz4_read_block); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 890, __pyx_L20_except_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 878, __pyx_L20_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 890, __pyx_L20_except_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_n_u_lz4, __pyx_t_2) < 0)) __PYX_ERR(0, 878, __pyx_L20_except_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_n_u_lz4, __pyx_t_2) < 0)) __PYX_ERR(0, 890, __pyx_L20_except_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     goto __pyx_L23_try_end;
     __pyx_L18_error:;
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "fastavro/_read.pyx":875
+    /* "fastavro/_read.pyx":887
  * try:
  *     import lz4.block
  * except ImportError:             # <<<<<<<<<<<<<<
  *     BLOCK_READERS["lz4"] = missing_codec_lib("lz4", "lz4")
  * else:
  */
     __pyx_t_8 = __Pyx_PyErr_ExceptionMatches(__pyx_builtin_ImportError);
     if (__pyx_t_8) {
       __Pyx_AddTraceback("fastavro._read", __pyx_clineno, __pyx_lineno, __pyx_filename);
-      if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_4, &__pyx_t_1) < 0) __PYX_ERR(0, 875, __pyx_L20_except_error)
+      if (__Pyx_GetException(&__pyx_t_2, &__pyx_t_4, &__pyx_t_1) < 0) __PYX_ERR(0, 887, __pyx_L20_except_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GOTREF(__pyx_t_1);
 
-      /* "fastavro/_read.pyx":876
+      /* "fastavro/_read.pyx":888
  *     import lz4.block
  * except ImportError:
  *     BLOCK_READERS["lz4"] = missing_codec_lib("lz4", "lz4")             # <<<<<<<<<<<<<<
  * else:
  *     BLOCK_READERS["lz4"] = lz4_read_block
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_missing_codec_lib); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L20_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_missing_codec_lib); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 888, __pyx_L20_except_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 876, __pyx_L20_except_error)
+      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 888, __pyx_L20_except_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L20_except_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_BLOCK_READERS); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 888, __pyx_L20_except_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_n_u_lz4, __pyx_t_9) < 0)) __PYX_ERR(0, 876, __pyx_L20_except_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_n_u_lz4, __pyx_t_9) < 0)) __PYX_ERR(0, 888, __pyx_L20_except_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       goto __pyx_L19_exception_handled;
     }
     goto __pyx_L20_except_error;
     __pyx_L20_except_error:;
 
-    /* "fastavro/_read.pyx":873
+    /* "fastavro/_read.pyx":885
  * 
  * 
  * try:             # <<<<<<<<<<<<<<
  *     import lz4.block
  * except ImportError:
  */
     __Pyx_XGIVEREF(__pyx_t_5);
@@ -21322,289 +21538,289 @@
     __Pyx_XGIVEREF(__pyx_t_5);
     __Pyx_XGIVEREF(__pyx_t_6);
     __Pyx_XGIVEREF(__pyx_t_7);
     __Pyx_ExceptionReset(__pyx_t_5, __pyx_t_6, __pyx_t_7);
     __pyx_L23_try_end:;
   }
 
-  /* "fastavro/_read.pyx":881
+  /* "fastavro/_read.pyx":893
  * 
  * 
  * def _iter_avro_records(             # <<<<<<<<<<<<<<
  *     fo,
  *     header,
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_8fastavro_5_read_81_iter_avro_records, NULL, __pyx_n_s_fastavro__read); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_8fastavro_5_read_83_iter_avro_records, NULL, __pyx_n_s_fastavro__read); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 893, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_iter_avro_records, __pyx_t_1) < 0) __PYX_ERR(0, 881, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_iter_avro_records, __pyx_t_1) < 0) __PYX_ERR(0, 893, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":915
+  /* "fastavro/_read.pyx":927
  * 
  * 
  * def _iter_avro_blocks(             # <<<<<<<<<<<<<<
  *     fo,
  *     header,
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_8fastavro_5_read_84_iter_avro_blocks, NULL, __pyx_n_s_fastavro__read); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 915, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_8fastavro_5_read_86_iter_avro_blocks, NULL, __pyx_n_s_fastavro__read); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_iter_avro_blocks, __pyx_t_1) < 0) __PYX_ERR(0, 915, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_iter_avro_blocks, __pyx_t_1) < 0) __PYX_ERR(0, 927, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":949
+  /* "fastavro/_read.pyx":961
  * 
  * 
  * class Block:             # <<<<<<<<<<<<<<
  *     def __init__(
  *         self,
  */
-  __pyx_t_1 = __Pyx_Py3MetaclassPrepare((PyObject *) NULL, __pyx_empty_tuple, __pyx_n_s_Block, __pyx_n_s_Block, (PyObject *) NULL, __pyx_n_s_fastavro__read, (PyObject *) NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 949, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Py3MetaclassPrepare((PyObject *) NULL, __pyx_empty_tuple, __pyx_n_s_Block, __pyx_n_s_Block, (PyObject *) NULL, __pyx_n_s_fastavro__read, (PyObject *) NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 961, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
 
-  /* "fastavro/_read.pyx":950
+  /* "fastavro/_read.pyx":962
  * 
  * class Block:
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         bytes_,
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_5Block_1__init__, 0, __pyx_n_s_Block___init, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__23)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 950, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_5Block_1__init__, 0, __pyx_n_s_Block___init, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__23)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 962, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_init, __pyx_t_4) < 0) __PYX_ERR(0, 950, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_init, __pyx_t_4) < 0) __PYX_ERR(0, 962, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "fastavro/_read.pyx":972
+  /* "fastavro/_read.pyx":984
  *         self.options = options
  * 
  *     def __iter__(self):             # <<<<<<<<<<<<<<
  *         for i in range(self.num_records):
  *             yield _read_data(
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_5Block_3__iter__, 0, __pyx_n_s_Block___iter, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 972, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_5Block_3__iter__, 0, __pyx_n_s_Block___iter, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 984, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_iter, __pyx_t_4) < 0) __PYX_ERR(0, 972, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_iter, __pyx_t_4) < 0) __PYX_ERR(0, 984, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "fastavro/_read.pyx":982
+  /* "fastavro/_read.pyx":994
  *             )
  * 
  *     def __str__(self):             # <<<<<<<<<<<<<<
  *         return (
  *             f"Avro block: {len(self.bytes_)} bytes, {self.num_records} records, "
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_5Block_6__str__, 0, __pyx_n_s_Block___str, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__26)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 982, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_5Block_6__str__, 0, __pyx_n_s_Block___str, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__26)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 994, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_str, __pyx_t_4) < 0) __PYX_ERR(0, 982, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_str, __pyx_t_4) < 0) __PYX_ERR(0, 994, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "fastavro/_read.pyx":949
+  /* "fastavro/_read.pyx":961
  * 
  * 
  * class Block:             # <<<<<<<<<<<<<<
  *     def __init__(
  *         self,
  */
-  __pyx_t_4 = __Pyx_Py3ClassCreate(((PyObject*)&__Pyx_DefaultClassType), __pyx_n_s_Block, __pyx_empty_tuple, __pyx_t_1, NULL, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 949, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3ClassCreate(((PyObject*)&__Pyx_DefaultClassType), __pyx_n_s_Block, __pyx_empty_tuple, __pyx_t_1, NULL, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 961, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Block, __pyx_t_4) < 0) __PYX_ERR(0, 949, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Block, __pyx_t_4) < 0) __PYX_ERR(0, 961, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":989
+  /* "fastavro/_read.pyx":1001
  * 
  * 
  * class file_reader:             # <<<<<<<<<<<<<<
  *     def __init__(self, fo, reader_schema=None, options={}):
  *         self.fo = fo
  */
-  __pyx_t_1 = __Pyx_Py3MetaclassPrepare((PyObject *) NULL, __pyx_empty_tuple, __pyx_n_s_file_reader, __pyx_n_s_file_reader, (PyObject *) NULL, __pyx_n_s_fastavro__read, (PyObject *) NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 989, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Py3MetaclassPrepare((PyObject *) NULL, __pyx_empty_tuple, __pyx_n_s_file_reader, __pyx_n_s_file_reader, (PyObject *) NULL, __pyx_n_s_fastavro__read, (PyObject *) NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1001, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
 
-  /* "fastavro/_read.pyx":990
+  /* "fastavro/_read.pyx":1002
  * 
  * class file_reader:
  *     def __init__(self, fo, reader_schema=None, options={}):             # <<<<<<<<<<<<<<
  *         self.fo = fo
  *         self.options = options
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_11file_reader_1__init__, 0, __pyx_n_s_file_reader___init, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__28)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 990, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_11file_reader_1__init__, 0, __pyx_n_s_file_reader___init, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__28)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1002, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (!__Pyx_CyFunction_InitDefaults(__pyx_t_4, sizeof(__pyx_defaults), 1)) __PYX_ERR(0, 990, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 990, __pyx_L1_error)
+  if (!__Pyx_CyFunction_InitDefaults(__pyx_t_4, sizeof(__pyx_defaults), 1)) __PYX_ERR(0, 1002, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1002, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_CyFunction_Defaults(__pyx_defaults, __pyx_t_4)->__pyx_arg_options = __pyx_t_2;
   __Pyx_GIVEREF(__pyx_t_2);
   __pyx_t_2 = 0;
-  __Pyx_CyFunction_SetDefaultsGetter(__pyx_t_4, __pyx_pf_8fastavro_5_read_90__defaults__);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_init, __pyx_t_4) < 0) __PYX_ERR(0, 990, __pyx_L1_error)
+  __Pyx_CyFunction_SetDefaultsGetter(__pyx_t_4, __pyx_pf_8fastavro_5_read_92__defaults__);
+  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_init, __pyx_t_4) < 0) __PYX_ERR(0, 1002, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "fastavro/_read.pyx":1032
+  /* "fastavro/_read.pyx":1044
  * 
  *     @property
  *     def schema(self):             # <<<<<<<<<<<<<<
  *         import warnings
  *         warnings.warn(
  */
-  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_11file_reader_3schema, 0, __pyx_n_s_file_reader_schema, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__30)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1032, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_11file_reader_3schema, 0, __pyx_n_s_file_reader_schema, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__30)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1044, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
 
-  /* "fastavro/_read.pyx":1031
+  /* "fastavro/_read.pyx":1043
  *         self._elems = None
  * 
  *     @property             # <<<<<<<<<<<<<<
  *     def schema(self):
  *         import warnings
  */
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_property, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_property, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1043, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_schema_2, __pyx_t_2) < 0) __PYX_ERR(0, 1032, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_schema_2, __pyx_t_2) < 0) __PYX_ERR(0, 1044, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":1040
+  /* "fastavro/_read.pyx":1052
  *         return self._schema
  * 
  *     def __iter__(self):             # <<<<<<<<<<<<<<
  *         if not self._elems:
  *             raise NotImplementedError
  */
-  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_11file_reader_5__iter__, 0, __pyx_n_s_file_reader___iter, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__32)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_11file_reader_5__iter__, 0, __pyx_n_s_file_reader___iter, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__32)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1052, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_iter, __pyx_t_2) < 0) __PYX_ERR(0, 1040, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_iter, __pyx_t_2) < 0) __PYX_ERR(0, 1052, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":1045
+  /* "fastavro/_read.pyx":1057
  *         return self._elems
  * 
  *     def __next__(self):             # <<<<<<<<<<<<<<
  *         return next(self._elems)
  * 
  */
-  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_11file_reader_7__next__, 0, __pyx_n_s_file_reader___next, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__34)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1045, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_11file_reader_7__next__, 0, __pyx_n_s_file_reader___next, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__34)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1057, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_next, __pyx_t_2) < 0) __PYX_ERR(0, 1045, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_next, __pyx_t_2) < 0) __PYX_ERR(0, 1057, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":989
+  /* "fastavro/_read.pyx":1001
  * 
  * 
  * class file_reader:             # <<<<<<<<<<<<<<
  *     def __init__(self, fo, reader_schema=None, options={}):
  *         self.fo = fo
  */
-  __pyx_t_2 = __Pyx_Py3ClassCreate(((PyObject*)&__Pyx_DefaultClassType), __pyx_n_s_file_reader, __pyx_empty_tuple, __pyx_t_1, NULL, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 989, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Py3ClassCreate(((PyObject*)&__Pyx_DefaultClassType), __pyx_n_s_file_reader, __pyx_empty_tuple, __pyx_t_1, NULL, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1001, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_file_reader, __pyx_t_2) < 0) __PYX_ERR(0, 989, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_file_reader, __pyx_t_2) < 0) __PYX_ERR(0, 1001, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastavro/_read.pyx":1049
+  /* "fastavro/_read.pyx":1061
  * 
  * 
  * class reader(file_reader):             # <<<<<<<<<<<<<<
  *     def __init__(
  *         self,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_file_reader); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_file_reader); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_reader, __pyx_n_s_reader, (PyObject *) NULL, __pyx_n_s_fastavro__read, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_t_2, __pyx_n_s_reader, __pyx_n_s_reader, (PyObject *) NULL, __pyx_n_s_fastavro__read, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
 
-  /* "fastavro/_read.pyx":1050
+  /* "fastavro/_read.pyx":1062
  * 
  * class reader(file_reader):
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         fo,
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_6reader_1__init__, 0, __pyx_n_s_reader___init, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__36)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1050, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_6reader_1__init__, 0, __pyx_n_s_reader___init, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__36)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_t_3);
   PyList_Append(__pyx_t_9, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__37);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 1050, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "fastavro/_read.pyx":1049
+  /* "fastavro/_read.pyx":1061
  * 
  * 
  * class reader(file_reader):             # <<<<<<<<<<<<<<
  *     def __init__(
  *         self,
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_reader, __pyx_t_2, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_reader, __pyx_t_2, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_9, __pyx_t_3) < 0) __PYX_ERR(0, 1049, __pyx_L1_error)
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_9, __pyx_t_3) < 0) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_reader, __pyx_t_3) < 0) __PYX_ERR(0, 1049, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_reader, __pyx_t_3) < 0) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastavro/_read.pyx":1074
+  /* "fastavro/_read.pyx":1086
  * 
  * 
  * class block_reader(file_reader):             # <<<<<<<<<<<<<<
  *     def __init__(
  *         self,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_file_reader); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1074, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_file_reader); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1074, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1074, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_block_reader, __pyx_n_s_block_reader, (PyObject *) NULL, __pyx_n_s_fastavro__read, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1074, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_block_reader, __pyx_n_s_block_reader, (PyObject *) NULL, __pyx_n_s_fastavro__read, (PyObject *) NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1074, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
 
-  /* "fastavro/_read.pyx":1075
+  /* "fastavro/_read.pyx":1087
  * 
  * class block_reader(file_reader):
  *     def __init__(             # <<<<<<<<<<<<<<
  *         self,
  *         fo,
  */
-  __pyx_t_9 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_12block_reader_1__init__, 0, __pyx_n_s_block_reader___init, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__39)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1075, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_CyFunction_New(&__pyx_mdef_8fastavro_5_read_12block_reader_1__init__, 0, __pyx_n_s_block_reader___init, NULL, __pyx_n_s_fastavro__read, __pyx_d, ((PyObject *)__pyx_codeobj__39)); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1087, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_INCREF(__pyx_t_9);
   PyList_Append(__pyx_t_3, __pyx_t_9);
   __Pyx_GIVEREF(__pyx_t_9);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_9, __pyx_tuple__40);
-  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_9) < 0) __PYX_ERR(0, 1075, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_4, __pyx_n_s_init, __pyx_t_9) < 0) __PYX_ERR(0, 1087, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-  /* "fastavro/_read.pyx":1074
+  /* "fastavro/_read.pyx":1086
  * 
  * 
  * class block_reader(file_reader):             # <<<<<<<<<<<<<<
  *     def __init__(
  *         self,
  */
-  __pyx_t_9 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_block_reader, __pyx_t_1, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1074, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_block_reader, __pyx_t_1, __pyx_t_4, NULL, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_3, __pyx_t_9) < 0) __PYX_ERR(0, 1074, __pyx_L1_error)
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_3, __pyx_t_9) < 0) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_block_reader, __pyx_t_9) < 0) __PYX_ERR(0, 1074, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_block_reader, __pyx_t_9) < 0) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "fastavro/_read.pyx":1
  * # cython: language_level=3             # <<<<<<<<<<<<<<
@@ -22150,217 +22366,37 @@
     #if PY_MAJOR_VERSION < 3
     Py_XDECREF(owned_ref);
     #endif
     return (equals == Py_NE);
 #endif
 }
 
-/* RaiseArgTupleInvalid */
-static void __Pyx_RaiseArgtupleInvalid(
-    const char* func_name,
-    int exact,
-    Py_ssize_t num_min,
-    Py_ssize_t num_max,
-    Py_ssize_t num_found)
-{
-    Py_ssize_t num_expected;
-    const char *more_or_less;
-    if (num_found < num_min) {
-        num_expected = num_min;
-        more_or_less = "at least";
-    } else {
-        num_expected = num_max;
-        more_or_less = "at most";
-    }
-    if (exact) {
-        more_or_less = "exactly";
-    }
-    PyErr_Format(PyExc_TypeError,
-                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
-                 func_name, more_or_less, num_expected,
-                 (num_expected == 1) ? "" : "s", num_found);
-}
-
-/* RaiseDoubleKeywords */
-static void __Pyx_RaiseDoubleKeywordsError(
-    const char* func_name,
-    PyObject* kw_name)
-{
-    PyErr_Format(PyExc_TypeError,
-        #if PY_MAJOR_VERSION >= 3
-        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
-        #else
-        "%s() got multiple values for keyword argument '%s'", func_name,
-        PyString_AsString(kw_name));
-        #endif
-}
-
-/* ParseKeywords */
-static int __Pyx_ParseOptionalKeywords(
-    PyObject *kwds,
-    PyObject **argnames[],
-    PyObject *kwds2,
-    PyObject *values[],
-    Py_ssize_t num_pos_args,
-    const char* function_name)
-{
-    PyObject *key = 0, *value = 0;
-    Py_ssize_t pos = 0;
-    PyObject*** name;
-    PyObject*** first_kw_arg = argnames + num_pos_args;
-    while (PyDict_Next(kwds, &pos, &key, &value)) {
-        name = first_kw_arg;
-        while (*name && (**name != key)) name++;
-        if (*name) {
-            values[name-argnames] = value;
-            continue;
-        }
-        name = first_kw_arg;
-        #if PY_MAJOR_VERSION < 3
-        if (likely(PyString_Check(key))) {
-            while (*name) {
-                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
-                        && _PyString_Eq(**name, key)) {
-                    values[name-argnames] = value;
-                    break;
-                }
-                name++;
-            }
-            if (*name) continue;
-            else {
-                PyObject*** argname = argnames;
-                while (argname != first_kw_arg) {
-                    if ((**argname == key) || (
-                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
-                             && _PyString_Eq(**argname, key))) {
-                        goto arg_passed_twice;
-                    }
-                    argname++;
-                }
-            }
-        } else
-        #endif
-        if (likely(PyUnicode_Check(key))) {
-            while (*name) {
-                int cmp = (**name == key) ? 0 :
-                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
-                    (__Pyx_PyUnicode_GET_LENGTH(**name) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
-                #endif
-                    PyUnicode_Compare(**name, key);
-                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
-                if (cmp == 0) {
-                    values[name-argnames] = value;
-                    break;
-                }
-                name++;
-            }
-            if (*name) continue;
-            else {
-                PyObject*** argname = argnames;
-                while (argname != first_kw_arg) {
-                    int cmp = (**argname == key) ? 0 :
-                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
-                        (__Pyx_PyUnicode_GET_LENGTH(**argname) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
-                    #endif
-                        PyUnicode_Compare(**argname, key);
-                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
-                    if (cmp == 0) goto arg_passed_twice;
-                    argname++;
+/* DictGetItem */
+#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
+static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
+    PyObject *value;
+    value = PyDict_GetItemWithError(d, key);
+    if (unlikely(!value)) {
+        if (!PyErr_Occurred()) {
+            if (unlikely(PyTuple_Check(key))) {
+                PyObject* args = PyTuple_Pack(1, key);
+                if (likely(args)) {
+                    PyErr_SetObject(PyExc_KeyError, args);
+                    Py_DECREF(args);
                 }
+            } else {
+                PyErr_SetObject(PyExc_KeyError, key);
             }
-        } else
-            goto invalid_keyword_type;
-        if (kwds2) {
-            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
-        } else {
-            goto invalid_keyword;
         }
+        return NULL;
     }
-    return 0;
-arg_passed_twice:
-    __Pyx_RaiseDoubleKeywordsError(function_name, key);
-    goto bad;
-invalid_keyword_type:
-    PyErr_Format(PyExc_TypeError,
-        "%.200s() keywords must be strings", function_name);
-    goto bad;
-invalid_keyword:
-    PyErr_Format(PyExc_TypeError,
-    #if PY_MAJOR_VERSION < 3
-        "%.200s() got an unexpected keyword argument '%.200s'",
-        function_name, PyString_AsString(key));
-    #else
-        "%s() got an unexpected keyword argument '%U'",
-        function_name, key);
-    #endif
-bad:
-    return -1;
+    Py_INCREF(value);
+    return value;
 }
-
-/* JoinPyUnicode */
-static PyObject* __Pyx_PyUnicode_Join(PyObject* value_tuple, Py_ssize_t value_count, Py_ssize_t result_ulength,
-                                      CYTHON_UNUSED Py_UCS4 max_char) {
-#if CYTHON_USE_UNICODE_INTERNALS && CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    PyObject *result_uval;
-    int result_ukind;
-    Py_ssize_t i, char_pos;
-    void *result_udata;
-#if CYTHON_PEP393_ENABLED
-    result_uval = PyUnicode_New(result_ulength, max_char);
-    if (unlikely(!result_uval)) return NULL;
-    result_ukind = (max_char <= 255) ? PyUnicode_1BYTE_KIND : (max_char <= 65535) ? PyUnicode_2BYTE_KIND : PyUnicode_4BYTE_KIND;
-    result_udata = PyUnicode_DATA(result_uval);
-#else
-    result_uval = PyUnicode_FromUnicode(NULL, result_ulength);
-    if (unlikely(!result_uval)) return NULL;
-    result_ukind = sizeof(Py_UNICODE);
-    result_udata = PyUnicode_AS_UNICODE(result_uval);
 #endif
-    char_pos = 0;
-    for (i=0; i < value_count; i++) {
-        int ukind;
-        Py_ssize_t ulength;
-        void *udata;
-        PyObject *uval = PyTuple_GET_ITEM(value_tuple, i);
-        if (unlikely(__Pyx_PyUnicode_READY(uval)))
-            goto bad;
-        ulength = __Pyx_PyUnicode_GET_LENGTH(uval);
-        if (unlikely(!ulength))
-            continue;
-        if (unlikely(char_pos + ulength < 0))
-            goto overflow;
-        ukind = __Pyx_PyUnicode_KIND(uval);
-        udata = __Pyx_PyUnicode_DATA(uval);
-        if (!CYTHON_PEP393_ENABLED || ukind == result_ukind) {
-            memcpy((char *)result_udata + char_pos * result_ukind, udata, (size_t) (ulength * result_ukind));
-        } else {
-            #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030300F0 || defined(_PyUnicode_FastCopyCharacters)
-            _PyUnicode_FastCopyCharacters(result_uval, char_pos, uval, 0, ulength);
-            #else
-            Py_ssize_t j;
-            for (j=0; j < ulength; j++) {
-                Py_UCS4 uchar = __Pyx_PyUnicode_READ(ukind, udata, j);
-                __Pyx_PyUnicode_WRITE(result_ukind, result_udata, char_pos+j, uchar);
-            }
-            #endif
-        }
-        char_pos += ulength;
-    }
-    return result_uval;
-overflow:
-    PyErr_SetString(PyExc_OverflowError, "join() result is too long for a Python string");
-bad:
-    Py_DECREF(result_uval);
-    return NULL;
-#else
-    result_ulength++;
-    value_count++;
-    return PyUnicode_Join(__pyx_empty_unicode, value_tuple);
-#endif
-}
 
 /* PyCFunctionFastCall */
 #if CYTHON_FAST_PYCCALL
 static CYTHON_INLINE PyObject * __Pyx_PyCFunction_FastCall(PyObject *func_obj, PyObject **args, Py_ssize_t nargs) {
     PyCFunctionObject *func = (PyCFunctionObject*)func_obj;
     PyCFunction meth = PyCFunction_GET_FUNCTION(func);
     PyObject *self = PyCFunction_GET_SELF(func);
@@ -22605,14 +22641,218 @@
     if (unlikely(!args)) return NULL;
     result = __Pyx_PyObject_Call(func, args, NULL);
     Py_DECREF(args);
     return result;
 }
 #endif
 
+/* RaiseArgTupleInvalid */
+static void __Pyx_RaiseArgtupleInvalid(
+    const char* func_name,
+    int exact,
+    Py_ssize_t num_min,
+    Py_ssize_t num_max,
+    Py_ssize_t num_found)
+{
+    Py_ssize_t num_expected;
+    const char *more_or_less;
+    if (num_found < num_min) {
+        num_expected = num_min;
+        more_or_less = "at least";
+    } else {
+        num_expected = num_max;
+        more_or_less = "at most";
+    }
+    if (exact) {
+        more_or_less = "exactly";
+    }
+    PyErr_Format(PyExc_TypeError,
+                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
+                 func_name, more_or_less, num_expected,
+                 (num_expected == 1) ? "" : "s", num_found);
+}
+
+/* RaiseDoubleKeywords */
+static void __Pyx_RaiseDoubleKeywordsError(
+    const char* func_name,
+    PyObject* kw_name)
+{
+    PyErr_Format(PyExc_TypeError,
+        #if PY_MAJOR_VERSION >= 3
+        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
+        #else
+        "%s() got multiple values for keyword argument '%s'", func_name,
+        PyString_AsString(kw_name));
+        #endif
+}
+
+/* ParseKeywords */
+static int __Pyx_ParseOptionalKeywords(
+    PyObject *kwds,
+    PyObject **argnames[],
+    PyObject *kwds2,
+    PyObject *values[],
+    Py_ssize_t num_pos_args,
+    const char* function_name)
+{
+    PyObject *key = 0, *value = 0;
+    Py_ssize_t pos = 0;
+    PyObject*** name;
+    PyObject*** first_kw_arg = argnames + num_pos_args;
+    while (PyDict_Next(kwds, &pos, &key, &value)) {
+        name = first_kw_arg;
+        while (*name && (**name != key)) name++;
+        if (*name) {
+            values[name-argnames] = value;
+            continue;
+        }
+        name = first_kw_arg;
+        #if PY_MAJOR_VERSION < 3
+        if (likely(PyString_Check(key))) {
+            while (*name) {
+                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
+                        && _PyString_Eq(**name, key)) {
+                    values[name-argnames] = value;
+                    break;
+                }
+                name++;
+            }
+            if (*name) continue;
+            else {
+                PyObject*** argname = argnames;
+                while (argname != first_kw_arg) {
+                    if ((**argname == key) || (
+                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
+                             && _PyString_Eq(**argname, key))) {
+                        goto arg_passed_twice;
+                    }
+                    argname++;
+                }
+            }
+        } else
+        #endif
+        if (likely(PyUnicode_Check(key))) {
+            while (*name) {
+                int cmp = (**name == key) ? 0 :
+                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
+                    (__Pyx_PyUnicode_GET_LENGTH(**name) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
+                #endif
+                    PyUnicode_Compare(**name, key);
+                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
+                if (cmp == 0) {
+                    values[name-argnames] = value;
+                    break;
+                }
+                name++;
+            }
+            if (*name) continue;
+            else {
+                PyObject*** argname = argnames;
+                while (argname != first_kw_arg) {
+                    int cmp = (**argname == key) ? 0 :
+                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
+                        (__Pyx_PyUnicode_GET_LENGTH(**argname) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
+                    #endif
+                        PyUnicode_Compare(**argname, key);
+                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
+                    if (cmp == 0) goto arg_passed_twice;
+                    argname++;
+                }
+            }
+        } else
+            goto invalid_keyword_type;
+        if (kwds2) {
+            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
+        } else {
+            goto invalid_keyword;
+        }
+    }
+    return 0;
+arg_passed_twice:
+    __Pyx_RaiseDoubleKeywordsError(function_name, key);
+    goto bad;
+invalid_keyword_type:
+    PyErr_Format(PyExc_TypeError,
+        "%.200s() keywords must be strings", function_name);
+    goto bad;
+invalid_keyword:
+    PyErr_Format(PyExc_TypeError,
+    #if PY_MAJOR_VERSION < 3
+        "%.200s() got an unexpected keyword argument '%.200s'",
+        function_name, PyString_AsString(key));
+    #else
+        "%s() got an unexpected keyword argument '%U'",
+        function_name, key);
+    #endif
+bad:
+    return -1;
+}
+
+/* JoinPyUnicode */
+static PyObject* __Pyx_PyUnicode_Join(PyObject* value_tuple, Py_ssize_t value_count, Py_ssize_t result_ulength,
+                                      CYTHON_UNUSED Py_UCS4 max_char) {
+#if CYTHON_USE_UNICODE_INTERNALS && CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+    PyObject *result_uval;
+    int result_ukind;
+    Py_ssize_t i, char_pos;
+    void *result_udata;
+#if CYTHON_PEP393_ENABLED
+    result_uval = PyUnicode_New(result_ulength, max_char);
+    if (unlikely(!result_uval)) return NULL;
+    result_ukind = (max_char <= 255) ? PyUnicode_1BYTE_KIND : (max_char <= 65535) ? PyUnicode_2BYTE_KIND : PyUnicode_4BYTE_KIND;
+    result_udata = PyUnicode_DATA(result_uval);
+#else
+    result_uval = PyUnicode_FromUnicode(NULL, result_ulength);
+    if (unlikely(!result_uval)) return NULL;
+    result_ukind = sizeof(Py_UNICODE);
+    result_udata = PyUnicode_AS_UNICODE(result_uval);
+#endif
+    char_pos = 0;
+    for (i=0; i < value_count; i++) {
+        int ukind;
+        Py_ssize_t ulength;
+        void *udata;
+        PyObject *uval = PyTuple_GET_ITEM(value_tuple, i);
+        if (unlikely(__Pyx_PyUnicode_READY(uval)))
+            goto bad;
+        ulength = __Pyx_PyUnicode_GET_LENGTH(uval);
+        if (unlikely(!ulength))
+            continue;
+        if (unlikely(char_pos + ulength < 0))
+            goto overflow;
+        ukind = __Pyx_PyUnicode_KIND(uval);
+        udata = __Pyx_PyUnicode_DATA(uval);
+        if (!CYTHON_PEP393_ENABLED || ukind == result_ukind) {
+            memcpy((char *)result_udata + char_pos * result_ukind, udata, (size_t) (ulength * result_ukind));
+        } else {
+            #if CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x030300F0 || defined(_PyUnicode_FastCopyCharacters)
+            _PyUnicode_FastCopyCharacters(result_uval, char_pos, uval, 0, ulength);
+            #else
+            Py_ssize_t j;
+            for (j=0; j < ulength; j++) {
+                Py_UCS4 uchar = __Pyx_PyUnicode_READ(ukind, udata, j);
+                __Pyx_PyUnicode_WRITE(result_ukind, result_udata, char_pos+j, uchar);
+            }
+            #endif
+        }
+        char_pos += ulength;
+    }
+    return result_uval;
+overflow:
+    PyErr_SetString(PyExc_OverflowError, "join() result is too long for a Python string");
+bad:
+    Py_DECREF(result_uval);
+    return NULL;
+#else
+    result_ulength++;
+    value_count++;
+    return PyUnicode_Join(__pyx_empty_unicode, value_tuple);
+#endif
+}
+
 /* RaiseException */
 #if PY_MAJOR_VERSION < 3
 static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
                         CYTHON_UNUSED PyObject *cause) {
     __Pyx_PyThreadState_declare
     Py_XINCREF(type);
     if (!value || value == Py_None)
@@ -22764,38 +23004,14 @@
     }
 bad:
     Py_XDECREF(owned_instance);
     return;
 }
 #endif
 
-/* DictGetItem */
-#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
-static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
-    PyObject *value;
-    value = PyDict_GetItemWithError(d, key);
-    if (unlikely(!value)) {
-        if (!PyErr_Occurred()) {
-            if (unlikely(PyTuple_Check(key))) {
-                PyObject* args = PyTuple_Pack(1, key);
-                if (likely(args)) {
-                    PyErr_SetObject(PyExc_KeyError, args);
-                    Py_DECREF(args);
-                }
-            } else {
-                PyErr_SetObject(PyExc_KeyError, key);
-            }
-        }
-        return NULL;
-    }
-    Py_INCREF(value);
-    return value;
-}
-#endif
-
 /* GetItemInt */
 static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
     PyObject *r;
     if (!j) return NULL;
     r = PyObject_GetItem(o, j);
     Py_DECREF(j);
     return r;
```

### Comparing `fastavro-1.8.1/fastavro/_read.pyi` & `fastavro-1.8.2/fastavro/_read.pyi`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_read.pyx` & `fastavro-1.8.2/fastavro/_read.pyx`

 * *Files 5% similar despite different names*

```diff
@@ -39,20 +39,24 @@
 ctypedef long long long64
 
 
 class ReadError(Exception):
     pass
 
 
-cpdef match_types(writer_type, reader_type):
+cpdef _default_named_schemas():
+    return {"writer": {}, "reader": {}}
+
+
+cpdef match_types(writer_type, reader_type, named_schemas):
     if isinstance(writer_type, list) or isinstance(reader_type, list):
         return True
     if isinstance(writer_type, dict) or isinstance(reader_type, dict):
         try:
-            return match_schemas(writer_type, reader_type)
+            return match_schemas(writer_type, reader_type, named_schemas)
         except SchemaResolutionError:
             return False
     if writer_type == reader_type:
         return True
     # promotion cases
     elif writer_type == "int" and reader_type in ["long", "float", "double"]:
         return True
@@ -60,28 +64,32 @@
         return True
     elif writer_type == "float" and reader_type == "double":
         return True
     elif writer_type == "string" and reader_type == "bytes":
         return True
     elif writer_type == "bytes" and reader_type == "string":
         return True
+    writer_schema = named_schemas["writer"].get(writer_type)
+    reader_schema = named_schemas["reader"].get(reader_type)
+    if writer_schema is not None and reader_schema is not None:
+        return match_types(writer_schema, reader_schema, named_schemas)
     return False
 
 
-cpdef match_schemas(w_schema, r_schema):
+cpdef match_schemas(w_schema, r_schema, named_schemas):
     error_msg = f"Schema mismatch: {w_schema} is not {r_schema}"
     if isinstance(w_schema, list):
         # If the writer is a union, checks will happen in read_union after the
         # correct schema is known
         return r_schema
     elif isinstance(r_schema, list):
         # If the reader is a union, ensure one of the new schemas is the same
         # as the writer
         for schema in r_schema:
-            if match_types(w_schema, schema):
+            if match_types(w_schema, schema, named_schemas):
                 return schema
         else:
             raise SchemaResolutionError(error_msg)
     else:
         # Check for dicts as primitive types are just strings
         if isinstance(w_schema, dict):
             w_type = w_schema["type"]
@@ -89,35 +97,35 @@
             w_type = w_schema
         if isinstance(r_schema, dict):
             r_type = r_schema["type"]
         else:
             r_type = r_schema
 
         if w_type == r_type == "map":
-            if match_types(w_schema["values"], r_schema["values"]):
+            if match_types(w_schema["values"], r_schema["values"], named_schemas):
                 return r_schema
         elif w_type == r_type == "array":
-            if match_types(w_schema["items"], r_schema["items"]):
+            if match_types(w_schema["items"], r_schema["items"], named_schemas):
                 return r_schema
         elif w_type in NAMED_TYPES and r_type in NAMED_TYPES:
             if w_type == r_type == "fixed" and w_schema["size"] != r_schema["size"]:
                 raise SchemaResolutionError(
                     f"Schema mismatch: {w_schema} size is different than {r_schema} size"
                 )
 
             w_unqual_name = w_schema["name"].split(".")[-1]
             r_unqual_name = r_schema["name"].split(".")[-1]
             if w_unqual_name == r_unqual_name or w_schema["name"] in r_schema.get(
                 "aliases", []
             ):
                 return r_schema
         elif w_type not in AVRO_TYPES and r_type in NAMED_TYPES:
-            if match_types(w_type, r_schema["name"]):
+            if match_types(w_type, r_schema["name"], named_schemas):
                 return r_schema["name"]
-        elif match_types(w_type, r_type):
+        elif match_types(w_type, r_type, named_schemas):
             return r_schema
         raise SchemaResolutionError(error_msg)
 
 
 cpdef inline read_null(fo):
     """null is written as zero bytes."""
     return None
@@ -512,25 +520,25 @@
     # schema resolution
     index = read_long(fo)
     idx_schema = writer_schema[index]
 
     if reader_schema:
         # Handle case where the reader schema is just a single type (not union)
         if not isinstance(reader_schema, list):
-            if match_types(idx_schema, reader_schema):
+            if match_types(idx_schema, reader_schema, named_schemas):
                 return _read_data(
                     fo,
                     idx_schema,
                     named_schemas,
                     reader_schema,
                     options,
                 )
         else:
             for schema in reader_schema:
-                if match_types(idx_schema, schema):
+                if match_types(idx_schema, schema, named_schemas):
                     return _read_data(
                         fo,
                         idx_schema,
                         named_schemas,
                         schema,
                         options,
                     )
@@ -675,15 +683,19 @@
     options={},
 ):
     """Read data from file object according to schema."""
 
     record_type = extract_record_type(writer_schema)
 
     if reader_schema:
-        reader_schema = match_schemas(writer_schema, reader_schema)
+        reader_schema = match_schemas(
+            writer_schema,
+            reader_schema,
+            named_schemas,
+        )
 
     try:
         if record_type == "null":
             data = read_null(fo)
         elif record_type == "string":
             data = read_utf8(fo, options.get("handle_unicode_errors", "strict"))
         elif record_type == "int" or record_type == "long":
@@ -999,15 +1011,15 @@
         self.metadata = {
             k: v.decode() for k, v in self._header["meta"].items()
         }
 
         self._schema = json.loads(self.metadata["avro.schema"])
         self.codec = self.metadata.get("avro.codec", "null")
 
-        self._named_schemas = {"writer": {}, "reader": {}}
+        self._named_schemas = _default_named_schemas()
         if reader_schema:
             self.reader_schema = parse_schema(
                 reader_schema, self._named_schemas["reader"], _write_hint=False
             )
             # Older avro files created before we were more strict about
             # defaults might have been writen with a bad default. Since we re-parse
             # the writer schema here, it will now fail. Therefore, if a user
@@ -1104,15 +1116,15 @@
     return_record_name_override=False,
     handle_unicode_errors="strict",
 ):
     if writer_schema == reader_schema:
         # No need for the reader schema if they are the same
         reader_schema = None
 
-    named_schemas = {"writer": {}, "reader": {}}
+    named_schemas = _default_named_schemas()
     writer_schema = parse_schema(writer_schema, named_schemas["writer"])
 
     if reader_schema:
         reader_schema = parse_schema(reader_schema, named_schemas["reader"])
 
     options = {
         "return_record_name": return_record_name,
```

### Comparing `fastavro-1.8.1/fastavro/_read_common.py` & `fastavro-1.8.2/fastavro/_read_common.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_read_py.py` & `fastavro-1.8.2/fastavro/_read_py.py`

 * *Files 1% similar despite different names*

```diff
@@ -38,20 +38,24 @@
 T = TypeVar("T")
 
 decimal_context = Context()
 epoch = datetime(1970, 1, 1, tzinfo=timezone.utc)
 epoch_naive = datetime(1970, 1, 1)
 
 
-def match_types(writer_type, reader_type):
+def _default_named_schemas() -> Dict[str, NamedSchemas]:
+    return {"writer": {}, "reader": {}}
+
+
+def match_types(writer_type, reader_type, named_schemas):
     if isinstance(writer_type, list) or isinstance(reader_type, list):
         return True
     if isinstance(writer_type, dict) or isinstance(reader_type, dict):
         try:
-            return match_schemas(writer_type, reader_type)
+            return match_schemas(writer_type, reader_type, named_schemas)
         except SchemaResolutionError:
             return False
     if writer_type == reader_type:
         return True
     # promotion cases
     elif writer_type == "int" and reader_type in ["long", "float", "double"]:
         return True
@@ -59,28 +63,32 @@
         return True
     elif writer_type == "float" and reader_type == "double":
         return True
     elif writer_type == "string" and reader_type == "bytes":
         return True
     elif writer_type == "bytes" and reader_type == "string":
         return True
+    writer_schema = named_schemas["writer"].get(writer_type)
+    reader_schema = named_schemas["reader"].get(reader_type)
+    if writer_schema is not None and reader_schema is not None:
+        return match_types(writer_schema, reader_schema, named_schemas)
     return False
 
 
-def match_schemas(w_schema, r_schema):
+def match_schemas(w_schema, r_schema, named_schemas):
     error_msg = f"Schema mismatch: {w_schema} is not {r_schema}"
     if isinstance(w_schema, list):
         # If the writer is a union, checks will happen in read_union after the
         # correct schema is known
         return r_schema
     elif isinstance(r_schema, list):
         # If the reader is a union, ensure one of the new schemas is the same
         # as the writer
         for schema in r_schema:
-            if match_types(w_schema, schema):
+            if match_types(w_schema, schema, named_schemas):
                 return schema
         else:
             raise SchemaResolutionError(error_msg)
     else:
         # Check for dicts as primitive types are just strings
         if isinstance(w_schema, dict):
             w_type = w_schema["type"]
@@ -88,35 +96,34 @@
             w_type = w_schema
         if isinstance(r_schema, dict):
             r_type = r_schema["type"]
         else:
             r_type = r_schema
 
         if w_type == r_type == "map":
-            if match_types(w_schema["values"], r_schema["values"]):
+            if match_types(w_schema["values"], r_schema["values"], named_schemas):
                 return r_schema
         elif w_type == r_type == "array":
-            if match_types(w_schema["items"], r_schema["items"]):
+            if match_types(w_schema["items"], r_schema["items"], named_schemas):
                 return r_schema
         elif w_type in NAMED_TYPES and r_type in NAMED_TYPES:
             if w_type == r_type == "fixed" and w_schema["size"] != r_schema["size"]:
                 raise SchemaResolutionError(
                     f"Schema mismatch: {w_schema} size is different than {r_schema} size"
                 )
 
             w_unqual_name = w_schema["name"].split(".")[-1]
             r_unqual_name = r_schema["name"].split(".")[-1]
-            if w_unqual_name == r_unqual_name or w_schema["name"] in r_schema.get(
-                "aliases", []
-            ):
+            r_aliases = r_schema.get("aliases", [])
+            if w_unqual_name == r_unqual_name or w_schema["name"] in r_aliases:
                 return r_schema
         elif w_type not in AVRO_TYPES and r_type in NAMED_TYPES:
-            if match_types(w_type, r_schema["name"]):
+            if match_types(w_type, r_schema["name"], named_schemas):
                 return r_schema["name"]
-        elif match_types(w_type, r_type):
+        elif match_types(w_type, r_type, named_schemas):
             return r_schema
         raise SchemaResolutionError(error_msg)
 
 
 def read_null(
     decoder,
     writer_schema=None,
@@ -389,25 +396,25 @@
     # schema resolution
     index = decoder.read_index()
     idx_schema = writer_schema[index]
 
     if reader_schema:
         # Handle case where the reader schema is just a single type (not union)
         if not isinstance(reader_schema, list):
-            if match_types(idx_schema, reader_schema):
+            if match_types(idx_schema, reader_schema, named_schemas):
                 return read_data(
                     decoder,
                     idx_schema,
                     named_schemas,
                     reader_schema,
                     options,
                 )
         else:
             for schema in reader_schema:
-                if match_types(idx_schema, schema):
+                if match_types(idx_schema, schema, named_schemas):
                     return read_data(
                         decoder,
                         idx_schema,
                         named_schemas,
                         schema,
                         options,
                     )
@@ -599,15 +606,19 @@
     options={},
 ):
     """Read data from file object according to schema."""
 
     record_type = extract_record_type(writer_schema)
 
     if reader_schema:
-        reader_schema = match_schemas(writer_schema, reader_schema)
+        reader_schema = match_schemas(
+            writer_schema,
+            reader_schema,
+            named_schemas,
+        )
 
     reader_fn = READERS.get(record_type)
     if reader_fn:
         try:
             data = reader_fn(
                 decoder,
                 writer_schema,
@@ -882,15 +893,15 @@
     ):
         if isinstance(fo_or_decoder, AvroJSONDecoder):
             self.decoder = fo_or_decoder
         else:
             # If a decoder was not provided, assume binary
             self.decoder = BinaryDecoder(fo_or_decoder)
 
-        self._named_schemas = {"writer": {}, "reader": {}}
+        self._named_schemas = _default_named_schemas()
         if reader_schema:
             self.reader_schema = parse_schema(
                 reader_schema, self._named_schemas["reader"], _write_hint=False
             )
 
         else:
             self.reader_schema = None
@@ -1185,15 +1196,15 @@
 
     Note: The ``schemaless_reader`` can only read a single record.
     """
     if writer_schema == reader_schema:
         # No need for the reader schema if they are the same
         reader_schema = None
 
-    named_schemas: Dict[str, NamedSchemas] = {"writer": {}, "reader": {}}
+    named_schemas: Dict[str, NamedSchemas] = _default_named_schemas()
     writer_schema = parse_schema(writer_schema, named_schemas["writer"])
 
     if reader_schema:
         reader_schema = parse_schema(reader_schema, named_schemas["reader"])
 
     decoder = BinaryDecoder(fo)
```

### Comparing `fastavro-1.8.1/fastavro/_schema.c` & `fastavro-1.8.2/fastavro/_schema.c`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_schema.pyi` & `fastavro-1.8.2/fastavro/_schema.pyi`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_schema.pyx` & `fastavro-1.8.2/fastavro/_schema.pyx`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_schema_common.py` & `fastavro-1.8.2/fastavro/_schema_common.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_schema_py.py` & `fastavro-1.8.2/fastavro/_schema_py.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_six.c` & `fastavro-1.8.2/fastavro/_six.c`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_validate_common.py` & `fastavro-1.8.2/fastavro/_validate_common.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_validation.c` & `fastavro-1.8.2/fastavro/_validation.c`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_validation.pyx` & `fastavro-1.8.2/fastavro/_validation.pyx`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_validation_py.py` & `fastavro-1.8.2/fastavro/_validation_py.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_write.c` & `fastavro-1.8.2/fastavro/_write.c`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_write.pyi` & `fastavro-1.8.2/fastavro/_write.pyi`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_write.pyx` & `fastavro-1.8.2/fastavro/_write.pyx`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_write_common.py` & `fastavro-1.8.2/fastavro/_write_common.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/_write_py.py` & `fastavro-1.8.2/fastavro/_write_py.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/const.py` & `fastavro-1.8.2/fastavro/const.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/io/binary_decoder.py` & `fastavro-1.8.2/fastavro/io/binary_decoder.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/io/binary_encoder.py` & `fastavro-1.8.2/fastavro/io/binary_encoder.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/io/json_decoder.py` & `fastavro-1.8.2/fastavro/io/json_decoder.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/io/json_encoder.py` & `fastavro-1.8.2/fastavro/io/json_encoder.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/io/parser.py` & `fastavro-1.8.2/fastavro/io/parser.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/io/symbols.py` & `fastavro-1.8.2/fastavro/io/symbols.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/json_read.py` & `fastavro-1.8.2/fastavro/json_read.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/json_write.py` & `fastavro-1.8.2/fastavro/json_write.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/read.py` & `fastavro-1.8.2/fastavro/read.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/repository/flat_dict.py` & `fastavro-1.8.2/fastavro/repository/flat_dict.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/schema.py` & `fastavro-1.8.2/fastavro/schema.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro/utils.py` & `fastavro-1.8.2/fastavro/utils.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/fastavro.egg-info/PKG-INFO` & `fastavro-1.8.2/fastavro.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: fastavro
-Version: 1.8.1
+Version: 1.8.2
 Summary: Fast read/write of AVRO files
 Home-page: https://github.com/fastavro/fastavro
 Author: Miki Tebeka
 Author-email: miki.tebeka@gmail.com
 License: MIT
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
```

### Comparing `fastavro-1.8.1/fastavro.egg-info/SOURCES.txt` & `fastavro-1.8.2/fastavro.egg-info/SOURCES.txt`

 * *Files 1% similar despite different names*

```diff
@@ -106,14 +106,15 @@
 tests/test_complex.py
 tests/test_compression.py
 tests/test_fastavro.py
 tests/test_fingerprint.py
 tests/test_json.py
 tests/test_logical_types.py
 tests/test_main_cli.py
+tests/test_match.py
 tests/test_promotion.py
 tests/test_schema.py
 tests/test_schema_evolution.py
 tests/test_schemaless.py
 tests/test_str_py3.py
 tests/test_timezone.py
 tests/test_types.py
```

### Comparing `fastavro-1.8.1/publish.sh` & `fastavro-1.8.2/publish.sh`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/run-tests.cmd` & `fastavro-1.8.2/run-tests.cmd`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/run-tests.sh` & `fastavro-1.8.2/run-tests.sh`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/setup.py` & `fastavro-1.8.2/setup.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/deflate.avro` & `fastavro-1.8.2/tests/avro-files/deflate.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/java-generated-uuid.avro` & `fastavro-1.8.2/tests/avro-files/java-generated-uuid.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/null.avro` & `fastavro-1.8.2/tests/avro-files/null.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/snappy.avro` & `fastavro-1.8.2/tests/avro-files/snappy.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/test-deflate-0.avro` & `fastavro-1.8.2/tests/avro-files/test-deflate-0.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/test-deflate-1-A.avro` & `fastavro-1.8.2/tests/avro-files/test-deflate-1-A.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/test-deflate-1.avro` & `fastavro-1.8.2/tests/avro-files/test-deflate-1.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/test-deflate-3-A.avro` & `fastavro-1.8.2/tests/avro-files/test-deflate-3-A.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/test-deflate-6-B.avro` & `fastavro-1.8.2/tests/avro-files/test-deflate-6-B.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/test-deflate-9.avro` & `fastavro-1.8.2/tests/avro-files/test-deflate-9.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/test-null-B.avro` & `fastavro-1.8.2/tests/avro-files/test-null-B.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/test-null.avro` & `fastavro-1.8.2/tests/avro-files/test-null.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/test-snappy.avro` & `fastavro-1.8.2/tests/avro-files/test-snappy.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/weather-legacy-generated.avro` & `fastavro-1.8.2/tests/avro-files/weather-legacy-generated.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/avro-files/weather-legacy-with-names.avro` & `fastavro-1.8.2/tests/avro-files/weather-legacy-with-names.avro`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/conftest.py` & `fastavro-1.8.2/tests/conftest.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/repository/test_flat_dict.py` & `fastavro-1.8.2/tests/repository/test_flat_dict.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_aliases.py` & `fastavro-1.8.2/tests/test_aliases.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_appendable.py` & `fastavro-1.8.2/tests/test_appendable.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_block_reader.py` & `fastavro-1.8.2/tests/test_block_reader.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_canonical_form.py` & `fastavro-1.8.2/tests/test_canonical_form.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_complex.py` & `fastavro-1.8.2/tests/test_complex.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_compression.py` & `fastavro-1.8.2/tests/test_compression.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_fastavro.py` & `fastavro-1.8.2/tests/test_fastavro.py`

 * *Files 0% similar despite different names*

```diff
@@ -3388,7 +3388,69 @@
         writer_schema, _ignore_default_error=True
     )
 
     roundtrip_records = roundtrip(
         parsed_writer_schema, records, reader_schema=reader_schema
     )
     assert roundtrip_records == [{"field1": 5}]
+
+
+def test_reuse_nested_schema_by_name():
+    """https://github.com/fastavro/fastavro/issues/700"""
+    writer_schema = {
+        "name": "Writer",
+        "namespace": "test",
+        "type": "record",
+        "fields": [
+            {
+                "name": "foo",
+                "type": {
+                    "name": "Item",
+                    "namespace": "test.Writer",
+                    "type": "record",
+                    "fields": [{"name": "spam", "type": "string"}],
+                },
+            },
+            {
+                "name": "bar",
+                "type": {
+                    "type": "array",
+                    "items": "test.Writer.Item",
+                },
+            },
+        ],
+    }
+
+    reader_schema = {
+        "name": "Reader",
+        "namespace": "test",
+        "type": "record",
+        "aliases": ["test.Writer"],
+        "fields": [
+            {
+                "name": "foo",
+                "type": {
+                    "name": "Item",
+                    "namespace": "test.Reader",
+                    "type": "record",
+                    "aliases": ["test.Writer.Item"],
+                    "fields": [{"name": "spam", "type": "string"}],
+                },
+            },
+            {
+                "name": "bar",
+                "type": {
+                    "type": "array",
+                    "items": "test.Reader.Item",
+                },
+            },
+        ],
+    }
+
+    records = [{"foo": {"spam": "ham"}, "bar": [{"spam": "ham"}]}]
+
+    parsed_writer_schema = fastavro.parse_schema(writer_schema)
+
+    roundtrip_records = roundtrip(
+        parsed_writer_schema, records, reader_schema=reader_schema
+    )
+    assert roundtrip_records == [{"foo": {"spam": "ham"}, "bar": [{"spam": "ham"}]}]
```

### Comparing `fastavro-1.8.1/tests/test_fingerprint.py` & `fastavro-1.8.2/tests/test_fingerprint.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_json.py` & `fastavro-1.8.2/tests/test_json.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_logical_types.py` & `fastavro-1.8.2/tests/test_logical_types.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_main_cli.py` & `fastavro-1.8.2/tests/test_main_cli.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_promotion.py` & `fastavro-1.8.2/tests/test_promotion.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_schema.py` & `fastavro-1.8.2/tests/test_schema.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_schema_evolution.py` & `fastavro-1.8.2/tests/test_schema_evolution.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_schemaless.py` & `fastavro-1.8.2/tests/test_schemaless.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_str_py3.py` & `fastavro-1.8.2/tests/test_str_py3.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_timezone.py` & `fastavro-1.8.2/tests/test_timezone.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_types.py` & `fastavro-1.8.2/tests/test_types.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_utils.py` & `fastavro-1.8.2/tests/test_utils.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_validation.py` & `fastavro-1.8.2/tests/test_validation.py`

 * *Files identical despite different names*

### Comparing `fastavro-1.8.1/tests/test_write_block.py` & `fastavro-1.8.2/tests/test_write_block.py`

 * *Files identical despite different names*

