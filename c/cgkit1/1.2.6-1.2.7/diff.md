# Comparing `tmp/cgkit1-1.2.6.tar.gz` & `tmp/cgkit1-1.2.7.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist/cgkit1-1.2.6.tar", last modified: Sun Oct 18 20:24:26 2020, max compression
+gzip compressed data, was "dist\cgkit1-1.2.7.tar", last modified: Sat Dec 12 21:26:34 2020, max compression
```

## Comparing `cgkit1-1.2.6.tar` & `cgkit1-1.2.7.tar`

### file list

```diff
@@ -1,21 +1,21 @@
-drwxrwxrwx   0 straw     (1000) straw     (1000)        0 2020-10-18 20:24:27.496176 cgkit1-1.2.6/
--rwxrwxrwx   0 straw     (1000) straw     (1000)       38 2020-04-07 09:07:49.000000 cgkit1-1.2.6/MANIFEST.in
--rwxrwxrwx   0 straw     (1000) straw     (1000)     2882 2020-10-18 20:24:27.494176 cgkit1-1.2.6/PKG-INFO
--rwxrwxrwx   0 straw     (1000) straw     (1000)     2116 2020-06-16 21:54:15.000000 cgkit1-1.2.6/README.md
-drwxrwxrwx   0 straw     (1000) straw     (1000)        0 2020-10-18 20:24:27.386176 cgkit1-1.2.6/cgkit1.egg-info/
--rwxrwxrwx   0 straw     (1000) straw     (1000)     2882 2020-10-18 20:24:27.000000 cgkit1-1.2.6/cgkit1.egg-info/PKG-INFO
--rwxrwxrwx   0 straw     (1000) straw     (1000)      302 2020-10-18 20:24:27.000000 cgkit1-1.2.6/cgkit1.egg-info/SOURCES.txt
--rwxrwxrwx   0 straw     (1000) straw     (1000)        1 2020-10-18 20:24:27.000000 cgkit1-1.2.6/cgkit1.egg-info/dependency_links.txt
--rwxrwxrwx   0 straw     (1000) straw     (1000)       28 2020-10-18 20:24:27.000000 cgkit1-1.2.6/cgkit1.egg-info/top_level.txt
--rwxrwxrwx   0 straw     (1000) straw     (1000)      566 2020-10-18 20:21:35.000000 cgkit1-1.2.6/cgkitinfo.py
--rwxrwxrwx   0 straw     (1000) straw     (1000)   146572 2020-06-17 21:44:00.000000 cgkit1-1.2.6/cgtypes.pyx
-drwxrwxrwx   0 straw     (1000) straw     (1000)        0 2020-10-18 20:24:27.476176 cgkit1-1.2.6/pycgtypes/
--rwxrwxrwx   0 straw     (1000) straw     (1000)      467 2020-04-06 21:43:42.000000 cgkit1-1.2.6/pycgtypes/__init__.py
--rwxrwxrwx   0 straw     (1000) straw     (1000)    13495 2020-04-06 21:43:42.000000 cgkit1-1.2.6/pycgtypes/mat3.py
--rwxrwxrwx   0 straw     (1000) straw     (1000)    23619 2020-04-06 21:43:42.000000 cgkit1-1.2.6/pycgtypes/mat4.py
--rwxrwxrwx   0 straw     (1000) straw     (1000)    11436 2020-04-06 21:43:42.000000 cgkit1-1.2.6/pycgtypes/quat.py
--rwxrwxrwx   0 straw     (1000) straw     (1000)    13820 2020-04-06 21:43:42.000000 cgkit1-1.2.6/pycgtypes/vec3.py
--rwxrwxrwx   0 straw     (1000) straw     (1000)    12180 2020-04-06 21:43:42.000000 cgkit1-1.2.6/pycgtypes/vec4.py
--rwxrwxrwx   0 straw     (1000) straw     (1000)      147 2020-06-16 21:54:19.000000 cgkit1-1.2.6/pyproject.toml
--rwxrwxrwx   0 straw     (1000) straw     (1000)       38 2020-10-18 20:24:27.496176 cgkit1-1.2.6/setup.cfg
--rwxrwxrwx   0 straw     (1000) straw     (1000)     1509 2020-10-18 20:21:17.000000 cgkit1-1.2.6/setup.py
+drwxrwxrwx   0        0        0        0 2020-12-12 21:26:34.000000 cgkit1-1.2.7/
+drwxrwxrwx   0        0        0        0 2020-12-12 21:26:34.000000 cgkit1-1.2.7/cgkit1.egg-info/
+-rw-rw-rw-   0        0        0        1 2020-12-12 21:26:33.000000 cgkit1-1.2.7/cgkit1.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0     2950 2020-12-12 21:26:33.000000 cgkit1-1.2.7/cgkit1.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      302 2020-12-12 21:26:33.000000 cgkit1-1.2.7/cgkit1.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0       28 2020-12-12 21:26:33.000000 cgkit1-1.2.7/cgkit1.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0      566 2020-12-12 21:25:50.000000 cgkit1-1.2.7/cgkitinfo.py
+-rw-rw-rw-   0        0        0   147017 2020-12-12 21:22:20.000000 cgkit1-1.2.7/cgtypes.pyx
+-rw-rw-rw-   0        0        0       38 2020-04-07 09:07:49.000000 cgkit1-1.2.7/MANIFEST.in
+-rw-rw-rw-   0        0        0     2950 2020-12-12 21:26:34.000000 cgkit1-1.2.7/PKG-INFO
+drwxrwxrwx   0        0        0        0 2020-12-12 21:26:34.000000 cgkit1-1.2.7/pycgtypes/
+-rw-rw-rw-   0        0        0    13495 2020-04-06 21:43:42.000000 cgkit1-1.2.7/pycgtypes/mat3.py
+-rw-rw-rw-   0        0        0    23619 2020-04-06 21:43:42.000000 cgkit1-1.2.7/pycgtypes/mat4.py
+-rw-rw-rw-   0        0        0    11436 2020-04-06 21:43:42.000000 cgkit1-1.2.7/pycgtypes/quat.py
+-rw-rw-rw-   0        0        0    13820 2020-04-06 21:43:42.000000 cgkit1-1.2.7/pycgtypes/vec3.py
+-rw-rw-rw-   0        0        0    12180 2020-04-06 21:43:42.000000 cgkit1-1.2.7/pycgtypes/vec4.py
+-rw-rw-rw-   0        0        0      467 2020-04-06 21:43:42.000000 cgkit1-1.2.7/pycgtypes/__init__.py
+-rw-rw-rw-   0        0        0      147 2020-06-16 21:54:19.000000 cgkit1-1.2.7/pyproject.toml
+-rw-rw-rw-   0        0        0     2116 2020-06-16 21:54:15.000000 cgkit1-1.2.7/README.md
+-rw-rw-rw-   0        0        0       42 2020-12-12 21:26:34.000000 cgkit1-1.2.7/setup.cfg
+-rw-rw-rw-   0        0        0     1508 2020-12-12 21:25:36.000000 cgkit1-1.2.7/setup.py
```

### filetype from file(1)

```diff
@@ -1 +1 @@
-POSIX tar archive
+POSIX tar archive (GNU)
```

### Comparing `cgkit1-1.2.6/PKG-INFO` & `cgkit1-1.2.7/cgkit1.egg-info/PKG-INFO`

 * *Files 12% similar despite different names*

```diff
@@ -1,68 +1,68 @@
-Metadata-Version: 2.1
-Name: cgkit1
-Version: 1.2.6
-Summary: Python Computer Graphics Kit v1
-Home-page: https://github.com/strawlab/cgkit1
-Maintainer: Andrew Straw
-Maintainer-email: strawman@astraw.com
-License: BSD license, see license.txt
-Description: # cgkit1
-        
-        [![build](https://github.com/strawlab/cgkit1/workflows/build-and-test/badge.svg?branch=master)](https://github.com/strawlab/cgkit1/actions?query=branch%3Amaster)
-        [![PyPI version](https://badge.fury.io/py/cgkit1.svg)](https://badge.fury.io/py/cgkit1)
-        
-        This is a fork of Matthias Bass's python-cgkit v1.2.0.
-        
-        It has been updated to be compatible with Python 2 and 3 and has the
-        renderman and noise generation code removed.
-        
-        <hr>
-        Python Computer Graphics Kit v1.2.0
-        
-        Copyright (C) 2002, Matthias Baas (see license.txt)
-        <hr>
-        
-        The Python Computer Graphics Kit is a collection of Python modules
-        that contain the basic types and functions to be able to create 3D
-        computer graphics images. The kit mainly focuses on Pixar's RenderMan
-        interface, but some modules can also be used for OpenGL programs or
-        non-RenderMan compliant renderers like POV-Ray, for example.
-        
-        ## Installing the package
-        
-        The package uses the Python distutils, so compiling and installing
-        looks the same on every platform, you simply have to call:
-        
-        ```
-        python setup.py install
-        ```
-        
-        This will compile the C-modules and install everything in the standard
-        location. See the distutils documentation that are coming with Python
-        if you have to install somewhere else.
-        If you've updated the sources for cgkit I recommend to delete the "build"
-        directory before compiling so that all the old code is out of the way.
-        
-        The cgtypes module uses Pyrex (v0.9 or higher required) to generate
-        the C source file. The generated C file is included in the source
-        package, so you only need Pyrex if you want to modify the cgtypes module.
-        
-        Once installed you can check the examples in the examples directory.
-        
-        IMPORTANT:
-        
-        If you've installed a version before v1.0beta3 you have to remove
-        the directory Lib/site-packages/cgtypes in your Python distribution.
-        Otherwise Python will access the old Python types instead of the
-        new C types (which are located directly in Lib/site-packages).
-        
-        ## Documentation
-        
-        The documentation has to be downloaded separatly or you can browse
-        it online. Whatever you prefer, you should point your browser to:
-        
-        http://cgkit.sourceforge.net
-        
-        
-Platform: UNKNOWN
-Description-Content-Type: text/markdown
+Metadata-Version: 2.1
+Name: cgkit1
+Version: 1.2.7
+Summary: Python Computer Graphics Kit v1
+Home-page: https://github.com/strawlab/cgkit1
+Maintainer: Andrew Straw
+Maintainer-email: strawman@astraw.com
+License: BSD license, see license.txt
+Description: # cgkit1
+        
+        [![build](https://github.com/strawlab/cgkit1/workflows/build-and-test/badge.svg?branch=master)](https://github.com/strawlab/cgkit1/actions?query=branch%3Amaster)
+        [![PyPI version](https://badge.fury.io/py/cgkit1.svg)](https://badge.fury.io/py/cgkit1)
+        
+        This is a fork of Matthias Bass's python-cgkit v1.2.0.
+        
+        It has been updated to be compatible with Python 2 and 3 and has the
+        renderman and noise generation code removed.
+        
+        <hr>
+        Python Computer Graphics Kit v1.2.0
+        
+        Copyright (C) 2002, Matthias Baas (see license.txt)
+        <hr>
+        
+        The Python Computer Graphics Kit is a collection of Python modules
+        that contain the basic types and functions to be able to create 3D
+        computer graphics images. The kit mainly focuses on Pixar's RenderMan
+        interface, but some modules can also be used for OpenGL programs or
+        non-RenderMan compliant renderers like POV-Ray, for example.
+        
+        ## Installing the package
+        
+        The package uses the Python distutils, so compiling and installing
+        looks the same on every platform, you simply have to call:
+        
+        ```
+        python setup.py install
+        ```
+        
+        This will compile the C-modules and install everything in the standard
+        location. See the distutils documentation that are coming with Python
+        if you have to install somewhere else.
+        If you've updated the sources for cgkit I recommend to delete the "build"
+        directory before compiling so that all the old code is out of the way.
+        
+        The cgtypes module uses Pyrex (v0.9 or higher required) to generate
+        the C source file. The generated C file is included in the source
+        package, so you only need Pyrex if you want to modify the cgtypes module.
+        
+        Once installed you can check the examples in the examples directory.
+        
+        IMPORTANT:
+        
+        If you've installed a version before v1.0beta3 you have to remove
+        the directory Lib/site-packages/cgtypes in your Python distribution.
+        Otherwise Python will access the old Python types instead of the
+        new C types (which are located directly in Lib/site-packages).
+        
+        ## Documentation
+        
+        The documentation has to be downloaded separatly or you can browse
+        it online. Whatever you prefer, you should point your browser to:
+        
+        http://cgkit.sourceforge.net
+        
+        
+Platform: UNKNOWN
+Description-Content-Type: text/markdown
```

### Comparing `cgkit1-1.2.6/README.md` & `cgkit1-1.2.7/README.md`

 * *Files identical despite different names*

### Comparing `cgkit1-1.2.6/cgkit1.egg-info/PKG-INFO` & `cgkit1-1.2.7/PKG-INFO`

 * *Files 12% similar despite different names*

```diff
@@ -1,68 +1,68 @@
-Metadata-Version: 2.1
-Name: cgkit1
-Version: 1.2.6
-Summary: Python Computer Graphics Kit v1
-Home-page: https://github.com/strawlab/cgkit1
-Maintainer: Andrew Straw
-Maintainer-email: strawman@astraw.com
-License: BSD license, see license.txt
-Description: # cgkit1
-        
-        [![build](https://github.com/strawlab/cgkit1/workflows/build-and-test/badge.svg?branch=master)](https://github.com/strawlab/cgkit1/actions?query=branch%3Amaster)
-        [![PyPI version](https://badge.fury.io/py/cgkit1.svg)](https://badge.fury.io/py/cgkit1)
-        
-        This is a fork of Matthias Bass's python-cgkit v1.2.0.
-        
-        It has been updated to be compatible with Python 2 and 3 and has the
-        renderman and noise generation code removed.
-        
-        <hr>
-        Python Computer Graphics Kit v1.2.0
-        
-        Copyright (C) 2002, Matthias Baas (see license.txt)
-        <hr>
-        
-        The Python Computer Graphics Kit is a collection of Python modules
-        that contain the basic types and functions to be able to create 3D
-        computer graphics images. The kit mainly focuses on Pixar's RenderMan
-        interface, but some modules can also be used for OpenGL programs or
-        non-RenderMan compliant renderers like POV-Ray, for example.
-        
-        ## Installing the package
-        
-        The package uses the Python distutils, so compiling and installing
-        looks the same on every platform, you simply have to call:
-        
-        ```
-        python setup.py install
-        ```
-        
-        This will compile the C-modules and install everything in the standard
-        location. See the distutils documentation that are coming with Python
-        if you have to install somewhere else.
-        If you've updated the sources for cgkit I recommend to delete the "build"
-        directory before compiling so that all the old code is out of the way.
-        
-        The cgtypes module uses Pyrex (v0.9 or higher required) to generate
-        the C source file. The generated C file is included in the source
-        package, so you only need Pyrex if you want to modify the cgtypes module.
-        
-        Once installed you can check the examples in the examples directory.
-        
-        IMPORTANT:
-        
-        If you've installed a version before v1.0beta3 you have to remove
-        the directory Lib/site-packages/cgtypes in your Python distribution.
-        Otherwise Python will access the old Python types instead of the
-        new C types (which are located directly in Lib/site-packages).
-        
-        ## Documentation
-        
-        The documentation has to be downloaded separatly or you can browse
-        it online. Whatever you prefer, you should point your browser to:
-        
-        http://cgkit.sourceforge.net
-        
-        
-Platform: UNKNOWN
-Description-Content-Type: text/markdown
+Metadata-Version: 2.1
+Name: cgkit1
+Version: 1.2.7
+Summary: Python Computer Graphics Kit v1
+Home-page: https://github.com/strawlab/cgkit1
+Maintainer: Andrew Straw
+Maintainer-email: strawman@astraw.com
+License: BSD license, see license.txt
+Description: # cgkit1
+        
+        [![build](https://github.com/strawlab/cgkit1/workflows/build-and-test/badge.svg?branch=master)](https://github.com/strawlab/cgkit1/actions?query=branch%3Amaster)
+        [![PyPI version](https://badge.fury.io/py/cgkit1.svg)](https://badge.fury.io/py/cgkit1)
+        
+        This is a fork of Matthias Bass's python-cgkit v1.2.0.
+        
+        It has been updated to be compatible with Python 2 and 3 and has the
+        renderman and noise generation code removed.
+        
+        <hr>
+        Python Computer Graphics Kit v1.2.0
+        
+        Copyright (C) 2002, Matthias Baas (see license.txt)
+        <hr>
+        
+        The Python Computer Graphics Kit is a collection of Python modules
+        that contain the basic types and functions to be able to create 3D
+        computer graphics images. The kit mainly focuses on Pixar's RenderMan
+        interface, but some modules can also be used for OpenGL programs or
+        non-RenderMan compliant renderers like POV-Ray, for example.
+        
+        ## Installing the package
+        
+        The package uses the Python distutils, so compiling and installing
+        looks the same on every platform, you simply have to call:
+        
+        ```
+        python setup.py install
+        ```
+        
+        This will compile the C-modules and install everything in the standard
+        location. See the distutils documentation that are coming with Python
+        if you have to install somewhere else.
+        If you've updated the sources for cgkit I recommend to delete the "build"
+        directory before compiling so that all the old code is out of the way.
+        
+        The cgtypes module uses Pyrex (v0.9 or higher required) to generate
+        the C source file. The generated C file is included in the source
+        package, so you only need Pyrex if you want to modify the cgtypes module.
+        
+        Once installed you can check the examples in the examples directory.
+        
+        IMPORTANT:
+        
+        If you've installed a version before v1.0beta3 you have to remove
+        the directory Lib/site-packages/cgtypes in your Python distribution.
+        Otherwise Python will access the old Python types instead of the
+        new C types (which are located directly in Lib/site-packages).
+        
+        ## Documentation
+        
+        The documentation has to be downloaded separatly or you can browse
+        it online. Whatever you prefer, you should point your browser to:
+        
+        http://cgkit.sourceforge.net
+        
+        
+Platform: UNKNOWN
+Description-Content-Type: text/markdown
```

### Comparing `cgkit1-1.2.6/cgkitinfo.py` & `cgkit1-1.2.7/cgkitinfo.py`

 * *Files 2% similar despite different names*

```diff
@@ -11,9 +11,9 @@
 # http://cgkit.sourceforge.net
 #
 # You may distribute under the terms of the BSD license, as
 # specified in the file license.txt.
 ####################################################################
 
 # also update setup.py
-version_info = (1, 2, 6, "final")
-version = "1.2.6"
+version_info = (1, 2, 7, "final")
+version = "1.2.7"
```

### Comparing `cgkit1-1.2.6/cgtypes.pyx` & `cgkit1-1.2.7/cgtypes.pyx`

 * *Files 1% similar despite different names*

```diff
@@ -545,8617 +545,8645 @@
 00002200: 2e7a 0a20 2020 2020 2020 2020 2020 2020  .z.             
 00002210: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
 00002220: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
 00002230: 6545 7272 6f72 2c20 2275 6e73 7570 706f  eError, "unsuppo
 00002240: 7274 6564 206f 7065 7261 6e64 2074 7970  rted operand typ
 00002250: 6520 666f 7220 2a22 0a0a 2020 2020 6465  e for *"..    de
 00002260: 6620 5f5f 6469 765f 5f28 7665 6333 2061  f __div__(vec3 a
-00002270: 2c20 6229 3a0a 2020 2020 2020 2020 2222  , b):.        ""
-00002280: 2244 6976 6973 696f 6e20 6279 2073 6361  "Division by sca
-00002290: 6c61 720a 0a20 2020 2020 2020 203e 3e3e  lar..        >>>
-000022a0: 2061 3d76 6563 3328 312e 302c 2030 2e35   a=vec3(1.0, 0.5
-000022b0: 2c20 2d31 2e38 290a 2020 2020 2020 2020  , -1.8).        
-000022c0: 3e3e 3e20 7072 696e 7420 612f 322e 300a  >>> print a/2.0.
-000022d0: 2020 2020 2020 2020 2830 2e35 3030 302c          (0.5000,
-000022e0: 2030 2e32 3530 302c 202d 302e 3930 3030   0.2500, -0.9000
-000022f0: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
-00002300: 2020 2020 2020 6364 6566 2076 6563 3320        cdef vec3 
-00002310: 7265 730a 2020 2020 2020 2020 6364 6566  res.        cdef
-00002320: 2064 6f75 626c 6520 720a 0a20 2020 2020   double r..     
-00002330: 2020 2074 6220 3d20 7479 7065 2862 290a     tb = type(b).
-00002340: 0a20 2020 2020 2020 2069 6620 7462 2069  .        if tb i
-00002350: 7320 666c 6f61 7420 6f72 2074 6220 6973  s float or tb is
-00002360: 2069 6e74 206f 7220 7462 2069 7320 6c6f   int or tb is lo
-00002370: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
-00002380: 2320 7665 6333 2f73 6361 6c61 720a 2020  # vec3/scalar.  
-00002390: 2020 2020 2020 2020 2020 7265 7320 3d20            res = 
-000023a0: 7665 6333 2829 0a20 2020 2020 2020 2020  vec3().         
-000023b0: 2020 2072 203d 2062 0a20 2020 2020 2020     r = b.       
-000023c0: 2020 2020 2069 6620 6661 6273 2872 293c       if fabs(r)<
-000023d0: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
-000023e0: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
-000023f0: 4469 7669 7369 6f6e 4572 726f 722c 2276  DivisionError,"v
-00002400: 6563 3320 6469 7669 7369 6f6e 220a 2020  ec3 division".  
-00002410: 2020 2020 2020 2020 2020 7265 732e 7820            res.x 
-00002420: 3d20 612e 782f 720a 2020 2020 2020 2020  = a.x/r.        
-00002430: 2020 2020 7265 732e 7920 3d20 612e 792f      res.y = a.y/
-00002440: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
-00002450: 732e 7a20 3d20 612e 7a2f 720a 2020 2020  s.z = a.z/r.    
-00002460: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00002470: 6573 0a20 2020 2020 2020 2065 6c73 653a  es.        else:
-00002480: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00002490: 7365 2054 7970 6545 7272 6f72 2c20 2275  se TypeError, "u
-000024a0: 6e73 7570 706f 7274 6564 206f 7065 7261  nsupported opera
-000024b0: 6e64 2074 7970 6520 666f 7220 2f22 0a0a  nd type for /"..
-000024c0: 2020 2020 6465 6620 5f5f 6d6f 645f 5f28      def __mod__(
-000024d0: 7665 6333 2073 656c 662c 2062 293a 0a20  vec3 self, b):. 
-000024e0: 2020 2020 2020 2022 2222 4d6f 6475 6c6f         """Modulo
-000024f0: 2028 636f 6d70 6f6e 656e 7420 7769 7365   (component wise
-00002500: 292e 0a0a 2020 2020 2020 2020 3e3e 3e20  )...        >>> 
-00002510: 613d 7665 6333 2833 2e30 2c20 322e 352c  a=vec3(3.0, 2.5,
-00002520: 202d 312e 3829 0a20 2020 2020 2020 203e   -1.8).        >
-00002530: 3e3e 2070 7269 6e74 2061 2532 2e30 0a20  >> print a%2.0. 
-00002540: 2020 2020 2020 2028 312e 3030 3030 2c20         (1.0000, 
-00002550: 302e 3530 3030 2c20 302e 3230 3030 290a  0.5000, 0.2000).
-00002560: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00002570: 2020 2020 6364 6566 2076 6563 3320 7265      cdef vec3 re
-00002580: 732c 2076 620a 2020 2020 2020 2020 6364  s, vb.        cd
-00002590: 6566 2064 6f75 626c 6520 720a 0a20 2020  ef double r..   
-000025a0: 2020 2020 2074 6220 3d20 7479 7065 2862       tb = type(b
-000025b0: 290a 0a20 2020 2020 2020 2069 6620 7462  )..        if tb
-000025c0: 2069 7320 666c 6f61 7420 6f72 2074 6220   is float or tb 
-000025d0: 6973 2069 6e74 206f 7220 7462 2069 7320  is int or tb is 
-000025e0: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
-000025f0: 2020 2320 7665 6333 2573 6361 6c61 720a    # vec3%scalar.
-00002600: 2020 2020 2020 2020 2020 2020 7265 7320              res 
-00002610: 3d20 7665 6333 2829 0a20 2020 2020 2020  = vec3().       
-00002620: 2020 2020 2072 203d 2062 0a20 2020 2020       r = b.     
-00002630: 2020 2020 2020 2069 6620 6661 6273 2872         if fabs(r
-00002640: 293c 3d65 7073 3a0a 2020 2020 2020 2020  )<=eps:.        
-00002650: 2020 2020 2020 2020 7261 6973 6520 5a65          raise Ze
-00002660: 726f 4469 7669 7369 6f6e 4572 726f 722c  roDivisionError,
-00002670: 2276 6563 3320 6d6f 6475 6c6f 220a 2020  "vec3 modulo".  
-00002680: 2020 2020 2020 2020 2020 7265 732e 7820            res.x 
-00002690: 3d20 5f66 6d6f 6428 7365 6c66 2e78 2c72  = _fmod(self.x,r
-000026a0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-000026b0: 732e 7920 3d20 5f66 6d6f 6428 7365 6c66  s.y = _fmod(self
-000026c0: 2e79 2c72 290a 2020 2020 2020 2020 2020  .y,r).          
-000026d0: 2020 7265 732e 7a20 3d20 5f66 6d6f 6428    res.z = _fmod(
-000026e0: 7365 6c66 2e7a 2c72 290a 2020 2020 2020  self.z,r).      
-000026f0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00002700: 0a20 2020 2020 2020 2065 6c69 6620 7462  .        elif tb
-00002710: 2069 7320 7665 6333 3a0a 2020 2020 2020   is vec3:.      
-00002720: 2020 2020 2020 2320 7665 6333 2576 6563        # vec3%vec
-00002730: 330a 2020 2020 2020 2020 2020 2020 7265  3.            re
-00002740: 7320 3d20 7665 6333 2829 0a20 2020 2020  s = vec3().     
-00002750: 2020 2020 2020 2076 6220 3d20 620a 2020         vb = b.  
-00002760: 2020 2020 2020 2020 2020 6966 2066 6162            if fab
-00002770: 7328 7662 2e78 293c 3d65 7073 206f 7220  s(vb.x)<=eps or 
-00002780: 6661 6273 2876 622e 7929 3c3d 6570 7320  fabs(vb.y)<=eps 
-00002790: 6f72 2066 6162 7328 7662 2e7a 293c 3d65  or fabs(vb.z)<=e
-000027a0: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
-000027b0: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
-000027c0: 7669 7369 6f6e 4572 726f 722c 2276 6563  visionError,"vec
-000027d0: 3320 6d6f 6475 6c6f 220a 2020 2020 2020  3 modulo".      
-000027e0: 2020 2020 2020 7265 732e 7820 3d20 5f66        res.x = _f
-000027f0: 6d6f 6428 7365 6c66 2e78 2c20 7662 2e78  mod(self.x, vb.x
-00002800: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00002810: 732e 7920 3d20 5f66 6d6f 6428 7365 6c66  s.y = _fmod(self
-00002820: 2e79 2c20 7662 2e79 290a 2020 2020 2020  .y, vb.y).      
-00002830: 2020 2020 2020 7265 732e 7a20 3d20 5f66        res.z = _f
-00002840: 6d6f 6428 7365 6c66 2e7a 2c20 7662 2e7a  mod(self.z, vb.z
-00002850: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00002860: 7475 726e 2072 6573 0a20 2020 2020 2020  turn res.       
-00002870: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00002880: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00002890: 6f72 2c20 2275 6e73 7570 706f 7274 6564  or, "unsupported
-000028a0: 206f 7065 7261 6e64 2074 7970 6520 666f   operand type fo
-000028b0: 7220 2522 0a0a 2020 2020 6465 6620 5f5f  r %"..    def __
-000028c0: 6e65 675f 5f28 7365 6c66 293a 0a20 2020  neg__(self):.   
-000028d0: 2020 2020 2022 2222 4e65 6761 7469 6f6e       """Negation
-000028e0: 0a0a 2020 2020 2020 2020 3e3e 3e20 613d  ..        >>> a=
-000028f0: 7665 6333 2833 2e30 2c20 322e 352c 202d  vec3(3.0, 2.5, -
-00002900: 312e 3829 0a20 2020 2020 2020 203e 3e3e  1.8).        >>>
-00002910: 2070 7269 6e74 202d 610a 2020 2020 2020   print -a.      
-00002920: 2020 282d 332e 3030 3030 2c20 2d32 2e35    (-3.0000, -2.5
-00002930: 3030 302c 2031 2e38 3030 3029 0a20 2020  000, 1.8000).   
-00002940: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00002950: 2063 6465 6620 7665 6333 2072 6573 0a20   cdef vec3 res. 
-00002960: 2020 2020 2020 2072 6573 203d 2076 6563         res = vec
-00002970: 3328 290a 2020 2020 2020 2020 7265 732e  3().        res.
-00002980: 7820 3d20 2d73 656c 662e 780a 2020 2020  x = -self.x.    
-00002990: 2020 2020 7265 732e 7920 3d20 2d73 656c      res.y = -sel
-000029a0: 662e 790a 2020 2020 2020 2020 7265 732e  f.y.        res.
-000029b0: 7a20 3d20 2d73 656c 662e 7a0a 2020 2020  z = -self.z.    
-000029c0: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-000029d0: 2020 2020 6465 6620 5f5f 706f 735f 5f28      def __pos__(
-000029e0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-000029f0: 2222 0a20 2020 2020 2020 203e 3e3e 2061  "".        >>> a
-00002a00: 3d76 6563 3328 332e 302c 2032 2e35 2c20  =vec3(3.0, 2.5, 
-00002a10: 2d31 2e38 290a 2020 2020 2020 2020 3e3e  -1.8).        >>
-00002a20: 3e20 7072 696e 7420 2b61 0a20 2020 2020  > print +a.     
-00002a30: 2020 2028 332e 3030 3030 2c20 322e 3530     (3.0000, 2.50
-00002a40: 3030 2c20 2d31 2e38 3030 3029 0a20 2020  00, -1.8000).   
-00002a50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00002a60: 2063 6465 6620 7665 6333 2072 6573 0a20   cdef vec3 res. 
-00002a70: 2020 2020 2020 2072 6573 203d 2076 6563         res = vec
-00002a80: 3328 290a 2020 2020 2020 2020 7265 732e  3().        res.
-00002a90: 7820 3d20 7365 6c66 2e78 0a20 2020 2020  x = self.x.     
-00002aa0: 2020 2072 6573 2e79 203d 2073 656c 662e     res.y = self.
-00002ab0: 790a 2020 2020 2020 2020 7265 732e 7a20  y.        res.z 
-00002ac0: 3d20 7365 6c66 2e7a 0a20 2020 2020 2020  = self.z.       
-00002ad0: 2072 6574 7572 6e20 7265 730a 0a0a 2020   return res...  
-00002ae0: 2020 6465 6620 5f5f 6961 6464 5f5f 2873    def __iadd__(s
-00002af0: 656c 662c 2076 6563 3320 6f74 6865 7229  elf, vec3 other)
-00002b00: 3a0a 2020 2020 2020 2020 2222 2249 6e6c  :.        """Inl
-00002b10: 696e 6520 7665 6374 6f72 2061 6464 6974  ine vector addit
-00002b20: 696f 6e2e 0a0a 2020 2020 2020 2020 3e3e  ion...        >>
-00002b30: 3e20 613d 7665 6333 2831 2e30 2c20 302e  > a=vec3(1.0, 0.
-00002b40: 352c 202d 312e 3829 0a20 2020 2020 2020  5, -1.8).       
-00002b50: 203e 3e3e 2062 3d76 6563 3328 2d30 2e33   >>> b=vec3(-0.3
-00002b60: 2c20 302e 3735 2c20 302e 3529 0a20 2020  , 0.75, 0.5).   
-00002b70: 2020 2020 203e 3e3e 2061 2b3d 620a 2020       >>> a+=b.  
-00002b80: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00002b90: 610a 2020 2020 2020 2020 2830 2e37 3030  a.        (0.700
-00002ba0: 302c 2031 2e32 3530 302c 202d 312e 3330  0, 1.2500, -1.30
-00002bb0: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
-00002bc0: 2020 2020 2020 2020 7365 6c66 2e78 3d73          self.x=s
-00002bd0: 656c 662e 782b 6f74 6865 722e 780a 2020  elf.x+other.x.  
-00002be0: 2020 2020 2020 7365 6c66 2e79 3d73 656c        self.y=sel
-00002bf0: 662e 792b 6f74 6865 722e 790a 2020 2020  f.y+other.y.    
-00002c00: 2020 2020 7365 6c66 2e7a 3d73 656c 662e      self.z=self.
-00002c10: 7a2b 6f74 6865 722e 7a0a 2020 2020 2020  z+other.z.      
-00002c20: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
-00002c30: 2020 2064 6566 205f 5f69 7375 625f 5f28     def __isub__(
-00002c40: 7365 6c66 2c20 7665 6333 206f 7468 6572  self, vec3 other
-00002c50: 293a 0a20 2020 2020 2020 2022 2222 496e  ):.        """In
-00002c60: 6c69 6e65 2076 6563 746f 7220 7375 6274  line vector subt
-00002c70: 7261 6374 696f 6e2e 0a0a 2020 2020 2020  raction...      
-00002c80: 2020 3e3e 3e20 613d 7665 6333 2831 2e30    >>> a=vec3(1.0
-00002c90: 2c20 302e 352c 202d 312e 3829 0a20 2020  , 0.5, -1.8).   
-00002ca0: 2020 2020 203e 3e3e 2062 3d76 6563 3328       >>> b=vec3(
-00002cb0: 2d30 2e33 2c20 302e 3735 2c20 302e 3529  -0.3, 0.75, 0.5)
-00002cc0: 0a20 2020 2020 2020 203e 3e3e 2061 2d3d  .        >>> a-=
-00002cd0: 620a 2020 2020 2020 2020 3e3e 3e20 7072  b.        >>> pr
-00002ce0: 696e 7420 610a 2020 2020 2020 2020 2831  int a.        (1
-00002cf0: 2e33 3030 302c 202d 302e 3235 3030 2c20  .3000, -0.2500, 
-00002d00: 2d32 2e33 3030 3029 0a20 2020 2020 2020  -2.3000).       
-00002d10: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
-00002d20: 662e 783d 7365 6c66 2e78 2d6f 7468 6572  f.x=self.x-other
-00002d30: 2e78 0a20 2020 2020 2020 2073 656c 662e  .x.        self.
-00002d40: 793d 7365 6c66 2e79 2d6f 7468 6572 2e79  y=self.y-other.y
-00002d50: 0a20 2020 2020 2020 2073 656c 662e 7a3d  .        self.z=
-00002d60: 7365 6c66 2e7a 2d6f 7468 6572 2e7a 0a20  self.z-other.z. 
-00002d70: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00002d80: 6c66 0a0a 2020 2020 6465 6620 5f5f 696d  lf..    def __im
-00002d90: 756c 5f5f 2873 656c 662c 206f 7468 6572  ul__(self, other
-00002da0: 293a 0a20 2020 2020 2020 2022 2222 496e  ):.        """In
-00002db0: 6c69 6e65 206d 756c 7469 706c 6963 6174  line multiplicat
-00002dc0: 696f 6e20 286f 6e6c 7920 7769 7468 2073  ion (only with s
-00002dd0: 6361 6c61 7229 0a0a 2020 2020 2020 2020  calar)..        
-00002de0: 3e3e 3e20 613d 7665 6333 2831 2e30 2c20  >>> a=vec3(1.0, 
-00002df0: 302e 352c 202d 312e 3829 0a20 2020 2020  0.5, -1.8).     
-00002e00: 2020 203e 3e3e 2061 2a3d 322e 300a 2020     >>> a*=2.0.  
-00002e10: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00002e20: 610a 2020 2020 2020 2020 2832 2e30 3030  a.        (2.000
-00002e30: 302c 2031 2e30 3030 302c 202d 332e 3630  0, 1.0000, -3.60
-00002e40: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
-00002e50: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
-00002e60: 626c 6520 720a 2020 2020 2020 2020 7462  ble r.        tb
-00002e70: 203d 2074 7970 6528 6f74 6865 7229 0a20   = type(other). 
-00002e80: 2020 2020 2020 2069 6620 7462 2069 7320         if tb is 
-00002e90: 666c 6f61 7420 6f72 2074 6220 6973 2069  float or tb is i
-00002ea0: 6e74 206f 7220 7462 2069 7320 6c6f 6e67  nt or tb is long
-00002eb0: 3a0a 2020 2020 2020 2020 2020 2020 723d  :.            r=
-00002ec0: 6f74 6865 720a 2020 2020 2020 2020 2020  other.          
-00002ed0: 2020 7365 6c66 2e78 3d73 656c 662e 782a    self.x=self.x*
-00002ee0: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-00002ef0: 6c66 2e79 3d73 656c 662e 792a 720a 2020  lf.y=self.y*r.  
-00002f00: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
-00002f10: 3d73 656c 662e 7a2a 720a 2020 2020 2020  =self.z*r.      
-00002f20: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00002f30: 660a 2020 2020 2020 2020 656c 7365 3a0a  f.        else:.
-00002f40: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00002f50: 6520 5479 7065 4572 726f 722c 2022 756e  e TypeError, "un
-00002f60: 7375 7070 6f72 7465 6420 6f70 6572 616e  supported operan
-00002f70: 6420 7479 7065 2066 6f72 202a 3d22 0a0a  d type for *="..
-00002f80: 2020 2020 6465 6620 5f5f 6964 6976 5f5f      def __idiv__
-00002f90: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
-00002fa0: 2020 2020 2020 2022 2222 496e 6c69 6e65         """Inline
-00002fb0: 2064 6976 6973 696f 6e20 7769 7468 2073   division with s
-00002fc0: 6361 6c61 720a 0a20 2020 2020 2020 203e  calar..        >
-00002fd0: 3e3e 2061 3d76 6563 3328 312e 302c 2030  >> a=vec3(1.0, 0
-00002fe0: 2e35 2c20 2d31 2e38 290a 2020 2020 2020  .5, -1.8).      
-00002ff0: 2020 3e3e 3e20 612f 3d32 2e30 0a20 2020    >>> a/=2.0.   
-00003000: 2020 2020 203e 3e3e 2070 7269 6e74 2061       >>> print a
-00003010: 0a20 2020 2020 2020 2028 302e 3530 3030  .        (0.5000
-00003020: 2c20 302e 3235 3030 2c20 2d30 2e39 3030  , 0.2500, -0.900
-00003030: 3029 0a20 2020 2020 2020 2022 2222 0a20  0).        """. 
-00003040: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-00003050: 6c65 2072 0a20 2020 2020 2020 2074 6220  le r.        tb 
-00003060: 3d20 7479 7065 286f 7468 6572 290a 2020  = type(other).  
-00003070: 2020 2020 2020 6966 2074 6220 6973 2066        if tb is f
-00003080: 6c6f 6174 206f 7220 7462 2069 7320 696e  loat or tb is in
-00003090: 7420 6f72 2074 6220 6973 206c 6f6e 673a  t or tb is long:
-000030a0: 0a20 2020 2020 2020 2020 2020 2072 3d6f  .            r=o
-000030b0: 7468 6572 0a20 2020 2020 2020 2020 2020  ther.           
-000030c0: 2069 6620 6661 6273 2872 293c 3d65 7073   if fabs(r)<=eps
-000030d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000030e0: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
-000030f0: 7369 6f6e 4572 726f 722c 2276 6563 3320  sionError,"vec3 
-00003100: 6469 7669 7369 6f6e 220a 2020 2020 2020  division".      
-00003110: 2020 2020 2020 7365 6c66 2e78 3d73 656c        self.x=sel
-00003120: 662e 782f 720a 2020 2020 2020 2020 2020  f.x/r.          
-00003130: 2020 7365 6c66 2e79 3d73 656c 662e 792f    self.y=self.y/
-00003140: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-00003150: 6c66 2e7a 3d73 656c 662e 7a2f 720a 2020  lf.z=self.z/r.  
-00003160: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00003170: 2073 656c 660a 2020 2020 2020 2020 656c   self.        el
-00003180: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00003190: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
-000031a0: 2022 756e 7375 7070 6f72 7465 6420 6f70   "unsupported op
-000031b0: 6572 616e 6420 7479 7065 2066 6f72 202f  erand type for /
-000031c0: 3d22 0a0a 2020 2020 6465 6620 5f5f 696d  ="..    def __im
-000031d0: 6f64 5f5f 2873 656c 662c 2062 293a 0a20  od__(self, b):. 
-000031e0: 2020 2020 2020 2022 2222 496e 6c69 6e65         """Inline
-000031f0: 206d 6f64 756c 6f2e 0a0a 2020 2020 2020   modulo...      
-00003200: 2020 3e3e 3e20 613d 7665 6333 2833 2e30    >>> a=vec3(3.0
-00003210: 2c20 322e 352c 202d 312e 3829 0a20 2020  , 2.5, -1.8).   
-00003220: 2020 2020 203e 3e3e 2061 253d 322e 300a       >>> a%=2.0.
-00003230: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00003240: 7420 610a 2020 2020 2020 2020 2831 2e30  t a.        (1.0
-00003250: 3030 302c 2030 2e35 3030 302c 2030 2e32  000, 0.5000, 0.2
-00003260: 3030 3029 0a20 2020 2020 2020 2022 2222  000).        """
-00003270: 0a20 2020 2020 2020 2063 6465 6620 7665  .        cdef ve
-00003280: 6333 2076 620a 2020 2020 2020 2020 6364  c3 vb.        cd
-00003290: 6566 2064 6f75 626c 6520 720a 0a20 2020  ef double r..   
-000032a0: 2020 2020 2074 6220 3d20 7479 7065 2862       tb = type(b
-000032b0: 290a 0a20 2020 2020 2020 2069 6620 7462  )..        if tb
-000032c0: 2069 7320 666c 6f61 7420 6f72 2074 6220   is float or tb 
-000032d0: 6973 2069 6e74 206f 7220 7462 2069 7320  is int or tb is 
-000032e0: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
-000032f0: 2020 2320 7665 6333 253d 7363 616c 6172    # vec3%=scalar
-00003300: 0a20 2020 2020 2020 2020 2020 2072 203d  .            r =
-00003310: 2062 0a20 2020 2020 2020 2020 2020 2069   b.            i
-00003320: 6620 6661 6273 2872 293c 3d65 7073 3a0a  f fabs(r)<=eps:.
-00003330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003340: 7261 6973 6520 5a65 726f 4469 7669 7369  raise ZeroDivisi
-00003350: 6f6e 4572 726f 722c 2276 6563 3320 6d6f  onError,"vec3 mo
-00003360: 6475 6c6f 220a 2020 2020 2020 2020 2020  dulo".          
-00003370: 2020 7365 6c66 2e78 203d 205f 666d 6f64    self.x = _fmod
-00003380: 2873 656c 662e 782c 7229 0a20 2020 2020  (self.x,r).     
-00003390: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
-000033a0: 5f66 6d6f 6428 7365 6c66 2e79 2c72 290a  _fmod(self.y,r).
-000033b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000033c0: 2e7a 203d 205f 666d 6f64 2873 656c 662e  .z = _fmod(self.
-000033d0: 7a2c 7229 0a20 2020 2020 2020 2020 2020  z,r).           
-000033e0: 2072 6574 7572 6e20 7365 6c66 0a20 2020   return self.   
-000033f0: 2020 2020 2065 6c69 6620 7462 2069 7320       elif tb is 
-00003400: 7665 6333 3a0a 2020 2020 2020 2020 2020  vec3:.          
-00003410: 2020 2320 7665 6333 253d 7665 6333 0a20    # vec3%=vec3. 
-00003420: 2020 2020 2020 2020 2020 2076 6220 3d20             vb = 
-00003430: 620a 2020 2020 2020 2020 2020 2020 6966  b.            if
-00003440: 2066 6162 7328 7662 2e78 293c 3d65 7073   fabs(vb.x)<=eps
-00003450: 206f 7220 6661 6273 2876 622e 7929 3c3d   or fabs(vb.y)<=
-00003460: 6570 7320 6f72 2066 6162 7328 7662 2e7a  eps or fabs(vb.z
-00003470: 293c 3d65 7073 3a0a 2020 2020 2020 2020  )<=eps:.        
-00003480: 2020 2020 2020 2020 7261 6973 6520 5a65          raise Ze
-00003490: 726f 4469 7669 7369 6f6e 4572 726f 722c  roDivisionError,
-000034a0: 2276 6563 3320 6d6f 6475 6c6f 220a 2020  "vec3 modulo".  
-000034b0: 2020 2020 2020 2020 2020 7365 6c66 2e78            self.x
-000034c0: 203d 205f 666d 6f64 2873 656c 662e 782c   = _fmod(self.x,
-000034d0: 2076 622e 7829 0a20 2020 2020 2020 2020   vb.x).         
-000034e0: 2020 2073 656c 662e 7920 3d20 5f66 6d6f     self.y = _fmo
-000034f0: 6428 7365 6c66 2e79 2c20 7662 2e79 290a  d(self.y, vb.y).
-00003500: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00003510: 2e7a 203d 205f 666d 6f64 2873 656c 662e  .z = _fmod(self.
-00003520: 7a2c 2076 622e 7a29 0a20 2020 2020 2020  z, vb.z).       
-00003530: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00003540: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00003550: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00003560: 2054 7970 6545 7272 6f72 2c20 2275 6e73   TypeError, "uns
-00003570: 7570 706f 7274 6564 206f 7065 7261 6e64  upported operand
-00003580: 2074 7970 6520 666f 7220 253d 220a 0a0a   type for %="...
-00003590: 2020 2020 6465 6620 5f5f 6162 735f 5f28      def __abs__(
-000035a0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-000035b0: 2222 5265 7475 726e 2074 6865 206c 656e  ""Return the len
-000035c0: 6774 6820 6f66 2074 6865 2076 6563 746f  gth of the vecto
-000035d0: 722e 0a0a 2020 2020 2020 2020 6162 7328  r...        abs(
-000035e0: 7629 2069 7320 6571 7569 7661 6c65 6e74  v) is equivalent
-000035f0: 2074 6f20 762e 6c65 6e67 7468 2829 2e0a   to v.length()..
-00003600: 0a20 2020 2020 2020 203e 3e3e 2061 3d76  .        >>> a=v
-00003610: 6563 3328 312e 302c 2030 2e35 2c20 2d31  ec3(1.0, 0.5, -1
-00003620: 2e38 290a 2020 2020 2020 2020 3e3e 3e20  .8).        >>> 
-00003630: 7072 696e 7420 6162 7328 6129 0a20 2020  print abs(a).   
-00003640: 2020 2020 2032 2e31 3138 3936 3230 3130       2.118962010
-00003650: 3034 0a20 2020 2020 2020 2022 2222 0a20  04.        """. 
-00003660: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-00003670: 6c65 2061 0a20 2020 2020 2020 2061 203d  le a.        a =
-00003680: 2073 656c 662e 782a 7365 6c66 2e78 202b   self.x*self.x +
-00003690: 2073 656c 662e 792a 7365 6c66 2e79 202b   self.y*self.y +
-000036a0: 2073 656c 662e 7a2a 7365 6c66 2e7a 0a20   self.z*self.z. 
-000036b0: 2020 2020 2020 2072 6574 7572 6e20 7371         return sq
-000036c0: 7274 2861 290a 0a20 2020 2064 6566 205f  rt(a)..    def _
-000036d0: 5f67 6574 6174 7472 5f5f 2873 656c 662c  _getattr__(self,
-000036e0: 206e 616d 6529 3a0a 2020 2020 2020 2020   name):.        
-000036f0: 6966 206e 616d 653d 3d22 7822 3a0a 2020  if name=="x":.  
-00003700: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00003710: 2073 656c 662e 780a 2020 2020 2020 2020   self.x.        
-00003720: 656c 6966 206e 616d 653d 3d22 7922 3a0a  elif name=="y":.
-00003730: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00003740: 726e 2073 656c 662e 790a 2020 2020 2020  rn self.y.      
-00003750: 2020 656c 6966 206e 616d 653d 3d22 7a22    elif name=="z"
-00003760: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00003770: 7475 726e 2073 656c 662e 7a0a 2020 2020  turn self.z.    
-00003780: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00003790: 2020 2020 2020 7261 6973 6520 4174 7472        raise Attr
-000037a0: 6962 7574 6545 7272 6f72 2c22 7665 6333  ibuteError,"vec3
-000037b0: 2068 6173 206e 6f20 6174 7472 6962 7574   has no attribut
-000037c0: 6520 2722 2b6e 616d 652b 2227 220a 0a20  e '"+name+"'".. 
-000037d0: 2020 2064 6566 205f 5f73 6574 6174 7472     def __setattr
-000037e0: 5f5f 2873 656c 662c 206e 616d 652c 2076  __(self, name, v
-000037f0: 616c 293a 0a20 2020 2020 2020 2069 6620  al):.        if 
-00003800: 6e61 6d65 3d3d 2278 223a 0a20 2020 2020  name=="x":.     
-00003810: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
-00003820: 7661 6c0a 2020 2020 2020 2020 656c 6966  val.        elif
-00003830: 206e 616d 653d 3d22 7922 3a0a 2020 2020   name=="y":.    
-00003840: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
-00003850: 2076 616c 0a20 2020 2020 2020 2065 6c69   val.        eli
-00003860: 6620 6e61 6d65 3d3d 227a 223a 0a20 2020  f name=="z":.   
-00003870: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
-00003880: 3d20 7661 6c0a 2020 2020 2020 2020 656c  = val.        el
-00003890: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000038a0: 7261 6973 6520 4174 7472 6962 7574 6545  raise AttributeE
-000038b0: 7272 6f72 2c22 7665 6333 2068 6173 206e  rror,"vec3 has n
-000038c0: 6f20 7772 6974 6162 6c65 2061 7474 7269  o writable attri
-000038d0: 6275 7465 2027 222b 6e61 6d65 2b22 2722  bute '"+name+"'"
-000038e0: 0a0a 2020 2020 6465 6620 5f5f 6c65 6e5f  ..    def __len_
-000038f0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00003900: 2022 2222 4c65 6e67 7468 206f 6620 7468   """Length of th
-00003910: 6520 7365 7175 656e 6365 2028 616c 7761  e sequence (alwa
-00003920: 7973 2033 2922 2222 0a20 2020 2020 2020  ys 3)""".       
-00003930: 2072 6574 7572 6e20 330a 0a20 2020 2064   return 3..    d
-00003940: 6566 205f 5f67 6574 6974 656d 5f5f 2876  ef __getitem__(v
-00003950: 6563 3320 7365 6c66 2c20 6b65 7929 3a0a  ec3 self, key):.
-00003960: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00003970: 6e20 6120 636f 6d70 6f6e 656e 7420 6279  n a component by
-00003980: 2069 6e64 6578 2028 302d 6261 7365 6429   index (0-based)
-00003990: 0a0a 2020 2020 2020 2020 3e3e 3e20 613d  ..        >>> a=
-000039a0: 7665 6333 2831 2e30 2c20 302e 352c 202d  vec3(1.0, 0.5, -
-000039b0: 312e 3829 0a20 2020 2020 2020 203e 3e3e  1.8).        >>>
-000039c0: 2070 7269 6e74 2061 5b30 5d0a 2020 2020   print a[0].    
-000039d0: 2020 2020 312e 300a 2020 2020 2020 2020      1.0.        
-000039e0: 3e3e 3e20 7072 696e 7420 615b 315d 0a20  >>> print a[1]. 
-000039f0: 2020 2020 2020 2030 2e35 0a20 2020 2020         0.5.     
-00003a00: 2020 203e 3e3e 2070 7269 6e74 2061 5b32     >>> print a[2
-00003a10: 5d0a 2020 2020 2020 2020 2d31 2e38 0a20  ].        -1.8. 
-00003a20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00003a30: 2020 2063 6465 6620 696e 7420 6b0a 0a20     cdef int k.. 
-00003a40: 2020 2020 2020 2054 3d74 7970 6528 6b65         T=type(ke
-00003a50: 7929 0a20 2020 2020 2020 2069 6620 5421  y).        if T!
-00003a60: 3d69 6e74 2061 6e64 2054 213d 6c6f 6e67  =int and T!=long
-00003a70: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00003a80: 6973 6520 5479 7065 4572 726f 722c 2022  ise TypeError, "
-00003a90: 696e 6465 7820 6d75 7374 2062 6520 696e  index must be in
-00003aa0: 7465 6765 7222 0a0a 2020 2020 2020 2020  teger"..        
-00003ab0: 6b20 3d20 6b65 790a 2020 2020 2020 2020  k = key.        
-00003ac0: 6966 2020 206b 3d3d 303a 2072 6574 7572  if   k==0: retur
-00003ad0: 6e20 7365 6c66 2e78 0a20 2020 2020 2020  n self.x.       
-00003ae0: 2065 6c69 6620 6b3d 3d31 3a20 7265 7475   elif k==1: retu
-00003af0: 726e 2073 656c 662e 790a 2020 2020 2020  rn self.y.      
-00003b00: 2020 656c 6966 206b 3d3d 323a 2072 6574    elif k==2: ret
-00003b10: 7572 6e20 7365 6c66 2e7a 0a20 2020 2020  urn self.z.     
-00003b20: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00003b30: 2020 2020 2072 6169 7365 2049 6e64 6578       raise Index
-00003b40: 4572 726f 722c 2269 6e64 6578 206f 7574  Error,"index out
-00003b50: 206f 6620 7261 6e67 6522 0a0a 2020 2020   of range"..    
-00003b60: 6465 6620 5f5f 7365 7469 7465 6d5f 5f28  def __setitem__(
-00003b70: 7365 6c66 2c20 6b65 792c 2076 616c 7565  self, key, value
-00003b80: 293a 0a20 2020 2020 2020 2022 2222 5365  ):.        """Se
-00003b90: 7420 6120 636f 6d70 6f6e 656e 7420 6279  t a component by
-00003ba0: 2069 6e64 6578 2028 302d 6261 7365 6429   index (0-based)
-00003bb0: 0a0a 2020 2020 2020 2020 3e3e 3e20 613d  ..        >>> a=
-00003bc0: 7665 6333 2829 0a20 2020 2020 2020 203e  vec3().        >
-00003bd0: 3e3e 2061 5b30 5d3d 312e 353b 2061 5b31  >> a[0]=1.5; a[1
-00003be0: 5d3d 302e 373b 2061 5b32 5d3d 2d30 2e33  ]=0.7; a[2]=-0.3
-00003bf0: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00003c00: 6e74 2061 0a20 2020 2020 2020 2028 312e  nt a.        (1.
-00003c10: 3530 3030 2c20 302e 3730 3030 2c20 2d30  5000, 0.7000, -0
-00003c20: 2e33 3030 3029 0a20 2020 2020 2020 2022  .3000).        "
-00003c30: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-00003c40: 696e 7420 6b0a 0a20 2020 2020 2020 2054  int k..        T
-00003c50: 3d74 7970 6528 6b65 7929 0a20 2020 2020  =type(key).     
-00003c60: 2020 2069 6620 5421 3d69 6e74 2061 6e64     if T!=int and
-00003c70: 2054 213d 6c6f 6e67 3a0a 2020 2020 2020   T!=long:.      
-00003c80: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00003c90: 4572 726f 722c 2022 696e 6465 7820 6d75  Error, "index mu
-00003ca0: 7374 2062 6520 696e 7465 6765 7222 0a0a  st be integer"..
-00003cb0: 2020 2020 2020 2020 6b20 3d20 6b65 790a          k = key.
-00003cc0: 2020 2020 2020 2020 6966 2020 206b 3d3d          if   k==
-00003cd0: 303a 2073 656c 662e 7820 3d20 7661 6c75  0: self.x = valu
-00003ce0: 650a 2020 2020 2020 2020 656c 6966 206b  e.        elif k
-00003cf0: 3d3d 313a 2073 656c 662e 7920 3d20 7661  ==1: self.y = va
-00003d00: 6c75 650a 2020 2020 2020 2020 656c 6966  lue.        elif
-00003d10: 206b 3d3d 323a 2073 656c 662e 7a20 3d20   k==2: self.z = 
-00003d20: 7661 6c75 650a 2020 2020 2020 2020 656c  value.        el
-00003d30: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00003d40: 7261 6973 6520 496e 6465 7845 7272 6f72  raise IndexError
-00003d50: 2c22 696e 6465 7820 6f75 7420 6f66 2072  ,"index out of r
-00003d60: 616e 6765 220a 0a20 2020 2064 6566 2063  ange"..    def c
-00003d70: 726f 7373 2873 656c 662c 2076 6563 3320  ross(self, vec3 
-00003d80: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-00003d90: 2222 2243 726f 7373 2070 726f 6475 6374  """Cross product
-00003da0: 2e0a 0a20 2020 2020 2020 203e 3e3e 2061  ...        >>> a
-00003db0: 3d76 6563 3328 312e 302c 2030 2e35 2c20  =vec3(1.0, 0.5, 
-00003dc0: 2d31 2e38 290a 2020 2020 2020 2020 3e3e  -1.8).        >>
-00003dd0: 3e20 623d 7665 6333 282d 302e 332c 2030  > b=vec3(-0.3, 0
-00003de0: 2e37 352c 2030 2e35 290a 2020 2020 2020  .75, 0.5).      
-00003df0: 2020 3e3e 3e20 633d 612e 6372 6f73 7328    >>> c=a.cross(
-00003e00: 6229 0a20 2020 2020 2020 203e 3e3e 2070  b).        >>> p
-00003e10: 7269 6e74 2063 0a20 2020 2020 2020 2028  rint c.        (
-00003e20: 312e 3630 3030 2c20 302e 3034 3030 2c20  1.6000, 0.0400, 
-00003e30: 302e 3930 3030 290a 2020 2020 2020 2020  0.9000).        
-00003e40: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
-00003e50: 2076 6563 3320 7265 730a 0a20 2020 2020   vec3 res..     
-00003e60: 2020 2069 6620 7479 7065 286f 7468 6572     if type(other
-00003e70: 293d 3d76 6563 333a 0a20 2020 2020 2020  )==vec3:.       
-00003e80: 2020 2020 2072 6573 203d 2076 6563 3328       res = vec3(
-00003e90: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00003ea0: 732e 7820 3d20 7365 6c66 2e79 2a6f 7468  s.x = self.y*oth
-00003eb0: 6572 2e7a 2d73 656c 662e 7a2a 6f74 6865  er.z-self.z*othe
-00003ec0: 722e 790a 2020 2020 2020 2020 2020 2020  r.y.            
-00003ed0: 7265 732e 7920 3d20 7365 6c66 2e7a 2a6f  res.y = self.z*o
-00003ee0: 7468 6572 2e78 2d73 656c 662e 782a 6f74  ther.x-self.x*ot
-00003ef0: 6865 722e 7a0a 2020 2020 2020 2020 2020  her.z.          
-00003f00: 2020 7265 732e 7a20 3d20 7365 6c66 2e78    res.z = self.x
-00003f10: 2a6f 7468 6572 2e79 2d73 656c 662e 792a  *other.y-self.y*
-00003f20: 6f74 6865 722e 780a 2020 2020 2020 2020  other.x.        
-00003f30: 2020 2020 7265 7475 726e 2072 6573 0a20      return res. 
-00003f40: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00003f50: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00003f60: 7970 6545 7272 6f72 2c20 2275 6e73 7570  ypeError, "unsup
-00003f70: 706f 7274 6564 206f 7065 7261 6e64 2074  ported operand t
-00003f80: 7970 6520 666f 7220 6372 6f73 7328 2922  ype for cross()"
-00003f90: 0a0a 2020 2020 6465 6620 6c65 6e67 7468  ..    def length
-00003fa0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00003fb0: 2222 2252 6574 7572 6e20 7468 6520 6c65  """Return the le
-00003fc0: 6e67 7468 206f 6620 7468 6520 7665 6374  ngth of the vect
-00003fd0: 6f72 2e0a 0a20 2020 2020 2020 2076 2e6c  or...        v.l
-00003fe0: 656e 6774 6828 2920 6973 2065 7175 6976  ength() is equiv
-00003ff0: 616c 656e 7420 746f 2061 6273 2876 292e  alent to abs(v).
-00004000: 0a0a 2020 2020 2020 2020 3e3e 3e20 613d  ..        >>> a=
-00004010: 7665 6333 2831 2e30 2c20 302e 352c 202d  vec3(1.0, 0.5, -
-00004020: 312e 3829 0a20 2020 2020 2020 203e 3e3e  1.8).        >>>
-00004030: 2070 7269 6e74 2061 2e6c 656e 6774 6828   print a.length(
-00004040: 290a 2020 2020 2020 2020 322e 3131 3839  ).        2.1189
-00004050: 3632 3031 3030 340a 2020 2020 2020 2020  6201004.        
-00004060: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
-00004070: 2064 6f75 626c 6520 610a 2020 2020 2020   double a.      
-00004080: 2020 6120 3d20 7365 6c66 2e78 2a73 656c    a = self.x*sel
-00004090: 662e 7820 2b20 7365 6c66 2e79 2a73 656c  f.x + self.y*sel
-000040a0: 662e 7920 2b20 7365 6c66 2e7a 2a73 656c  f.y + self.z*sel
-000040b0: 662e 7a0a 2020 2020 2020 2020 7265 7475  f.z.        retu
-000040c0: 726e 2073 7172 7428 6129 0a0a 2020 2020  rn sqrt(a)..    
-000040d0: 6465 6620 6e6f 726d 616c 697a 6528 7365  def normalize(se
-000040e0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000040f0: 5265 7475 726e 206e 6f72 6d61 6c69 7a65  Return normalize
-00004100: 6420 7665 6374 6f72 2e0a 0a20 2020 2020  d vector...     
-00004110: 2020 203e 3e3e 2061 3d76 6563 3328 312e     >>> a=vec3(1.
-00004120: 302c 2030 2e35 2c20 2d31 2e38 290a 2020  0, 0.5, -1.8).  
-00004130: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00004140: 612e 6e6f 726d 616c 697a 6528 290a 2020  a.normalize().  
-00004150: 2020 2020 2020 2830 2e34 3731 392c 2030        (0.4719, 0
-00004160: 2e32 3336 302c 202d 302e 3834 3935 290a  .2360, -0.8495).
-00004170: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00004180: 2020 2020 6364 6566 2076 6563 3320 7265      cdef vec3 re
-00004190: 730a 2020 2020 2020 2020 6364 6566 2064  s.        cdef d
-000041a0: 6f75 626c 6520 6e6c 656e 0a0a 2020 2020  ouble nlen..    
-000041b0: 2020 2020 6e6c 656e 203d 2073 7172 7428      nlen = sqrt(
-000041c0: 7365 6c66 2e78 2a73 656c 662e 7820 2b20  self.x*self.x + 
-000041d0: 7365 6c66 2e79 2a73 656c 662e 7920 2b20  self.y*self.y + 
-000041e0: 7365 6c66 2e7a 2a73 656c 662e 7a29 0a20  self.z*self.z). 
-000041f0: 2020 2020 2020 2069 6620 6e6c 656e 3c3d         if nlen<=
-00004200: 6570 733a 0a20 2020 2020 2020 2020 2020  eps:.           
-00004210: 2072 6169 7365 205a 6572 6f44 6976 6973   raise ZeroDivis
-00004220: 696f 6e45 7272 6f72 2c22 6e75 6c6c 2076  ionError,"null v
-00004230: 6563 746f 7220 6361 6e27 7420 6265 206e  ector can't be n
-00004240: 6f72 6d61 6c69 7a65 6422 0a20 2020 2020  ormalized".     
-00004250: 2020 206e 6c65 6e20 3d20 312e 302f 6e6c     nlen = 1.0/nl
-00004260: 656e 0a20 2020 2020 2020 2072 6573 203d  en.        res =
-00004270: 2076 6563 3328 290a 2020 2020 2020 2020   vec3().        
-00004280: 7265 732e 7820 3d20 7365 6c66 2e78 2a6e  res.x = self.x*n
-00004290: 6c65 6e0a 2020 2020 2020 2020 7265 732e  len.        res.
-000042a0: 7920 3d20 7365 6c66 2e79 2a6e 6c65 6e0a  y = self.y*nlen.
-000042b0: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
-000042c0: 7365 6c66 2e7a 2a6e 6c65 6e0a 2020 2020  self.z*nlen.    
-000042d0: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-000042e0: 2020 2020 6465 6620 616e 676c 6528 7365      def angle(se
-000042f0: 6c66 2c20 7665 6333 206f 7468 6572 293a  lf, vec3 other):
-00004300: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00004310: 726e 2061 6e67 6c65 2028 696e 2072 6164  rn angle (in rad
-00004320: 6961 6e73 2920 6265 7477 6565 6e20 7365  ians) between se
-00004330: 6c66 2061 6e64 206f 7468 6572 2e0a 0a20  lf and other... 
-00004340: 2020 2020 2020 203e 3e3e 2061 3d76 6563         >>> a=vec
-00004350: 3328 312e 302c 2030 2e35 2c20 2d31 2e38  3(1.0, 0.5, -1.8
-00004360: 290a 2020 2020 2020 2020 3e3e 3e20 623d  ).        >>> b=
-00004370: 7665 6333 282d 302e 332c 2030 2e37 352c  vec3(-0.3, 0.75,
-00004380: 2030 2e35 290a 2020 2020 2020 2020 3e3e   0.5).        >>
-00004390: 3e20 7072 696e 7420 612e 616e 676c 6528  > print a.angle(
-000043a0: 6229 0a20 2020 2020 2020 2031 2e39 3933  b).        1.993
-000043b0: 3036 3735 3535 3834 0a20 2020 2020 2020  06755584.       
-000043c0: 2022 2222 0a0a 2020 2020 2020 2020 6364   """..        cd
-000043d0: 6566 2064 6f75 626c 6520 612c 206c 732c  ef double a, ls,
-000043e0: 206c 6f0a 0a20 2020 2020 2020 206c 7320   lo..        ls 
-000043f0: 3d20 7371 7274 2873 656c 662e 782a 7365  = sqrt(self.x*se
-00004400: 6c66 2e78 202b 2073 656c 662e 792a 7365  lf.x + self.y*se
-00004410: 6c66 2e79 202b 2073 656c 662e 7a2a 7365  lf.y + self.z*se
-00004420: 6c66 2e7a 290a 2020 2020 2020 2020 6c6f  lf.z).        lo
-00004430: 203d 2073 7172 7428 6f74 6865 722e 782a   = sqrt(other.x*
-00004440: 6f74 6865 722e 7820 2b20 6f74 6865 722e  other.x + other.
-00004450: 792a 6f74 6865 722e 7920 2b20 6f74 6865  y*other.y + othe
-00004460: 722e 7a2a 6f74 6865 722e 7a29 0a20 2020  r.z*other.z).   
-00004470: 2020 2020 2061 2020 3d20 6c73 2a6c 6f0a       a  = ls*lo.
-00004480: 2020 2020 2020 2020 6966 2061 3c3d 6570          if a<=ep
-00004490: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-000044a0: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
-000044b0: 6e45 7272 6f72 2c22 616e 676c 6528 293a  nError,"angle():
-000044c0: 206e 756c 6c20 7665 6374 6f72 2063 616e   null vector can
-000044d0: 2774 2062 6520 6e6f 726d 616c 697a 6564  't be normalized
-000044e0: 220a 2020 2020 2020 2020 6120 203d 2028  ".        a  = (
-000044f0: 7365 6c66 2e78 2a6f 7468 6572 2e78 202b  self.x*other.x +
-00004500: 2073 656c 662e 792a 6f74 6865 722e 7920   self.y*other.y 
-00004510: 2b20 7365 6c66 2e7a 2a6f 7468 6572 2e7a  + self.z*other.z
-00004520: 292f 610a 2020 2020 2020 2020 6966 2061  )/a.        if a
-00004530: 3e31 2e30 3a0a 2020 2020 2020 2020 2020  >1.0:.          
-00004540: 2020 613d 312e 300a 2020 2020 2020 2020    a=1.0.        
-00004550: 6966 2061 3c2d 312e 303a 0a20 2020 2020  if a<-1.0:.     
-00004560: 2020 2020 2020 2061 3d2d 312e 300a 2020         a=-1.0.  
-00004570: 2020 2020 2020 7265 7475 726e 2061 636f        return aco
-00004580: 7328 6129 0a23 2020 2020 2020 2020 6966  s(a).#        if
-00004590: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
-000045a0: 722c 2076 6563 3329 3a0a 2320 2020 2020  r, vec3):.#     
-000045b0: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
-000045c0: 7468 2e61 636f 7328 2873 656c 662a 6f74  th.acos((self*ot
-000045d0: 6865 7229 202f 2028 6162 7328 7365 6c66  her) / (abs(self
-000045e0: 292a 6162 7328 6f74 6865 7229 2929 0a23  )*abs(other))).#
-000045f0: 2020 2020 2020 2020 656c 7365 3a0a 2320          else:.# 
-00004600: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00004610: 2054 7970 6545 7272 6f72 2c20 2275 6e73   TypeError, "uns
-00004620: 7570 706f 7274 6564 206f 7065 7261 6e64  upported operand
-00004630: 2074 7970 6520 666f 7220 616e 676c 6528   type for angle(
-00004640: 2922 0a0a 2020 2020 6465 6620 7265 666c  )"..    def refl
-00004650: 6563 7428 7365 6c66 2c20 7665 6333 204e  ect(self, vec3 N
-00004660: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-00004670: 7475 726e 2074 6865 2072 6566 6c65 6374  turn the reflect
-00004680: 696f 6e20 7665 6374 6f72 2e0a 0a20 2020  ion vector...   
-00004690: 2020 2020 204e 2069 7320 7468 6520 7375       N is the su
-000046a0: 7266 6163 6520 6e6f 726d 616c 2077 6869  rface normal whi
-000046b0: 6368 2068 6173 2074 6f20 6265 206f 6620  ch has to be of 
-000046c0: 756e 6974 206c 656e 6774 682e 0a0a 2020  unit length...  
-000046d0: 2020 2020 2020 3e3e 3e20 613d 7665 6333        >>> a=vec3
-000046e0: 2831 2e30 2c20 2d31 2e30 2c20 302e 3029  (1.0, -1.0, 0.0)
-000046f0: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00004700: 6e74 2061 2e72 6566 6c65 6374 2876 6563  nt a.reflect(vec
-00004710: 3328 302c 312c 3029 0a20 2020 2020 2020  3(0,1,0).       
-00004720: 2028 312e 3030 3030 2c20 312e 3030 3030   (1.0000, 1.0000
-00004730: 2c20 302e 3030 3030 290a 2020 2020 2020  , 0.0000).      
-00004740: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
-00004750: 6566 2076 6563 3320 7265 730a 2020 2020  ef vec3 res.    
-00004760: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
-00004770: 610a 0a20 2020 2020 2020 2072 6573 203d  a..        res =
-00004780: 2076 6563 3328 290a 2020 2020 2020 2020   vec3().        
-00004790: 6120 3d20 322e 302a 2873 656c 662e 782a  a = 2.0*(self.x*
-000047a0: 4e2e 7820 2b20 7365 6c66 2e79 2a4e 2e79  N.x + self.y*N.y
-000047b0: 202b 2073 656c 662e 7a2a 4e2e 7a29 0a20   + self.z*N.z). 
-000047c0: 2020 2020 2020 2072 6573 2e78 203d 2073         res.x = s
-000047d0: 656c 662e 7820 2d20 612a 4e2e 780a 2020  elf.x - a*N.x.  
-000047e0: 2020 2020 2020 7265 732e 7920 3d20 7365        res.y = se
-000047f0: 6c66 2e79 202d 2061 2a4e 2e79 0a20 2020  lf.y - a*N.y.   
-00004800: 2020 2020 2072 6573 2e7a 203d 2073 656c       res.z = sel
-00004810: 662e 7a20 2d20 612a 4e2e 7a0a 2020 2020  f.z - a*N.z.    
-00004820: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-00004830: 2020 2020 6465 6620 7265 6672 6163 7428      def refract(
-00004840: 7365 6c66 2c20 7665 6333 204e 2c20 6574  self, vec3 N, et
-00004850: 6129 3a0a 2020 2020 2020 2020 2222 2252  a):.        """R
-00004860: 6574 7572 6e20 7468 6520 7472 616e 736d  eturn the transm
-00004870: 6974 7465 6420 7665 6374 6f72 2e0a 0a20  itted vector... 
-00004880: 2020 2020 2020 204e 2069 7320 7468 6520         N is the 
-00004890: 7375 7266 6163 6520 6e6f 726d 616c 2077  surface normal w
-000048a0: 6869 6368 2068 6173 2074 6f20 6265 206f  hich has to be o
-000048b0: 6620 756e 6974 206c 656e 6774 682e 0a20  f unit length.. 
-000048c0: 2020 2020 2020 2065 7461 2069 7320 7468         eta is th
-000048d0: 6520 7265 6c61 7469 7665 2069 6e64 6578  e relative index
-000048e0: 206f 6620 7265 6672 6163 7469 6f6e 2e20   of refraction. 
-000048f0: 4966 2074 6865 2072 6574 7572 6e65 640a  If the returned.
-00004900: 2020 2020 2020 2020 7665 6374 6f72 2069          vector i
-00004910: 7320 7a65 726f 2074 6865 6e20 7468 6572  s zero then ther
-00004920: 6520 6973 206e 6f20 7472 616e 736d 6974  e is no transmit
-00004930: 7465 6420 6c69 6768 7420 6265 6361 7573  ted light becaus
-00004940: 650a 2020 2020 2020 2020 6f66 2074 6f74  e.        of tot
-00004950: 616c 2069 6e74 6572 6e61 6c20 7265 666c  al internal refl
-00004960: 6563 7469 6f6e 2e0a 0a20 2020 2020 2020  ection...       
-00004970: 203e 3e3e 2061 3d76 6563 3328 312e 302c   >>> a=vec3(1.0,
-00004980: 202d 312e 352c 2030 2e38 290a 2020 2020   -1.5, 0.8).    
-00004990: 2020 2020 3e3e 3e20 7072 696e 7420 612e      >>> print a.
-000049a0: 7265 6672 6163 7428 7665 6333 2830 2c31  refract(vec3(0,1
-000049b0: 2c30 292c 2031 2e33 3329 0a20 2020 2020  ,0), 1.33).     
-000049c0: 2020 2028 312e 3333 3030 2c20 2d31 2e37     (1.3300, -1.7
-000049d0: 3932 302c 2031 2e30 3634 3029 0a20 2020  920, 1.0640).   
-000049e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000049f0: 2063 6465 6620 7665 6333 2072 6573 0a20   cdef vec3 res. 
-00004a00: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-00004a10: 6c65 2064 6f74 2c20 6b2c 2063 6574 610a  le dot, k, ceta.
-00004a20: 0a20 2020 2020 2020 2072 6573 203d 2076  .        res = v
-00004a30: 6563 3328 290a 0a20 2020 2020 2020 2063  ec3()..        c
-00004a40: 6574 6120 3d20 6574 610a 2020 2020 2020  eta = eta.      
-00004a50: 2020 646f 7420 3d20 7365 6c66 2e78 2a4e    dot = self.x*N
-00004a60: 2e78 202b 2073 656c 662e 792a 4e2e 7920  .x + self.y*N.y 
-00004a70: 2b20 7365 6c66 2e7a 2a4e 2e7a 0a20 2020  + self.z*N.z.   
-00004a80: 2020 2020 206b 2020 203d 2031 2e30 202d       k   = 1.0 -
-00004a90: 2063 6574 612a 6365 7461 2a28 312e 3020   ceta*ceta*(1.0 
-00004aa0: 2d20 646f 742a 646f 7429 0a20 2020 2020  - dot*dot).     
-00004ab0: 2020 2069 6620 6b3c 3d65 7073 3a0a 2020     if k<=eps:.  
-00004ac0: 2020 2020 2020 2020 2020 7265 732e 7820            res.x 
-00004ad0: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
-00004ae0: 2020 7265 732e 7920 3d20 302e 300a 2020    res.y = 0.0.  
-00004af0: 2020 2020 2020 2020 2020 7265 732e 7a20            res.z 
-00004b00: 3d20 302e 300a 2020 2020 2020 2020 656c  = 0.0.        el
-00004b10: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00004b20: 6b20 3d20 6365 7461 2a64 6f74 202b 2073  k = ceta*dot + s
-00004b30: 7172 7428 6b29 0a20 2020 2020 2020 2020  qrt(k).         
-00004b40: 2020 2072 6573 2e78 203d 2063 6574 612a     res.x = ceta*
-00004b50: 7365 6c66 2e78 202d 206b 2a4e 2e78 0a20  self.x - k*N.x. 
-00004b60: 2020 2020 2020 2020 2020 2072 6573 2e79             res.y
-00004b70: 203d 2063 6574 612a 7365 6c66 2e79 202d   = ceta*self.y -
-00004b80: 206b 2a4e 2e79 0a20 2020 2020 2020 2020   k*N.y.         
-00004b90: 2020 2072 6573 2e7a 203d 2063 6574 612a     res.z = ceta*
-00004ba0: 7365 6c66 2e7a 202d 206b 2a4e 2e7a 0a0a  self.z - k*N.z..
-00004bb0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00004bc0: 6573 0a0a 2020 2020 6465 6620 6f72 7468  es..    def orth
-00004bd0: 6f28 7365 6c66 293a 0a20 2020 2020 2020  o(self):.       
-00004be0: 2022 2222 5265 7475 726e 7320 616e 206f   """Returns an o
-00004bf0: 7274 686f 676f 6e61 6c20 7665 6374 6f72  rthogonal vector
-00004c00: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-00004c10: 6e73 2061 2076 6563 746f 7220 7468 6174  ns a vector that
-00004c20: 2069 7320 6f72 7468 6f67 6f6e 616c 2074   is orthogonal t
-00004c30: 6f20 7365 6c66 2028 7768 6572 650a 2020  o self (where.  
-00004c40: 2020 2020 2020 7365 6c66 2a73 656c 662e        self*self.
-00004c50: 6f72 7468 6f28 293d 3d30 292e 0a0a 2020  ortho()==0)...  
-00004c60: 2020 2020 2020 3e3e 3e20 613d 7665 6333        >>> a=vec3
-00004c70: 2831 2e30 2c20 2d31 2e35 2c20 302e 3829  (1.0, -1.5, 0.8)
-00004c80: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00004c90: 6e74 2072 6f75 6e64 2861 2a61 2e6f 7274  nt round(a*a.ort
-00004ca0: 686f 2829 2c38 290a 2020 2020 2020 2020  ho(),8).        
-00004cb0: 302e 300a 2020 2020 2020 2020 2222 220a  0.0.        """.
-00004cc0: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
-00004cd0: 3320 7265 730a 2020 2020 2020 2020 6364  3 res.        cd
-00004ce0: 6566 2064 6f75 626c 6520 782c 792c 7a0a  ef double x,y,z.
-00004cf0: 2020 2020 2020 2020 7265 7320 3d20 7665          res = ve
-00004d00: 6333 2829 0a0a 2020 2020 2020 2020 783d  c3()..        x=
-00004d10: 6661 6273 2873 656c 662e 7829 0a20 2020  fabs(self.x).   
-00004d20: 2020 2020 2079 3d66 6162 7328 7365 6c66       y=fabs(self
-00004d30: 2e79 290a 2020 2020 2020 2020 7a3d 6661  .y).        z=fa
-00004d40: 6273 2873 656c 662e 7a29 0a20 2020 2020  bs(self.z).     
-00004d50: 2020 2023 2049 7320 7a20 7468 6520 736d     # Is z the sm
-00004d60: 616c 6c65 7374 2065 6c65 6d65 6e74 3f20  allest element? 
-00004d70: 5468 656e 2075 7365 2078 2061 6e64 2079  Then use x and y
-00004d80: 0a20 2020 2020 2020 2069 6620 7a3c 3d78  .        if z<=x
-00004d90: 2061 6e64 207a 3c3d 793a 0a20 2020 2020   and z<=y:.     
-00004da0: 2020 2020 2020 2072 6573 2e78 203d 202d         res.x = -
-00004db0: 7365 6c66 2e79 0a20 2020 2020 2020 2020  self.y.         
-00004dc0: 2020 2072 6573 2e79 203d 2073 656c 662e     res.y = self.
-00004dd0: 780a 2020 2020 2020 2020 2020 2020 7265  x.            re
-00004de0: 732e 7a20 3d20 302e 300a 2020 2020 2020  s.z = 0.0.      
-00004df0: 2020 2320 4973 2079 2073 6d61 6c6c 6573    # Is y smalles
-00004e00: 7420 656c 656d 656e 743f 2054 6865 6e20  t element? Then 
-00004e10: 7573 6520 7820 616e 6420 7a0a 2020 2020  use x and z.    
-00004e20: 2020 2020 656c 6966 2079 3c3d 7820 616e      elif y<=x an
-00004e30: 6420 793c 3d7a 3a0a 2020 2020 2020 2020  d y<=z:.        
-00004e40: 2020 2020 7265 732e 7820 3d20 2d73 656c      res.x = -sel
-00004e50: 662e 7a0a 2020 2020 2020 2020 2020 2020  f.z.            
-00004e60: 7265 732e 7920 3d20 302e 300a 2020 2020  res.y = 0.0.    
-00004e70: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
-00004e80: 7365 6c66 2e78 0a20 2020 2020 2020 2023  self.x.        #
-00004e90: 2078 2069 7320 736d 616c 6c65 7374 0a20   x is smallest. 
-00004ea0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00004eb0: 2020 2020 2020 2020 2072 6573 2e78 203d           res.x =
+00002270: 2c20 6229 3a0a 2020 2020 2020 2020 2320  , b):.        # 
+00002280: 5079 7468 6f6e 2032 0a20 2020 2020 2020  Python 2.       
+00002290: 2072 6574 7572 6e20 7665 6333 2e5f 5f74   return vec3.__t
+000022a0: 7275 6564 6976 5f5f 2861 2c62 290a 0a20  ruediv__(a,b).. 
+000022b0: 2020 2064 6566 205f 5f74 7275 6564 6976     def __truediv
+000022c0: 5f5f 2876 6563 3320 612c 2062 293a 0a20  __(vec3 a, b):. 
+000022d0: 2020 2020 2020 2022 2222 4469 7669 7369         """Divisi
+000022e0: 6f6e 2062 7920 7363 616c 6172 0a0a 2020  on by scalar..  
+000022f0: 2020 2020 2020 3e3e 3e20 613d 7665 6333        >>> a=vec3
+00002300: 2831 2e30 2c20 302e 352c 202d 312e 3829  (1.0, 0.5, -1.8)
+00002310: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00002320: 6e74 2061 2f32 2e30 0a20 2020 2020 2020  nt a/2.0.       
+00002330: 2028 302e 3530 3030 2c20 302e 3235 3030   (0.5000, 0.2500
+00002340: 2c20 2d30 2e39 3030 3029 0a20 2020 2020  , -0.9000).     
+00002350: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+00002360: 6465 6620 7665 6333 2072 6573 0a20 2020  def vec3 res.   
+00002370: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
+00002380: 2072 0a0a 2020 2020 2020 2020 7462 203d   r..        tb =
+00002390: 2074 7970 6528 6229 0a0a 2020 2020 2020   type(b)..      
+000023a0: 2020 6966 2074 6220 6973 2066 6c6f 6174    if tb is float
+000023b0: 206f 7220 7462 2069 7320 696e 7420 6f72   or tb is int or
+000023c0: 2074 6220 6973 206c 6f6e 673a 0a20 2020   tb is long:.   
+000023d0: 2020 2020 2020 2020 2023 2076 6563 332f           # vec3/
+000023e0: 7363 616c 6172 0a20 2020 2020 2020 2020  scalar.         
+000023f0: 2020 2072 6573 203d 2076 6563 3328 290a     res = vec3().
+00002400: 2020 2020 2020 2020 2020 2020 7220 3d20              r = 
+00002410: 620a 2020 2020 2020 2020 2020 2020 6966  b.            if
+00002420: 2066 6162 7328 7229 3c3d 6570 733a 0a20   fabs(r)<=eps:. 
+00002430: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00002440: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
+00002450: 6e45 7272 6f72 2c22 7665 6333 2064 6976  nError,"vec3 div
+00002460: 6973 696f 6e22 0a20 2020 2020 2020 2020  ision".         
+00002470: 2020 2072 6573 2e78 203d 2061 2e78 2f72     res.x = a.x/r
+00002480: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00002490: 2e79 203d 2061 2e79 2f72 0a20 2020 2020  .y = a.y/r.     
+000024a0: 2020 2020 2020 2072 6573 2e7a 203d 2061         res.z = a
+000024b0: 2e7a 2f72 0a20 2020 2020 2020 2020 2020  .z/r.           
+000024c0: 2072 6574 7572 6e20 7265 730a 2020 2020   return res.    
+000024d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000024e0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+000024f0: 4572 726f 722c 2022 756e 7375 7070 6f72  Error, "unsuppor
+00002500: 7465 6420 6f70 6572 616e 6420 7479 7065  ted operand type
+00002510: 2066 6f72 202f 220a 0a20 2020 2064 6566   for /"..    def
+00002520: 205f 5f6d 6f64 5f5f 2876 6563 3320 7365   __mod__(vec3 se
+00002530: 6c66 2c20 6229 3a0a 2020 2020 2020 2020  lf, b):.        
+00002540: 2222 224d 6f64 756c 6f20 2863 6f6d 706f  """Modulo (compo
+00002550: 6e65 6e74 2077 6973 6529 2e0a 0a20 2020  nent wise)...   
+00002560: 2020 2020 203e 3e3e 2061 3d76 6563 3328       >>> a=vec3(
+00002570: 332e 302c 2032 2e35 2c20 2d31 2e38 290a  3.0, 2.5, -1.8).
+00002580: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00002590: 7420 6125 322e 300a 2020 2020 2020 2020  t a%2.0.        
+000025a0: 2831 2e30 3030 302c 2030 2e35 3030 302c  (1.0000, 0.5000,
+000025b0: 2030 2e32 3030 3029 0a20 2020 2020 2020   0.2000).       
+000025c0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+000025d0: 6620 7665 6333 2072 6573 2c20 7662 0a20  f vec3 res, vb. 
+000025e0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
+000025f0: 6c65 2072 0a0a 2020 2020 2020 2020 7462  le r..        tb
+00002600: 203d 2074 7970 6528 6229 0a0a 2020 2020   = type(b)..    
+00002610: 2020 2020 6966 2074 6220 6973 2066 6c6f      if tb is flo
+00002620: 6174 206f 7220 7462 2069 7320 696e 7420  at or tb is int 
+00002630: 6f72 2074 6220 6973 206c 6f6e 673a 0a20  or tb is long:. 
+00002640: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
+00002650: 3325 7363 616c 6172 0a20 2020 2020 2020  3%scalar.       
+00002660: 2020 2020 2072 6573 203d 2076 6563 3328       res = vec3(
+00002670: 290a 2020 2020 2020 2020 2020 2020 7220  ).            r 
+00002680: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
+00002690: 6966 2066 6162 7328 7229 3c3d 6570 733a  if fabs(r)<=eps:
+000026a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000026b0: 2072 6169 7365 205a 6572 6f44 6976 6973   raise ZeroDivis
+000026c0: 696f 6e45 7272 6f72 2c22 7665 6333 206d  ionError,"vec3 m
+000026d0: 6f64 756c 6f22 0a20 2020 2020 2020 2020  odulo".         
+000026e0: 2020 2072 6573 2e78 203d 205f 666d 6f64     res.x = _fmod
+000026f0: 2873 656c 662e 782c 7229 0a20 2020 2020  (self.x,r).     
+00002700: 2020 2020 2020 2072 6573 2e79 203d 205f         res.y = _
+00002710: 666d 6f64 2873 656c 662e 792c 7229 0a20  fmod(self.y,r). 
+00002720: 2020 2020 2020 2020 2020 2072 6573 2e7a             res.z
+00002730: 203d 205f 666d 6f64 2873 656c 662e 7a2c   = _fmod(self.z,
+00002740: 7229 0a20 2020 2020 2020 2020 2020 2072  r).            r
+00002750: 6574 7572 6e20 7265 730a 2020 2020 2020  eturn res.      
+00002760: 2020 656c 6966 2074 6220 6973 2076 6563    elif tb is vec
+00002770: 333a 0a20 2020 2020 2020 2020 2020 2023  3:.            #
+00002780: 2076 6563 3325 7665 6333 0a20 2020 2020   vec3%vec3.     
+00002790: 2020 2020 2020 2072 6573 203d 2076 6563         res = vec
+000027a0: 3328 290a 2020 2020 2020 2020 2020 2020  3().            
+000027b0: 7662 203d 2062 0a20 2020 2020 2020 2020  vb = b.         
+000027c0: 2020 2069 6620 6661 6273 2876 622e 7829     if fabs(vb.x)
+000027d0: 3c3d 6570 7320 6f72 2066 6162 7328 7662  <=eps or fabs(vb
+000027e0: 2e79 293c 3d65 7073 206f 7220 6661 6273  .y)<=eps or fabs
+000027f0: 2876 622e 7a29 3c3d 6570 733a 0a20 2020  (vb.z)<=eps:.   
+00002800: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00002810: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
+00002820: 7272 6f72 2c22 7665 6333 206d 6f64 756c  rror,"vec3 modul
+00002830: 6f22 0a20 2020 2020 2020 2020 2020 2072  o".            r
+00002840: 6573 2e78 203d 205f 666d 6f64 2873 656c  es.x = _fmod(sel
+00002850: 662e 782c 2076 622e 7829 0a20 2020 2020  f.x, vb.x).     
+00002860: 2020 2020 2020 2072 6573 2e79 203d 205f         res.y = _
+00002870: 666d 6f64 2873 656c 662e 792c 2076 622e  fmod(self.y, vb.
+00002880: 7929 0a20 2020 2020 2020 2020 2020 2072  y).            r
+00002890: 6573 2e7a 203d 205f 666d 6f64 2873 656c  es.z = _fmod(sel
+000028a0: 662e 7a2c 2076 622e 7a29 0a20 2020 2020  f.z, vb.z).     
+000028b0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+000028c0: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
+000028d0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000028e0: 6520 5479 7065 4572 726f 722c 2022 756e  e TypeError, "un
+000028f0: 7375 7070 6f72 7465 6420 6f70 6572 616e  supported operan
+00002900: 6420 7479 7065 2066 6f72 2025 220a 0a20  d type for %".. 
+00002910: 2020 2064 6566 205f 5f6e 6567 5f5f 2873     def __neg__(s
+00002920: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00002930: 224e 6567 6174 696f 6e0a 0a20 2020 2020  "Negation..     
+00002940: 2020 203e 3e3e 2061 3d76 6563 3328 332e     >>> a=vec3(3.
+00002950: 302c 2032 2e35 2c20 2d31 2e38 290a 2020  0, 2.5, -1.8).  
+00002960: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
+00002970: 2d61 0a20 2020 2020 2020 2028 2d33 2e30  -a.        (-3.0
+00002980: 3030 302c 202d 322e 3530 3030 2c20 312e  000, -2.5000, 1.
+00002990: 3830 3030 290a 2020 2020 2020 2020 2222  8000).        ""
+000029a0: 220a 2020 2020 2020 2020 6364 6566 2076  ".        cdef v
+000029b0: 6563 3320 7265 730a 2020 2020 2020 2020  ec3 res.        
+000029c0: 7265 7320 3d20 7665 6333 2829 0a20 2020  res = vec3().   
+000029d0: 2020 2020 2072 6573 2e78 203d 202d 7365       res.x = -se
+000029e0: 6c66 2e78 0a20 2020 2020 2020 2072 6573  lf.x.        res
+000029f0: 2e79 203d 202d 7365 6c66 2e79 0a20 2020  .y = -self.y.   
+00002a00: 2020 2020 2072 6573 2e7a 203d 202d 7365       res.z = -se
+00002a10: 6c66 2e7a 0a20 2020 2020 2020 2072 6574  lf.z.        ret
+00002a20: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
+00002a30: 205f 5f70 6f73 5f5f 2873 656c 6629 3a0a   __pos__(self):.
+00002a40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00002a50: 2020 2020 3e3e 3e20 613d 7665 6333 2833      >>> a=vec3(3
+00002a60: 2e30 2c20 322e 352c 202d 312e 3829 0a20  .0, 2.5, -1.8). 
+00002a70: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+00002a80: 202b 610a 2020 2020 2020 2020 2833 2e30   +a.        (3.0
+00002a90: 3030 302c 2032 2e35 3030 302c 202d 312e  000, 2.5000, -1.
+00002aa0: 3830 3030 290a 2020 2020 2020 2020 2222  8000).        ""
+00002ab0: 220a 2020 2020 2020 2020 6364 6566 2076  ".        cdef v
+00002ac0: 6563 3320 7265 730a 2020 2020 2020 2020  ec3 res.        
+00002ad0: 7265 7320 3d20 7665 6333 2829 0a20 2020  res = vec3().   
+00002ae0: 2020 2020 2072 6573 2e78 203d 2073 656c       res.x = sel
+00002af0: 662e 780a 2020 2020 2020 2020 7265 732e  f.x.        res.
+00002b00: 7920 3d20 7365 6c66 2e79 0a20 2020 2020  y = self.y.     
+00002b10: 2020 2072 6573 2e7a 203d 2073 656c 662e     res.z = self.
+00002b20: 7a0a 2020 2020 2020 2020 7265 7475 726e  z.        return
+00002b30: 2072 6573 0a0a 0a20 2020 2064 6566 205f   res...    def _
+00002b40: 5f69 6164 645f 5f28 7365 6c66 2c20 7665  _iadd__(self, ve
+00002b50: 6333 206f 7468 6572 293a 0a20 2020 2020  c3 other):.     
+00002b60: 2020 2022 2222 496e 6c69 6e65 2076 6563     """Inline vec
+00002b70: 746f 7220 6164 6469 7469 6f6e 2e0a 0a20  tor addition... 
+00002b80: 2020 2020 2020 203e 3e3e 2061 3d76 6563         >>> a=vec
+00002b90: 3328 312e 302c 2030 2e35 2c20 2d31 2e38  3(1.0, 0.5, -1.8
+00002ba0: 290a 2020 2020 2020 2020 3e3e 3e20 623d  ).        >>> b=
+00002bb0: 7665 6333 282d 302e 332c 2030 2e37 352c  vec3(-0.3, 0.75,
+00002bc0: 2030 2e35 290a 2020 2020 2020 2020 3e3e   0.5).        >>
+00002bd0: 3e20 612b 3d62 0a20 2020 2020 2020 203e  > a+=b.        >
+00002be0: 3e3e 2070 7269 6e74 2061 0a20 2020 2020  >> print a.     
+00002bf0: 2020 2028 302e 3730 3030 2c20 312e 3235     (0.7000, 1.25
+00002c00: 3030 2c20 2d31 2e33 3030 3029 0a20 2020  00, -1.3000).   
+00002c10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00002c20: 2073 656c 662e 783d 7365 6c66 2e78 2b6f   self.x=self.x+o
+00002c30: 7468 6572 2e78 0a20 2020 2020 2020 2073  ther.x.        s
+00002c40: 656c 662e 793d 7365 6c66 2e79 2b6f 7468  elf.y=self.y+oth
+00002c50: 6572 2e79 0a20 2020 2020 2020 2073 656c  er.y.        sel
+00002c60: 662e 7a3d 7365 6c66 2e7a 2b6f 7468 6572  f.z=self.z+other
+00002c70: 2e7a 0a20 2020 2020 2020 2072 6574 7572  .z.        retur
+00002c80: 6e20 7365 6c66 0a0a 2020 2020 6465 6620  n self..    def 
+00002c90: 5f5f 6973 7562 5f5f 2873 656c 662c 2076  __isub__(self, v
+00002ca0: 6563 3320 6f74 6865 7229 3a0a 2020 2020  ec3 other):.    
+00002cb0: 2020 2020 2222 2249 6e6c 696e 6520 7665      """Inline ve
+00002cc0: 6374 6f72 2073 7562 7472 6163 7469 6f6e  ctor subtraction
+00002cd0: 2e0a 0a20 2020 2020 2020 203e 3e3e 2061  ...        >>> a
+00002ce0: 3d76 6563 3328 312e 302c 2030 2e35 2c20  =vec3(1.0, 0.5, 
+00002cf0: 2d31 2e38 290a 2020 2020 2020 2020 3e3e  -1.8).        >>
+00002d00: 3e20 623d 7665 6333 282d 302e 332c 2030  > b=vec3(-0.3, 0
+00002d10: 2e37 352c 2030 2e35 290a 2020 2020 2020  .75, 0.5).      
+00002d20: 2020 3e3e 3e20 612d 3d62 0a20 2020 2020    >>> a-=b.     
+00002d30: 2020 203e 3e3e 2070 7269 6e74 2061 0a20     >>> print a. 
+00002d40: 2020 2020 2020 2028 312e 3330 3030 2c20         (1.3000, 
+00002d50: 2d30 2e32 3530 302c 202d 322e 3330 3030  -0.2500, -2.3000
+00002d60: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
+00002d70: 2020 2020 2020 7365 6c66 2e78 3d73 656c        self.x=sel
+00002d80: 662e 782d 6f74 6865 722e 780a 2020 2020  f.x-other.x.    
+00002d90: 2020 2020 7365 6c66 2e79 3d73 656c 662e      self.y=self.
+00002da0: 792d 6f74 6865 722e 790a 2020 2020 2020  y-other.y.      
+00002db0: 2020 7365 6c66 2e7a 3d73 656c 662e 7a2d    self.z=self.z-
+00002dc0: 6f74 6865 722e 7a0a 2020 2020 2020 2020  other.z.        
+00002dd0: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
+00002de0: 2064 6566 205f 5f69 6d75 6c5f 5f28 7365   def __imul__(se
+00002df0: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+00002e00: 2020 2020 2222 2249 6e6c 696e 6520 6d75      """Inline mu
+00002e10: 6c74 6970 6c69 6361 7469 6f6e 2028 6f6e  ltiplication (on
+00002e20: 6c79 2077 6974 6820 7363 616c 6172 290a  ly with scalar).
+00002e30: 0a20 2020 2020 2020 203e 3e3e 2061 3d76  .        >>> a=v
+00002e40: 6563 3328 312e 302c 2030 2e35 2c20 2d31  ec3(1.0, 0.5, -1
+00002e50: 2e38 290a 2020 2020 2020 2020 3e3e 3e20  .8).        >>> 
+00002e60: 612a 3d32 2e30 0a20 2020 2020 2020 203e  a*=2.0.        >
+00002e70: 3e3e 2070 7269 6e74 2061 0a20 2020 2020  >> print a.     
+00002e80: 2020 2028 322e 3030 3030 2c20 312e 3030     (2.0000, 1.00
+00002e90: 3030 2c20 2d33 2e36 3030 3029 0a20 2020  00, -3.6000).   
+00002ea0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00002eb0: 2063 6465 6620 646f 7562 6c65 2072 0a20   cdef double r. 
+00002ec0: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
+00002ed0: 286f 7468 6572 290a 2020 2020 2020 2020  (other).        
+00002ee0: 6966 2074 6220 6973 2066 6c6f 6174 206f  if tb is float o
+00002ef0: 7220 7462 2069 7320 696e 7420 6f72 2074  r tb is int or t
+00002f00: 6220 6973 206c 6f6e 673a 0a20 2020 2020  b is long:.     
+00002f10: 2020 2020 2020 2072 3d6f 7468 6572 0a20         r=other. 
+00002f20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00002f30: 783d 7365 6c66 2e78 2a72 0a20 2020 2020  x=self.x*r.     
+00002f40: 2020 2020 2020 2073 656c 662e 793d 7365         self.y=se
+00002f50: 6c66 2e79 2a72 0a20 2020 2020 2020 2020  lf.y*r.         
+00002f60: 2020 2073 656c 662e 7a3d 7365 6c66 2e7a     self.z=self.z
+00002f70: 2a72 0a20 2020 2020 2020 2020 2020 2072  *r.            r
+00002f80: 6574 7572 6e20 7365 6c66 0a20 2020 2020  eturn self.     
+00002f90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00002fa0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00002fb0: 7272 6f72 2c20 2275 6e73 7570 706f 7274  rror, "unsupport
+00002fc0: 6564 206f 7065 7261 6e64 2074 7970 6520  ed operand type 
+00002fd0: 666f 7220 2a3d 220a 0a20 2020 2064 6566  for *="..    def
+00002fe0: 205f 5f69 6469 765f 5f28 7365 6c66 2c20   __idiv__(self, 
+00002ff0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+00003000: 2222 2249 6e6c 696e 6520 6469 7669 7369  """Inline divisi
+00003010: 6f6e 2077 6974 6820 7363 616c 6172 0a0a  on with scalar..
+00003020: 2020 2020 2020 2020 3e3e 3e20 613d 7665          >>> a=ve
+00003030: 6333 2831 2e30 2c20 302e 352c 202d 312e  c3(1.0, 0.5, -1.
+00003040: 3829 0a20 2020 2020 2020 203e 3e3e 2061  8).        >>> a
+00003050: 2f3d 322e 300a 2020 2020 2020 2020 3e3e  /=2.0.        >>
+00003060: 3e20 7072 696e 7420 610a 2020 2020 2020  > print a.      
+00003070: 2020 2830 2e35 3030 302c 2030 2e32 3530    (0.5000, 0.250
+00003080: 302c 202d 302e 3930 3030 290a 2020 2020  0, -0.9000).    
+00003090: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000030a0: 6364 6566 2064 6f75 626c 6520 720a 2020  cdef double r.  
+000030b0: 2020 2020 2020 7462 203d 2074 7970 6528        tb = type(
+000030c0: 6f74 6865 7229 0a20 2020 2020 2020 2069  other).        i
+000030d0: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
+000030e0: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
+000030f0: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
+00003100: 2020 2020 2020 723d 6f74 6865 720a 2020        r=other.  
+00003110: 2020 2020 2020 2020 2020 6966 2066 6162            if fab
+00003120: 7328 7229 3c3d 6570 733a 0a20 2020 2020  s(r)<=eps:.     
+00003130: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00003140: 205a 6572 6f44 6976 6973 696f 6e45 7272   ZeroDivisionErr
+00003150: 6f72 2c22 7665 6333 2064 6976 6973 696f  or,"vec3 divisio
+00003160: 6e22 0a20 2020 2020 2020 2020 2020 2073  n".            s
+00003170: 656c 662e 783d 7365 6c66 2e78 2f72 0a20  elf.x=self.x/r. 
+00003180: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00003190: 793d 7365 6c66 2e79 2f72 0a20 2020 2020  y=self.y/r.     
+000031a0: 2020 2020 2020 2073 656c 662e 7a3d 7365         self.z=se
+000031b0: 6c66 2e7a 2f72 0a20 2020 2020 2020 2020  lf.z/r.         
+000031c0: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
+000031d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000031e0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+000031f0: 7970 6545 7272 6f72 2c20 2275 6e73 7570  ypeError, "unsup
+00003200: 706f 7274 6564 206f 7065 7261 6e64 2074  ported operand t
+00003210: 7970 6520 666f 7220 2f3d 220a 0a20 2020  ype for /="..   
+00003220: 2064 6566 205f 5f69 6d6f 645f 5f28 7365   def __imod__(se
+00003230: 6c66 2c20 6229 3a0a 2020 2020 2020 2020  lf, b):.        
+00003240: 2222 2249 6e6c 696e 6520 6d6f 6475 6c6f  """Inline modulo
+00003250: 2e0a 0a20 2020 2020 2020 203e 3e3e 2061  ...        >>> a
+00003260: 3d76 6563 3328 332e 302c 2032 2e35 2c20  =vec3(3.0, 2.5, 
+00003270: 2d31 2e38 290a 2020 2020 2020 2020 3e3e  -1.8).        >>
+00003280: 3e20 6125 3d32 2e30 0a20 2020 2020 2020  > a%=2.0.       
+00003290: 203e 3e3e 2070 7269 6e74 2061 0a20 2020   >>> print a.   
+000032a0: 2020 2020 2028 312e 3030 3030 2c20 302e       (1.0000, 0.
+000032b0: 3530 3030 2c20 302e 3230 3030 290a 2020  5000, 0.2000).  
+000032c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000032d0: 2020 6364 6566 2076 6563 3320 7662 0a20    cdef vec3 vb. 
+000032e0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
+000032f0: 6c65 2072 0a0a 2020 2020 2020 2020 7462  le r..        tb
+00003300: 203d 2074 7970 6528 6229 0a0a 2020 2020   = type(b)..    
+00003310: 2020 2020 6966 2074 6220 6973 2066 6c6f      if tb is flo
+00003320: 6174 206f 7220 7462 2069 7320 696e 7420  at or tb is int 
+00003330: 6f72 2074 6220 6973 206c 6f6e 673a 0a20  or tb is long:. 
+00003340: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
+00003350: 3325 3d73 6361 6c61 720a 2020 2020 2020  3%=scalar.      
+00003360: 2020 2020 2020 7220 3d20 620a 2020 2020        r = b.    
+00003370: 2020 2020 2020 2020 6966 2066 6162 7328          if fabs(
+00003380: 7229 3c3d 6570 733a 0a20 2020 2020 2020  r)<=eps:.       
+00003390: 2020 2020 2020 2020 2072 6169 7365 205a           raise Z
+000033a0: 6572 6f44 6976 6973 696f 6e45 7272 6f72  eroDivisionError
+000033b0: 2c22 7665 6333 206d 6f64 756c 6f22 0a20  ,"vec3 modulo". 
+000033c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000033d0: 7820 3d20 5f66 6d6f 6428 7365 6c66 2e78  x = _fmod(self.x
+000033e0: 2c72 290a 2020 2020 2020 2020 2020 2020  ,r).            
+000033f0: 7365 6c66 2e79 203d 205f 666d 6f64 2873  self.y = _fmod(s
+00003400: 656c 662e 792c 7229 0a20 2020 2020 2020  elf.y,r).       
+00003410: 2020 2020 2073 656c 662e 7a20 3d20 5f66       self.z = _f
+00003420: 6d6f 6428 7365 6c66 2e7a 2c72 290a 2020  mod(self.z,r).  
+00003430: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00003440: 2073 656c 660a 2020 2020 2020 2020 656c   self.        el
+00003450: 6966 2074 6220 6973 2076 6563 333a 0a20  if tb is vec3:. 
+00003460: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
+00003470: 3325 3d76 6563 330a 2020 2020 2020 2020  3%=vec3.        
+00003480: 2020 2020 7662 203d 2062 0a20 2020 2020      vb = b.     
+00003490: 2020 2020 2020 2069 6620 6661 6273 2876         if fabs(v
+000034a0: 622e 7829 3c3d 6570 7320 6f72 2066 6162  b.x)<=eps or fab
+000034b0: 7328 7662 2e79 293c 3d65 7073 206f 7220  s(vb.y)<=eps or 
+000034c0: 6661 6273 2876 622e 7a29 3c3d 6570 733a  fabs(vb.z)<=eps:
+000034d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000034e0: 2072 6169 7365 205a 6572 6f44 6976 6973   raise ZeroDivis
+000034f0: 696f 6e45 7272 6f72 2c22 7665 6333 206d  ionError,"vec3 m
+00003500: 6f64 756c 6f22 0a20 2020 2020 2020 2020  odulo".         
+00003510: 2020 2073 656c 662e 7820 3d20 5f66 6d6f     self.x = _fmo
+00003520: 6428 7365 6c66 2e78 2c20 7662 2e78 290a  d(self.x, vb.x).
+00003530: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00003540: 2e79 203d 205f 666d 6f64 2873 656c 662e  .y = _fmod(self.
+00003550: 792c 2076 622e 7929 0a20 2020 2020 2020  y, vb.y).       
+00003560: 2020 2020 2073 656c 662e 7a20 3d20 5f66       self.z = _f
+00003570: 6d6f 6428 7365 6c66 2e7a 2c20 7662 2e7a  mod(self.z, vb.z
+00003580: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00003590: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
+000035a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000035b0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+000035c0: 726f 722c 2022 756e 7375 7070 6f72 7465  ror, "unsupporte
+000035d0: 6420 6f70 6572 616e 6420 7479 7065 2066  d operand type f
+000035e0: 6f72 2025 3d22 0a0a 0a20 2020 2064 6566  or %="...    def
+000035f0: 205f 5f61 6273 5f5f 2873 656c 6629 3a0a   __abs__(self):.
+00003600: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00003610: 6e20 7468 6520 6c65 6e67 7468 206f 6620  n the length of 
+00003620: 7468 6520 7665 6374 6f72 2e0a 0a20 2020  the vector...   
+00003630: 2020 2020 2061 6273 2876 2920 6973 2065       abs(v) is e
+00003640: 7175 6976 616c 656e 7420 746f 2076 2e6c  quivalent to v.l
+00003650: 656e 6774 6828 292e 0a0a 2020 2020 2020  ength()...      
+00003660: 2020 3e3e 3e20 613d 7665 6333 2831 2e30    >>> a=vec3(1.0
+00003670: 2c20 302e 352c 202d 312e 3829 0a20 2020  , 0.5, -1.8).   
+00003680: 2020 2020 203e 3e3e 2070 7269 6e74 2061       >>> print a
+00003690: 6273 2861 290a 2020 2020 2020 2020 322e  bs(a).        2.
+000036a0: 3131 3839 3632 3031 3030 340a 2020 2020  11896201004.    
+000036b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000036c0: 6364 6566 2064 6f75 626c 6520 610a 2020  cdef double a.  
+000036d0: 2020 2020 2020 6120 3d20 7365 6c66 2e78        a = self.x
+000036e0: 2a73 656c 662e 7820 2b20 7365 6c66 2e79  *self.x + self.y
+000036f0: 2a73 656c 662e 7920 2b20 7365 6c66 2e7a  *self.y + self.z
+00003700: 2a73 656c 662e 7a0a 2020 2020 2020 2020  *self.z.        
+00003710: 7265 7475 726e 2073 7172 7428 6129 0a0a  return sqrt(a)..
+00003720: 2020 2020 6465 6620 5f5f 6765 7461 7474      def __getatt
+00003730: 725f 5f28 7365 6c66 2c20 6e61 6d65 293a  r__(self, name):
+00003740: 0a20 2020 2020 2020 2069 6620 6e61 6d65  .        if name
+00003750: 3d3d 2278 223a 0a20 2020 2020 2020 2020  =="x":.         
+00003760: 2020 2072 6574 7572 6e20 7365 6c66 2e78     return self.x
+00003770: 0a20 2020 2020 2020 2065 6c69 6620 6e61  .        elif na
+00003780: 6d65 3d3d 2279 223a 0a20 2020 2020 2020  me=="y":.       
+00003790: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000037a0: 2e79 0a20 2020 2020 2020 2065 6c69 6620  .y.        elif 
+000037b0: 6e61 6d65 3d3d 227a 223a 0a20 2020 2020  name=="z":.     
+000037c0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000037d0: 6c66 2e7a 0a20 2020 2020 2020 2065 6c73  lf.z.        els
+000037e0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+000037f0: 6169 7365 2041 7474 7269 6275 7465 4572  aise AttributeEr
+00003800: 726f 722c 2276 6563 3320 6861 7320 6e6f  ror,"vec3 has no
+00003810: 2061 7474 7269 6275 7465 2027 222b 6e61   attribute '"+na
+00003820: 6d65 2b22 2722 0a0a 2020 2020 6465 6620  me+"'"..    def 
+00003830: 5f5f 7365 7461 7474 725f 5f28 7365 6c66  __setattr__(self
+00003840: 2c20 6e61 6d65 2c20 7661 6c29 3a0a 2020  , name, val):.  
+00003850: 2020 2020 2020 6966 206e 616d 653d 3d22        if name=="
+00003860: 7822 3a0a 2020 2020 2020 2020 2020 2020  x":.            
+00003870: 7365 6c66 2e78 203d 2076 616c 0a20 2020  self.x = val.   
+00003880: 2020 2020 2065 6c69 6620 6e61 6d65 3d3d       elif name==
+00003890: 2279 223a 0a20 2020 2020 2020 2020 2020  "y":.           
+000038a0: 2073 656c 662e 7920 3d20 7661 6c0a 2020   self.y = val.  
+000038b0: 2020 2020 2020 656c 6966 206e 616d 653d        elif name=
+000038c0: 3d22 7a22 3a0a 2020 2020 2020 2020 2020  ="z":.          
+000038d0: 2020 7365 6c66 2e7a 203d 2076 616c 0a20    self.z = val. 
+000038e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000038f0: 2020 2020 2020 2020 2072 6169 7365 2041           raise A
+00003900: 7474 7269 6275 7465 4572 726f 722c 2276  ttributeError,"v
+00003910: 6563 3320 6861 7320 6e6f 2077 7269 7461  ec3 has no writa
+00003920: 626c 6520 6174 7472 6962 7574 6520 2722  ble attribute '"
+00003930: 2b6e 616d 652b 2227 220a 0a20 2020 2064  +name+"'"..    d
+00003940: 6566 205f 5f6c 656e 5f5f 2873 656c 6629  ef __len__(self)
+00003950: 3a0a 2020 2020 2020 2020 2222 224c 656e  :.        """Len
+00003960: 6774 6820 6f66 2074 6865 2073 6571 7565  gth of the seque
+00003970: 6e63 6520 2861 6c77 6179 7320 3329 2222  nce (always 3)""
+00003980: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00003990: 2033 0a0a 2020 2020 6465 6620 5f5f 6765   3..    def __ge
+000039a0: 7469 7465 6d5f 5f28 7665 6333 2073 656c  titem__(vec3 sel
+000039b0: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
+000039c0: 2022 2222 5265 7475 726e 2061 2063 6f6d   """Return a com
+000039d0: 706f 6e65 6e74 2062 7920 696e 6465 7820  ponent by index 
+000039e0: 2830 2d62 6173 6564 290a 0a20 2020 2020  (0-based)..     
+000039f0: 2020 203e 3e3e 2061 3d76 6563 3328 312e     >>> a=vec3(1.
+00003a00: 302c 2030 2e35 2c20 2d31 2e38 290a 2020  0, 0.5, -1.8).  
+00003a10: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
+00003a20: 615b 305d 0a20 2020 2020 2020 2031 2e30  a[0].        1.0
+00003a30: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00003a40: 6e74 2061 5b31 5d0a 2020 2020 2020 2020  nt a[1].        
+00003a50: 302e 350a 2020 2020 2020 2020 3e3e 3e20  0.5.        >>> 
+00003a60: 7072 696e 7420 615b 325d 0a20 2020 2020  print a[2].     
+00003a70: 2020 202d 312e 380a 2020 2020 2020 2020     -1.8.        
+00003a80: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+00003a90: 2069 6e74 206b 0a0a 2020 2020 2020 2020   int k..        
+00003aa0: 543d 7479 7065 286b 6579 290a 2020 2020  T=type(key).    
+00003ab0: 2020 2020 6966 2054 213d 696e 7420 616e      if T!=int an
+00003ac0: 6420 5421 3d6c 6f6e 673a 0a20 2020 2020  d T!=long:.     
+00003ad0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00003ae0: 6545 7272 6f72 2c20 2269 6e64 6578 206d  eError, "index m
+00003af0: 7573 7420 6265 2069 6e74 6567 6572 220a  ust be integer".
+00003b00: 0a20 2020 2020 2020 206b 203d 206b 6579  .        k = key
+00003b10: 0a20 2020 2020 2020 2069 6620 2020 6b3d  .        if   k=
+00003b20: 3d30 3a20 7265 7475 726e 2073 656c 662e  =0: return self.
+00003b30: 780a 2020 2020 2020 2020 656c 6966 206b  x.        elif k
+00003b40: 3d3d 313a 2072 6574 7572 6e20 7365 6c66  ==1: return self
+00003b50: 2e79 0a20 2020 2020 2020 2065 6c69 6620  .y.        elif 
+00003b60: 6b3d 3d32 3a20 7265 7475 726e 2073 656c  k==2: return sel
+00003b70: 662e 7a0a 2020 2020 2020 2020 656c 7365  f.z.        else
+00003b80: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00003b90: 6973 6520 496e 6465 7845 7272 6f72 2c22  ise IndexError,"
+00003ba0: 696e 6465 7820 6f75 7420 6f66 2072 616e  index out of ran
+00003bb0: 6765 220a 0a20 2020 2064 6566 205f 5f73  ge"..    def __s
+00003bc0: 6574 6974 656d 5f5f 2873 656c 662c 206b  etitem__(self, k
+00003bd0: 6579 2c20 7661 6c75 6529 3a0a 2020 2020  ey, value):.    
+00003be0: 2020 2020 2222 2253 6574 2061 2063 6f6d      """Set a com
+00003bf0: 706f 6e65 6e74 2062 7920 696e 6465 7820  ponent by index 
+00003c00: 2830 2d62 6173 6564 290a 0a20 2020 2020  (0-based)..     
+00003c10: 2020 203e 3e3e 2061 3d76 6563 3328 290a     >>> a=vec3().
+00003c20: 2020 2020 2020 2020 3e3e 3e20 615b 305d          >>> a[0]
+00003c30: 3d31 2e35 3b20 615b 315d 3d30 2e37 3b20  =1.5; a[1]=0.7; 
+00003c40: 615b 325d 3d2d 302e 330a 2020 2020 2020  a[2]=-0.3.      
+00003c50: 2020 3e3e 3e20 7072 696e 7420 610a 2020    >>> print a.  
+00003c60: 2020 2020 2020 2831 2e35 3030 302c 2030        (1.5000, 0
+00003c70: 2e37 3030 302c 202d 302e 3330 3030 290a  .7000, -0.3000).
+00003c80: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00003c90: 2020 2020 6364 6566 2069 6e74 206b 0a0a      cdef int k..
+00003ca0: 2020 2020 2020 2020 543d 7479 7065 286b          T=type(k
+00003cb0: 6579 290a 2020 2020 2020 2020 6966 2054  ey).        if T
+00003cc0: 213d 696e 7420 616e 6420 5421 3d6c 6f6e  !=int and T!=lon
+00003cd0: 673a 0a20 2020 2020 2020 2020 2020 2072  g:.            r
+00003ce0: 6169 7365 2054 7970 6545 7272 6f72 2c20  aise TypeError, 
+00003cf0: 2269 6e64 6578 206d 7573 7420 6265 2069  "index must be i
+00003d00: 6e74 6567 6572 220a 0a20 2020 2020 2020  nteger"..       
+00003d10: 206b 203d 206b 6579 0a20 2020 2020 2020   k = key.       
+00003d20: 2069 6620 2020 6b3d 3d30 3a20 7365 6c66   if   k==0: self
+00003d30: 2e78 203d 2076 616c 7565 0a20 2020 2020  .x = value.     
+00003d40: 2020 2065 6c69 6620 6b3d 3d31 3a20 7365     elif k==1: se
+00003d50: 6c66 2e79 203d 2076 616c 7565 0a20 2020  lf.y = value.   
+00003d60: 2020 2020 2065 6c69 6620 6b3d 3d32 3a20       elif k==2: 
+00003d70: 7365 6c66 2e7a 203d 2076 616c 7565 0a20  self.z = value. 
+00003d80: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00003d90: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
+00003da0: 6e64 6578 4572 726f 722c 2269 6e64 6578  ndexError,"index
+00003db0: 206f 7574 206f 6620 7261 6e67 6522 0a0a   out of range"..
+00003dc0: 2020 2020 6465 6620 6372 6f73 7328 7365      def cross(se
+00003dd0: 6c66 2c20 7665 6333 206f 7468 6572 293a  lf, vec3 other):
+00003de0: 0a20 2020 2020 2020 2022 2222 4372 6f73  .        """Cros
+00003df0: 7320 7072 6f64 7563 742e 0a0a 2020 2020  s product...    
+00003e00: 2020 2020 3e3e 3e20 613d 7665 6333 2831      >>> a=vec3(1
+00003e10: 2e30 2c20 302e 352c 202d 312e 3829 0a20  .0, 0.5, -1.8). 
+00003e20: 2020 2020 2020 203e 3e3e 2062 3d76 6563         >>> b=vec
+00003e30: 3328 2d30 2e33 2c20 302e 3735 2c20 302e  3(-0.3, 0.75, 0.
+00003e40: 3529 0a20 2020 2020 2020 203e 3e3e 2063  5).        >>> c
+00003e50: 3d61 2e63 726f 7373 2862 290a 2020 2020  =a.cross(b).    
+00003e60: 2020 2020 3e3e 3e20 7072 696e 7420 630a      >>> print c.
+00003e70: 2020 2020 2020 2020 2831 2e36 3030 302c          (1.6000,
+00003e80: 2030 2e30 3430 302c 2030 2e39 3030 3029   0.0400, 0.9000)
+00003e90: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00003ea0: 2020 2020 2063 6465 6620 7665 6333 2072       cdef vec3 r
+00003eb0: 6573 0a0a 2020 2020 2020 2020 6966 2074  es..        if t
+00003ec0: 7970 6528 6f74 6865 7229 3d3d 7665 6333  ype(other)==vec3
+00003ed0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00003ee0: 7320 3d20 7665 6333 2829 0a20 2020 2020  s = vec3().     
+00003ef0: 2020 2020 2020 2072 6573 2e78 203d 2073         res.x = s
+00003f00: 656c 662e 792a 6f74 6865 722e 7a2d 7365  elf.y*other.z-se
+00003f10: 6c66 2e7a 2a6f 7468 6572 2e79 0a20 2020  lf.z*other.y.   
+00003f20: 2020 2020 2020 2020 2072 6573 2e79 203d           res.y =
+00003f30: 2073 656c 662e 7a2a 6f74 6865 722e 782d   self.z*other.x-
+00003f40: 7365 6c66 2e78 2a6f 7468 6572 2e7a 0a20  self.x*other.z. 
+00003f50: 2020 2020 2020 2020 2020 2072 6573 2e7a             res.z
+00003f60: 203d 2073 656c 662e 782a 6f74 6865 722e   = self.x*other.
+00003f70: 792d 7365 6c66 2e79 2a6f 7468 6572 2e78  y-self.y*other.x
+00003f80: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00003f90: 7572 6e20 7265 730a 2020 2020 2020 2020  urn res.        
+00003fa0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00003fb0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00003fc0: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
+00003fd0: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
+00003fe0: 2063 726f 7373 2829 220a 0a20 2020 2064   cross()"..    d
+00003ff0: 6566 206c 656e 6774 6828 7365 6c66 293a  ef length(self):
+00004000: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00004010: 726e 2074 6865 206c 656e 6774 6820 6f66  rn the length of
+00004020: 2074 6865 2076 6563 746f 722e 0a0a 2020   the vector...  
+00004030: 2020 2020 2020 762e 6c65 6e67 7468 2829        v.length()
+00004040: 2069 7320 6571 7569 7661 6c65 6e74 2074   is equivalent t
+00004050: 6f20 6162 7328 7629 2e0a 0a20 2020 2020  o abs(v)...     
+00004060: 2020 203e 3e3e 2061 3d76 6563 3328 312e     >>> a=vec3(1.
+00004070: 302c 2030 2e35 2c20 2d31 2e38 290a 2020  0, 0.5, -1.8).  
+00004080: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
+00004090: 612e 6c65 6e67 7468 2829 0a20 2020 2020  a.length().     
+000040a0: 2020 2032 2e31 3138 3936 3230 3130 3034     2.11896201004
+000040b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000040c0: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
+000040d0: 2061 0a20 2020 2020 2020 2061 203d 2073   a.        a = s
+000040e0: 656c 662e 782a 7365 6c66 2e78 202b 2073  elf.x*self.x + s
+000040f0: 656c 662e 792a 7365 6c66 2e79 202b 2073  elf.y*self.y + s
+00004100: 656c 662e 7a2a 7365 6c66 2e7a 0a20 2020  elf.z*self.z.   
+00004110: 2020 2020 2072 6574 7572 6e20 7371 7274       return sqrt
+00004120: 2861 290a 0a20 2020 2064 6566 206e 6f72  (a)..    def nor
+00004130: 6d61 6c69 7a65 2873 656c 6629 3a0a 2020  malize(self):.  
+00004140: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+00004150: 6e6f 726d 616c 697a 6564 2076 6563 746f  normalized vecto
+00004160: 722e 0a0a 2020 2020 2020 2020 3e3e 3e20  r...        >>> 
+00004170: 613d 7665 6333 2831 2e30 2c20 302e 352c  a=vec3(1.0, 0.5,
+00004180: 202d 312e 3829 0a20 2020 2020 2020 203e   -1.8).        >
+00004190: 3e3e 2070 7269 6e74 2061 2e6e 6f72 6d61  >> print a.norma
+000041a0: 6c69 7a65 2829 0a20 2020 2020 2020 2028  lize().        (
+000041b0: 302e 3437 3139 2c20 302e 3233 3630 2c20  0.4719, 0.2360, 
+000041c0: 2d30 2e38 3439 3529 0a20 2020 2020 2020  -0.8495).       
+000041d0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+000041e0: 6620 7665 6333 2072 6573 0a20 2020 2020  f vec3 res.     
+000041f0: 2020 2063 6465 6620 646f 7562 6c65 206e     cdef double n
+00004200: 6c65 6e0a 0a20 2020 2020 2020 206e 6c65  len..        nle
+00004210: 6e20 3d20 7371 7274 2873 656c 662e 782a  n = sqrt(self.x*
+00004220: 7365 6c66 2e78 202b 2073 656c 662e 792a  self.x + self.y*
+00004230: 7365 6c66 2e79 202b 2073 656c 662e 7a2a  self.y + self.z*
+00004240: 7365 6c66 2e7a 290a 2020 2020 2020 2020  self.z).        
+00004250: 6966 206e 6c65 6e3c 3d65 7073 3a0a 2020  if nlen<=eps:.  
+00004260: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00004270: 5a65 726f 4469 7669 7369 6f6e 4572 726f  ZeroDivisionErro
+00004280: 722c 226e 756c 6c20 7665 6374 6f72 2063  r,"null vector c
+00004290: 616e 2774 2062 6520 6e6f 726d 616c 697a  an't be normaliz
+000042a0: 6564 220a 2020 2020 2020 2020 6e6c 656e  ed".        nlen
+000042b0: 203d 2031 2e30 2f6e 6c65 6e0a 2020 2020   = 1.0/nlen.    
+000042c0: 2020 2020 7265 7320 3d20 7665 6333 2829      res = vec3()
+000042d0: 0a20 2020 2020 2020 2072 6573 2e78 203d  .        res.x =
+000042e0: 2073 656c 662e 782a 6e6c 656e 0a20 2020   self.x*nlen.   
+000042f0: 2020 2020 2072 6573 2e79 203d 2073 656c       res.y = sel
+00004300: 662e 792a 6e6c 656e 0a20 2020 2020 2020  f.y*nlen.       
+00004310: 2072 6573 2e7a 203d 2073 656c 662e 7a2a   res.z = self.z*
+00004320: 6e6c 656e 0a20 2020 2020 2020 2072 6574  nlen.        ret
+00004330: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
+00004340: 2061 6e67 6c65 2873 656c 662c 2076 6563   angle(self, vec
+00004350: 3320 6f74 6865 7229 3a0a 2020 2020 2020  3 other):.      
+00004360: 2020 2222 2252 6574 7572 6e20 616e 676c    """Return angl
+00004370: 6520 2869 6e20 7261 6469 616e 7329 2062  e (in radians) b
+00004380: 6574 7765 656e 2073 656c 6620 616e 6420  etween self and 
+00004390: 6f74 6865 722e 0a0a 2020 2020 2020 2020  other...        
+000043a0: 3e3e 3e20 613d 7665 6333 2831 2e30 2c20  >>> a=vec3(1.0, 
+000043b0: 302e 352c 202d 312e 3829 0a20 2020 2020  0.5, -1.8).     
+000043c0: 2020 203e 3e3e 2062 3d76 6563 3328 2d30     >>> b=vec3(-0
+000043d0: 2e33 2c20 302e 3735 2c20 302e 3529 0a20  .3, 0.75, 0.5). 
+000043e0: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+000043f0: 2061 2e61 6e67 6c65 2862 290a 2020 2020   a.angle(b).    
+00004400: 2020 2020 312e 3939 3330 3637 3535 3538      1.9930675558
+00004410: 340a 2020 2020 2020 2020 2222 220a 0a20  4.        """.. 
+00004420: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
+00004430: 6c65 2061 2c20 6c73 2c20 6c6f 0a0a 2020  le a, ls, lo..  
+00004440: 2020 2020 2020 6c73 203d 2073 7172 7428        ls = sqrt(
+00004450: 7365 6c66 2e78 2a73 656c 662e 7820 2b20  self.x*self.x + 
+00004460: 7365 6c66 2e79 2a73 656c 662e 7920 2b20  self.y*self.y + 
+00004470: 7365 6c66 2e7a 2a73 656c 662e 7a29 0a20  self.z*self.z). 
+00004480: 2020 2020 2020 206c 6f20 3d20 7371 7274         lo = sqrt
+00004490: 286f 7468 6572 2e78 2a6f 7468 6572 2e78  (other.x*other.x
+000044a0: 202b 206f 7468 6572 2e79 2a6f 7468 6572   + other.y*other
+000044b0: 2e79 202b 206f 7468 6572 2e7a 2a6f 7468  .y + other.z*oth
+000044c0: 6572 2e7a 290a 2020 2020 2020 2020 6120  er.z).        a 
+000044d0: 203d 206c 732a 6c6f 0a20 2020 2020 2020   = ls*lo.       
+000044e0: 2069 6620 613c 3d65 7073 3a0a 2020 2020   if a<=eps:.    
+000044f0: 2020 2020 2020 2020 7261 6973 6520 5a65          raise Ze
+00004500: 726f 4469 7669 7369 6f6e 4572 726f 722c  roDivisionError,
+00004510: 2261 6e67 6c65 2829 3a20 6e75 6c6c 2076  "angle(): null v
+00004520: 6563 746f 7220 6361 6e27 7420 6265 206e  ector can't be n
+00004530: 6f72 6d61 6c69 7a65 6422 0a20 2020 2020  ormalized".     
+00004540: 2020 2061 2020 3d20 2873 656c 662e 782a     a  = (self.x*
+00004550: 6f74 6865 722e 7820 2b20 7365 6c66 2e79  other.x + self.y
+00004560: 2a6f 7468 6572 2e79 202b 2073 656c 662e  *other.y + self.
+00004570: 7a2a 6f74 6865 722e 7a29 2f61 0a20 2020  z*other.z)/a.   
+00004580: 2020 2020 2069 6620 613e 312e 303a 0a20       if a>1.0:. 
+00004590: 2020 2020 2020 2020 2020 2061 3d31 2e30             a=1.0
+000045a0: 0a20 2020 2020 2020 2069 6620 613c 2d31  .        if a<-1
+000045b0: 2e30 3a0a 2020 2020 2020 2020 2020 2020  .0:.            
+000045c0: 613d 2d31 2e30 0a20 2020 2020 2020 2072  a=-1.0.        r
+000045d0: 6574 7572 6e20 6163 6f73 2861 290a 2320  eturn acos(a).# 
+000045e0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000045f0: 616e 6365 286f 7468 6572 2c20 7665 6333  ance(other, vec3
+00004600: 293a 0a23 2020 2020 2020 2020 2020 2020  ):.#            
+00004610: 7265 7475 726e 206d 6174 682e 6163 6f73  return math.acos
+00004620: 2828 7365 6c66 2a6f 7468 6572 2920 2f20  ((self*other) / 
+00004630: 2861 6273 2873 656c 6629 2a61 6273 286f  (abs(self)*abs(o
+00004640: 7468 6572 2929 290a 2320 2020 2020 2020  ther))).#       
+00004650: 2065 6c73 653a 0a23 2020 2020 2020 2020   else:.#        
+00004660: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00004670: 726f 722c 2022 756e 7375 7070 6f72 7465  ror, "unsupporte
+00004680: 6420 6f70 6572 616e 6420 7479 7065 2066  d operand type f
+00004690: 6f72 2061 6e67 6c65 2829 220a 0a20 2020  or angle()"..   
+000046a0: 2064 6566 2072 6566 6c65 6374 2873 656c   def reflect(sel
+000046b0: 662c 2076 6563 3320 4e29 3a0a 2020 2020  f, vec3 N):.    
+000046c0: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
+000046d0: 6520 7265 666c 6563 7469 6f6e 2076 6563  e reflection vec
+000046e0: 746f 722e 0a0a 2020 2020 2020 2020 4e20  tor...        N 
+000046f0: 6973 2074 6865 2073 7572 6661 6365 206e  is the surface n
+00004700: 6f72 6d61 6c20 7768 6963 6820 6861 7320  ormal which has 
+00004710: 746f 2062 6520 6f66 2075 6e69 7420 6c65  to be of unit le
+00004720: 6e67 7468 2e0a 0a20 2020 2020 2020 203e  ngth...        >
+00004730: 3e3e 2061 3d76 6563 3328 312e 302c 202d  >> a=vec3(1.0, -
+00004740: 312e 302c 2030 2e30 290a 2020 2020 2020  1.0, 0.0).      
+00004750: 2020 3e3e 3e20 7072 696e 7420 612e 7265    >>> print a.re
+00004760: 666c 6563 7428 7665 6333 2830 2c31 2c30  flect(vec3(0,1,0
+00004770: 290a 2020 2020 2020 2020 2831 2e30 3030  ).        (1.000
+00004780: 302c 2031 2e30 3030 302c 2030 2e30 3030  0, 1.0000, 0.000
+00004790: 3029 0a20 2020 2020 2020 2022 2222 0a20  0).        """. 
+000047a0: 2020 2020 2020 2063 6465 6620 7665 6333         cdef vec3
+000047b0: 2072 6573 0a20 2020 2020 2020 2063 6465   res.        cde
+000047c0: 6620 646f 7562 6c65 2061 0a0a 2020 2020  f double a..    
+000047d0: 2020 2020 7265 7320 3d20 7665 6333 2829      res = vec3()
+000047e0: 0a20 2020 2020 2020 2061 203d 2032 2e30  .        a = 2.0
+000047f0: 2a28 7365 6c66 2e78 2a4e 2e78 202b 2073  *(self.x*N.x + s
+00004800: 656c 662e 792a 4e2e 7920 2b20 7365 6c66  elf.y*N.y + self
+00004810: 2e7a 2a4e 2e7a 290a 2020 2020 2020 2020  .z*N.z).        
+00004820: 7265 732e 7820 3d20 7365 6c66 2e78 202d  res.x = self.x -
+00004830: 2061 2a4e 2e78 0a20 2020 2020 2020 2072   a*N.x.        r
+00004840: 6573 2e79 203d 2073 656c 662e 7920 2d20  es.y = self.y - 
+00004850: 612a 4e2e 790a 2020 2020 2020 2020 7265  a*N.y.        re
+00004860: 732e 7a20 3d20 7365 6c66 2e7a 202d 2061  s.z = self.z - a
+00004870: 2a4e 2e7a 0a20 2020 2020 2020 2072 6574  *N.z.        ret
+00004880: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
+00004890: 2072 6566 7261 6374 2873 656c 662c 2076   refract(self, v
+000048a0: 6563 3320 4e2c 2065 7461 293a 0a20 2020  ec3 N, eta):.   
+000048b0: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+000048c0: 6865 2074 7261 6e73 6d69 7474 6564 2076  he transmitted v
+000048d0: 6563 746f 722e 0a0a 2020 2020 2020 2020  ector...        
+000048e0: 4e20 6973 2074 6865 2073 7572 6661 6365  N is the surface
+000048f0: 206e 6f72 6d61 6c20 7768 6963 6820 6861   normal which ha
+00004900: 7320 746f 2062 6520 6f66 2075 6e69 7420  s to be of unit 
+00004910: 6c65 6e67 7468 2e0a 2020 2020 2020 2020  length..        
+00004920: 6574 6120 6973 2074 6865 2072 656c 6174  eta is the relat
+00004930: 6976 6520 696e 6465 7820 6f66 2072 6566  ive index of ref
+00004940: 7261 6374 696f 6e2e 2049 6620 7468 6520  raction. If the 
+00004950: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
+00004960: 2076 6563 746f 7220 6973 207a 6572 6f20   vector is zero 
+00004970: 7468 656e 2074 6865 7265 2069 7320 6e6f  then there is no
+00004980: 2074 7261 6e73 6d69 7474 6564 206c 6967   transmitted lig
+00004990: 6874 2062 6563 6175 7365 0a20 2020 2020  ht because.     
+000049a0: 2020 206f 6620 746f 7461 6c20 696e 7465     of total inte
+000049b0: 726e 616c 2072 6566 6c65 6374 696f 6e2e  rnal reflection.
+000049c0: 0a0a 2020 2020 2020 2020 3e3e 3e20 613d  ..        >>> a=
+000049d0: 7665 6333 2831 2e30 2c20 2d31 2e35 2c20  vec3(1.0, -1.5, 
+000049e0: 302e 3829 0a20 2020 2020 2020 203e 3e3e  0.8).        >>>
+000049f0: 2070 7269 6e74 2061 2e72 6566 7261 6374   print a.refract
+00004a00: 2876 6563 3328 302c 312c 3029 2c20 312e  (vec3(0,1,0), 1.
+00004a10: 3333 290a 2020 2020 2020 2020 2831 2e33  33).        (1.3
+00004a20: 3330 302c 202d 312e 3739 3230 2c20 312e  300, -1.7920, 1.
+00004a30: 3036 3430 290a 2020 2020 2020 2020 2222  0640).        ""
+00004a40: 220a 2020 2020 2020 2020 6364 6566 2076  ".        cdef v
+00004a50: 6563 3320 7265 730a 2020 2020 2020 2020  ec3 res.        
+00004a60: 6364 6566 2064 6f75 626c 6520 646f 742c  cdef double dot,
+00004a70: 206b 2c20 6365 7461 0a0a 2020 2020 2020   k, ceta..      
+00004a80: 2020 7265 7320 3d20 7665 6333 2829 0a0a    res = vec3()..
+00004a90: 2020 2020 2020 2020 6365 7461 203d 2065          ceta = e
+00004aa0: 7461 0a20 2020 2020 2020 2064 6f74 203d  ta.        dot =
+00004ab0: 2073 656c 662e 782a 4e2e 7820 2b20 7365   self.x*N.x + se
+00004ac0: 6c66 2e79 2a4e 2e79 202b 2073 656c 662e  lf.y*N.y + self.
+00004ad0: 7a2a 4e2e 7a0a 2020 2020 2020 2020 6b20  z*N.z.        k 
+00004ae0: 2020 3d20 312e 3020 2d20 6365 7461 2a63    = 1.0 - ceta*c
+00004af0: 6574 612a 2831 2e30 202d 2064 6f74 2a64  eta*(1.0 - dot*d
+00004b00: 6f74 290a 2020 2020 2020 2020 6966 206b  ot).        if k
+00004b10: 3c3d 6570 733a 0a20 2020 2020 2020 2020  <=eps:.         
+00004b20: 2020 2072 6573 2e78 203d 2030 2e30 0a20     res.x = 0.0. 
+00004b30: 2020 2020 2020 2020 2020 2072 6573 2e79             res.y
+00004b40: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
+00004b50: 2020 2072 6573 2e7a 203d 2030 2e30 0a20     res.z = 0.0. 
+00004b60: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00004b70: 2020 2020 2020 2020 206b 203d 2063 6574           k = cet
+00004b80: 612a 646f 7420 2b20 7371 7274 286b 290a  a*dot + sqrt(k).
+00004b90: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00004ba0: 7820 3d20 6365 7461 2a73 656c 662e 7820  x = ceta*self.x 
+00004bb0: 2d20 6b2a 4e2e 780a 2020 2020 2020 2020  - k*N.x.        
+00004bc0: 2020 2020 7265 732e 7920 3d20 6365 7461      res.y = ceta
+00004bd0: 2a73 656c 662e 7920 2d20 6b2a 4e2e 790a  *self.y - k*N.y.
+00004be0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00004bf0: 7a20 3d20 6365 7461 2a73 656c 662e 7a20  z = ceta*self.z 
+00004c00: 2d20 6b2a 4e2e 7a0a 0a20 2020 2020 2020  - k*N.z..       
+00004c10: 2072 6574 7572 6e20 7265 730a 0a20 2020   return res..   
+00004c20: 2064 6566 206f 7274 686f 2873 656c 6629   def ortho(self)
+00004c30: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+00004c40: 7572 6e73 2061 6e20 6f72 7468 6f67 6f6e  urns an orthogon
+00004c50: 616c 2076 6563 746f 722e 0a0a 2020 2020  al vector...    
+00004c60: 2020 2020 5265 7475 726e 7320 6120 7665      Returns a ve
+00004c70: 6374 6f72 2074 6861 7420 6973 206f 7274  ctor that is ort
+00004c80: 686f 676f 6e61 6c20 746f 2073 656c 6620  hogonal to self 
+00004c90: 2877 6865 7265 0a20 2020 2020 2020 2073  (where.        s
+00004ca0: 656c 662a 7365 6c66 2e6f 7274 686f 2829  elf*self.ortho()
+00004cb0: 3d3d 3029 2e0a 0a20 2020 2020 2020 203e  ==0)...        >
+00004cc0: 3e3e 2061 3d76 6563 3328 312e 302c 202d  >> a=vec3(1.0, -
+00004cd0: 312e 352c 2030 2e38 290a 2020 2020 2020  1.5, 0.8).      
+00004ce0: 2020 3e3e 3e20 7072 696e 7420 726f 756e    >>> print roun
+00004cf0: 6428 612a 612e 6f72 7468 6f28 292c 3829  d(a*a.ortho(),8)
+00004d00: 0a20 2020 2020 2020 2030 2e30 0a20 2020  .        0.0.   
+00004d10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00004d20: 2063 6465 6620 7665 6333 2072 6573 0a20   cdef vec3 res. 
+00004d30: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
+00004d40: 6c65 2078 2c79 2c7a 0a20 2020 2020 2020  le x,y,z.       
+00004d50: 2072 6573 203d 2076 6563 3328 290a 0a20   res = vec3().. 
+00004d60: 2020 2020 2020 2078 3d66 6162 7328 7365         x=fabs(se
+00004d70: 6c66 2e78 290a 2020 2020 2020 2020 793d  lf.x).        y=
+00004d80: 6661 6273 2873 656c 662e 7929 0a20 2020  fabs(self.y).   
+00004d90: 2020 2020 207a 3d66 6162 7328 7365 6c66       z=fabs(self
+00004da0: 2e7a 290a 2020 2020 2020 2020 2320 4973  .z).        # Is
+00004db0: 207a 2074 6865 2073 6d61 6c6c 6573 7420   z the smallest 
+00004dc0: 656c 656d 656e 743f 2054 6865 6e20 7573  element? Then us
+00004dd0: 6520 7820 616e 6420 790a 2020 2020 2020  e x and y.      
+00004de0: 2020 6966 207a 3c3d 7820 616e 6420 7a3c    if z<=x and z<
+00004df0: 3d79 3a0a 2020 2020 2020 2020 2020 2020  =y:.            
+00004e00: 7265 732e 7820 3d20 2d73 656c 662e 790a  res.x = -self.y.
+00004e10: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00004e20: 7920 3d20 7365 6c66 2e78 0a20 2020 2020  y = self.x.     
+00004e30: 2020 2020 2020 2072 6573 2e7a 203d 2030         res.z = 0
+00004e40: 2e30 0a20 2020 2020 2020 2023 2049 7320  .0.        # Is 
+00004e50: 7920 736d 616c 6c65 7374 2065 6c65 6d65  y smallest eleme
+00004e60: 6e74 3f20 5468 656e 2075 7365 2078 2061  nt? Then use x a
+00004e70: 6e64 207a 0a20 2020 2020 2020 2065 6c69  nd z.        eli
+00004e80: 6620 793c 3d78 2061 6e64 2079 3c3d 7a3a  f y<=x and y<=z:
+00004e90: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00004ea0: 2e78 203d 202d 7365 6c66 2e7a 0a20 2020  .x = -self.z.   
+00004eb0: 2020 2020 2020 2020 2072 6573 2e79 203d           res.y =
 00004ec0: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
-00004ed0: 2072 6573 2e79 203d 202d 7365 6c66 2e7a   res.y = -self.z
-00004ee0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00004ef0: 2e7a 203d 2073 656c 662e 790a 0a20 2020  .z = self.y..   
-00004f00: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-00004f10: 0a0a 2020 2020 6465 6620 6661 6464 2873  ..    def fadd(s
-00004f20: 656c 662c 2076 6563 3320 612c 2076 6563  elf, vec3 a, vec
-00004f30: 3320 6229 3a0a 2020 2020 2020 2020 7365  3 b):.        se
-00004f40: 6c66 2e78 203d 2061 2e78 2b62 2e78 0a20  lf.x = a.x+b.x. 
-00004f50: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
-00004f60: 612e 792b 622e 790a 2020 2020 2020 2020  a.y+b.y.        
-00004f70: 7365 6c66 2e7a 203d 2061 2e7a 2b62 2e7a  self.z = a.z+b.z
-00004f80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00004f90: 7365 6c66 0a0a 2020 2020 6465 6620 666e  self..    def fn
-00004fa0: 6f72 6d61 6c69 7a65 2873 656c 662c 2076  ormalize(self, v
-00004fb0: 6563 3320 6129 3a0a 2020 2020 2020 2020  ec3 a):.        
-00004fc0: 2222 224e 6f72 6d61 6c69 7a65 2076 6563  """Normalize vec
-00004fd0: 746f 7220 6120 616e 6420 7374 6f72 6520  tor a and store 
-00004fe0: 7265 7375 6c74 2069 6e20 7365 6c66 2e0a  result in self..
-00004ff0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00005000: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
-00005010: 6e6c 656e 0a0a 2020 2020 2020 2020 6e6c  nlen..        nl
-00005020: 656e 203d 2073 7172 7428 612e 782a 612e  en = sqrt(a.x*a.
-00005030: 7820 2b20 612e 792a 612e 7920 2b20 612e  x + a.y*a.y + a.
-00005040: 7a2a 612e 7a29 0a20 2020 2020 2020 2069  z*a.z).        i
-00005050: 6620 6e6c 656e 3c3d 6570 733a 0a20 2020  f nlen<=eps:.   
-00005060: 2020 2020 2020 2020 2072 6169 7365 205a           raise Z
-00005070: 6572 6f44 6976 6973 696f 6e45 7272 6f72  eroDivisionError
-00005080: 2c22 6e75 6c6c 2076 6563 746f 7220 6361  ,"null vector ca
-00005090: 6e27 7420 6265 206e 6f72 6d61 6c69 7a65  n't be normalize
-000050a0: 6422 0a20 2020 2020 2020 206e 6c65 6e20  d".        nlen 
-000050b0: 3d20 312e 302f 6e6c 656e 0a20 2020 2020  = 1.0/nlen.     
-000050c0: 2020 2073 656c 662e 7820 3d20 612e 782a     self.x = a.x*
-000050d0: 6e6c 656e 0a20 2020 2020 2020 2073 656c  nlen.        sel
-000050e0: 662e 7920 3d20 612e 792a 6e6c 656e 0a20  f.y = a.y*nlen. 
-000050f0: 2020 2020 2020 2073 656c 662e 7a20 3d20         self.z = 
-00005100: 612e 7a2a 6e6c 656e 0a20 2020 2020 2020  a.z*nlen.       
-00005110: 2072 6574 7572 6e20 7365 6c66 0a0a 2323   return self..##
-00005120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00005130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00005140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00005150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00005160: 2323 2323 0a0a 2320 7665 6334 6974 6572  ####..# vec4iter
-00005170: 0a63 6465 6620 636c 6173 7320 7665 6334  .cdef class vec4
-00005180: 6974 6572 3a0a 2020 2020 2222 2276 6563  iter:.    """vec
-00005190: 3420 6974 6572 6174 6f72 2e22 2222 0a20  4 iterator.""". 
-000051a0: 2020 2063 6465 6620 696e 7420 6964 780a     cdef int idx.
-000051b0: 2020 2020 6364 6566 206f 626a 6563 7420      cdef object 
-000051c0: 760a 0a20 2020 2064 6566 205f 5f63 696e  v..    def __cin
-000051d0: 6974 5f5f 2873 656c 662c 2076 293a 0a20  it__(self, v):. 
-000051e0: 2020 2020 2020 2073 656c 662e 6964 7820         self.idx 
-000051f0: 3d20 300a 2020 2020 2020 2020 7365 6c66  = 0.        self
-00005200: 2e76 2020 203d 2076 0a0a 2020 2020 6465  .v   = v..    de
-00005210: 6620 5f5f 6974 6572 5f5f 2873 656c 6629  f __iter__(self)
-00005220: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00005230: 2073 656c 660a 0a20 2020 2064 6566 205f   self..    def _
-00005240: 5f6e 6578 745f 5f28 7365 6c66 293a 0a20  _next__(self):. 
-00005250: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
-00005260: 6478 3d3d 303a 0a20 2020 2020 2020 2020  dx==0:.         
-00005270: 2020 2073 656c 662e 6964 783d 310a 2020     self.idx=1.  
-00005280: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00005290: 2073 656c 662e 762e 780a 2020 2020 2020   self.v.x.      
-000052a0: 2020 656c 6966 2073 656c 662e 6964 783d    elif self.idx=
-000052b0: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
-000052c0: 7365 6c66 2e69 6478 3d32 0a20 2020 2020  self.idx=2.     
-000052d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000052e0: 6c66 2e76 2e79 0a20 2020 2020 2020 2065  lf.v.y.        e
-000052f0: 6c69 6620 7365 6c66 2e69 6478 3d3d 323a  lif self.idx==2:
-00005300: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005310: 662e 6964 783d 330a 2020 2020 2020 2020  f.idx=3.        
-00005320: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00005330: 762e 7a0a 2020 2020 2020 2020 656c 6966  v.z.        elif
-00005340: 2073 656c 662e 6964 783d 3d33 3a0a 2020   self.idx==3:.  
-00005350: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-00005360: 6478 3d34 0a20 2020 2020 2020 2020 2020  dx=4.           
-00005370: 2072 6574 7572 6e20 7365 6c66 2e76 2e77   return self.v.w
-00005380: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00005390: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000053a0: 2053 746f 7049 7465 7261 7469 6f6e 0a0a   StopIteration..
-000053b0: 2320 7665 6334 0a63 6465 6620 636c 6173  # vec4.cdef clas
-000053c0: 7320 7665 6334 3a0a 2020 2020 2222 2246  s vec4:.    """F
-000053d0: 6f75 722d 6469 6d65 6e73 696f 6e61 6c20  our-dimensional 
-000053e0: 7665 6374 6f72 2e0a 0a20 2020 2054 6869  vector...    Thi
-000053f0: 7320 636c 6173 7320 7265 7072 6573 656e  s class represen
-00005400: 7473 2061 2034 4420 7665 6374 6f72 2e0a  ts a 4D vector..
-00005410: 2020 2020 2222 220a 0a20 2020 2063 6465      """..    cde
-00005420: 6620 646f 7562 6c65 2078 2c79 2c7a 2c77  f double x,y,z,w
-00005430: 0a0a 2020 2020 6465 6620 5f5f 6369 6e69  ..    def __cini
-00005440: 745f 5f28 7365 6c66 2c20 2a61 7267 7329  t__(self, *args)
-00005450: 3a0a 2020 2020 2020 2020 2222 2243 6f6e  :.        """Con
-00005460: 7374 7275 6374 6f72 2e0a 0a20 2020 2020  structor...     
-00005470: 2020 2054 6865 7265 2061 7265 2073 6576     There are sev
-00005480: 6572 616c 2070 6f73 7369 6269 6c69 7469  eral possibiliti
-00005490: 6573 2068 6f77 2074 6f20 696e 6974 6961  es how to initia
-000054a0: 6c69 7a65 2061 2076 6563 746f 723a 0a0a  lize a vector:..
-000054b0: 2020 2020 2020 2020 7620 3d20 7665 6334          v = vec4
-000054c0: 2829 2020 2020 2020 2020 2d3e 2076 203d  ()        -> v =
-000054d0: 203c 302c 302c 302c 303e 0a20 2020 2020   <0,0,0,0>.     
-000054e0: 2020 2076 203d 2076 6563 3428 6129 2020     v = vec4(a)  
-000054f0: 2020 2020 202d 3e20 7620 3d20 3c61 2c61       -> v = <a,a
-00005500: 2c61 2c61 3e0a 2020 2020 2020 2020 7620  ,a,a>.        v 
-00005510: 3d20 7665 6334 2878 2c79 2920 2020 2020  = vec4(x,y)     
-00005520: 2d3e 2076 203d 203c 782c 792c 302c 303e  -> v = <x,y,0,0>
-00005530: 0a20 2020 2020 2020 2076 203d 2076 6563  .        v = vec
-00005540: 3428 782c 792c 7a29 2020 202d 3e20 7620  4(x,y,z)   -> v 
-00005550: 3d20 3c78 2c79 2c7a 2c30 3e0a 2020 2020  = <x,y,z,0>.    
-00005560: 2020 2020 7620 3d20 7665 6334 2878 2c79      v = vec4(x,y
-00005570: 2c7a 2c77 2920 2d3e 2076 203d 203c 782c  ,z,w) -> v = <x,
-00005580: 792c 7a2c 773e 0a0a 2020 2020 2020 2020  y,z,w>..        
-00005590: 4e6f 7465 2074 6861 7420 7370 6563 6966  Note that specif
-000055a0: 7969 6e67 206a 7573 7420 6f6e 6520 7661  ying just one va
-000055b0: 6c75 6520 7365 7473 2061 6c6c 2066 6f75  lue sets all fou
-000055c0: 7220 636f 6d70 6f6e 656e 7473 2074 6f0a  r components to.
-000055d0: 2020 2020 2020 2020 7468 6174 2076 616c          that val
-000055e0: 7565 2e0a 0a20 2020 2020 2020 2041 6464  ue...        Add
-000055f0: 6974 696f 6e61 6c6c 7920 796f 7520 6361  itionally you ca
-00005600: 6e20 7772 6170 2074 686f 7365 2076 616c  n wrap those val
-00005610: 7565 7320 696e 2061 206c 6973 7420 6f72  ues in a list or
-00005620: 2061 2074 7570 6c65 206f 720a 2020 2020   a tuple or.    
-00005630: 2020 2020 7370 6563 6966 7920 7468 656d      specify them
-00005640: 2061 7320 6120 7374 7269 6e67 3a0a 0a20   as a string:.. 
-00005650: 2020 2020 2020 2076 203d 2076 6563 3428         v = vec4(
-00005660: 5b31 2c32 2c33 5d29 202d 3e20 7620 3d20  [1,2,3]) -> v = 
-00005670: 3c31 2c32 2c33 2c30 3e0a 2020 2020 2020  <1,2,3,0>.      
-00005680: 2020 7620 3d20 7665 6334 2822 342c 3522    v = vec4("4,5"
-00005690: 2920 2020 2d3e 2076 203d 203c 342c 352c  )   -> v = <4,5,
-000056a0: 302c 303e 0a20 2020 2020 2020 2022 2222  0,0>.        """
-000056b0: 0a0a 2020 2020 2020 2020 6364 6566 2069  ..        cdef i
-000056c0: 6e74 2061 7267 6c65 6e2c 2073 6571 6c65  nt arglen, seqle
-000056d0: 6e0a 2020 2020 2020 2020 6364 6566 2076  n.        cdef v
-000056e0: 6563 3420 760a 2020 2020 2020 2020 6172  ec4 v.        ar
-000056f0: 676c 656e 203d 206c 656e 2861 7267 7329  glen = len(args)
-00005700: 0a0a 2020 2020 2020 2020 6966 2061 7267  ..        if arg
-00005710: 6c65 6e3d 3d30 3a0a 2020 2020 2020 2020  len==0:.        
-00005720: 2020 2020 7365 6c66 2e78 203d 2030 2e30      self.x = 0.0
-00005730: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005740: 662e 7920 3d20 302e 300a 2020 2020 2020  f.y = 0.0.      
-00005750: 2020 2020 2020 7365 6c66 2e7a 203d 2030        self.z = 0
-00005760: 2e30 0a20 2020 2020 2020 2020 2020 2073  .0.            s
-00005770: 656c 662e 7720 3d20 302e 300a 2020 2020  elf.w = 0.0.    
-00005780: 2020 2020 656c 6966 2061 7267 6c65 6e3d      elif arglen=
-00005790: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
-000057a0: 5420 3d20 7479 7065 2861 7267 735b 305d  T = type(args[0]
-000057b0: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-000057c0: 7363 616c 6172 0a20 2020 2020 2020 2020  scalar.         
-000057d0: 2020 2069 6620 5420 6973 2066 6c6f 6174     if T is float
-000057e0: 206f 7220 5420 6973 2069 6e74 206f 7220   or T is int or 
-000057f0: 5420 6973 206c 6f6e 673a 0a20 2020 2020  T is long:.     
-00005800: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005810: 7820 3d20 6172 6773 5b30 5d0a 2020 2020  x = args[0].    
-00005820: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00005830: 2e79 203d 2073 656c 662e 780a 2020 2020  .y = self.x.    
-00005840: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00005850: 2e7a 203d 2073 656c 662e 780a 2020 2020  .z = self.x.    
-00005860: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00005870: 2e77 203d 2073 656c 662e 780a 2020 2020  .w = self.x.    
-00005880: 2020 2020 2020 2020 2320 7665 6334 0a20          # vec4. 
-00005890: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-000058a0: 5420 6973 2076 6563 343a 0a20 2020 2020  T is vec4:.     
-000058b0: 2020 2020 2020 2020 2020 2076 203d 2061             v = a
-000058c0: 7267 735b 305d 0a20 2020 2020 2020 2020  rgs[0].         
-000058d0: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
-000058e0: 762e 780a 2020 2020 2020 2020 2020 2020  v.x.            
-000058f0: 2020 2020 7365 6c66 2e79 203d 2076 2e79      self.y = v.y
-00005900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005910: 2073 656c 662e 7a20 3d20 762e 7a0a 2020   self.z = v.z.  
-00005920: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00005930: 6c66 2e77 203d 2076 2e77 0a20 2020 2020  lf.w = v.w.     
-00005940: 2020 2020 2020 2023 2053 7472 696e 670a         # String.
-00005950: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00005960: 2054 2069 7320 7374 7220 6f72 2054 2069   T is str or T i
-00005970: 7320 756e 6963 6f64 653a 0a20 2020 2020  s unicode:.     
-00005980: 2020 2020 2020 2020 2020 2073 3d61 7267             s=arg
-00005990: 735b 305d 2e72 6570 6c61 6365 2822 2c22  s[0].replace(","
-000059a0: 2c22 2022 292e 7265 706c 6163 6528 2220  ," ").replace(" 
-000059b0: 2022 2c22 2022 292e 7374 7269 7028 292e   "," ").strip().
-000059c0: 7370 6c69 7428 2220 2229 0a20 2020 2020  split(" ").     
-000059d0: 2020 2020 2020 2020 2020 2069 6620 733d             if s=
-000059e0: 3d5b 2222 5d3a 0a20 2020 2020 2020 2020  =[""]:.         
-000059f0: 2020 2020 2020 2020 2020 2073 3d5b 5d0a             s=[].
-00005a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005a10: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
-00005a20: 656e 2873 2929 3a0a 2020 2020 2020 2020  en(s)):.        
-00005a30: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-00005a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005a50: 2020 2020 2020 2020 2073 5b69 5d20 3d20           s[i] = 
-00005a60: 666c 6f61 7428 735b 695d 290a 2020 2020  float(s[i]).    
-00005a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005a80: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
-00005a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005aa0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00005ab0: 2c22 7665 6334 2829 2061 7267 2069 7320  ,"vec4() arg is 
-00005ac0: 6120 6d61 6c66 6f72 6d65 6420 7374 7269  a malformed stri
-00005ad0: 6e67 220a 2020 2020 2020 2020 2020 2020  ng".            
-00005ae0: 2020 2020 7620 3d20 7665 6334 2873 290a      v = vec4(s).
-00005af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b00: 7365 6c66 2e78 203d 2076 2e78 0a20 2020  self.x = v.x.   
-00005b10: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00005b20: 662e 7920 3d20 762e 790a 2020 2020 2020  f.y = v.y.      
-00005b30: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
-00005b40: 203d 2076 2e7a 0a20 2020 2020 2020 2020   = v.z.         
-00005b50: 2020 2020 2020 2073 656c 662e 7720 3d20         self.w = 
-00005b60: 762e 770a 2020 2020 2020 2020 2020 2020  v.w.            
-00005b70: 2320 5365 7175 656e 6365 206f 6620 666c  # Sequence of fl
-00005b80: 6f61 7473 0a20 2020 2020 2020 2020 2020  oats.           
-00005b90: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00005ba0: 2020 2020 2020 2073 6571 203d 2061 7267         seq = arg
-00005bb0: 735b 305d 0a20 2020 2020 2020 2020 2020  s[0].           
-00005bc0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-00005bd0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00005be0: 716c 656e 203d 206c 656e 2873 6571 290a  qlen = len(seq).
+00004ed0: 2072 6573 2e7a 203d 2073 656c 662e 780a   res.z = self.x.
+00004ee0: 2020 2020 2020 2020 2320 7820 6973 2073          # x is s
+00004ef0: 6d61 6c6c 6573 740a 2020 2020 2020 2020  mallest.        
+00004f00: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00004f10: 2020 7265 732e 7820 3d20 302e 300a 2020    res.x = 0.0.  
+00004f20: 2020 2020 2020 2020 2020 7265 732e 7920            res.y 
+00004f30: 3d20 2d73 656c 662e 7a0a 2020 2020 2020  = -self.z.      
+00004f40: 2020 2020 2020 7265 732e 7a20 3d20 7365        res.z = se
+00004f50: 6c66 2e79 0a0a 2020 2020 2020 2020 7265  lf.y..        re
+00004f60: 7475 726e 2072 6573 0a0a 0a20 2020 2064  turn res...    d
+00004f70: 6566 2066 6164 6428 7365 6c66 2c20 7665  ef fadd(self, ve
+00004f80: 6333 2061 2c20 7665 6333 2062 293a 0a20  c3 a, vec3 b):. 
+00004f90: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
+00004fa0: 612e 782b 622e 780a 2020 2020 2020 2020  a.x+b.x.        
+00004fb0: 7365 6c66 2e79 203d 2061 2e79 2b62 2e79  self.y = a.y+b.y
+00004fc0: 0a20 2020 2020 2020 2073 656c 662e 7a20  .        self.z 
+00004fd0: 3d20 612e 7a2b 622e 7a0a 2020 2020 2020  = a.z+b.z.      
+00004fe0: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
+00004ff0: 2020 2064 6566 2066 6e6f 726d 616c 697a     def fnormaliz
+00005000: 6528 7365 6c66 2c20 7665 6333 2061 293a  e(self, vec3 a):
+00005010: 0a20 2020 2020 2020 2022 2222 4e6f 726d  .        """Norm
+00005020: 616c 697a 6520 7665 6374 6f72 2061 2061  alize vector a a
+00005030: 6e64 2073 746f 7265 2072 6573 756c 7420  nd store result 
+00005040: 696e 2073 656c 662e 0a20 2020 2020 2020  in self..       
+00005050: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00005060: 6620 646f 7562 6c65 206e 6c65 6e0a 0a20  f double nlen.. 
+00005070: 2020 2020 2020 206e 6c65 6e20 3d20 7371         nlen = sq
+00005080: 7274 2861 2e78 2a61 2e78 202b 2061 2e79  rt(a.x*a.x + a.y
+00005090: 2a61 2e79 202b 2061 2e7a 2a61 2e7a 290a  *a.y + a.z*a.z).
+000050a0: 2020 2020 2020 2020 6966 206e 6c65 6e3c          if nlen<
+000050b0: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
+000050c0: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
+000050d0: 7369 6f6e 4572 726f 722c 226e 756c 6c20  sionError,"null 
+000050e0: 7665 6374 6f72 2063 616e 2774 2062 6520  vector can't be 
+000050f0: 6e6f 726d 616c 697a 6564 220a 2020 2020  normalized".    
+00005100: 2020 2020 6e6c 656e 203d 2031 2e30 2f6e      nlen = 1.0/n
+00005110: 6c65 6e0a 2020 2020 2020 2020 7365 6c66  len.        self
+00005120: 2e78 203d 2061 2e78 2a6e 6c65 6e0a 2020  .x = a.x*nlen.  
+00005130: 2020 2020 2020 7365 6c66 2e79 203d 2061        self.y = a
+00005140: 2e79 2a6e 6c65 6e0a 2020 2020 2020 2020  .y*nlen.        
+00005150: 7365 6c66 2e7a 203d 2061 2e7a 2a6e 6c65  self.z = a.z*nle
+00005160: 6e0a 2020 2020 2020 2020 7265 7475 726e  n.        return
+00005170: 2073 656c 660a 0a23 2323 2323 2323 2323   self..#########
+00005180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00005190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000051a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000051b0: 2323 2323 2323 2323 2323 2323 230a 0a23  #############..#
+000051c0: 2076 6563 3469 7465 720a 6364 6566 2063   vec4iter.cdef c
+000051d0: 6c61 7373 2076 6563 3469 7465 723a 0a20  lass vec4iter:. 
+000051e0: 2020 2022 2222 7665 6334 2069 7465 7261     """vec4 itera
+000051f0: 746f 722e 2222 220a 2020 2020 6364 6566  tor.""".    cdef
+00005200: 2069 6e74 2069 6478 0a20 2020 2063 6465   int idx.    cde
+00005210: 6620 6f62 6a65 6374 2076 0a0a 2020 2020  f object v..    
+00005220: 6465 6620 5f5f 6369 6e69 745f 5f28 7365  def __cinit__(se
+00005230: 6c66 2c20 7629 3a0a 2020 2020 2020 2020  lf, v):.        
+00005240: 7365 6c66 2e69 6478 203d 2030 0a20 2020  self.idx = 0.   
+00005250: 2020 2020 2073 656c 662e 7620 2020 3d20       self.v   = 
+00005260: 760a 0a20 2020 2064 6566 205f 5f69 7465  v..    def __ite
+00005270: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
+00005280: 2020 2072 6574 7572 6e20 7365 6c66 0a0a     return self..
+00005290: 2020 2020 6465 6620 5f5f 6e65 7874 5f5f      def __next__
+000052a0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000052b0: 6966 2073 656c 662e 6964 783d 3d30 3a0a  if self.idx==0:.
+000052c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000052d0: 2e69 6478 3d31 0a20 2020 2020 2020 2020  .idx=1.         
+000052e0: 2020 2072 6574 7572 6e20 7365 6c66 2e76     return self.v
+000052f0: 2e78 0a20 2020 2020 2020 2065 6c69 6620  .x.        elif 
+00005300: 7365 6c66 2e69 6478 3d3d 313a 0a20 2020  self.idx==1:.   
+00005310: 2020 2020 2020 2020 2073 656c 662e 6964           self.id
+00005320: 783d 320a 2020 2020 2020 2020 2020 2020  x=2.            
+00005330: 7265 7475 726e 2073 656c 662e 762e 790a  return self.v.y.
+00005340: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
+00005350: 662e 6964 783d 3d32 3a0a 2020 2020 2020  f.idx==2:.      
+00005360: 2020 2020 2020 7365 6c66 2e69 6478 3d33        self.idx=3
+00005370: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00005380: 7572 6e20 7365 6c66 2e76 2e7a 0a20 2020  urn self.v.z.   
+00005390: 2020 2020 2065 6c69 6620 7365 6c66 2e69       elif self.i
+000053a0: 6478 3d3d 333a 0a20 2020 2020 2020 2020  dx==3:.         
+000053b0: 2020 2073 656c 662e 6964 783d 340a 2020     self.idx=4.  
+000053c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000053d0: 2073 656c 662e 762e 770a 2020 2020 2020   self.v.w.      
+000053e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000053f0: 2020 2020 7261 6973 6520 5374 6f70 4974      raise StopIt
+00005400: 6572 6174 696f 6e0a 0a23 2076 6563 340a  eration..# vec4.
+00005410: 6364 6566 2063 6c61 7373 2076 6563 343a  cdef class vec4:
+00005420: 0a20 2020 2022 2222 466f 7572 2d64 696d  .    """Four-dim
+00005430: 656e 7369 6f6e 616c 2076 6563 746f 722e  ensional vector.
+00005440: 0a0a 2020 2020 5468 6973 2063 6c61 7373  ..    This class
+00005450: 2072 6570 7265 7365 6e74 7320 6120 3444   represents a 4D
+00005460: 2076 6563 746f 722e 0a20 2020 2022 2222   vector..    """
+00005470: 0a0a 2020 2020 6364 6566 2064 6f75 626c  ..    cdef doubl
+00005480: 6520 782c 792c 7a2c 770a 0a20 2020 2064  e x,y,z,w..    d
+00005490: 6566 205f 5f63 696e 6974 5f5f 2873 656c  ef __cinit__(sel
+000054a0: 662c 202a 6172 6773 293a 0a20 2020 2020  f, *args):.     
+000054b0: 2020 2022 2222 436f 6e73 7472 7563 746f     """Constructo
+000054c0: 722e 0a0a 2020 2020 2020 2020 5468 6572  r...        Ther
+000054d0: 6520 6172 6520 7365 7665 7261 6c20 706f  e are several po
+000054e0: 7373 6962 696c 6974 6965 7320 686f 7720  ssibilities how 
+000054f0: 746f 2069 6e69 7469 616c 697a 6520 6120  to initialize a 
+00005500: 7665 6374 6f72 3a0a 0a20 2020 2020 2020  vector:..       
+00005510: 2076 203d 2076 6563 3428 2920 2020 2020   v = vec4()     
+00005520: 2020 202d 3e20 7620 3d20 3c30 2c30 2c30     -> v = <0,0,0
+00005530: 2c30 3e0a 2020 2020 2020 2020 7620 3d20  ,0>.        v = 
+00005540: 7665 6334 2861 2920 2020 2020 2020 2d3e  vec4(a)       ->
+00005550: 2076 203d 203c 612c 612c 612c 613e 0a20   v = <a,a,a,a>. 
+00005560: 2020 2020 2020 2076 203d 2076 6563 3428         v = vec4(
+00005570: 782c 7929 2020 2020 202d 3e20 7620 3d20  x,y)     -> v = 
+00005580: 3c78 2c79 2c30 2c30 3e0a 2020 2020 2020  <x,y,0,0>.      
+00005590: 2020 7620 3d20 7665 6334 2878 2c79 2c7a    v = vec4(x,y,z
+000055a0: 2920 2020 2d3e 2076 203d 203c 782c 792c  )   -> v = <x,y,
+000055b0: 7a2c 303e 0a20 2020 2020 2020 2076 203d  z,0>.        v =
+000055c0: 2076 6563 3428 782c 792c 7a2c 7729 202d   vec4(x,y,z,w) -
+000055d0: 3e20 7620 3d20 3c78 2c79 2c7a 2c77 3e0a  > v = <x,y,z,w>.
+000055e0: 0a20 2020 2020 2020 204e 6f74 6520 7468  .        Note th
+000055f0: 6174 2073 7065 6369 6679 696e 6720 6a75  at specifying ju
+00005600: 7374 206f 6e65 2076 616c 7565 2073 6574  st one value set
+00005610: 7320 616c 6c20 666f 7572 2063 6f6d 706f  s all four compo
+00005620: 6e65 6e74 7320 746f 0a20 2020 2020 2020  nents to.       
+00005630: 2074 6861 7420 7661 6c75 652e 0a0a 2020   that value...  
+00005640: 2020 2020 2020 4164 6469 7469 6f6e 616c        Additional
+00005650: 6c79 2079 6f75 2063 616e 2077 7261 7020  ly you can wrap 
+00005660: 7468 6f73 6520 7661 6c75 6573 2069 6e20  those values in 
+00005670: 6120 6c69 7374 206f 7220 6120 7475 706c  a list or a tupl
+00005680: 6520 6f72 0a20 2020 2020 2020 2073 7065  e or.        spe
+00005690: 6369 6679 2074 6865 6d20 6173 2061 2073  cify them as a s
+000056a0: 7472 696e 673a 0a0a 2020 2020 2020 2020  tring:..        
+000056b0: 7620 3d20 7665 6334 285b 312c 322c 335d  v = vec4([1,2,3]
+000056c0: 2920 2d3e 2076 203d 203c 312c 322c 332c  ) -> v = <1,2,3,
+000056d0: 303e 0a20 2020 2020 2020 2076 203d 2076  0>.        v = v
+000056e0: 6563 3428 2234 2c35 2229 2020 202d 3e20  ec4("4,5")   -> 
+000056f0: 7620 3d20 3c34 2c35 2c30 2c30 3e0a 2020  v = <4,5,0,0>.  
+00005700: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+00005710: 2020 2063 6465 6620 696e 7420 6172 676c     cdef int argl
+00005720: 656e 2c20 7365 716c 656e 0a20 2020 2020  en, seqlen.     
+00005730: 2020 2063 6465 6620 7665 6334 2076 0a20     cdef vec4 v. 
+00005740: 2020 2020 2020 2061 7267 6c65 6e20 3d20         arglen = 
+00005750: 6c65 6e28 6172 6773 290a 0a20 2020 2020  len(args)..     
+00005760: 2020 2069 6620 6172 676c 656e 3d3d 303a     if arglen==0:
+00005770: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00005780: 662e 7820 3d20 302e 300a 2020 2020 2020  f.x = 0.0.      
+00005790: 2020 2020 2020 7365 6c66 2e79 203d 2030        self.y = 0
+000057a0: 2e30 0a20 2020 2020 2020 2020 2020 2073  .0.            s
+000057b0: 656c 662e 7a20 3d20 302e 300a 2020 2020  elf.z = 0.0.    
+000057c0: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
+000057d0: 2030 2e30 0a20 2020 2020 2020 2065 6c69   0.0.        eli
+000057e0: 6620 6172 676c 656e 3d3d 313a 0a20 2020  f arglen==1:.   
+000057f0: 2020 2020 2020 2020 2054 203d 2074 7970           T = typ
+00005800: 6528 6172 6773 5b30 5d29 0a20 2020 2020  e(args[0]).     
+00005810: 2020 2020 2020 2023 2073 6361 6c61 720a         # scalar.
+00005820: 2020 2020 2020 2020 2020 2020 6966 2054              if T
+00005830: 2069 7320 666c 6f61 7420 6f72 2054 2069   is float or T i
+00005840: 7320 696e 7420 6f72 2054 2069 7320 6c6f  s int or T is lo
+00005850: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+00005860: 2020 2020 7365 6c66 2e78 203d 2061 7267      self.x = arg
+00005870: 735b 305d 0a20 2020 2020 2020 2020 2020  s[0].           
+00005880: 2020 2020 2073 656c 662e 7920 3d20 7365       self.y = se
+00005890: 6c66 2e78 0a20 2020 2020 2020 2020 2020  lf.x.           
+000058a0: 2020 2020 2073 656c 662e 7a20 3d20 7365       self.z = se
+000058b0: 6c66 2e78 0a20 2020 2020 2020 2020 2020  lf.x.           
+000058c0: 2020 2020 2073 656c 662e 7720 3d20 7365       self.w = se
+000058d0: 6c66 2e78 0a20 2020 2020 2020 2020 2020  lf.x.           
+000058e0: 2023 2076 6563 340a 2020 2020 2020 2020   # vec4.        
+000058f0: 2020 2020 656c 6966 2054 2069 7320 7665      elif T is ve
+00005900: 6334 3a0a 2020 2020 2020 2020 2020 2020  c4:.            
+00005910: 2020 2020 7620 3d20 6172 6773 5b30 5d0a      v = args[0].
+00005920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005930: 7365 6c66 2e78 203d 2076 2e78 0a20 2020  self.x = v.x.   
+00005940: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00005950: 662e 7920 3d20 762e 790a 2020 2020 2020  f.y = v.y.      
+00005960: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
+00005970: 203d 2076 2e7a 0a20 2020 2020 2020 2020   = v.z.         
+00005980: 2020 2020 2020 2073 656c 662e 7720 3d20         self.w = 
+00005990: 762e 770a 2020 2020 2020 2020 2020 2020  v.w.            
+000059a0: 2320 5374 7269 6e67 0a20 2020 2020 2020  # String.       
+000059b0: 2020 2020 2065 6c69 6620 5420 6973 2073       elif T is s
+000059c0: 7472 206f 7220 5420 6973 2075 6e69 636f  tr or T is unico
+000059d0: 6465 3a0a 2020 2020 2020 2020 2020 2020  de:.            
+000059e0: 2020 2020 733d 6172 6773 5b30 5d2e 7265      s=args[0].re
+000059f0: 706c 6163 6528 222c 222c 2220 2229 2e72  place(","," ").r
+00005a00: 6570 6c61 6365 2822 2020 222c 2220 2229  eplace("  "," ")
+00005a10: 2e73 7472 6970 2829 2e73 706c 6974 2822  .strip().split("
+00005a20: 2022 290a 2020 2020 2020 2020 2020 2020   ").            
+00005a30: 2020 2020 6966 2073 3d3d 5b22 225d 3a0a      if s==[""]:.
+00005a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005a50: 2020 2020 733d 5b5d 0a20 2020 2020 2020      s=[].       
+00005a60: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+00005a70: 6e20 7261 6e67 6528 6c65 6e28 7329 293a  n range(len(s)):
+00005a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005a90: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00005aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ab0: 2020 735b 695d 203d 2066 6c6f 6174 2873    s[i] = float(s
+00005ac0: 5b69 5d29 0a20 2020 2020 2020 2020 2020  [i]).           
+00005ad0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+00005ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005af0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00005b00: 616c 7565 4572 726f 722c 2276 6563 3428  alueError,"vec4(
+00005b10: 2920 6172 6720 6973 2061 206d 616c 666f  ) arg is a malfo
+00005b20: 726d 6564 2073 7472 696e 6722 0a20 2020  rmed string".   
+00005b30: 2020 2020 2020 2020 2020 2020 2076 203d               v =
+00005b40: 2076 6563 3428 7329 0a20 2020 2020 2020   vec4(s).       
+00005b50: 2020 2020 2020 2020 2073 656c 662e 7820           self.x 
+00005b60: 3d20 762e 780a 2020 2020 2020 2020 2020  = v.x.          
+00005b70: 2020 2020 2020 7365 6c66 2e79 203d 2076        self.y = v
+00005b80: 2e79 0a20 2020 2020 2020 2020 2020 2020  .y.             
+00005b90: 2020 2073 656c 662e 7a20 3d20 762e 7a0a     self.z = v.z.
+00005ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005bb0: 7365 6c66 2e77 203d 2076 2e77 0a20 2020  self.w = v.w.   
+00005bc0: 2020 2020 2020 2020 2023 2053 6571 7565           # Seque
+00005bd0: 6e63 6520 6f66 2066 6c6f 6174 730a 2020  nce of floats.  
+00005be0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
 00005bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c00: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
-00005c10: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00005c20: 6520 5479 7065 4572 726f 722c 2276 6563  e TypeError,"vec
-00005c30: 3428 2920 6172 6720 6361 6e27 7420 6265  4() arg can't be
-00005c40: 2063 6f6e 7665 7274 6564 2074 6f20 7665   converted to ve
-00005c50: 6334 220a 0a20 2020 2020 2020 2020 2020  c4"..           
-00005c60: 2020 2020 2069 6620 7365 716c 656e 3d3d       if seqlen==
-00005c70: 343a 0a20 2020 2020 2020 2020 2020 2020  4:.             
-00005c80: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
-00005c90: 7365 715b 305d 0a20 2020 2020 2020 2020  seq[0].         
-00005ca0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005cb0: 7920 3d20 7365 715b 315d 0a20 2020 2020  y = seq[1].     
-00005cc0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00005cd0: 656c 662e 7a20 3d20 7365 715b 325d 0a20  elf.z = seq[2]. 
-00005ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005cf0: 2020 2073 656c 662e 7720 3d20 7365 715b     self.w = seq[
-00005d00: 335d 0a20 2020 2020 2020 2020 2020 2020  3].             
-00005d10: 2020 2065 6c69 6620 7365 716c 656e 3d3d     elif seqlen==
-00005d20: 333a 0a20 2020 2020 2020 2020 2020 2020  3:.             
-00005d30: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
-00005d40: 7365 715b 305d 0a20 2020 2020 2020 2020  seq[0].         
-00005d50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005d60: 7920 3d20 7365 715b 315d 0a20 2020 2020  y = seq[1].     
-00005d70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00005d80: 656c 662e 7a20 3d20 7365 715b 325d 0a20  elf.z = seq[2]. 
-00005d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005da0: 2020 2073 656c 662e 7720 3d20 302e 300a     self.w = 0.0.
-00005db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005dc0: 656c 6966 2073 6571 6c65 6e3d 3d32 3a0a  elif seqlen==2:.
-00005dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005de0: 2020 2020 7365 6c66 2e78 203d 2073 6571      self.x = seq
-00005df0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-00005e00: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
-00005e10: 2073 6571 5b31 5d0a 2020 2020 2020 2020   seq[1].        
-00005e20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00005e30: 2e7a 203d 2030 2e30 0a20 2020 2020 2020  .z = 0.0.       
-00005e40: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00005e50: 662e 7720 3d20 302e 300a 2020 2020 2020  f.w = 0.0.      
-00005e60: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-00005e70: 6571 6c65 6e3d 3d31 3a0a 2020 2020 2020  eqlen==1:.      
-00005e80: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00005e90: 6c66 2e78 203d 2073 6571 5b30 5d0a 2020  lf.x = seq[0].  
-00005ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005eb0: 2020 7365 6c66 2e79 203d 2073 656c 662e    self.y = self.
-00005ec0: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
-00005ed0: 2020 2020 2020 7365 6c66 2e7a 203d 2073        self.z = s
-00005ee0: 656c 662e 780a 2020 2020 2020 2020 2020  elf.x.          
-00005ef0: 2020 2020 2020 2020 2020 7365 6c66 2e77            self.w
-00005f00: 203d 2073 656c 662e 780a 2020 2020 2020   = self.x.      
-00005f10: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-00005f20: 6571 6c65 6e3d 3d30 3a0a 2020 2020 2020  eqlen==0:.      
-00005f30: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00005f40: 6c66 2e78 203d 2030 2e30 0a20 2020 2020  lf.x = 0.0.     
-00005f50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00005f60: 656c 662e 7920 3d20 302e 300a 2020 2020  elf.y = 0.0.    
-00005f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f80: 7365 6c66 2e7a 203d 2030 2e30 0a20 2020  self.z = 0.0.   
-00005f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005fa0: 2073 656c 662e 7720 3d20 302e 300a 2020   self.w = 0.0.  
-00005fb0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00005fc0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00005fd0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00005fe0: 7065 4572 726f 722c 2022 7665 6334 2829  peError, "vec4()
-00005ff0: 2074 616b 6573 2061 7420 6d6f 7374 2034   takes at most 4
-00006000: 2061 7267 756d 656e 7473 220a 0a20 2020   arguments"..   
-00006010: 2020 2020 2065 6c69 6620 6172 676c 656e       elif arglen
-00006020: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
-00006030: 2073 656c 662e 7820 3d20 6172 6773 5b30   self.x = args[0
-00006040: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-00006050: 6c66 2e79 203d 2061 7267 735b 315d 0a20  lf.y = args[1]. 
-00006060: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00006070: 7a20 3d20 302e 300a 2020 2020 2020 2020  z = 0.0.        
-00006080: 2020 2020 7365 6c66 2e77 203d 2030 2e30      self.w = 0.0
-00006090: 0a0a 2020 2020 2020 2020 656c 6966 2061  ..        elif a
-000060a0: 7267 6c65 6e3d 3d33 3a0a 2020 2020 2020  rglen==3:.      
-000060b0: 2020 2020 2020 7365 6c66 2e78 203d 2061        self.x = a
-000060c0: 7267 735b 305d 0a20 2020 2020 2020 2020  rgs[0].         
-000060d0: 2020 2073 656c 662e 7920 3d20 6172 6773     self.y = args
-000060e0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-000060f0: 7365 6c66 2e7a 203d 2061 7267 735b 325d  self.z = args[2]
-00006100: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00006110: 662e 7720 3d20 302e 300a 0a20 2020 2020  f.w = 0.0..     
-00006120: 2020 2065 6c69 6620 6172 676c 656e 3d3d     elif arglen==
-00006130: 343a 0a20 2020 2020 2020 2020 2020 2073  4:.            s
-00006140: 656c 662e 7820 3d20 6172 6773 5b30 5d0a  elf.x = args[0].
-00006150: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00006160: 2e79 203d 2061 7267 735b 315d 0a20 2020  .y = args[1].   
-00006170: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
-00006180: 3d20 6172 6773 5b32 5d0a 2020 2020 2020  = args[2].      
-00006190: 2020 2020 2020 7365 6c66 2e77 203d 2061        self.w = a
-000061a0: 7267 735b 335d 0a0a 2020 2020 2020 2020  rgs[3]..        
-000061b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000061c0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-000061d0: 722c 2022 7665 6334 2829 2074 616b 6573  r, "vec4() takes
-000061e0: 2061 7420 6d6f 7374 2034 2061 7267 756d   at most 4 argum
-000061f0: 656e 7473 220a 0a20 2020 2064 6566 205f  ents"..    def _
-00006200: 5f72 6564 7563 655f 5f28 7365 6c66 293a  _reduce__(self):
-00006210: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00006220: 285f 7665 6334 636f 6e73 7472 7563 742c  (_vec4construct,
-00006230: 2028 7365 6c66 2e78 2c20 7365 6c66 2e79   (self.x, self.y
-00006240: 2c20 7365 6c66 2e7a 2c20 7365 6c66 2e77  , self.z, self.w
-00006250: 2929 0a0a 2020 2020 6465 6620 5f5f 7265  ))..    def __re
-00006260: 7072 5f5f 2873 656c 6629 3a0a 2020 2020  pr__(self):.    
-00006270: 2020 2020 7265 7475 726e 2027 7665 6334      return 'vec4
-00006280: 2825 732c 2025 732c 2025 732c 2025 7329  (%s, %s, %s, %s)
-00006290: 2725 2872 6570 7228 7365 6c66 2e78 292c  '%(repr(self.x),
-000062a0: 7265 7072 2873 656c 662e 7929 2c72 6570  repr(self.y),rep
-000062b0: 7228 7365 6c66 2e7a 292c 7265 7072 2873  r(self.z),repr(s
-000062c0: 656c 662e 7729 290a 0a20 2020 2064 6566  elf.w))..    def
-000062d0: 205f 5f73 7472 5f5f 2873 656c 6629 3a0a   __str__(self):.
-000062e0: 2020 2020 2020 2020 7265 7475 726e 2022          return "
-000062f0: 2825 312e 3466 2c20 2531 2e34 662c 2025  (%1.4f, %1.4f, %
-00006300: 312e 3466 2c20 2531 2e34 6629 2225 2873  1.4f, %1.4f)"%(s
-00006310: 656c 662e 782c 2073 656c 662e 792c 2073  elf.x, self.y, s
-00006320: 656c 662e 7a2c 2073 656c 662e 7729 0a0a  elf.z, self.w)..
-00006330: 2020 2020 6465 6620 5f5f 6974 6572 5f5f      def __iter__
-00006340: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00006350: 7265 7475 726e 2076 6563 3469 7465 7228  return vec4iter(
-00006360: 7365 6c66 290a 0a20 2020 2064 6566 205f  self)..    def _
-00006370: 5f72 6963 6863 6d70 5f5f 2861 2c62 2c6f  _richcmp__(a,b,o
-00006380: 7029 3a0a 2020 2020 2020 2020 6364 6566  p):.        cdef
-00006390: 2076 6563 3420 7661 2c20 7662 0a20 2020   vec4 va, vb.   
-000063a0: 2020 2020 2063 6465 6620 696e 7420 636f       cdef int co
-000063b0: 700a 0a20 2020 2020 2020 2063 6f70 203d  p..        cop =
-000063c0: 206f 700a 0a20 2020 2020 2020 2074 6120   op..        ta 
-000063d0: 3d20 7479 7065 2861 290a 2020 2020 2020  = type(a).      
-000063e0: 2020 7462 203d 2074 7970 6528 6229 0a20    tb = type(b). 
-000063f0: 2020 2020 2020 2069 6620 2874 6121 3d76         if (ta!=v
-00006400: 6563 3420 6f72 2074 6221 3d76 6563 3429  ec4 or tb!=vec4)
-00006410: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00006420: 2063 6f70 3d3d 333a 0a20 2020 2020 2020   cop==3:.       
-00006430: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00006440: 310a 2020 2020 2020 2020 2020 2020 656c  1.            el
-00006450: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00006460: 2020 2020 7265 7475 726e 2030 0a0a 2020      return 0..  
-00006470: 2020 2020 2020 7661 203d 2061 0a20 2020        va = a.   
-00006480: 2020 2020 2076 6220 3d20 620a 0a20 2020       vb = b..   
-00006490: 2020 2020 2023 203c 0a20 2020 2020 2020       # <.       
-000064a0: 2069 6620 636f 703d 3d30 3a0a 2020 2020   if cop==0:.    
-000064b0: 2020 2020 2020 2020 7265 7475 726e 2028          return (
-000064c0: 7661 2e78 3c76 622e 7820 616e 6420 7661  va.x<vb.x and va
-000064d0: 2e79 3c76 622e 7920 616e 6420 7661 2e7a  .y<vb.y and va.z
-000064e0: 3c76 622e 7a20 616e 6420 7661 2e77 3c76  <vb.z and va.w<v
-000064f0: 622e 7729 0a20 2020 2020 2020 2023 203c  b.w).        # <
-00006500: 3d0a 2020 2020 2020 2020 656c 6966 2063  =.        elif c
-00006510: 6f70 3d3d 313a 0a20 2020 2020 2020 2020  op==1:.         
-00006520: 2020 2072 6574 7572 6e20 2876 612e 782d     return (va.x-
-00006530: 6570 733c 3d76 622e 7820 616e 6420 7661  eps<=vb.x and va
-00006540: 2e79 2d65 7073 3c3d 7662 2e79 2061 6e64  .y-eps<=vb.y and
-00006550: 2076 612e 7a2d 6570 733c 3d76 622e 7a20   va.z-eps<=vb.z 
-00006560: 616e 6420 7661 2e77 2d65 7073 3c3d 7662  and va.w-eps<=vb
-00006570: 2e77 290a 2020 2020 2020 2020 2320 3d3d  .w).        # ==
-00006580: 0a20 2020 2020 2020 2065 6c69 6620 636f  .        elif co
-00006590: 703d 3d32 3a0a 2020 2020 2020 2020 2020  p==2:.          
-000065a0: 2020 7265 7475 726e 2028 6661 6273 2876    return (fabs(v
-000065b0: 612e 782d 7662 2e78 293c 3d65 7073 2061  a.x-vb.x)<=eps a
-000065c0: 6e64 2066 6162 7328 7661 2e79 2d76 622e  nd fabs(va.y-vb.
-000065d0: 7929 3c3d 6570 7320 616e 6420 6661 6273  y)<=eps and fabs
-000065e0: 2876 612e 7a2d 7662 2e7a 293c 3d65 7073  (va.z-vb.z)<=eps
-000065f0: 2061 6e64 2066 6162 7328 7661 2e77 2d76   and fabs(va.w-v
-00006600: 622e 7729 3c3d 6570 7329 0a20 2020 2020  b.w)<=eps).     
-00006610: 2020 2023 2021 3d0a 2020 2020 2020 2020     # !=.        
-00006620: 656c 6966 2063 6f70 3d3d 333a 0a20 2020  elif cop==3:.   
-00006630: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00006640: 2866 6162 7328 7661 2e78 2d76 622e 7829  (fabs(va.x-vb.x)
-00006650: 3e65 7073 206f 7220 6661 6273 2876 612e  >eps or fabs(va.
-00006660: 792d 7662 2e79 293e 6570 7320 616e 6420  y-vb.y)>eps and 
-00006670: 6661 6273 2876 612e 7a2d 7662 2e7a 293e  fabs(va.z-vb.z)>
-00006680: 6570 7320 616e 6420 6661 6273 2876 612e  eps and fabs(va.
-00006690: 772d 7662 2e77 293e 6570 7329 0a20 2020  w-vb.w)>eps).   
-000066a0: 2020 2020 2023 203e 0a20 2020 2020 2020       # >.       
-000066b0: 2065 6c69 6620 636f 703d 3d34 3a0a 2020   elif cop==4:.  
-000066c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000066d0: 2028 7661 2e78 3e76 622e 7820 616e 6420   (va.x>vb.x and 
-000066e0: 7661 2e79 3e76 622e 7920 616e 6420 7661  va.y>vb.y and va
-000066f0: 2e7a 3e76 622e 7a20 616e 6420 7661 2e77  .z>vb.z and va.w
-00006700: 3e76 622e 7729 0a20 2020 2020 2020 2023  >vb.w).        #
-00006710: 203e 3d0a 2020 2020 2020 2020 656c 6966   >=.        elif
-00006720: 2063 6f70 3d3d 353a 0a20 2020 2020 2020   cop==5:.       
-00006730: 2020 2020 2072 6574 7572 6e20 2876 612e       return (va.
-00006740: 782b 6570 733e 3d76 622e 7820 616e 6420  x+eps>=vb.x and 
-00006750: 7661 2e79 2b65 7073 3e3d 7662 2e79 2061  va.y+eps>=vb.y a
-00006760: 6e64 2076 612e 7a2b 6570 733e 3d76 622e  nd va.z+eps>=vb.
-00006770: 7a20 616e 6420 7661 2e77 2b65 7073 3e3d  z and va.w+eps>=
-00006780: 7662 2e77 290a 2020 2020 2020 2020 2320  vb.w).        # 
-00006790: 736f 6e73 7420 2846 6568 6c65 7229 0a20  sonst (Fehler). 
-000067a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000067b0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-000067c0: 616c 7565 4572 726f 722c 2269 6e74 6572  alueError,"inter
-000067d0: 6e61 6c20 6572 726f 723a 2069 6c6c 6567  nal error: illeg
-000067e0: 616c 2072 6963 6820 636f 6d70 6172 6973  al rich comparis
-000067f0: 6f6e 206e 756d 6265 7222 0a0a 2020 2020  on number"..    
-00006800: 6465 6620 5f5f 6164 645f 5f28 7665 6334  def __add__(vec4
-00006810: 2061 2c20 7665 6334 2062 293a 0a20 2020   a, vec4 b):.   
-00006820: 2020 2020 2022 2222 5665 6374 6f72 2061       """Vector a
-00006830: 6464 6974 696f 6e2e 0a0a 2020 2020 2020  ddition...      
-00006840: 2020 3e3e 3e20 613d 7665 6334 2831 2e30    >>> a=vec4(1.0
-00006850: 2c20 302e 352c 202d 312e 382c 2030 2e32  , 0.5, -1.8, 0.2
-00006860: 290a 2020 2020 2020 2020 3e3e 3e20 623d  ).        >>> b=
-00006870: 7665 6334 282d 302e 332c 2030 2e37 352c  vec4(-0.3, 0.75,
-00006880: 2030 2e35 2c20 302e 3329 0a20 2020 2020   0.5, 0.3).     
-00006890: 2020 203e 3e3e 2070 7269 6e74 2061 2b62     >>> print a+b
-000068a0: 0a20 2020 2020 2020 2028 302e 3730 3030  .        (0.7000
-000068b0: 2c20 312e 3235 3030 2c20 2d31 2e33 3030  , 1.2500, -1.300
-000068c0: 302c 2030 2e35 3030 3029 0a20 2020 2020  0, 0.5000).     
-000068d0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-000068e0: 6465 6620 7665 6334 2072 6573 0a20 2020  def vec4 res.   
-000068f0: 2020 2020 2072 6573 203d 2076 6563 3428       res = vec4(
-00006900: 290a 2020 2020 2020 2020 7265 732e 7820  ).        res.x 
-00006910: 3d20 612e 782b 622e 780a 2020 2020 2020  = a.x+b.x.      
-00006920: 2020 7265 732e 7920 3d20 612e 792b 622e    res.y = a.y+b.
-00006930: 790a 2020 2020 2020 2020 7265 732e 7a20  y.        res.z 
-00006940: 3d20 612e 7a2b 622e 7a0a 2020 2020 2020  = a.z+b.z.      
-00006950: 2020 7265 732e 7720 3d20 612e 772b 622e    res.w = a.w+b.
-00006960: 770a 2020 2020 2020 2020 7265 7475 726e  w.        return
-00006970: 2072 6573 0a0a 2020 2020 6465 6620 5f5f   res..    def __
-00006980: 7375 625f 5f28 7665 6334 2061 2c20 7665  sub__(vec4 a, ve
-00006990: 6334 2062 293a 0a20 2020 2020 2020 2022  c4 b):.        "
-000069a0: 2222 5665 6374 6f72 2073 7562 7472 6163  ""Vector subtrac
-000069b0: 7469 6f6e 2e0a 0a20 2020 2020 2020 203e  tion...        >
-000069c0: 3e3e 2061 3d76 6563 3428 312e 302c 2030  >> a=vec4(1.0, 0
-000069d0: 2e35 2c20 2d31 2e38 2c20 302e 3229 0a20  .5, -1.8, 0.2). 
-000069e0: 2020 2020 2020 203e 3e3e 2062 3d76 6563         >>> b=vec
-000069f0: 3428 2d30 2e33 2c20 302e 3735 2c20 302e  4(-0.3, 0.75, 0.
-00006a00: 352c 2030 2e33 290a 2020 2020 2020 2020  5, 0.3).        
-00006a10: 3e3e 3e20 7072 696e 7420 612d 620a 2020  >>> print a-b.  
-00006a20: 2020 2020 2020 2831 2e33 3030 302c 202d        (1.3000, -
-00006a30: 302e 3235 3030 2c20 2d32 2e33 3030 302c  0.2500, -2.3000,
-00006a40: 202d 302e 3130 3030 290a 2020 2020 2020   -0.1000).      
-00006a50: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
-00006a60: 6566 2076 6563 3420 7265 730a 2020 2020  ef vec4 res.    
-00006a70: 2020 2020 7265 7320 3d20 7665 6334 2829      res = vec4()
-00006a80: 0a20 2020 2020 2020 2072 6573 2e78 203d  .        res.x =
-00006a90: 2061 2e78 2d62 2e78 0a20 2020 2020 2020   a.x-b.x.       
-00006aa0: 2072 6573 2e79 203d 2061 2e79 2d62 2e79   res.y = a.y-b.y
-00006ab0: 0a20 2020 2020 2020 2072 6573 2e7a 203d  .        res.z =
-00006ac0: 2061 2e7a 2d62 2e7a 0a20 2020 2020 2020   a.z-b.z.       
-00006ad0: 2072 6573 2e77 203d 2061 2e77 2d62 2e77   res.w = a.w-b.w
-00006ae0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00006af0: 7265 730a 0a20 2020 2064 6566 205f 5f6d  res..    def __m
-00006b00: 756c 5f5f 2861 2c20 6229 3a0a 2020 2020  ul__(a, b):.    
-00006b10: 2020 2020 2222 224d 756c 7469 706c 6963      """Multiplic
-00006b20: 6174 696f 6e20 7769 7468 2061 2073 6361  ation with a sca
-00006b30: 6c61 7220 6f72 2064 6f74 2070 726f 6475  lar or dot produ
-00006b40: 6374 2e0a 0a20 2020 2020 2020 203e 3e3e  ct...        >>>
-00006b50: 2061 3d76 6563 3428 312e 302c 2030 2e35   a=vec4(1.0, 0.5
-00006b60: 2c20 2d31 2e38 2c20 302e 3229 0a20 2020  , -1.8, 0.2).   
-00006b70: 2020 2020 203e 3e3e 2062 3d76 6563 3428       >>> b=vec4(
-00006b80: 2d30 2e33 2c20 302e 3735 2c20 302e 352c  -0.3, 0.75, 0.5,
-00006b90: 2030 2e33 290a 2020 2020 2020 2020 3e3e   0.3).        >>
-00006ba0: 3e20 7072 696e 7420 612a 322e 300a 2020  > print a*2.0.  
-00006bb0: 2020 2020 2020 2832 2e30 3030 302c 2031        (2.0000, 1
-00006bc0: 2e30 3030 302c 202d 332e 3630 3030 2c20  .0000, -3.6000, 
-00006bd0: 302e 3430 3030 290a 2020 2020 2020 2020  0.4000).        
-00006be0: 3e3e 3e20 7072 696e 7420 322e 302a 610a  >>> print 2.0*a.
-00006bf0: 2020 2020 2020 2020 2832 2e30 3030 302c          (2.0000,
-00006c00: 2031 2e30 3030 302c 202d 332e 3630 3030   1.0000, -3.6000
-00006c10: 2c20 302e 3430 3030 290a 2020 2020 2020  , 0.4000).      
-00006c20: 2020 3e3e 3e20 7072 696e 7420 612a 620a    >>> print a*b.
-00006c30: 2020 2020 2020 2020 2d30 2e37 3635 0a20          -0.765. 
-00006c40: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00006c50: 2020 2020 6364 6566 2076 6563 3420 7265      cdef vec4 re
-00006c60: 732c 2076 612c 2076 620a 2020 2020 2020  s, va, vb.      
-00006c70: 2020 6364 6566 2064 6f75 626c 6520 720a    cdef double r.
-00006c80: 0a20 2020 2020 2020 2074 6120 3d20 7479  .        ta = ty
-00006c90: 7065 2861 290a 2020 2020 2020 2020 7462  pe(a).        tb
-00006ca0: 203d 2074 7970 6528 6229 0a0a 2020 2020   = type(b)..    
-00006cb0: 2020 2020 6966 2074 6120 6973 2076 6563      if ta is vec
-00006cc0: 343a 0a20 2020 2020 2020 2020 2020 2076  4:.            v
-00006cd0: 6120 3d20 610a 2020 2020 2020 2020 2020  a = a.          
-00006ce0: 2020 6966 2074 6220 6973 2076 6563 343a    if tb is vec4:
-00006cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006d00: 2023 2076 6563 342a 7665 6334 2020 2028   # vec4*vec4   (
-00006d10: 646f 7420 7072 6f64 7563 7420 612a 6229  dot product a*b)
-00006d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006d30: 2076 6220 3d20 620a 2020 2020 2020 2020   vb = b.        
-00006d40: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-00006d50: 612e 782a 7662 2e78 202b 2076 612e 792a  a.x*vb.x + va.y*
-00006d60: 7662 2e79 202b 2076 612e 7a2a 7662 2e7a  vb.y + va.z*vb.z
-00006d70: 202b 2076 612e 772a 7662 2e77 0a20 2020   + va.w*vb.w.   
-00006d80: 2020 2020 2020 2020 2065 6c69 6620 7462           elif tb
-00006d90: 2069 7320 666c 6f61 7420 6f72 2074 6220   is float or tb 
-00006da0: 6973 2069 6e74 206f 7220 7462 2069 7320  is int or tb is 
-00006db0: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
-00006dc0: 2020 2020 2020 2320 7665 6334 2a73 6361        # vec4*sca
-00006dd0: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
-00006de0: 2020 2020 7265 7320 3d20 7665 6334 2829      res = vec4()
-00006df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006e00: 2072 2020 203d 2062 0a20 2020 2020 2020   r   = b.       
-00006e10: 2020 2020 2020 2020 2072 6573 2e78 203d           res.x =
-00006e20: 2076 612e 782a 720a 2020 2020 2020 2020   va.x*r.        
-00006e30: 2020 2020 2020 2020 7265 732e 7920 3d20          res.y = 
-00006e40: 7661 2e79 2a72 0a20 2020 2020 2020 2020  va.y*r.         
-00006e50: 2020 2020 2020 2072 6573 2e7a 203d 2076         res.z = v
-00006e60: 612e 7a2a 720a 2020 2020 2020 2020 2020  a.z*r.          
-00006e70: 2020 2020 2020 7265 732e 7720 3d20 7661        res.w = va
-00006e80: 2e77 2a72 0a20 2020 2020 2020 2020 2020  .w*r.           
-00006e90: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-00006ea0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00006eb0: 2074 6220 6973 206d 6174 343a 0a20 2020   tb is mat4:.   
-00006ec0: 2020 2020 2020 2020 2020 2020 2023 2076               # v
-00006ed0: 6563 342a 6d61 7434 0a20 2020 2020 2020  ec4*mat4.       
-00006ee0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00006ef0: 622e 5f5f 726d 756c 5f5f 2861 290a 2020  b.__rmul__(a).  
-00006f00: 2020 2020 2020 656c 6966 2074 6120 6973        elif ta is
-00006f10: 2066 6c6f 6174 206f 7220 7461 2069 7320   float or ta is 
-00006f20: 696e 7420 6f72 2074 6120 6973 206c 6f6e  int or ta is lon
-00006f30: 673a 0a20 2020 2020 2020 2020 2020 2069  g:.            i
-00006f40: 6620 7462 2069 7320 7665 6334 3a0a 2020  f tb is vec4:.  
-00006f50: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00006f60: 7363 616c 6172 2a76 6563 340a 2020 2020  scalar*vec4.    
-00006f70: 2020 2020 2020 2020 2020 2020 7265 7320              res 
-00006f80: 3d20 7665 6334 2829 0a20 2020 2020 2020  = vec4().       
-00006f90: 2020 2020 2020 2020 2076 6220 203d 2062           vb  = b
-00006fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006fb0: 2072 2020 203d 2061 0a20 2020 2020 2020   r   = a.       
-00006fc0: 2020 2020 2020 2020 2072 6573 2e78 203d           res.x =
-00006fd0: 2072 2a76 622e 780a 2020 2020 2020 2020   r*vb.x.        
-00006fe0: 2020 2020 2020 2020 7265 732e 7920 3d20          res.y = 
-00006ff0: 722a 7662 2e79 0a20 2020 2020 2020 2020  r*vb.y.         
-00007000: 2020 2020 2020 2072 6573 2e7a 203d 2072         res.z = r
-00007010: 2a76 622e 7a0a 2020 2020 2020 2020 2020  *vb.z.          
-00007020: 2020 2020 2020 7265 732e 7720 3d20 722a        res.w = r*
-00007030: 7662 2e77 0a20 2020 2020 2020 2020 2020  vb.w.           
-00007040: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-00007050: 0a20 2020 2020 2020 2072 6169 7365 2054  .        raise T
-00007060: 7970 6545 7272 6f72 2c20 2275 6e73 7570  ypeError, "unsup
-00007070: 706f 7274 6564 206f 7065 7261 6e64 2074  ported operand t
-00007080: 7970 6520 666f 7220 2a22 0a0a 2020 2020  ype for *"..    
-00007090: 6465 6620 5f5f 6469 765f 5f28 7665 6334  def __div__(vec4
-000070a0: 2061 2c20 6229 3a0a 2020 2020 2020 2020   a, b):.        
-000070b0: 2222 2244 6976 6973 696f 6e20 6279 2073  """Division by s
-000070c0: 6361 6c61 722e 0a0a 2020 2020 2020 2020  calar...        
-000070d0: 3e3e 3e20 613d 7665 6334 2831 2e30 2c20  >>> a=vec4(1.0, 
-000070e0: 302e 352c 202d 312e 382c 2030 2e32 290a  0.5, -1.8, 0.2).
-000070f0: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00007100: 7420 612f 322e 300a 2020 2020 2020 2020  t a/2.0.        
-00007110: 2830 2e35 3030 302c 2030 2e32 3530 302c  (0.5000, 0.2500,
-00007120: 202d 302e 3930 3030 2c20 302e 3130 3030   -0.9000, 0.1000
-00007130: 290a 2020 2020 2020 2020 2222 220a 0a20  ).        """.. 
-00007140: 2020 2020 2020 2063 6465 6620 7665 6334         cdef vec4
-00007150: 2072 6573 0a20 2020 2020 2020 2063 6465   res.        cde
-00007160: 6620 646f 7562 6c65 2072 0a0a 2020 2020  f double r..    
-00007170: 2020 2020 7462 203d 2074 7970 6528 6229      tb = type(b)
-00007180: 0a0a 2020 2020 2020 2020 6966 2074 6220  ..        if tb 
-00007190: 6973 2066 6c6f 6174 206f 7220 7462 2069  is float or tb i
-000071a0: 7320 696e 7420 6f72 2074 6220 6973 206c  s int or tb is l
-000071b0: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
-000071c0: 2023 2076 6563 342f 7363 616c 6172 0a20   # vec4/scalar. 
-000071d0: 2020 2020 2020 2020 2020 2072 6573 203d             res =
-000071e0: 2076 6563 3428 290a 2020 2020 2020 2020   vec4().        
-000071f0: 2020 2020 7220 3d20 620a 2020 2020 2020      r = b.      
-00007200: 2020 2020 2020 6966 2066 6162 7328 7229        if fabs(r)
-00007210: 3c3d 6570 733a 0a20 2020 2020 2020 2020  <=eps:.         
-00007220: 2020 2020 2020 2072 6169 7365 205a 6572         raise Zer
-00007230: 6f44 6976 6973 696f 6e45 7272 6f72 2c22  oDivisionError,"
-00007240: 7665 6334 2064 6976 6973 696f 6e22 0a20  vec4 division". 
-00007250: 2020 2020 2020 2020 2020 2072 6573 2e78             res.x
-00007260: 203d 2061 2e78 2f72 0a20 2020 2020 2020   = a.x/r.       
-00007270: 2020 2020 2072 6573 2e79 203d 2061 2e79       res.y = a.y
-00007280: 2f72 0a20 2020 2020 2020 2020 2020 2072  /r.            r
-00007290: 6573 2e7a 203d 2061 2e7a 2f72 0a20 2020  es.z = a.z/r.   
-000072a0: 2020 2020 2020 2020 2072 6573 2e77 203d           res.w =
-000072b0: 2061 2e77 2f72 0a20 2020 2020 2020 2020   a.w/r.         
-000072c0: 2020 2072 6574 7572 6e20 7265 730a 2020     return res.  
-000072d0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000072e0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-000072f0: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
-00007300: 6f72 7465 6420 6f70 6572 616e 6420 7479  orted operand ty
-00007310: 7065 2066 6f72 202f 220a 0a20 2020 2064  pe for /"..    d
-00007320: 6566 205f 5f6d 6f64 5f5f 2876 6563 3420  ef __mod__(vec4 
-00007330: 7365 6c66 2c20 6229 3a0a 2020 2020 2020  self, b):.      
-00007340: 2020 2222 224d 6f64 756c 6f20 2863 6f6d    """Modulo (com
-00007350: 706f 6e65 6e74 2077 6973 6529 0a0a 2020  ponent wise)..  
-00007360: 2020 2020 2020 3e3e 3e20 613d 7665 6334        >>> a=vec4
-00007370: 2833 2e30 2c20 322e 352c 202d 312e 382c  (3.0, 2.5, -1.8,
-00007380: 2030 2e32 290a 2020 2020 2020 2020 3e3e   0.2).        >>
-00007390: 3e20 7072 696e 7420 6125 322e 300a 2020  > print a%2.0.  
-000073a0: 2020 2020 2020 2831 2e30 3030 302c 2030        (1.0000, 0
-000073b0: 2e35 3030 302c 2030 2e32 3030 302c 2030  .5000, 0.2000, 0
-000073c0: 2e32 3030 3029 0a20 2020 2020 2020 2022  .2000).        "
-000073d0: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-000073e0: 7665 6334 2072 6573 2c20 7662 0a20 2020  vec4 res, vb.   
-000073f0: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
-00007400: 2072 0a0a 2020 2020 2020 2020 7462 203d   r..        tb =
-00007410: 2074 7970 6528 6229 0a0a 2020 2020 2020   type(b)..      
-00007420: 2020 6966 2074 6220 6973 2066 6c6f 6174    if tb is float
-00007430: 206f 7220 7462 2069 7320 696e 7420 6f72   or tb is int or
-00007440: 2074 6220 6973 206c 6f6e 673a 0a20 2020   tb is long:.   
-00007450: 2020 2020 2020 2020 2023 2076 6563 3425           # vec4%
-00007460: 7363 616c 6172 0a20 2020 2020 2020 2020  scalar.         
-00007470: 2020 2072 6573 203d 2076 6563 3428 290a     res = vec4().
-00007480: 2020 2020 2020 2020 2020 2020 7220 3d20              r = 
-00007490: 620a 2020 2020 2020 2020 2020 2020 6966  b.            if
-000074a0: 2066 6162 7328 7229 3c3d 6570 733a 0a20   fabs(r)<=eps:. 
-000074b0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000074c0: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
-000074d0: 6e45 7272 6f72 2c22 7665 6334 206d 6f64  nError,"vec4 mod
-000074e0: 756c 6f22 0a20 2020 2020 2020 2020 2020  ulo".           
-000074f0: 2072 6573 2e78 203d 205f 666d 6f64 2873   res.x = _fmod(s
-00007500: 656c 662e 782c 7229 0a20 2020 2020 2020  elf.x,r).       
-00007510: 2020 2020 2072 6573 2e79 203d 205f 666d       res.y = _fm
-00007520: 6f64 2873 656c 662e 792c 7229 0a20 2020  od(self.y,r).   
-00007530: 2020 2020 2020 2020 2072 6573 2e7a 203d           res.z =
-00007540: 205f 666d 6f64 2873 656c 662e 7a2c 7229   _fmod(self.z,r)
-00007550: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00007560: 2e77 203d 205f 666d 6f64 2873 656c 662e  .w = _fmod(self.
-00007570: 772c 7229 0a20 2020 2020 2020 2020 2020  w,r).           
-00007580: 2072 6574 7572 6e20 7265 730a 2020 2020   return res.    
-00007590: 2020 2020 656c 6966 2074 6220 6973 2076      elif tb is v
-000075a0: 6563 343a 0a20 2020 2020 2020 2020 2020  ec4:.           
-000075b0: 2023 2076 6563 3425 7665 6334 0a20 2020   # vec4%vec4.   
-000075c0: 2020 2020 2020 2020 2072 6573 203d 2076           res = v
-000075d0: 6563 3428 290a 2020 2020 2020 2020 2020  ec4().          
-000075e0: 2020 7662 203d 2062 0a20 2020 2020 2020    vb = b.       
-000075f0: 2020 2020 2069 6620 2866 6162 7328 7662       if (fabs(vb
-00007600: 2e78 293c 3d65 7073 206f 7220 6661 6273  .x)<=eps or fabs
-00007610: 2876 622e 7929 3c3d 6570 7320 6f72 0a20  (vb.y)<=eps or. 
-00007620: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00007630: 6162 7328 7662 2e7a 293c 3d65 7073 206f  abs(vb.z)<=eps o
-00007640: 7220 6661 6273 2876 622e 7729 3c3d 6570  r fabs(vb.w)<=ep
-00007650: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00007660: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
-00007670: 7669 7369 6f6e 4572 726f 722c 2276 6563  visionError,"vec
-00007680: 3420 6d6f 6475 6c6f 220a 2020 2020 2020  4 modulo".      
-00007690: 2020 2020 2020 7265 732e 7820 3d20 5f66        res.x = _f
-000076a0: 6d6f 6428 7365 6c66 2e78 2c20 7662 2e78  mod(self.x, vb.x
-000076b0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-000076c0: 732e 7920 3d20 5f66 6d6f 6428 7365 6c66  s.y = _fmod(self
-000076d0: 2e79 2c20 7662 2e79 290a 2020 2020 2020  .y, vb.y).      
-000076e0: 2020 2020 2020 7265 732e 7a20 3d20 5f66        res.z = _f
-000076f0: 6d6f 6428 7365 6c66 2e7a 2c20 7662 2e7a  mod(self.z, vb.z
-00007700: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00007710: 732e 7720 3d20 5f66 6d6f 6428 7365 6c66  s.w = _fmod(self
-00007720: 2e77 2c20 7662 2e77 290a 2020 2020 2020  .w, vb.w).      
-00007730: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00007740: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00007750: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00007760: 2054 7970 6545 7272 6f72 2c20 2275 6e73   TypeError, "uns
-00007770: 7570 706f 7274 6564 206f 7065 7261 6e64  upported operand
-00007780: 2074 7970 6520 666f 7220 2522 0a0a 2020   type for %"..  
-00007790: 2020 6465 6620 5f5f 6e65 675f 5f28 7365    def __neg__(se
-000077a0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000077b0: 4e65 6761 7469 6f6e 2e0a 0a20 2020 2020  Negation...     
-000077c0: 2020 203e 3e3e 2061 3d76 6563 3428 332e     >>> a=vec4(3.
-000077d0: 302c 2032 2e35 2c20 2d31 2e38 2c20 302e  0, 2.5, -1.8, 0.
-000077e0: 3229 0a20 2020 2020 2020 203e 3e3e 2070  2).        >>> p
-000077f0: 7269 6e74 202d 610a 2020 2020 2020 2020  rint -a.        
-00007800: 282d 332e 3030 3030 2c20 2d32 2e35 3030  (-3.0000, -2.500
-00007810: 302c 2031 2e38 3030 302c 202d 302e 3230  0, 1.8000, -0.20
-00007820: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
-00007830: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
-00007840: 3420 7265 730a 2020 2020 2020 2020 7265  4 res.        re
-00007850: 7320 3d20 7665 6334 2829 0a20 2020 2020  s = vec4().     
-00007860: 2020 2072 6573 2e78 203d 202d 7365 6c66     res.x = -self
-00007870: 2e78 0a20 2020 2020 2020 2072 6573 2e79  .x.        res.y
-00007880: 203d 202d 7365 6c66 2e79 0a20 2020 2020   = -self.y.     
-00007890: 2020 2072 6573 2e7a 203d 202d 7365 6c66     res.z = -self
-000078a0: 2e7a 0a20 2020 2020 2020 2072 6573 2e77  .z.        res.w
-000078b0: 203d 202d 7365 6c66 2e77 0a20 2020 2020   = -self.w.     
-000078c0: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
-000078d0: 2020 2064 6566 205f 5f70 6f73 5f5f 2873     def __pos__(s
-000078e0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000078f0: 220a 2020 2020 2020 2020 3e3e 3e20 613d  ".        >>> a=
-00007900: 7665 6334 2833 2e30 2c20 322e 352c 202d  vec4(3.0, 2.5, -
-00007910: 312e 382c 2030 2e32 290a 2020 2020 2020  1.8, 0.2).      
-00007920: 2020 3e3e 3e20 7072 696e 7420 2b61 0a20    >>> print +a. 
-00007930: 2020 2020 2020 2028 332e 3030 3030 2c20         (3.0000, 
-00007940: 322e 3530 3030 2c20 2d31 2e38 3030 302c  2.5000, -1.8000,
-00007950: 2030 2e32 3030 3029 0a20 2020 2020 2020   0.2000).       
-00007960: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00007970: 6620 7665 6334 2072 6573 0a20 2020 2020  f vec4 res.     
-00007980: 2020 2072 6573 203d 2076 6563 3428 290a     res = vec4().
-00007990: 2020 2020 2020 2020 7265 732e 7820 3d20          res.x = 
-000079a0: 7365 6c66 2e78 0a20 2020 2020 2020 2072  self.x.        r
-000079b0: 6573 2e79 203d 2073 656c 662e 790a 2020  es.y = self.y.  
-000079c0: 2020 2020 2020 7265 732e 7a20 3d20 7365        res.z = se
-000079d0: 6c66 2e7a 0a20 2020 2020 2020 2072 6573  lf.z.        res
-000079e0: 2e77 203d 2073 656c 662e 770a 2020 2020  .w = self.w.    
-000079f0: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-00007a00: 2020 2020 6465 6620 5f5f 6961 6464 5f5f      def __iadd__
-00007a10: 2873 656c 662c 2076 6563 3420 6f74 6865  (self, vec4 othe
-00007a20: 7229 3a0a 2020 2020 2020 2020 2222 2249  r):.        """I
-00007a30: 6e6c 696e 6520 7665 6374 6f72 2061 6464  nline vector add
-00007a40: 6974 696f 6e2e 0a0a 2020 2020 2020 2020  ition...        
-00007a50: 3e3e 3e20 613d 7665 6334 2831 2e30 2c20  >>> a=vec4(1.0, 
-00007a60: 302e 352c 202d 312e 382c 2030 2e32 290a  0.5, -1.8, 0.2).
-00007a70: 2020 2020 2020 2020 3e3e 3e20 623d 7665          >>> b=ve
-00007a80: 6334 282d 302e 332c 2030 2e37 352c 2030  c4(-0.3, 0.75, 0
-00007a90: 2e35 2c20 302e 3329 0a20 2020 2020 2020  .5, 0.3).       
-00007aa0: 203e 3e3e 2061 2b3d 620a 2020 2020 2020   >>> a+=b.      
-00007ab0: 2020 3e3e 3e20 7072 696e 7420 610a 2020    >>> print a.  
-00007ac0: 2020 2020 2020 2830 2e37 3030 302c 2031        (0.7000, 1
-00007ad0: 2e32 3530 302c 202d 312e 3330 3030 2c20  .2500, -1.3000, 
-00007ae0: 302e 3530 3030 290a 2020 2020 2020 2020  0.5000).        
-00007af0: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
-00007b00: 2e78 3d73 656c 662e 782b 6f74 6865 722e  .x=self.x+other.
-00007b10: 780a 2020 2020 2020 2020 7365 6c66 2e79  x.        self.y
-00007b20: 3d73 656c 662e 792b 6f74 6865 722e 790a  =self.y+other.y.
-00007b30: 2020 2020 2020 2020 7365 6c66 2e7a 3d73          self.z=s
-00007b40: 656c 662e 7a2b 6f74 6865 722e 7a0a 2020  elf.z+other.z.  
-00007b50: 2020 2020 2020 7365 6c66 2e77 3d73 656c        self.w=sel
-00007b60: 662e 772b 6f74 6865 722e 770a 2020 2020  f.w+other.w.    
-00007b70: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
-00007b80: 0a20 2020 2064 6566 205f 5f69 7375 625f  .    def __isub_
-00007b90: 5f28 7365 6c66 2c20 7665 6334 206f 7468  _(self, vec4 oth
-00007ba0: 6572 293a 0a20 2020 2020 2020 2022 2222  er):.        """
-00007bb0: 496e 6c69 6e65 2076 6563 746f 7220 7375  Inline vector su
-00007bc0: 6274 7261 6374 696f 6e2e 0a0a 2020 2020  btraction...    
-00007bd0: 2020 2020 3e3e 3e20 613d 7665 6334 2831      >>> a=vec4(1
-00007be0: 2e30 2c20 302e 352c 202d 312e 382c 2030  .0, 0.5, -1.8, 0
-00007bf0: 2e32 290a 2020 2020 2020 2020 3e3e 3e20  .2).        >>> 
-00007c00: 623d 7665 6334 282d 302e 332c 2030 2e37  b=vec4(-0.3, 0.7
-00007c10: 352c 2030 2e35 2c20 302e 3329 0a20 2020  5, 0.5, 0.3).   
-00007c20: 2020 2020 203e 3e3e 2061 2d3d 620a 2020       >>> a-=b.  
-00007c30: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00007c40: 610a 2020 2020 2020 2020 2831 2e33 3030  a.        (1.300
-00007c50: 302c 202d 302e 3235 3030 2c20 2d32 2e33  0, -0.2500, -2.3
-00007c60: 3030 302c 202d 302e 3130 3030 290a 2020  000, -0.1000).  
-00007c70: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00007c80: 2020 7365 6c66 2e78 3d73 656c 662e 782d    self.x=self.x-
-00007c90: 6f74 6865 722e 780a 2020 2020 2020 2020  other.x.        
-00007ca0: 7365 6c66 2e79 3d73 656c 662e 792d 6f74  self.y=self.y-ot
-00007cb0: 6865 722e 790a 2020 2020 2020 2020 7365  her.y.        se
-00007cc0: 6c66 2e7a 3d73 656c 662e 7a2d 6f74 6865  lf.z=self.z-othe
-00007cd0: 722e 7a0a 2020 2020 2020 2020 7365 6c66  r.z.        self
-00007ce0: 2e77 3d73 656c 662e 772d 6f74 6865 722e  .w=self.w-other.
-00007cf0: 770a 2020 2020 2020 2020 7265 7475 726e  w.        return
-00007d00: 2073 656c 660a 0a20 2020 2064 6566 205f   self..    def _
-00007d10: 5f69 6d75 6c5f 5f28 7365 6c66 2c20 6f74  _imul__(self, ot
-00007d20: 6865 7229 3a0a 2020 2020 2020 2020 2222  her):.        ""
-00007d30: 2249 6e6c 696e 6520 6d75 6c74 6970 6c69  "Inline multipli
-00007d40: 6361 7469 6f6e 2028 6f6e 6c79 2077 6974  cation (only wit
-00007d50: 6820 7363 616c 6172 290a 0a20 2020 2020  h scalar)..     
-00007d60: 2020 203e 3e3e 2061 3d76 6563 3428 312e     >>> a=vec4(1.
-00007d70: 302c 2030 2e35 2c20 2d31 2e38 2c20 302e  0, 0.5, -1.8, 0.
-00007d80: 3229 0a20 2020 2020 2020 203e 3e3e 2061  2).        >>> a
-00007d90: 2a3d 322e 300a 2020 2020 2020 2020 3e3e  *=2.0.        >>
-00007da0: 3e20 7072 696e 7420 610a 2020 2020 2020  > print a.      
-00007db0: 2020 2832 2e30 3030 302c 2031 2e30 3030    (2.0000, 1.000
-00007dc0: 302c 202d 332e 3630 3030 2c20 302e 3430  0, -3.6000, 0.40
-00007dd0: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
-00007de0: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
-00007df0: 626c 6520 720a 2020 2020 2020 2020 7462  ble r.        tb
-00007e00: 203d 2074 7970 6528 6f74 6865 7229 0a20   = type(other). 
-00007e10: 2020 2020 2020 2069 6620 7462 2069 7320         if tb is 
-00007e20: 666c 6f61 7420 6f72 2074 6220 6973 2069  float or tb is i
-00007e30: 6e74 206f 7220 7462 2069 7320 6c6f 6e67  nt or tb is long
-00007e40: 3a0a 2020 2020 2020 2020 2020 2020 723d  :.            r=
-00007e50: 6f74 6865 720a 2020 2020 2020 2020 2020  other.          
-00007e60: 2020 7365 6c66 2e78 3d73 656c 662e 782a    self.x=self.x*
-00007e70: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-00007e80: 6c66 2e79 3d73 656c 662e 792a 720a 2020  lf.y=self.y*r.  
-00007e90: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
-00007ea0: 3d73 656c 662e 7a2a 720a 2020 2020 2020  =self.z*r.      
-00007eb0: 2020 2020 2020 7365 6c66 2e77 3d73 656c        self.w=sel
-00007ec0: 662e 772a 720a 2020 2020 2020 2020 2020  f.w*r.          
-00007ed0: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
-00007ee0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00007ef0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00007f00: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
-00007f10: 6f72 7465 6420 6f70 6572 616e 6420 7479  orted operand ty
-00007f20: 7065 2066 6f72 202a 3d22 0a0a 2020 2020  pe for *="..    
-00007f30: 6465 6620 5f5f 6964 6976 5f5f 2873 656c  def __idiv__(sel
-00007f40: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
-00007f50: 2020 2022 2222 496e 6c69 6e65 2064 6976     """Inline div
-00007f60: 6973 696f 6e20 7769 7468 2073 6361 6c61  ision with scala
-00007f70: 720a 0a20 2020 2020 2020 203e 3e3e 2061  r..        >>> a
-00007f80: 3d76 6563 3428 312e 302c 2030 2e35 2c20  =vec4(1.0, 0.5, 
-00007f90: 2d31 2e38 2c20 302e 3229 0a20 2020 2020  -1.8, 0.2).     
-00007fa0: 2020 203e 3e3e 2061 2f3d 322e 300a 2020     >>> a/=2.0.  
-00007fb0: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00007fc0: 610a 2020 2020 2020 2020 2830 2e35 3030  a.        (0.500
-00007fd0: 302c 2030 2e32 3530 302c 202d 302e 3930  0, 0.2500, -0.90
-00007fe0: 3030 2c20 302e 3130 3030 290a 2020 2020  00, 0.1000).    
-00007ff0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00008000: 6364 6566 2064 6f75 626c 6520 720a 2020  cdef double r.  
-00008010: 2020 2020 2020 7462 203d 2074 7970 6528        tb = type(
-00008020: 6f74 6865 7229 0a20 2020 2020 2020 2069  other).        i
-00008030: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
-00008040: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
-00008050: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
-00008060: 2020 2020 2020 723d 6f74 6865 720a 2020        r=other.  
-00008070: 2020 2020 2020 2020 2020 6966 2066 6162            if fab
-00008080: 7328 7229 3c3d 6570 733a 0a20 2020 2020  s(r)<=eps:.     
-00008090: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000080a0: 205a 6572 6f44 6976 6973 696f 6e45 7272   ZeroDivisionErr
-000080b0: 6f72 2c22 7665 6334 2064 6976 6973 696f  or,"vec4 divisio
-000080c0: 6e22 0a20 2020 2020 2020 2020 2020 2073  n".            s
-000080d0: 656c 662e 783d 7365 6c66 2e78 2f72 0a20  elf.x=self.x/r. 
-000080e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000080f0: 793d 7365 6c66 2e79 2f72 0a20 2020 2020  y=self.y/r.     
-00008100: 2020 2020 2020 2073 656c 662e 7a3d 7365         self.z=se
-00008110: 6c66 2e7a 2f72 0a20 2020 2020 2020 2020  lf.z/r.         
-00008120: 2020 2073 656c 662e 773d 7365 6c66 2e77     self.w=self.w
-00008130: 2f72 0a20 2020 2020 2020 2020 2020 2072  /r.            r
-00008140: 6574 7572 6e20 7365 6c66 0a20 2020 2020  eturn self.     
-00008150: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00008160: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00008170: 7272 6f72 2c20 2275 6e73 7570 706f 7274  rror, "unsupport
-00008180: 6564 206f 7065 7261 6e64 2074 7970 6520  ed operand type 
-00008190: 666f 7220 2f3d 220a 0a20 2020 2064 6566  for /="..    def
-000081a0: 205f 5f69 6d6f 645f 5f28 7365 6c66 2c20   __imod__(self, 
-000081b0: 6229 3a0a 2020 2020 2020 2020 2222 2249  b):.        """I
-000081c0: 6e6c 696e 6520 6d6f 6475 6c6f 2e0a 0a20  nline modulo... 
-000081d0: 2020 2020 2020 203e 3e3e 2061 3d76 6563         >>> a=vec
-000081e0: 3428 332e 302c 2032 2e35 2c20 2d31 2e38  4(3.0, 2.5, -1.8
-000081f0: 2c20 302e 3229 0a20 2020 2020 2020 203e  , 0.2).        >
-00008200: 3e3e 2061 253d 322e 300a 2020 2020 2020  >> a%=2.0.      
-00008210: 2020 3e3e 3e20 7072 696e 7420 610a 2020    >>> print a.  
-00008220: 2020 2020 2020 2831 2e30 3030 302c 2030        (1.0000, 0
-00008230: 2e35 3030 302c 2030 2e32 3030 302c 2030  .5000, 0.2000, 0
-00008240: 2e32 3030 3029 0a20 2020 2020 2020 2022  .2000).        "
-00008250: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-00008260: 7665 6334 2076 620a 2020 2020 2020 2020  vec4 vb.        
-00008270: 6364 6566 2064 6f75 626c 6520 720a 0a20  cdef double r.. 
-00008280: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
-00008290: 2862 290a 0a20 2020 2020 2020 2069 6620  (b)..        if 
-000082a0: 7462 2069 7320 666c 6f61 7420 6f72 2074  tb is float or t
-000082b0: 6220 6973 2069 6e74 206f 7220 7462 2069  b is int or tb i
-000082c0: 7320 6c6f 6e67 3a0a 2020 2020 2020 2020  s long:.        
-000082d0: 2020 2020 2320 7665 6334 253d 7363 616c      # vec4%=scal
-000082e0: 6172 0a20 2020 2020 2020 2020 2020 2072  ar.            r
-000082f0: 203d 2062 0a20 2020 2020 2020 2020 2020   = b.           
-00008300: 2069 6620 6661 6273 2872 293c 3d65 7073   if fabs(r)<=eps
-00008310: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00008320: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
-00008330: 7369 6f6e 4572 726f 722c 2276 6563 3420  sionError,"vec4 
-00008340: 6d6f 6475 6c6f 220a 2020 2020 2020 2020  modulo".        
-00008350: 2020 2020 7365 6c66 2e78 203d 205f 666d      self.x = _fm
-00008360: 6f64 2873 656c 662e 782c 7229 0a20 2020  od(self.x,r).   
-00008370: 2020 2020 2020 2020 2073 656c 662e 7920           self.y 
-00008380: 3d20 5f66 6d6f 6428 7365 6c66 2e79 2c72  = _fmod(self.y,r
-00008390: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-000083a0: 6c66 2e7a 203d 205f 666d 6f64 2873 656c  lf.z = _fmod(sel
-000083b0: 662e 7a2c 7229 0a20 2020 2020 2020 2020  f.z,r).         
-000083c0: 2020 2073 656c 662e 7720 3d20 5f66 6d6f     self.w = _fmo
-000083d0: 6428 7365 6c66 2e77 2c72 290a 2020 2020  d(self.w,r).    
-000083e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000083f0: 656c 660a 2020 2020 2020 2020 656c 6966  elf.        elif
-00008400: 2074 6220 6973 2076 6563 343a 0a20 2020   tb is vec4:.   
-00008410: 2020 2020 2020 2020 2023 2076 6563 3425           # vec4%
-00008420: 3d76 6563 340a 2020 2020 2020 2020 2020  =vec4.          
-00008430: 2020 7662 203d 2062 0a20 2020 2020 2020    vb = b.       
-00008440: 2020 2020 2069 6620 2866 6162 7328 7662       if (fabs(vb
-00008450: 2e78 293c 3d65 7073 206f 7220 6661 6273  .x)<=eps or fabs
-00008460: 2876 622e 7929 3c3d 6570 7320 6f72 0a20  (vb.y)<=eps or. 
-00008470: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00008480: 6162 7328 7662 2e7a 293c 3d65 7073 206f  abs(vb.z)<=eps o
-00008490: 7220 6661 6273 2876 622e 7729 3c3d 6570  r fabs(vb.w)<=ep
-000084a0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-000084b0: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
-000084c0: 7669 7369 6f6e 4572 726f 722c 2276 6563  visionError,"vec
-000084d0: 3420 6d6f 6475 6c6f 220a 2020 2020 2020  4 modulo".      
-000084e0: 2020 2020 2020 7365 6c66 2e78 203d 205f        self.x = _
-000084f0: 666d 6f64 2873 656c 662e 782c 2076 622e  fmod(self.x, vb.
-00008500: 7829 0a20 2020 2020 2020 2020 2020 2073  x).            s
-00008510: 656c 662e 7920 3d20 5f66 6d6f 6428 7365  elf.y = _fmod(se
-00008520: 6c66 2e79 2c20 7662 2e79 290a 2020 2020  lf.y, vb.y).    
-00008530: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
-00008540: 205f 666d 6f64 2873 656c 662e 7a2c 2076   _fmod(self.z, v
-00008550: 622e 7a29 0a20 2020 2020 2020 2020 2020  b.z).           
-00008560: 2073 656c 662e 7720 3d20 5f66 6d6f 6428   self.w = _fmod(
-00008570: 7365 6c66 2e77 2c20 7662 2e77 290a 2020  self.w, vb.w).  
-00008580: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00008590: 2073 656c 660a 2020 2020 2020 2020 656c   self.        el
-000085a0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000085b0: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
-000085c0: 2022 756e 7375 7070 6f72 7465 6420 6f70   "unsupported op
-000085d0: 6572 616e 6420 7479 7065 2066 6f72 2025  erand type for %
-000085e0: 3d22 0a0a 0a20 2020 2064 6566 205f 5f61  ="...    def __a
-000085f0: 6273 5f5f 2873 656c 6629 3a0a 2020 2020  bs__(self):.    
-00008600: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
-00008610: 6520 6c65 6e67 7468 206f 6620 7468 6520  e length of the 
-00008620: 7665 6374 6f72 2e0a 0a20 2020 2020 2020  vector...       
-00008630: 2061 6273 2876 2920 6973 2065 7175 6976   abs(v) is equiv
-00008640: 616c 656e 7420 746f 2076 2e6c 656e 6774  alent to v.lengt
-00008650: 6828 292e 0a0a 2020 2020 2020 2020 3e3e  h()...        >>
-00008660: 3e20 613d 7665 6334 2831 2e30 2c20 302e  > a=vec4(1.0, 0.
-00008670: 352c 202d 312e 382c 2030 2e32 290a 2020  5, -1.8, 0.2).  
-00008680: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00008690: 6162 7328 6129 0a20 2020 2020 2020 2032  abs(a).        2
-000086a0: 2e31 3238 3337 3936 3635 3338 0a20 2020  .12837966538.   
-000086b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000086c0: 2063 6465 6620 646f 7562 6c65 2061 0a20   cdef double a. 
-000086d0: 2020 2020 2020 2061 203d 2073 656c 662e         a = self.
-000086e0: 782a 7365 6c66 2e78 202b 2073 656c 662e  x*self.x + self.
-000086f0: 792a 7365 6c66 2e79 202b 2073 656c 662e  y*self.y + self.
-00008700: 7a2a 7365 6c66 2e7a 202b 2073 656c 662e  z*self.z + self.
-00008710: 772a 7365 6c66 2e77 0a20 2020 2020 2020  w*self.w.       
-00008720: 2072 6574 7572 6e20 7371 7274 2861 290a   return sqrt(a).
-00008730: 0a20 2020 2064 6566 205f 5f67 6574 6174  .    def __getat
-00008740: 7472 5f5f 2873 656c 662c 206e 616d 6529  tr__(self, name)
-00008750: 3a0a 2020 2020 2020 2020 6966 206e 616d  :.        if nam
-00008760: 653d 3d22 7822 3a0a 2020 2020 2020 2020  e=="x":.        
-00008770: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00008780: 780a 2020 2020 2020 2020 656c 6966 206e  x.        elif n
-00008790: 616d 653d 3d22 7922 3a0a 2020 2020 2020  ame=="y":.      
-000087a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000087b0: 662e 790a 2020 2020 2020 2020 656c 6966  f.y.        elif
-000087c0: 206e 616d 653d 3d22 7a22 3a0a 2020 2020   name=="z":.    
-000087d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000087e0: 656c 662e 7a0a 2020 2020 2020 2020 656c  elf.z.        el
-000087f0: 6966 206e 616d 653d 3d22 7722 206f 7220  if name=="w" or 
-00008800: 6e61 6d65 3d3d 2274 223a 0a20 2020 2020  name=="t":.     
-00008810: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00008820: 6c66 2e77 0a20 2020 2020 2020 2065 6c73  lf.w.        els
-00008830: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00008840: 6169 7365 2041 7474 7269 6275 7465 4572  aise AttributeEr
-00008850: 726f 722c 2276 6563 3420 6861 7320 6e6f  ror,"vec4 has no
-00008860: 2061 7474 7269 6275 7465 2027 222b 6e61   attribute '"+na
-00008870: 6d65 2b22 2722 0a0a 2020 2020 6465 6620  me+"'"..    def 
-00008880: 5f5f 7365 7461 7474 725f 5f28 7365 6c66  __setattr__(self
-00008890: 2c20 6e61 6d65 2c20 7661 6c29 3a0a 2020  , name, val):.  
-000088a0: 2020 2020 2020 6966 206e 616d 653d 3d22        if name=="
-000088b0: 7822 3a0a 2020 2020 2020 2020 2020 2020  x":.            
-000088c0: 7365 6c66 2e78 203d 2076 616c 0a20 2020  self.x = val.   
-000088d0: 2020 2020 2065 6c69 6620 6e61 6d65 3d3d       elif name==
-000088e0: 2279 223a 0a20 2020 2020 2020 2020 2020  "y":.           
-000088f0: 2073 656c 662e 7920 3d20 7661 6c0a 2020   self.y = val.  
-00008900: 2020 2020 2020 656c 6966 206e 616d 653d        elif name=
-00008910: 3d22 7a22 3a0a 2020 2020 2020 2020 2020  ="z":.          
-00008920: 2020 7365 6c66 2e7a 203d 2076 616c 0a20    self.z = val. 
-00008930: 2020 2020 2020 2065 6c69 6620 6e61 6d65         elif name
-00008940: 3d3d 2277 2220 6f72 206e 616d 653d 3d22  =="w" or name=="
-00008950: 7422 3a0a 2020 2020 2020 2020 2020 2020  t":.            
-00008960: 7365 6c66 2e77 203d 2076 616c 0a20 2020  self.w = val.   
-00008970: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00008980: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
-00008990: 7269 6275 7465 4572 726f 722c 2276 6563  ributeError,"vec
-000089a0: 3420 6861 7320 6e6f 2077 7269 7461 626c  4 has no writabl
-000089b0: 6520 6174 7472 6962 7574 6520 2722 2b6e  e attribute '"+n
-000089c0: 616d 652b 2227 220a 0a20 2020 2064 6566  ame+"'"..    def
-000089d0: 205f 5f6c 656e 5f5f 2873 656c 6629 3a0a   __len__(self):.
-000089e0: 2020 2020 2020 2020 2222 224c 656e 6774          """Lengt
-000089f0: 6820 6f66 2074 6865 2073 6571 7565 6e63  h of the sequenc
-00008a00: 6520 2861 6c77 6179 7320 3429 2e22 2222  e (always 4)."""
-00008a10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00008a20: 340a 0a20 2020 2064 6566 205f 5f67 6574  4..    def __get
-00008a30: 6974 656d 5f5f 2873 656c 662c 206b 6579  item__(self, key
-00008a40: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-00008a50: 7475 726e 2061 2063 6f6d 706f 6e65 6e74  turn a component
-00008a60: 2062 7920 696e 6465 7820 2830 2d62 6173   by index (0-bas
-00008a70: 6564 292e 0a0a 2020 2020 2020 2020 3e3e  ed)...        >>
-00008a80: 3e20 613d 7665 6334 2831 2e30 2c20 302e  > a=vec4(1.0, 0.
-00008a90: 352c 202d 312e 382c 2030 2e32 290a 2020  5, -1.8, 0.2).  
-00008aa0: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00008ab0: 615b 305d 0a20 2020 2020 2020 2031 2e30  a[0].        1.0
-00008ac0: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00008ad0: 6e74 2061 5b31 5d0a 2020 2020 2020 2020  nt a[1].        
-00008ae0: 302e 350a 2020 2020 2020 2020 3e3e 3e20  0.5.        >>> 
-00008af0: 7072 696e 7420 615b 325d 0a20 2020 2020  print a[2].     
-00008b00: 2020 202d 312e 380a 2020 2020 2020 2020     -1.8.        
-00008b10: 3e3e 3e20 7072 696e 7420 615b 335d 0a20  >>> print a[3]. 
-00008b20: 2020 2020 2020 2030 2e32 0a20 2020 2020         0.2.     
-00008b30: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-00008b40: 6465 6620 696e 7420 6b0a 0a20 2020 2020  def int k..     
-00008b50: 2020 2054 3d74 7970 6528 6b65 7929 0a20     T=type(key). 
-00008b60: 2020 2020 2020 2069 6620 5421 3d69 6e74         if T!=int
-00008b70: 2061 6e64 2054 213d 6c6f 6e67 3a0a 2020   and T!=long:.  
-00008b80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00008b90: 5479 7065 4572 726f 722c 2022 696e 6465  TypeError, "inde
-00008ba0: 7820 6d75 7374 2062 6520 696e 7465 6765  x must be intege
-00008bb0: 7222 0a0a 2020 2020 2020 2020 6b20 3d20  r"..        k = 
-00008bc0: 6b65 790a 2020 2020 2020 2020 6966 2020  key.        if  
-00008bd0: 206b 3d3d 303a 2072 6574 7572 6e20 7365   k==0: return se
-00008be0: 6c66 2e78 0a20 2020 2020 2020 2065 6c69  lf.x.        eli
-00008bf0: 6620 6b3d 3d31 3a20 7265 7475 726e 2073  f k==1: return s
-00008c00: 656c 662e 790a 2020 2020 2020 2020 656c  elf.y.        el
-00008c10: 6966 206b 3d3d 323a 2072 6574 7572 6e20  if k==2: return 
-00008c20: 7365 6c66 2e7a 0a20 2020 2020 2020 2065  self.z.        e
-00008c30: 6c69 6620 6b3d 3d33 3a20 7265 7475 726e  lif k==3: return
-00008c40: 2073 656c 662e 770a 2020 2020 2020 2020   self.w.        
-00008c50: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00008c60: 2020 7261 6973 6520 496e 6465 7845 7272    raise IndexErr
-00008c70: 6f72 2c22 696e 6465 7820 6f75 7420 6f66  or,"index out of
-00008c80: 2072 616e 6765 220a 0a20 2020 2064 6566   range"..    def
-00008c90: 205f 5f73 6574 6974 656d 5f5f 2873 656c   __setitem__(sel
-00008ca0: 662c 206b 6579 2c20 7661 6c75 6529 3a0a  f, key, value):.
-00008cb0: 2020 2020 2020 2020 2222 2253 6574 2061          """Set a
-00008cc0: 2063 6f6d 706f 6e65 6e74 2062 7920 696e   component by in
-00008cd0: 6465 7820 2830 2d62 6173 6564 292e 0a0a  dex (0-based)...
-00008ce0: 2020 2020 2020 2020 3e3e 3e20 613d 7665          >>> a=ve
-00008cf0: 6334 2829 0a20 2020 2020 2020 203e 3e3e  c4().        >>>
-00008d00: 2061 5b30 5d3d 312e 353b 2061 5b31 5d3d   a[0]=1.5; a[1]=
-00008d10: 302e 373b 2061 5b32 5d3d 2d30 2e33 3b20  0.7; a[2]=-0.3; 
-00008d20: 615b 335d 3d30 2e32 0a20 2020 2020 2020  a[3]=0.2.       
-00008d30: 203e 3e3e 2070 7269 6e74 2061 0a20 2020   >>> print a.   
-00008d40: 2020 2020 2028 312e 3530 3030 2c20 302e       (1.5000, 0.
-00008d50: 3730 3030 2c20 2d30 2e33 3030 302c 2030  7000, -0.3000, 0
-00008d60: 2e32 3030 3029 0a20 2020 2020 2020 2022  .2000).        "
-00008d70: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-00008d80: 696e 7420 6b0a 0a20 2020 2020 2020 2054  int k..        T
-00008d90: 3d74 7970 6528 6b65 7929 0a20 2020 2020  =type(key).     
-00008da0: 2020 2069 6620 5421 3d69 6e74 2061 6e64     if T!=int and
-00008db0: 2054 213d 6c6f 6e67 3a0a 2020 2020 2020   T!=long:.      
-00008dc0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00008dd0: 4572 726f 722c 2022 696e 6465 7820 6d75  Error, "index mu
-00008de0: 7374 2062 6520 696e 7465 6765 7222 0a0a  st be integer"..
-00008df0: 2020 2020 2020 2020 6b20 3d20 6b65 790a          k = key.
-00008e00: 2020 2020 2020 2020 6966 2020 206b 3d3d          if   k==
-00008e10: 303a 2073 656c 662e 7820 3d20 7661 6c75  0: self.x = valu
-00008e20: 650a 2020 2020 2020 2020 656c 6966 206b  e.        elif k
-00008e30: 3d3d 313a 2073 656c 662e 7920 3d20 7661  ==1: self.y = va
-00008e40: 6c75 650a 2020 2020 2020 2020 656c 6966  lue.        elif
-00008e50: 206b 3d3d 323a 2073 656c 662e 7a20 3d20   k==2: self.z = 
-00008e60: 7661 6c75 650a 2020 2020 2020 2020 656c  value.        el
-00008e70: 6966 206b 3d3d 333a 2073 656c 662e 7720  if k==3: self.w 
-00008e80: 3d20 7661 6c75 650a 2020 2020 2020 2020  = value.        
-00008e90: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00008ea0: 2020 7261 6973 6520 496e 6465 7845 7272    raise IndexErr
-00008eb0: 6f72 2c22 696e 6465 7820 6f75 7420 6f66  or,"index out of
-00008ec0: 2072 616e 6765 220a 0a20 2020 2064 6566   range"..    def
-00008ed0: 206c 656e 6774 6828 7365 6c66 293a 0a20   length(self):. 
-00008ee0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00008ef0: 2074 6865 206c 656e 6774 6820 6f66 2074   the length of t
-00008f00: 6865 2076 6563 746f 722e 0a0a 2020 2020  he vector...    
-00008f10: 2020 2020 762e 6c65 6e67 7468 2829 2069      v.length() i
-00008f20: 7320 6571 7569 7661 6c65 6e74 2074 6f20  s equivalent to 
-00008f30: 6162 7328 7629 2e0a 0a20 2020 2020 2020  abs(v)...       
-00008f40: 203e 3e3e 2061 3d76 6563 3428 312e 302c   >>> a=vec4(1.0,
-00008f50: 2030 2e35 2c20 2d31 2e38 2c20 302e 3229   0.5, -1.8, 0.2)
-00008f60: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00008f70: 6e74 2061 2e6c 656e 6774 6828 290a 2020  nt a.length().  
-00008f80: 2020 2020 2020 322e 3132 3833 3739 3636        2.12837966
-00008f90: 3533 380a 2020 2020 2020 2020 2222 220a  538.        """.
-00008fa0: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
-00008fb0: 626c 6520 610a 2020 2020 2020 2020 6120  ble a.        a 
-00008fc0: 3d20 7365 6c66 2e78 2a73 656c 662e 7820  = self.x*self.x 
-00008fd0: 2b20 7365 6c66 2e79 2a73 656c 662e 7920  + self.y*self.y 
-00008fe0: 2b20 7365 6c66 2e7a 2a73 656c 662e 7a20  + self.z*self.z 
-00008ff0: 2b20 7365 6c66 2e77 2a73 656c 662e 770a  + self.w*self.w.
-00009000: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00009010: 7172 7428 6129 0a0a 2020 2020 6465 6620  qrt(a)..    def 
-00009020: 6e6f 726d 616c 697a 6528 7365 6c66 293a  normalize(self):
-00009030: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00009040: 726e 206e 6f72 6d61 6c69 7a65 6420 7665  rn normalized ve
-00009050: 6374 6f72 2e0a 0a20 2020 2020 2020 203e  ctor...        >
-00009060: 3e3e 2061 3d76 6563 3428 312e 302c 2030  >> a=vec4(1.0, 0
-00009070: 2e35 2c20 2d31 2e38 2c20 312e 3229 0a20  .5, -1.8, 1.2). 
-00009080: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
-00009090: 2061 2e6e 6f72 6d61 6c69 7a65 2829 0a20   a.normalize(). 
-000090a0: 2020 2020 2020 2028 302e 3431 3037 2c20         (0.4107, 
-000090b0: 302e 3230 3533 2c20 2d30 2e37 3339 322c  0.2053, -0.7392,
-000090c0: 2030 2e34 3932 3829 0a20 2020 2020 2020   0.4928).       
-000090d0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-000090e0: 6620 7665 6334 2072 6573 0a20 2020 2020  f vec4 res.     
-000090f0: 2020 2063 6465 6620 646f 7562 6c65 206e     cdef double n
-00009100: 6c65 6e0a 0a20 2020 2020 2020 206e 6c65  len..        nle
-00009110: 6e20 3d20 7371 7274 2873 656c 662e 782a  n = sqrt(self.x*
-00009120: 7365 6c66 2e78 202b 2073 656c 662e 792a  self.x + self.y*
-00009130: 7365 6c66 2e79 202b 2073 656c 662e 7a2a  self.y + self.z*
-00009140: 7365 6c66 2e7a 202b 2073 656c 662e 772a  self.z + self.w*
-00009150: 7365 6c66 2e77 290a 2020 2020 2020 2020  self.w).        
-00009160: 6966 206e 6c65 6e3c 3d65 7073 3a0a 2020  if nlen<=eps:.  
-00009170: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00009180: 5a65 726f 4469 7669 7369 6f6e 4572 726f  ZeroDivisionErro
-00009190: 722c 226e 756c 6c20 7665 6374 6f72 2063  r,"null vector c
-000091a0: 616e 2774 2062 6520 6e6f 726d 616c 697a  an't be normaliz
-000091b0: 6564 220a 2020 2020 2020 2020 6e6c 656e  ed".        nlen
-000091c0: 203d 2031 2e30 2f6e 6c65 6e0a 2020 2020   = 1.0/nlen.    
-000091d0: 2020 2020 7265 7320 3d20 7665 6334 2829      res = vec4()
-000091e0: 0a20 2020 2020 2020 2072 6573 2e78 203d  .        res.x =
-000091f0: 2073 656c 662e 782a 6e6c 656e 0a20 2020   self.x*nlen.   
-00009200: 2020 2020 2072 6573 2e79 203d 2073 656c       res.y = sel
-00009210: 662e 792a 6e6c 656e 0a20 2020 2020 2020  f.y*nlen.       
-00009220: 2072 6573 2e7a 203d 2073 656c 662e 7a2a   res.z = self.z*
-00009230: 6e6c 656e 0a20 2020 2020 2020 2072 6573  nlen.        res
-00009240: 2e77 203d 2073 656c 662e 772a 6e6c 656e  .w = self.w*nlen
-00009250: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00009260: 7265 730a 0a23 2323 2323 2323 2323 2323  res..###########
-00009270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00009280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00009290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000092a0: 2323 2323 2323 2323 2323 230a 0a23 206d  ###########..# m
-000092b0: 6174 3369 7465 720a 6364 6566 2063 6c61  at3iter.cdef cla
-000092c0: 7373 206d 6174 3369 7465 723a 0a20 2020  ss mat3iter:.   
-000092d0: 2022 2222 6d61 7420 6974 6572 6174 6f72   """mat iterator
-000092e0: 2e22 2222 0a20 2020 2063 6465 6620 696e  .""".    cdef in
-000092f0: 7420 6964 780a 2020 2020 6364 6566 206f  t idx.    cdef o
-00009300: 626a 6563 7420 6d0a 0a20 2020 2064 6566  bject m..    def
-00009310: 205f 5f63 696e 6974 5f5f 2873 656c 662c   __cinit__(self,
-00009320: 206d 293a 0a20 2020 2020 2020 2073 656c   m):.        sel
-00009330: 662e 6964 7820 3d20 300a 2020 2020 2020  f.idx = 0.      
-00009340: 2020 7365 6c66 2e6d 2020 203d 206d 0a0a    self.m   = m..
-00009350: 2020 2020 6465 6620 5f5f 6974 6572 5f5f      def __iter__
-00009360: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00009370: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
-00009380: 2064 6566 205f 5f6e 6578 745f 5f28 7365   def __next__(se
-00009390: 6c66 293a 0a20 2020 2020 2020 2069 6620  lf):.        if 
-000093a0: 7365 6c66 2e69 6478 3d3d 303a 0a20 2020  self.idx==0:.   
-000093b0: 2020 2020 2020 2020 2073 656c 662e 6964           self.id
-000093c0: 783d 310a 2020 2020 2020 2020 2020 2020  x=1.            
-000093d0: 7265 7475 726e 2073 656c 662e 6d5b 305d  return self.m[0]
-000093e0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-000093f0: 6c66 2e69 6478 3d3d 313a 0a20 2020 2020  lf.idx==1:.     
-00009400: 2020 2020 2020 2073 656c 662e 6964 783d         self.idx=
-00009410: 320a 2020 2020 2020 2020 2020 2020 7265  2.            re
-00009420: 7475 726e 2073 656c 662e 6d5b 315d 0a20  turn self.m[1]. 
-00009430: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00009440: 2e69 6478 3d3d 323a 0a20 2020 2020 2020  .idx==2:.       
-00009450: 2020 2020 2073 656c 662e 6964 783d 330a       self.idx=3.
-00009460: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00009470: 726e 2073 656c 662e 6d5b 325d 0a20 2020  rn self.m[2].   
-00009480: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00009490: 2020 2020 2020 2072 6169 7365 2053 746f         raise Sto
-000094a0: 7049 7465 7261 7469 6f6e 0a0a 2320 6d61  pIteration..# ma
-000094b0: 7433 0a63 6465 6620 636c 6173 7320 6d61  t3.cdef class ma
-000094c0: 7433 3a0a 0a20 2020 2063 6465 6620 646f  t3:..    cdef do
-000094d0: 7562 6c65 206d 3131 2c20 6d31 322c 206d  uble m11, m12, m
-000094e0: 3133 0a20 2020 2063 6465 6620 646f 7562  13.    cdef doub
-000094f0: 6c65 206d 3231 2c20 6d32 322c 206d 3233  le m21, m22, m23
-00009500: 0a20 2020 2063 6465 6620 646f 7562 6c65  .    cdef double
-00009510: 206d 3331 2c20 6d33 322c 206d 3333 0a0a   m31, m32, m33..
-00009520: 2020 2020 6465 6620 5f5f 6369 6e69 745f      def __cinit_
-00009530: 5f28 7365 6c66 2c20 2a61 7267 7329 3a0a  _(self, *args):.
-00009540: 2020 2020 2020 2020 2222 2243 6f6e 7374          """Const
-00009550: 7275 6374 6f72 2e0a 0a20 2020 2020 2020  ructor...       
-00009560: 2054 6865 7265 2061 7265 2073 6576 6572   There are sever
-00009570: 616c 2070 6f73 7369 6269 6c69 7469 6573  al possibilities
-00009580: 2068 6f77 2074 6f20 696e 6974 6961 6c69   how to initiali
-00009590: 7a65 2061 206d 6174 7269 782c 0a20 2020  ze a matrix,.   
-000095a0: 2020 2020 2064 6570 656e 6469 6e67 206f       depending o
-000095b0: 6e20 7468 6520 6e75 6d62 6572 206f 6620  n the number of 
-000095c0: 6172 6775 6d65 6e74 7320 796f 7520 7072  arguments you pr
-000095d0: 6f76 6964 6520 746f 2074 6865 2063 6f6e  ovide to the con
-000095e0: 7374 7275 6374 6f72 2e0a 0a20 2020 2020  structor...     
-000095f0: 2020 202d 2030 2061 7267 756d 656e 7473     - 0 arguments
-00009600: 3a20 4576 6572 7920 636f 6d70 6f6e 656e  : Every componen
-00009610: 7420 6973 207a 6572 6f2e 0a20 2020 2020  t is zero..     
-00009620: 2020 202d 2031 206e 756d 6265 7220 6172     - 1 number ar
-00009630: 6775 6d65 6e74 3a20 5468 6520 6469 6167  gument: The diag
-00009640: 6f6e 616c 2069 7320 696e 6974 6961 6c69  onal is initiali
-00009650: 7a65 6420 746f 2074 6861 7420 6e75 6d62  zed to that numb
-00009660: 6572 2c0a 2020 2020 2020 2020 2020 616c  er,.          al
-00009670: 6c20 7468 6520 6f74 6865 7220 656c 656d  l the other elem
-00009680: 656e 7473 2061 7265 207a 6572 6f2e 0a20  ents are zero.. 
-00009690: 2020 2020 2020 202d 2031 2073 6571 7565         - 1 seque
-000096a0: 6e63 6520 6172 6775 6d65 6e74 3a20 5468  nce argument: Th
-000096b0: 6520 656c 656d 656e 7473 2061 7265 2069  e elements are i
-000096c0: 6e69 7469 616c 697a 6564 2077 6974 6820  nitialized with 
-000096d0: 7468 6520 6e75 6d62 6572 730a 2020 2020  the numbers.    
-000096e0: 2020 2020 2020 696e 2074 6865 2073 6571        in the seq
-000096f0: 7565 6e63 6520 2874 6865 2073 6571 7565  uence (the seque
-00009700: 6e63 6520 6d75 7374 2063 6f6e 7461 696e  nce must contain
-00009710: 2039 206e 756d 6265 7273 292e 0a20 2020   9 numbers)..   
-00009720: 2020 2020 202d 2031 206d 6174 3320 6172       - 1 mat3 ar
-00009730: 6775 6d65 6e74 3a20 5468 6520 6d61 7472  gument: The matr
-00009740: 6978 2069 7320 636f 7069 6564 2e0a 2020  ix is copied..  
-00009750: 2020 2020 2020 2d20 3320 7365 7175 656e        - 3 sequen
-00009760: 6365 2061 7267 756d 656e 7473 3a20 5468  ce arguments: Th
-00009770: 6520 636f 6c75 6d6e 7320 6172 6520 696e  e columns are in
-00009780: 6974 6961 6c69 7a65 6420 7769 7468 2074  itialized with t
-00009790: 6865 0a20 2020 2020 2020 2020 2072 6573  he.          res
-000097a0: 7065 6374 6976 6520 7365 7175 656e 6365  pective sequence
-000097b0: 2028 6561 6368 2073 6571 7565 6e63 6520   (each sequence 
-000097c0: 6d75 7374 2063 6f6e 7461 696e 2033 206e  must contain 3 n
-000097d0: 756d 6265 7273 292e 0a20 2020 2020 2020  umbers)..       
-000097e0: 202d 2039 206e 756d 6265 7220 6172 6775   - 9 number argu
-000097f0: 6d65 6e74 733a 2054 6865 206d 6174 7269  ments: The matri
-00009800: 7820 6973 2069 6e69 7469 616c 697a 6564  x is initialized
-00009810: 2077 6974 6820 7468 6f73 6520 7661 6c75   with those valu
-00009820: 6573 0a20 2020 2020 2020 2020 2028 726f  es.          (ro
-00009830: 772d 6d61 6a6f 7220 6f72 6465 7229 2e0a  w-major order)..
-00009840: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00009850: 2020 2020 6364 6566 2069 6e74 2061 7267      cdef int arg
-00009860: 6c65 6e0a 2020 2020 2020 2020 6364 6566  len.        cdef
-00009870: 206d 6174 3320 420a 2020 2020 2020 2020   mat3 B.        
-00009880: 6172 676c 656e 203d 206c 656e 2861 7267  arglen = len(arg
-00009890: 7329 0a0a 2020 2020 2020 2020 2320 4e6f  s)..        # No
-000098a0: 2061 7267 756d 656e 7473 0a20 2020 2020   arguments.     
-000098b0: 2020 2069 6620 6172 676c 656e 3d3d 303a     if arglen==0:
-000098c0: 0a20 2020 2020 2020 2020 2020 206d 3131  .            m11
-000098d0: 3d6d 3132 3d6d 3133 3d30 2e30 0a20 2020  =m12=m13=0.0.   
-000098e0: 2020 2020 2020 2020 206d 3231 3d6d 3232           m21=m22
-000098f0: 3d6d 3233 3d30 2e30 0a20 2020 2020 2020  =m23=0.0.       
-00009900: 2020 2020 206d 3331 3d6d 3332 3d6d 3333       m31=m32=m33
-00009910: 3d30 2e30 0a0a 2020 2020 2020 2020 2320  =0.0..        # 
-00009920: 3120 6172 6775 6d65 6e74 2028 6c69 7374  1 argument (list
-00009930: 2c20 7363 616c 6172 206f 7220 6d61 7433  , scalar or mat3
-00009940: 290a 2020 2020 2020 2020 656c 6966 2061  ).        elif a
-00009950: 7267 6c65 6e3d 3d31 3a0a 2020 2020 2020  rglen==1:.      
-00009960: 2020 2020 2020 5420 3d20 7479 7065 2861        T = type(a
-00009970: 7267 735b 305d 290a 2020 2020 2020 2020  rgs[0]).        
-00009980: 2020 2020 2320 7363 616c 6172 0a20 2020      # scalar.   
-00009990: 2020 2020 2020 2020 2069 6620 5420 6973           if T is
-000099a0: 2066 6c6f 6174 206f 7220 5420 6973 2069   float or T is i
-000099b0: 6e74 206f 7220 5420 6973 206c 6f6e 673a  nt or T is long:
-000099c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000099d0: 2073 656c 662e 6d31 3120 3d20 6172 6773   self.m11 = args
-000099e0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-000099f0: 2020 2020 7365 6c66 2e6d 3132 203d 2030      self.m12 = 0
-00009a00: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-00009a10: 2020 2073 656c 662e 6d31 3320 3d20 302e     self.m13 = 0.
-00009a20: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
-00009a30: 2020 7365 6c66 2e6d 3231 203d 2030 2e30    self.m21 = 0.0
-00009a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009a50: 2073 656c 662e 6d32 3220 3d20 7365 6c66   self.m22 = self
-00009a60: 2e6d 3131 0a20 2020 2020 2020 2020 2020  .m11.           
-00009a70: 2020 2020 2073 656c 662e 6d32 3320 3d20       self.m23 = 
-00009a80: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-00009a90: 2020 2020 7365 6c66 2e6d 3331 203d 2030      self.m31 = 0
-00009aa0: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-00009ab0: 2020 2073 656c 662e 6d33 3220 3d20 302e     self.m32 = 0.
-00009ac0: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
-00009ad0: 2020 7365 6c66 2e6d 3333 203d 2073 656c    self.m33 = sel
-00009ae0: 662e 6d31 310a 0a20 2020 2020 2020 2020  f.m11..         
-00009af0: 2020 2023 206d 6174 330a 2020 2020 2020     # mat3.      
-00009b00: 2020 2020 2020 656c 6966 2054 2069 7320        elif T is 
-00009b10: 6d61 7433 3a0a 2020 2020 2020 2020 2020  mat3:.          
-00009b20: 2020 2020 2020 4220 3d20 6172 6773 5b30        B = args[0
-00009b30: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00009b40: 2020 7365 6c66 2e6d 3131 203d 2042 2e6d    self.m11 = B.m
-00009b50: 3131 0a20 2020 2020 2020 2020 2020 2020  11.             
-00009b60: 2020 2073 656c 662e 6d31 3220 3d20 422e     self.m12 = B.
-00009b70: 6d31 320a 2020 2020 2020 2020 2020 2020  m12.            
-00009b80: 2020 2020 7365 6c66 2e6d 3133 203d 2042      self.m13 = B
-00009b90: 2e6d 3133 0a20 2020 2020 2020 2020 2020  .m13.           
-00009ba0: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
-00009bb0: 422e 6d32 310a 2020 2020 2020 2020 2020  B.m21.          
-00009bc0: 2020 2020 2020 7365 6c66 2e6d 3232 203d        self.m22 =
-00009bd0: 2042 2e6d 3232 0a20 2020 2020 2020 2020   B.m22.         
-00009be0: 2020 2020 2020 2073 656c 662e 6d32 3320         self.m23 
-00009bf0: 3d20 422e 6d32 330a 2020 2020 2020 2020  = B.m23.        
-00009c00: 2020 2020 2020 2020 7365 6c66 2e6d 3331          self.m31
-00009c10: 203d 2042 2e6d 3331 0a20 2020 2020 2020   = B.m31.       
-00009c20: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
-00009c30: 3220 3d20 422e 6d33 320a 2020 2020 2020  2 = B.m32.      
-00009c40: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00009c50: 3333 203d 2042 2e6d 3333 0a20 2020 2020  33 = B.m33.     
-00009c60: 2020 2020 2020 2023 2053 7472 696e 670a         # String.
-00009c70: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00009c80: 2054 2069 7320 7374 7220 6f72 2054 2069   T is str or T i
-00009c90: 7320 756e 6963 6f64 653a 0a20 2020 2020  s unicode:.     
-00009ca0: 2020 2020 2020 2020 2020 2073 3d61 7267             s=arg
-00009cb0: 735b 305d 2e72 6570 6c61 6365 2822 2c22  s[0].replace(","
-00009cc0: 2c22 2022 292e 7265 706c 6163 6528 2220  ," ").replace(" 
-00009cd0: 2022 2c22 2022 292e 7374 7269 7028 292e   "," ").strip().
-00009ce0: 7370 6c69 7428 2220 2229 0a20 2020 2020  split(" ").     
-00009cf0: 2020 2020 2020 2020 2020 2069 6620 733d             if s=
-00009d00: 3d5b 2222 5d3a 0a20 2020 2020 2020 2020  =[""]:.         
-00009d10: 2020 2020 2020 2020 2020 2073 3d5b 5d0a             s=[].
-00009d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d30: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
-00009d40: 656e 2873 2929 3a0a 2020 2020 2020 2020  en(s)):.        
-00009d50: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-00009d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009d70: 2020 2020 2020 2020 2073 5b69 5d20 3d20           s[i] = 
-00009d80: 666c 6f61 7428 735b 695d 290a 2020 2020  float(s[i]).    
-00009d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009da0: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
-00009db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009dc0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00009dd0: 2c22 6d61 7433 2829 2061 7267 2069 7320  ,"mat3() arg is 
-00009de0: 6120 6d61 6c66 6f72 6d65 6420 7374 7269  a malformed stri
-00009df0: 6e67 220a 2020 2020 2020 2020 2020 2020  ng".            
-00009e00: 2020 2020 4220 3d20 6d61 7433 2873 290a      B = mat3(s).
-00009e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e20: 7365 6c66 2e6d 3131 203d 2042 2e6d 3131  self.m11 = B.m11
-00009e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009e40: 2073 656c 662e 6d31 3220 3d20 422e 6d31   self.m12 = B.m1
-00009e50: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
-00009e60: 2020 7365 6c66 2e6d 3133 203d 2042 2e6d    self.m13 = B.m
-00009e70: 3133 0a20 2020 2020 2020 2020 2020 2020  13.             
-00009e80: 2020 2073 656c 662e 6d32 3120 3d20 422e     self.m21 = B.
-00009e90: 6d32 310a 2020 2020 2020 2020 2020 2020  m21.            
-00009ea0: 2020 2020 7365 6c66 2e6d 3232 203d 2042      self.m22 = B
-00009eb0: 2e6d 3232 0a20 2020 2020 2020 2020 2020  .m22.           
-00009ec0: 2020 2020 2073 656c 662e 6d32 3320 3d20       self.m23 = 
-00009ed0: 422e 6d32 330a 2020 2020 2020 2020 2020  B.m23.          
-00009ee0: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
-00009ef0: 2042 2e6d 3331 0a20 2020 2020 2020 2020   B.m31.         
-00009f00: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
-00009f10: 3d20 422e 6d33 320a 2020 2020 2020 2020  = B.m32.        
-00009f20: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
-00009f30: 203d 2042 2e6d 3333 0a20 2020 2020 2020   = B.m33.       
-00009f40: 2020 2020 2023 2053 6571 7565 6e63 6520       # Sequence 
-00009f50: 6f66 2039 2066 6c6f 6174 730a 2020 2020  of 9 floats.    
-00009f60: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00009f70: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00009f80: 7120 3d20 6172 6773 5b30 5d0a 2020 2020  q = args[0].    
-00009f90: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-00009fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009fb0: 2020 2020 2073 6571 6c65 6e20 3d20 6c65       seqlen = le
-00009fc0: 6e28 7365 7129 0a20 2020 2020 2020 2020  n(seq).         
-00009fd0: 2020 2020 2020 2065 7863 6570 743a 0a20         except:. 
-00009fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009ff0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-0000a000: 6f72 2c22 6d61 7433 2829 2061 7267 2063  or,"mat3() arg c
-0000a010: 616e 2774 2062 6520 636f 6e76 6572 7465  an't be converte
-0000a020: 6420 746f 206d 6174 3322 0a0a 2020 2020  d to mat3"..    
-0000a030: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0000a040: 6571 6c65 6e3d 3d39 3a0a 2020 2020 2020  eqlen==9:.      
-0000a050: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000a060: 6c66 2e6d 3131 203d 2073 6571 5b30 5d0a  lf.m11 = seq[0].
-0000a070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a080: 2020 2020 7365 6c66 2e6d 3132 203d 2073      self.m12 = s
-0000a090: 6571 5b31 5d0a 2020 2020 2020 2020 2020  eq[1].          
-0000a0a0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000a0b0: 3133 203d 2073 6571 5b32 5d0a 2020 2020  13 = seq[2].    
-0000a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0d0: 7365 6c66 2e6d 3231 203d 2073 6571 5b33  self.m21 = seq[3
-0000a0e0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0000a0f0: 2020 2020 2020 7365 6c66 2e6d 3232 203d        self.m22 =
-0000a100: 2073 6571 5b34 5d0a 2020 2020 2020 2020   seq[4].        
-0000a110: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000a120: 2e6d 3233 203d 2073 6571 5b35 5d0a 2020  .m23 = seq[5].  
-0000a130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a140: 2020 7365 6c66 2e6d 3331 203d 2073 6571    self.m31 = seq
-0000a150: 5b36 5d0a 2020 2020 2020 2020 2020 2020  [6].            
-0000a160: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
-0000a170: 203d 2073 6571 5b37 5d0a 2020 2020 2020   = seq[7].      
-0000a180: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000a190: 6c66 2e6d 3333 203d 2073 6571 5b38 5d0a  lf.m33 = seq[8].
-0000a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1b0: 656c 6966 2073 6571 6c65 6e3d 3d33 3a0a  elif seqlen==3:.
-0000a1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1d0: 2020 2020 6220 3d20 7365 715b 305d 0a20      b = seq[0]. 
+00005c00: 7365 7120 3d20 6172 6773 5b30 5d0a 2020  seq = args[0].  
+00005c10: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00005c20: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00005c30: 2020 2020 2020 2073 6571 6c65 6e20 3d20         seqlen = 
+00005c40: 6c65 6e28 7365 7129 0a20 2020 2020 2020  len(seq).       
+00005c50: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+00005c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005c70: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00005c80: 7272 6f72 2c22 7665 6334 2829 2061 7267  rror,"vec4() arg
+00005c90: 2063 616e 2774 2062 6520 636f 6e76 6572   can't be conver
+00005ca0: 7465 6420 746f 2076 6563 3422 0a0a 2020  ted to vec4"..  
+00005cb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00005cc0: 2073 6571 6c65 6e3d 3d34 3a0a 2020 2020   seqlen==4:.    
+00005cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ce0: 7365 6c66 2e78 203d 2073 6571 5b30 5d0a  self.x = seq[0].
+00005cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d00: 2020 2020 7365 6c66 2e79 203d 2073 6571      self.y = seq
+00005d10: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00005d20: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
+00005d30: 2073 6571 5b32 5d0a 2020 2020 2020 2020   seq[2].        
+00005d40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005d50: 2e77 203d 2073 6571 5b33 5d0a 2020 2020  .w = seq[3].    
+00005d60: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00005d70: 2073 6571 6c65 6e3d 3d33 3a0a 2020 2020   seqlen==3:.    
+00005d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d90: 7365 6c66 2e78 203d 2073 6571 5b30 5d0a  self.x = seq[0].
+00005da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005db0: 2020 2020 7365 6c66 2e79 203d 2073 6571      self.y = seq
+00005dc0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00005dd0: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
+00005de0: 2073 6571 5b32 5d0a 2020 2020 2020 2020   seq[2].        
+00005df0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005e00: 2e77 203d 2030 2e30 0a20 2020 2020 2020  .w = 0.0.       
+00005e10: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+00005e20: 716c 656e 3d3d 323a 0a20 2020 2020 2020  qlen==2:.       
+00005e30: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00005e40: 662e 7820 3d20 7365 715b 305d 0a20 2020  f.x = seq[0].   
+00005e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005e60: 2073 656c 662e 7920 3d20 7365 715b 315d   self.y = seq[1]
+00005e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005e80: 2020 2020 2073 656c 662e 7a20 3d20 302e       self.z = 0.
+00005e90: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+00005ea0: 2020 2020 2020 7365 6c66 2e77 203d 2030        self.w = 0
+00005eb0: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
+00005ec0: 2020 2065 6c69 6620 7365 716c 656e 3d3d     elif seqlen==
+00005ed0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+00005ee0: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
+00005ef0: 7365 715b 305d 0a20 2020 2020 2020 2020  seq[0].         
+00005f00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005f10: 7920 3d20 7365 6c66 2e78 0a20 2020 2020  y = self.x.     
+00005f20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00005f30: 656c 662e 7a20 3d20 7365 6c66 2e78 0a20  elf.z = self.x. 
+00005f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f50: 2020 2073 656c 662e 7720 3d20 7365 6c66     self.w = self
+00005f60: 2e78 0a20 2020 2020 2020 2020 2020 2020  .x.             
+00005f70: 2020 2065 6c69 6620 7365 716c 656e 3d3d     elif seqlen==
+00005f80: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+00005f90: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
+00005fa0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
+00005fb0: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
+00005fc0: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
+00005fd0: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
+00005fe0: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
+00005ff0: 2020 2020 2020 2020 2020 7365 6c66 2e77            self.w
+00006000: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
+00006010: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00006020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006030: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00006040: 2c20 2276 6563 3428 2920 7461 6b65 7320  , "vec4() takes 
+00006050: 6174 206d 6f73 7420 3420 6172 6775 6d65  at most 4 argume
+00006060: 6e74 7322 0a0a 2020 2020 2020 2020 656c  nts"..        el
+00006070: 6966 2061 7267 6c65 6e3d 3d32 3a0a 2020  if arglen==2:.  
+00006080: 2020 2020 2020 2020 2020 7365 6c66 2e78            self.x
+00006090: 203d 2061 7267 735b 305d 0a20 2020 2020   = args[0].     
+000060a0: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
+000060b0: 6172 6773 5b31 5d0a 2020 2020 2020 2020  args[1].        
+000060c0: 2020 2020 7365 6c66 2e7a 203d 2030 2e30      self.z = 0.0
+000060d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000060e0: 662e 7720 3d20 302e 300a 0a20 2020 2020  f.w = 0.0..     
+000060f0: 2020 2065 6c69 6620 6172 676c 656e 3d3d     elif arglen==
+00006100: 333a 0a20 2020 2020 2020 2020 2020 2073  3:.            s
+00006110: 656c 662e 7820 3d20 6172 6773 5b30 5d0a  elf.x = args[0].
+00006120: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00006130: 2e79 203d 2061 7267 735b 315d 0a20 2020  .y = args[1].   
+00006140: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
+00006150: 3d20 6172 6773 5b32 5d0a 2020 2020 2020  = args[2].      
+00006160: 2020 2020 2020 7365 6c66 2e77 203d 2030        self.w = 0
+00006170: 2e30 0a0a 2020 2020 2020 2020 656c 6966  .0..        elif
+00006180: 2061 7267 6c65 6e3d 3d34 3a0a 2020 2020   arglen==4:.    
+00006190: 2020 2020 2020 2020 7365 6c66 2e78 203d          self.x =
+000061a0: 2061 7267 735b 305d 0a20 2020 2020 2020   args[0].       
+000061b0: 2020 2020 2073 656c 662e 7920 3d20 6172       self.y = ar
+000061c0: 6773 5b31 5d0a 2020 2020 2020 2020 2020  gs[1].          
+000061d0: 2020 7365 6c66 2e7a 203d 2061 7267 735b    self.z = args[
+000061e0: 325d 0a20 2020 2020 2020 2020 2020 2073  2].            s
+000061f0: 656c 662e 7720 3d20 6172 6773 5b33 5d0a  elf.w = args[3].
+00006200: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00006210: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00006220: 2054 7970 6545 7272 6f72 2c20 2276 6563   TypeError, "vec
+00006230: 3428 2920 7461 6b65 7320 6174 206d 6f73  4() takes at mos
+00006240: 7420 3420 6172 6775 6d65 6e74 7322 0a0a  t 4 arguments"..
+00006250: 2020 2020 6465 6620 5f5f 7265 6475 6365      def __reduce
+00006260: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+00006270: 2020 7265 7475 726e 2028 5f76 6563 3463    return (_vec4c
+00006280: 6f6e 7374 7275 6374 2c20 2873 656c 662e  onstruct, (self.
+00006290: 782c 2073 656c 662e 792c 2073 656c 662e  x, self.y, self.
+000062a0: 7a2c 2073 656c 662e 7729 290a 0a20 2020  z, self.w))..   
+000062b0: 2064 6566 205f 5f72 6570 725f 5f28 7365   def __repr__(se
+000062c0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+000062d0: 7572 6e20 2776 6563 3428 2573 2c20 2573  urn 'vec4(%s, %s
+000062e0: 2c20 2573 2c20 2573 2927 2528 7265 7072  , %s, %s)'%(repr
+000062f0: 2873 656c 662e 7829 2c72 6570 7228 7365  (self.x),repr(se
+00006300: 6c66 2e79 292c 7265 7072 2873 656c 662e  lf.y),repr(self.
+00006310: 7a29 2c72 6570 7228 7365 6c66 2e77 2929  z),repr(self.w))
+00006320: 0a0a 2020 2020 6465 6620 5f5f 7374 725f  ..    def __str_
+00006330: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00006340: 2072 6574 7572 6e20 2228 2531 2e34 662c   return "(%1.4f,
+00006350: 2025 312e 3466 2c20 2531 2e34 662c 2025   %1.4f, %1.4f, %
+00006360: 312e 3466 2922 2528 7365 6c66 2e78 2c20  1.4f)"%(self.x, 
+00006370: 7365 6c66 2e79 2c20 7365 6c66 2e7a 2c20  self.y, self.z, 
+00006380: 7365 6c66 2e77 290a 0a20 2020 2064 6566  self.w)..    def
+00006390: 205f 5f69 7465 725f 5f28 7365 6c66 293a   __iter__(self):
+000063a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000063b0: 7665 6334 6974 6572 2873 656c 6629 0a0a  vec4iter(self)..
+000063c0: 2020 2020 6465 6620 5f5f 7269 6368 636d      def __richcm
+000063d0: 705f 5f28 612c 622c 6f70 293a 0a20 2020  p__(a,b,op):.   
+000063e0: 2020 2020 2063 6465 6620 7665 6334 2076       cdef vec4 v
+000063f0: 612c 2076 620a 2020 2020 2020 2020 6364  a, vb.        cd
+00006400: 6566 2069 6e74 2063 6f70 0a0a 2020 2020  ef int cop..    
+00006410: 2020 2020 636f 7020 3d20 6f70 0a0a 2020      cop = op..  
+00006420: 2020 2020 2020 7461 203d 2074 7970 6528        ta = type(
+00006430: 6129 0a20 2020 2020 2020 2074 6220 3d20  a).        tb = 
+00006440: 7479 7065 2862 290a 2020 2020 2020 2020  type(b).        
+00006450: 6966 2028 7461 213d 7665 6334 206f 7220  if (ta!=vec4 or 
+00006460: 7462 213d 7665 6334 293a 0a20 2020 2020  tb!=vec4):.     
+00006470: 2020 2020 2020 2069 6620 636f 703d 3d33         if cop==3
+00006480: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006490: 2020 7265 7475 726e 2031 0a20 2020 2020    return 1.     
+000064a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000064b0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+000064c0: 7572 6e20 300a 0a20 2020 2020 2020 2076  urn 0..        v
+000064d0: 6120 3d20 610a 2020 2020 2020 2020 7662  a = a.        vb
+000064e0: 203d 2062 0a0a 2020 2020 2020 2020 2320   = b..        # 
+000064f0: 3c0a 2020 2020 2020 2020 6966 2063 6f70  <.        if cop
+00006500: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
+00006510: 2072 6574 7572 6e20 2876 612e 783c 7662   return (va.x<vb
+00006520: 2e78 2061 6e64 2076 612e 793c 7662 2e79  .x and va.y<vb.y
+00006530: 2061 6e64 2076 612e 7a3c 7662 2e7a 2061   and va.z<vb.z a
+00006540: 6e64 2076 612e 773c 7662 2e77 290a 2020  nd va.w<vb.w).  
+00006550: 2020 2020 2020 2320 3c3d 0a20 2020 2020        # <=.     
+00006560: 2020 2065 6c69 6620 636f 703d 3d31 3a0a     elif cop==1:.
+00006570: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00006580: 726e 2028 7661 2e78 2d65 7073 3c3d 7662  rn (va.x-eps<=vb
+00006590: 2e78 2061 6e64 2076 612e 792d 6570 733c  .x and va.y-eps<
+000065a0: 3d76 622e 7920 616e 6420 7661 2e7a 2d65  =vb.y and va.z-e
+000065b0: 7073 3c3d 7662 2e7a 2061 6e64 2076 612e  ps<=vb.z and va.
+000065c0: 772d 6570 733c 3d76 622e 7729 0a20 2020  w-eps<=vb.w).   
+000065d0: 2020 2020 2023 203d 3d0a 2020 2020 2020       # ==.      
+000065e0: 2020 656c 6966 2063 6f70 3d3d 323a 0a20    elif cop==2:. 
+000065f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00006600: 6e20 2866 6162 7328 7661 2e78 2d76 622e  n (fabs(va.x-vb.
+00006610: 7829 3c3d 6570 7320 616e 6420 6661 6273  x)<=eps and fabs
+00006620: 2876 612e 792d 7662 2e79 293c 3d65 7073  (va.y-vb.y)<=eps
+00006630: 2061 6e64 2066 6162 7328 7661 2e7a 2d76   and fabs(va.z-v
+00006640: 622e 7a29 3c3d 6570 7320 616e 6420 6661  b.z)<=eps and fa
+00006650: 6273 2876 612e 772d 7662 2e77 293c 3d65  bs(va.w-vb.w)<=e
+00006660: 7073 290a 2020 2020 2020 2020 2320 213d  ps).        # !=
+00006670: 0a20 2020 2020 2020 2065 6c69 6620 636f  .        elif co
+00006680: 703d 3d33 3a0a 2020 2020 2020 2020 2020  p==3:.          
+00006690: 2020 7265 7475 726e 2028 6661 6273 2876    return (fabs(v
+000066a0: 612e 782d 7662 2e78 293e 6570 7320 6f72  a.x-vb.x)>eps or
+000066b0: 2066 6162 7328 7661 2e79 2d76 622e 7929   fabs(va.y-vb.y)
+000066c0: 3e65 7073 2061 6e64 2066 6162 7328 7661  >eps and fabs(va
+000066d0: 2e7a 2d76 622e 7a29 3e65 7073 2061 6e64  .z-vb.z)>eps and
+000066e0: 2066 6162 7328 7661 2e77 2d76 622e 7729   fabs(va.w-vb.w)
+000066f0: 3e65 7073 290a 2020 2020 2020 2020 2320  >eps).        # 
+00006700: 3e0a 2020 2020 2020 2020 656c 6966 2063  >.        elif c
+00006710: 6f70 3d3d 343a 0a20 2020 2020 2020 2020  op==4:.         
+00006720: 2020 2072 6574 7572 6e20 2876 612e 783e     return (va.x>
+00006730: 7662 2e78 2061 6e64 2076 612e 793e 7662  vb.x and va.y>vb
+00006740: 2e79 2061 6e64 2076 612e 7a3e 7662 2e7a  .y and va.z>vb.z
+00006750: 2061 6e64 2076 612e 773e 7662 2e77 290a   and va.w>vb.w).
+00006760: 2020 2020 2020 2020 2320 3e3d 0a20 2020          # >=.   
+00006770: 2020 2020 2065 6c69 6620 636f 703d 3d35       elif cop==5
+00006780: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00006790: 7475 726e 2028 7661 2e78 2b65 7073 3e3d  turn (va.x+eps>=
+000067a0: 7662 2e78 2061 6e64 2076 612e 792b 6570  vb.x and va.y+ep
+000067b0: 733e 3d76 622e 7920 616e 6420 7661 2e7a  s>=vb.y and va.z
+000067c0: 2b65 7073 3e3d 7662 2e7a 2061 6e64 2076  +eps>=vb.z and v
+000067d0: 612e 772b 6570 733e 3d76 622e 7729 0a20  a.w+eps>=vb.w). 
+000067e0: 2020 2020 2020 2023 2073 6f6e 7374 2028         # sonst (
+000067f0: 4665 686c 6572 290a 2020 2020 2020 2020  Fehler).        
+00006800: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00006810: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00006820: 6f72 2c22 696e 7465 726e 616c 2065 7272  or,"internal err
+00006830: 6f72 3a20 696c 6c65 6761 6c20 7269 6368  or: illegal rich
+00006840: 2063 6f6d 7061 7269 736f 6e20 6e75 6d62   comparison numb
+00006850: 6572 220a 0a20 2020 2064 6566 205f 5f61  er"..    def __a
+00006860: 6464 5f5f 2876 6563 3420 612c 2076 6563  dd__(vec4 a, vec
+00006870: 3420 6229 3a0a 2020 2020 2020 2020 2222  4 b):.        ""
+00006880: 2256 6563 746f 7220 6164 6469 7469 6f6e  "Vector addition
+00006890: 2e0a 0a20 2020 2020 2020 203e 3e3e 2061  ...        >>> a
+000068a0: 3d76 6563 3428 312e 302c 2030 2e35 2c20  =vec4(1.0, 0.5, 
+000068b0: 2d31 2e38 2c20 302e 3229 0a20 2020 2020  -1.8, 0.2).     
+000068c0: 2020 203e 3e3e 2062 3d76 6563 3428 2d30     >>> b=vec4(-0
+000068d0: 2e33 2c20 302e 3735 2c20 302e 352c 2030  .3, 0.75, 0.5, 0
+000068e0: 2e33 290a 2020 2020 2020 2020 3e3e 3e20  .3).        >>> 
+000068f0: 7072 696e 7420 612b 620a 2020 2020 2020  print a+b.      
+00006900: 2020 2830 2e37 3030 302c 2031 2e32 3530    (0.7000, 1.250
+00006910: 302c 202d 312e 3330 3030 2c20 302e 3530  0, -1.3000, 0.50
+00006920: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
+00006930: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
+00006940: 3420 7265 730a 2020 2020 2020 2020 7265  4 res.        re
+00006950: 7320 3d20 7665 6334 2829 0a20 2020 2020  s = vec4().     
+00006960: 2020 2072 6573 2e78 203d 2061 2e78 2b62     res.x = a.x+b
+00006970: 2e78 0a20 2020 2020 2020 2072 6573 2e79  .x.        res.y
+00006980: 203d 2061 2e79 2b62 2e79 0a20 2020 2020   = a.y+b.y.     
+00006990: 2020 2072 6573 2e7a 203d 2061 2e7a 2b62     res.z = a.z+b
+000069a0: 2e7a 0a20 2020 2020 2020 2072 6573 2e77  .z.        res.w
+000069b0: 203d 2061 2e77 2b62 2e77 0a20 2020 2020   = a.w+b.w.     
+000069c0: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
+000069d0: 2020 2064 6566 205f 5f73 7562 5f5f 2876     def __sub__(v
+000069e0: 6563 3420 612c 2076 6563 3420 6229 3a0a  ec4 a, vec4 b):.
+000069f0: 2020 2020 2020 2020 2222 2256 6563 746f          """Vecto
+00006a00: 7220 7375 6274 7261 6374 696f 6e2e 0a0a  r subtraction...
+00006a10: 2020 2020 2020 2020 3e3e 3e20 613d 7665          >>> a=ve
+00006a20: 6334 2831 2e30 2c20 302e 352c 202d 312e  c4(1.0, 0.5, -1.
+00006a30: 382c 2030 2e32 290a 2020 2020 2020 2020  8, 0.2).        
+00006a40: 3e3e 3e20 623d 7665 6334 282d 302e 332c  >>> b=vec4(-0.3,
+00006a50: 2030 2e37 352c 2030 2e35 2c20 302e 3329   0.75, 0.5, 0.3)
+00006a60: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00006a70: 6e74 2061 2d62 0a20 2020 2020 2020 2028  nt a-b.        (
+00006a80: 312e 3330 3030 2c20 2d30 2e32 3530 302c  1.3000, -0.2500,
+00006a90: 202d 322e 3330 3030 2c20 2d30 2e31 3030   -2.3000, -0.100
+00006aa0: 3029 0a20 2020 2020 2020 2022 2222 0a20  0).        """. 
+00006ab0: 2020 2020 2020 2063 6465 6620 7665 6334         cdef vec4
+00006ac0: 2072 6573 0a20 2020 2020 2020 2072 6573   res.        res
+00006ad0: 203d 2076 6563 3428 290a 2020 2020 2020   = vec4().      
+00006ae0: 2020 7265 732e 7820 3d20 612e 782d 622e    res.x = a.x-b.
+00006af0: 780a 2020 2020 2020 2020 7265 732e 7920  x.        res.y 
+00006b00: 3d20 612e 792d 622e 790a 2020 2020 2020  = a.y-b.y.      
+00006b10: 2020 7265 732e 7a20 3d20 612e 7a2d 622e    res.z = a.z-b.
+00006b20: 7a0a 2020 2020 2020 2020 7265 732e 7720  z.        res.w 
+00006b30: 3d20 612e 772d 622e 770a 2020 2020 2020  = a.w-b.w.      
+00006b40: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
+00006b50: 2020 6465 6620 5f5f 6d75 6c5f 5f28 612c    def __mul__(a,
+00006b60: 2062 293a 0a20 2020 2020 2020 2022 2222   b):.        """
+00006b70: 4d75 6c74 6970 6c69 6361 7469 6f6e 2077  Multiplication w
+00006b80: 6974 6820 6120 7363 616c 6172 206f 7220  ith a scalar or 
+00006b90: 646f 7420 7072 6f64 7563 742e 0a0a 2020  dot product...  
+00006ba0: 2020 2020 2020 3e3e 3e20 613d 7665 6334        >>> a=vec4
+00006bb0: 2831 2e30 2c20 302e 352c 202d 312e 382c  (1.0, 0.5, -1.8,
+00006bc0: 2030 2e32 290a 2020 2020 2020 2020 3e3e   0.2).        >>
+00006bd0: 3e20 623d 7665 6334 282d 302e 332c 2030  > b=vec4(-0.3, 0
+00006be0: 2e37 352c 2030 2e35 2c20 302e 3329 0a20  .75, 0.5, 0.3). 
+00006bf0: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+00006c00: 2061 2a32 2e30 0a20 2020 2020 2020 2028   a*2.0.        (
+00006c10: 322e 3030 3030 2c20 312e 3030 3030 2c20  2.0000, 1.0000, 
+00006c20: 2d33 2e36 3030 302c 2030 2e34 3030 3029  -3.6000, 0.4000)
+00006c30: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00006c40: 6e74 2032 2e30 2a61 0a20 2020 2020 2020  nt 2.0*a.       
+00006c50: 2028 322e 3030 3030 2c20 312e 3030 3030   (2.0000, 1.0000
+00006c60: 2c20 2d33 2e36 3030 302c 2030 2e34 3030  , -3.6000, 0.400
+00006c70: 3029 0a20 2020 2020 2020 203e 3e3e 2070  0).        >>> p
+00006c80: 7269 6e74 2061 2a62 0a20 2020 2020 2020  rint a*b.       
+00006c90: 202d 302e 3736 350a 2020 2020 2020 2020   -0.765.        
+00006ca0: 2222 220a 0a20 2020 2020 2020 2063 6465  """..        cde
+00006cb0: 6620 7665 6334 2072 6573 2c20 7661 2c20  f vec4 res, va, 
+00006cc0: 7662 0a20 2020 2020 2020 2063 6465 6620  vb.        cdef 
+00006cd0: 646f 7562 6c65 2072 0a0a 2020 2020 2020  double r..      
+00006ce0: 2020 7461 203d 2074 7970 6528 6129 0a20    ta = type(a). 
+00006cf0: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
+00006d00: 2862 290a 0a20 2020 2020 2020 2069 6620  (b)..        if 
+00006d10: 7461 2069 7320 7665 6334 3a0a 2020 2020  ta is vec4:.    
+00006d20: 2020 2020 2020 2020 7661 203d 2061 0a20          va = a. 
+00006d30: 2020 2020 2020 2020 2020 2069 6620 7462             if tb
+00006d40: 2069 7320 7665 6334 3a0a 2020 2020 2020   is vec4:.      
+00006d50: 2020 2020 2020 2020 2020 2320 7665 6334            # vec4
+00006d60: 2a76 6563 3420 2020 2864 6f74 2070 726f  *vec4   (dot pro
+00006d70: 6475 6374 2061 2a62 290a 2020 2020 2020  duct a*b).      
+00006d80: 2020 2020 2020 2020 2020 7662 203d 2062            vb = b
+00006d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006da0: 2072 6574 7572 6e20 7661 2e78 2a76 622e   return va.x*vb.
+00006db0: 7820 2b20 7661 2e79 2a76 622e 7920 2b20  x + va.y*vb.y + 
+00006dc0: 7661 2e7a 2a76 622e 7a20 2b20 7661 2e77  va.z*vb.z + va.w
+00006dd0: 2a76 622e 770a 2020 2020 2020 2020 2020  *vb.w.          
+00006de0: 2020 656c 6966 2074 6220 6973 2066 6c6f    elif tb is flo
+00006df0: 6174 206f 7220 7462 2069 7320 696e 7420  at or tb is int 
+00006e00: 6f72 2074 6220 6973 206c 6f6e 673a 0a20  or tb is long:. 
+00006e10: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00006e20: 2076 6563 342a 7363 616c 6172 0a20 2020   vec4*scalar.   
+00006e30: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00006e40: 203d 2076 6563 3428 290a 2020 2020 2020   = vec4().      
+00006e50: 2020 2020 2020 2020 2020 7220 2020 3d20            r   = 
+00006e60: 620a 2020 2020 2020 2020 2020 2020 2020  b.              
+00006e70: 2020 7265 732e 7820 3d20 7661 2e78 2a72    res.x = va.x*r
+00006e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006e90: 2072 6573 2e79 203d 2076 612e 792a 720a   res.y = va.y*r.
+00006ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006eb0: 7265 732e 7a20 3d20 7661 2e7a 2a72 0a20  res.z = va.z*r. 
+00006ec0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00006ed0: 6573 2e77 203d 2076 612e 772a 720a 2020  es.w = va.w*r.  
+00006ee0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00006ef0: 7475 726e 2072 6573 0a20 2020 2020 2020  turn res.       
+00006f00: 2020 2020 2065 6c69 6620 7462 2069 7320       elif tb is 
+00006f10: 6d61 7434 3a0a 2020 2020 2020 2020 2020  mat4:.          
+00006f20: 2020 2020 2020 2320 7665 6334 2a6d 6174        # vec4*mat
+00006f30: 340a 2020 2020 2020 2020 2020 2020 2020  4.              
+00006f40: 2020 7265 7475 726e 2062 2e5f 5f72 6d75    return b.__rmu
+00006f50: 6c5f 5f28 6129 0a20 2020 2020 2020 2065  l__(a).        e
+00006f60: 6c69 6620 7461 2069 7320 666c 6f61 7420  lif ta is float 
+00006f70: 6f72 2074 6120 6973 2069 6e74 206f 7220  or ta is int or 
+00006f80: 7461 2069 7320 6c6f 6e67 3a0a 2020 2020  ta is long:.    
+00006f90: 2020 2020 2020 2020 6966 2074 6220 6973          if tb is
+00006fa0: 2076 6563 343a 0a20 2020 2020 2020 2020   vec4:.         
+00006fb0: 2020 2020 2020 2023 2073 6361 6c61 722a         # scalar*
+00006fc0: 7665 6334 0a20 2020 2020 2020 2020 2020  vec4.           
+00006fd0: 2020 2020 2072 6573 203d 2076 6563 3428       res = vec4(
+00006fe0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00006ff0: 2020 7662 2020 3d20 620a 2020 2020 2020    vb  = b.      
+00007000: 2020 2020 2020 2020 2020 7220 2020 3d20            r   = 
+00007010: 610a 2020 2020 2020 2020 2020 2020 2020  a.              
+00007020: 2020 7265 732e 7820 3d20 722a 7662 2e78    res.x = r*vb.x
+00007030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007040: 2072 6573 2e79 203d 2072 2a76 622e 790a   res.y = r*vb.y.
+00007050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007060: 7265 732e 7a20 3d20 722a 7662 2e7a 0a20  res.z = r*vb.z. 
+00007070: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00007080: 6573 2e77 203d 2072 2a76 622e 770a 2020  es.w = r*vb.w.  
+00007090: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000070a0: 7475 726e 2072 6573 0a0a 2020 2020 2020  turn res..      
+000070b0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+000070c0: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
+000070d0: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
+000070e0: 202a 220a 0a20 2020 2064 6566 205f 5f64   *"..    def __d
+000070f0: 6976 5f5f 2876 6563 3420 612c 2062 293a  iv__(vec4 a, b):
+00007100: 0a20 2020 2020 2020 2023 2050 7974 686f  .        # Pytho
+00007110: 6e20 320a 2020 2020 2020 2020 7265 7475  n 2.        retu
+00007120: 726e 2076 6563 342e 5f5f 7472 7565 6469  rn vec4.__truedi
+00007130: 765f 5f28 612c 6229 0a0a 2020 2020 6465  v__(a,b)..    de
+00007140: 6620 5f5f 7472 7565 6469 765f 5f28 7665  f __truediv__(ve
+00007150: 6334 2061 2c20 6229 3a0a 2020 2020 2020  c4 a, b):.      
+00007160: 2020 2222 2244 6976 6973 696f 6e20 6279    """Division by
+00007170: 2073 6361 6c61 722e 0a0a 2020 2020 2020   scalar...      
+00007180: 2020 3e3e 3e20 613d 7665 6334 2831 2e30    >>> a=vec4(1.0
+00007190: 2c20 302e 352c 202d 312e 382c 2030 2e32  , 0.5, -1.8, 0.2
+000071a0: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
+000071b0: 696e 7420 612f 322e 300a 2020 2020 2020  int a/2.0.      
+000071c0: 2020 2830 2e35 3030 302c 2030 2e32 3530    (0.5000, 0.250
+000071d0: 302c 202d 302e 3930 3030 2c20 302e 3130  0, -0.9000, 0.10
+000071e0: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
+000071f0: 0a20 2020 2020 2020 2063 6465 6620 7665  .        cdef ve
+00007200: 6334 2072 6573 0a20 2020 2020 2020 2063  c4 res.        c
+00007210: 6465 6620 646f 7562 6c65 2072 0a0a 2020  def double r..  
+00007220: 2020 2020 2020 7462 203d 2074 7970 6528        tb = type(
+00007230: 6229 0a0a 2020 2020 2020 2020 6966 2074  b)..        if t
+00007240: 6220 6973 2066 6c6f 6174 206f 7220 7462  b is float or tb
+00007250: 2069 7320 696e 7420 6f72 2074 6220 6973   is int or tb is
+00007260: 206c 6f6e 673a 0a20 2020 2020 2020 2020   long:.         
+00007270: 2020 2023 2076 6563 342f 7363 616c 6172     # vec4/scalar
+00007280: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00007290: 203d 2076 6563 3428 290a 2020 2020 2020   = vec4().      
+000072a0: 2020 2020 2020 7220 3d20 620a 2020 2020        r = b.    
+000072b0: 2020 2020 2020 2020 6966 2066 6162 7328          if fabs(
+000072c0: 7229 3c3d 6570 733a 0a20 2020 2020 2020  r)<=eps:.       
+000072d0: 2020 2020 2020 2020 2072 6169 7365 205a           raise Z
+000072e0: 6572 6f44 6976 6973 696f 6e45 7272 6f72  eroDivisionError
+000072f0: 2c22 7665 6334 2064 6976 6973 696f 6e22  ,"vec4 division"
+00007300: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00007310: 2e78 203d 2061 2e78 2f72 0a20 2020 2020  .x = a.x/r.     
+00007320: 2020 2020 2020 2072 6573 2e79 203d 2061         res.y = a
+00007330: 2e79 2f72 0a20 2020 2020 2020 2020 2020  .y/r.           
+00007340: 2072 6573 2e7a 203d 2061 2e7a 2f72 0a20   res.z = a.z/r. 
+00007350: 2020 2020 2020 2020 2020 2072 6573 2e77             res.w
+00007360: 203d 2061 2e77 2f72 0a20 2020 2020 2020   = a.w/r.       
+00007370: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
+00007380: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00007390: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000073a0: 5479 7065 4572 726f 722c 2022 756e 7375  TypeError, "unsu
+000073b0: 7070 6f72 7465 6420 6f70 6572 616e 6420  pported operand 
+000073c0: 7479 7065 2066 6f72 202f 220a 0a20 2020  type for /"..   
+000073d0: 2064 6566 205f 5f6d 6f64 5f5f 2876 6563   def __mod__(vec
+000073e0: 3420 7365 6c66 2c20 6229 3a0a 2020 2020  4 self, b):.    
+000073f0: 2020 2020 2222 224d 6f64 756c 6f20 2863      """Modulo (c
+00007400: 6f6d 706f 6e65 6e74 2077 6973 6529 0a0a  omponent wise)..
+00007410: 2020 2020 2020 2020 3e3e 3e20 613d 7665          >>> a=ve
+00007420: 6334 2833 2e30 2c20 322e 352c 202d 312e  c4(3.0, 2.5, -1.
+00007430: 382c 2030 2e32 290a 2020 2020 2020 2020  8, 0.2).        
+00007440: 3e3e 3e20 7072 696e 7420 6125 322e 300a  >>> print a%2.0.
+00007450: 2020 2020 2020 2020 2831 2e30 3030 302c          (1.0000,
+00007460: 2030 2e35 3030 302c 2030 2e32 3030 302c   0.5000, 0.2000,
+00007470: 2030 2e32 3030 3029 0a20 2020 2020 2020   0.2000).       
+00007480: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00007490: 6620 7665 6334 2072 6573 2c20 7662 0a20  f vec4 res, vb. 
+000074a0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
+000074b0: 6c65 2072 0a0a 2020 2020 2020 2020 7462  le r..        tb
+000074c0: 203d 2074 7970 6528 6229 0a0a 2020 2020   = type(b)..    
+000074d0: 2020 2020 6966 2074 6220 6973 2066 6c6f      if tb is flo
+000074e0: 6174 206f 7220 7462 2069 7320 696e 7420  at or tb is int 
+000074f0: 6f72 2074 6220 6973 206c 6f6e 673a 0a20  or tb is long:. 
+00007500: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
+00007510: 3425 7363 616c 6172 0a20 2020 2020 2020  4%scalar.       
+00007520: 2020 2020 2072 6573 203d 2076 6563 3428       res = vec4(
+00007530: 290a 2020 2020 2020 2020 2020 2020 7220  ).            r 
+00007540: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
+00007550: 6966 2066 6162 7328 7229 3c3d 6570 733a  if fabs(r)<=eps:
+00007560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007570: 2072 6169 7365 205a 6572 6f44 6976 6973   raise ZeroDivis
+00007580: 696f 6e45 7272 6f72 2c22 7665 6334 206d  ionError,"vec4 m
+00007590: 6f64 756c 6f22 0a20 2020 2020 2020 2020  odulo".         
+000075a0: 2020 2072 6573 2e78 203d 205f 666d 6f64     res.x = _fmod
+000075b0: 2873 656c 662e 782c 7229 0a20 2020 2020  (self.x,r).     
+000075c0: 2020 2020 2020 2072 6573 2e79 203d 205f         res.y = _
+000075d0: 666d 6f64 2873 656c 662e 792c 7229 0a20  fmod(self.y,r). 
+000075e0: 2020 2020 2020 2020 2020 2072 6573 2e7a             res.z
+000075f0: 203d 205f 666d 6f64 2873 656c 662e 7a2c   = _fmod(self.z,
+00007600: 7229 0a20 2020 2020 2020 2020 2020 2072  r).            r
+00007610: 6573 2e77 203d 205f 666d 6f64 2873 656c  es.w = _fmod(sel
+00007620: 662e 772c 7229 0a20 2020 2020 2020 2020  f.w,r).         
+00007630: 2020 2072 6574 7572 6e20 7265 730a 2020     return res.  
+00007640: 2020 2020 2020 656c 6966 2074 6220 6973        elif tb is
+00007650: 2076 6563 343a 0a20 2020 2020 2020 2020   vec4:.         
+00007660: 2020 2023 2076 6563 3425 7665 6334 0a20     # vec4%vec4. 
+00007670: 2020 2020 2020 2020 2020 2072 6573 203d             res =
+00007680: 2076 6563 3428 290a 2020 2020 2020 2020   vec4().        
+00007690: 2020 2020 7662 203d 2062 0a20 2020 2020      vb = b.     
+000076a0: 2020 2020 2020 2069 6620 2866 6162 7328         if (fabs(
+000076b0: 7662 2e78 293c 3d65 7073 206f 7220 6661  vb.x)<=eps or fa
+000076c0: 6273 2876 622e 7929 3c3d 6570 7320 6f72  bs(vb.y)<=eps or
+000076d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000076e0: 2066 6162 7328 7662 2e7a 293c 3d65 7073   fabs(vb.z)<=eps
+000076f0: 206f 7220 6661 6273 2876 622e 7729 3c3d   or fabs(vb.w)<=
+00007700: 6570 7329 3a0a 2020 2020 2020 2020 2020  eps):.          
+00007710: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
+00007720: 4469 7669 7369 6f6e 4572 726f 722c 2276  DivisionError,"v
+00007730: 6563 3420 6d6f 6475 6c6f 220a 2020 2020  ec4 modulo".    
+00007740: 2020 2020 2020 2020 7265 732e 7820 3d20          res.x = 
+00007750: 5f66 6d6f 6428 7365 6c66 2e78 2c20 7662  _fmod(self.x, vb
+00007760: 2e78 290a 2020 2020 2020 2020 2020 2020  .x).            
+00007770: 7265 732e 7920 3d20 5f66 6d6f 6428 7365  res.y = _fmod(se
+00007780: 6c66 2e79 2c20 7662 2e79 290a 2020 2020  lf.y, vb.y).    
+00007790: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
+000077a0: 5f66 6d6f 6428 7365 6c66 2e7a 2c20 7662  _fmod(self.z, vb
+000077b0: 2e7a 290a 2020 2020 2020 2020 2020 2020  .z).            
+000077c0: 7265 732e 7720 3d20 5f66 6d6f 6428 7365  res.w = _fmod(se
+000077d0: 6c66 2e77 2c20 7662 2e77 290a 2020 2020  lf.w, vb.w).    
+000077e0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+000077f0: 6573 0a20 2020 2020 2020 2065 6c73 653a  es.        else:
+00007800: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00007810: 7365 2054 7970 6545 7272 6f72 2c20 2275  se TypeError, "u
+00007820: 6e73 7570 706f 7274 6564 206f 7065 7261  nsupported opera
+00007830: 6e64 2074 7970 6520 666f 7220 2522 0a0a  nd type for %"..
+00007840: 2020 2020 6465 6620 5f5f 6e65 675f 5f28      def __neg__(
+00007850: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00007860: 2222 4e65 6761 7469 6f6e 2e0a 0a20 2020  ""Negation...   
+00007870: 2020 2020 203e 3e3e 2061 3d76 6563 3428       >>> a=vec4(
+00007880: 332e 302c 2032 2e35 2c20 2d31 2e38 2c20  3.0, 2.5, -1.8, 
+00007890: 302e 3229 0a20 2020 2020 2020 203e 3e3e  0.2).        >>>
+000078a0: 2070 7269 6e74 202d 610a 2020 2020 2020   print -a.      
+000078b0: 2020 282d 332e 3030 3030 2c20 2d32 2e35    (-3.0000, -2.5
+000078c0: 3030 302c 2031 2e38 3030 302c 202d 302e  000, 1.8000, -0.
+000078d0: 3230 3030 290a 2020 2020 2020 2020 2222  2000).        ""
+000078e0: 220a 2020 2020 2020 2020 6364 6566 2076  ".        cdef v
+000078f0: 6563 3420 7265 730a 2020 2020 2020 2020  ec4 res.        
+00007900: 7265 7320 3d20 7665 6334 2829 0a20 2020  res = vec4().   
+00007910: 2020 2020 2072 6573 2e78 203d 202d 7365       res.x = -se
+00007920: 6c66 2e78 0a20 2020 2020 2020 2072 6573  lf.x.        res
+00007930: 2e79 203d 202d 7365 6c66 2e79 0a20 2020  .y = -self.y.   
+00007940: 2020 2020 2072 6573 2e7a 203d 202d 7365       res.z = -se
+00007950: 6c66 2e7a 0a20 2020 2020 2020 2072 6573  lf.z.        res
+00007960: 2e77 203d 202d 7365 6c66 2e77 0a20 2020  .w = -self.w.   
+00007970: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
+00007980: 0a20 2020 2064 6566 205f 5f70 6f73 5f5f  .    def __pos__
+00007990: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000079a0: 2222 220a 2020 2020 2020 2020 3e3e 3e20  """.        >>> 
+000079b0: 613d 7665 6334 2833 2e30 2c20 322e 352c  a=vec4(3.0, 2.5,
+000079c0: 202d 312e 382c 2030 2e32 290a 2020 2020   -1.8, 0.2).    
+000079d0: 2020 2020 3e3e 3e20 7072 696e 7420 2b61      >>> print +a
+000079e0: 0a20 2020 2020 2020 2028 332e 3030 3030  .        (3.0000
+000079f0: 2c20 322e 3530 3030 2c20 2d31 2e38 3030  , 2.5000, -1.800
+00007a00: 302c 2030 2e32 3030 3029 0a20 2020 2020  0, 0.2000).     
+00007a10: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+00007a20: 6465 6620 7665 6334 2072 6573 0a20 2020  def vec4 res.   
+00007a30: 2020 2020 2072 6573 203d 2076 6563 3428       res = vec4(
+00007a40: 290a 2020 2020 2020 2020 7265 732e 7820  ).        res.x 
+00007a50: 3d20 7365 6c66 2e78 0a20 2020 2020 2020  = self.x.       
+00007a60: 2072 6573 2e79 203d 2073 656c 662e 790a   res.y = self.y.
+00007a70: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
+00007a80: 7365 6c66 2e7a 0a20 2020 2020 2020 2072  self.z.        r
+00007a90: 6573 2e77 203d 2073 656c 662e 770a 2020  es.w = self.w.  
+00007aa0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00007ab0: 0a0a 2020 2020 6465 6620 5f5f 6961 6464  ..    def __iadd
+00007ac0: 5f5f 2873 656c 662c 2076 6563 3420 6f74  __(self, vec4 ot
+00007ad0: 6865 7229 3a0a 2020 2020 2020 2020 2222  her):.        ""
+00007ae0: 2249 6e6c 696e 6520 7665 6374 6f72 2061  "Inline vector a
+00007af0: 6464 6974 696f 6e2e 0a0a 2020 2020 2020  ddition...      
+00007b00: 2020 3e3e 3e20 613d 7665 6334 2831 2e30    >>> a=vec4(1.0
+00007b10: 2c20 302e 352c 202d 312e 382c 2030 2e32  , 0.5, -1.8, 0.2
+00007b20: 290a 2020 2020 2020 2020 3e3e 3e20 623d  ).        >>> b=
+00007b30: 7665 6334 282d 302e 332c 2030 2e37 352c  vec4(-0.3, 0.75,
+00007b40: 2030 2e35 2c20 302e 3329 0a20 2020 2020   0.5, 0.3).     
+00007b50: 2020 203e 3e3e 2061 2b3d 620a 2020 2020     >>> a+=b.    
+00007b60: 2020 2020 3e3e 3e20 7072 696e 7420 610a      >>> print a.
+00007b70: 2020 2020 2020 2020 2830 2e37 3030 302c          (0.7000,
+00007b80: 2031 2e32 3530 302c 202d 312e 3330 3030   1.2500, -1.3000
+00007b90: 2c20 302e 3530 3030 290a 2020 2020 2020  , 0.5000).      
+00007ba0: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
+00007bb0: 6c66 2e78 3d73 656c 662e 782b 6f74 6865  lf.x=self.x+othe
+00007bc0: 722e 780a 2020 2020 2020 2020 7365 6c66  r.x.        self
+00007bd0: 2e79 3d73 656c 662e 792b 6f74 6865 722e  .y=self.y+other.
+00007be0: 790a 2020 2020 2020 2020 7365 6c66 2e7a  y.        self.z
+00007bf0: 3d73 656c 662e 7a2b 6f74 6865 722e 7a0a  =self.z+other.z.
+00007c00: 2020 2020 2020 2020 7365 6c66 2e77 3d73          self.w=s
+00007c10: 656c 662e 772b 6f74 6865 722e 770a 2020  elf.w+other.w.  
+00007c20: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00007c30: 660a 0a20 2020 2064 6566 205f 5f69 7375  f..    def __isu
+00007c40: 625f 5f28 7365 6c66 2c20 7665 6334 206f  b__(self, vec4 o
+00007c50: 7468 6572 293a 0a20 2020 2020 2020 2022  ther):.        "
+00007c60: 2222 496e 6c69 6e65 2076 6563 746f 7220  ""Inline vector 
+00007c70: 7375 6274 7261 6374 696f 6e2e 0a0a 2020  subtraction...  
+00007c80: 2020 2020 2020 3e3e 3e20 613d 7665 6334        >>> a=vec4
+00007c90: 2831 2e30 2c20 302e 352c 202d 312e 382c  (1.0, 0.5, -1.8,
+00007ca0: 2030 2e32 290a 2020 2020 2020 2020 3e3e   0.2).        >>
+00007cb0: 3e20 623d 7665 6334 282d 302e 332c 2030  > b=vec4(-0.3, 0
+00007cc0: 2e37 352c 2030 2e35 2c20 302e 3329 0a20  .75, 0.5, 0.3). 
+00007cd0: 2020 2020 2020 203e 3e3e 2061 2d3d 620a         >>> a-=b.
+00007ce0: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00007cf0: 7420 610a 2020 2020 2020 2020 2831 2e33  t a.        (1.3
+00007d00: 3030 302c 202d 302e 3235 3030 2c20 2d32  000, -0.2500, -2
+00007d10: 2e33 3030 302c 202d 302e 3130 3030 290a  .3000, -0.1000).
+00007d20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00007d30: 2020 2020 7365 6c66 2e78 3d73 656c 662e      self.x=self.
+00007d40: 782d 6f74 6865 722e 780a 2020 2020 2020  x-other.x.      
+00007d50: 2020 7365 6c66 2e79 3d73 656c 662e 792d    self.y=self.y-
+00007d60: 6f74 6865 722e 790a 2020 2020 2020 2020  other.y.        
+00007d70: 7365 6c66 2e7a 3d73 656c 662e 7a2d 6f74  self.z=self.z-ot
+00007d80: 6865 722e 7a0a 2020 2020 2020 2020 7365  her.z.        se
+00007d90: 6c66 2e77 3d73 656c 662e 772d 6f74 6865  lf.w=self.w-othe
+00007da0: 722e 770a 2020 2020 2020 2020 7265 7475  r.w.        retu
+00007db0: 726e 2073 656c 660a 0a20 2020 2064 6566  rn self..    def
+00007dc0: 205f 5f69 6d75 6c5f 5f28 7365 6c66 2c20   __imul__(self, 
+00007dd0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+00007de0: 2222 2249 6e6c 696e 6520 6d75 6c74 6970  """Inline multip
+00007df0: 6c69 6361 7469 6f6e 2028 6f6e 6c79 2077  lication (only w
+00007e00: 6974 6820 7363 616c 6172 290a 0a20 2020  ith scalar)..   
+00007e10: 2020 2020 203e 3e3e 2061 3d76 6563 3428       >>> a=vec4(
+00007e20: 312e 302c 2030 2e35 2c20 2d31 2e38 2c20  1.0, 0.5, -1.8, 
+00007e30: 302e 3229 0a20 2020 2020 2020 203e 3e3e  0.2).        >>>
+00007e40: 2061 2a3d 322e 300a 2020 2020 2020 2020   a*=2.0.        
+00007e50: 3e3e 3e20 7072 696e 7420 610a 2020 2020  >>> print a.    
+00007e60: 2020 2020 2832 2e30 3030 302c 2031 2e30      (2.0000, 1.0
+00007e70: 3030 302c 202d 332e 3630 3030 2c20 302e  000, -3.6000, 0.
+00007e80: 3430 3030 290a 2020 2020 2020 2020 2222  4000).        ""
+00007e90: 220a 2020 2020 2020 2020 6364 6566 2064  ".        cdef d
+00007ea0: 6f75 626c 6520 720a 2020 2020 2020 2020  ouble r.        
+00007eb0: 7462 203d 2074 7970 6528 6f74 6865 7229  tb = type(other)
+00007ec0: 0a20 2020 2020 2020 2069 6620 7462 2069  .        if tb i
+00007ed0: 7320 666c 6f61 7420 6f72 2074 6220 6973  s float or tb is
+00007ee0: 2069 6e74 206f 7220 7462 2069 7320 6c6f   int or tb is lo
+00007ef0: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+00007f00: 723d 6f74 6865 720a 2020 2020 2020 2020  r=other.        
+00007f10: 2020 2020 7365 6c66 2e78 3d73 656c 662e      self.x=self.
+00007f20: 782a 720a 2020 2020 2020 2020 2020 2020  x*r.            
+00007f30: 7365 6c66 2e79 3d73 656c 662e 792a 720a  self.y=self.y*r.
+00007f40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00007f50: 2e7a 3d73 656c 662e 7a2a 720a 2020 2020  .z=self.z*r.    
+00007f60: 2020 2020 2020 2020 7365 6c66 2e77 3d73          self.w=s
+00007f70: 656c 662e 772a 720a 2020 2020 2020 2020  elf.w*r.        
+00007f80: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+00007f90: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00007fa0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00007fb0: 5479 7065 4572 726f 722c 2022 756e 7375  TypeError, "unsu
+00007fc0: 7070 6f72 7465 6420 6f70 6572 616e 6420  pported operand 
+00007fd0: 7479 7065 2066 6f72 202a 3d22 0a0a 2020  type for *="..  
+00007fe0: 2020 6465 6620 5f5f 6964 6976 5f5f 2873    def __idiv__(s
+00007ff0: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
+00008000: 2020 2020 2022 2222 496e 6c69 6e65 2064       """Inline d
+00008010: 6976 6973 696f 6e20 7769 7468 2073 6361  ivision with sca
+00008020: 6c61 720a 0a20 2020 2020 2020 203e 3e3e  lar..        >>>
+00008030: 2061 3d76 6563 3428 312e 302c 2030 2e35   a=vec4(1.0, 0.5
+00008040: 2c20 2d31 2e38 2c20 302e 3229 0a20 2020  , -1.8, 0.2).   
+00008050: 2020 2020 203e 3e3e 2061 2f3d 322e 300a       >>> a/=2.0.
+00008060: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00008070: 7420 610a 2020 2020 2020 2020 2830 2e35  t a.        (0.5
+00008080: 3030 302c 2030 2e32 3530 302c 202d 302e  000, 0.2500, -0.
+00008090: 3930 3030 2c20 302e 3130 3030 290a 2020  9000, 0.1000).  
+000080a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000080b0: 2020 6364 6566 2064 6f75 626c 6520 720a    cdef double r.
+000080c0: 2020 2020 2020 2020 7462 203d 2074 7970          tb = typ
+000080d0: 6528 6f74 6865 7229 0a20 2020 2020 2020  e(other).       
+000080e0: 2069 6620 7462 2069 7320 666c 6f61 7420   if tb is float 
+000080f0: 6f72 2074 6220 6973 2069 6e74 206f 7220  or tb is int or 
+00008100: 7462 2069 7320 6c6f 6e67 3a0a 2020 2020  tb is long:.    
+00008110: 2020 2020 2020 2020 723d 6f74 6865 720a          r=other.
+00008120: 2020 2020 2020 2020 2020 2020 6966 2066              if f
+00008130: 6162 7328 7229 3c3d 6570 733a 0a20 2020  abs(r)<=eps:.   
+00008140: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00008150: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
+00008160: 7272 6f72 2c22 7665 6334 2064 6976 6973  rror,"vec4 divis
+00008170: 696f 6e22 0a20 2020 2020 2020 2020 2020  ion".           
+00008180: 2073 656c 662e 783d 7365 6c66 2e78 2f72   self.x=self.x/r
+00008190: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000081a0: 662e 793d 7365 6c66 2e79 2f72 0a20 2020  f.y=self.y/r.   
+000081b0: 2020 2020 2020 2020 2073 656c 662e 7a3d           self.z=
+000081c0: 7365 6c66 2e7a 2f72 0a20 2020 2020 2020  self.z/r.       
+000081d0: 2020 2020 2073 656c 662e 773d 7365 6c66       self.w=self
+000081e0: 2e77 2f72 0a20 2020 2020 2020 2020 2020  .w/r.           
+000081f0: 2072 6574 7572 6e20 7365 6c66 0a20 2020   return self.   
+00008200: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00008210: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00008220: 6545 7272 6f72 2c20 2275 6e73 7570 706f  eError, "unsuppo
+00008230: 7274 6564 206f 7065 7261 6e64 2074 7970  rted operand typ
+00008240: 6520 666f 7220 2f3d 220a 0a20 2020 2064  e for /="..    d
+00008250: 6566 205f 5f69 6d6f 645f 5f28 7365 6c66  ef __imod__(self
+00008260: 2c20 6229 3a0a 2020 2020 2020 2020 2222  , b):.        ""
+00008270: 2249 6e6c 696e 6520 6d6f 6475 6c6f 2e0a  "Inline modulo..
+00008280: 0a20 2020 2020 2020 203e 3e3e 2061 3d76  .        >>> a=v
+00008290: 6563 3428 332e 302c 2032 2e35 2c20 2d31  ec4(3.0, 2.5, -1
+000082a0: 2e38 2c20 302e 3229 0a20 2020 2020 2020  .8, 0.2).       
+000082b0: 203e 3e3e 2061 253d 322e 300a 2020 2020   >>> a%=2.0.    
+000082c0: 2020 2020 3e3e 3e20 7072 696e 7420 610a      >>> print a.
+000082d0: 2020 2020 2020 2020 2831 2e30 3030 302c          (1.0000,
+000082e0: 2030 2e35 3030 302c 2030 2e32 3030 302c   0.5000, 0.2000,
+000082f0: 2030 2e32 3030 3029 0a20 2020 2020 2020   0.2000).       
+00008300: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00008310: 6620 7665 6334 2076 620a 2020 2020 2020  f vec4 vb.      
+00008320: 2020 6364 6566 2064 6f75 626c 6520 720a    cdef double r.
+00008330: 0a20 2020 2020 2020 2074 6220 3d20 7479  .        tb = ty
+00008340: 7065 2862 290a 0a20 2020 2020 2020 2069  pe(b)..        i
+00008350: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
+00008360: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
+00008370: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
+00008380: 2020 2020 2020 2320 7665 6334 253d 7363        # vec4%=sc
+00008390: 616c 6172 0a20 2020 2020 2020 2020 2020  alar.           
+000083a0: 2072 203d 2062 0a20 2020 2020 2020 2020   r = b.         
+000083b0: 2020 2069 6620 6661 6273 2872 293c 3d65     if fabs(r)<=e
+000083c0: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
+000083d0: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
+000083e0: 7669 7369 6f6e 4572 726f 722c 2276 6563  visionError,"vec
+000083f0: 3420 6d6f 6475 6c6f 220a 2020 2020 2020  4 modulo".      
+00008400: 2020 2020 2020 7365 6c66 2e78 203d 205f        self.x = _
+00008410: 666d 6f64 2873 656c 662e 782c 7229 0a20  fmod(self.x,r). 
+00008420: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00008430: 7920 3d20 5f66 6d6f 6428 7365 6c66 2e79  y = _fmod(self.y
+00008440: 2c72 290a 2020 2020 2020 2020 2020 2020  ,r).            
+00008450: 7365 6c66 2e7a 203d 205f 666d 6f64 2873  self.z = _fmod(s
+00008460: 656c 662e 7a2c 7229 0a20 2020 2020 2020  elf.z,r).       
+00008470: 2020 2020 2073 656c 662e 7720 3d20 5f66       self.w = _f
+00008480: 6d6f 6428 7365 6c66 2e77 2c72 290a 2020  mod(self.w,r).  
+00008490: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000084a0: 2073 656c 660a 2020 2020 2020 2020 656c   self.        el
+000084b0: 6966 2074 6220 6973 2076 6563 343a 0a20  if tb is vec4:. 
+000084c0: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
+000084d0: 3425 3d76 6563 340a 2020 2020 2020 2020  4%=vec4.        
+000084e0: 2020 2020 7662 203d 2062 0a20 2020 2020      vb = b.     
+000084f0: 2020 2020 2020 2069 6620 2866 6162 7328         if (fabs(
+00008500: 7662 2e78 293c 3d65 7073 206f 7220 6661  vb.x)<=eps or fa
+00008510: 6273 2876 622e 7929 3c3d 6570 7320 6f72  bs(vb.y)<=eps or
+00008520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008530: 2066 6162 7328 7662 2e7a 293c 3d65 7073   fabs(vb.z)<=eps
+00008540: 206f 7220 6661 6273 2876 622e 7729 3c3d   or fabs(vb.w)<=
+00008550: 6570 7329 3a0a 2020 2020 2020 2020 2020  eps):.          
+00008560: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
+00008570: 4469 7669 7369 6f6e 4572 726f 722c 2276  DivisionError,"v
+00008580: 6563 3420 6d6f 6475 6c6f 220a 2020 2020  ec4 modulo".    
+00008590: 2020 2020 2020 2020 7365 6c66 2e78 203d          self.x =
+000085a0: 205f 666d 6f64 2873 656c 662e 782c 2076   _fmod(self.x, v
+000085b0: 622e 7829 0a20 2020 2020 2020 2020 2020  b.x).           
+000085c0: 2073 656c 662e 7920 3d20 5f66 6d6f 6428   self.y = _fmod(
+000085d0: 7365 6c66 2e79 2c20 7662 2e79 290a 2020  self.y, vb.y).  
+000085e0: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
+000085f0: 203d 205f 666d 6f64 2873 656c 662e 7a2c   = _fmod(self.z,
+00008600: 2076 622e 7a29 0a20 2020 2020 2020 2020   vb.z).         
+00008610: 2020 2073 656c 662e 7720 3d20 5f66 6d6f     self.w = _fmo
+00008620: 6428 7365 6c66 2e77 2c20 7662 2e77 290a  d(self.w, vb.w).
+00008630: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00008640: 726e 2073 656c 660a 2020 2020 2020 2020  rn self.        
+00008650: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00008660: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00008670: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
+00008680: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
+00008690: 2025 3d22 0a0a 0a20 2020 2064 6566 205f   %="...    def _
+000086a0: 5f61 6273 5f5f 2873 656c 6629 3a0a 2020  _abs__(self):.  
+000086b0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+000086c0: 7468 6520 6c65 6e67 7468 206f 6620 7468  the length of th
+000086d0: 6520 7665 6374 6f72 2e0a 0a20 2020 2020  e vector...     
+000086e0: 2020 2061 6273 2876 2920 6973 2065 7175     abs(v) is equ
+000086f0: 6976 616c 656e 7420 746f 2076 2e6c 656e  ivalent to v.len
+00008700: 6774 6828 292e 0a0a 2020 2020 2020 2020  gth()...        
+00008710: 3e3e 3e20 613d 7665 6334 2831 2e30 2c20  >>> a=vec4(1.0, 
+00008720: 302e 352c 202d 312e 382c 2030 2e32 290a  0.5, -1.8, 0.2).
+00008730: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00008740: 7420 6162 7328 6129 0a20 2020 2020 2020  t abs(a).       
+00008750: 2032 2e31 3238 3337 3936 3635 3338 0a20   2.12837966538. 
+00008760: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00008770: 2020 2063 6465 6620 646f 7562 6c65 2061     cdef double a
+00008780: 0a20 2020 2020 2020 2061 203d 2073 656c  .        a = sel
+00008790: 662e 782a 7365 6c66 2e78 202b 2073 656c  f.x*self.x + sel
+000087a0: 662e 792a 7365 6c66 2e79 202b 2073 656c  f.y*self.y + sel
+000087b0: 662e 7a2a 7365 6c66 2e7a 202b 2073 656c  f.z*self.z + sel
+000087c0: 662e 772a 7365 6c66 2e77 0a20 2020 2020  f.w*self.w.     
+000087d0: 2020 2072 6574 7572 6e20 7371 7274 2861     return sqrt(a
+000087e0: 290a 0a20 2020 2064 6566 205f 5f67 6574  )..    def __get
+000087f0: 6174 7472 5f5f 2873 656c 662c 206e 616d  attr__(self, nam
+00008800: 6529 3a0a 2020 2020 2020 2020 6966 206e  e):.        if n
+00008810: 616d 653d 3d22 7822 3a0a 2020 2020 2020  ame=="x":.      
+00008820: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00008830: 662e 780a 2020 2020 2020 2020 656c 6966  f.x.        elif
+00008840: 206e 616d 653d 3d22 7922 3a0a 2020 2020   name=="y":.    
+00008850: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00008860: 656c 662e 790a 2020 2020 2020 2020 656c  elf.y.        el
+00008870: 6966 206e 616d 653d 3d22 7a22 3a0a 2020  if name=="z":.  
+00008880: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00008890: 2073 656c 662e 7a0a 2020 2020 2020 2020   self.z.        
+000088a0: 656c 6966 206e 616d 653d 3d22 7722 206f  elif name=="w" o
+000088b0: 7220 6e61 6d65 3d3d 2274 223a 0a20 2020  r name=="t":.   
+000088c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000088d0: 7365 6c66 2e77 0a20 2020 2020 2020 2065  self.w.        e
+000088e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000088f0: 2072 6169 7365 2041 7474 7269 6275 7465   raise Attribute
+00008900: 4572 726f 722c 2276 6563 3420 6861 7320  Error,"vec4 has 
+00008910: 6e6f 2061 7474 7269 6275 7465 2027 222b  no attribute '"+
+00008920: 6e61 6d65 2b22 2722 0a0a 2020 2020 6465  name+"'"..    de
+00008930: 6620 5f5f 7365 7461 7474 725f 5f28 7365  f __setattr__(se
+00008940: 6c66 2c20 6e61 6d65 2c20 7661 6c29 3a0a  lf, name, val):.
+00008950: 2020 2020 2020 2020 6966 206e 616d 653d          if name=
+00008960: 3d22 7822 3a0a 2020 2020 2020 2020 2020  ="x":.          
+00008970: 2020 7365 6c66 2e78 203d 2076 616c 0a20    self.x = val. 
+00008980: 2020 2020 2020 2065 6c69 6620 6e61 6d65         elif name
+00008990: 3d3d 2279 223a 0a20 2020 2020 2020 2020  =="y":.         
+000089a0: 2020 2073 656c 662e 7920 3d20 7661 6c0a     self.y = val.
+000089b0: 2020 2020 2020 2020 656c 6966 206e 616d          elif nam
+000089c0: 653d 3d22 7a22 3a0a 2020 2020 2020 2020  e=="z":.        
+000089d0: 2020 2020 7365 6c66 2e7a 203d 2076 616c      self.z = val
+000089e0: 0a20 2020 2020 2020 2065 6c69 6620 6e61  .        elif na
+000089f0: 6d65 3d3d 2277 2220 6f72 206e 616d 653d  me=="w" or name=
+00008a00: 3d22 7422 3a0a 2020 2020 2020 2020 2020  ="t":.          
+00008a10: 2020 7365 6c66 2e77 203d 2076 616c 0a20    self.w = val. 
+00008a20: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00008a30: 2020 2020 2020 2020 2072 6169 7365 2041           raise A
+00008a40: 7474 7269 6275 7465 4572 726f 722c 2276  ttributeError,"v
+00008a50: 6563 3420 6861 7320 6e6f 2077 7269 7461  ec4 has no writa
+00008a60: 626c 6520 6174 7472 6962 7574 6520 2722  ble attribute '"
+00008a70: 2b6e 616d 652b 2227 220a 0a20 2020 2064  +name+"'"..    d
+00008a80: 6566 205f 5f6c 656e 5f5f 2873 656c 6629  ef __len__(self)
+00008a90: 3a0a 2020 2020 2020 2020 2222 224c 656e  :.        """Len
+00008aa0: 6774 6820 6f66 2074 6865 2073 6571 7565  gth of the seque
+00008ab0: 6e63 6520 2861 6c77 6179 7320 3429 2e22  nce (always 4)."
+00008ac0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00008ad0: 6e20 340a 0a20 2020 2064 6566 205f 5f67  n 4..    def __g
+00008ae0: 6574 6974 656d 5f5f 2873 656c 662c 206b  etitem__(self, k
+00008af0: 6579 293a 0a20 2020 2020 2020 2022 2222  ey):.        """
+00008b00: 5265 7475 726e 2061 2063 6f6d 706f 6e65  Return a compone
+00008b10: 6e74 2062 7920 696e 6465 7820 2830 2d62  nt by index (0-b
+00008b20: 6173 6564 292e 0a0a 2020 2020 2020 2020  ased)...        
+00008b30: 3e3e 3e20 613d 7665 6334 2831 2e30 2c20  >>> a=vec4(1.0, 
+00008b40: 302e 352c 202d 312e 382c 2030 2e32 290a  0.5, -1.8, 0.2).
+00008b50: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00008b60: 7420 615b 305d 0a20 2020 2020 2020 2031  t a[0].        1
+00008b70: 2e30 0a20 2020 2020 2020 203e 3e3e 2070  .0.        >>> p
+00008b80: 7269 6e74 2061 5b31 5d0a 2020 2020 2020  rint a[1].      
+00008b90: 2020 302e 350a 2020 2020 2020 2020 3e3e    0.5.        >>
+00008ba0: 3e20 7072 696e 7420 615b 325d 0a20 2020  > print a[2].   
+00008bb0: 2020 2020 202d 312e 380a 2020 2020 2020       -1.8.      
+00008bc0: 2020 3e3e 3e20 7072 696e 7420 615b 335d    >>> print a[3]
+00008bd0: 0a20 2020 2020 2020 2030 2e32 0a20 2020  .        0.2.   
+00008be0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00008bf0: 2063 6465 6620 696e 7420 6b0a 0a20 2020   cdef int k..   
+00008c00: 2020 2020 2054 3d74 7970 6528 6b65 7929       T=type(key)
+00008c10: 0a20 2020 2020 2020 2069 6620 5421 3d69  .        if T!=i
+00008c20: 6e74 2061 6e64 2054 213d 6c6f 6e67 3a0a  nt and T!=long:.
+00008c30: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00008c40: 6520 5479 7065 4572 726f 722c 2022 696e  e TypeError, "in
+00008c50: 6465 7820 6d75 7374 2062 6520 696e 7465  dex must be inte
+00008c60: 6765 7222 0a0a 2020 2020 2020 2020 6b20  ger"..        k 
+00008c70: 3d20 6b65 790a 2020 2020 2020 2020 6966  = key.        if
+00008c80: 2020 206b 3d3d 303a 2072 6574 7572 6e20     k==0: return 
+00008c90: 7365 6c66 2e78 0a20 2020 2020 2020 2065  self.x.        e
+00008ca0: 6c69 6620 6b3d 3d31 3a20 7265 7475 726e  lif k==1: return
+00008cb0: 2073 656c 662e 790a 2020 2020 2020 2020   self.y.        
+00008cc0: 656c 6966 206b 3d3d 323a 2072 6574 7572  elif k==2: retur
+00008cd0: 6e20 7365 6c66 2e7a 0a20 2020 2020 2020  n self.z.       
+00008ce0: 2065 6c69 6620 6b3d 3d33 3a20 7265 7475   elif k==3: retu
+00008cf0: 726e 2073 656c 662e 770a 2020 2020 2020  rn self.w.      
+00008d00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00008d10: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
+00008d20: 7272 6f72 2c22 696e 6465 7820 6f75 7420  rror,"index out 
+00008d30: 6f66 2072 616e 6765 220a 0a20 2020 2064  of range"..    d
+00008d40: 6566 205f 5f73 6574 6974 656d 5f5f 2873  ef __setitem__(s
+00008d50: 656c 662c 206b 6579 2c20 7661 6c75 6529  elf, key, value)
+00008d60: 3a0a 2020 2020 2020 2020 2222 2253 6574  :.        """Set
+00008d70: 2061 2063 6f6d 706f 6e65 6e74 2062 7920   a component by 
+00008d80: 696e 6465 7820 2830 2d62 6173 6564 292e  index (0-based).
+00008d90: 0a0a 2020 2020 2020 2020 3e3e 3e20 613d  ..        >>> a=
+00008da0: 7665 6334 2829 0a20 2020 2020 2020 203e  vec4().        >
+00008db0: 3e3e 2061 5b30 5d3d 312e 353b 2061 5b31  >> a[0]=1.5; a[1
+00008dc0: 5d3d 302e 373b 2061 5b32 5d3d 2d30 2e33  ]=0.7; a[2]=-0.3
+00008dd0: 3b20 615b 335d 3d30 2e32 0a20 2020 2020  ; a[3]=0.2.     
+00008de0: 2020 203e 3e3e 2070 7269 6e74 2061 0a20     >>> print a. 
+00008df0: 2020 2020 2020 2028 312e 3530 3030 2c20         (1.5000, 
+00008e00: 302e 3730 3030 2c20 2d30 2e33 3030 302c  0.7000, -0.3000,
+00008e10: 2030 2e32 3030 3029 0a20 2020 2020 2020   0.2000).       
+00008e20: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00008e30: 6620 696e 7420 6b0a 0a20 2020 2020 2020  f int k..       
+00008e40: 2054 3d74 7970 6528 6b65 7929 0a20 2020   T=type(key).   
+00008e50: 2020 2020 2069 6620 5421 3d69 6e74 2061       if T!=int a
+00008e60: 6e64 2054 213d 6c6f 6e67 3a0a 2020 2020  nd T!=long:.    
+00008e70: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00008e80: 7065 4572 726f 722c 2022 696e 6465 7820  peError, "index 
+00008e90: 6d75 7374 2062 6520 696e 7465 6765 7222  must be integer"
+00008ea0: 0a0a 2020 2020 2020 2020 6b20 3d20 6b65  ..        k = ke
+00008eb0: 790a 2020 2020 2020 2020 6966 2020 206b  y.        if   k
+00008ec0: 3d3d 303a 2073 656c 662e 7820 3d20 7661  ==0: self.x = va
+00008ed0: 6c75 650a 2020 2020 2020 2020 656c 6966  lue.        elif
+00008ee0: 206b 3d3d 313a 2073 656c 662e 7920 3d20   k==1: self.y = 
+00008ef0: 7661 6c75 650a 2020 2020 2020 2020 656c  value.        el
+00008f00: 6966 206b 3d3d 323a 2073 656c 662e 7a20  if k==2: self.z 
+00008f10: 3d20 7661 6c75 650a 2020 2020 2020 2020  = value.        
+00008f20: 656c 6966 206b 3d3d 333a 2073 656c 662e  elif k==3: self.
+00008f30: 7720 3d20 7661 6c75 650a 2020 2020 2020  w = value.      
+00008f40: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00008f50: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
+00008f60: 7272 6f72 2c22 696e 6465 7820 6f75 7420  rror,"index out 
+00008f70: 6f66 2072 616e 6765 220a 0a20 2020 2064  of range"..    d
+00008f80: 6566 206c 656e 6774 6828 7365 6c66 293a  ef length(self):
+00008f90: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00008fa0: 726e 2074 6865 206c 656e 6774 6820 6f66  rn the length of
+00008fb0: 2074 6865 2076 6563 746f 722e 0a0a 2020   the vector...  
+00008fc0: 2020 2020 2020 762e 6c65 6e67 7468 2829        v.length()
+00008fd0: 2069 7320 6571 7569 7661 6c65 6e74 2074   is equivalent t
+00008fe0: 6f20 6162 7328 7629 2e0a 0a20 2020 2020  o abs(v)...     
+00008ff0: 2020 203e 3e3e 2061 3d76 6563 3428 312e     >>> a=vec4(1.
+00009000: 302c 2030 2e35 2c20 2d31 2e38 2c20 302e  0, 0.5, -1.8, 0.
+00009010: 3229 0a20 2020 2020 2020 203e 3e3e 2070  2).        >>> p
+00009020: 7269 6e74 2061 2e6c 656e 6774 6828 290a  rint a.length().
+00009030: 2020 2020 2020 2020 322e 3132 3833 3739          2.128379
+00009040: 3636 3533 380a 2020 2020 2020 2020 2222  66538.        ""
+00009050: 220a 2020 2020 2020 2020 6364 6566 2064  ".        cdef d
+00009060: 6f75 626c 6520 610a 2020 2020 2020 2020  ouble a.        
+00009070: 6120 3d20 7365 6c66 2e78 2a73 656c 662e  a = self.x*self.
+00009080: 7820 2b20 7365 6c66 2e79 2a73 656c 662e  x + self.y*self.
+00009090: 7920 2b20 7365 6c66 2e7a 2a73 656c 662e  y + self.z*self.
+000090a0: 7a20 2b20 7365 6c66 2e77 2a73 656c 662e  z + self.w*self.
+000090b0: 770a 2020 2020 2020 2020 7265 7475 726e  w.        return
+000090c0: 2073 7172 7428 6129 0a0a 2020 2020 6465   sqrt(a)..    de
+000090d0: 6620 6e6f 726d 616c 697a 6528 7365 6c66  f normalize(self
+000090e0: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+000090f0: 7475 726e 206e 6f72 6d61 6c69 7a65 6420  turn normalized 
+00009100: 7665 6374 6f72 2e0a 0a20 2020 2020 2020  vector...       
+00009110: 203e 3e3e 2061 3d76 6563 3428 312e 302c   >>> a=vec4(1.0,
+00009120: 2030 2e35 2c20 2d31 2e38 2c20 312e 3229   0.5, -1.8, 1.2)
+00009130: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00009140: 6e74 2061 2e6e 6f72 6d61 6c69 7a65 2829  nt a.normalize()
+00009150: 0a20 2020 2020 2020 2028 302e 3431 3037  .        (0.4107
+00009160: 2c20 302e 3230 3533 2c20 2d30 2e37 3339  , 0.2053, -0.739
+00009170: 322c 2030 2e34 3932 3829 0a20 2020 2020  2, 0.4928).     
+00009180: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+00009190: 6465 6620 7665 6334 2072 6573 0a20 2020  def vec4 res.   
+000091a0: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
+000091b0: 206e 6c65 6e0a 0a20 2020 2020 2020 206e   nlen..        n
+000091c0: 6c65 6e20 3d20 7371 7274 2873 656c 662e  len = sqrt(self.
+000091d0: 782a 7365 6c66 2e78 202b 2073 656c 662e  x*self.x + self.
+000091e0: 792a 7365 6c66 2e79 202b 2073 656c 662e  y*self.y + self.
+000091f0: 7a2a 7365 6c66 2e7a 202b 2073 656c 662e  z*self.z + self.
+00009200: 772a 7365 6c66 2e77 290a 2020 2020 2020  w*self.w).      
+00009210: 2020 6966 206e 6c65 6e3c 3d65 7073 3a0a    if nlen<=eps:.
+00009220: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00009230: 6520 5a65 726f 4469 7669 7369 6f6e 4572  e ZeroDivisionEr
+00009240: 726f 722c 226e 756c 6c20 7665 6374 6f72  ror,"null vector
+00009250: 2063 616e 2774 2062 6520 6e6f 726d 616c   can't be normal
+00009260: 697a 6564 220a 2020 2020 2020 2020 6e6c  ized".        nl
+00009270: 656e 203d 2031 2e30 2f6e 6c65 6e0a 2020  en = 1.0/nlen.  
+00009280: 2020 2020 2020 7265 7320 3d20 7665 6334        res = vec4
+00009290: 2829 0a20 2020 2020 2020 2072 6573 2e78  ().        res.x
+000092a0: 203d 2073 656c 662e 782a 6e6c 656e 0a20   = self.x*nlen. 
+000092b0: 2020 2020 2020 2072 6573 2e79 203d 2073         res.y = s
+000092c0: 656c 662e 792a 6e6c 656e 0a20 2020 2020  elf.y*nlen.     
+000092d0: 2020 2072 6573 2e7a 203d 2073 656c 662e     res.z = self.
+000092e0: 7a2a 6e6c 656e 0a20 2020 2020 2020 2072  z*nlen.        r
+000092f0: 6573 2e77 203d 2073 656c 662e 772a 6e6c  es.w = self.w*nl
+00009300: 656e 0a20 2020 2020 2020 2072 6574 7572  en.        retur
+00009310: 6e20 7265 730a 0a23 2323 2323 2323 2323  n res..#########
+00009320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00009350: 2323 2323 2323 2323 2323 2323 230a 0a23  #############..#
+00009360: 206d 6174 3369 7465 720a 6364 6566 2063   mat3iter.cdef c
+00009370: 6c61 7373 206d 6174 3369 7465 723a 0a20  lass mat3iter:. 
+00009380: 2020 2022 2222 6d61 7420 6974 6572 6174     """mat iterat
+00009390: 6f72 2e22 2222 0a20 2020 2063 6465 6620  or.""".    cdef 
+000093a0: 696e 7420 6964 780a 2020 2020 6364 6566  int idx.    cdef
+000093b0: 206f 626a 6563 7420 6d0a 0a20 2020 2064   object m..    d
+000093c0: 6566 205f 5f63 696e 6974 5f5f 2873 656c  ef __cinit__(sel
+000093d0: 662c 206d 293a 0a20 2020 2020 2020 2073  f, m):.        s
+000093e0: 656c 662e 6964 7820 3d20 300a 2020 2020  elf.idx = 0.    
+000093f0: 2020 2020 7365 6c66 2e6d 2020 203d 206d      self.m   = m
+00009400: 0a0a 2020 2020 6465 6620 5f5f 6974 6572  ..    def __iter
+00009410: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+00009420: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
+00009430: 2020 2064 6566 205f 5f6e 6578 745f 5f28     def __next__(
+00009440: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
+00009450: 6620 7365 6c66 2e69 6478 3d3d 303a 0a20  f self.idx==0:. 
+00009460: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00009470: 6964 783d 310a 2020 2020 2020 2020 2020  idx=1.          
+00009480: 2020 7265 7475 726e 2073 656c 662e 6d5b    return self.m[
+00009490: 305d 0a20 2020 2020 2020 2065 6c69 6620  0].        elif 
+000094a0: 7365 6c66 2e69 6478 3d3d 313a 0a20 2020  self.idx==1:.   
+000094b0: 2020 2020 2020 2020 2073 656c 662e 6964           self.id
+000094c0: 783d 320a 2020 2020 2020 2020 2020 2020  x=2.            
+000094d0: 7265 7475 726e 2073 656c 662e 6d5b 315d  return self.m[1]
+000094e0: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+000094f0: 6c66 2e69 6478 3d3d 323a 0a20 2020 2020  lf.idx==2:.     
+00009500: 2020 2020 2020 2073 656c 662e 6964 783d         self.idx=
+00009510: 330a 2020 2020 2020 2020 2020 2020 7265  3.            re
+00009520: 7475 726e 2073 656c 662e 6d5b 325d 0a20  turn self.m[2]. 
+00009530: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00009540: 2020 2020 2020 2020 2072 6169 7365 2053           raise S
+00009550: 746f 7049 7465 7261 7469 6f6e 0a0a 2320  topIteration..# 
+00009560: 6d61 7433 0a63 6465 6620 636c 6173 7320  mat3.cdef class 
+00009570: 6d61 7433 3a0a 0a20 2020 2063 6465 6620  mat3:..    cdef 
+00009580: 646f 7562 6c65 206d 3131 2c20 6d31 322c  double m11, m12,
+00009590: 206d 3133 0a20 2020 2063 6465 6620 646f   m13.    cdef do
+000095a0: 7562 6c65 206d 3231 2c20 6d32 322c 206d  uble m21, m22, m
+000095b0: 3233 0a20 2020 2063 6465 6620 646f 7562  23.    cdef doub
+000095c0: 6c65 206d 3331 2c20 6d33 322c 206d 3333  le m31, m32, m33
+000095d0: 0a0a 2020 2020 6465 6620 5f5f 6369 6e69  ..    def __cini
+000095e0: 745f 5f28 7365 6c66 2c20 2a61 7267 7329  t__(self, *args)
+000095f0: 3a0a 2020 2020 2020 2020 2222 2243 6f6e  :.        """Con
+00009600: 7374 7275 6374 6f72 2e0a 0a20 2020 2020  structor...     
+00009610: 2020 2054 6865 7265 2061 7265 2073 6576     There are sev
+00009620: 6572 616c 2070 6f73 7369 6269 6c69 7469  eral possibiliti
+00009630: 6573 2068 6f77 2074 6f20 696e 6974 6961  es how to initia
+00009640: 6c69 7a65 2061 206d 6174 7269 782c 0a20  lize a matrix,. 
+00009650: 2020 2020 2020 2064 6570 656e 6469 6e67         depending
+00009660: 206f 6e20 7468 6520 6e75 6d62 6572 206f   on the number o
+00009670: 6620 6172 6775 6d65 6e74 7320 796f 7520  f arguments you 
+00009680: 7072 6f76 6964 6520 746f 2074 6865 2063  provide to the c
+00009690: 6f6e 7374 7275 6374 6f72 2e0a 0a20 2020  onstructor...   
+000096a0: 2020 2020 202d 2030 2061 7267 756d 656e       - 0 argumen
+000096b0: 7473 3a20 4576 6572 7920 636f 6d70 6f6e  ts: Every compon
+000096c0: 656e 7420 6973 207a 6572 6f2e 0a20 2020  ent is zero..   
+000096d0: 2020 2020 202d 2031 206e 756d 6265 7220       - 1 number 
+000096e0: 6172 6775 6d65 6e74 3a20 5468 6520 6469  argument: The di
+000096f0: 6167 6f6e 616c 2069 7320 696e 6974 6961  agonal is initia
+00009700: 6c69 7a65 6420 746f 2074 6861 7420 6e75  lized to that nu
+00009710: 6d62 6572 2c0a 2020 2020 2020 2020 2020  mber,.          
+00009720: 616c 6c20 7468 6520 6f74 6865 7220 656c  all the other el
+00009730: 656d 656e 7473 2061 7265 207a 6572 6f2e  ements are zero.
+00009740: 0a20 2020 2020 2020 202d 2031 2073 6571  .        - 1 seq
+00009750: 7565 6e63 6520 6172 6775 6d65 6e74 3a20  uence argument: 
+00009760: 5468 6520 656c 656d 656e 7473 2061 7265  The elements are
+00009770: 2069 6e69 7469 616c 697a 6564 2077 6974   initialized wit
+00009780: 6820 7468 6520 6e75 6d62 6572 730a 2020  h the numbers.  
+00009790: 2020 2020 2020 2020 696e 2074 6865 2073          in the s
+000097a0: 6571 7565 6e63 6520 2874 6865 2073 6571  equence (the seq
+000097b0: 7565 6e63 6520 6d75 7374 2063 6f6e 7461  uence must conta
+000097c0: 696e 2039 206e 756d 6265 7273 292e 0a20  in 9 numbers).. 
+000097d0: 2020 2020 2020 202d 2031 206d 6174 3320         - 1 mat3 
+000097e0: 6172 6775 6d65 6e74 3a20 5468 6520 6d61  argument: The ma
+000097f0: 7472 6978 2069 7320 636f 7069 6564 2e0a  trix is copied..
+00009800: 2020 2020 2020 2020 2d20 3320 7365 7175          - 3 sequ
+00009810: 656e 6365 2061 7267 756d 656e 7473 3a20  ence arguments: 
+00009820: 5468 6520 636f 6c75 6d6e 7320 6172 6520  The columns are 
+00009830: 696e 6974 6961 6c69 7a65 6420 7769 7468  initialized with
+00009840: 2074 6865 0a20 2020 2020 2020 2020 2072   the.          r
+00009850: 6573 7065 6374 6976 6520 7365 7175 656e  espective sequen
+00009860: 6365 2028 6561 6368 2073 6571 7565 6e63  ce (each sequenc
+00009870: 6520 6d75 7374 2063 6f6e 7461 696e 2033  e must contain 3
+00009880: 206e 756d 6265 7273 292e 0a20 2020 2020   numbers)..     
+00009890: 2020 202d 2039 206e 756d 6265 7220 6172     - 9 number ar
+000098a0: 6775 6d65 6e74 733a 2054 6865 206d 6174  guments: The mat
+000098b0: 7269 7820 6973 2069 6e69 7469 616c 697a  rix is initializ
+000098c0: 6564 2077 6974 6820 7468 6f73 6520 7661  ed with those va
+000098d0: 6c75 6573 0a20 2020 2020 2020 2020 2028  lues.          (
+000098e0: 726f 772d 6d61 6a6f 7220 6f72 6465 7229  row-major order)
+000098f0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00009900: 2020 2020 2020 6364 6566 2069 6e74 2061        cdef int a
+00009910: 7267 6c65 6e0a 2020 2020 2020 2020 6364  rglen.        cd
+00009920: 6566 206d 6174 3320 420a 2020 2020 2020  ef mat3 B.      
+00009930: 2020 6172 676c 656e 203d 206c 656e 2861    arglen = len(a
+00009940: 7267 7329 0a0a 2020 2020 2020 2020 2320  rgs)..        # 
+00009950: 4e6f 2061 7267 756d 656e 7473 0a20 2020  No arguments.   
+00009960: 2020 2020 2069 6620 6172 676c 656e 3d3d       if arglen==
+00009970: 303a 0a20 2020 2020 2020 2020 2020 206d  0:.            m
+00009980: 3131 3d6d 3132 3d6d 3133 3d30 2e30 0a20  11=m12=m13=0.0. 
+00009990: 2020 2020 2020 2020 2020 206d 3231 3d6d             m21=m
+000099a0: 3232 3d6d 3233 3d30 2e30 0a20 2020 2020  22=m23=0.0.     
+000099b0: 2020 2020 2020 206d 3331 3d6d 3332 3d6d         m31=m32=m
+000099c0: 3333 3d30 2e30 0a0a 2020 2020 2020 2020  33=0.0..        
+000099d0: 2320 3120 6172 6775 6d65 6e74 2028 6c69  # 1 argument (li
+000099e0: 7374 2c20 7363 616c 6172 206f 7220 6d61  st, scalar or ma
+000099f0: 7433 290a 2020 2020 2020 2020 656c 6966  t3).        elif
+00009a00: 2061 7267 6c65 6e3d 3d31 3a0a 2020 2020   arglen==1:.    
+00009a10: 2020 2020 2020 2020 5420 3d20 7479 7065          T = type
+00009a20: 2861 7267 735b 305d 290a 2020 2020 2020  (args[0]).      
+00009a30: 2020 2020 2020 2320 7363 616c 6172 0a20        # scalar. 
+00009a40: 2020 2020 2020 2020 2020 2069 6620 5420             if T 
+00009a50: 6973 2066 6c6f 6174 206f 7220 5420 6973  is float or T is
+00009a60: 2069 6e74 206f 7220 5420 6973 206c 6f6e   int or T is lon
+00009a70: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
+00009a80: 2020 2073 656c 662e 6d31 3120 3d20 6172     self.m11 = ar
+00009a90: 6773 5b30 5d0a 2020 2020 2020 2020 2020  gs[0].          
+00009aa0: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
+00009ab0: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
+00009ac0: 2020 2020 2073 656c 662e 6d31 3320 3d20       self.m13 = 
+00009ad0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
+00009ae0: 2020 2020 7365 6c66 2e6d 3231 203d 2030      self.m21 = 0
+00009af0: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
+00009b00: 2020 2073 656c 662e 6d32 3220 3d20 7365     self.m22 = se
+00009b10: 6c66 2e6d 3131 0a20 2020 2020 2020 2020  lf.m11.         
+00009b20: 2020 2020 2020 2073 656c 662e 6d32 3320         self.m23 
+00009b30: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
+00009b40: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
+00009b50: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
+00009b60: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
+00009b70: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
+00009b80: 2020 2020 7365 6c66 2e6d 3333 203d 2073      self.m33 = s
+00009b90: 656c 662e 6d31 310a 0a20 2020 2020 2020  elf.m11..       
+00009ba0: 2020 2020 2023 206d 6174 330a 2020 2020       # mat3.    
+00009bb0: 2020 2020 2020 2020 656c 6966 2054 2069          elif T i
+00009bc0: 7320 6d61 7433 3a0a 2020 2020 2020 2020  s mat3:.        
+00009bd0: 2020 2020 2020 2020 4220 3d20 6172 6773          B = args
+00009be0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+00009bf0: 2020 2020 7365 6c66 2e6d 3131 203d 2042      self.m11 = B
+00009c00: 2e6d 3131 0a20 2020 2020 2020 2020 2020  .m11.           
+00009c10: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
+00009c20: 422e 6d31 320a 2020 2020 2020 2020 2020  B.m12.          
+00009c30: 2020 2020 2020 7365 6c66 2e6d 3133 203d        self.m13 =
+00009c40: 2042 2e6d 3133 0a20 2020 2020 2020 2020   B.m13.         
+00009c50: 2020 2020 2020 2073 656c 662e 6d32 3120         self.m21 
+00009c60: 3d20 422e 6d32 310a 2020 2020 2020 2020  = B.m21.        
+00009c70: 2020 2020 2020 2020 7365 6c66 2e6d 3232          self.m22
+00009c80: 203d 2042 2e6d 3232 0a20 2020 2020 2020   = B.m22.       
+00009c90: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+00009ca0: 3320 3d20 422e 6d32 330a 2020 2020 2020  3 = B.m23.      
+00009cb0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00009cc0: 3331 203d 2042 2e6d 3331 0a20 2020 2020  31 = B.m31.     
+00009cd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00009ce0: 6d33 3220 3d20 422e 6d33 320a 2020 2020  m32 = B.m32.    
+00009cf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00009d00: 2e6d 3333 203d 2042 2e6d 3333 0a20 2020  .m33 = B.m33.   
+00009d10: 2020 2020 2020 2020 2023 2053 7472 696e           # Strin
+00009d20: 670a 2020 2020 2020 2020 2020 2020 656c  g.            el
+00009d30: 6966 2054 2069 7320 7374 7220 6f72 2054  if T is str or T
+00009d40: 2069 7320 756e 6963 6f64 653a 0a20 2020   is unicode:.   
+00009d50: 2020 2020 2020 2020 2020 2020 2073 3d61               s=a
+00009d60: 7267 735b 305d 2e72 6570 6c61 6365 2822  rgs[0].replace("
+00009d70: 2c22 2c22 2022 292e 7265 706c 6163 6528  ,"," ").replace(
+00009d80: 2220 2022 2c22 2022 292e 7374 7269 7028  "  "," ").strip(
+00009d90: 292e 7370 6c69 7428 2220 2229 0a20 2020  ).split(" ").   
+00009da0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00009db0: 733d 3d5b 2222 5d3a 0a20 2020 2020 2020  s==[""]:.       
+00009dc0: 2020 2020 2020 2020 2020 2020 2073 3d5b               s=[
+00009dd0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00009de0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+00009df0: 286c 656e 2873 2929 3a0a 2020 2020 2020  (len(s)):.      
+00009e00: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00009e10: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00009e20: 2020 2020 2020 2020 2020 2073 5b69 5d20             s[i] 
+00009e30: 3d20 666c 6f61 7428 735b 695d 290a 2020  = float(s[i]).  
+00009e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009e50: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
+00009e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009e70: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00009e80: 6f72 2c22 6d61 7433 2829 2061 7267 2069  or,"mat3() arg i
+00009e90: 7320 6120 6d61 6c66 6f72 6d65 6420 7374  s a malformed st
+00009ea0: 7269 6e67 220a 2020 2020 2020 2020 2020  ring".          
+00009eb0: 2020 2020 2020 4220 3d20 6d61 7433 2873        B = mat3(s
+00009ec0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00009ed0: 2020 7365 6c66 2e6d 3131 203d 2042 2e6d    self.m11 = B.m
+00009ee0: 3131 0a20 2020 2020 2020 2020 2020 2020  11.             
+00009ef0: 2020 2073 656c 662e 6d31 3220 3d20 422e     self.m12 = B.
+00009f00: 6d31 320a 2020 2020 2020 2020 2020 2020  m12.            
+00009f10: 2020 2020 7365 6c66 2e6d 3133 203d 2042      self.m13 = B
+00009f20: 2e6d 3133 0a20 2020 2020 2020 2020 2020  .m13.           
+00009f30: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
+00009f40: 422e 6d32 310a 2020 2020 2020 2020 2020  B.m21.          
+00009f50: 2020 2020 2020 7365 6c66 2e6d 3232 203d        self.m22 =
+00009f60: 2042 2e6d 3232 0a20 2020 2020 2020 2020   B.m22.         
+00009f70: 2020 2020 2020 2073 656c 662e 6d32 3320         self.m23 
+00009f80: 3d20 422e 6d32 330a 2020 2020 2020 2020  = B.m23.        
+00009f90: 2020 2020 2020 2020 7365 6c66 2e6d 3331          self.m31
+00009fa0: 203d 2042 2e6d 3331 0a20 2020 2020 2020   = B.m31.       
+00009fb0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+00009fc0: 3220 3d20 422e 6d33 320a 2020 2020 2020  2 = B.m32.      
+00009fd0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00009fe0: 3333 203d 2042 2e6d 3333 0a20 2020 2020  33 = B.m33.     
+00009ff0: 2020 2020 2020 2023 2053 6571 7565 6e63         # Sequenc
+0000a000: 6520 6f66 2039 2066 6c6f 6174 730a 2020  e of 9 floats.  
+0000a010: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0000a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a030: 7365 7120 3d20 6172 6773 5b30 5d0a 2020  seq = args[0].  
+0000a040: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+0000a050: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+0000a060: 2020 2020 2020 2073 6571 6c65 6e20 3d20         seqlen = 
+0000a070: 6c65 6e28 7365 7129 0a20 2020 2020 2020  len(seq).       
+0000a080: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+0000a090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a0a0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+0000a0b0: 7272 6f72 2c22 6d61 7433 2829 2061 7267  rror,"mat3() arg
+0000a0c0: 2063 616e 2774 2062 6520 636f 6e76 6572   can't be conver
+0000a0d0: 7465 6420 746f 206d 6174 3322 0a0a 2020  ted to mat3"..  
+0000a0e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000a0f0: 2073 6571 6c65 6e3d 3d39 3a0a 2020 2020   seqlen==9:.    
+0000a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a110: 7365 6c66 2e6d 3131 203d 2073 6571 5b30  self.m11 = seq[0
+0000a120: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0000a130: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
+0000a140: 2073 6571 5b31 5d0a 2020 2020 2020 2020   seq[1].        
+0000a150: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000a160: 2e6d 3133 203d 2073 6571 5b32 5d0a 2020  .m13 = seq[2].  
+0000a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a180: 2020 7365 6c66 2e6d 3231 203d 2073 6571    self.m21 = seq
+0000a190: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
+0000a1a0: 2020 2020 2020 2020 7365 6c66 2e6d 3232          self.m22
+0000a1b0: 203d 2073 6571 5b34 5d0a 2020 2020 2020   = seq[4].      
+0000a1c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000a1d0: 6c66 2e6d 3233 203d 2073 6571 5b35 5d0a  lf.m23 = seq[5].
 0000a1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1f0: 2020 2073 656c 662e 6d31 3120 3d20 625b     self.m11 = b[
-0000a200: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
-0000a210: 2020 2020 2020 2073 656c 662e 6d32 3120         self.m21 
-0000a220: 3d20 625b 315d 0a20 2020 2020 2020 2020  = b[1].         
-0000a230: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a240: 6d33 3120 3d20 625b 325d 0a20 2020 2020  m31 = b[2].     
-0000a250: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0000a260: 203d 2073 6571 5b31 5d0a 2020 2020 2020   = seq[1].      
-0000a270: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000a280: 6c66 2e6d 3132 203d 2062 5b30 5d0a 2020  lf.m12 = b[0].  
-0000a290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a2a0: 2020 7365 6c66 2e6d 3232 203d 2062 5b31    self.m22 = b[1
-0000a2b0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0000a2c0: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
-0000a2d0: 2062 5b32 5d0a 2020 2020 2020 2020 2020   b[2].          
-0000a2e0: 2020 2020 2020 2020 2020 6220 3d20 7365            b = se
-0000a2f0: 715b 325d 0a20 2020 2020 2020 2020 2020  q[2].           
-0000a300: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-0000a310: 3320 3d20 625b 305d 0a20 2020 2020 2020  3 = b[0].       
-0000a320: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000a330: 662e 6d32 3320 3d20 625b 315d 0a20 2020  f.m23 = b[1].   
+0000a1f0: 2020 2020 7365 6c66 2e6d 3331 203d 2073      self.m31 = s
+0000a200: 6571 5b36 5d0a 2020 2020 2020 2020 2020  eq[6].          
+0000a210: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000a220: 3332 203d 2073 6571 5b37 5d0a 2020 2020  32 = seq[7].    
+0000a230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a240: 7365 6c66 2e6d 3333 203d 2073 6571 5b38  self.m33 = seq[8
+0000a250: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0000a260: 2020 656c 6966 2073 6571 6c65 6e3d 3d33    elif seqlen==3
+0000a270: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000a280: 2020 2020 2020 6220 3d20 7365 715b 305d        b = seq[0]
+0000a290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a2a0: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
+0000a2b0: 625b 305d 0a20 2020 2020 2020 2020 2020  b[0].           
+0000a2c0: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+0000a2d0: 3120 3d20 625b 315d 0a20 2020 2020 2020  1 = b[1].       
+0000a2e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000a2f0: 662e 6d33 3120 3d20 625b 325d 0a20 2020  f.m31 = b[2].   
+0000a300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a310: 2062 203d 2073 6571 5b31 5d0a 2020 2020   b = seq[1].    
+0000a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a330: 7365 6c66 2e6d 3132 203d 2062 5b30 5d0a  self.m12 = b[0].
 0000a340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a350: 2073 656c 662e 6d33 3320 3d20 625b 325d   self.m33 = b[2]
-0000a360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a370: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000a380: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000a390: 2054 7970 6545 7272 6f72 2c20 226d 6174   TypeError, "mat
-0000a3a0: 3328 2920 7461 6b65 7320 6174 206d 6f73  3() takes at mos
-0000a3b0: 7420 3920 6172 6775 6d65 6e74 7322 0a0a  t 9 arguments"..
-0000a3c0: 2020 2020 2020 2020 2320 3320 6172 6775          # 3 argu
-0000a3d0: 6d65 6e74 7320 2863 6f6c 756d 6e73 2061  ments (columns a
-0000a3e0: 7320 7365 7175 656e 6365 7329 0a20 2020  s sequences).   
-0000a3f0: 2020 2020 2065 6c69 6620 6172 676c 656e       elif arglen
-0000a400: 3d3d 333a 0a20 2020 2020 2020 2020 2020  ==3:.           
-0000a410: 2061 2c62 2c63 3d61 7267 730a 2020 2020   a,b,c=args.    
-0000a420: 2020 2020 2020 2020 7365 6c66 2e6d 3131          self.m11
-0000a430: 203d 2061 5b30 5d0a 2020 2020 2020 2020   = a[0].        
-0000a440: 2020 2020 7365 6c66 2e6d 3132 203d 2062      self.m12 = b
-0000a450: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-0000a460: 7365 6c66 2e6d 3133 203d 2063 5b30 5d0a  self.m13 = c[0].
-0000a470: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000a480: 2e6d 3231 203d 2061 5b31 5d0a 2020 2020  .m21 = a[1].    
-0000a490: 2020 2020 2020 2020 7365 6c66 2e6d 3232          self.m22
-0000a4a0: 203d 2062 5b31 5d0a 2020 2020 2020 2020   = b[1].        
-0000a4b0: 2020 2020 7365 6c66 2e6d 3233 203d 2063      self.m23 = c
-0000a4c0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-0000a4d0: 7365 6c66 2e6d 3331 203d 2061 5b32 5d0a  self.m31 = a[2].
-0000a4e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000a4f0: 2e6d 3332 203d 2062 5b32 5d0a 2020 2020  .m32 = b[2].    
-0000a500: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
-0000a510: 203d 2063 5b32 5d0a 0a20 2020 2020 2020   = c[2]..       
-0000a520: 2023 2039 2061 7267 756d 656e 7473 0a20   # 9 arguments. 
-0000a530: 2020 2020 2020 2065 6c69 6620 6172 676c         elif argl
-0000a540: 656e 3d3d 393a 0a20 2020 2020 2020 2020  en==9:.         
-0000a550: 2020 2073 656c 662e 6d31 3120 3d20 6172     self.m11 = ar
-0000a560: 6773 5b30 5d0a 2020 2020 2020 2020 2020  gs[0].          
-0000a570: 2020 7365 6c66 2e6d 3132 203d 2061 7267    self.m12 = arg
-0000a580: 735b 315d 0a20 2020 2020 2020 2020 2020  s[1].           
-0000a590: 2073 656c 662e 6d31 3320 3d20 6172 6773   self.m13 = args
-0000a5a0: 5b32 5d0a 2020 2020 2020 2020 2020 2020  [2].            
-0000a5b0: 7365 6c66 2e6d 3231 203d 2061 7267 735b  self.m21 = args[
-0000a5c0: 335d 0a20 2020 2020 2020 2020 2020 2073  3].            s
-0000a5d0: 656c 662e 6d32 3220 3d20 6172 6773 5b34  elf.m22 = args[4
-0000a5e0: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0000a5f0: 6c66 2e6d 3233 203d 2061 7267 735b 355d  lf.m23 = args[5]
-0000a600: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000a610: 662e 6d33 3120 3d20 6172 6773 5b36 5d0a  f.m31 = args[6].
-0000a620: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000a630: 2e6d 3332 203d 2061 7267 735b 375d 0a20  .m32 = args[7]. 
-0000a640: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a650: 6d33 3320 3d20 6172 6773 5b38 5d0a 0a20  m33 = args[8].. 
-0000a660: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000a670: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0000a680: 7970 6545 7272 6f72 2c22 6d61 7433 2829  ypeError,"mat3()
-0000a690: 2061 7267 2063 616e 2774 2062 6520 636f   arg can't be co
-0000a6a0: 6e76 6572 7465 6420 746f 206d 6174 3322  nverted to mat3"
-0000a6b0: 0a0a 2020 2020 6465 6620 5f5f 7265 6475  ..    def __redu
-0000a6c0: 6365 5f5f 2873 656c 6629 3a0a 2020 2020  ce__(self):.    
-0000a6d0: 2020 2020 7265 7475 726e 2028 5f6d 6174      return (_mat
-0000a6e0: 3363 6f6e 7374 7275 6374 2c20 2873 656c  3construct, (sel
-0000a6f0: 665b 305d 2c20 7365 6c66 5b31 5d2c 2073  f[0], self[1], s
-0000a700: 656c 665b 325d 2929 0a0a 2020 2020 6465  elf[2]))..    de
-0000a710: 6620 5f5f 7265 7072 5f5f 2873 656c 6629  f __repr__(self)
-0000a720: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0000a730: 2027 6d61 7433 2825 732c 2025 732c 2025   'mat3(%s, %s, %
-0000a740: 732c 2025 732c 2025 732c 2025 732c 2025  s, %s, %s, %s, %
-0000a750: 732c 2025 732c 2025 7329 2725 280a 2020  s, %s, %s)'%(.  
-0000a760: 2020 2020 2020 2020 2020 7265 7072 2873            repr(s
-0000a770: 656c 662e 6d31 3129 2c72 6570 7228 7365  elf.m11),repr(se
-0000a780: 6c66 2e6d 3132 292c 7265 7072 2873 656c  lf.m12),repr(sel
-0000a790: 662e 6d31 3329 2c0a 2020 2020 2020 2020  f.m13),.        
-0000a7a0: 2020 2020 7265 7072 2873 656c 662e 6d32      repr(self.m2
-0000a7b0: 3129 2c72 6570 7228 7365 6c66 2e6d 3232  1),repr(self.m22
-0000a7c0: 292c 7265 7072 2873 656c 662e 6d32 3329  ),repr(self.m23)
-0000a7d0: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
-0000a7e0: 7072 2873 656c 662e 6d33 3129 2c72 6570  pr(self.m31),rep
-0000a7f0: 7228 7365 6c66 2e6d 3332 292c 7265 7072  r(self.m32),repr
-0000a800: 2873 656c 662e 6d33 3329 290a 0a20 2020  (self.m33))..   
-0000a810: 2064 6566 205f 5f73 7472 5f5f 2873 656c   def __str__(sel
-0000a820: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-0000a830: 726e 2022 5b25 392e 3466 2c20 2539 2e34  rn "[%9.4f, %9.4
-0000a840: 662c 2025 392e 3466 5d5c 6e5b 2539 2e34  f, %9.4f]\n[%9.4
-0000a850: 662c 2025 392e 3466 2c20 2539 2e34 665d  f, %9.4f, %9.4f]
-0000a860: 5c6e 5b25 392e 3466 2c20 2539 2e34 662c  \n[%9.4f, %9.4f,
-0000a870: 2025 392e 3466 5d22 2528 0a20 2020 2020   %9.4f]"%(.     
-0000a880: 2020 2020 2020 2073 656c 662e 6d31 312c         self.m11,
-0000a890: 2073 656c 662e 6d31 322c 2073 656c 662e   self.m12, self.
-0000a8a0: 6d31 332c 0a20 2020 2020 2020 2020 2020  m13,.           
-0000a8b0: 2073 656c 662e 6d32 312c 2073 656c 662e   self.m21, self.
-0000a8c0: 6d32 322c 2073 656c 662e 6d32 332c 0a20  m22, self.m23,. 
-0000a8d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a8e0: 6d33 312c 2073 656c 662e 6d33 322c 2073  m31, self.m32, s
-0000a8f0: 656c 662e 6d33 3329 0a0a 2020 2020 6465  elf.m33)..    de
-0000a900: 6620 5f5f 6974 6572 5f5f 2873 656c 6629  f __iter__(self)
-0000a910: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0000a920: 206d 6174 3369 7465 7228 7365 6c66 290a   mat3iter(self).
-0000a930: 0a20 2020 2064 6566 205f 5f72 6963 6863  .    def __richc
-0000a940: 6d70 5f5f 2861 2c62 2c6f 7029 3a0a 2020  mp__(a,b,op):.  
-0000a950: 2020 2020 2020 6364 6566 206d 6174 3320        cdef mat3 
-0000a960: 6d61 2c20 6d62 0a20 2020 2020 2020 2063  ma, mb.        c
-0000a970: 6465 6620 696e 7420 636f 700a 0a20 2020  def int cop..   
-0000a980: 2020 2020 2063 6f70 203d 206f 700a 0a20       cop = op.. 
-0000a990: 2020 2020 2020 2074 6120 3d20 7479 7065         ta = type
-0000a9a0: 2861 290a 2020 2020 2020 2020 7462 203d  (a).        tb =
-0000a9b0: 2074 7970 6528 6229 0a20 2020 2020 2020   type(b).       
-0000a9c0: 2069 6620 2874 6121 3d6d 6174 3320 6f72   if (ta!=mat3 or
-0000a9d0: 2074 6221 3d6d 6174 3329 3a0a 2020 2020   tb!=mat3):.    
-0000a9e0: 2020 2020 2020 2020 6966 2063 6f70 3d3d          if cop==
-0000a9f0: 333a 0a20 2020 2020 2020 2020 2020 2020  3:.             
-0000aa00: 2020 2072 6574 7572 6e20 310a 2020 2020     return 1.    
-0000aa10: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000aa20: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000aa30: 7475 726e 2030 0a0a 2020 2020 2020 2020  turn 0..        
-0000aa40: 6d61 203d 2061 0a20 2020 2020 2020 206d  ma = a.        m
-0000aa50: 6220 3d20 620a 0a20 2020 2020 2020 2023  b = b..        #
-0000aa60: 203c 0a20 2020 2020 2020 2069 6620 636f   <.        if co
-0000aa70: 703d 3d30 3a0a 2020 2020 2020 2020 2020  p==0:.          
-0000aa80: 2020 7265 7475 726e 2030 0a20 2020 2020    return 0.     
-0000aa90: 2020 2023 203c 3d0a 2020 2020 2020 2020     # <=.        
-0000aaa0: 656c 6966 2063 6f70 3d3d 313a 0a20 2020  elif cop==1:.   
-0000aab0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000aac0: 300a 2020 2020 2020 2020 2320 3d3d 0a20  0.        # ==. 
-0000aad0: 2020 2020 2020 2065 6c69 6620 636f 703d         elif cop=
-0000aae0: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
-0000aaf0: 7265 7475 726e 2028 6661 6273 286d 612e  return (fabs(ma.
-0000ab00: 6d31 312d 6d62 2e6d 3131 293c 3d65 7073  m11-mb.m11)<=eps
-0000ab10: 2061 6e64 2066 6162 7328 6d61 2e6d 3132   and fabs(ma.m12
-0000ab20: 2d6d 622e 6d31 3229 3c3d 6570 7320 616e  -mb.m12)<=eps an
-0000ab30: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-0000ab40: 2020 2020 2020 6661 6273 286d 612e 6d31        fabs(ma.m1
-0000ab50: 332d 6d62 2e6d 3133 293c 3d65 7073 2061  3-mb.m13)<=eps a
-0000ab60: 6e64 0a20 2020 2020 2020 2020 2020 2020  nd.             
-0000ab70: 2020 2020 2020 2066 6162 7328 6d61 2e6d         fabs(ma.m
-0000ab80: 3231 2d6d 622e 6d32 3129 3c3d 6570 7320  21-mb.m21)<=eps 
-0000ab90: 616e 6420 6661 6273 286d 612e 6d32 322d  and fabs(ma.m22-
-0000aba0: 6d62 2e6d 3232 293c 3d65 7073 2061 6e64  mb.m22)<=eps and
-0000abb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000abc0: 2020 2020 2066 6162 7328 6d61 2e6d 3233       fabs(ma.m23
-0000abd0: 2d6d 622e 6d32 3329 3c3d 6570 7320 616e  -mb.m23)<=eps an
-0000abe0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-0000abf0: 2020 2020 2020 6661 6273 286d 612e 6d33        fabs(ma.m3
-0000ac00: 312d 6d62 2e6d 3331 293c 3d65 7073 2061  1-mb.m31)<=eps a
-0000ac10: 6e64 2066 6162 7328 6d61 2e6d 3332 2d6d  nd fabs(ma.m32-m
-0000ac20: 622e 6d33 3229 3c3d 6570 7320 616e 640a  b.m32)<=eps and.
-0000ac30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ac40: 2020 2020 6661 6273 286d 612e 6d33 332d      fabs(ma.m33-
-0000ac50: 6d62 2e6d 3333 293c 3d65 7073 290a 2020  mb.m33)<=eps).  
-0000ac60: 2020 2020 2020 2320 213d 0a20 2020 2020        # !=.     
-0000ac70: 2020 2065 6c69 6620 636f 703d 3d33 3a0a     elif cop==3:.
-0000ac80: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000ac90: 726e 2028 6661 6273 286d 612e 6d31 312d  rn (fabs(ma.m11-
-0000aca0: 6d62 2e6d 3131 293e 6570 7320 6f72 2066  mb.m11)>eps or f
-0000acb0: 6162 7328 6d61 2e6d 3132 2d6d 622e 6d31  abs(ma.m12-mb.m1
-0000acc0: 3229 3e65 7073 206f 720a 2020 2020 2020  2)>eps or.      
-0000acd0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-0000ace0: 6273 286d 612e 6d31 332d 6d62 2e6d 3133  bs(ma.m13-mb.m13
-0000acf0: 293e 6570 7320 6f72 0a20 2020 2020 2020  )>eps or.       
-0000ad00: 2020 2020 2020 2020 2020 2020 2066 6162               fab
-0000ad10: 7328 6d61 2e6d 3231 2d6d 622e 6d32 3129  s(ma.m21-mb.m21)
-0000ad20: 3e65 7073 206f 7220 6661 6273 286d 612e  >eps or fabs(ma.
-0000ad30: 6d32 322d 6d62 2e6d 3232 293e 6570 7320  m22-mb.m22)>eps 
-0000ad40: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-0000ad50: 2020 2020 2020 2066 6162 7328 6d61 2e6d         fabs(ma.m
-0000ad60: 3233 2d6d 622e 6d32 3329 3e65 7073 206f  23-mb.m23)>eps o
-0000ad70: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-0000ad80: 2020 2020 2020 6661 6273 286d 612e 6d33        fabs(ma.m3
-0000ad90: 312d 6d62 2e6d 3331 293e 6570 7320 6f72  1-mb.m31)>eps or
-0000ada0: 2066 6162 7328 6d61 2e6d 3332 2d6d 622e   fabs(ma.m32-mb.
-0000adb0: 6d33 3229 3e65 7073 206f 720a 2020 2020  m32)>eps or.    
-0000adc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000add0: 6661 6273 286d 612e 6d33 332d 6d62 2e6d  fabs(ma.m33-mb.m
-0000ade0: 3333 293e 6570 7329 0a20 2020 2020 2020  33)>eps).       
-0000adf0: 2023 203e 0a20 2020 2020 2020 2065 6c69   # >.        eli
-0000ae00: 6620 636f 703d 3d34 3a0a 2020 2020 2020  f cop==4:.      
-0000ae10: 2020 2020 2020 7265 7475 726e 2030 0a20        return 0. 
-0000ae20: 2020 2020 2020 2023 203e 3d0a 2020 2020         # >=.    
-0000ae30: 2020 2020 656c 6966 2063 6f70 3d3d 353a      elif cop==5:
-0000ae40: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000ae50: 7572 6e20 300a 2020 2020 2020 2020 2320  urn 0.        # 
-0000ae60: 736f 6e73 7420 2846 6568 6c65 7229 0a20  sonst (Fehler). 
-0000ae70: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000ae80: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0000ae90: 616c 7565 4572 726f 722c 2269 6e74 6572  alueError,"inter
-0000aea0: 6e61 6c20 6572 726f 723a 2069 6c6c 6567  nal error: illeg
-0000aeb0: 616c 2072 6963 6820 636f 6d70 6172 6973  al rich comparis
-0000aec0: 6f6e 206e 756d 6265 7222 0a0a 0a20 2020  on number"...   
-0000aed0: 2064 6566 205f 5f61 6464 5f5f 286d 6174   def __add__(mat
-0000aee0: 3320 612c 206d 6174 3320 6229 3a0a 2020  3 a, mat3 b):.  
-0000aef0: 2020 2020 2020 2222 224d 6174 7269 7820        """Matrix 
-0000af00: 6164 6469 7469 6f6e 2e0a 2020 2020 2020  addition..      
-0000af10: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
-0000af20: 6566 206d 6174 3320 7265 730a 2020 2020  ef mat3 res.    
-0000af30: 2020 2020 7265 7320 3d20 6d61 7433 2829      res = mat3()
-0000af40: 0a20 2020 2020 2020 2072 6573 2e6d 3131  .        res.m11
-0000af50: 203d 2061 2e6d 3131 202b 2062 2e6d 3131   = a.m11 + b.m11
-0000af60: 0a20 2020 2020 2020 2072 6573 2e6d 3132  .        res.m12
-0000af70: 203d 2061 2e6d 3132 202b 2062 2e6d 3132   = a.m12 + b.m12
-0000af80: 0a20 2020 2020 2020 2072 6573 2e6d 3133  .        res.m13
-0000af90: 203d 2061 2e6d 3133 202b 2062 2e6d 3133   = a.m13 + b.m13
-0000afa0: 0a20 2020 2020 2020 2072 6573 2e6d 3231  .        res.m21
-0000afb0: 203d 2061 2e6d 3231 202b 2062 2e6d 3231   = a.m21 + b.m21
-0000afc0: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
-0000afd0: 203d 2061 2e6d 3232 202b 2062 2e6d 3232   = a.m22 + b.m22
-0000afe0: 0a20 2020 2020 2020 2072 6573 2e6d 3233  .        res.m23
-0000aff0: 203d 2061 2e6d 3233 202b 2062 2e6d 3233   = a.m23 + b.m23
-0000b000: 0a20 2020 2020 2020 2072 6573 2e6d 3331  .        res.m31
-0000b010: 203d 2061 2e6d 3331 202b 2062 2e6d 3331   = a.m31 + b.m31
-0000b020: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
-0000b030: 203d 2061 2e6d 3332 202b 2062 2e6d 3332   = a.m32 + b.m32
-0000b040: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
-0000b050: 203d 2061 2e6d 3333 202b 2062 2e6d 3333   = a.m33 + b.m33
-0000b060: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000b070: 7265 730a 0a20 2020 2064 6566 205f 5f73  res..    def __s
-0000b080: 7562 5f5f 286d 6174 3320 612c 206d 6174  ub__(mat3 a, mat
-0000b090: 3320 6229 3a0a 2020 2020 2020 2020 2222  3 b):.        ""
-0000b0a0: 224d 6174 7269 7820 7375 6274 7261 6374  "Matrix subtract
-0000b0b0: 696f 6e2e 0a20 2020 2020 2020 2022 2222  ion..        """
-0000b0c0: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
-0000b0d0: 7433 2072 6573 0a20 2020 2020 2020 2072  t3 res.        r
-0000b0e0: 6573 203d 206d 6174 3328 290a 2020 2020  es = mat3().    
-0000b0f0: 2020 2020 7265 732e 6d31 3120 3d20 612e      res.m11 = a.
-0000b100: 6d31 3120 2d20 622e 6d31 310a 2020 2020  m11 - b.m11.    
-0000b110: 2020 2020 7265 732e 6d31 3220 3d20 612e      res.m12 = a.
-0000b120: 6d31 3220 2d20 622e 6d31 320a 2020 2020  m12 - b.m12.    
-0000b130: 2020 2020 7265 732e 6d31 3320 3d20 612e      res.m13 = a.
-0000b140: 6d31 3320 2d20 622e 6d31 330a 2020 2020  m13 - b.m13.    
-0000b150: 2020 2020 7265 732e 6d32 3120 3d20 612e      res.m21 = a.
-0000b160: 6d32 3120 2d20 622e 6d32 310a 2020 2020  m21 - b.m21.    
-0000b170: 2020 2020 7265 732e 6d32 3220 3d20 612e      res.m22 = a.
-0000b180: 6d32 3220 2d20 622e 6d32 320a 2020 2020  m22 - b.m22.    
-0000b190: 2020 2020 7265 732e 6d32 3320 3d20 612e      res.m23 = a.
-0000b1a0: 6d32 3320 2d20 622e 6d32 330a 2020 2020  m23 - b.m23.    
-0000b1b0: 2020 2020 7265 732e 6d33 3120 3d20 612e      res.m31 = a.
-0000b1c0: 6d33 3120 2d20 622e 6d33 310a 2020 2020  m31 - b.m31.    
-0000b1d0: 2020 2020 7265 732e 6d33 3220 3d20 612e      res.m32 = a.
-0000b1e0: 6d33 3220 2d20 622e 6d33 320a 2020 2020  m32 - b.m32.    
-0000b1f0: 2020 2020 7265 732e 6d33 3320 3d20 612e      res.m33 = a.
-0000b200: 6d33 3320 2d20 622e 6d33 330a 2020 2020  m33 - b.m33.    
-0000b210: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-0000b220: 2020 2020 6465 6620 5f5f 6d75 6c5f 5f28      def __mul__(
-0000b230: 612c 2062 293a 0a20 2020 2020 2020 2022  a, b):.        "
-0000b240: 2222 4d75 6c74 6970 6c69 6361 7469 6f6e  ""Multiplication
-0000b250: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000b260: 2020 2020 2020 6364 6566 206d 6174 3320        cdef mat3 
-0000b270: 6d61 2c20 6d62 2c20 7265 730a 2020 2020  ma, mb, res.    
-0000b280: 2020 2020 6364 6566 2076 6563 3320 7661      cdef vec3 va
-0000b290: 2c20 7662 2c20 7672 6573 0a20 2020 2020  , vb, vres.     
-0000b2a0: 2020 2063 6465 6620 646f 7562 6c65 2072     cdef double r
-0000b2b0: 0a0a 2020 2020 2020 2020 7461 203d 2074  ..        ta = t
-0000b2c0: 7970 6528 6129 0a20 2020 2020 2020 2074  ype(a).        t
-0000b2d0: 6220 3d20 7479 7065 2862 290a 0a20 2020  b = type(b)..   
-0000b2e0: 2020 2020 2023 206d 6174 3320 6f6e 2074       # mat3 on t
-0000b2f0: 6865 206c 6566 743f 0a20 2020 2020 2020  he left?.       
-0000b300: 2069 6620 7461 2069 7320 6d61 7433 3a0a   if ta is mat3:.
-0000b310: 2020 2020 2020 2020 2020 2020 6d61 203d              ma =
-0000b320: 2061 0a20 2020 2020 2020 2020 2020 2023   a.            #
-0000b330: 206d 6174 3320 6f6e 2074 6865 2072 6967   mat3 on the rig
-0000b340: 6874 3f0a 2020 2020 2020 2020 2020 2020  ht?.            
-0000b350: 6966 2074 6220 6973 206d 6174 333a 0a20  if tb is mat3:. 
-0000b360: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0000b370: 206d 6174 332a 6d61 7433 0a20 2020 2020   mat3*mat3.     
-0000b380: 2020 2020 2020 2020 2020 2072 6573 203d             res =
-0000b390: 206d 6174 3328 290a 2020 2020 2020 2020   mat3().        
-0000b3a0: 2020 2020 2020 2020 6d62 203d 2062 0a20          mb = b. 
-0000b3b0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000b3c0: 6573 2e6d 3131 203d 206d 612e 6d31 312a  es.m11 = ma.m11*
-0000b3d0: 6d62 2e6d 3131 2b6d 612e 6d31 322a 6d62  mb.m11+ma.m12*mb
-0000b3e0: 2e6d 3231 2b6d 612e 6d31 332a 6d62 2e6d  .m21+ma.m13*mb.m
-0000b3f0: 3331 0a20 2020 2020 2020 2020 2020 2020  31.             
-0000b400: 2020 2072 6573 2e6d 3132 203d 206d 612e     res.m12 = ma.
-0000b410: 6d31 312a 6d62 2e6d 3132 2b6d 612e 6d31  m11*mb.m12+ma.m1
-0000b420: 322a 6d62 2e6d 3232 2b6d 612e 6d31 332a  2*mb.m22+ma.m13*
-0000b430: 6d62 2e6d 3332 0a20 2020 2020 2020 2020  mb.m32.         
-0000b440: 2020 2020 2020 2072 6573 2e6d 3133 203d         res.m13 =
-0000b450: 206d 612e 6d31 312a 6d62 2e6d 3133 2b6d   ma.m11*mb.m13+m
-0000b460: 612e 6d31 322a 6d62 2e6d 3233 2b6d 612e  a.m12*mb.m23+ma.
-0000b470: 6d31 332a 6d62 2e6d 3333 0a20 2020 2020  m13*mb.m33.     
-0000b480: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-0000b490: 3231 203d 206d 612e 6d32 312a 6d62 2e6d  21 = ma.m21*mb.m
-0000b4a0: 3131 2b6d 612e 6d32 322a 6d62 2e6d 3231  11+ma.m22*mb.m21
-0000b4b0: 2b6d 612e 6d32 332a 6d62 2e6d 3331 0a20  +ma.m23*mb.m31. 
-0000b4c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000b4d0: 6573 2e6d 3232 203d 206d 612e 6d32 312a  es.m22 = ma.m21*
-0000b4e0: 6d62 2e6d 3132 2b6d 612e 6d32 322a 6d62  mb.m12+ma.m22*mb
-0000b4f0: 2e6d 3232 2b6d 612e 6d32 332a 6d62 2e6d  .m22+ma.m23*mb.m
-0000b500: 3332 0a20 2020 2020 2020 2020 2020 2020  32.             
-0000b510: 2020 2072 6573 2e6d 3233 203d 206d 612e     res.m23 = ma.
-0000b520: 6d32 312a 6d62 2e6d 3133 2b6d 612e 6d32  m21*mb.m13+ma.m2
-0000b530: 322a 6d62 2e6d 3233 2b6d 612e 6d32 332a  2*mb.m23+ma.m23*
-0000b540: 6d62 2e6d 3333 0a20 2020 2020 2020 2020  mb.m33.         
-0000b550: 2020 2020 2020 2072 6573 2e6d 3331 203d         res.m31 =
-0000b560: 206d 612e 6d33 312a 6d62 2e6d 3131 2b6d   ma.m31*mb.m11+m
-0000b570: 612e 6d33 322a 6d62 2e6d 3231 2b6d 612e  a.m32*mb.m21+ma.
-0000b580: 6d33 332a 6d62 2e6d 3331 0a20 2020 2020  m33*mb.m31.     
-0000b590: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-0000b5a0: 3332 203d 206d 612e 6d33 312a 6d62 2e6d  32 = ma.m31*mb.m
-0000b5b0: 3132 2b6d 612e 6d33 322a 6d62 2e6d 3232  12+ma.m32*mb.m22
-0000b5c0: 2b6d 612e 6d33 332a 6d62 2e6d 3332 0a20  +ma.m33*mb.m32. 
-0000b5d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000b5e0: 6573 2e6d 3333 203d 206d 612e 6d33 312a  es.m33 = ma.m31*
-0000b5f0: 6d62 2e6d 3133 2b6d 612e 6d33 322a 6d62  mb.m13+ma.m32*mb
-0000b600: 2e6d 3233 2b6d 612e 6d33 332a 6d62 2e6d  .m23+ma.m33*mb.m
-0000b610: 3333 0a20 2020 2020 2020 2020 2020 2020  33.             
-0000b620: 2020 2072 6574 7572 6e20 7265 730a 2020     return res.  
-0000b630: 2020 2020 2020 2020 2020 2320 7665 6333            # vec3
-0000b640: 206f 6e20 7468 6520 7269 6768 743f 0a20   on the right?. 
-0000b650: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0000b660: 7462 2069 7320 7665 6333 3a0a 2020 2020  tb is vec3:.    
-0000b670: 2020 2020 2020 2020 2020 2020 2320 6d61              # ma
-0000b680: 7433 2a76 6563 330a 2020 2020 2020 2020  t3*vec3.        
-0000b690: 2020 2020 2020 2020 7772 6573 203d 2076          wres = v
-0000b6a0: 6563 3328 290a 2020 2020 2020 2020 2020  ec3().          
-0000b6b0: 2020 2020 2020 7762 2020 203d 2062 0a20        wb   = b. 
-0000b6c0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0000b6d0: 7265 732e 7820 3d20 6d61 2e6d 3131 2a77  res.x = ma.m11*w
-0000b6e0: 622e 7820 2b20 6d61 2e6d 3132 2a77 622e  b.x + ma.m12*wb.
-0000b6f0: 7920 2b20 6d61 2e6d 3133 2a77 622e 7a0a  y + ma.m13*wb.z.
-0000b700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b710: 7772 6573 2e79 203d 206d 612e 6d32 312a  wres.y = ma.m21*
-0000b720: 7762 2e78 202b 206d 612e 6d32 322a 7762  wb.x + ma.m22*wb
-0000b730: 2e79 202b 206d 612e 6d32 332a 7762 2e7a  .y + ma.m23*wb.z
-0000b740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b750: 2077 7265 732e 7a20 3d20 6d61 2e6d 3331   wres.z = ma.m31
-0000b760: 2a77 622e 7820 2b20 6d61 2e6d 3332 2a77  *wb.x + ma.m32*w
-0000b770: 622e 7920 2b20 6d61 2e6d 3333 2a77 622e  b.y + ma.m33*wb.
-0000b780: 7a0a 2020 2020 2020 2020 2020 2020 2020  z.              
-0000b790: 2020 7265 7475 726e 2077 7265 730a 2020    return wres.  
-0000b7a0: 2020 2020 2020 2020 2020 2320 5363 616c            # Scal
-0000b7b0: 6172 206f 6e20 7468 6520 7269 6768 743f  ar on the right?
-0000b7c0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0000b7d0: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
-0000b7e0: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
-0000b7f0: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
-0000b800: 2020 2020 2020 2020 2020 7265 7320 3d20            res = 
-0000b810: 6d61 7433 2829 0a20 2020 2020 2020 2020  mat3().         
-0000b820: 2020 2020 2020 2072 203d 2062 0a20 2020         r = b.   
-0000b830: 2020 2020 2020 2020 2020 2020 2072 6573               res
-0000b840: 2e6d 3131 203d 206d 612e 6d31 312a 720a  .m11 = ma.m11*r.
-0000b850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b860: 7265 732e 6d31 3220 3d20 6d61 2e6d 3132  res.m12 = ma.m12
-0000b870: 2a72 0a20 2020 2020 2020 2020 2020 2020  *r.             
-0000b880: 2020 2072 6573 2e6d 3133 203d 206d 612e     res.m13 = ma.
-0000b890: 6d31 332a 720a 2020 2020 2020 2020 2020  m13*r.          
-0000b8a0: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
-0000b8b0: 6d61 2e6d 3231 2a72 0a20 2020 2020 2020  ma.m21*r.       
-0000b8c0: 2020 2020 2020 2020 2072 6573 2e6d 3232           res.m22
-0000b8d0: 203d 206d 612e 6d32 322a 720a 2020 2020   = ma.m22*r.    
-0000b8e0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-0000b8f0: 6d32 3320 3d20 6d61 2e6d 3233 2a72 0a20  m23 = ma.m23*r. 
-0000b900: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000b910: 6573 2e6d 3331 203d 206d 612e 6d33 312a  es.m31 = ma.m31*
-0000b920: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-0000b930: 2020 7265 732e 6d33 3220 3d20 6d61 2e6d    res.m32 = ma.m
-0000b940: 3332 2a72 0a20 2020 2020 2020 2020 2020  32*r.           
-0000b950: 2020 2020 2072 6573 2e6d 3333 203d 206d       res.m33 = m
-0000b960: 612e 6d33 332a 720a 2020 2020 2020 2020  a.m33*r.        
-0000b970: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0000b980: 6573 0a0a 2020 2020 2020 2020 2320 7665  es..        # ve
-0000b990: 6333 206f 6e20 7468 6520 6c65 6674 3f20  c3 on the left? 
-0000b9a0: 2874 6865 6e20 7468 6572 6520 6d75 7374  (then there must
-0000b9b0: 2062 6520 6120 6d61 7433 206f 6e20 7468   be a mat3 on th
-0000b9c0: 6520 7269 6768 7429 0a20 2020 2020 2020  e right).       
-0000b9d0: 2065 6c69 6620 7461 2069 7320 7665 6333   elif ta is vec3
-0000b9e0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0000b9f0: 7665 6333 2a6d 6174 330a 2020 2020 2020  vec3*mat3.      
-0000ba00: 2020 2020 2020 7772 6573 203d 2076 6563        wres = vec
-0000ba10: 3328 290a 2020 2020 2020 2020 2020 2020  3().            
-0000ba20: 7761 2020 203d 2061 0a20 2020 2020 2020  wa   = a.       
-0000ba30: 2020 2020 206d 6220 2020 3d20 620a 2020       mb   = b.  
-0000ba40: 2020 2020 2020 2020 2020 7772 6573 2e78            wres.x
-0000ba50: 203d 2077 612e 782a 6d62 2e6d 3131 202b   = wa.x*mb.m11 +
-0000ba60: 2077 612e 792a 6d62 2e6d 3231 202b 2077   wa.y*mb.m21 + w
-0000ba70: 612e 7a2a 6d62 2e6d 3331 0a20 2020 2020  a.z*mb.m31.     
-0000ba80: 2020 2020 2020 2077 7265 732e 7920 3d20         wres.y = 
-0000ba90: 7761 2e78 2a6d 622e 6d31 3220 2b20 7761  wa.x*mb.m12 + wa
-0000baa0: 2e79 2a6d 622e 6d32 3220 2b20 7761 2e7a  .y*mb.m22 + wa.z
-0000bab0: 2a6d 622e 6d33 320a 2020 2020 2020 2020  *mb.m32.        
-0000bac0: 2020 2020 7772 6573 2e7a 203d 2077 612e      wres.z = wa.
-0000bad0: 782a 6d62 2e6d 3133 202b 2077 612e 792a  x*mb.m13 + wa.y*
-0000bae0: 6d62 2e6d 3233 202b 2077 612e 7a2a 6d62  mb.m23 + wa.z*mb
-0000baf0: 2e6d 3333 0a20 2020 2020 2020 2020 2020  .m33.           
-0000bb00: 2072 6574 7572 6e20 7772 6573 0a0a 2020   return wres..  
-0000bb10: 2020 2020 2020 2320 5363 616c 6172 206f        # Scalar o
-0000bb20: 6e20 7468 6520 6c65 6674 3f20 2874 6865  n the left? (the
-0000bb30: 6e20 7468 6572 6520 6d75 7374 2062 6520  n there must be 
-0000bb40: 6120 6d61 7433 206f 6e20 7468 6520 7269  a mat3 on the ri
-0000bb50: 6768 7429 0a20 2020 2020 2020 2065 6c69  ght).        eli
-0000bb60: 6620 7461 2069 7320 666c 6f61 7420 6f72  f ta is float or
-0000bb70: 2074 6120 6973 2069 6e74 206f 7220 7461   ta is int or ta
-0000bb80: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
-0000bb90: 2020 2020 2020 7265 7320 3d20 6d61 7433        res = mat3
-0000bba0: 2829 0a20 2020 2020 2020 2020 2020 2072  ().            r
-0000bbb0: 2020 3d20 610a 2020 2020 2020 2020 2020    = a.          
-0000bbc0: 2020 6d62 203d 2062 0a20 2020 2020 2020    mb = b.       
-0000bbd0: 2020 2020 2072 6573 2e6d 3131 203d 2072       res.m11 = r
-0000bbe0: 2a6d 622e 6d31 310a 2020 2020 2020 2020  *mb.m11.        
-0000bbf0: 2020 2020 7265 732e 6d31 3220 3d20 722a      res.m12 = r*
-0000bc00: 6d62 2e6d 3132 0a20 2020 2020 2020 2020  mb.m12.         
-0000bc10: 2020 2072 6573 2e6d 3133 203d 2072 2a6d     res.m13 = r*m
-0000bc20: 622e 6d31 330a 2020 2020 2020 2020 2020  b.m13.          
-0000bc30: 2020 7265 732e 6d32 3120 3d20 722a 6d62    res.m21 = r*mb
-0000bc40: 2e6d 3231 0a20 2020 2020 2020 2020 2020  .m21.           
-0000bc50: 2072 6573 2e6d 3232 203d 2072 2a6d 622e   res.m22 = r*mb.
-0000bc60: 6d32 320a 2020 2020 2020 2020 2020 2020  m22.            
-0000bc70: 7265 732e 6d32 3320 3d20 722a 6d62 2e6d  res.m23 = r*mb.m
-0000bc80: 3233 0a20 2020 2020 2020 2020 2020 2072  23.            r
-0000bc90: 6573 2e6d 3331 203d 2072 2a6d 622e 6d33  es.m31 = r*mb.m3
-0000bca0: 310a 2020 2020 2020 2020 2020 2020 7265  1.            re
-0000bcb0: 732e 6d33 3220 3d20 722a 6d62 2e6d 3332  s.m32 = r*mb.m32
-0000bcc0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-0000bcd0: 2e6d 3333 203d 2072 2a6d 622e 6d33 330a  .m33 = r*mb.m33.
-0000bce0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000bcf0: 726e 2072 6573 0a0a 2020 2020 2020 2020  rn res..        
-0000bd00: 2320 4e6f 2076 616c 6964 2063 6f6d 6269  # No valid combi
-0000bd10: 6e61 7469 6f6e 2066 6f75 6e64 0a20 2020  nation found.   
-0000bd20: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0000bd30: 7272 6f72 2c20 2275 6e73 7570 706f 7274  rror, "unsupport
-0000bd40: 6564 206f 7065 7261 6e64 2074 7970 6520  ed operand type 
-0000bd50: 666f 7220 2a22 0a0a 2020 2020 6465 6620  for *"..    def 
-0000bd60: 5f5f 6469 765f 5f28 6d61 7433 2061 2c20  __div__(mat3 a, 
-0000bd70: 6229 3a0a 2020 2020 2020 2020 2222 2244  b):.        """D
-0000bd80: 6976 6973 696f 6e2e 0a20 2020 2020 2020  ivision..       
-0000bd90: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-0000bda0: 6620 6d61 7433 2072 6573 0a20 2020 2020  f mat3 res.     
-0000bdb0: 2020 2063 6465 6620 646f 7562 6c65 2072     cdef double r
-0000bdc0: 0a0a 2020 2020 2020 2020 7462 203d 2074  ..        tb = t
-0000bdd0: 7970 6528 6229 0a0a 2020 2020 2020 2020  ype(b)..        
-0000bde0: 6966 2074 6220 6973 2066 6c6f 6174 206f  if tb is float o
-0000bdf0: 7220 7462 2069 7320 696e 7420 6f72 2074  r tb is int or t
-0000be00: 6220 6973 206c 6f6e 673a 0a20 2020 2020  b is long:.     
-0000be10: 2020 2020 2020 2023 206d 6174 332f 7363         # mat3/sc
-0000be20: 616c 6172 0a20 2020 2020 2020 2020 2020  alar.           
-0000be30: 2072 6573 203d 206d 6174 3328 290a 2020   res = mat3().  
-0000be40: 2020 2020 2020 2020 2020 7220 3d20 620a            r = b.
-0000be50: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-0000be60: 6162 7328 7229 3c3d 6570 733a 0a20 2020  abs(r)<=eps:.   
-0000be70: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0000be80: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
-0000be90: 7272 6f72 2c22 6d61 7433 2064 6976 6973  rror,"mat3 divis
-0000bea0: 696f 6e22 0a20 2020 2020 2020 2020 2020  ion".           
-0000beb0: 2072 6573 2e6d 3131 203d 2061 2e6d 3131   res.m11 = a.m11
-0000bec0: 2f72 0a20 2020 2020 2020 2020 2020 2072  /r.            r
-0000bed0: 6573 2e6d 3132 203d 2061 2e6d 3132 2f72  es.m12 = a.m12/r
-0000bee0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-0000bef0: 2e6d 3133 203d 2061 2e6d 3133 2f72 0a20  .m13 = a.m13/r. 
-0000bf00: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-0000bf10: 3231 203d 2061 2e6d 3231 2f72 0a20 2020  21 = a.m21/r.   
-0000bf20: 2020 2020 2020 2020 2072 6573 2e6d 3232           res.m22
-0000bf30: 203d 2061 2e6d 3232 2f72 0a20 2020 2020   = a.m22/r.     
-0000bf40: 2020 2020 2020 2072 6573 2e6d 3233 203d         res.m23 =
-0000bf50: 2061 2e6d 3233 2f72 0a20 2020 2020 2020   a.m23/r.       
-0000bf60: 2020 2020 2072 6573 2e6d 3331 203d 2061       res.m31 = a
-0000bf70: 2e6d 3331 2f72 0a20 2020 2020 2020 2020  .m31/r.         
-0000bf80: 2020 2072 6573 2e6d 3332 203d 2061 2e6d     res.m32 = a.m
-0000bf90: 3332 2f72 0a20 2020 2020 2020 2020 2020  32/r.           
-0000bfa0: 2072 6573 2e6d 3333 203d 2061 2e6d 3333   res.m33 = a.m33
-0000bfb0: 2f72 0a20 2020 2020 2020 2020 2020 2072  /r.            r
-0000bfc0: 6574 7572 6e20 7265 730a 2020 2020 2020  eturn res.      
-0000bfd0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000bfe0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-0000bff0: 726f 722c 2022 756e 7375 7070 6f72 7465  ror, "unsupporte
-0000c000: 6420 6f70 6572 616e 6420 7479 7065 2066  d operand type f
-0000c010: 6f72 202f 220a 0a20 2020 2064 6566 205f  or /"..    def _
-0000c020: 5f6d 6f64 5f5f 286d 6174 3320 7365 6c66  _mod__(mat3 self
-0000c030: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
-0000c040: 2020 2222 224d 6f64 756c 6f2e 0a20 2020    """Modulo..   
-0000c050: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000c060: 2063 6465 6620 6d61 7433 206d 622c 2072   cdef mat3 mb, r
-0000c070: 6573 0a0a 2020 2020 2020 2020 7462 203d  es..        tb =
-0000c080: 2074 7970 6528 6f74 6865 7229 0a0a 2020   type(other)..  
-0000c090: 2020 2020 2020 6966 2074 6220 6973 2066        if tb is f
-0000c0a0: 6c6f 6174 206f 7220 7462 2069 7320 696e  loat or tb is in
-0000c0b0: 7420 6f72 2074 6220 6973 206c 6f6e 673a  t or tb is long:
-0000c0c0: 0a20 2020 2020 2020 2020 2020 2072 203d  .            r =
-0000c0d0: 206f 7468 6572 0a20 2020 2020 2020 2020   other.         
-0000c0e0: 2020 2069 6620 6661 6273 2872 293c 3d65     if fabs(r)<=e
-0000c0f0: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
-0000c100: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
-0000c110: 7669 7369 6f6e 4572 726f 722c 226d 6174  visionError,"mat
-0000c120: 3320 6d6f 6475 6c6f 220a 2020 2020 2020  3 modulo".      
-0000c130: 2020 2020 2020 7265 7320 3d20 6d61 7433        res = mat3
-0000c140: 2829 0a20 2020 2020 2020 2020 2020 2072  ().            r
-0000c150: 6573 2e6d 3131 203d 205f 666d 6f64 2873  es.m11 = _fmod(s
-0000c160: 656c 662e 6d31 312c 2072 290a 2020 2020  elf.m11, r).    
-0000c170: 2020 2020 2020 2020 7265 732e 6d31 3220          res.m12 
-0000c180: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3132  = _fmod(self.m12
-0000c190: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
-0000c1a0: 2072 6573 2e6d 3133 203d 205f 666d 6f64   res.m13 = _fmod
-0000c1b0: 2873 656c 662e 6d31 332c 2072 290a 2020  (self.m13, r).  
-0000c1c0: 2020 2020 2020 2020 2020 7265 732e 6d32            res.m2
-0000c1d0: 3120 3d20 5f66 6d6f 6428 7365 6c66 2e6d  1 = _fmod(self.m
-0000c1e0: 3231 2c20 7229 0a20 2020 2020 2020 2020  21, r).         
-0000c1f0: 2020 2072 6573 2e6d 3232 203d 205f 666d     res.m22 = _fm
-0000c200: 6f64 2873 656c 662e 6d32 322c 2072 290a  od(self.m22, r).
-0000c210: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-0000c220: 6d32 3320 3d20 5f66 6d6f 6428 7365 6c66  m23 = _fmod(self
-0000c230: 2e6d 3233 2c20 7229 0a20 2020 2020 2020  .m23, r).       
-0000c240: 2020 2020 2072 6573 2e6d 3331 203d 205f       res.m31 = _
-0000c250: 666d 6f64 2873 656c 662e 6d33 312c 2072  fmod(self.m31, r
-0000c260: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0000c270: 732e 6d33 3220 3d20 5f66 6d6f 6428 7365  s.m32 = _fmod(se
-0000c280: 6c66 2e6d 3332 2c20 7229 0a20 2020 2020  lf.m32, r).     
-0000c290: 2020 2020 2020 2072 6573 2e6d 3333 203d         res.m33 =
-0000c2a0: 205f 666d 6f64 2873 656c 662e 6d33 332c   _fmod(self.m33,
-0000c2b0: 2072 290a 2020 2020 2020 2020 2020 2020   r).            
-0000c2c0: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
-0000c2d0: 2020 2020 656c 6966 2074 6220 6973 206d      elif tb is m
-0000c2e0: 6174 333a 0a20 2020 2020 2020 2020 2020  at3:.           
-0000c2f0: 206d 6220 3d20 6f74 6865 720a 0a20 2020   mb = other..   
-0000c300: 2020 2020 2020 2020 2069 6620 2866 6162           if (fab
-0000c310: 7328 6d62 2e6d 3131 293c 3d65 7073 206f  s(mb.m11)<=eps o
-0000c320: 7220 6661 6273 286d 622e 6d31 3229 3c3d  r fabs(mb.m12)<=
-0000c330: 6570 7320 6f72 2066 6162 7328 6d62 2e6d  eps or fabs(mb.m
-0000c340: 3133 293c 3d65 7073 206f 720a 2020 2020  13)<=eps or.    
-0000c350: 2020 2020 2020 2020 2020 2020 6661 6273              fabs
-0000c360: 286d 622e 6d32 3129 3c3d 6570 7320 6f72  (mb.m21)<=eps or
-0000c370: 2066 6162 7328 6d62 2e6d 3232 293c 3d65   fabs(mb.m22)<=e
-0000c380: 7073 206f 7220 6661 6273 286d 622e 6d32  ps or fabs(mb.m2
-0000c390: 3329 3c3d 6570 7320 6f72 0a20 2020 2020  3)<=eps or.     
-0000c3a0: 2020 2020 2020 2020 2020 2066 6162 7328             fabs(
-0000c3b0: 6d62 2e6d 3331 293c 3d65 7073 206f 7220  mb.m31)<=eps or 
-0000c3c0: 6661 6273 286d 622e 6d33 3229 3c3d 6570  fabs(mb.m32)<=ep
-0000c3d0: 7320 6f72 2066 6162 7328 6d62 2e6d 3333  s or fabs(mb.m33
-0000c3e0: 293c 3d65 7073 293a 0a20 2020 2020 2020  )<=eps):.       
-0000c3f0: 2020 2020 2020 2020 2072 6169 7365 205a           raise Z
-0000c400: 6572 6f44 6976 6973 696f 6e45 7272 6f72  eroDivisionError
-0000c410: 2c22 6d61 7433 206d 6f64 756c 6f22 0a0a  ,"mat3 modulo"..
-0000c420: 2020 2020 2020 2020 2020 2020 7265 733d              res=
-0000c430: 6d61 7433 2829 0a20 2020 2020 2020 2020  mat3().         
-0000c440: 2020 2072 6573 2e6d 3131 203d 205f 666d     res.m11 = _fm
-0000c450: 6f64 2873 656c 662e 6d31 312c 206d 622e  od(self.m11, mb.
-0000c460: 6d31 3129 0a20 2020 2020 2020 2020 2020  m11).           
-0000c470: 2072 6573 2e6d 3132 203d 205f 666d 6f64   res.m12 = _fmod
-0000c480: 2873 656c 662e 6d31 322c 206d 622e 6d31  (self.m12, mb.m1
-0000c490: 3229 0a20 2020 2020 2020 2020 2020 2072  2).            r
-0000c4a0: 6573 2e6d 3133 203d 205f 666d 6f64 2873  es.m13 = _fmod(s
-0000c4b0: 656c 662e 6d31 332c 206d 622e 6d31 3329  elf.m13, mb.m13)
-0000c4c0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-0000c4d0: 2e6d 3231 203d 205f 666d 6f64 2873 656c  .m21 = _fmod(sel
-0000c4e0: 662e 6d32 312c 206d 622e 6d32 3129 0a20  f.m21, mb.m21). 
-0000c4f0: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-0000c500: 3232 203d 205f 666d 6f64 2873 656c 662e  22 = _fmod(self.
-0000c510: 6d32 322c 206d 622e 6d32 3229 0a20 2020  m22, mb.m22).   
-0000c520: 2020 2020 2020 2020 2072 6573 2e6d 3233           res.m23
-0000c530: 203d 205f 666d 6f64 2873 656c 662e 6d32   = _fmod(self.m2
-0000c540: 332c 206d 622e 6d32 3329 0a20 2020 2020  3, mb.m23).     
-0000c550: 2020 2020 2020 2072 6573 2e6d 3331 203d         res.m31 =
-0000c560: 205f 666d 6f64 2873 656c 662e 6d33 312c   _fmod(self.m31,
-0000c570: 206d 622e 6d33 3129 0a20 2020 2020 2020   mb.m31).       
-0000c580: 2020 2020 2072 6573 2e6d 3332 203d 205f       res.m32 = _
-0000c590: 666d 6f64 2873 656c 662e 6d33 322c 206d  fmod(self.m32, m
-0000c5a0: 622e 6d33 3229 0a20 2020 2020 2020 2020  b.m32).         
-0000c5b0: 2020 2072 6573 2e6d 3333 203d 205f 666d     res.m33 = _fm
-0000c5c0: 6f64 2873 656c 662e 6d33 332c 206d 622e  od(self.m33, mb.
-0000c5d0: 6d33 3329 0a20 2020 2020 2020 2020 2020  m33).           
-0000c5e0: 2072 6574 7572 6e20 7265 730a 0a20 2020   return res..   
-0000c5f0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000c600: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-0000c610: 6545 7272 6f72 2c20 2275 6e73 7570 706f  eError, "unsuppo
-0000c620: 7274 6564 206f 7065 7261 6e64 2074 7970  rted operand typ
-0000c630: 6520 666f 7220 2522 0a0a 0a20 2020 2064  e for %"...    d
-0000c640: 6566 205f 5f6e 6567 5f5f 2873 656c 6629  ef __neg__(self)
-0000c650: 3a0a 2020 2020 2020 2020 2222 224e 6567  :.        """Neg
-0000c660: 6174 696f 6e2e 0a20 2020 2020 2020 2022  ation..        "
-0000c670: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-0000c680: 6d61 7433 2072 6573 0a20 2020 2020 2020  mat3 res.       
-0000c690: 2072 6573 203d 206d 6174 3328 290a 2020   res = mat3().  
-0000c6a0: 2020 2020 2020 7265 732e 6d31 3120 3d20        res.m11 = 
-0000c6b0: 2d73 656c 662e 6d31 310a 2020 2020 2020  -self.m11.      
-0000c6c0: 2020 7265 732e 6d31 3220 3d20 2d73 656c    res.m12 = -sel
-0000c6d0: 662e 6d31 320a 2020 2020 2020 2020 7265  f.m12.        re
-0000c6e0: 732e 6d31 3320 3d20 2d73 656c 662e 6d31  s.m13 = -self.m1
-0000c6f0: 330a 2020 2020 2020 2020 7265 732e 6d32  3.        res.m2
-0000c700: 3120 3d20 2d73 656c 662e 6d32 310a 2020  1 = -self.m21.  
-0000c710: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
-0000c720: 2d73 656c 662e 6d32 320a 2020 2020 2020  -self.m22.      
-0000c730: 2020 7265 732e 6d32 3320 3d20 2d73 656c    res.m23 = -sel
-0000c740: 662e 6d32 330a 2020 2020 2020 2020 7265  f.m23.        re
-0000c750: 732e 6d33 3120 3d20 2d73 656c 662e 6d33  s.m31 = -self.m3
-0000c760: 310a 2020 2020 2020 2020 7265 732e 6d33  1.        res.m3
-0000c770: 3220 3d20 2d73 656c 662e 6d33 320a 2020  2 = -self.m32.  
-0000c780: 2020 2020 2020 7265 732e 6d33 3320 3d20        res.m33 = 
-0000c790: 2d73 656c 662e 6d33 330a 2020 2020 2020  -self.m33.      
-0000c7a0: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
-0000c7b0: 2020 6465 6620 5f5f 706f 735f 5f28 7365    def __pos__(se
-0000c7c0: 6c66 293a 0a20 2020 2020 2020 2063 6465  lf):.        cde
-0000c7d0: 6620 6d61 7433 2072 6573 0a20 2020 2020  f mat3 res.     
-0000c7e0: 2020 2072 6573 203d 206d 6174 3328 290a     res = mat3().
-0000c7f0: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
-0000c800: 3d20 7365 6c66 2e6d 3131 0a20 2020 2020  = self.m11.     
-0000c810: 2020 2072 6573 2e6d 3132 203d 2073 656c     res.m12 = sel
-0000c820: 662e 6d31 320a 2020 2020 2020 2020 7265  f.m12.        re
-0000c830: 732e 6d31 3320 3d20 7365 6c66 2e6d 3133  s.m13 = self.m13
-0000c840: 0a20 2020 2020 2020 2072 6573 2e6d 3231  .        res.m21
-0000c850: 203d 2073 656c 662e 6d32 310a 2020 2020   = self.m21.    
-0000c860: 2020 2020 7265 732e 6d32 3220 3d20 7365      res.m22 = se
-0000c870: 6c66 2e6d 3232 0a20 2020 2020 2020 2072  lf.m22.        r
-0000c880: 6573 2e6d 3233 203d 2073 656c 662e 6d32  es.m23 = self.m2
-0000c890: 330a 2020 2020 2020 2020 7265 732e 6d33  3.        res.m3
-0000c8a0: 3120 3d20 7365 6c66 2e6d 3331 0a20 2020  1 = self.m31.   
-0000c8b0: 2020 2020 2072 6573 2e6d 3332 203d 2073       res.m32 = s
-0000c8c0: 656c 662e 6d33 320a 2020 2020 2020 2020  elf.m32.        
-0000c8d0: 7265 732e 6d33 3320 3d20 7365 6c66 2e6d  res.m33 = self.m
-0000c8e0: 3333 0a20 2020 2020 2020 2072 6574 7572  33.        retur
-0000c8f0: 6e20 7265 730a 0a20 2020 2064 6566 205f  n res..    def _
-0000c900: 5f69 6164 645f 5f28 7365 6c66 2c20 6d61  _iadd__(self, ma
-0000c910: 7433 206f 7468 6572 293a 0a20 2020 2020  t3 other):.     
-0000c920: 2020 2022 2222 496e 6c69 6e65 206d 6174     """Inline mat
-0000c930: 7269 7820 6164 6469 7469 6f6e 2e0a 2020  rix addition..  
-0000c940: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000c950: 2020 7365 6c66 2e6d 3131 203d 2073 656c    self.m11 = sel
-0000c960: 662e 6d31 3120 2b20 6f74 6865 722e 6d31  f.m11 + other.m1
-0000c970: 310a 2020 2020 2020 2020 7365 6c66 2e6d  1.        self.m
-0000c980: 3132 203d 2073 656c 662e 6d31 3220 2b20  12 = self.m12 + 
-0000c990: 6f74 6865 722e 6d31 320a 2020 2020 2020  other.m12.      
-0000c9a0: 2020 7365 6c66 2e6d 3133 203d 2073 656c    self.m13 = sel
-0000c9b0: 662e 6d31 3320 2b20 6f74 6865 722e 6d31  f.m13 + other.m1
-0000c9c0: 330a 2020 2020 2020 2020 7365 6c66 2e6d  3.        self.m
-0000c9d0: 3231 203d 2073 656c 662e 6d32 3120 2b20  21 = self.m21 + 
-0000c9e0: 6f74 6865 722e 6d32 310a 2020 2020 2020  other.m21.      
-0000c9f0: 2020 7365 6c66 2e6d 3232 203d 2073 656c    self.m22 = sel
-0000ca00: 662e 6d32 3220 2b20 6f74 6865 722e 6d32  f.m22 + other.m2
-0000ca10: 320a 2020 2020 2020 2020 7365 6c66 2e6d  2.        self.m
-0000ca20: 3233 203d 2073 656c 662e 6d32 3320 2b20  23 = self.m23 + 
-0000ca30: 6f74 6865 722e 6d32 330a 2020 2020 2020  other.m23.      
-0000ca40: 2020 7365 6c66 2e6d 3331 203d 2073 656c    self.m31 = sel
-0000ca50: 662e 6d33 3120 2b20 6f74 6865 722e 6d33  f.m31 + other.m3
-0000ca60: 310a 2020 2020 2020 2020 7365 6c66 2e6d  1.        self.m
-0000ca70: 3332 203d 2073 656c 662e 6d33 3220 2b20  32 = self.m32 + 
-0000ca80: 6f74 6865 722e 6d33 320a 2020 2020 2020  other.m32.      
-0000ca90: 2020 7365 6c66 2e6d 3333 203d 2073 656c    self.m33 = sel
-0000caa0: 662e 6d33 3320 2b20 6f74 6865 722e 6d33  f.m33 + other.m3
-0000cab0: 330a 2020 2020 2020 2020 7265 7475 726e  3.        return
-0000cac0: 2073 656c 660a 0a20 2020 2064 6566 205f   self..    def _
-0000cad0: 5f69 7375 625f 5f28 7365 6c66 2c20 6d61  _isub__(self, ma
-0000cae0: 7433 206f 7468 6572 293a 0a20 2020 2020  t3 other):.     
-0000caf0: 2020 2022 2222 496e 6c69 6e65 206d 6174     """Inline mat
-0000cb00: 7269 7820 7375 6274 7261 6374 696f 6e2e  rix subtraction.
-0000cb10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000cb20: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
-0000cb30: 7365 6c66 2e6d 3131 202d 206f 7468 6572  self.m11 - other
-0000cb40: 2e6d 3131 0a20 2020 2020 2020 2073 656c  .m11.        sel
-0000cb50: 662e 6d31 3220 3d20 7365 6c66 2e6d 3132  f.m12 = self.m12
-0000cb60: 202d 206f 7468 6572 2e6d 3132 0a20 2020   - other.m12.   
-0000cb70: 2020 2020 2073 656c 662e 6d31 3320 3d20       self.m13 = 
-0000cb80: 7365 6c66 2e6d 3133 202d 206f 7468 6572  self.m13 - other
-0000cb90: 2e6d 3133 0a20 2020 2020 2020 2073 656c  .m13.        sel
-0000cba0: 662e 6d32 3120 3d20 7365 6c66 2e6d 3231  f.m21 = self.m21
-0000cbb0: 202d 206f 7468 6572 2e6d 3231 0a20 2020   - other.m21.   
-0000cbc0: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
-0000cbd0: 7365 6c66 2e6d 3232 202d 206f 7468 6572  self.m22 - other
-0000cbe0: 2e6d 3232 0a20 2020 2020 2020 2073 656c  .m22.        sel
-0000cbf0: 662e 6d32 3320 3d20 7365 6c66 2e6d 3233  f.m23 = self.m23
-0000cc00: 202d 206f 7468 6572 2e6d 3233 0a20 2020   - other.m23.   
-0000cc10: 2020 2020 2073 656c 662e 6d33 3120 3d20       self.m31 = 
-0000cc20: 7365 6c66 2e6d 3331 202d 206f 7468 6572  self.m31 - other
-0000cc30: 2e6d 3331 0a20 2020 2020 2020 2073 656c  .m31.        sel
-0000cc40: 662e 6d33 3220 3d20 7365 6c66 2e6d 3332  f.m32 = self.m32
-0000cc50: 202d 206f 7468 6572 2e6d 3332 0a20 2020   - other.m32.   
-0000cc60: 2020 2020 2073 656c 662e 6d33 3320 3d20       self.m33 = 
-0000cc70: 7365 6c66 2e6d 3333 202d 206f 7468 6572  self.m33 - other
-0000cc80: 2e6d 3333 0a20 2020 2020 2020 2072 6574  .m33.        ret
-0000cc90: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
-0000cca0: 6620 5f5f 696d 756c 5f5f 2873 656c 662c  f __imul__(self,
-0000ccb0: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
-0000ccc0: 2022 2222 496e 6c69 6e65 206d 756c 7469   """Inline multi
-0000ccd0: 706c 6963 6174 696f 6e20 2873 6361 6c61  plication (scala
-0000cce0: 7220 6f72 206d 6174 7269 7829 2e0a 2020  r or matrix)..  
-0000ccf0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000cd00: 2020 6364 6566 2064 6f75 626c 6520 722c    cdef double r,
-0000cd10: 2061 2c62 2c63 0a20 2020 2020 2020 2063   a,b,c.        c
-0000cd20: 6465 6620 6d61 7433 206d 620a 0a20 2020  def mat3 mb..   
-0000cd30: 2020 2020 2074 6220 3d20 7479 7065 286f       tb = type(o
-0000cd40: 7468 6572 290a 2020 2020 2020 2020 6966  ther).        if
-0000cd50: 2074 6220 6973 2066 6c6f 6174 206f 7220   tb is float or 
-0000cd60: 7462 2069 7320 696e 7420 6f72 2074 6220  tb is int or tb 
-0000cd70: 6973 206c 6f6e 673a 0a20 2020 2020 2020  is long:.       
-0000cd80: 2020 2020 2072 3d6f 7468 6572 0a20 2020       r=other.   
-0000cd90: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-0000cda0: 3120 3d20 7365 6c66 2e6d 3131 2a72 0a20  1 = self.m11*r. 
-0000cdb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000cdc0: 6d31 3220 3d20 7365 6c66 2e6d 3132 2a72  m12 = self.m12*r
-0000cdd0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000cde0: 662e 6d31 3320 3d20 7365 6c66 2e6d 3133  f.m13 = self.m13
-0000cdf0: 2a72 0a20 2020 2020 2020 2020 2020 2073  *r.            s
-0000ce00: 656c 662e 6d32 3120 3d20 7365 6c66 2e6d  elf.m21 = self.m
-0000ce10: 3231 2a72 0a20 2020 2020 2020 2020 2020  21*r.           
-0000ce20: 2073 656c 662e 6d32 3220 3d20 7365 6c66   self.m22 = self
-0000ce30: 2e6d 3232 2a72 0a20 2020 2020 2020 2020  .m22*r.         
-0000ce40: 2020 2073 656c 662e 6d32 3320 3d20 7365     self.m23 = se
-0000ce50: 6c66 2e6d 3233 2a72 0a20 2020 2020 2020  lf.m23*r.       
-0000ce60: 2020 2020 2073 656c 662e 6d33 3120 3d20       self.m31 = 
-0000ce70: 7365 6c66 2e6d 3331 2a72 0a20 2020 2020  self.m31*r.     
-0000ce80: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
-0000ce90: 3d20 7365 6c66 2e6d 3332 2a72 0a20 2020  = self.m32*r.   
-0000cea0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
-0000ceb0: 3320 3d20 7365 6c66 2e6d 3333 2a72 0a20  3 = self.m33*r. 
-0000cec0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000ced0: 6e20 7365 6c66 0a20 2020 2020 2020 2065  n self.        e
-0000cee0: 6c69 6620 7462 2069 7320 6d61 7433 3a0a  lif tb is mat3:.
-0000cef0: 2020 2020 2020 2020 2020 2020 6d62 203d              mb =
-0000cf00: 206f 7468 6572 0a20 2020 2020 2020 2020   other.         
-0000cf10: 2020 2061 203d 2073 656c 662e 6d31 310a     a = self.m11.
-0000cf20: 2020 2020 2020 2020 2020 2020 6220 3d20              b = 
-0000cf30: 7365 6c66 2e6d 3132 0a20 2020 2020 2020  self.m12.       
-0000cf40: 2020 2020 2063 203d 2073 656c 662e 6d31       c = self.m1
-0000cf50: 330a 2020 2020 2020 2020 2020 2020 7365  3.            se
-0000cf60: 6c66 2e6d 3131 203d 2061 2a6d 622e 6d31  lf.m11 = a*mb.m1
-0000cf70: 312b 622a 6d62 2e6d 3231 2b63 2a6d 622e  1+b*mb.m21+c*mb.
-0000cf80: 6d33 310a 2020 2020 2020 2020 2020 2020  m31.            
-0000cf90: 7365 6c66 2e6d 3132 203d 2061 2a6d 622e  self.m12 = a*mb.
-0000cfa0: 6d31 322b 622a 6d62 2e6d 3232 2b63 2a6d  m12+b*mb.m22+c*m
-0000cfb0: 622e 6d33 320a 2020 2020 2020 2020 2020  b.m32.          
-0000cfc0: 2020 7365 6c66 2e6d 3133 203d 2061 2a6d    self.m13 = a*m
-0000cfd0: 622e 6d31 332b 622a 6d62 2e6d 3233 2b63  b.m13+b*mb.m23+c
-0000cfe0: 2a6d 622e 6d33 330a 2020 2020 2020 2020  *mb.m33.        
-0000cff0: 2020 2020 6120 3d20 7365 6c66 2e6d 3231      a = self.m21
-0000d000: 0a20 2020 2020 2020 2020 2020 2062 203d  .            b =
-0000d010: 2073 656c 662e 6d32 320a 2020 2020 2020   self.m22.      
-0000d020: 2020 2020 2020 6320 3d20 7365 6c66 2e6d        c = self.m
-0000d030: 3233 0a20 2020 2020 2020 2020 2020 2073  23.            s
-0000d040: 656c 662e 6d32 3120 3d20 612a 6d62 2e6d  elf.m21 = a*mb.m
-0000d050: 3131 2b62 2a6d 622e 6d32 312b 632a 6d62  11+b*mb.m21+c*mb
-0000d060: 2e6d 3331 0a20 2020 2020 2020 2020 2020  .m31.           
-0000d070: 2073 656c 662e 6d32 3220 3d20 612a 6d62   self.m22 = a*mb
-0000d080: 2e6d 3132 2b62 2a6d 622e 6d32 322b 632a  .m12+b*mb.m22+c*
-0000d090: 6d62 2e6d 3332 0a20 2020 2020 2020 2020  mb.m32.         
-0000d0a0: 2020 2073 656c 662e 6d32 3320 3d20 612a     self.m23 = a*
-0000d0b0: 6d62 2e6d 3133 2b62 2a6d 622e 6d32 332b  mb.m13+b*mb.m23+
-0000d0c0: 632a 6d62 2e6d 3333 0a20 2020 2020 2020  c*mb.m33.       
-0000d0d0: 2020 2020 2061 203d 2073 656c 662e 6d33       a = self.m3
-0000d0e0: 310a 2020 2020 2020 2020 2020 2020 6220  1.            b 
-0000d0f0: 3d20 7365 6c66 2e6d 3332 0a20 2020 2020  = self.m32.     
-0000d100: 2020 2020 2020 2063 203d 2073 656c 662e         c = self.
-0000d110: 6d33 330a 2020 2020 2020 2020 2020 2020  m33.            
-0000d120: 7365 6c66 2e6d 3331 203d 2061 2a6d 622e  self.m31 = a*mb.
-0000d130: 6d31 312b 622a 6d62 2e6d 3231 2b63 2a6d  m11+b*mb.m21+c*m
-0000d140: 622e 6d33 310a 2020 2020 2020 2020 2020  b.m31.          
-0000d150: 2020 7365 6c66 2e6d 3332 203d 2061 2a6d    self.m32 = a*m
-0000d160: 622e 6d31 322b 622a 6d62 2e6d 3232 2b63  b.m12+b*mb.m22+c
-0000d170: 2a6d 622e 6d33 320a 2020 2020 2020 2020  *mb.m32.        
-0000d180: 2020 2020 7365 6c66 2e6d 3333 203d 2061      self.m33 = a
-0000d190: 2a6d 622e 6d31 332b 622a 6d62 2e6d 3233  *mb.m13+b*mb.m23
-0000d1a0: 2b63 2a6d 622e 6d33 330a 2020 2020 2020  +c*mb.m33.      
-0000d1b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000d1c0: 660a 2020 2020 2020 2020 656c 7365 3a0a  f.        else:.
-0000d1d0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000d1e0: 6520 5479 7065 4572 726f 722c 2022 756e  e TypeError, "un
-0000d1f0: 7375 7070 6f72 7465 6420 6f70 6572 616e  supported operan
-0000d200: 6420 7479 7065 2066 6f72 202a 3d22 0a0a  d type for *="..
-0000d210: 2020 2020 6465 6620 5f5f 6964 6976 5f5f      def __idiv__
-0000d220: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
-0000d230: 2020 2020 2020 2022 2222 496e 6c69 6e65         """Inline
-0000d240: 2064 6976 6973 696f 6e20 7769 7468 2073   division with s
-0000d250: 6361 6c61 722e 0a20 2020 2020 2020 2022  calar..        "
-0000d260: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-0000d270: 646f 7562 6c65 2072 0a20 2020 2020 2020  double r.       
-0000d280: 2074 6220 3d20 7479 7065 286f 7468 6572   tb = type(other
-0000d290: 290a 2020 2020 2020 2020 6966 2074 6220  ).        if tb 
-0000d2a0: 6973 2066 6c6f 6174 206f 7220 7462 2069  is float or tb i
-0000d2b0: 7320 696e 7420 6f72 2074 6220 6973 206c  s int or tb is l
-0000d2c0: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
-0000d2d0: 2072 3d6f 7468 6572 0a20 2020 2020 2020   r=other.       
-0000d2e0: 2020 2020 2069 6620 6661 6273 2872 293c       if fabs(r)<
-0000d2f0: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
-0000d300: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
-0000d310: 4469 7669 7369 6f6e 4572 726f 722c 226d  DivisionError,"m
-0000d320: 6174 3320 6469 7669 7369 6f6e 220a 2020  at3 division".  
-0000d330: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000d340: 3131 203d 2073 656c 662e 6d31 312f 720a  11 = self.m11/r.
-0000d350: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000d360: 2e6d 3132 203d 2073 656c 662e 6d31 322f  .m12 = self.m12/
-0000d370: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-0000d380: 6c66 2e6d 3133 203d 2073 656c 662e 6d31  lf.m13 = self.m1
-0000d390: 332f 720a 2020 2020 2020 2020 2020 2020  3/r.            
-0000d3a0: 7365 6c66 2e6d 3231 203d 2073 656c 662e  self.m21 = self.
-0000d3b0: 6d32 312f 720a 2020 2020 2020 2020 2020  m21/r.          
-0000d3c0: 2020 7365 6c66 2e6d 3232 203d 2073 656c    self.m22 = sel
-0000d3d0: 662e 6d32 322f 720a 2020 2020 2020 2020  f.m22/r.        
-0000d3e0: 2020 2020 7365 6c66 2e6d 3233 203d 2073      self.m23 = s
-0000d3f0: 656c 662e 6d32 332f 720a 2020 2020 2020  elf.m23/r.      
-0000d400: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
-0000d410: 2073 656c 662e 6d33 312f 720a 2020 2020   self.m31/r.    
-0000d420: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
-0000d430: 203d 2073 656c 662e 6d33 322f 720a 2020   = self.m32/r.  
-0000d440: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000d450: 3333 203d 2073 656c 662e 6d33 332f 720a  33 = self.m33/r.
-0000d460: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000d470: 726e 2073 656c 660a 2020 2020 2020 2020  rn self.        
-0000d480: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000d490: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-0000d4a0: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
-0000d4b0: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
-0000d4c0: 202f 3d22 0a0a 2020 2020 6465 6620 5f5f   /="..    def __
-0000d4d0: 696d 6f64 5f5f 2873 656c 662c 2062 293a  imod__(self, b):
-0000d4e0: 0a20 2020 2020 2020 2022 2222 496e 6c69  .        """Inli
-0000d4f0: 6e65 206d 6f64 756c 6f2e 0a20 2020 2020  ne modulo..     
-0000d500: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-0000d510: 6465 6620 6d61 7433 206d 620a 2020 2020  def mat3 mb.    
-0000d520: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
-0000d530: 720a 0a20 2020 2020 2020 2074 6220 3d20  r..        tb = 
-0000d540: 7479 7065 2862 290a 0a20 2020 2020 2020  type(b)..       
-0000d550: 2069 6620 7462 2069 7320 666c 6f61 7420   if tb is float 
-0000d560: 6f72 2074 6220 6973 2069 6e74 206f 7220  or tb is int or 
-0000d570: 7462 2069 7320 6c6f 6e67 3a0a 2020 2020  tb is long:.    
-0000d580: 2020 2020 2020 2020 7220 3d20 620a 2020          r = b.  
-0000d590: 2020 2020 2020 2020 2020 6966 2066 6162            if fab
-0000d5a0: 7328 7229 3c3d 6570 733a 0a20 2020 2020  s(r)<=eps:.     
-0000d5b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000d5c0: 205a 6572 6f44 6976 6973 696f 6e45 7272   ZeroDivisionErr
-0000d5d0: 6f72 2c22 6d61 7433 206d 6f64 756c 6f22  or,"mat3 modulo"
-0000d5e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000d5f0: 662e 6d31 3120 3d20 5f66 6d6f 6428 7365  f.m11 = _fmod(se
-0000d600: 6c66 2e6d 3131 2c20 7229 0a20 2020 2020  lf.m11, r).     
-0000d610: 2020 2020 2020 2073 656c 662e 6d31 3220         self.m12 
-0000d620: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3132  = _fmod(self.m12
-0000d630: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
-0000d640: 2073 656c 662e 6d31 3320 3d20 5f66 6d6f   self.m13 = _fmo
-0000d650: 6428 7365 6c66 2e6d 3133 2c20 7229 0a20  d(self.m13, r). 
-0000d660: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d670: 6d32 3120 3d20 5f66 6d6f 6428 7365 6c66  m21 = _fmod(self
-0000d680: 2e6d 3231 2c20 7229 0a20 2020 2020 2020  .m21, r).       
-0000d690: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
-0000d6a0: 5f66 6d6f 6428 7365 6c66 2e6d 3232 2c20  _fmod(self.m22, 
-0000d6b0: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
-0000d6c0: 656c 662e 6d32 3320 3d20 5f66 6d6f 6428  elf.m23 = _fmod(
-0000d6d0: 7365 6c66 2e6d 3233 2c20 7229 0a20 2020  self.m23, r).   
-0000d6e0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
-0000d6f0: 3120 3d20 5f66 6d6f 6428 7365 6c66 2e6d  1 = _fmod(self.m
-0000d700: 3331 2c20 7229 0a20 2020 2020 2020 2020  31, r).         
-0000d710: 2020 2073 656c 662e 6d33 3220 3d20 5f66     self.m32 = _f
-0000d720: 6d6f 6428 7365 6c66 2e6d 3332 2c20 7229  mod(self.m32, r)
-0000d730: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000d740: 662e 6d33 3320 3d20 5f66 6d6f 6428 7365  f.m33 = _fmod(se
-0000d750: 6c66 2e6d 3333 2c20 7229 0a20 2020 2020  lf.m33, r).     
-0000d760: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000d770: 6c66 0a20 2020 2020 2020 2065 6c69 6620  lf.        elif 
-0000d780: 7462 2069 7320 6d61 7433 3a0a 2020 2020  tb is mat3:.    
-0000d790: 2020 2020 2020 2020 6d62 203d 2062 0a20          mb = b. 
-0000d7a0: 2020 2020 2020 2020 2020 2069 6620 2866             if (f
-0000d7b0: 6162 7328 6d62 2e6d 3131 293c 3d65 7073  abs(mb.m11)<=eps
-0000d7c0: 206f 7220 6661 6273 286d 622e 6d31 3229   or fabs(mb.m12)
-0000d7d0: 3c3d 6570 7320 6f72 2066 6162 7328 6d62  <=eps or fabs(mb
-0000d7e0: 2e6d 3133 293c 3d65 7073 206f 720a 2020  .m13)<=eps or.  
-0000d7f0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-0000d800: 6273 286d 622e 6d32 3129 3c3d 6570 7320  bs(mb.m21)<=eps 
-0000d810: 6f72 2066 6162 7328 6d62 2e6d 3232 293c  or fabs(mb.m22)<
-0000d820: 3d65 7073 206f 7220 6661 6273 286d 622e  =eps or fabs(mb.
-0000d830: 6d32 3329 3c3d 6570 7320 6f72 0a20 2020  m23)<=eps or.   
-0000d840: 2020 2020 2020 2020 2020 2020 2066 6162               fab
-0000d850: 7328 6d62 2e6d 3331 293c 3d65 7073 206f  s(mb.m31)<=eps o
-0000d860: 7220 6661 6273 286d 622e 6d33 3229 3c3d  r fabs(mb.m32)<=
-0000d870: 6570 7320 6f72 2066 6162 7328 6d62 2e6d  eps or fabs(mb.m
-0000d880: 3333 293c 3d65 7073 293a 0a20 2020 2020  33)<=eps):.     
-0000d890: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000d8a0: 205a 6572 6f44 6976 6973 696f 6e45 7272   ZeroDivisionErr
-0000d8b0: 6f72 2c22 6d61 7433 206d 6f64 756c 6f22  or,"mat3 modulo"
-0000d8c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000d8d0: 662e 6d31 3120 3d20 5f66 6d6f 6428 7365  f.m11 = _fmod(se
-0000d8e0: 6c66 2e6d 3131 2c20 6d62 2e6d 3131 290a  lf.m11, mb.m11).
-0000d8f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000d900: 2e6d 3132 203d 205f 666d 6f64 2873 656c  .m12 = _fmod(sel
-0000d910: 662e 6d31 322c 206d 622e 6d31 3229 0a20  f.m12, mb.m12). 
-0000d920: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000d930: 6d31 3320 3d20 5f66 6d6f 6428 7365 6c66  m13 = _fmod(self
-0000d940: 2e6d 3133 2c20 6d62 2e6d 3133 290a 2020  .m13, mb.m13).  
-0000d950: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000d960: 3231 203d 205f 666d 6f64 2873 656c 662e  21 = _fmod(self.
-0000d970: 6d32 312c 206d 622e 6d32 3129 0a20 2020  m21, mb.m21).   
-0000d980: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-0000d990: 3220 3d20 5f66 6d6f 6428 7365 6c66 2e6d  2 = _fmod(self.m
-0000d9a0: 3232 2c20 6d62 2e6d 3232 290a 2020 2020  22, mb.m22).    
-0000d9b0: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
-0000d9c0: 203d 205f 666d 6f64 2873 656c 662e 6d32   = _fmod(self.m2
-0000d9d0: 332c 206d 622e 6d32 3329 0a20 2020 2020  3, mb.m23).     
-0000d9e0: 2020 2020 2020 2073 656c 662e 6d33 3120         self.m31 
-0000d9f0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3331  = _fmod(self.m31
-0000da00: 2c20 6d62 2e6d 3331 290a 2020 2020 2020  , mb.m31).      
-0000da10: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
-0000da20: 205f 666d 6f64 2873 656c 662e 6d33 322c   _fmod(self.m32,
-0000da30: 206d 622e 6d33 3229 0a20 2020 2020 2020   mb.m32).       
-0000da40: 2020 2020 2073 656c 662e 6d33 3320 3d20       self.m33 = 
-0000da50: 5f66 6d6f 6428 7365 6c66 2e6d 3333 2c20  _fmod(self.m33, 
-0000da60: 6d62 2e6d 3333 290a 2020 2020 2020 2020  mb.m33).        
-0000da70: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
-0000da80: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000da90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000daa0: 5479 7065 4572 726f 722c 2022 756e 7375  TypeError, "unsu
-0000dab0: 7070 6f72 7465 6420 6f70 6572 616e 6420  pported operand 
-0000dac0: 7479 7065 2066 6f72 2025 3d22 0a0a 0a20  type for %="... 
-0000dad0: 2020 2064 6566 205f 5f6c 656e 5f5f 2873     def __len__(s
-0000dae0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0000daf0: 224c 656e 6774 6820 6f66 2074 6865 2073  "Length of the s
-0000db00: 6571 7565 6e63 6520 2861 6c77 6179 7320  equence (always 
-0000db10: 3329 2e22 2222 0a20 2020 2020 2020 2072  3).""".        r
-0000db20: 6574 7572 6e20 330a 0a20 2020 2064 6566  eturn 3..    def
-0000db30: 205f 5f67 6574 6974 656d 5f5f 286d 6174   __getitem__(mat
-0000db40: 3320 7365 6c66 2c20 6b65 7929 3a0a 2020  3 self, key):.  
-0000db50: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-0000db60: 6120 636f 6c75 6d6e 206f 7220 6120 7369  a column or a si
-0000db70: 6e67 6c65 206d 6174 7269 7820 656c 656d  ngle matrix elem
-0000db80: 656e 742e 0a20 2020 2020 2020 2022 2222  ent..        """
-0000db90: 0a20 2020 2020 2020 2063 6465 6620 696e  .        cdef in
-0000dba0: 7420 692c 6a0a 0a20 2020 2020 2020 2054  t i,j..        T
-0000dbb0: 3d74 7970 6528 6b65 7929 0a20 2020 2020  =type(key).     
-0000dbc0: 2020 2069 6620 5420 6973 2069 6e74 206f     if T is int o
-0000dbd0: 7220 5420 6973 206c 6f6e 673a 0a20 2020  r T is long:.   
-0000dbe0: 2020 2020 2020 2020 2069 203d 206b 6579           i = key
-0000dbf0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000dc00: 693d 3d30 3a0a 2020 2020 2020 2020 2020  i==0:.          
-0000dc10: 2020 2020 2020 7265 7475 726e 2076 6563        return vec
-0000dc20: 3328 7365 6c66 2e6d 3131 2c20 7365 6c66  3(self.m11, self
-0000dc30: 2e6d 3231 2c20 7365 6c66 2e6d 3331 290a  .m21, self.m31).
-0000dc40: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0000dc50: 2069 3d3d 313a 0a20 2020 2020 2020 2020   i==1:.         
-0000dc60: 2020 2020 2020 2072 6574 7572 6e20 7665         return ve
-0000dc70: 6333 2873 656c 662e 6d31 322c 2073 656c  c3(self.m12, sel
-0000dc80: 662e 6d32 322c 2073 656c 662e 6d33 3229  f.m22, self.m32)
-0000dc90: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0000dca0: 6620 693d 3d32 3a0a 2020 2020 2020 2020  f i==2:.        
-0000dcb0: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-0000dcc0: 6563 3328 7365 6c66 2e6d 3133 2c20 7365  ec3(self.m13, se
-0000dcd0: 6c66 2e6d 3233 2c20 7365 6c66 2e6d 3333  lf.m23, self.m33
-0000dce0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-0000dcf0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000dd00: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
-0000dd10: 7272 6f72 2c20 2269 6e64 6578 206f 7574  rror, "index out
-0000dd20: 206f 6620 7261 6e67 6522 0a20 2020 2020   of range".     
-0000dd30: 2020 2065 6c69 6620 5420 6973 2074 7570     elif T is tup
-0000dd40: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-0000dd50: 6966 206c 656e 286b 6579 2921 3d32 3a0a  if len(key)!=2:.
-0000dd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dd70: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0000dd80: 2c20 2269 6e64 6578 2074 7570 6c65 206d  , "index tuple m
-0000dd90: 7573 7420 6265 2061 2032 2d74 7570 6c65  ust be a 2-tuple
-0000dda0: 220a 2020 2020 2020 2020 2020 2020 6920  ".            i 
-0000ddb0: 3d20 6b65 795b 305d 0a20 2020 2020 2020  = key[0].       
-0000ddc0: 2020 2020 206a 203d 206b 6579 5b31 5d0a       j = key[1].
-0000ddd0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0000dde0: 3c30 206f 7220 693e 3220 6f72 206a 3c30  <0 or i>2 or j<0
-0000ddf0: 206f 7220 6a3e 323a 0a20 2020 2020 2020   or j>2:.       
-0000de00: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
-0000de10: 6e64 6578 4572 726f 722c 2022 696e 6465  ndexError, "inde
-0000de20: 7820 6f75 7420 6f66 2072 616e 6765 220a  x out of range".
-0000de30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000de40: 693d 3d30 3a0a 2020 2020 2020 2020 2020  i==0:.          
-0000de50: 2020 2020 2020 6966 206a 3d3d 303a 0a20        if j==0:. 
-0000de60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000de70: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-0000de80: 3131 0a20 2020 2020 2020 2020 2020 2020  11.             
-0000de90: 2020 2065 6c69 6620 6a3d 3d31 3a0a 2020     elif j==1:.  
-0000dea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000deb0: 2020 7265 7475 726e 2073 656c 662e 6d31    return self.m1
-0000dec0: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
-0000ded0: 2020 656c 6966 206a 3d3d 323a 0a20 2020    elif j==2:.   
-0000dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000def0: 2072 6574 7572 6e20 7365 6c66 2e6d 3133   return self.m13
-0000df00: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0000df10: 6620 693d 3d31 3a0a 2020 2020 2020 2020  f i==1:.        
-0000df20: 2020 2020 2020 2020 6966 206a 3d3d 303a          if j==0:
-0000df30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000df40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000df50: 2e6d 3231 0a20 2020 2020 2020 2020 2020  .m21.           
-0000df60: 2020 2020 2065 6c69 6620 6a3d 3d31 3a0a       elif j==1:.
-0000df70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000df80: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000df90: 6d32 320a 2020 2020 2020 2020 2020 2020  m22.            
-0000dfa0: 2020 2020 656c 6966 206a 3d3d 323a 0a20      elif j==2:. 
-0000dfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dfc0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-0000dfd0: 3233 0a20 2020 2020 2020 2020 2020 2065  23.            e
-0000dfe0: 6c69 6620 693d 3d32 3a0a 2020 2020 2020  lif i==2:.      
-0000dff0: 2020 2020 2020 2020 2020 6966 206a 3d3d            if j==
-0000e000: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0000e010: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000e020: 6c66 2e6d 3331 0a20 2020 2020 2020 2020  lf.m31.         
-0000e030: 2020 2020 2020 2065 6c69 6620 6a3d 3d31         elif j==1
-0000e040: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000e050: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000e060: 662e 6d33 320a 2020 2020 2020 2020 2020  f.m32.          
-0000e070: 2020 2020 2020 656c 6966 206a 3d3d 323a        elif j==2:
-0000e080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e090: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000e0a0: 2e6d 3333 0a20 2020 2020 2020 2065 6c73  .m33.        els
-0000e0b0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000e0c0: 6169 7365 2054 7970 6545 7272 6f72 2c22  aise TypeError,"
-0000e0d0: 696e 6465 7820 6d75 7374 2062 6520 696e  index must be in
-0000e0e0: 7465 6765 7220 6f72 2032 2d74 7570 6c65  teger or 2-tuple
-0000e0f0: 220a 0a20 2020 2064 6566 205f 5f73 6574  "..    def __set
-0000e100: 6974 656d 5f5f 2873 656c 662c 206b 6579  item__(self, key
-0000e110: 2c20 7661 6c75 6529 3a0a 2020 2020 2020  , value):.      
-0000e120: 2020 2222 2253 6574 2061 2063 6f6c 756d    """Set a colum
-0000e130: 6e20 6f72 2061 2073 696e 676c 6520 6d61  n or a single ma
-0000e140: 7472 6978 2065 6c65 6d65 6e74 2e0a 0a20  trix element... 
-0000e150: 2020 2020 2020 2054 6865 2063 6f6c 756d         The colum
-0000e160: 6e20 6d75 7374 2062 6520 6769 7665 6e20  n must be given 
-0000e170: 6173 2061 2033 2d73 6571 7565 6e63 6520  as a 3-sequence 
-0000e180: 2874 6869 7320 696e 636c 7564 6573 2076  (this includes v
-0000e190: 6563 3320 6173 2077 656c 6c29 2e0a 2020  ec3 as well)..  
-0000e1a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0000e1b0: 2020 6364 6566 2069 6e74 2069 2c6a 0a20    cdef int i,j. 
-0000e1c0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-0000e1d0: 6c65 2076 0a0a 2020 2020 2020 2020 543d  le v..        T=
-0000e1e0: 7479 7065 286b 6579 290a 2020 2020 2020  type(key).      
-0000e1f0: 2020 6966 2054 2069 7320 696e 7420 6f72    if T is int or
-0000e200: 2054 2069 7320 6c6f 6e67 3a0a 2020 2020   T is long:.    
-0000e210: 2020 2020 2020 2020 6966 206c 656e 2876          if len(v
-0000e220: 616c 7565 2921 3d33 3a0a 2020 2020 2020  alue)!=3:.      
-0000e230: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000e240: 5661 6c75 6545 7272 6f72 2c20 2233 2d73  ValueError, "3-s
-0000e250: 6571 7565 6e63 6520 6578 7065 6374 6564  equence expected
-0000e260: 220a 2020 2020 2020 2020 2020 2020 6920  ".            i 
-0000e270: 3d20 6b65 790a 2020 2020 2020 2020 2020  = key.          
-0000e280: 2020 6966 2069 3d3d 303a 0a20 2020 2020    if i==0:.     
-0000e290: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000e2a0: 6d31 3120 3d20 7661 6c75 655b 305d 0a20  m11 = value[0]. 
-0000e2b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000e2c0: 656c 662e 6d32 3120 3d20 7661 6c75 655b  elf.m21 = value[
-0000e2d0: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-0000e2e0: 2020 2073 656c 662e 6d33 3120 3d20 7661     self.m31 = va
-0000e2f0: 6c75 655b 325d 0a20 2020 2020 2020 2020  lue[2].         
-0000e300: 2020 2065 6c69 6620 693d 3d31 3a0a 2020     elif i==1:.  
-0000e310: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000e320: 6c66 2e6d 3132 203d 2076 616c 7565 5b30  lf.m12 = value[0
-0000e330: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0000e340: 2020 7365 6c66 2e6d 3232 203d 2076 616c    self.m22 = val
-0000e350: 7565 5b31 5d0a 2020 2020 2020 2020 2020  ue[1].          
-0000e360: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
-0000e370: 2076 616c 7565 5b32 5d0a 2020 2020 2020   value[2].      
-0000e380: 2020 2020 2020 656c 6966 2069 3d3d 323a        elif i==2:
-0000e390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e3a0: 2073 656c 662e 6d31 3320 3d20 7661 6c75   self.m13 = valu
-0000e3b0: 655b 305d 0a20 2020 2020 2020 2020 2020  e[0].           
-0000e3c0: 2020 2020 2073 656c 662e 6d32 3320 3d20       self.m23 = 
-0000e3d0: 7661 6c75 655b 315d 0a20 2020 2020 2020  value[1].       
-0000e3e0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
-0000e3f0: 3320 3d20 7661 6c75 655b 325d 0a20 2020  3 = value[2].   
-0000e400: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0000e410: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000e420: 6169 7365 2049 6e64 6578 4572 726f 722c  aise IndexError,
-0000e430: 2022 696e 6465 7820 6f75 7420 6f66 2072   "index out of r
-0000e440: 616e 6765 220a 2020 2020 2020 2020 656c  ange".        el
-0000e450: 6966 2054 2069 7320 7475 706c 653a 0a20  if T is tuple:. 
-0000e460: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0000e470: 6e28 6b65 7929 213d 323a 0a20 2020 2020  n(key)!=2:.     
-0000e480: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000e490: 2056 616c 7565 4572 726f 722c 2022 696e   ValueError, "in
-0000e4a0: 6465 7820 7475 706c 6520 6d75 7374 2062  dex tuple must b
-0000e4b0: 6520 6120 322d 7475 706c 6522 0a20 2020  e a 2-tuple".   
-0000e4c0: 2020 2020 2020 2020 2069 203d 206b 6579           i = key
-0000e4d0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-0000e4e0: 6a20 3d20 6b65 795b 315d 0a20 2020 2020  j = key[1].     
-0000e4f0: 2020 2020 2020 2076 203d 2076 616c 7565         v = value
-0000e500: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000e510: 693c 3020 6f72 2069 3e32 206f 7220 6a3c  i<0 or i>2 or j<
-0000e520: 3020 6f72 206a 3e32 3a0a 2020 2020 2020  0 or j>2:.      
-0000e530: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000e540: 496e 6465 7845 7272 6f72 2c20 2269 6e64  IndexError, "ind
-0000e550: 6578 206f 7574 206f 6620 7261 6e67 6522  ex out of range"
-0000e560: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0000e570: 2069 3d3d 303a 0a20 2020 2020 2020 2020   i==0:.         
-0000e580: 2020 2020 2020 2069 6620 6a3d 3d30 3a0a         if j==0:.
-0000e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e5a0: 2020 2020 7365 6c66 2e6d 3131 203d 2076      self.m11 = v
-0000e5b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e5c0: 2065 6c69 6620 6a3d 3d31 3a0a 2020 2020   elif j==1:.    
-0000e5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e5e0: 7365 6c66 2e6d 3132 203d 2076 0a20 2020  self.m12 = v.   
-0000e5f0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0000e600: 6620 6a3d 3d32 3a0a 2020 2020 2020 2020  f j==2:.        
-0000e610: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000e620: 2e6d 3133 203d 2076 0a20 2020 2020 2020  .m13 = v.       
-0000e630: 2020 2020 2065 6c69 6620 693d 3d31 3a0a       elif i==1:.
-0000e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e650: 6966 206a 3d3d 303a 0a20 2020 2020 2020  if j==0:.       
-0000e660: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000e670: 662e 6d32 3120 3d20 760a 2020 2020 2020  f.m21 = v.      
-0000e680: 2020 2020 2020 2020 2020 656c 6966 206a            elif j
-0000e690: 3d3d 313a 0a20 2020 2020 2020 2020 2020  ==1:.           
-0000e6a0: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-0000e6b0: 3220 3d20 760a 2020 2020 2020 2020 2020  2 = v.          
-0000e6c0: 2020 2020 2020 656c 6966 206a 3d3d 323a        elif j==2:
-0000e6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e6e0: 2020 2020 2073 656c 662e 6d32 3320 3d20       self.m23 = 
-0000e6f0: 760a 2020 2020 2020 2020 2020 2020 656c  v.            el
-0000e700: 6966 2069 3d3d 323a 0a20 2020 2020 2020  if i==2:.       
-0000e710: 2020 2020 2020 2020 2069 6620 6a3d 3d30           if j==0
-0000e720: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000e730: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
-0000e740: 2076 0a20 2020 2020 2020 2020 2020 2020   v.             
-0000e750: 2020 2065 6c69 6620 6a3d 3d31 3a0a 2020     elif j==1:.  
-0000e760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e770: 2020 7365 6c66 2e6d 3332 203d 2076 0a20    self.m32 = v. 
-0000e780: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000e790: 6c69 6620 6a3d 3d32 3a0a 2020 2020 2020  lif j==2:.      
-0000e7a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000e7b0: 6c66 2e6d 3333 203d 2076 0a20 2020 2020  lf.m33 = v.     
-0000e7c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000e7d0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0000e7e0: 7272 6f72 2c22 696e 6465 7820 6d75 7374  rror,"index must
-0000e7f0: 2062 6520 696e 7465 6765 7220 6f72 2032   be integer or 2
-0000e800: 2d74 7570 6c65 220a 0a20 2020 2064 6566  -tuple"..    def
-0000e810: 2067 6574 526f 7728 7365 6c66 2c20 6964   getRow(self, id
-0000e820: 7829 3a0a 2020 2020 2020 2020 2222 2252  x):.        """R
-0000e830: 6574 7572 6e20 726f 7720 2861 7320 7665  eturn row (as ve
-0000e840: 6333 292e 2222 220a 2020 2020 2020 2020  c3).""".        
-0000e850: 6364 6566 2069 6e74 2069 0a0a 2020 2020  cdef int i..    
-0000e860: 2020 2020 543d 7479 7065 2869 6478 290a      T=type(idx).
-0000e870: 2020 2020 2020 2020 6966 2054 213d 696e          if T!=in
-0000e880: 7420 616e 6420 5421 3d6c 6f6e 673a 0a20  t and T!=long:. 
-0000e890: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000e8a0: 2054 7970 6545 7272 6f72 2c22 696e 6465   TypeError,"inde
-0000e8b0: 7820 6d75 7374 2062 6520 696e 7465 6765  x must be intege
-0000e8c0: 7222 0a0a 2020 2020 2020 2020 6920 3d20  r"..        i = 
-0000e8d0: 6964 780a 2020 2020 2020 2020 6966 2069  idx.        if i
-0000e8e0: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
-0000e8f0: 2072 6574 7572 6e20 7665 6333 2873 656c   return vec3(sel
-0000e900: 662e 6d31 312c 2073 656c 662e 6d31 322c  f.m11, self.m12,
-0000e910: 2073 656c 662e 6d31 3329 0a20 2020 2020   self.m13).     
-0000e920: 2020 2065 6c69 6620 693d 3d31 3a0a 2020     elif i==1:.  
-0000e930: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000e940: 2076 6563 3328 7365 6c66 2e6d 3231 2c20   vec3(self.m21, 
-0000e950: 7365 6c66 2e6d 3232 2c20 7365 6c66 2e6d  self.m22, self.m
-0000e960: 3233 290a 2020 2020 2020 2020 656c 6966  23).        elif
-0000e970: 2069 3d3d 323a 0a20 2020 2020 2020 2020   i==2:.         
-0000e980: 2020 2072 6574 7572 6e20 7665 6333 2873     return vec3(s
-0000e990: 656c 662e 6d33 312c 2073 656c 662e 6d33  elf.m31, self.m3
-0000e9a0: 322c 2073 656c 662e 6d33 3329 0a20 2020  2, self.m33).   
-0000e9b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000e9c0: 2020 2020 2020 2072 6169 7365 2049 6e64         raise Ind
-0000e9d0: 6578 4572 726f 722c 2022 696e 6465 7820  exError, "index 
-0000e9e0: 6f75 7420 6f66 2072 616e 6765 220a 0a20  out of range".. 
-0000e9f0: 2020 2064 6566 2073 6574 526f 7728 7365     def setRow(se
-0000ea00: 6c66 2c20 6964 782c 2076 616c 7565 293a  lf, idx, value):
-0000ea10: 0a20 2020 2020 2020 2022 2222 5365 7420  .        """Set 
-0000ea20: 726f 772e 2222 220a 2020 2020 2020 2020  row.""".        
-0000ea30: 6364 6566 2069 6e74 2069 0a0a 2020 2020  cdef int i..    
-0000ea40: 2020 2020 543d 7479 7065 2869 6478 290a      T=type(idx).
-0000ea50: 2020 2020 2020 2020 6966 2054 213d 696e          if T!=in
-0000ea60: 7420 616e 6420 5421 3d6c 6f6e 673a 0a20  t and T!=long:. 
-0000ea70: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000ea80: 2054 7970 6545 7272 6f72 2c22 696e 6465   TypeError,"inde
-0000ea90: 7820 6d75 7374 2062 6520 696e 7465 6765  x must be intege
-0000eaa0: 7222 0a0a 2020 2020 2020 2020 6966 206c  r"..        if l
-0000eab0: 656e 2876 616c 7565 2921 3d33 3a0a 2020  en(value)!=3:.  
-0000eac0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000ead0: 5661 6c75 6545 7272 6f72 2c20 2233 2d73  ValueError, "3-s
-0000eae0: 6571 7565 6e63 6520 6578 7065 6374 6564  equence expected
-0000eaf0: 220a 0a20 2020 2020 2020 2069 203d 2069  "..        i = i
-0000eb00: 6478 0a20 2020 2020 2020 2069 6620 693d  dx.        if i=
-0000eb10: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
-0000eb20: 7365 6c66 2e6d 3131 203d 2076 616c 7565  self.m11 = value
-0000eb30: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-0000eb40: 7365 6c66 2e6d 3132 203d 2076 616c 7565  self.m12 = value
-0000eb50: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-0000eb60: 7365 6c66 2e6d 3133 203d 2076 616c 7565  self.m13 = value
-0000eb70: 5b32 5d0a 2020 2020 2020 2020 656c 6966  [2].        elif
-0000eb80: 2069 3d3d 313a 0a20 2020 2020 2020 2020   i==1:.         
-0000eb90: 2020 2073 656c 662e 6d32 3120 3d20 7661     self.m21 = va
-0000eba0: 6c75 655b 305d 0a20 2020 2020 2020 2020  lue[0].         
-0000ebb0: 2020 2073 656c 662e 6d32 3220 3d20 7661     self.m22 = va
-0000ebc0: 6c75 655b 315d 0a20 2020 2020 2020 2020  lue[1].         
-0000ebd0: 2020 2073 656c 662e 6d32 3320 3d20 7661     self.m23 = va
-0000ebe0: 6c75 655b 325d 0a20 2020 2020 2020 2065  lue[2].        e
-0000ebf0: 6c69 6620 693d 3d32 3a0a 2020 2020 2020  lif i==2:.      
-0000ec00: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
-0000ec10: 2076 616c 7565 5b30 5d0a 2020 2020 2020   value[0].      
-0000ec20: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
-0000ec30: 2076 616c 7565 5b31 5d0a 2020 2020 2020   value[1].      
-0000ec40: 2020 2020 2020 7365 6c66 2e6d 3333 203d        self.m33 =
-0000ec50: 2076 616c 7565 5b32 5d0a 2020 2020 2020   value[2].      
-0000ec60: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000ec70: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
-0000ec80: 7272 6f72 2c20 2269 6e64 6578 206f 7574  rror, "index out
-0000ec90: 206f 6620 7261 6e67 6522 0a0a 0a20 2020   of range"...   
-0000eca0: 2064 6566 2067 6574 436f 6c75 6d6e 2873   def getColumn(s
-0000ecb0: 656c 662c 2069 6478 293a 0a20 2020 2020  elf, idx):.     
-0000ecc0: 2020 2022 2222 5265 7475 726e 2063 6f6c     """Return col
-0000ecd0: 756d 6e20 2861 7320 7665 6333 292e 2222  umn (as vec3).""
-0000ece0: 220a 2020 2020 2020 2020 6364 6566 2069  ".        cdef i
-0000ecf0: 6e74 2069 0a0a 2020 2020 2020 2020 543d  nt i..        T=
-0000ed00: 7479 7065 2869 6478 290a 2020 2020 2020  type(idx).      
-0000ed10: 2020 6966 2054 213d 696e 7420 616e 6420    if T!=int and 
-0000ed20: 5421 3d6c 6f6e 673a 0a20 2020 2020 2020  T!=long:.       
-0000ed30: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0000ed40: 7272 6f72 2c22 696e 6465 7820 6d75 7374  rror,"index must
-0000ed50: 2062 6520 696e 7465 6765 7222 0a0a 2020   be integer"..  
-0000ed60: 2020 2020 2020 6920 3d20 6964 780a 2020        i = idx.  
-0000ed70: 2020 2020 2020 6966 2069 3d3d 303a 0a20        if i==0:. 
-0000ed80: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000ed90: 6e20 7665 6333 2873 656c 662e 6d31 312c  n vec3(self.m11,
-0000eda0: 2073 656c 662e 6d32 312c 2073 656c 662e   self.m21, self.
-0000edb0: 6d33 3129 0a20 2020 2020 2020 2065 6c69  m31).        eli
-0000edc0: 6620 693d 3d31 3a0a 2020 2020 2020 2020  f i==1:.        
-0000edd0: 2020 2020 7265 7475 726e 2076 6563 3328      return vec3(
-0000ede0: 7365 6c66 2e6d 3132 2c20 7365 6c66 2e6d  self.m12, self.m
-0000edf0: 3232 2c20 7365 6c66 2e6d 3332 290a 2020  22, self.m32).  
-0000ee00: 2020 2020 2020 656c 6966 2069 3d3d 323a        elif i==2:
-0000ee10: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000ee20: 7572 6e20 7665 6333 2873 656c 662e 6d31  urn vec3(self.m1
-0000ee30: 332c 2073 656c 662e 6d32 332c 2073 656c  3, self.m23, sel
-0000ee40: 662e 6d33 3329 0a20 2020 2020 2020 2065  f.m33).        e
-0000ee50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000ee60: 2072 6169 7365 2049 6e64 6578 4572 726f   raise IndexErro
-0000ee70: 722c 2022 696e 6465 7820 6f75 7420 6f66  r, "index out of
-0000ee80: 2072 616e 6765 220a 0a20 2020 2064 6566   range"..    def
-0000ee90: 2073 6574 436f 6c75 6d6e 2873 656c 662c   setColumn(self,
-0000eea0: 2069 6478 2c20 7661 6c75 6529 3a0a 2020   idx, value):.  
-0000eeb0: 2020 2020 2020 2222 2253 6574 2063 6f6c        """Set col
-0000eec0: 756d 6e2e 2222 220a 2020 2020 2020 2020  umn.""".        
-0000eed0: 6364 6566 2069 6e74 2069 0a0a 2020 2020  cdef int i..    
-0000eee0: 2020 2020 543d 7479 7065 2869 6478 290a      T=type(idx).
-0000eef0: 2020 2020 2020 2020 6966 2054 213d 696e          if T!=in
-0000ef00: 7420 616e 6420 5421 3d6c 6f6e 673a 0a20  t and T!=long:. 
-0000ef10: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000ef20: 2054 7970 6545 7272 6f72 2c22 696e 6465   TypeError,"inde
-0000ef30: 7820 6d75 7374 2062 6520 696e 7465 6765  x must be intege
-0000ef40: 7222 0a0a 2020 2020 2020 2020 6966 206c  r"..        if l
-0000ef50: 656e 2876 616c 7565 2921 3d33 3a0a 2020  en(value)!=3:.  
-0000ef60: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000ef70: 5661 6c75 6545 7272 6f72 2c20 2233 2d73  ValueError, "3-s
-0000ef80: 6571 7565 6e63 6520 6578 7065 6374 6564  equence expected
-0000ef90: 220a 0a20 2020 2020 2020 2069 203d 2069  "..        i = i
-0000efa0: 6478 0a20 2020 2020 2020 2069 6620 693d  dx.        if i=
-0000efb0: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
-0000efc0: 7365 6c66 2e6d 3131 203d 2076 616c 7565  self.m11 = value
-0000efd0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-0000efe0: 7365 6c66 2e6d 3231 203d 2076 616c 7565  self.m21 = value
-0000eff0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
-0000f000: 7365 6c66 2e6d 3331 203d 2076 616c 7565  self.m31 = value
-0000f010: 5b32 5d0a 2020 2020 2020 2020 656c 6966  [2].        elif
-0000f020: 2069 3d3d 313a 0a20 2020 2020 2020 2020   i==1:.         
-0000f030: 2020 2073 656c 662e 6d31 3220 3d20 7661     self.m12 = va
-0000f040: 6c75 655b 305d 0a20 2020 2020 2020 2020  lue[0].         
-0000f050: 2020 2073 656c 662e 6d32 3220 3d20 7661     self.m22 = va
-0000f060: 6c75 655b 315d 0a20 2020 2020 2020 2020  lue[1].         
-0000f070: 2020 2073 656c 662e 6d33 3220 3d20 7661     self.m32 = va
-0000f080: 6c75 655b 325d 0a20 2020 2020 2020 2065  lue[2].        e
-0000f090: 6c69 6620 693d 3d32 3a0a 2020 2020 2020  lif i==2:.      
-0000f0a0: 2020 2020 2020 7365 6c66 2e6d 3133 203d        self.m13 =
-0000f0b0: 2076 616c 7565 5b30 5d0a 2020 2020 2020   value[0].      
-0000f0c0: 2020 2020 2020 7365 6c66 2e6d 3233 203d        self.m23 =
-0000f0d0: 2076 616c 7565 5b31 5d0a 2020 2020 2020   value[1].      
-0000f0e0: 2020 2020 2020 7365 6c66 2e6d 3333 203d        self.m33 =
-0000f0f0: 2076 616c 7565 5b32 5d0a 2020 2020 2020   value[2].      
-0000f100: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000f110: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
-0000f120: 7272 6f72 2c20 2269 6e64 6578 206f 7574  rror, "index out
-0000f130: 206f 6620 7261 6e67 6522 0a0a 0a20 2020   of range"...   
-0000f140: 2064 6566 2074 6f4c 6973 7428 7365 6c66   def toList(self
-0000f150: 2c20 726f 776d 616a 6f72 3d30 293a 0a20  , rowmajor=0):. 
-0000f160: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-0000f170: 2061 206c 6973 7420 636f 6e74 6169 6e69   a list containi
-0000f180: 6e67 2074 6865 206d 6174 7269 7820 656c  ng the matrix el
-0000f190: 656d 656e 7473 2e0a 0a20 2020 2020 2020  ements...       
-0000f1a0: 2042 7920 6465 6661 756c 7420 7468 6520   By default the 
-0000f1b0: 6c69 7374 2069 7320 696e 2063 6f6c 756d  list is in colum
-0000f1c0: 6e2d 6d61 6a6f 7220 6f72 6465 722e 2049  n-major order. I
-0000f1d0: 6620 796f 7520 7365 7420 7468 650a 2020  f you set the.  
-0000f1e0: 2020 2020 2020 6f70 7469 6f6e 616c 2061        optional a
-0000f1f0: 7267 756d 656e 7420 726f 776d 616a 6f72  rgument rowmajor
-0000f200: 2074 6f20 312c 2079 6f75 276c 6c20 6765   to 1, you'll ge
-0000f210: 7420 7468 6520 6c69 7374 2069 6e20 726f  t the list in ro
-0000f220: 772d 6d61 6a6f 720a 2020 2020 2020 2020  w-major.        
-0000f230: 6f72 6465 722e 0a20 2020 2020 2020 2022  order..        "
-0000f240: 2222 0a20 2020 2020 2020 2069 6620 726f  "".        if ro
-0000f250: 776d 616a 6f72 3a0a 2020 2020 2020 2020  wmajor:.        
-0000f260: 2020 2020 7265 7475 726e 205b 7365 6c66      return [self
-0000f270: 2e6d 3131 2c20 7365 6c66 2e6d 3132 2c20  .m11, self.m12, 
-0000f280: 7365 6c66 2e6d 3133 2c0a 2020 2020 2020  self.m13,.      
-0000f290: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000f2a0: 6c66 2e6d 3231 2c20 7365 6c66 2e6d 3232  lf.m21, self.m22
-0000f2b0: 2c20 7365 6c66 2e6d 3233 2c0a 2020 2020  , self.m23,.    
-0000f2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f2d0: 7365 6c66 2e6d 3331 2c20 7365 6c66 2e6d  self.m31, self.m
-0000f2e0: 3332 2c20 7365 6c66 2e6d 3333 5d0a 2020  32, self.m33].  
-0000f2f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000f300: 2020 2020 2020 2020 7265 7475 726e 205b          return [
-0000f310: 7365 6c66 2e6d 3131 2c20 7365 6c66 2e6d  self.m11, self.m
-0000f320: 3231 2c20 7365 6c66 2e6d 3331 2c0a 2020  21, self.m31,.  
-0000f330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f340: 2020 7365 6c66 2e6d 3132 2c20 7365 6c66    self.m12, self
-0000f350: 2e6d 3232 2c20 7365 6c66 2e6d 3332 2c0a  .m22, self.m32,.
-0000f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f370: 2020 2020 7365 6c66 2e6d 3133 2c20 7365      self.m13, se
-0000f380: 6c66 2e6d 3233 2c20 7365 6c66 2e6d 3333  lf.m23, self.m33
-0000f390: 5d0a 0a0a 2020 2020 6465 6620 6964 656e  ]...    def iden
-0000f3a0: 7469 7479 2873 656c 6629 3a0a 2020 2020  tity(self):.    
-0000f3b0: 2020 2020 2222 2252 6574 7572 6e20 6964      """Return id
-0000f3c0: 656e 7469 7479 206d 6174 7269 782e 0a20  entity matrix.. 
-0000f3d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000f3e0: 2020 2063 6465 6620 6d61 7433 2072 6573     cdef mat3 res
-0000f3f0: 0a20 2020 2020 2020 2072 6573 203d 206d  .        res = m
-0000f400: 6174 3328 290a 2020 2020 2020 2020 7265  at3().        re
-0000f410: 732e 6d31 3120 3d20 312e 300a 2020 2020  s.m11 = 1.0.    
-0000f420: 2020 2020 7265 732e 6d31 3220 3d20 302e      res.m12 = 0.
-0000f430: 300a 2020 2020 2020 2020 7265 732e 6d31  0.        res.m1
-0000f440: 3320 3d20 302e 300a 2020 2020 2020 2020  3 = 0.0.        
-0000f450: 7265 732e 6d32 3120 3d20 302e 300a 2020  res.m21 = 0.0.  
-0000f460: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
-0000f470: 312e 300a 2020 2020 2020 2020 7265 732e  1.0.        res.
-0000f480: 6d32 3320 3d20 302e 300a 2020 2020 2020  m23 = 0.0.      
-0000f490: 2020 7265 732e 6d33 3120 3d20 302e 300a    res.m31 = 0.0.
-0000f4a0: 2020 2020 2020 2020 7265 732e 6d33 3220          res.m32 
-0000f4b0: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
-0000f4c0: 732e 6d33 3320 3d20 312e 300a 2020 2020  s.m33 = 1.0.    
-0000f4d0: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-0000f4e0: 2020 2020 6465 6620 7472 616e 7370 6f73      def transpos
-0000f4f0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-0000f500: 2022 2222 5265 7475 726e 2074 7261 6e73   """Return trans
-0000f510: 706f 7365 206d 6174 7269 782e 0a20 2020  pose matrix..   
-0000f520: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000f530: 2063 6465 6620 6d61 7433 2072 6573 0a20   cdef mat3 res. 
-0000f540: 2020 2020 2020 2072 6573 203d 206d 6174         res = mat
-0000f550: 3328 290a 2020 2020 2020 2020 7265 732e  3().        res.
-0000f560: 6d31 3120 3d20 7365 6c66 2e6d 3131 0a20  m11 = self.m11. 
-0000f570: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
-0000f580: 2073 656c 662e 6d32 310a 2020 2020 2020   self.m21.      
-0000f590: 2020 7265 732e 6d31 3320 3d20 7365 6c66    res.m13 = self
-0000f5a0: 2e6d 3331 0a20 2020 2020 2020 2072 6573  .m31.        res
-0000f5b0: 2e6d 3231 203d 2073 656c 662e 6d31 320a  .m21 = self.m12.
-0000f5c0: 2020 2020 2020 2020 7265 732e 6d32 3220          res.m22 
-0000f5d0: 3d20 7365 6c66 2e6d 3232 0a20 2020 2020  = self.m22.     
-0000f5e0: 2020 2072 6573 2e6d 3233 203d 2073 656c     res.m23 = sel
-0000f5f0: 662e 6d33 320a 2020 2020 2020 2020 7265  f.m32.        re
-0000f600: 732e 6d33 3120 3d20 7365 6c66 2e6d 3133  s.m31 = self.m13
-0000f610: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
-0000f620: 203d 2073 656c 662e 6d32 330a 2020 2020   = self.m23.    
-0000f630: 2020 2020 7265 732e 6d33 3320 3d20 7365      res.m33 = se
-0000f640: 6c66 2e6d 3333 0a20 2020 2020 2020 2072  lf.m33.        r
-0000f650: 6574 7572 6e20 7265 730a 0a20 2020 2064  eturn res..    d
-0000f660: 6566 2064 6574 6572 6d69 6e61 6e74 2873  ef determinant(s
-0000f670: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0000f680: 2252 6574 7572 6e20 6465 7465 726d 696e  "Return determin
-0000f690: 616e 742e 0a20 2020 2020 2020 2022 2222  ant..        """
-0000f6a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000f6b0: 7365 6c66 2e6d 3131 2a73 656c 662e 6d32  self.m11*self.m2
-0000f6c0: 322a 7365 6c66 2e6d 3333 2b20 5c0a 2020  2*self.m33+ \.  
-0000f6d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000f6e0: 662e 6d31 322a 7365 6c66 2e6d 3233 2a73  f.m12*self.m23*s
-0000f6f0: 656c 662e 6d33 312b 205c 0a20 2020 2020  elf.m31+ \.     
-0000f700: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-0000f710: 3133 2a73 656c 662e 6d32 312a 7365 6c66  13*self.m21*self
-0000f720: 2e6d 3332 2d20 5c0a 2020 2020 2020 2020  .m32- \.        
-0000f730: 2020 2020 2020 2073 656c 662e 6d33 312a         self.m31*
-0000f740: 7365 6c66 2e6d 3232 2a73 656c 662e 6d31  self.m22*self.m1
-0000f750: 332d 205c 0a20 2020 2020 2020 2020 2020  3- \.           
-0000f760: 2020 2020 7365 6c66 2e6d 3332 2a73 656c      self.m32*sel
-0000f770: 662e 6d32 332a 7365 6c66 2e6d 3131 2d20  f.m23*self.m11- 
-0000f780: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0000f790: 2073 656c 662e 6d33 332a 7365 6c66 2e6d   self.m33*self.m
-0000f7a0: 3231 2a73 656c 662e 6d31 320a 0a20 2020  21*self.m12..   
-0000f7b0: 2064 6566 2069 6e76 6572 7365 2873 656c   def inverse(sel
-0000f7c0: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-0000f7d0: 6574 7572 6e20 696e 7665 7273 6520 6d61  eturn inverse ma
-0000f7e0: 7472 6978 2e22 2222 0a20 2020 2020 2020  trix.""".       
-0000f7f0: 2063 6465 6620 6d61 7433 2072 6573 0a20   cdef mat3 res. 
-0000f800: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-0000f810: 6c65 2064 0a0a 2020 2020 2020 2020 6420  le d..        d 
-0000f820: 3d20 7365 6c66 2e64 6574 6572 6d69 6e61  = self.determina
-0000f830: 6e74 2829 0a20 2020 2020 2020 2069 6620  nt().        if 
-0000f840: 6661 6273 2864 293c 3d65 7073 3a0a 2020  fabs(d)<=eps:.  
-0000f850: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000f860: 5a65 726f 4469 7669 7369 6f6e 4572 726f  ZeroDivisionErro
-0000f870: 722c 2022 6d61 7472 6978 2069 7320 6e6f  r, "matrix is no
-0000f880: 7420 696e 7665 7274 6962 6c65 220a 0a20  t invertible".. 
-0000f890: 2020 2020 2020 2064 203d 2031 2e30 2f64         d = 1.0/d
-0000f8a0: 0a0a 2020 2020 2020 2020 7265 733d 6d61  ..        res=ma
-0000f8b0: 7433 2829 0a20 2020 2020 2020 2072 6573  t3().        res
-0000f8c0: 2e6d 3131 203d 2064 2a28 7365 6c66 2e6d  .m11 = d*(self.m
-0000f8d0: 3232 2a73 656c 662e 6d33 332d 7365 6c66  22*self.m33-self
-0000f8e0: 2e6d 3233 2a73 656c 662e 6d33 3229 0a20  .m23*self.m32). 
-0000f8f0: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
-0000f900: 2064 2a28 7365 6c66 2e6d 3332 2a73 656c   d*(self.m32*sel
-0000f910: 662e 6d31 332d 7365 6c66 2e6d 3132 2a73  f.m13-self.m12*s
-0000f920: 656c 662e 6d33 3329 0a20 2020 2020 2020  elf.m33).       
-0000f930: 2072 6573 2e6d 3133 203d 2064 2a28 7365   res.m13 = d*(se
-0000f940: 6c66 2e6d 3132 2a73 656c 662e 6d32 332d  lf.m12*self.m23-
-0000f950: 7365 6c66 2e6d 3232 2a73 656c 662e 6d31  self.m22*self.m1
-0000f960: 3329 0a20 2020 2020 2020 2072 6573 2e6d  3).        res.m
-0000f970: 3231 203d 2064 2a28 7365 6c66 2e6d 3233  21 = d*(self.m23
-0000f980: 2a73 656c 662e 6d33 312d 7365 6c66 2e6d  *self.m31-self.m
-0000f990: 3231 2a73 656c 662e 6d33 3329 0a20 2020  21*self.m33).   
-0000f9a0: 2020 2020 2072 6573 2e6d 3232 203d 2064       res.m22 = d
-0000f9b0: 2a28 7365 6c66 2e6d 3131 2a73 656c 662e  *(self.m11*self.
-0000f9c0: 6d33 332d 7365 6c66 2e6d 3331 2a73 656c  m33-self.m31*sel
-0000f9d0: 662e 6d31 3329 0a20 2020 2020 2020 2072  f.m13).        r
-0000f9e0: 6573 2e6d 3233 203d 2064 2a28 7365 6c66  es.m23 = d*(self
-0000f9f0: 2e6d 3231 2a73 656c 662e 6d31 332d 7365  .m21*self.m13-se
-0000fa00: 6c66 2e6d 3131 2a73 656c 662e 6d32 3329  lf.m11*self.m23)
-0000fa10: 0a20 2020 2020 2020 2072 6573 2e6d 3331  .        res.m31
-0000fa20: 203d 2064 2a28 7365 6c66 2e6d 3231 2a73   = d*(self.m21*s
-0000fa30: 656c 662e 6d33 322d 7365 6c66 2e6d 3331  elf.m32-self.m31
-0000fa40: 2a73 656c 662e 6d32 3229 0a20 2020 2020  *self.m22).     
-0000fa50: 2020 2072 6573 2e6d 3332 203d 2064 2a28     res.m32 = d*(
-0000fa60: 7365 6c66 2e6d 3331 2a73 656c 662e 6d31  self.m31*self.m1
-0000fa70: 322d 7365 6c66 2e6d 3131 2a73 656c 662e  2-self.m11*self.
-0000fa80: 6d33 3229 0a20 2020 2020 2020 2072 6573  m32).        res
-0000fa90: 2e6d 3333 203d 2064 2a28 7365 6c66 2e6d  .m33 = d*(self.m
-0000faa0: 3131 2a73 656c 662e 6d32 322d 7365 6c66  11*self.m22-self
-0000fab0: 2e6d 3132 2a73 656c 662e 6d32 3129 0a20  .m12*self.m21). 
-0000fac0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-0000fad0: 730a 0a20 2020 2064 6566 2073 6361 6c69  s..    def scali
-0000fae0: 6e67 2873 656c 662c 2073 293a 0a20 2020  ng(self, s):.   
-0000faf0: 2020 2020 2022 2222 5265 7475 726e 2073       """Return s
-0000fb00: 6361 6c69 6e67 206d 6174 7269 782e 2222  caling matrix.""
-0000fb10: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
-0000fb20: 6174 3320 7265 730a 2020 2020 2020 2020  at3 res.        
-0000fb30: 7265 7320 3d20 6d61 7433 2829 0a20 2020  res = mat3().   
-0000fb40: 2020 2020 2072 6573 2e6d 3131 203d 2073       res.m11 = s
-0000fb50: 5b30 5d0a 2020 2020 2020 2020 7265 732e  [0].        res.
-0000fb60: 6d31 3220 3d20 302e 300a 2020 2020 2020  m12 = 0.0.      
-0000fb70: 2020 7265 732e 6d31 3320 3d20 302e 300a    res.m13 = 0.0.
-0000fb80: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
-0000fb90: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
-0000fba0: 732e 6d32 3220 3d20 735b 315d 0a20 2020  s.m22 = s[1].   
-0000fbb0: 2020 2020 2072 6573 2e6d 3233 203d 2030       res.m23 = 0
-0000fbc0: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
-0000fbd0: 3331 203d 2030 2e30 0a20 2020 2020 2020  31 = 0.0.       
-0000fbe0: 2072 6573 2e6d 3332 203d 2030 2e30 0a20   res.m32 = 0.0. 
-0000fbf0: 2020 2020 2020 2072 6573 2e6d 3333 203d         res.m33 =
-0000fc00: 2073 5b32 5d0a 2020 2020 2020 2020 7265   s[2].        re
-0000fc10: 7475 726e 2072 6573 0a0a 2020 2020 6465  turn res..    de
-0000fc20: 6620 726f 7461 7469 6f6e 2873 656c 662c  f rotation(self,
-0000fc30: 2061 6e67 6c65 2c20 6178 6973 293a 0a20   angle, axis):. 
-0000fc40: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-0000fc50: 2072 6f74 6174 696f 6e20 6d61 7472 6978   rotation matrix
-0000fc60: 2e0a 0a20 2020 2020 2020 2061 6e67 6c65  ...        angle
-0000fc70: 206d 7573 7420 6265 2067 6976 656e 2069   must be given i
-0000fc80: 6e20 7261 6469 616e 732e 2061 7869 7320  n radians. axis 
-0000fc90: 6d75 7374 2062 6520 6120 332d 7365 7175  must be a 3-sequ
-0000fca0: 656e 6365 2e0a 2020 2020 2020 2020 2222  ence..        ""
-0000fcb0: 220a 2020 2020 2020 2020 6364 6566 2064  ".        cdef d
-0000fcc0: 6f75 626c 6520 6361 6e67 6c65 2c20 6178  ouble cangle, ax
-0000fcd0: 2c20 6179 2c20 617a 0a20 2020 2020 2020  , ay, az.       
-0000fce0: 2063 6465 6620 646f 7562 6c65 2073 7172   cdef double sqr
-0000fcf0: 5f61 2c20 7371 725f 622c 2073 7172 5f63  _a, sqr_b, sqr_c
-0000fd00: 2c20 6c65 6e32 0a20 2020 2020 2020 2063  , len2.        c
-0000fd10: 6465 6620 646f 7562 6c65 206b 312c 206b  def double k1, k
-0000fd20: 322c 206b 332c 206b 3161 622c 206b 3161  2, k3, k1ab, k1a
-0000fd30: 632c 206b 3162 632c 206b 3361 2c20 6b33  c, k1bc, k3a, k3
-0000fd40: 622c 206b 3363 0a20 2020 2020 2020 2063  b, k3c.        c
-0000fd50: 6465 6620 6d61 7433 2072 6573 0a0a 2020  def mat3 res..  
-0000fd60: 2020 2020 2020 6361 6e67 6c65 2020 203d        cangle   =
-0000fd70: 2061 6e67 6c65 0a20 2020 2020 2020 2061   angle.        a
-0000fd80: 7820 2020 203d 2061 7869 735b 305d 0a20  x    = axis[0]. 
-0000fd90: 2020 2020 2020 2061 7920 2020 203d 2061         ay    = a
-0000fda0: 7869 735b 315d 0a20 2020 2020 2020 2061  xis[1].        a
-0000fdb0: 7a20 2020 203d 2061 7869 735b 325d 0a20  z    = axis[2]. 
-0000fdc0: 2020 2020 2020 2073 7172 5f61 203d 2061         sqr_a = a
-0000fdd0: 782a 6178 0a20 2020 2020 2020 2073 7172  x*ax.        sqr
-0000fde0: 5f62 203d 2061 792a 6179 0a20 2020 2020  _b = ay*ay.     
-0000fdf0: 2020 2073 7172 5f63 203d 2061 7a2a 617a     sqr_c = az*az
-0000fe00: 0a20 2020 2020 2020 206c 656e 3220 203d  .        len2  =
-0000fe10: 2073 7172 5f61 2b73 7172 5f62 2b73 7172   sqr_a+sqr_b+sqr
-0000fe20: 5f63 0a0a 2020 2020 2020 2020 6b32 2020  _c..        k2  
-0000fe30: 2020 3d20 636f 7328 6361 6e67 6c65 290a    = cos(cangle).
-0000fe40: 2020 2020 2020 2020 6b31 2020 2020 3d20          k1    = 
-0000fe50: 2831 2e30 2d6b 3229 2f6c 656e 320a 2020  (1.0-k2)/len2.  
-0000fe60: 2020 2020 2020 6b33 2020 2020 3d20 7369        k3    = si
-0000fe70: 6e28 6361 6e67 6c65 292f 7371 7274 286c  n(cangle)/sqrt(l
-0000fe80: 656e 3229 0a20 2020 2020 2020 206b 3161  en2).        k1a
-0000fe90: 6220 203d 206b 312a 6178 2a61 790a 2020  b  = k1*ax*ay.  
-0000fea0: 2020 2020 2020 6b31 6163 2020 3d20 6b31        k1ac  = k1
-0000feb0: 2a61 782a 617a 0a20 2020 2020 2020 206b  *ax*az.        k
-0000fec0: 3162 6320 203d 206b 312a 6179 2a61 7a0a  1bc  = k1*ay*az.
-0000fed0: 2020 2020 2020 2020 6b33 6120 2020 3d20          k3a   = 
-0000fee0: 6b33 2a61 780a 2020 2020 2020 2020 6b33  k3*ax.        k3
-0000fef0: 6220 2020 3d20 6b33 2a61 790a 2020 2020  b   = k3*ay.    
-0000ff00: 2020 2020 6b33 6320 2020 3d20 6b33 2a61      k3c   = k3*a
-0000ff10: 7a0a 0a20 2020 2020 2020 2072 6573 203d  z..        res =
-0000ff20: 206d 6174 3328 290a 2020 2020 2020 2020   mat3().        
-0000ff30: 7265 732e 6d31 3120 3d20 6b31 2a73 7172  res.m11 = k1*sqr
-0000ff40: 5f61 2b6b 320a 2020 2020 2020 2020 7265  _a+k2.        re
-0000ff50: 732e 6d31 3220 3d20 6b31 6162 2d6b 3363  s.m12 = k1ab-k3c
-0000ff60: 0a20 2020 2020 2020 2072 6573 2e6d 3133  .        res.m13
-0000ff70: 203d 206b 3161 632b 6b33 620a 2020 2020   = k1ac+k3b.    
-0000ff80: 2020 2020 7265 732e 6d32 3120 3d20 6b31      res.m21 = k1
-0000ff90: 6162 2b6b 3363 0a20 2020 2020 2020 2072  ab+k3c.        r
-0000ffa0: 6573 2e6d 3232 203d 206b 312a 7371 725f  es.m22 = k1*sqr_
-0000ffb0: 622b 6b32 0a20 2020 2020 2020 2072 6573  b+k2.        res
-0000ffc0: 2e6d 3233 203d 206b 3162 632d 6b33 610a  .m23 = k1bc-k3a.
-0000ffd0: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
-0000ffe0: 3d20 6b31 6163 2d6b 3362 0a20 2020 2020  = k1ac-k3b.     
-0000fff0: 2020 2072 6573 2e6d 3332 203d 206b 3162     res.m32 = k1b
-00010000: 632b 6b33 610a 2020 2020 2020 2020 7265  c+k3a.        re
-00010010: 732e 6d33 3320 3d20 6b31 2a73 7172 5f63  s.m33 = k1*sqr_c
-00010020: 2b6b 320a 2020 2020 2020 2020 7265 7475  +k2.        retu
-00010030: 726e 2072 6573 0a0a 0a20 2020 2064 6566  rn res...    def
-00010040: 2073 6361 6c65 2873 656c 662c 2073 293a   scale(self, s):
-00010050: 0a20 2020 2020 2020 2022 2222 436f 6e63  .        """Conc
-00010060: 6174 656e 6174 6520 6120 7363 616c 696e  atenate a scalin
-00010070: 672e 2222 220a 2020 2020 2020 2020 6364  g.""".        cd
-00010080: 6566 2064 6f75 626c 6520 7378 2c20 7379  ef double sx, sy
-00010090: 2c20 737a 0a20 2020 2020 2020 2073 7820  , sz.        sx 
-000100a0: 3d20 735b 305d 0a20 2020 2020 2020 2073  = s[0].        s
-000100b0: 7920 3d20 735b 315d 0a20 2020 2020 2020  y = s[1].       
-000100c0: 2073 7a20 3d20 735b 325d 0a20 2020 2020   sz = s[2].     
-000100d0: 2020 2073 656c 662e 6d31 3120 3d20 7365     self.m11 = se
-000100e0: 6c66 2e6d 3131 2a73 780a 2020 2020 2020  lf.m11*sx.      
-000100f0: 2020 7365 6c66 2e6d 3132 203d 2073 656c    self.m12 = sel
-00010100: 662e 6d31 322a 7379 0a20 2020 2020 2020  f.m12*sy.       
-00010110: 2073 656c 662e 6d31 3320 3d20 7365 6c66   self.m13 = self
-00010120: 2e6d 3133 2a73 7a0a 2020 2020 2020 2020  .m13*sz.        
-00010130: 7365 6c66 2e6d 3231 203d 2073 656c 662e  self.m21 = self.
-00010140: 6d32 312a 7378 0a20 2020 2020 2020 2073  m21*sx.        s
-00010150: 656c 662e 6d32 3220 3d20 7365 6c66 2e6d  elf.m22 = self.m
-00010160: 3232 2a73 790a 2020 2020 2020 2020 7365  22*sy.        se
-00010170: 6c66 2e6d 3233 203d 2073 656c 662e 6d32  lf.m23 = self.m2
-00010180: 332a 737a 0a20 2020 2020 2020 2073 656c  3*sz.        sel
-00010190: 662e 6d33 3120 3d20 7365 6c66 2e6d 3331  f.m31 = self.m31
-000101a0: 2a73 780a 2020 2020 2020 2020 7365 6c66  *sx.        self
-000101b0: 2e6d 3332 203d 2073 656c 662e 6d33 322a  .m32 = self.m32*
-000101c0: 7379 0a20 2020 2020 2020 2073 656c 662e  sy.        self.
-000101d0: 6d33 3320 3d20 7365 6c66 2e6d 3333 2a73  m33 = self.m33*s
-000101e0: 7a0a 2020 2020 2020 2020 7265 7475 726e  z.        return
-000101f0: 2073 656c 660a 0a20 2020 2064 6566 2072   self..    def r
-00010200: 6f74 6174 6528 7365 6c66 2c20 616e 676c  otate(self, angl
-00010210: 652c 2061 7869 7329 3a0a 2020 2020 2020  e, axis):.      
-00010220: 2020 2222 2243 6f6e 6361 7465 6e61 7465    """Concatenate
-00010230: 2061 2072 6f74 6174 696f 6e2e 0a0a 2020   a rotation...  
-00010240: 2020 2020 2020 616e 676c 6520 6d75 7374        angle must
-00010250: 2062 6520 6769 7665 6e20 696e 2072 6164   be given in rad
-00010260: 6961 6e73 2e20 6178 6973 206d 7573 7420  ians. axis must 
-00010270: 6265 2061 2033 2d73 6571 7565 6e63 652e  be a 3-sequence.
-00010280: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00010290: 2020 2020 2063 6465 6620 6d61 7433 2052       cdef mat3 R
-000102a0: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
-000102b0: 7562 6c65 2063 312c 2063 322c 2063 330a  uble c1, c2, c3.
-000102c0: 2020 2020 2020 2020 523d 7365 6c66 2e72          R=self.r
-000102d0: 6f74 6174 696f 6e28 616e 676c 652c 2061  otation(angle, a
-000102e0: 7869 7329 0a0a 2020 2020 2020 2020 2320  xis)..        # 
-000102f0: 7365 6c66 2a52 2020 2869 6e2d 706c 6163  self*R  (in-plac
-00010300: 6529 0a20 2020 2020 2020 2063 3120 3d20  e).        c1 = 
-00010310: 7365 6c66 2e6d 3131 0a20 2020 2020 2020  self.m11.       
-00010320: 2063 3220 3d20 7365 6c66 2e6d 3132 0a20   c2 = self.m12. 
-00010330: 2020 2020 2020 2063 3320 3d20 7365 6c66         c3 = self
-00010340: 2e6d 3133 0a20 2020 2020 2020 2073 656c  .m13.        sel
-00010350: 662e 6d31 3120 3d20 6331 2a52 2e6d 3131  f.m11 = c1*R.m11
-00010360: 2b63 322a 522e 6d32 312b 6333 2a52 2e6d  +c2*R.m21+c3*R.m
-00010370: 3331 0a20 2020 2020 2020 2073 656c 662e  31.        self.
-00010380: 6d31 3220 3d20 6331 2a52 2e6d 3132 2b63  m12 = c1*R.m12+c
-00010390: 322a 522e 6d32 322b 6333 2a52 2e6d 3332  2*R.m22+c3*R.m32
-000103a0: 0a20 2020 2020 2020 2073 656c 662e 6d31  .        self.m1
-000103b0: 3320 3d20 6331 2a52 2e6d 3133 2b63 322a  3 = c1*R.m13+c2*
-000103c0: 522e 6d32 332b 6333 2a52 2e6d 3333 0a0a  R.m23+c3*R.m33..
-000103d0: 2020 2020 2020 2020 6331 203d 2073 656c          c1 = sel
-000103e0: 662e 6d32 310a 2020 2020 2020 2020 6332  f.m21.        c2
-000103f0: 203d 2073 656c 662e 6d32 320a 2020 2020   = self.m22.    
-00010400: 2020 2020 6333 203d 2073 656c 662e 6d32      c3 = self.m2
-00010410: 330a 2020 2020 2020 2020 7365 6c66 2e6d  3.        self.m
-00010420: 3231 203d 2063 312a 522e 6d31 312b 6332  21 = c1*R.m11+c2
-00010430: 2a52 2e6d 3231 2b63 332a 522e 6d33 310a  *R.m21+c3*R.m31.
-00010440: 2020 2020 2020 2020 7365 6c66 2e6d 3232          self.m22
-00010450: 203d 2063 312a 522e 6d31 322b 6332 2a52   = c1*R.m12+c2*R
-00010460: 2e6d 3232 2b63 332a 522e 6d33 320a 2020  .m22+c3*R.m32.  
-00010470: 2020 2020 2020 7365 6c66 2e6d 3233 203d        self.m23 =
-00010480: 2063 312a 522e 6d31 332b 6332 2a52 2e6d   c1*R.m13+c2*R.m
-00010490: 3233 2b63 332a 522e 6d33 330a 0a20 2020  23+c3*R.m33..   
-000104a0: 2020 2020 2063 3120 3d20 7365 6c66 2e6d       c1 = self.m
-000104b0: 3331 0a20 2020 2020 2020 2063 3220 3d20  31.        c2 = 
-000104c0: 7365 6c66 2e6d 3332 0a20 2020 2020 2020  self.m32.       
-000104d0: 2063 3320 3d20 7365 6c66 2e6d 3333 0a20   c3 = self.m33. 
-000104e0: 2020 2020 2020 2073 656c 662e 6d33 3120         self.m31 
-000104f0: 3d20 6331 2a52 2e6d 3131 2b63 322a 522e  = c1*R.m11+c2*R.
-00010500: 6d32 312b 6333 2a52 2e6d 3331 0a20 2020  m21+c3*R.m31.   
-00010510: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
-00010520: 6331 2a52 2e6d 3132 2b63 322a 522e 6d32  c1*R.m12+c2*R.m2
-00010530: 322b 6333 2a52 2e6d 3332 0a20 2020 2020  2+c3*R.m32.     
-00010540: 2020 2073 656c 662e 6d33 3320 3d20 6331     self.m33 = c1
-00010550: 2a52 2e6d 3133 2b63 322a 522e 6d32 332b  *R.m13+c2*R.m23+
-00010560: 6333 2a52 2e6d 3333 0a0a 2020 2020 2020  c3*R.m33..      
-00010570: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
-00010580: 2020 2064 6566 206f 7274 686f 2873 656c     def ortho(sel
-00010590: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-000105a0: 6574 7572 6e20 6120 6d61 7472 6978 2077  eturn a matrix w
-000105b0: 6974 6820 6f72 7468 6f67 6f6e 616c 2062  ith orthogonal b
-000105c0: 6173 6520 7665 6374 6f72 732e 0a0a 2020  ase vectors...  
-000105d0: 2020 2020 2020 4d61 6b65 7320 7468 6520        Makes the 
-000105e0: 782d 2c20 792d 2061 6e64 207a 2d61 7869  x-, y- and z-axi
-000105f0: 7320 6f72 7468 6f67 6f6e 616c 2e0a 2020  s orthogonal..  
-00010600: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00010610: 2020 6364 6566 206d 6174 3320 7265 730a    cdef mat3 res.
-00010620: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
-00010630: 3320 782c 792c 7a0a 0a20 2020 2020 2020  3 x,y,z..       
-00010640: 2078 203d 2076 6563 3328 7365 6c66 2e6d   x = vec3(self.m
-00010650: 3131 2c20 7365 6c66 2e6d 3231 2c20 7365  11, self.m21, se
-00010660: 6c66 2e6d 3331 290a 2020 2020 2020 2020  lf.m31).        
-00010670: 7920 3d20 7665 6333 2873 656c 662e 6d31  y = vec3(self.m1
-00010680: 322c 2073 656c 662e 6d32 322c 2073 656c  2, self.m22, sel
-00010690: 662e 6d33 3229 0a20 2020 2020 2020 207a  f.m32).        z
-000106a0: 203d 2076 6563 3328 7365 6c66 2e6d 3133   = vec3(self.m13
-000106b0: 2c20 7365 6c66 2e6d 3233 2c20 7365 6c66  , self.m23, self
-000106c0: 2e6d 3333 290a 0a20 2020 2020 2020 2078  .m33)..        x
-000106d0: 6c20 3d20 782e 6c65 6e67 7468 2829 0a20  l = x.length(). 
-000106e0: 2020 2020 2020 2078 6c20 3d20 786c 2a78         xl = xl*x
-000106f0: 6c0a 2020 2020 2020 2020 7920 3d20 7920  l.        y = y 
-00010700: 2d20 2828 782a 7929 2f78 6c29 2a78 0a20  - ((x*y)/xl)*x. 
-00010710: 2020 2020 2020 207a 203d 207a 202d 2028         z = z - (
-00010720: 2878 2a7a 292f 786c 292a 780a 0a20 2020  (x*z)/xl)*x..   
-00010730: 2020 2020 2079 6c20 3d20 792e 6c65 6e67       yl = y.leng
-00010740: 7468 2829 0a20 2020 2020 2020 2079 6c20  th().        yl 
-00010750: 3d20 796c 2a79 6c0a 2020 2020 2020 2020  = yl*yl.        
-00010760: 7a20 3d20 7a20 2d20 2828 792a 7a29 2f79  z = z - ((y*z)/y
-00010770: 6c29 2a79 0a0a 2020 2020 2020 2020 7265  l)*y..        re
-00010780: 7320 3d20 6d61 7433 2829 0a20 2020 2020  s = mat3().     
-00010790: 2020 2072 6573 2e6d 3131 203d 2078 2e78     res.m11 = x.x
-000107a0: 0a20 2020 2020 2020 2072 6573 2e6d 3132  .        res.m12
-000107b0: 203d 2079 2e78 0a20 2020 2020 2020 2072   = y.x.        r
-000107c0: 6573 2e6d 3133 203d 207a 2e78 0a20 2020  es.m13 = z.x.   
-000107d0: 2020 2020 2072 6573 2e6d 3231 203d 2078       res.m21 = x
-000107e0: 2e79 0a20 2020 2020 2020 2072 6573 2e6d  .y.        res.m
-000107f0: 3232 203d 2079 2e79 0a20 2020 2020 2020  22 = y.y.       
-00010800: 2072 6573 2e6d 3233 203d 207a 2e79 0a20   res.m23 = z.y. 
-00010810: 2020 2020 2020 2072 6573 2e6d 3331 203d         res.m31 =
-00010820: 2078 2e7a 0a20 2020 2020 2020 2072 6573   x.z.        res
-00010830: 2e6d 3332 203d 2079 2e7a 0a20 2020 2020  .m32 = y.z.     
-00010840: 2020 2072 6573 2e6d 3333 203d 207a 2e7a     res.m33 = z.z
-00010850: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00010860: 7265 730a 0a20 2020 2064 6566 2064 6563  res..    def dec
-00010870: 6f6d 706f 7365 2873 656c 6629 3a0a 2020  ompose(self):.  
-00010880: 2020 2020 2020 2222 2244 6563 6f6d 706f        """Decompo
-00010890: 7365 7320 7468 6520 6d61 7472 6978 2069  ses the matrix i
-000108a0: 6e74 6f20 6120 726f 7461 7469 6f6e 2061  nto a rotation a
-000108b0: 6e64 2073 6361 6c69 6e67 2070 6172 742e  nd scaling part.
-000108c0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-000108d0: 7320 6120 7475 706c 6520 2872 6f74 6174  s a tuple (rotat
-000108e0: 696f 6e2c 2073 6361 6c69 6e67 292e 2054  ion, scaling). T
-000108f0: 6865 2073 6361 6c69 6e67 2070 6172 7420  he scaling part 
-00010900: 6973 2067 6976 656e 0a20 2020 2020 2020  is given.       
-00010910: 2061 7320 6120 7665 6333 2c20 7468 6520   as a vec3, the 
-00010920: 726f 7461 7469 6f6e 2069 7320 7374 696c  rotation is stil
-00010930: 6c20 6120 6d61 7433 2e0a 2020 2020 2020  l a mat3..      
-00010940: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
-00010950: 6566 206d 6174 3320 6d0a 2020 2020 2020  ef mat3 m.      
-00010960: 2020 6364 6566 2076 6563 3320 612c 622c    cdef vec3 a,b,
-00010970: 630a 2020 2020 2020 2020 6364 6566 2064  c.        cdef d
-00010980: 6f75 626c 6520 616c 2c20 626c 2c20 636c  ouble al, bl, cl
-00010990: 0a0a 2020 2020 2020 2020 6d20 3d20 7365  ..        m = se
-000109a0: 6c66 2e6f 7274 686f 2829 0a0a 2020 2020  lf.ortho()..    
-000109b0: 2020 2020 2320 612c 622c 6320 3d20 436f      # a,b,c = Co
-000109c0: 6c75 6d6e 2030 2c31 2c32 206f 6620 6d0a  lumn 0,1,2 of m.
-000109d0: 2020 2020 2020 2020 6120 3d20 7665 6333          a = vec3
-000109e0: 2829 0a20 2020 2020 2020 2062 203d 2076  ().        b = v
-000109f0: 6563 3328 290a 2020 2020 2020 2020 6320  ec3().        c 
-00010a00: 3d20 7665 6333 2829 0a20 2020 2020 2020  = vec3().       
-00010a10: 2061 2e78 203d 206d 2e6d 3131 0a20 2020   a.x = m.m11.   
-00010a20: 2020 2020 2061 2e79 203d 206d 2e6d 3231       a.y = m.m21
-00010a30: 0a20 2020 2020 2020 2061 2e7a 203d 206d  .        a.z = m
-00010a40: 2e6d 3331 0a20 2020 2020 2020 2062 2e78  .m31.        b.x
-00010a50: 203d 206d 2e6d 3132 0a20 2020 2020 2020   = m.m12.       
-00010a60: 2062 2e79 203d 206d 2e6d 3232 0a20 2020   b.y = m.m22.   
-00010a70: 2020 2020 2062 2e7a 203d 206d 2e6d 3332       b.z = m.m32
-00010a80: 0a20 2020 2020 2020 2063 2e78 203d 206d  .        c.x = m
-00010a90: 2e6d 3133 0a20 2020 2020 2020 2063 2e79  .m13.        c.y
-00010aa0: 203d 206d 2e6d 3233 0a20 2020 2020 2020   = m.m23.       
-00010ab0: 2063 2e7a 203d 206d 2e6d 3333 0a0a 2020   c.z = m.m33..  
-00010ac0: 2020 2020 2020 2320 616c 2c62 6c2c 636c        # al,bl,cl
-00010ad0: 203d 206c 656e 6774 6820 6f66 2061 2c62   = length of a,b
-00010ae0: 2c63 2028 3d20 7363 616c 696e 6720 6661  ,c (= scaling fa
-00010af0: 6374 6f72 7329 0a20 2020 2020 2020 2061  ctors).        a
-00010b00: 6c20 3d20 7371 7274 2861 2e78 2a61 2e78  l = sqrt(a.x*a.x
-00010b10: 202b 2061 2e79 2a61 2e79 202b 2061 2e7a   + a.y*a.y + a.z
-00010b20: 2a61 2e7a 290a 2020 2020 2020 2020 626c  *a.z).        bl
-00010b30: 203d 2073 7172 7428 622e 782a 622e 7820   = sqrt(b.x*b.x 
-00010b40: 2b20 622e 792a 622e 7920 2b20 622e 7a2a  + b.y*b.y + b.z*
-00010b50: 622e 7a29 0a20 2020 2020 2020 2063 6c20  b.z).        cl 
-00010b60: 3d20 7371 7274 2863 2e78 2a63 2e78 202b  = sqrt(c.x*c.x +
-00010b70: 2063 2e79 2a63 2e79 202b 2063 2e7a 2a63   c.y*c.y + c.z*c
-00010b80: 2e7a 290a 2020 2020 2020 2020 6966 2061  .z).        if a
-00010b90: 6c3c 3d65 7073 206f 7220 626c 3c3d 6570  l<=eps or bl<=ep
-00010ba0: 7320 6f72 2063 6c3c 3d65 7073 3a0a 2020  s or cl<=eps:.  
-00010bb0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00010bc0: 5a65 726f 4469 7669 7369 6f6e 4572 726f  ZeroDivisionErro
-00010bd0: 722c 2274 7261 6e73 666f 726d 6174 696f  r,"transformatio
-00010be0: 6e20 636f 6e74 6169 6e73 2061 2030 2073  n contains a 0 s
-00010bf0: 6361 6c69 6e67 220a 0a20 2020 2020 2020  caling"..       
-00010c00: 2073 6361 6c65 203d 2076 6563 3328 616c   scale = vec3(al
-00010c10: 2c62 6c2c 636c 290a 0a20 2020 2020 2020  ,bl,cl)..       
-00010c20: 2023 206e 6f72 6d61 6c69 7a69 6e67 2061   # normalizing a
-00010c30: 2c62 2c63 0a23 2020 2020 2020 2020 612f  ,b,c.#        a/
-00010c40: 3d61 6c0a 2320 2020 2020 2020 2062 2f3d  =al.#        b/=
-00010c50: 626c 0a23 2020 2020 2020 2020 632f 3d63  bl.#        c/=c
-00010c60: 6c0a 2020 2020 2020 2020 612e 7820 3d20  l.        a.x = 
-00010c70: 612e 782f 616c 0a20 2020 2020 2020 2061  a.x/al.        a
-00010c80: 2e79 203d 2061 2e79 2f61 6c0a 2020 2020  .y = a.y/al.    
-00010c90: 2020 2020 612e 7a20 3d20 612e 7a2f 616c      a.z = a.z/al
-00010ca0: 0a20 2020 2020 2020 2062 2e78 203d 2062  .        b.x = b
-00010cb0: 2e78 2f62 6c0a 2020 2020 2020 2020 622e  .x/bl.        b.
-00010cc0: 7920 3d20 622e 792f 626c 0a20 2020 2020  y = b.y/bl.     
-00010cd0: 2020 2062 2e7a 203d 2062 2e7a 2f62 6c0a     b.z = b.z/bl.
-00010ce0: 2020 2020 2020 2020 632e 7820 3d20 632e          c.x = c.
-00010cf0: 782f 636c 0a20 2020 2020 2020 2063 2e79  x/cl.        c.y
-00010d00: 203d 2063 2e79 2f63 6c0a 2020 2020 2020   = c.y/cl.      
-00010d10: 2020 632e 7a20 3d20 632e 7a2f 636c 0a0a    c.z = c.z/cl..
-00010d20: 2020 2020 2020 2020 6d2e 6d31 3120 3d20          m.m11 = 
-00010d30: 612e 780a 2020 2020 2020 2020 6d2e 6d32  a.x.        m.m2
-00010d40: 3120 3d20 612e 790a 2020 2020 2020 2020  1 = a.y.        
-00010d50: 6d2e 6d33 3120 3d20 612e 7a0a 2020 2020  m.m31 = a.z.    
-00010d60: 2020 2020 6d2e 6d31 3220 3d20 622e 780a      m.m12 = b.x.
-00010d70: 2020 2020 2020 2020 6d2e 6d32 3220 3d20          m.m22 = 
-00010d80: 622e 790a 2020 2020 2020 2020 6d2e 6d33  b.y.        m.m3
-00010d90: 3220 3d20 622e 7a0a 2020 2020 2020 2020  2 = b.z.        
-00010da0: 6d2e 6d31 3320 3d20 632e 780a 2020 2020  m.m13 = c.x.    
-00010db0: 2020 2020 6d2e 6d32 3320 3d20 632e 790a      m.m23 = c.y.
-00010dc0: 2020 2020 2020 2020 6d2e 6d33 3320 3d20          m.m33 = 
-00010dd0: 632e 7a0a 2020 2020 2020 2020 6966 206d  c.z.        if m
-00010de0: 2e64 6574 6572 6d69 6e61 6e74 2829 3c30  .determinant()<0
-00010df0: 2e30 3a0a 2020 2020 2020 2020 2020 2020  .0:.            
-00010e00: 6d2e 6d31 3120 3d20 2d6d 2e6d 3131 0a20  m.m11 = -m.m11. 
-00010e10: 2020 2020 2020 2020 2020 206d 2e6d 3231             m.m21
-00010e20: 203d 202d 6d2e 6d32 310a 2020 2020 2020   = -m.m21.      
-00010e30: 2020 2020 2020 6d2e 6d33 3120 3d20 2d6d        m.m31 = -m
-00010e40: 2e6d 3331 0a20 2020 2020 2020 2020 2020  .m31.           
-00010e50: 2073 6361 6c65 2e78 203d 202d 7363 616c   scale.x = -scal
-00010e60: 652e 780a 0a20 2020 2020 2020 2072 6574  e.x..        ret
-00010e70: 7572 6e20 286d 2c20 7363 616c 6529 0a0a  urn (m, scale)..
-00010e80: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
-00010e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00010ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00010eb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00010ec0: 2323 2323 2323 230a 0a23 206d 6174 3469  #######..# mat4i
-00010ed0: 7465 720a 6364 6566 2063 6c61 7373 206d  ter.cdef class m
-00010ee0: 6174 3469 7465 723a 0a20 2020 2022 2222  at4iter:.    """
-00010ef0: 6d61 7420 6974 6572 6174 6f72 2e22 2222  mat iterator."""
-00010f00: 0a20 2020 2063 6465 6620 696e 7420 6964  .    cdef int id
-00010f10: 780a 2020 2020 6364 6566 206f 626a 6563  x.    cdef objec
-00010f20: 7420 6d0a 0a20 2020 2064 6566 205f 5f63  t m..    def __c
-00010f30: 696e 6974 5f5f 2873 656c 662c 206d 293a  init__(self, m):
-00010f40: 0a20 2020 2020 2020 2073 656c 662e 6964  .        self.id
-00010f50: 7820 3d20 300a 2020 2020 2020 2020 7365  x = 0.        se
-00010f60: 6c66 2e6d 2020 203d 206d 0a0a 2020 2020  lf.m   = m..    
-00010f70: 6465 6620 5f5f 6974 6572 5f5f 2873 656c  def __iter__(sel
-00010f80: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00010f90: 726e 2073 656c 660a 0a20 2020 2064 6566  rn self..    def
-00010fa0: 205f 5f6e 6578 745f 5f28 7365 6c66 293a   __next__(self):
-00010fb0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00010fc0: 2e69 6478 3d3d 303a 0a20 2020 2020 2020  .idx==0:.       
-00010fd0: 2020 2020 2073 656c 662e 6964 783d 310a       self.idx=1.
-00010fe0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00010ff0: 726e 2073 656c 662e 6d5b 305d 0a20 2020  rn self.m[0].   
-00011000: 2020 2020 2065 6c69 6620 7365 6c66 2e69       elif self.i
-00011010: 6478 3d3d 313a 0a20 2020 2020 2020 2020  dx==1:.         
-00011020: 2020 2073 656c 662e 6964 783d 320a 2020     self.idx=2.  
-00011030: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00011040: 2073 656c 662e 6d5b 315d 0a20 2020 2020   self.m[1].     
-00011050: 2020 2065 6c69 6620 7365 6c66 2e69 6478     elif self.idx
-00011060: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
-00011070: 2073 656c 662e 6964 783d 330a 2020 2020   self.idx=3.    
-00011080: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00011090: 656c 662e 6d5b 325d 0a20 2020 2020 2020  elf.m[2].       
-000110a0: 2065 6c69 6620 7365 6c66 2e69 6478 3d3d   elif self.idx==
-000110b0: 333a 0a20 2020 2020 2020 2020 2020 2073  3:.            s
-000110c0: 656c 662e 6964 783d 340a 2020 2020 2020  elf.idx=4.      
-000110d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000110e0: 662e 6d5b 335d 0a20 2020 2020 2020 2065  f.m[3].        e
-000110f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00011100: 2072 6169 7365 2053 746f 7049 7465 7261   raise StopItera
-00011110: 7469 6f6e 0a0a 2320 4361 6c63 756c 6174  tion..# Calculat
-00011120: 6573 206d 332e 6465 7465 726d 696e 616e  es m3.determinan
-00011130: 7428 2920 7768 6572 6520 6d33 2069 7320  t() where m3 is 
-00011140: 6120 6d61 7433 2074 6861 7420 6973 2062  a mat3 that is b
-00011150: 6173 6564 206f 6e20 6d34 0a23 2077 6865  ased on m4.# whe
-00011160: 7265 2072 6f77 2069 2061 6e64 2063 6f6c  re row i and col
-00011170: 756d 6e20 6a20 6172 6520 6c65 6674 206f  umn j are left o
-00011180: 7574 2e0a 6364 6566 2064 6f75 626c 6520  ut..cdef double 
-00011190: 5f73 7562 6465 7428 646f 7562 6c65 206d  _subdet(double m
-000111a0: 345b 3136 5d2c 2073 686f 7274 2069 2c20  4[16], short i, 
-000111b0: 7368 6f72 7420 6a29 3a0a 2020 2020 6364  short j):.    cd
-000111c0: 6566 2064 6f75 626c 6520 6d33 5b39 5d0a  ef double m3[9].
-000111d0: 2020 2020 6364 6566 2064 6f75 626c 652a      cdef double*
-000111e0: 2070 0a20 2020 2063 6465 6620 7368 6f72   p.    cdef shor
-000111f0: 7420 6b2c 206c 0a0a 2020 2020 7020 3d20  t k, l..    p = 
-00011200: 6d33 0a20 2020 206b 3d30 0a20 2020 2077  m3.    k=0.    w
-00011210: 6869 6c65 2031 3a0a 2020 2020 2020 2020  hile 1:.        
-00011220: 6966 206b 3d3d 693a 0a20 2020 2020 2020  if k==i:.       
-00011230: 2020 2020 206b 3d6b 2b31 0a20 2020 2020       k=k+1.     
-00011240: 2020 2069 6620 6b3d 3d34 3a0a 2020 2020     if k==4:.    
-00011250: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
-00011260: 2020 2020 2020 6c3d 300a 2020 2020 2020        l=0.      
-00011270: 2020 7768 696c 6520 313a 0a20 2020 2020    while 1:.     
-00011280: 2020 2020 2020 2069 6620 6c3d 3d6a 3a0a         if l==j:.
-00011290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000112a0: 6c3d 6c2b 310a 2020 2020 2020 2020 2020  l=l+1.          
-000112b0: 2020 6966 206c 3d3d 343a 0a20 2020 2020    if l==4:.     
-000112c0: 2020 2020 2020 2020 2020 2062 7265 616b             break
-000112d0: 0a20 2020 2020 2020 2020 2020 2070 5b30  .            p[0
-000112e0: 5d3d 6d34 5b6b 2a34 2b6c 5d0a 2020 2020  ]=m4[k*4+l].    
-000112f0: 2020 2020 2020 2020 703d 702b 310a 2020          p=p+1.  
-00011300: 2020 2020 2020 2020 2020 6c3d 6c2b 310a            l=l+1.
-00011310: 2020 2020 2020 2020 6b3d 6b2b 310a 0a20          k=k+1.. 
-00011320: 2020 2072 6574 7572 6e20 6d33 5b30 5d2a     return m3[0]*
-00011330: 6d33 5b34 5d2a 6d33 5b38 5d2b 205c 0a20  m3[4]*m3[8]+ \. 
-00011340: 2020 2020 2020 2020 2020 6d33 5b31 5d2a            m3[1]*
-00011350: 6d33 5b35 5d2a 6d33 5b36 5d2b 205c 0a20  m3[5]*m3[6]+ \. 
-00011360: 2020 2020 2020 2020 2020 6d33 5b32 5d2a            m3[2]*
-00011370: 6d33 5b33 5d2a 6d33 5b37 5d2d 205c 0a20  m3[3]*m3[7]- \. 
-00011380: 2020 2020 2020 2020 2020 6d33 5b36 5d2a            m3[6]*
-00011390: 6d33 5b34 5d2a 6d33 5b32 5d2d 205c 0a20  m3[4]*m3[2]- \. 
-000113a0: 2020 2020 2020 2020 2020 6d33 5b37 5d2a            m3[7]*
-000113b0: 6d33 5b35 5d2a 6d33 5b30 5d2d 205c 0a20  m3[5]*m3[0]- \. 
-000113c0: 2020 2020 2020 2020 2020 6d33 5b38 5d2a            m3[8]*
-000113d0: 6d33 5b33 5d2a 6d33 5b31 5d0a 0a0a 0a23  m3[3]*m3[1]....#
-000113e0: 206d 6174 340a 6364 6566 2063 6c61 7373   mat4.cdef class
-000113f0: 206d 6174 343a 0a0a 2020 2020 6364 6566   mat4:..    cdef
-00011400: 2064 6f75 626c 6520 6d31 312c 206d 3132   double m11, m12
-00011410: 2c20 6d31 332c 206d 3134 0a20 2020 2063  , m13, m14.    c
-00011420: 6465 6620 646f 7562 6c65 206d 3231 2c20  def double m21, 
-00011430: 6d32 322c 206d 3233 2c20 6d32 340a 2020  m22, m23, m24.  
-00011440: 2020 6364 6566 2064 6f75 626c 6520 6d33    cdef double m3
-00011450: 312c 206d 3332 2c20 6d33 332c 206d 3334  1, m32, m33, m34
-00011460: 0a20 2020 2063 6465 6620 646f 7562 6c65  .    cdef double
-00011470: 206d 3431 2c20 6d34 322c 206d 3433 2c20   m41, m42, m43, 
-00011480: 6d34 340a 0a20 2020 2064 6566 205f 5f63  m44..    def __c
-00011490: 696e 6974 5f5f 2873 656c 662c 202a 6172  init__(self, *ar
-000114a0: 6773 293a 0a20 2020 2020 2020 2063 6465  gs):.        cde
-000114b0: 6620 696e 7420 6172 676c 656e 0a20 2020  f int arglen.   
-000114c0: 2020 2020 2063 6465 6620 6d61 7434 2042       cdef mat4 B
-000114d0: 0a20 2020 2020 2020 2061 7267 6c65 6e20  .        arglen 
-000114e0: 3d20 6c65 6e28 6172 6773 290a 0a20 2020  = len(args)..   
-000114f0: 2020 2020 2023 204e 6f20 6172 6775 6d65       # No argume
-00011500: 6e74 730a 2020 2020 2020 2020 6966 2061  nts.        if a
-00011510: 7267 6c65 6e3d 3d30 3a0a 2020 2020 2020  rglen==0:.      
-00011520: 2020 2020 2020 6d31 313d 6d31 323d 6d31        m11=m12=m1
-00011530: 333d 6d31 343d 302e 300a 2020 2020 2020  3=m14=0.0.      
-00011540: 2020 2020 2020 6d32 313d 6d32 323d 6d32        m21=m22=m2
-00011550: 333d 6d32 343d 302e 300a 2020 2020 2020  3=m24=0.0.      
-00011560: 2020 2020 2020 6d33 313d 6d33 323d 6d33        m31=m32=m3
-00011570: 333d 6d33 343d 302e 300a 2020 2020 2020  3=m34=0.0.      
-00011580: 2020 2020 2020 6d34 313d 6d34 323d 6d34        m41=m42=m4
-00011590: 333d 6d34 343d 302e 300a 0a20 2020 2020  3=m44=0.0..     
-000115a0: 2020 2023 2031 2061 7267 756d 656e 7420     # 1 argument 
-000115b0: 286c 6973 742c 2073 6361 6c61 7220 6f72  (list, scalar or
-000115c0: 206d 6174 3429 0a20 2020 2020 2020 2065   mat4).        e
-000115d0: 6c69 6620 6172 676c 656e 3d3d 313a 0a20  lif arglen==1:. 
-000115e0: 2020 2020 2020 2020 2020 2054 203d 2074             T = t
-000115f0: 7970 6528 6172 6773 5b30 5d29 0a20 2020  ype(args[0]).   
-00011600: 2020 2020 2020 2020 2023 2073 6361 6c61           # scala
-00011610: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
-00011620: 2054 2069 7320 666c 6f61 7420 6f72 2054   T is float or T
-00011630: 2069 7320 696e 7420 6f72 2054 2069 7320   is int or T is 
-00011640: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
-00011650: 2020 2020 2020 7365 6c66 2e6d 3131 203d        self.m11 =
-00011660: 2061 7267 735b 305d 0a20 2020 2020 2020   args[0].       
-00011670: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-00011680: 3220 3d20 302e 300a 2020 2020 2020 2020  2 = 0.0.        
-00011690: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
-000116a0: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
-000116b0: 2020 2020 2020 2073 656c 662e 6d31 3420         self.m14 
-000116c0: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
-000116d0: 2020 2020 2020 7365 6c66 2e6d 3231 203d        self.m21 =
-000116e0: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
-000116f0: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
-00011700: 7365 6c66 2e6d 3131 0a20 2020 2020 2020  self.m11.       
-00011710: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-00011720: 3320 3d20 302e 300a 2020 2020 2020 2020  3 = 0.0.        
-00011730: 2020 2020 2020 2020 7365 6c66 2e6d 3234          self.m24
-00011740: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
-00011750: 2020 2020 2020 2073 656c 662e 6d33 3120         self.m31 
-00011760: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
-00011770: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
-00011780: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
-00011790: 2020 2020 2073 656c 662e 6d33 3320 3d20       self.m33 = 
-000117a0: 7365 6c66 2e6d 3131 0a20 2020 2020 2020  self.m11.       
-000117b0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
-000117c0: 3420 3d20 302e 300a 2020 2020 2020 2020  4 = 0.0.        
-000117d0: 2020 2020 2020 2020 7365 6c66 2e6d 3431          self.m41
-000117e0: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
-000117f0: 2020 2020 2020 2073 656c 662e 6d34 3220         self.m42 
-00011800: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
-00011810: 2020 2020 2020 7365 6c66 2e6d 3433 203d        self.m43 =
-00011820: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
-00011830: 2020 2020 2073 656c 662e 6d34 3420 3d20       self.m44 = 
-00011840: 7365 6c66 2e6d 3131 0a20 2020 2020 2020  self.m11.       
-00011850: 2020 2020 2023 206d 6174 340a 2020 2020       # mat4.    
-00011860: 2020 2020 2020 2020 656c 6966 2054 2069          elif T i
-00011870: 7320 6d61 7434 3a0a 2020 2020 2020 2020  s mat4:.        
-00011880: 2020 2020 2020 2020 4220 3d20 6172 6773          B = args
-00011890: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-000118a0: 2020 2020 7365 6c66 2e6d 3131 203d 2042      self.m11 = B
-000118b0: 2e6d 3131 0a20 2020 2020 2020 2020 2020  .m11.           
-000118c0: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
-000118d0: 422e 6d31 320a 2020 2020 2020 2020 2020  B.m12.          
-000118e0: 2020 2020 2020 7365 6c66 2e6d 3133 203d        self.m13 =
-000118f0: 2042 2e6d 3133 0a20 2020 2020 2020 2020   B.m13.         
-00011900: 2020 2020 2020 2073 656c 662e 6d31 3420         self.m14 
-00011910: 3d20 422e 6d31 340a 2020 2020 2020 2020  = B.m14.        
-00011920: 2020 2020 2020 2020 7365 6c66 2e6d 3231          self.m21
-00011930: 203d 2042 2e6d 3231 0a20 2020 2020 2020   = B.m21.       
-00011940: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-00011950: 3220 3d20 422e 6d32 320a 2020 2020 2020  2 = B.m22.      
-00011960: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00011970: 3233 203d 2042 2e6d 3233 0a20 2020 2020  23 = B.m23.     
-00011980: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011990: 6d32 3420 3d20 422e 6d32 340a 2020 2020  m24 = B.m24.    
-000119a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000119b0: 2e6d 3331 203d 2042 2e6d 3331 0a20 2020  .m31 = B.m31.   
-000119c0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000119d0: 662e 6d33 3220 3d20 422e 6d33 320a 2020  f.m32 = B.m32.  
-000119e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000119f0: 6c66 2e6d 3333 203d 2042 2e6d 3333 0a20  lf.m33 = B.m33. 
-00011a00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00011a10: 656c 662e 6d33 3420 3d20 422e 6d33 340a  elf.m34 = B.m34.
-00011a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011a30: 7365 6c66 2e6d 3431 203d 2042 2e6d 3431  self.m41 = B.m41
-00011a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011a50: 2073 656c 662e 6d34 3220 3d20 422e 6d34   self.m42 = B.m4
-00011a60: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
-00011a70: 2020 7365 6c66 2e6d 3433 203d 2042 2e6d    self.m43 = B.m
-00011a80: 3433 0a20 2020 2020 2020 2020 2020 2020  43.             
-00011a90: 2020 2073 656c 662e 6d34 3420 3d20 422e     self.m44 = B.
-00011aa0: 6d34 340a 2020 2020 2020 2020 2020 2020  m44.            
-00011ab0: 2320 5374 7269 6e67 0a20 2020 2020 2020  # String.       
-00011ac0: 2020 2020 2065 6c69 6620 5420 6973 2073       elif T is s
-00011ad0: 7472 206f 7220 5420 6973 2075 6e69 636f  tr or T is unico
-00011ae0: 6465 3a0a 2020 2020 2020 2020 2020 2020  de:.            
-00011af0: 2020 2020 733d 6172 6773 5b30 5d2e 7265      s=args[0].re
-00011b00: 706c 6163 6528 222c 222c 2220 2229 2e72  place(","," ").r
-00011b10: 6570 6c61 6365 2822 2020 222c 2220 2229  eplace("  "," ")
-00011b20: 2e73 7472 6970 2829 2e73 706c 6974 2822  .strip().split("
-00011b30: 2022 290a 2020 2020 2020 2020 2020 2020   ").            
-00011b40: 2020 2020 6966 2073 3d3d 5b22 225d 3a0a      if s==[""]:.
-00011b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011b60: 2020 2020 733d 5b5d 0a20 2020 2020 2020      s=[].       
-00011b70: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-00011b80: 6e20 7261 6e67 6528 6c65 6e28 7329 293a  n range(len(s)):
-00011b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011ba0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-00011bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011bc0: 2020 735b 695d 203d 2066 6c6f 6174 2873    s[i] = float(s
-00011bd0: 5b69 5d29 0a20 2020 2020 2020 2020 2020  [i]).           
-00011be0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-00011bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011c00: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00011c10: 616c 7565 4572 726f 722c 226d 6174 3428  alueError,"mat4(
-00011c20: 2920 6172 6720 6973 2061 206d 616c 666f  ) arg is a malfo
-00011c30: 726d 6564 2073 7472 696e 6722 0a20 2020  rmed string".   
-00011c40: 2020 2020 2020 2020 2020 2020 2042 203d               B =
-00011c50: 206d 6174 3428 7329 0a20 2020 2020 2020   mat4(s).       
-00011c60: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-00011c70: 3120 3d20 422e 6d31 310a 2020 2020 2020  1 = B.m11.      
-00011c80: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00011c90: 3132 203d 2042 2e6d 3132 0a20 2020 2020  12 = B.m12.     
-00011ca0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011cb0: 6d31 3320 3d20 422e 6d31 330a 2020 2020  m13 = B.m13.    
-00011cc0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00011cd0: 2e6d 3134 203d 2042 2e6d 3134 0a20 2020  .m14 = B.m14.   
-00011ce0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00011cf0: 662e 6d32 3120 3d20 422e 6d32 310a 2020  f.m21 = B.m21.  
-00011d00: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00011d10: 6c66 2e6d 3232 203d 2042 2e6d 3232 0a20  lf.m22 = B.m22. 
-00011d20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00011d30: 656c 662e 6d32 3320 3d20 422e 6d32 330a  elf.m23 = B.m23.
-00011d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d50: 7365 6c66 2e6d 3234 203d 2042 2e6d 3234  self.m24 = B.m24
-00011d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011d70: 2073 656c 662e 6d33 3120 3d20 422e 6d33   self.m31 = B.m3
-00011d80: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00011d90: 2020 7365 6c66 2e6d 3332 203d 2042 2e6d    self.m32 = B.m
-00011da0: 3332 0a20 2020 2020 2020 2020 2020 2020  32.             
-00011db0: 2020 2073 656c 662e 6d33 3320 3d20 422e     self.m33 = B.
-00011dc0: 6d33 330a 2020 2020 2020 2020 2020 2020  m33.            
-00011dd0: 2020 2020 7365 6c66 2e6d 3334 203d 2042      self.m34 = B
-00011de0: 2e6d 3334 0a20 2020 2020 2020 2020 2020  .m34.           
-00011df0: 2020 2020 2073 656c 662e 6d34 3120 3d20       self.m41 = 
-00011e00: 422e 6d34 310a 2020 2020 2020 2020 2020  B.m41.          
-00011e10: 2020 2020 2020 7365 6c66 2e6d 3432 203d        self.m42 =
-00011e20: 2042 2e6d 3432 0a20 2020 2020 2020 2020   B.m42.         
-00011e30: 2020 2020 2020 2073 656c 662e 6d34 3320         self.m43 
-00011e40: 3d20 422e 6d34 330a 2020 2020 2020 2020  = B.m43.        
-00011e50: 2020 2020 2020 2020 7365 6c66 2e6d 3434          self.m44
-00011e60: 203d 2042 2e6d 3434 0a20 2020 2020 2020   = B.m44.       
-00011e70: 2020 2020 2023 2053 6571 7565 6e63 6520       # Sequence 
-00011e80: 6f66 2031 3620 666c 6f61 7473 206f 7220  of 16 floats or 
-00011e90: 3420 342d 7365 7175 656e 6365 730a 2020  4 4-sequences.  
-00011ea0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00011eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ec0: 7365 7120 3d20 6172 6773 5b30 5d0a 2020  seq = args[0].  
-00011ed0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-00011ee0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00011ef0: 2020 2020 2020 2073 6571 6c65 6e20 3d20         seqlen = 
-00011f00: 6c65 6e28 7365 7129 0a20 2020 2020 2020  len(seq).       
-00011f10: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-00011f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011f30: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00011f40: 7272 6f72 2c22 6d61 7434 2829 2061 7267  rror,"mat4() arg
-00011f50: 2063 616e 2774 2062 6520 636f 6e76 6572   can't be conver
-00011f60: 7465 6420 746f 206d 6174 3422 0a0a 2020  ted to mat4"..  
-00011f70: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00011f80: 2073 6571 6c65 6e3d 3d31 363a 0a20 2020   seqlen==16:.   
-00011f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011fa0: 2073 656c 662e 6d31 3120 3d20 7365 715b   self.m11 = seq[
-00011fb0: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
-00011fc0: 2020 2020 2020 2073 656c 662e 6d31 3220         self.m12 
-00011fd0: 3d20 7365 715b 315d 0a20 2020 2020 2020  = seq[1].       
-00011fe0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00011ff0: 662e 6d31 3320 3d20 7365 715b 325d 0a20  f.m13 = seq[2]. 
-00012000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012010: 2020 2073 656c 662e 6d31 3420 3d20 7365     self.m14 = se
-00012020: 715b 335d 0a20 2020 2020 2020 2020 2020  q[3].           
-00012030: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-00012040: 3120 3d20 7365 715b 345d 0a20 2020 2020  1 = seq[4].     
-00012050: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00012060: 656c 662e 6d32 3220 3d20 7365 715b 355d  elf.m22 = seq[5]
-00012070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012080: 2020 2020 2073 656c 662e 6d32 3320 3d20       self.m23 = 
-00012090: 7365 715b 365d 0a20 2020 2020 2020 2020  seq[6].         
-000120a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000120b0: 6d32 3420 3d20 7365 715b 375d 0a20 2020  m24 = seq[7].   
+0000a350: 2020 2020 7365 6c66 2e6d 3232 203d 2062      self.m22 = b
+0000a360: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+0000a370: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
+0000a380: 203d 2062 5b32 5d0a 2020 2020 2020 2020   = b[2].        
+0000a390: 2020 2020 2020 2020 2020 2020 6220 3d20              b = 
+0000a3a0: 7365 715b 325d 0a20 2020 2020 2020 2020  seq[2].         
+0000a3b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000a3c0: 6d31 3320 3d20 625b 305d 0a20 2020 2020  m13 = b[0].     
+0000a3d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000a3e0: 656c 662e 6d32 3320 3d20 625b 315d 0a20  elf.m23 = b[1]. 
+0000a3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a400: 2020 2073 656c 662e 6d33 3320 3d20 625b     self.m33 = b[
+0000a410: 325d 0a20 2020 2020 2020 2020 2020 2020  2].             
+0000a420: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000a430: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000a440: 7365 2054 7970 6545 7272 6f72 2c20 226d  se TypeError, "m
+0000a450: 6174 3328 2920 7461 6b65 7320 6174 206d  at3() takes at m
+0000a460: 6f73 7420 3920 6172 6775 6d65 6e74 7322  ost 9 arguments"
+0000a470: 0a0a 2020 2020 2020 2020 2320 3320 6172  ..        # 3 ar
+0000a480: 6775 6d65 6e74 7320 2863 6f6c 756d 6e73  guments (columns
+0000a490: 2061 7320 7365 7175 656e 6365 7329 0a20   as sequences). 
+0000a4a0: 2020 2020 2020 2065 6c69 6620 6172 676c         elif argl
+0000a4b0: 656e 3d3d 333a 0a20 2020 2020 2020 2020  en==3:.         
+0000a4c0: 2020 2061 2c62 2c63 3d61 7267 730a 2020     a,b,c=args.  
+0000a4d0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000a4e0: 3131 203d 2061 5b30 5d0a 2020 2020 2020  11 = a[0].      
+0000a4f0: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
+0000a500: 2062 5b30 5d0a 2020 2020 2020 2020 2020   b[0].          
+0000a510: 2020 7365 6c66 2e6d 3133 203d 2063 5b30    self.m13 = c[0
+0000a520: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
+0000a530: 6c66 2e6d 3231 203d 2061 5b31 5d0a 2020  lf.m21 = a[1].  
+0000a540: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000a550: 3232 203d 2062 5b31 5d0a 2020 2020 2020  22 = b[1].      
+0000a560: 2020 2020 2020 7365 6c66 2e6d 3233 203d        self.m23 =
+0000a570: 2063 5b31 5d0a 2020 2020 2020 2020 2020   c[1].          
+0000a580: 2020 7365 6c66 2e6d 3331 203d 2061 5b32    self.m31 = a[2
+0000a590: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
+0000a5a0: 6c66 2e6d 3332 203d 2062 5b32 5d0a 2020  lf.m32 = b[2].  
+0000a5b0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000a5c0: 3333 203d 2063 5b32 5d0a 0a20 2020 2020  33 = c[2]..     
+0000a5d0: 2020 2023 2039 2061 7267 756d 656e 7473     # 9 arguments
+0000a5e0: 0a20 2020 2020 2020 2065 6c69 6620 6172  .        elif ar
+0000a5f0: 676c 656e 3d3d 393a 0a20 2020 2020 2020  glen==9:.       
+0000a600: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
+0000a610: 6172 6773 5b30 5d0a 2020 2020 2020 2020  args[0].        
+0000a620: 2020 2020 7365 6c66 2e6d 3132 203d 2061      self.m12 = a
+0000a630: 7267 735b 315d 0a20 2020 2020 2020 2020  rgs[1].         
+0000a640: 2020 2073 656c 662e 6d31 3320 3d20 6172     self.m13 = ar
+0000a650: 6773 5b32 5d0a 2020 2020 2020 2020 2020  gs[2].          
+0000a660: 2020 7365 6c66 2e6d 3231 203d 2061 7267    self.m21 = arg
+0000a670: 735b 335d 0a20 2020 2020 2020 2020 2020  s[3].           
+0000a680: 2073 656c 662e 6d32 3220 3d20 6172 6773   self.m22 = args
+0000a690: 5b34 5d0a 2020 2020 2020 2020 2020 2020  [4].            
+0000a6a0: 7365 6c66 2e6d 3233 203d 2061 7267 735b  self.m23 = args[
+0000a6b0: 355d 0a20 2020 2020 2020 2020 2020 2073  5].            s
+0000a6c0: 656c 662e 6d33 3120 3d20 6172 6773 5b36  elf.m31 = args[6
+0000a6d0: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
+0000a6e0: 6c66 2e6d 3332 203d 2061 7267 735b 375d  lf.m32 = args[7]
+0000a6f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000a700: 662e 6d33 3320 3d20 6172 6773 5b38 5d0a  f.m33 = args[8].
+0000a710: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000a720: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000a730: 2054 7970 6545 7272 6f72 2c22 6d61 7433   TypeError,"mat3
+0000a740: 2829 2061 7267 2063 616e 2774 2062 6520  () arg can't be 
+0000a750: 636f 6e76 6572 7465 6420 746f 206d 6174  converted to mat
+0000a760: 3322 0a0a 2020 2020 6465 6620 5f5f 7265  3"..    def __re
+0000a770: 6475 6365 5f5f 2873 656c 6629 3a0a 2020  duce__(self):.  
+0000a780: 2020 2020 2020 7265 7475 726e 2028 5f6d        return (_m
+0000a790: 6174 3363 6f6e 7374 7275 6374 2c20 2873  at3construct, (s
+0000a7a0: 656c 665b 305d 2c20 7365 6c66 5b31 5d2c  elf[0], self[1],
+0000a7b0: 2073 656c 665b 325d 2929 0a0a 2020 2020   self[2]))..    
+0000a7c0: 6465 6620 5f5f 7265 7072 5f5f 2873 656c  def __repr__(sel
+0000a7d0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+0000a7e0: 726e 2027 6d61 7433 2825 732c 2025 732c  rn 'mat3(%s, %s,
+0000a7f0: 2025 732c 2025 732c 2025 732c 2025 732c   %s, %s, %s, %s,
+0000a800: 2025 732c 2025 732c 2025 7329 2725 280a   %s, %s, %s)'%(.
+0000a810: 2020 2020 2020 2020 2020 2020 7265 7072              repr
+0000a820: 2873 656c 662e 6d31 3129 2c72 6570 7228  (self.m11),repr(
+0000a830: 7365 6c66 2e6d 3132 292c 7265 7072 2873  self.m12),repr(s
+0000a840: 656c 662e 6d31 3329 2c0a 2020 2020 2020  elf.m13),.      
+0000a850: 2020 2020 2020 7265 7072 2873 656c 662e        repr(self.
+0000a860: 6d32 3129 2c72 6570 7228 7365 6c66 2e6d  m21),repr(self.m
+0000a870: 3232 292c 7265 7072 2873 656c 662e 6d32  22),repr(self.m2
+0000a880: 3329 2c0a 2020 2020 2020 2020 2020 2020  3),.            
+0000a890: 7265 7072 2873 656c 662e 6d33 3129 2c72  repr(self.m31),r
+0000a8a0: 6570 7228 7365 6c66 2e6d 3332 292c 7265  epr(self.m32),re
+0000a8b0: 7072 2873 656c 662e 6d33 3329 290a 0a20  pr(self.m33)).. 
+0000a8c0: 2020 2064 6566 205f 5f73 7472 5f5f 2873     def __str__(s
+0000a8d0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+0000a8e0: 7475 726e 2022 5b25 392e 3466 2c20 2539  turn "[%9.4f, %9
+0000a8f0: 2e34 662c 2025 392e 3466 5d5c 6e5b 2539  .4f, %9.4f]\n[%9
+0000a900: 2e34 662c 2025 392e 3466 2c20 2539 2e34  .4f, %9.4f, %9.4
+0000a910: 665d 5c6e 5b25 392e 3466 2c20 2539 2e34  f]\n[%9.4f, %9.4
+0000a920: 662c 2025 392e 3466 5d22 2528 0a20 2020  f, %9.4f]"%(.   
+0000a930: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+0000a940: 312c 2073 656c 662e 6d31 322c 2073 656c  1, self.m12, sel
+0000a950: 662e 6d31 332c 0a20 2020 2020 2020 2020  f.m13,.         
+0000a960: 2020 2073 656c 662e 6d32 312c 2073 656c     self.m21, sel
+0000a970: 662e 6d32 322c 2073 656c 662e 6d32 332c  f.m22, self.m23,
+0000a980: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000a990: 662e 6d33 312c 2073 656c 662e 6d33 322c  f.m31, self.m32,
+0000a9a0: 2073 656c 662e 6d33 3329 0a0a 2020 2020   self.m33)..    
+0000a9b0: 6465 6620 5f5f 6974 6572 5f5f 2873 656c  def __iter__(sel
+0000a9c0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+0000a9d0: 726e 206d 6174 3369 7465 7228 7365 6c66  rn mat3iter(self
+0000a9e0: 290a 0a20 2020 2064 6566 205f 5f72 6963  )..    def __ric
+0000a9f0: 6863 6d70 5f5f 2861 2c62 2c6f 7029 3a0a  hcmp__(a,b,op):.
+0000aa00: 2020 2020 2020 2020 6364 6566 206d 6174          cdef mat
+0000aa10: 3320 6d61 2c20 6d62 0a20 2020 2020 2020  3 ma, mb.       
+0000aa20: 2063 6465 6620 696e 7420 636f 700a 0a20   cdef int cop.. 
+0000aa30: 2020 2020 2020 2063 6f70 203d 206f 700a         cop = op.
+0000aa40: 0a20 2020 2020 2020 2074 6120 3d20 7479  .        ta = ty
+0000aa50: 7065 2861 290a 2020 2020 2020 2020 7462  pe(a).        tb
+0000aa60: 203d 2074 7970 6528 6229 0a20 2020 2020   = type(b).     
+0000aa70: 2020 2069 6620 2874 6121 3d6d 6174 3320     if (ta!=mat3 
+0000aa80: 6f72 2074 6221 3d6d 6174 3329 3a0a 2020  or tb!=mat3):.  
+0000aa90: 2020 2020 2020 2020 2020 6966 2063 6f70            if cop
+0000aaa0: 3d3d 333a 0a20 2020 2020 2020 2020 2020  ==3:.           
+0000aab0: 2020 2020 2072 6574 7572 6e20 310a 2020       return 1.  
+0000aac0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0000aad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aae0: 7265 7475 726e 2030 0a0a 2020 2020 2020  return 0..      
+0000aaf0: 2020 6d61 203d 2061 0a20 2020 2020 2020    ma = a.       
+0000ab00: 206d 6220 3d20 620a 0a20 2020 2020 2020   mb = b..       
+0000ab10: 2023 203c 0a20 2020 2020 2020 2069 6620   # <.        if 
+0000ab20: 636f 703d 3d30 3a0a 2020 2020 2020 2020  cop==0:.        
+0000ab30: 2020 2020 7265 7475 726e 2030 0a20 2020      return 0.   
+0000ab40: 2020 2020 2023 203c 3d0a 2020 2020 2020       # <=.      
+0000ab50: 2020 656c 6966 2063 6f70 3d3d 313a 0a20    elif cop==1:. 
+0000ab60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000ab70: 6e20 300a 2020 2020 2020 2020 2320 3d3d  n 0.        # ==
+0000ab80: 0a20 2020 2020 2020 2065 6c69 6620 636f  .        elif co
+0000ab90: 703d 3d32 3a0a 2020 2020 2020 2020 2020  p==2:.          
+0000aba0: 2020 7265 7475 726e 2028 6661 6273 286d    return (fabs(m
+0000abb0: 612e 6d31 312d 6d62 2e6d 3131 293c 3d65  a.m11-mb.m11)<=e
+0000abc0: 7073 2061 6e64 2066 6162 7328 6d61 2e6d  ps and fabs(ma.m
+0000abd0: 3132 2d6d 622e 6d31 3229 3c3d 6570 7320  12-mb.m12)<=eps 
+0000abe0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+0000abf0: 2020 2020 2020 2020 6661 6273 286d 612e          fabs(ma.
+0000ac00: 6d31 332d 6d62 2e6d 3133 293c 3d65 7073  m13-mb.m13)<=eps
+0000ac10: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+0000ac20: 2020 2020 2020 2020 2066 6162 7328 6d61           fabs(ma
+0000ac30: 2e6d 3231 2d6d 622e 6d32 3129 3c3d 6570  .m21-mb.m21)<=ep
+0000ac40: 7320 616e 6420 6661 6273 286d 612e 6d32  s and fabs(ma.m2
+0000ac50: 322d 6d62 2e6d 3232 293c 3d65 7073 2061  2-mb.m22)<=eps a
+0000ac60: 6e64 0a20 2020 2020 2020 2020 2020 2020  nd.             
+0000ac70: 2020 2020 2020 2066 6162 7328 6d61 2e6d         fabs(ma.m
+0000ac80: 3233 2d6d 622e 6d32 3329 3c3d 6570 7320  23-mb.m23)<=eps 
+0000ac90: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+0000aca0: 2020 2020 2020 2020 6661 6273 286d 612e          fabs(ma.
+0000acb0: 6d33 312d 6d62 2e6d 3331 293c 3d65 7073  m31-mb.m31)<=eps
+0000acc0: 2061 6e64 2066 6162 7328 6d61 2e6d 3332   and fabs(ma.m32
+0000acd0: 2d6d 622e 6d33 3229 3c3d 6570 7320 616e  -mb.m32)<=eps an
+0000ace0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0000acf0: 2020 2020 2020 6661 6273 286d 612e 6d33        fabs(ma.m3
+0000ad00: 332d 6d62 2e6d 3333 293c 3d65 7073 290a  3-mb.m33)<=eps).
+0000ad10: 2020 2020 2020 2020 2320 213d 0a20 2020          # !=.   
+0000ad20: 2020 2020 2065 6c69 6620 636f 703d 3d33       elif cop==3
+0000ad30: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000ad40: 7475 726e 2028 6661 6273 286d 612e 6d31  turn (fabs(ma.m1
+0000ad50: 312d 6d62 2e6d 3131 293e 6570 7320 6f72  1-mb.m11)>eps or
+0000ad60: 2066 6162 7328 6d61 2e6d 3132 2d6d 622e   fabs(ma.m12-mb.
+0000ad70: 6d31 3229 3e65 7073 206f 720a 2020 2020  m12)>eps or.    
+0000ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ad90: 6661 6273 286d 612e 6d31 332d 6d62 2e6d  fabs(ma.m13-mb.m
+0000ada0: 3133 293e 6570 7320 6f72 0a20 2020 2020  13)>eps or.     
+0000adb0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000adc0: 6162 7328 6d61 2e6d 3231 2d6d 622e 6d32  abs(ma.m21-mb.m2
+0000add0: 3129 3e65 7073 206f 7220 6661 6273 286d  1)>eps or fabs(m
+0000ade0: 612e 6d32 322d 6d62 2e6d 3232 293e 6570  a.m22-mb.m22)>ep
+0000adf0: 7320 6f72 0a20 2020 2020 2020 2020 2020  s or.           
+0000ae00: 2020 2020 2020 2020 2066 6162 7328 6d61           fabs(ma
+0000ae10: 2e6d 3233 2d6d 622e 6d32 3329 3e65 7073  .m23-mb.m23)>eps
+0000ae20: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
+0000ae30: 2020 2020 2020 2020 6661 6273 286d 612e          fabs(ma.
+0000ae40: 6d33 312d 6d62 2e6d 3331 293e 6570 7320  m31-mb.m31)>eps 
+0000ae50: 6f72 2066 6162 7328 6d61 2e6d 3332 2d6d  or fabs(ma.m32-m
+0000ae60: 622e 6d33 3229 3e65 7073 206f 720a 2020  b.m32)>eps or.  
+0000ae70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ae80: 2020 6661 6273 286d 612e 6d33 332d 6d62    fabs(ma.m33-mb
+0000ae90: 2e6d 3333 293e 6570 7329 0a20 2020 2020  .m33)>eps).     
+0000aea0: 2020 2023 203e 0a20 2020 2020 2020 2065     # >.        e
+0000aeb0: 6c69 6620 636f 703d 3d34 3a0a 2020 2020  lif cop==4:.    
+0000aec0: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+0000aed0: 0a20 2020 2020 2020 2023 203e 3d0a 2020  .        # >=.  
+0000aee0: 2020 2020 2020 656c 6966 2063 6f70 3d3d        elif cop==
+0000aef0: 353a 0a20 2020 2020 2020 2020 2020 2072  5:.            r
+0000af00: 6574 7572 6e20 300a 2020 2020 2020 2020  eturn 0.        
+0000af10: 2320 736f 6e73 7420 2846 6568 6c65 7229  # sonst (Fehler)
+0000af20: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000af30: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000af40: 2056 616c 7565 4572 726f 722c 2269 6e74   ValueError,"int
+0000af50: 6572 6e61 6c20 6572 726f 723a 2069 6c6c  ernal error: ill
+0000af60: 6567 616c 2072 6963 6820 636f 6d70 6172  egal rich compar
+0000af70: 6973 6f6e 206e 756d 6265 7222 0a0a 0a20  ison number"... 
+0000af80: 2020 2064 6566 205f 5f61 6464 5f5f 286d     def __add__(m
+0000af90: 6174 3320 612c 206d 6174 3320 6229 3a0a  at3 a, mat3 b):.
+0000afa0: 2020 2020 2020 2020 2222 224d 6174 7269          """Matri
+0000afb0: 7820 6164 6469 7469 6f6e 2e0a 2020 2020  x addition..    
+0000afc0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000afd0: 6364 6566 206d 6174 3320 7265 730a 2020  cdef mat3 res.  
+0000afe0: 2020 2020 2020 7265 7320 3d20 6d61 7433        res = mat3
+0000aff0: 2829 0a20 2020 2020 2020 2072 6573 2e6d  ().        res.m
+0000b000: 3131 203d 2061 2e6d 3131 202b 2062 2e6d  11 = a.m11 + b.m
+0000b010: 3131 0a20 2020 2020 2020 2072 6573 2e6d  11.        res.m
+0000b020: 3132 203d 2061 2e6d 3132 202b 2062 2e6d  12 = a.m12 + b.m
+0000b030: 3132 0a20 2020 2020 2020 2072 6573 2e6d  12.        res.m
+0000b040: 3133 203d 2061 2e6d 3133 202b 2062 2e6d  13 = a.m13 + b.m
+0000b050: 3133 0a20 2020 2020 2020 2072 6573 2e6d  13.        res.m
+0000b060: 3231 203d 2061 2e6d 3231 202b 2062 2e6d  21 = a.m21 + b.m
+0000b070: 3231 0a20 2020 2020 2020 2072 6573 2e6d  21.        res.m
+0000b080: 3232 203d 2061 2e6d 3232 202b 2062 2e6d  22 = a.m22 + b.m
+0000b090: 3232 0a20 2020 2020 2020 2072 6573 2e6d  22.        res.m
+0000b0a0: 3233 203d 2061 2e6d 3233 202b 2062 2e6d  23 = a.m23 + b.m
+0000b0b0: 3233 0a20 2020 2020 2020 2072 6573 2e6d  23.        res.m
+0000b0c0: 3331 203d 2061 2e6d 3331 202b 2062 2e6d  31 = a.m31 + b.m
+0000b0d0: 3331 0a20 2020 2020 2020 2072 6573 2e6d  31.        res.m
+0000b0e0: 3332 203d 2061 2e6d 3332 202b 2062 2e6d  32 = a.m32 + b.m
+0000b0f0: 3332 0a20 2020 2020 2020 2072 6573 2e6d  32.        res.m
+0000b100: 3333 203d 2061 2e6d 3333 202b 2062 2e6d  33 = a.m33 + b.m
+0000b110: 3333 0a20 2020 2020 2020 2072 6574 7572  33.        retur
+0000b120: 6e20 7265 730a 0a20 2020 2064 6566 205f  n res..    def _
+0000b130: 5f73 7562 5f5f 286d 6174 3320 612c 206d  _sub__(mat3 a, m
+0000b140: 6174 3320 6229 3a0a 2020 2020 2020 2020  at3 b):.        
+0000b150: 2222 224d 6174 7269 7820 7375 6274 7261  """Matrix subtra
+0000b160: 6374 696f 6e2e 0a20 2020 2020 2020 2022  ction..        "
+0000b170: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
+0000b180: 6d61 7433 2072 6573 0a20 2020 2020 2020  mat3 res.       
+0000b190: 2072 6573 203d 206d 6174 3328 290a 2020   res = mat3().  
+0000b1a0: 2020 2020 2020 7265 732e 6d31 3120 3d20        res.m11 = 
+0000b1b0: 612e 6d31 3120 2d20 622e 6d31 310a 2020  a.m11 - b.m11.  
+0000b1c0: 2020 2020 2020 7265 732e 6d31 3220 3d20        res.m12 = 
+0000b1d0: 612e 6d31 3220 2d20 622e 6d31 320a 2020  a.m12 - b.m12.  
+0000b1e0: 2020 2020 2020 7265 732e 6d31 3320 3d20        res.m13 = 
+0000b1f0: 612e 6d31 3320 2d20 622e 6d31 330a 2020  a.m13 - b.m13.  
+0000b200: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
+0000b210: 612e 6d32 3120 2d20 622e 6d32 310a 2020  a.m21 - b.m21.  
+0000b220: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
+0000b230: 612e 6d32 3220 2d20 622e 6d32 320a 2020  a.m22 - b.m22.  
+0000b240: 2020 2020 2020 7265 732e 6d32 3320 3d20        res.m23 = 
+0000b250: 612e 6d32 3320 2d20 622e 6d32 330a 2020  a.m23 - b.m23.  
+0000b260: 2020 2020 2020 7265 732e 6d33 3120 3d20        res.m31 = 
+0000b270: 612e 6d33 3120 2d20 622e 6d33 310a 2020  a.m31 - b.m31.  
+0000b280: 2020 2020 2020 7265 732e 6d33 3220 3d20        res.m32 = 
+0000b290: 612e 6d33 3220 2d20 622e 6d33 320a 2020  a.m32 - b.m32.  
+0000b2a0: 2020 2020 2020 7265 732e 6d33 3320 3d20        res.m33 = 
+0000b2b0: 612e 6d33 3320 2d20 622e 6d33 330a 2020  a.m33 - b.m33.  
+0000b2c0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0000b2d0: 0a0a 2020 2020 6465 6620 5f5f 6d75 6c5f  ..    def __mul_
+0000b2e0: 5f28 612c 2062 293a 0a20 2020 2020 2020  _(a, b):.       
+0000b2f0: 2022 2222 4d75 6c74 6970 6c69 6361 7469   """Multiplicati
+0000b300: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
+0000b310: 2020 2020 2020 2020 6364 6566 206d 6174          cdef mat
+0000b320: 3320 6d61 2c20 6d62 2c20 7265 730a 2020  3 ma, mb, res.  
+0000b330: 2020 2020 2020 6364 6566 2076 6563 3320        cdef vec3 
+0000b340: 7661 2c20 7662 2c20 7672 6573 0a20 2020  va, vb, vres.   
+0000b350: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
+0000b360: 2072 0a0a 2020 2020 2020 2020 7461 203d   r..        ta =
+0000b370: 2074 7970 6528 6129 0a20 2020 2020 2020   type(a).       
+0000b380: 2074 6220 3d20 7479 7065 2862 290a 0a20   tb = type(b).. 
+0000b390: 2020 2020 2020 2023 206d 6174 3320 6f6e         # mat3 on
+0000b3a0: 2074 6865 206c 6566 743f 0a20 2020 2020   the left?.     
+0000b3b0: 2020 2069 6620 7461 2069 7320 6d61 7433     if ta is mat3
+0000b3c0: 3a0a 2020 2020 2020 2020 2020 2020 6d61  :.            ma
+0000b3d0: 203d 2061 0a20 2020 2020 2020 2020 2020   = a.           
+0000b3e0: 2023 206d 6174 3320 6f6e 2074 6865 2072   # mat3 on the r
+0000b3f0: 6967 6874 3f0a 2020 2020 2020 2020 2020  ight?.          
+0000b400: 2020 6966 2074 6220 6973 206d 6174 333a    if tb is mat3:
+0000b410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b420: 2023 206d 6174 332a 6d61 7433 0a20 2020   # mat3*mat3.   
+0000b430: 2020 2020 2020 2020 2020 2020 2072 6573               res
+0000b440: 203d 206d 6174 3328 290a 2020 2020 2020   = mat3().      
+0000b450: 2020 2020 2020 2020 2020 6d62 203d 2062            mb = b
+0000b460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b470: 2072 6573 2e6d 3131 203d 206d 612e 6d31   res.m11 = ma.m1
+0000b480: 312a 6d62 2e6d 3131 2b6d 612e 6d31 322a  1*mb.m11+ma.m12*
+0000b490: 6d62 2e6d 3231 2b6d 612e 6d31 332a 6d62  mb.m21+ma.m13*mb
+0000b4a0: 2e6d 3331 0a20 2020 2020 2020 2020 2020  .m31.           
+0000b4b0: 2020 2020 2072 6573 2e6d 3132 203d 206d       res.m12 = m
+0000b4c0: 612e 6d31 312a 6d62 2e6d 3132 2b6d 612e  a.m11*mb.m12+ma.
+0000b4d0: 6d31 322a 6d62 2e6d 3232 2b6d 612e 6d31  m12*mb.m22+ma.m1
+0000b4e0: 332a 6d62 2e6d 3332 0a20 2020 2020 2020  3*mb.m32.       
+0000b4f0: 2020 2020 2020 2020 2072 6573 2e6d 3133           res.m13
+0000b500: 203d 206d 612e 6d31 312a 6d62 2e6d 3133   = ma.m11*mb.m13
+0000b510: 2b6d 612e 6d31 322a 6d62 2e6d 3233 2b6d  +ma.m12*mb.m23+m
+0000b520: 612e 6d31 332a 6d62 2e6d 3333 0a20 2020  a.m13*mb.m33.   
+0000b530: 2020 2020 2020 2020 2020 2020 2072 6573               res
+0000b540: 2e6d 3231 203d 206d 612e 6d32 312a 6d62  .m21 = ma.m21*mb
+0000b550: 2e6d 3131 2b6d 612e 6d32 322a 6d62 2e6d  .m11+ma.m22*mb.m
+0000b560: 3231 2b6d 612e 6d32 332a 6d62 2e6d 3331  21+ma.m23*mb.m31
+0000b570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b580: 2072 6573 2e6d 3232 203d 206d 612e 6d32   res.m22 = ma.m2
+0000b590: 312a 6d62 2e6d 3132 2b6d 612e 6d32 322a  1*mb.m12+ma.m22*
+0000b5a0: 6d62 2e6d 3232 2b6d 612e 6d32 332a 6d62  mb.m22+ma.m23*mb
+0000b5b0: 2e6d 3332 0a20 2020 2020 2020 2020 2020  .m32.           
+0000b5c0: 2020 2020 2072 6573 2e6d 3233 203d 206d       res.m23 = m
+0000b5d0: 612e 6d32 312a 6d62 2e6d 3133 2b6d 612e  a.m21*mb.m13+ma.
+0000b5e0: 6d32 322a 6d62 2e6d 3233 2b6d 612e 6d32  m22*mb.m23+ma.m2
+0000b5f0: 332a 6d62 2e6d 3333 0a20 2020 2020 2020  3*mb.m33.       
+0000b600: 2020 2020 2020 2020 2072 6573 2e6d 3331           res.m31
+0000b610: 203d 206d 612e 6d33 312a 6d62 2e6d 3131   = ma.m31*mb.m11
+0000b620: 2b6d 612e 6d33 322a 6d62 2e6d 3231 2b6d  +ma.m32*mb.m21+m
+0000b630: 612e 6d33 332a 6d62 2e6d 3331 0a20 2020  a.m33*mb.m31.   
+0000b640: 2020 2020 2020 2020 2020 2020 2072 6573               res
+0000b650: 2e6d 3332 203d 206d 612e 6d33 312a 6d62  .m32 = ma.m31*mb
+0000b660: 2e6d 3132 2b6d 612e 6d33 322a 6d62 2e6d  .m12+ma.m32*mb.m
+0000b670: 3232 2b6d 612e 6d33 332a 6d62 2e6d 3332  22+ma.m33*mb.m32
+0000b680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b690: 2072 6573 2e6d 3333 203d 206d 612e 6d33   res.m33 = ma.m3
+0000b6a0: 312a 6d62 2e6d 3133 2b6d 612e 6d33 322a  1*mb.m13+ma.m32*
+0000b6b0: 6d62 2e6d 3233 2b6d 612e 6d33 332a 6d62  mb.m23+ma.m33*mb
+0000b6c0: 2e6d 3333 0a20 2020 2020 2020 2020 2020  .m33.           
+0000b6d0: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
+0000b6e0: 2020 2020 2020 2020 2020 2020 2320 7665              # ve
+0000b6f0: 6333 206f 6e20 7468 6520 7269 6768 743f  c3 on the right?
+0000b700: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0000b710: 6620 7462 2069 7320 7665 6333 3a0a 2020  f tb is vec3:.  
+0000b720: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0000b730: 6d61 7433 2a76 6563 330a 2020 2020 2020  mat3*vec3.      
+0000b740: 2020 2020 2020 2020 2020 7772 6573 203d            wres =
+0000b750: 2076 6563 3328 290a 2020 2020 2020 2020   vec3().        
+0000b760: 2020 2020 2020 2020 7762 2020 203d 2062          wb   = b
+0000b770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b780: 2077 7265 732e 7820 3d20 6d61 2e6d 3131   wres.x = ma.m11
+0000b790: 2a77 622e 7820 2b20 6d61 2e6d 3132 2a77  *wb.x + ma.m12*w
+0000b7a0: 622e 7920 2b20 6d61 2e6d 3133 2a77 622e  b.y + ma.m13*wb.
+0000b7b0: 7a0a 2020 2020 2020 2020 2020 2020 2020  z.              
+0000b7c0: 2020 7772 6573 2e79 203d 206d 612e 6d32    wres.y = ma.m2
+0000b7d0: 312a 7762 2e78 202b 206d 612e 6d32 322a  1*wb.x + ma.m22*
+0000b7e0: 7762 2e79 202b 206d 612e 6d32 332a 7762  wb.y + ma.m23*wb
+0000b7f0: 2e7a 0a20 2020 2020 2020 2020 2020 2020  .z.             
+0000b800: 2020 2077 7265 732e 7a20 3d20 6d61 2e6d     wres.z = ma.m
+0000b810: 3331 2a77 622e 7820 2b20 6d61 2e6d 3332  31*wb.x + ma.m32
+0000b820: 2a77 622e 7920 2b20 6d61 2e6d 3333 2a77  *wb.y + ma.m33*w
+0000b830: 622e 7a0a 2020 2020 2020 2020 2020 2020  b.z.            
+0000b840: 2020 2020 7265 7475 726e 2077 7265 730a      return wres.
+0000b850: 2020 2020 2020 2020 2020 2020 2320 5363              # Sc
+0000b860: 616c 6172 206f 6e20 7468 6520 7269 6768  alar on the righ
+0000b870: 743f 0a20 2020 2020 2020 2020 2020 2065  t?.            e
+0000b880: 6c69 6620 7462 2069 7320 666c 6f61 7420  lif tb is float 
+0000b890: 6f72 2074 6220 6973 2069 6e74 206f 7220  or tb is int or 
+0000b8a0: 7462 2069 7320 6c6f 6e67 3a0a 2020 2020  tb is long:.    
+0000b8b0: 2020 2020 2020 2020 2020 2020 7265 7320              res 
+0000b8c0: 3d20 6d61 7433 2829 0a20 2020 2020 2020  = mat3().       
+0000b8d0: 2020 2020 2020 2020 2072 203d 2062 0a20           r = b. 
+0000b8e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000b8f0: 6573 2e6d 3131 203d 206d 612e 6d31 312a  es.m11 = ma.m11*
+0000b900: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+0000b910: 2020 7265 732e 6d31 3220 3d20 6d61 2e6d    res.m12 = ma.m
+0000b920: 3132 2a72 0a20 2020 2020 2020 2020 2020  12*r.           
+0000b930: 2020 2020 2072 6573 2e6d 3133 203d 206d       res.m13 = m
+0000b940: 612e 6d31 332a 720a 2020 2020 2020 2020  a.m13*r.        
+0000b950: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
+0000b960: 3d20 6d61 2e6d 3231 2a72 0a20 2020 2020  = ma.m21*r.     
+0000b970: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+0000b980: 3232 203d 206d 612e 6d32 322a 720a 2020  22 = ma.m22*r.  
+0000b990: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000b9a0: 732e 6d32 3320 3d20 6d61 2e6d 3233 2a72  s.m23 = ma.m23*r
+0000b9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b9c0: 2072 6573 2e6d 3331 203d 206d 612e 6d33   res.m31 = ma.m3
+0000b9d0: 312a 720a 2020 2020 2020 2020 2020 2020  1*r.            
+0000b9e0: 2020 2020 7265 732e 6d33 3220 3d20 6d61      res.m32 = ma
+0000b9f0: 2e6d 3332 2a72 0a20 2020 2020 2020 2020  .m32*r.         
+0000ba00: 2020 2020 2020 2072 6573 2e6d 3333 203d         res.m33 =
+0000ba10: 206d 612e 6d33 332a 720a 2020 2020 2020   ma.m33*r.      
+0000ba20: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000ba30: 2072 6573 0a0a 2020 2020 2020 2020 2320   res..        # 
+0000ba40: 7665 6333 206f 6e20 7468 6520 6c65 6674  vec3 on the left
+0000ba50: 3f20 2874 6865 6e20 7468 6572 6520 6d75  ? (then there mu
+0000ba60: 7374 2062 6520 6120 6d61 7433 206f 6e20  st be a mat3 on 
+0000ba70: 7468 6520 7269 6768 7429 0a20 2020 2020  the right).     
+0000ba80: 2020 2065 6c69 6620 7461 2069 7320 7665     elif ta is ve
+0000ba90: 6333 3a0a 2020 2020 2020 2020 2020 2020  c3:.            
+0000baa0: 2320 7665 6333 2a6d 6174 330a 2020 2020  # vec3*mat3.    
+0000bab0: 2020 2020 2020 2020 7772 6573 203d 2076          wres = v
+0000bac0: 6563 3328 290a 2020 2020 2020 2020 2020  ec3().          
+0000bad0: 2020 7761 2020 203d 2061 0a20 2020 2020    wa   = a.     
+0000bae0: 2020 2020 2020 206d 6220 2020 3d20 620a         mb   = b.
+0000baf0: 2020 2020 2020 2020 2020 2020 7772 6573              wres
+0000bb00: 2e78 203d 2077 612e 782a 6d62 2e6d 3131  .x = wa.x*mb.m11
+0000bb10: 202b 2077 612e 792a 6d62 2e6d 3231 202b   + wa.y*mb.m21 +
+0000bb20: 2077 612e 7a2a 6d62 2e6d 3331 0a20 2020   wa.z*mb.m31.   
+0000bb30: 2020 2020 2020 2020 2077 7265 732e 7920           wres.y 
+0000bb40: 3d20 7761 2e78 2a6d 622e 6d31 3220 2b20  = wa.x*mb.m12 + 
+0000bb50: 7761 2e79 2a6d 622e 6d32 3220 2b20 7761  wa.y*mb.m22 + wa
+0000bb60: 2e7a 2a6d 622e 6d33 320a 2020 2020 2020  .z*mb.m32.      
+0000bb70: 2020 2020 2020 7772 6573 2e7a 203d 2077        wres.z = w
+0000bb80: 612e 782a 6d62 2e6d 3133 202b 2077 612e  a.x*mb.m13 + wa.
+0000bb90: 792a 6d62 2e6d 3233 202b 2077 612e 7a2a  y*mb.m23 + wa.z*
+0000bba0: 6d62 2e6d 3333 0a20 2020 2020 2020 2020  mb.m33.         
+0000bbb0: 2020 2072 6574 7572 6e20 7772 6573 0a0a     return wres..
+0000bbc0: 2020 2020 2020 2020 2320 5363 616c 6172          # Scalar
+0000bbd0: 206f 6e20 7468 6520 6c65 6674 3f20 2874   on the left? (t
+0000bbe0: 6865 6e20 7468 6572 6520 6d75 7374 2062  hen there must b
+0000bbf0: 6520 6120 6d61 7433 206f 6e20 7468 6520  e a mat3 on the 
+0000bc00: 7269 6768 7429 0a20 2020 2020 2020 2065  right).        e
+0000bc10: 6c69 6620 7461 2069 7320 666c 6f61 7420  lif ta is float 
+0000bc20: 6f72 2074 6120 6973 2069 6e74 206f 7220  or ta is int or 
+0000bc30: 7461 2069 7320 6c6f 6e67 3a0a 2020 2020  ta is long:.    
+0000bc40: 2020 2020 2020 2020 7265 7320 3d20 6d61          res = ma
+0000bc50: 7433 2829 0a20 2020 2020 2020 2020 2020  t3().           
+0000bc60: 2072 2020 3d20 610a 2020 2020 2020 2020   r  = a.        
+0000bc70: 2020 2020 6d62 203d 2062 0a20 2020 2020      mb = b.     
+0000bc80: 2020 2020 2020 2072 6573 2e6d 3131 203d         res.m11 =
+0000bc90: 2072 2a6d 622e 6d31 310a 2020 2020 2020   r*mb.m11.      
+0000bca0: 2020 2020 2020 7265 732e 6d31 3220 3d20        res.m12 = 
+0000bcb0: 722a 6d62 2e6d 3132 0a20 2020 2020 2020  r*mb.m12.       
+0000bcc0: 2020 2020 2072 6573 2e6d 3133 203d 2072       res.m13 = r
+0000bcd0: 2a6d 622e 6d31 330a 2020 2020 2020 2020  *mb.m13.        
+0000bce0: 2020 2020 7265 732e 6d32 3120 3d20 722a      res.m21 = r*
+0000bcf0: 6d62 2e6d 3231 0a20 2020 2020 2020 2020  mb.m21.         
+0000bd00: 2020 2072 6573 2e6d 3232 203d 2072 2a6d     res.m22 = r*m
+0000bd10: 622e 6d32 320a 2020 2020 2020 2020 2020  b.m22.          
+0000bd20: 2020 7265 732e 6d32 3320 3d20 722a 6d62    res.m23 = r*mb
+0000bd30: 2e6d 3233 0a20 2020 2020 2020 2020 2020  .m23.           
+0000bd40: 2072 6573 2e6d 3331 203d 2072 2a6d 622e   res.m31 = r*mb.
+0000bd50: 6d33 310a 2020 2020 2020 2020 2020 2020  m31.            
+0000bd60: 7265 732e 6d33 3220 3d20 722a 6d62 2e6d  res.m32 = r*mb.m
+0000bd70: 3332 0a20 2020 2020 2020 2020 2020 2072  32.            r
+0000bd80: 6573 2e6d 3333 203d 2072 2a6d 622e 6d33  es.m33 = r*mb.m3
+0000bd90: 330a 2020 2020 2020 2020 2020 2020 7265  3.            re
+0000bda0: 7475 726e 2072 6573 0a0a 2020 2020 2020  turn res..      
+0000bdb0: 2020 2320 4e6f 2076 616c 6964 2063 6f6d    # No valid com
+0000bdc0: 6269 6e61 7469 6f6e 2066 6f75 6e64 0a20  bination found. 
+0000bdd0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+0000bde0: 6545 7272 6f72 2c20 2275 6e73 7570 706f  eError, "unsuppo
+0000bdf0: 7274 6564 206f 7065 7261 6e64 2074 7970  rted operand typ
+0000be00: 6520 666f 7220 2a22 0a0a 2020 2020 6465  e for *"..    de
+0000be10: 6620 5f5f 6469 765f 5f28 6d61 7433 2061  f __div__(mat3 a
+0000be20: 2c20 6229 3a0a 2020 2020 2020 2020 2320  , b):.        # 
+0000be30: 5079 7468 6f6e 2032 0a20 2020 2020 2020  Python 2.       
+0000be40: 2072 6574 7572 6e20 6d61 7433 2e5f 5f74   return mat3.__t
+0000be50: 7275 6564 6976 5f5f 2861 2c62 290a 0a20  ruediv__(a,b).. 
+0000be60: 2020 2064 6566 205f 5f74 7275 6564 6976     def __truediv
+0000be70: 5f5f 286d 6174 3320 612c 2062 293a 0a20  __(mat3 a, b):. 
+0000be80: 2020 2020 2020 2022 2222 4469 7669 7369         """Divisi
+0000be90: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
+0000bea0: 2020 2020 2020 2020 6364 6566 206d 6174          cdef mat
+0000beb0: 3320 7265 730a 2020 2020 2020 2020 6364  3 res.        cd
+0000bec0: 6566 2064 6f75 626c 6520 720a 0a20 2020  ef double r..   
+0000bed0: 2020 2020 2074 6220 3d20 7479 7065 2862       tb = type(b
+0000bee0: 290a 0a20 2020 2020 2020 2069 6620 7462  )..        if tb
+0000bef0: 2069 7320 666c 6f61 7420 6f72 2074 6220   is float or tb 
+0000bf00: 6973 2069 6e74 206f 7220 7462 2069 7320  is int or tb is 
+0000bf10: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
+0000bf20: 2020 2320 6d61 7433 2f73 6361 6c61 720a    # mat3/scalar.
+0000bf30: 2020 2020 2020 2020 2020 2020 7265 7320              res 
+0000bf40: 3d20 6d61 7433 2829 0a20 2020 2020 2020  = mat3().       
+0000bf50: 2020 2020 2072 203d 2062 0a20 2020 2020       r = b.     
+0000bf60: 2020 2020 2020 2069 6620 6661 6273 2872         if fabs(r
+0000bf70: 293c 3d65 7073 3a0a 2020 2020 2020 2020  )<=eps:.        
+0000bf80: 2020 2020 2020 2020 7261 6973 6520 5a65          raise Ze
+0000bf90: 726f 4469 7669 7369 6f6e 4572 726f 722c  roDivisionError,
+0000bfa0: 226d 6174 3320 6469 7669 7369 6f6e 220a  "mat3 division".
+0000bfb0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+0000bfc0: 6d31 3120 3d20 612e 6d31 312f 720a 2020  m11 = a.m11/r.  
+0000bfd0: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+0000bfe0: 3220 3d20 612e 6d31 322f 720a 2020 2020  2 = a.m12/r.    
+0000bff0: 2020 2020 2020 2020 7265 732e 6d31 3320          res.m13 
+0000c000: 3d20 612e 6d31 332f 720a 2020 2020 2020  = a.m13/r.      
+0000c010: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
+0000c020: 612e 6d32 312f 720a 2020 2020 2020 2020  a.m21/r.        
+0000c030: 2020 2020 7265 732e 6d32 3220 3d20 612e      res.m22 = a.
+0000c040: 6d32 322f 720a 2020 2020 2020 2020 2020  m22/r.          
+0000c050: 2020 7265 732e 6d32 3320 3d20 612e 6d32    res.m23 = a.m2
+0000c060: 332f 720a 2020 2020 2020 2020 2020 2020  3/r.            
+0000c070: 7265 732e 6d33 3120 3d20 612e 6d33 312f  res.m31 = a.m31/
+0000c080: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
+0000c090: 732e 6d33 3220 3d20 612e 6d33 322f 720a  s.m32 = a.m32/r.
+0000c0a0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+0000c0b0: 6d33 3320 3d20 612e 6d33 332f 720a 2020  m33 = a.m33/r.  
+0000c0c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000c0d0: 2072 6573 0a20 2020 2020 2020 2065 6c73   res.        els
+0000c0e0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0000c0f0: 6169 7365 2054 7970 6545 7272 6f72 2c20  aise TypeError, 
+0000c100: 2275 6e73 7570 706f 7274 6564 206f 7065  "unsupported ope
+0000c110: 7261 6e64 2074 7970 6520 666f 7220 2f22  rand type for /"
+0000c120: 0a0a 2020 2020 6465 6620 5f5f 6d6f 645f  ..    def __mod_
+0000c130: 5f28 6d61 7433 2073 656c 662c 206f 7468  _(mat3 self, oth
+0000c140: 6572 293a 0a20 2020 2020 2020 2022 2222  er):.        """
+0000c150: 4d6f 6475 6c6f 2e0a 2020 2020 2020 2020  Modulo..        
+0000c160: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+0000c170: 206d 6174 3320 6d62 2c20 7265 730a 0a20   mat3 mb, res.. 
+0000c180: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
+0000c190: 286f 7468 6572 290a 0a20 2020 2020 2020  (other)..       
+0000c1a0: 2069 6620 7462 2069 7320 666c 6f61 7420   if tb is float 
+0000c1b0: 6f72 2074 6220 6973 2069 6e74 206f 7220  or tb is int or 
+0000c1c0: 7462 2069 7320 6c6f 6e67 3a0a 2020 2020  tb is long:.    
+0000c1d0: 2020 2020 2020 2020 7220 3d20 6f74 6865          r = othe
+0000c1e0: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
+0000c1f0: 2066 6162 7328 7229 3c3d 6570 733a 0a20   fabs(r)<=eps:. 
+0000c200: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000c210: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
+0000c220: 6e45 7272 6f72 2c22 6d61 7433 206d 6f64  nError,"mat3 mod
+0000c230: 756c 6f22 0a20 2020 2020 2020 2020 2020  ulo".           
+0000c240: 2072 6573 203d 206d 6174 3328 290a 2020   res = mat3().  
+0000c250: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+0000c260: 3120 3d20 5f66 6d6f 6428 7365 6c66 2e6d  1 = _fmod(self.m
+0000c270: 3131 2c20 7229 0a20 2020 2020 2020 2020  11, r).         
+0000c280: 2020 2072 6573 2e6d 3132 203d 205f 666d     res.m12 = _fm
+0000c290: 6f64 2873 656c 662e 6d31 322c 2072 290a  od(self.m12, r).
+0000c2a0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+0000c2b0: 6d31 3320 3d20 5f66 6d6f 6428 7365 6c66  m13 = _fmod(self
+0000c2c0: 2e6d 3133 2c20 7229 0a20 2020 2020 2020  .m13, r).       
+0000c2d0: 2020 2020 2072 6573 2e6d 3231 203d 205f       res.m21 = _
+0000c2e0: 666d 6f64 2873 656c 662e 6d32 312c 2072  fmod(self.m21, r
+0000c2f0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+0000c300: 732e 6d32 3220 3d20 5f66 6d6f 6428 7365  s.m22 = _fmod(se
+0000c310: 6c66 2e6d 3232 2c20 7229 0a20 2020 2020  lf.m22, r).     
+0000c320: 2020 2020 2020 2072 6573 2e6d 3233 203d         res.m23 =
+0000c330: 205f 666d 6f64 2873 656c 662e 6d32 332c   _fmod(self.m23,
+0000c340: 2072 290a 2020 2020 2020 2020 2020 2020   r).            
+0000c350: 7265 732e 6d33 3120 3d20 5f66 6d6f 6428  res.m31 = _fmod(
+0000c360: 7365 6c66 2e6d 3331 2c20 7229 0a20 2020  self.m31, r).   
+0000c370: 2020 2020 2020 2020 2072 6573 2e6d 3332           res.m32
+0000c380: 203d 205f 666d 6f64 2873 656c 662e 6d33   = _fmod(self.m3
+0000c390: 322c 2072 290a 2020 2020 2020 2020 2020  2, r).          
+0000c3a0: 2020 7265 732e 6d33 3320 3d20 5f66 6d6f    res.m33 = _fmo
+0000c3b0: 6428 7365 6c66 2e6d 3333 2c20 7229 0a20  d(self.m33, r). 
+0000c3c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000c3d0: 6e20 7265 730a 0a20 2020 2020 2020 2065  n res..        e
+0000c3e0: 6c69 6620 7462 2069 7320 6d61 7433 3a0a  lif tb is mat3:.
+0000c3f0: 2020 2020 2020 2020 2020 2020 6d62 203d              mb =
+0000c400: 206f 7468 6572 0a0a 2020 2020 2020 2020   other..        
+0000c410: 2020 2020 6966 2028 6661 6273 286d 622e      if (fabs(mb.
+0000c420: 6d31 3129 3c3d 6570 7320 6f72 2066 6162  m11)<=eps or fab
+0000c430: 7328 6d62 2e6d 3132 293c 3d65 7073 206f  s(mb.m12)<=eps o
+0000c440: 7220 6661 6273 286d 622e 6d31 3329 3c3d  r fabs(mb.m13)<=
+0000c450: 6570 7320 6f72 0a20 2020 2020 2020 2020  eps or.         
+0000c460: 2020 2020 2020 2066 6162 7328 6d62 2e6d         fabs(mb.m
+0000c470: 3231 293c 3d65 7073 206f 7220 6661 6273  21)<=eps or fabs
+0000c480: 286d 622e 6d32 3229 3c3d 6570 7320 6f72  (mb.m22)<=eps or
+0000c490: 2066 6162 7328 6d62 2e6d 3233 293c 3d65   fabs(mb.m23)<=e
+0000c4a0: 7073 206f 720a 2020 2020 2020 2020 2020  ps or.          
+0000c4b0: 2020 2020 2020 6661 6273 286d 622e 6d33        fabs(mb.m3
+0000c4c0: 3129 3c3d 6570 7320 6f72 2066 6162 7328  1)<=eps or fabs(
+0000c4d0: 6d62 2e6d 3332 293c 3d65 7073 206f 7220  mb.m32)<=eps or 
+0000c4e0: 6661 6273 286d 622e 6d33 3329 3c3d 6570  fabs(mb.m33)<=ep
+0000c4f0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0000c500: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
+0000c510: 7669 7369 6f6e 4572 726f 722c 226d 6174  visionError,"mat
+0000c520: 3320 6d6f 6475 6c6f 220a 0a20 2020 2020  3 modulo"..     
+0000c530: 2020 2020 2020 2072 6573 3d6d 6174 3328         res=mat3(
+0000c540: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+0000c550: 732e 6d31 3120 3d20 5f66 6d6f 6428 7365  s.m11 = _fmod(se
+0000c560: 6c66 2e6d 3131 2c20 6d62 2e6d 3131 290a  lf.m11, mb.m11).
+0000c570: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+0000c580: 6d31 3220 3d20 5f66 6d6f 6428 7365 6c66  m12 = _fmod(self
+0000c590: 2e6d 3132 2c20 6d62 2e6d 3132 290a 2020  .m12, mb.m12).  
+0000c5a0: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+0000c5b0: 3320 3d20 5f66 6d6f 6428 7365 6c66 2e6d  3 = _fmod(self.m
+0000c5c0: 3133 2c20 6d62 2e6d 3133 290a 2020 2020  13, mb.m13).    
+0000c5d0: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
+0000c5e0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3231  = _fmod(self.m21
+0000c5f0: 2c20 6d62 2e6d 3231 290a 2020 2020 2020  , mb.m21).      
+0000c600: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
+0000c610: 5f66 6d6f 6428 7365 6c66 2e6d 3232 2c20  _fmod(self.m22, 
+0000c620: 6d62 2e6d 3232 290a 2020 2020 2020 2020  mb.m22).        
+0000c630: 2020 2020 7265 732e 6d32 3320 3d20 5f66      res.m23 = _f
+0000c640: 6d6f 6428 7365 6c66 2e6d 3233 2c20 6d62  mod(self.m23, mb
+0000c650: 2e6d 3233 290a 2020 2020 2020 2020 2020  .m23).          
+0000c660: 2020 7265 732e 6d33 3120 3d20 5f66 6d6f    res.m31 = _fmo
+0000c670: 6428 7365 6c66 2e6d 3331 2c20 6d62 2e6d  d(self.m31, mb.m
+0000c680: 3331 290a 2020 2020 2020 2020 2020 2020  31).            
+0000c690: 7265 732e 6d33 3220 3d20 5f66 6d6f 6428  res.m32 = _fmod(
+0000c6a0: 7365 6c66 2e6d 3332 2c20 6d62 2e6d 3332  self.m32, mb.m32
+0000c6b0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+0000c6c0: 732e 6d33 3320 3d20 5f66 6d6f 6428 7365  s.m33 = _fmod(se
+0000c6d0: 6c66 2e6d 3333 2c20 6d62 2e6d 3333 290a  lf.m33, mb.m33).
+0000c6e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000c6f0: 726e 2072 6573 0a0a 2020 2020 2020 2020  rn res..        
+0000c700: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000c710: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+0000c720: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
+0000c730: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
+0000c740: 2025 220a 0a0a 2020 2020 6465 6620 5f5f   %"...    def __
+0000c750: 6e65 675f 5f28 7365 6c66 293a 0a20 2020  neg__(self):.   
+0000c760: 2020 2020 2022 2222 4e65 6761 7469 6f6e       """Negation
+0000c770: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000c780: 2020 2020 2020 6364 6566 206d 6174 3320        cdef mat3 
+0000c790: 7265 730a 2020 2020 2020 2020 7265 7320  res.        res 
+0000c7a0: 3d20 6d61 7433 2829 0a20 2020 2020 2020  = mat3().       
+0000c7b0: 2072 6573 2e6d 3131 203d 202d 7365 6c66   res.m11 = -self
+0000c7c0: 2e6d 3131 0a20 2020 2020 2020 2072 6573  .m11.        res
+0000c7d0: 2e6d 3132 203d 202d 7365 6c66 2e6d 3132  .m12 = -self.m12
+0000c7e0: 0a20 2020 2020 2020 2072 6573 2e6d 3133  .        res.m13
+0000c7f0: 203d 202d 7365 6c66 2e6d 3133 0a20 2020   = -self.m13.   
+0000c800: 2020 2020 2072 6573 2e6d 3231 203d 202d       res.m21 = -
+0000c810: 7365 6c66 2e6d 3231 0a20 2020 2020 2020  self.m21.       
+0000c820: 2072 6573 2e6d 3232 203d 202d 7365 6c66   res.m22 = -self
+0000c830: 2e6d 3232 0a20 2020 2020 2020 2072 6573  .m22.        res
+0000c840: 2e6d 3233 203d 202d 7365 6c66 2e6d 3233  .m23 = -self.m23
+0000c850: 0a20 2020 2020 2020 2072 6573 2e6d 3331  .        res.m31
+0000c860: 203d 202d 7365 6c66 2e6d 3331 0a20 2020   = -self.m31.   
+0000c870: 2020 2020 2072 6573 2e6d 3332 203d 202d       res.m32 = -
+0000c880: 7365 6c66 2e6d 3332 0a20 2020 2020 2020  self.m32.       
+0000c890: 2072 6573 2e6d 3333 203d 202d 7365 6c66   res.m33 = -self
+0000c8a0: 2e6d 3333 0a20 2020 2020 2020 2072 6574  .m33.        ret
+0000c8b0: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
+0000c8c0: 205f 5f70 6f73 5f5f 2873 656c 6629 3a0a   __pos__(self):.
+0000c8d0: 2020 2020 2020 2020 6364 6566 206d 6174          cdef mat
+0000c8e0: 3320 7265 730a 2020 2020 2020 2020 7265  3 res.        re
+0000c8f0: 7320 3d20 6d61 7433 2829 0a20 2020 2020  s = mat3().     
+0000c900: 2020 2072 6573 2e6d 3131 203d 2073 656c     res.m11 = sel
+0000c910: 662e 6d31 310a 2020 2020 2020 2020 7265  f.m11.        re
+0000c920: 732e 6d31 3220 3d20 7365 6c66 2e6d 3132  s.m12 = self.m12
+0000c930: 0a20 2020 2020 2020 2072 6573 2e6d 3133  .        res.m13
+0000c940: 203d 2073 656c 662e 6d31 330a 2020 2020   = self.m13.    
+0000c950: 2020 2020 7265 732e 6d32 3120 3d20 7365      res.m21 = se
+0000c960: 6c66 2e6d 3231 0a20 2020 2020 2020 2072  lf.m21.        r
+0000c970: 6573 2e6d 3232 203d 2073 656c 662e 6d32  es.m22 = self.m2
+0000c980: 320a 2020 2020 2020 2020 7265 732e 6d32  2.        res.m2
+0000c990: 3320 3d20 7365 6c66 2e6d 3233 0a20 2020  3 = self.m23.   
+0000c9a0: 2020 2020 2072 6573 2e6d 3331 203d 2073       res.m31 = s
+0000c9b0: 656c 662e 6d33 310a 2020 2020 2020 2020  elf.m31.        
+0000c9c0: 7265 732e 6d33 3220 3d20 7365 6c66 2e6d  res.m32 = self.m
+0000c9d0: 3332 0a20 2020 2020 2020 2072 6573 2e6d  32.        res.m
+0000c9e0: 3333 203d 2073 656c 662e 6d33 330a 2020  33 = self.m33.  
+0000c9f0: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0000ca00: 0a0a 2020 2020 6465 6620 5f5f 6961 6464  ..    def __iadd
+0000ca10: 5f5f 2873 656c 662c 206d 6174 3320 6f74  __(self, mat3 ot
+0000ca20: 6865 7229 3a0a 2020 2020 2020 2020 2222  her):.        ""
+0000ca30: 2249 6e6c 696e 6520 6d61 7472 6978 2061  "Inline matrix a
+0000ca40: 6464 6974 696f 6e2e 0a20 2020 2020 2020  ddition..       
+0000ca50: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
+0000ca60: 662e 6d31 3120 3d20 7365 6c66 2e6d 3131  f.m11 = self.m11
+0000ca70: 202b 206f 7468 6572 2e6d 3131 0a20 2020   + other.m11.   
+0000ca80: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
+0000ca90: 7365 6c66 2e6d 3132 202b 206f 7468 6572  self.m12 + other
+0000caa0: 2e6d 3132 0a20 2020 2020 2020 2073 656c  .m12.        sel
+0000cab0: 662e 6d31 3320 3d20 7365 6c66 2e6d 3133  f.m13 = self.m13
+0000cac0: 202b 206f 7468 6572 2e6d 3133 0a20 2020   + other.m13.   
+0000cad0: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
+0000cae0: 7365 6c66 2e6d 3231 202b 206f 7468 6572  self.m21 + other
+0000caf0: 2e6d 3231 0a20 2020 2020 2020 2073 656c  .m21.        sel
+0000cb00: 662e 6d32 3220 3d20 7365 6c66 2e6d 3232  f.m22 = self.m22
+0000cb10: 202b 206f 7468 6572 2e6d 3232 0a20 2020   + other.m22.   
+0000cb20: 2020 2020 2073 656c 662e 6d32 3320 3d20       self.m23 = 
+0000cb30: 7365 6c66 2e6d 3233 202b 206f 7468 6572  self.m23 + other
+0000cb40: 2e6d 3233 0a20 2020 2020 2020 2073 656c  .m23.        sel
+0000cb50: 662e 6d33 3120 3d20 7365 6c66 2e6d 3331  f.m31 = self.m31
+0000cb60: 202b 206f 7468 6572 2e6d 3331 0a20 2020   + other.m31.   
+0000cb70: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
+0000cb80: 7365 6c66 2e6d 3332 202b 206f 7468 6572  self.m32 + other
+0000cb90: 2e6d 3332 0a20 2020 2020 2020 2073 656c  .m32.        sel
+0000cba0: 662e 6d33 3320 3d20 7365 6c66 2e6d 3333  f.m33 = self.m33
+0000cbb0: 202b 206f 7468 6572 2e6d 3333 0a20 2020   + other.m33.   
+0000cbc0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000cbd0: 0a0a 2020 2020 6465 6620 5f5f 6973 7562  ..    def __isub
+0000cbe0: 5f5f 2873 656c 662c 206d 6174 3320 6f74  __(self, mat3 ot
+0000cbf0: 6865 7229 3a0a 2020 2020 2020 2020 2222  her):.        ""
+0000cc00: 2249 6e6c 696e 6520 6d61 7472 6978 2073  "Inline matrix s
+0000cc10: 7562 7472 6163 7469 6f6e 2e0a 2020 2020  ubtraction..    
+0000cc20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000cc30: 7365 6c66 2e6d 3131 203d 2073 656c 662e  self.m11 = self.
+0000cc40: 6d31 3120 2d20 6f74 6865 722e 6d31 310a  m11 - other.m11.
+0000cc50: 2020 2020 2020 2020 7365 6c66 2e6d 3132          self.m12
+0000cc60: 203d 2073 656c 662e 6d31 3220 2d20 6f74   = self.m12 - ot
+0000cc70: 6865 722e 6d31 320a 2020 2020 2020 2020  her.m12.        
+0000cc80: 7365 6c66 2e6d 3133 203d 2073 656c 662e  self.m13 = self.
+0000cc90: 6d31 3320 2d20 6f74 6865 722e 6d31 330a  m13 - other.m13.
+0000cca0: 2020 2020 2020 2020 7365 6c66 2e6d 3231          self.m21
+0000ccb0: 203d 2073 656c 662e 6d32 3120 2d20 6f74   = self.m21 - ot
+0000ccc0: 6865 722e 6d32 310a 2020 2020 2020 2020  her.m21.        
+0000ccd0: 7365 6c66 2e6d 3232 203d 2073 656c 662e  self.m22 = self.
+0000cce0: 6d32 3220 2d20 6f74 6865 722e 6d32 320a  m22 - other.m22.
+0000ccf0: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
+0000cd00: 203d 2073 656c 662e 6d32 3320 2d20 6f74   = self.m23 - ot
+0000cd10: 6865 722e 6d32 330a 2020 2020 2020 2020  her.m23.        
+0000cd20: 7365 6c66 2e6d 3331 203d 2073 656c 662e  self.m31 = self.
+0000cd30: 6d33 3120 2d20 6f74 6865 722e 6d33 310a  m31 - other.m31.
+0000cd40: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
+0000cd50: 203d 2073 656c 662e 6d33 3220 2d20 6f74   = self.m32 - ot
+0000cd60: 6865 722e 6d33 320a 2020 2020 2020 2020  her.m32.        
+0000cd70: 7365 6c66 2e6d 3333 203d 2073 656c 662e  self.m33 = self.
+0000cd80: 6d33 3320 2d20 6f74 6865 722e 6d33 330a  m33 - other.m33.
+0000cd90: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000cda0: 656c 660a 0a20 2020 2064 6566 205f 5f69  elf..    def __i
+0000cdb0: 6d75 6c5f 5f28 7365 6c66 2c20 6f74 6865  mul__(self, othe
+0000cdc0: 7229 3a0a 2020 2020 2020 2020 2222 2249  r):.        """I
+0000cdd0: 6e6c 696e 6520 6d75 6c74 6970 6c69 6361  nline multiplica
+0000cde0: 7469 6f6e 2028 7363 616c 6172 206f 7220  tion (scalar or 
+0000cdf0: 6d61 7472 6978 292e 0a20 2020 2020 2020  matrix)..       
+0000ce00: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+0000ce10: 6620 646f 7562 6c65 2072 2c20 612c 622c  f double r, a,b,
+0000ce20: 630a 2020 2020 2020 2020 6364 6566 206d  c.        cdef m
+0000ce30: 6174 3320 6d62 0a0a 2020 2020 2020 2020  at3 mb..        
+0000ce40: 7462 203d 2074 7970 6528 6f74 6865 7229  tb = type(other)
+0000ce50: 0a20 2020 2020 2020 2069 6620 7462 2069  .        if tb i
+0000ce60: 7320 666c 6f61 7420 6f72 2074 6220 6973  s float or tb is
+0000ce70: 2069 6e74 206f 7220 7462 2069 7320 6c6f   int or tb is lo
+0000ce80: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+0000ce90: 723d 6f74 6865 720a 2020 2020 2020 2020  r=other.        
+0000cea0: 2020 2020 7365 6c66 2e6d 3131 203d 2073      self.m11 = s
+0000ceb0: 656c 662e 6d31 312a 720a 2020 2020 2020  elf.m11*r.      
+0000cec0: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
+0000ced0: 2073 656c 662e 6d31 322a 720a 2020 2020   self.m12*r.    
+0000cee0: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
+0000cef0: 203d 2073 656c 662e 6d31 332a 720a 2020   = self.m13*r.  
+0000cf00: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000cf10: 3231 203d 2073 656c 662e 6d32 312a 720a  21 = self.m21*r.
+0000cf20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000cf30: 2e6d 3232 203d 2073 656c 662e 6d32 322a  .m22 = self.m22*
+0000cf40: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
+0000cf50: 6c66 2e6d 3233 203d 2073 656c 662e 6d32  lf.m23 = self.m2
+0000cf60: 332a 720a 2020 2020 2020 2020 2020 2020  3*r.            
+0000cf70: 7365 6c66 2e6d 3331 203d 2073 656c 662e  self.m31 = self.
+0000cf80: 6d33 312a 720a 2020 2020 2020 2020 2020  m31*r.          
+0000cf90: 2020 7365 6c66 2e6d 3332 203d 2073 656c    self.m32 = sel
+0000cfa0: 662e 6d33 322a 720a 2020 2020 2020 2020  f.m32*r.        
+0000cfb0: 2020 2020 7365 6c66 2e6d 3333 203d 2073      self.m33 = s
+0000cfc0: 656c 662e 6d33 332a 720a 2020 2020 2020  elf.m33*r.      
+0000cfd0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000cfe0: 660a 2020 2020 2020 2020 656c 6966 2074  f.        elif t
+0000cff0: 6220 6973 206d 6174 333a 0a20 2020 2020  b is mat3:.     
+0000d000: 2020 2020 2020 206d 6220 3d20 6f74 6865         mb = othe
+0000d010: 720a 2020 2020 2020 2020 2020 2020 6120  r.            a 
+0000d020: 3d20 7365 6c66 2e6d 3131 0a20 2020 2020  = self.m11.     
+0000d030: 2020 2020 2020 2062 203d 2073 656c 662e         b = self.
+0000d040: 6d31 320a 2020 2020 2020 2020 2020 2020  m12.            
+0000d050: 6320 3d20 7365 6c66 2e6d 3133 0a20 2020  c = self.m13.   
+0000d060: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+0000d070: 3120 3d20 612a 6d62 2e6d 3131 2b62 2a6d  1 = a*mb.m11+b*m
+0000d080: 622e 6d32 312b 632a 6d62 2e6d 3331 0a20  b.m21+c*mb.m31. 
+0000d090: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000d0a0: 6d31 3220 3d20 612a 6d62 2e6d 3132 2b62  m12 = a*mb.m12+b
+0000d0b0: 2a6d 622e 6d32 322b 632a 6d62 2e6d 3332  *mb.m22+c*mb.m32
+0000d0c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000d0d0: 662e 6d31 3320 3d20 612a 6d62 2e6d 3133  f.m13 = a*mb.m13
+0000d0e0: 2b62 2a6d 622e 6d32 332b 632a 6d62 2e6d  +b*mb.m23+c*mb.m
+0000d0f0: 3333 0a20 2020 2020 2020 2020 2020 2061  33.            a
+0000d100: 203d 2073 656c 662e 6d32 310a 2020 2020   = self.m21.    
+0000d110: 2020 2020 2020 2020 6220 3d20 7365 6c66          b = self
+0000d120: 2e6d 3232 0a20 2020 2020 2020 2020 2020  .m22.           
+0000d130: 2063 203d 2073 656c 662e 6d32 330a 2020   c = self.m23.  
+0000d140: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000d150: 3231 203d 2061 2a6d 622e 6d31 312b 622a  21 = a*mb.m11+b*
+0000d160: 6d62 2e6d 3231 2b63 2a6d 622e 6d33 310a  mb.m21+c*mb.m31.
+0000d170: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000d180: 2e6d 3232 203d 2061 2a6d 622e 6d31 322b  .m22 = a*mb.m12+
+0000d190: 622a 6d62 2e6d 3232 2b63 2a6d 622e 6d33  b*mb.m22+c*mb.m3
+0000d1a0: 320a 2020 2020 2020 2020 2020 2020 7365  2.            se
+0000d1b0: 6c66 2e6d 3233 203d 2061 2a6d 622e 6d31  lf.m23 = a*mb.m1
+0000d1c0: 332b 622a 6d62 2e6d 3233 2b63 2a6d 622e  3+b*mb.m23+c*mb.
+0000d1d0: 6d33 330a 2020 2020 2020 2020 2020 2020  m33.            
+0000d1e0: 6120 3d20 7365 6c66 2e6d 3331 0a20 2020  a = self.m31.   
+0000d1f0: 2020 2020 2020 2020 2062 203d 2073 656c           b = sel
+0000d200: 662e 6d33 320a 2020 2020 2020 2020 2020  f.m32.          
+0000d210: 2020 6320 3d20 7365 6c66 2e6d 3333 0a20    c = self.m33. 
+0000d220: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000d230: 6d33 3120 3d20 612a 6d62 2e6d 3131 2b62  m31 = a*mb.m11+b
+0000d240: 2a6d 622e 6d32 312b 632a 6d62 2e6d 3331  *mb.m21+c*mb.m31
+0000d250: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000d260: 662e 6d33 3220 3d20 612a 6d62 2e6d 3132  f.m32 = a*mb.m12
+0000d270: 2b62 2a6d 622e 6d32 322b 632a 6d62 2e6d  +b*mb.m22+c*mb.m
+0000d280: 3332 0a20 2020 2020 2020 2020 2020 2073  32.            s
+0000d290: 656c 662e 6d33 3320 3d20 612a 6d62 2e6d  elf.m33 = a*mb.m
+0000d2a0: 3133 2b62 2a6d 622e 6d32 332b 632a 6d62  13+b*mb.m23+c*mb
+0000d2b0: 2e6d 3333 0a20 2020 2020 2020 2020 2020  .m33.           
+0000d2c0: 2072 6574 7572 6e20 7365 6c66 0a20 2020   return self.   
+0000d2d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000d2e0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+0000d2f0: 6545 7272 6f72 2c20 2275 6e73 7570 706f  eError, "unsuppo
+0000d300: 7274 6564 206f 7065 7261 6e64 2074 7970  rted operand typ
+0000d310: 6520 666f 7220 2a3d 220a 0a20 2020 2064  e for *="..    d
+0000d320: 6566 205f 5f69 6469 765f 5f28 7365 6c66  ef __idiv__(self
+0000d330: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
+0000d340: 2020 2222 2249 6e6c 696e 6520 6469 7669    """Inline divi
+0000d350: 7369 6f6e 2077 6974 6820 7363 616c 6172  sion with scalar
+0000d360: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000d370: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
+0000d380: 6520 720a 2020 2020 2020 2020 7462 203d  e r.        tb =
+0000d390: 2074 7970 6528 6f74 6865 7229 0a20 2020   type(other).   
+0000d3a0: 2020 2020 2069 6620 7462 2069 7320 666c       if tb is fl
+0000d3b0: 6f61 7420 6f72 2074 6220 6973 2069 6e74  oat or tb is int
+0000d3c0: 206f 7220 7462 2069 7320 6c6f 6e67 3a0a   or tb is long:.
+0000d3d0: 2020 2020 2020 2020 2020 2020 723d 6f74              r=ot
+0000d3e0: 6865 720a 2020 2020 2020 2020 2020 2020  her.            
+0000d3f0: 6966 2066 6162 7328 7229 3c3d 6570 733a  if fabs(r)<=eps:
+0000d400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d410: 2072 6169 7365 205a 6572 6f44 6976 6973   raise ZeroDivis
+0000d420: 696f 6e45 7272 6f72 2c22 6d61 7433 2064  ionError,"mat3 d
+0000d430: 6976 6973 696f 6e22 0a20 2020 2020 2020  ivision".       
+0000d440: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
+0000d450: 7365 6c66 2e6d 3131 2f72 0a20 2020 2020  self.m11/r.     
+0000d460: 2020 2020 2020 2073 656c 662e 6d31 3220         self.m12 
+0000d470: 3d20 7365 6c66 2e6d 3132 2f72 0a20 2020  = self.m12/r.   
+0000d480: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+0000d490: 3320 3d20 7365 6c66 2e6d 3133 2f72 0a20  3 = self.m13/r. 
+0000d4a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000d4b0: 6d32 3120 3d20 7365 6c66 2e6d 3231 2f72  m21 = self.m21/r
+0000d4c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000d4d0: 662e 6d32 3220 3d20 7365 6c66 2e6d 3232  f.m22 = self.m22
+0000d4e0: 2f72 0a20 2020 2020 2020 2020 2020 2073  /r.            s
+0000d4f0: 656c 662e 6d32 3320 3d20 7365 6c66 2e6d  elf.m23 = self.m
+0000d500: 3233 2f72 0a20 2020 2020 2020 2020 2020  23/r.           
+0000d510: 2073 656c 662e 6d33 3120 3d20 7365 6c66   self.m31 = self
+0000d520: 2e6d 3331 2f72 0a20 2020 2020 2020 2020  .m31/r.         
+0000d530: 2020 2073 656c 662e 6d33 3220 3d20 7365     self.m32 = se
+0000d540: 6c66 2e6d 3332 2f72 0a20 2020 2020 2020  lf.m32/r.       
+0000d550: 2020 2020 2073 656c 662e 6d33 3320 3d20       self.m33 = 
+0000d560: 7365 6c66 2e6d 3333 2f72 0a20 2020 2020  self.m33/r.     
+0000d570: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000d580: 6c66 0a20 2020 2020 2020 2065 6c73 653a  lf.        else:
+0000d590: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000d5a0: 7365 2054 7970 6545 7272 6f72 2c20 2275  se TypeError, "u
+0000d5b0: 6e73 7570 706f 7274 6564 206f 7065 7261  nsupported opera
+0000d5c0: 6e64 2074 7970 6520 666f 7220 2f3d 220a  nd type for /=".
+0000d5d0: 0a20 2020 2064 6566 205f 5f69 6d6f 645f  .    def __imod_
+0000d5e0: 5f28 7365 6c66 2c20 6229 3a0a 2020 2020  _(self, b):.    
+0000d5f0: 2020 2020 2222 2249 6e6c 696e 6520 6d6f      """Inline mo
+0000d600: 6475 6c6f 2e0a 2020 2020 2020 2020 2222  dulo..        ""
+0000d610: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
+0000d620: 6174 3320 6d62 0a20 2020 2020 2020 2063  at3 mb.        c
+0000d630: 6465 6620 646f 7562 6c65 2072 0a0a 2020  def double r..  
+0000d640: 2020 2020 2020 7462 203d 2074 7970 6528        tb = type(
+0000d650: 6229 0a0a 2020 2020 2020 2020 6966 2074  b)..        if t
+0000d660: 6220 6973 2066 6c6f 6174 206f 7220 7462  b is float or tb
+0000d670: 2069 7320 696e 7420 6f72 2074 6220 6973   is int or tb is
+0000d680: 206c 6f6e 673a 0a20 2020 2020 2020 2020   long:.         
+0000d690: 2020 2072 203d 2062 0a20 2020 2020 2020     r = b.       
+0000d6a0: 2020 2020 2069 6620 6661 6273 2872 293c       if fabs(r)<
+0000d6b0: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
+0000d6c0: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
+0000d6d0: 4469 7669 7369 6f6e 4572 726f 722c 226d  DivisionError,"m
+0000d6e0: 6174 3320 6d6f 6475 6c6f 220a 2020 2020  at3 modulo".    
+0000d6f0: 2020 2020 2020 2020 7365 6c66 2e6d 3131          self.m11
+0000d700: 203d 205f 666d 6f64 2873 656c 662e 6d31   = _fmod(self.m1
+0000d710: 312c 2072 290a 2020 2020 2020 2020 2020  1, r).          
+0000d720: 2020 7365 6c66 2e6d 3132 203d 205f 666d    self.m12 = _fm
+0000d730: 6f64 2873 656c 662e 6d31 322c 2072 290a  od(self.m12, r).
+0000d740: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000d750: 2e6d 3133 203d 205f 666d 6f64 2873 656c  .m13 = _fmod(sel
+0000d760: 662e 6d31 332c 2072 290a 2020 2020 2020  f.m13, r).      
+0000d770: 2020 2020 2020 7365 6c66 2e6d 3231 203d        self.m21 =
+0000d780: 205f 666d 6f64 2873 656c 662e 6d32 312c   _fmod(self.m21,
+0000d790: 2072 290a 2020 2020 2020 2020 2020 2020   r).            
+0000d7a0: 7365 6c66 2e6d 3232 203d 205f 666d 6f64  self.m22 = _fmod
+0000d7b0: 2873 656c 662e 6d32 322c 2072 290a 2020  (self.m22, r).  
+0000d7c0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000d7d0: 3233 203d 205f 666d 6f64 2873 656c 662e  23 = _fmod(self.
+0000d7e0: 6d32 332c 2072 290a 2020 2020 2020 2020  m23, r).        
+0000d7f0: 2020 2020 7365 6c66 2e6d 3331 203d 205f      self.m31 = _
+0000d800: 666d 6f64 2873 656c 662e 6d33 312c 2072  fmod(self.m31, r
+0000d810: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0000d820: 6c66 2e6d 3332 203d 205f 666d 6f64 2873  lf.m32 = _fmod(s
+0000d830: 656c 662e 6d33 322c 2072 290a 2020 2020  elf.m32, r).    
+0000d840: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
+0000d850: 203d 205f 666d 6f64 2873 656c 662e 6d33   = _fmod(self.m3
+0000d860: 332c 2072 290a 2020 2020 2020 2020 2020  3, r).          
+0000d870: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
+0000d880: 2020 2020 2020 656c 6966 2074 6220 6973        elif tb is
+0000d890: 206d 6174 333a 0a20 2020 2020 2020 2020   mat3:.         
+0000d8a0: 2020 206d 6220 3d20 620a 2020 2020 2020     mb = b.      
+0000d8b0: 2020 2020 2020 6966 2028 6661 6273 286d        if (fabs(m
+0000d8c0: 622e 6d31 3129 3c3d 6570 7320 6f72 2066  b.m11)<=eps or f
+0000d8d0: 6162 7328 6d62 2e6d 3132 293c 3d65 7073  abs(mb.m12)<=eps
+0000d8e0: 206f 7220 6661 6273 286d 622e 6d31 3329   or fabs(mb.m13)
+0000d8f0: 3c3d 6570 7320 6f72 0a20 2020 2020 2020  <=eps or.       
+0000d900: 2020 2020 2020 2020 2066 6162 7328 6d62           fabs(mb
+0000d910: 2e6d 3231 293c 3d65 7073 206f 7220 6661  .m21)<=eps or fa
+0000d920: 6273 286d 622e 6d32 3229 3c3d 6570 7320  bs(mb.m22)<=eps 
+0000d930: 6f72 2066 6162 7328 6d62 2e6d 3233 293c  or fabs(mb.m23)<
+0000d940: 3d65 7073 206f 720a 2020 2020 2020 2020  =eps or.        
+0000d950: 2020 2020 2020 2020 6661 6273 286d 622e          fabs(mb.
+0000d960: 6d33 3129 3c3d 6570 7320 6f72 2066 6162  m31)<=eps or fab
+0000d970: 7328 6d62 2e6d 3332 293c 3d65 7073 206f  s(mb.m32)<=eps o
+0000d980: 7220 6661 6273 286d 622e 6d33 3329 3c3d  r fabs(mb.m33)<=
+0000d990: 6570 7329 3a0a 2020 2020 2020 2020 2020  eps):.          
+0000d9a0: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
+0000d9b0: 4469 7669 7369 6f6e 4572 726f 722c 226d  DivisionError,"m
+0000d9c0: 6174 3320 6d6f 6475 6c6f 220a 2020 2020  at3 modulo".    
+0000d9d0: 2020 2020 2020 2020 7365 6c66 2e6d 3131          self.m11
+0000d9e0: 203d 205f 666d 6f64 2873 656c 662e 6d31   = _fmod(self.m1
+0000d9f0: 312c 206d 622e 6d31 3129 0a20 2020 2020  1, mb.m11).     
+0000da00: 2020 2020 2020 2073 656c 662e 6d31 3220         self.m12 
+0000da10: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3132  = _fmod(self.m12
+0000da20: 2c20 6d62 2e6d 3132 290a 2020 2020 2020  , mb.m12).      
+0000da30: 2020 2020 2020 7365 6c66 2e6d 3133 203d        self.m13 =
+0000da40: 205f 666d 6f64 2873 656c 662e 6d31 332c   _fmod(self.m13,
+0000da50: 206d 622e 6d31 3329 0a20 2020 2020 2020   mb.m13).       
+0000da60: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
+0000da70: 5f66 6d6f 6428 7365 6c66 2e6d 3231 2c20  _fmod(self.m21, 
+0000da80: 6d62 2e6d 3231 290a 2020 2020 2020 2020  mb.m21).        
+0000da90: 2020 2020 7365 6c66 2e6d 3232 203d 205f      self.m22 = _
+0000daa0: 666d 6f64 2873 656c 662e 6d32 322c 206d  fmod(self.m22, m
+0000dab0: 622e 6d32 3229 0a20 2020 2020 2020 2020  b.m22).         
+0000dac0: 2020 2073 656c 662e 6d32 3320 3d20 5f66     self.m23 = _f
+0000dad0: 6d6f 6428 7365 6c66 2e6d 3233 2c20 6d62  mod(self.m23, mb
+0000dae0: 2e6d 3233 290a 2020 2020 2020 2020 2020  .m23).          
+0000daf0: 2020 7365 6c66 2e6d 3331 203d 205f 666d    self.m31 = _fm
+0000db00: 6f64 2873 656c 662e 6d33 312c 206d 622e  od(self.m31, mb.
+0000db10: 6d33 3129 0a20 2020 2020 2020 2020 2020  m31).           
+0000db20: 2073 656c 662e 6d33 3220 3d20 5f66 6d6f   self.m32 = _fmo
+0000db30: 6428 7365 6c66 2e6d 3332 2c20 6d62 2e6d  d(self.m32, mb.m
+0000db40: 3332 290a 2020 2020 2020 2020 2020 2020  32).            
+0000db50: 7365 6c66 2e6d 3333 203d 205f 666d 6f64  self.m33 = _fmod
+0000db60: 2873 656c 662e 6d33 332c 206d 622e 6d33  (self.m33, mb.m3
+0000db70: 3329 0a20 2020 2020 2020 2020 2020 2072  3).            r
+0000db80: 6574 7572 6e20 7365 6c66 0a20 2020 2020  eturn self.     
+0000db90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000dba0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+0000dbb0: 7272 6f72 2c20 2275 6e73 7570 706f 7274  rror, "unsupport
+0000dbc0: 6564 206f 7065 7261 6e64 2074 7970 6520  ed operand type 
+0000dbd0: 666f 7220 253d 220a 0a0a 2020 2020 6465  for %="...    de
+0000dbe0: 6620 5f5f 6c65 6e5f 5f28 7365 6c66 293a  f __len__(self):
+0000dbf0: 0a20 2020 2020 2020 2022 2222 4c65 6e67  .        """Leng
+0000dc00: 7468 206f 6620 7468 6520 7365 7175 656e  th of the sequen
+0000dc10: 6365 2028 616c 7761 7973 2033 292e 2222  ce (always 3).""
+0000dc20: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0000dc30: 2033 0a0a 2020 2020 6465 6620 5f5f 6765   3..    def __ge
+0000dc40: 7469 7465 6d5f 5f28 6d61 7433 2073 656c  titem__(mat3 sel
+0000dc50: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
+0000dc60: 2022 2222 5265 7475 726e 2061 2063 6f6c   """Return a col
+0000dc70: 756d 6e20 6f72 2061 2073 696e 676c 6520  umn or a single 
+0000dc80: 6d61 7472 6978 2065 6c65 6d65 6e74 2e0a  matrix element..
+0000dc90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000dca0: 2020 2020 6364 6566 2069 6e74 2069 2c6a      cdef int i,j
+0000dcb0: 0a0a 2020 2020 2020 2020 543d 7479 7065  ..        T=type
+0000dcc0: 286b 6579 290a 2020 2020 2020 2020 6966  (key).        if
+0000dcd0: 2054 2069 7320 696e 7420 6f72 2054 2069   T is int or T i
+0000dce0: 7320 6c6f 6e67 3a0a 2020 2020 2020 2020  s long:.        
+0000dcf0: 2020 2020 6920 3d20 6b65 790a 2020 2020      i = key.    
+0000dd00: 2020 2020 2020 2020 6966 2069 3d3d 303a          if i==0:
+0000dd10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000dd20: 2072 6574 7572 6e20 7665 6333 2873 656c   return vec3(sel
+0000dd30: 662e 6d31 312c 2073 656c 662e 6d32 312c  f.m11, self.m21,
+0000dd40: 2073 656c 662e 6d33 3129 0a20 2020 2020   self.m31).     
+0000dd50: 2020 2020 2020 2065 6c69 6620 693d 3d31         elif i==1
+0000dd60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000dd70: 2020 7265 7475 726e 2076 6563 3328 7365    return vec3(se
+0000dd80: 6c66 2e6d 3132 2c20 7365 6c66 2e6d 3232  lf.m12, self.m22
+0000dd90: 2c20 7365 6c66 2e6d 3332 290a 2020 2020  , self.m32).    
+0000dda0: 2020 2020 2020 2020 656c 6966 2069 3d3d          elif i==
+0000ddb0: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
+0000ddc0: 2020 2072 6574 7572 6e20 7665 6333 2873     return vec3(s
+0000ddd0: 656c 662e 6d31 332c 2073 656c 662e 6d32  elf.m13, self.m2
+0000dde0: 332c 2073 656c 662e 6d33 3329 0a20 2020  3, self.m33).   
+0000ddf0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000de00: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000de10: 6169 7365 2049 6e64 6578 4572 726f 722c  aise IndexError,
+0000de20: 2022 696e 6465 7820 6f75 7420 6f66 2072   "index out of r
+0000de30: 616e 6765 220a 2020 2020 2020 2020 656c  ange".        el
+0000de40: 6966 2054 2069 7320 7475 706c 653a 0a20  if T is tuple:. 
+0000de50: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+0000de60: 6e28 6b65 7929 213d 323a 0a20 2020 2020  n(key)!=2:.     
+0000de70: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000de80: 2056 616c 7565 4572 726f 722c 2022 696e   ValueError, "in
+0000de90: 6465 7820 7475 706c 6520 6d75 7374 2062  dex tuple must b
+0000dea0: 6520 6120 322d 7475 706c 6522 0a20 2020  e a 2-tuple".   
+0000deb0: 2020 2020 2020 2020 2069 203d 206b 6579           i = key
+0000dec0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+0000ded0: 6a20 3d20 6b65 795b 315d 0a20 2020 2020  j = key[1].     
+0000dee0: 2020 2020 2020 2069 6620 693c 3020 6f72         if i<0 or
+0000def0: 2069 3e32 206f 7220 6a3c 3020 6f72 206a   i>2 or j<0 or j
+0000df00: 3e32 3a0a 2020 2020 2020 2020 2020 2020  >2:.            
+0000df10: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
+0000df20: 7272 6f72 2c20 2269 6e64 6578 206f 7574  rror, "index out
+0000df30: 206f 6620 7261 6e67 6522 0a0a 2020 2020   of range"..    
+0000df40: 2020 2020 2020 2020 6966 2069 3d3d 303a          if i==0:
+0000df50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000df60: 2069 6620 6a3d 3d30 3a0a 2020 2020 2020   if j==0:.      
+0000df70: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000df80: 7475 726e 2073 656c 662e 6d31 310a 2020  turn self.m11.  
+0000df90: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0000dfa0: 6966 206a 3d3d 313a 0a20 2020 2020 2020  if j==1:.       
+0000dfb0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0000dfc0: 7572 6e20 7365 6c66 2e6d 3132 0a20 2020  urn self.m12.   
+0000dfd0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+0000dfe0: 6620 6a3d 3d32 3a0a 2020 2020 2020 2020  f j==2:.        
+0000dff0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000e000: 726e 2073 656c 662e 6d31 330a 2020 2020  rn self.m13.    
+0000e010: 2020 2020 2020 2020 656c 6966 2069 3d3d          elif i==
+0000e020: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+0000e030: 2020 2069 6620 6a3d 3d30 3a0a 2020 2020     if j==0:.    
+0000e040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e050: 7265 7475 726e 2073 656c 662e 6d32 310a  return self.m21.
+0000e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e070: 656c 6966 206a 3d3d 313a 0a20 2020 2020  elif j==1:.     
+0000e080: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000e090: 6574 7572 6e20 7365 6c66 2e6d 3232 0a20  eturn self.m22. 
+0000e0a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000e0b0: 6c69 6620 6a3d 3d32 3a0a 2020 2020 2020  lif j==2:.      
+0000e0c0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000e0d0: 7475 726e 2073 656c 662e 6d32 330a 2020  turn self.m23.  
+0000e0e0: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+0000e0f0: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
+0000e100: 2020 2020 2069 6620 6a3d 3d30 3a0a 2020       if j==0:.  
+0000e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e120: 2020 7265 7475 726e 2073 656c 662e 6d33    return self.m3
+0000e130: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+0000e140: 2020 656c 6966 206a 3d3d 313a 0a20 2020    elif j==1:.   
+0000e150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e160: 2072 6574 7572 6e20 7365 6c66 2e6d 3332   return self.m32
+0000e170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e180: 2065 6c69 6620 6a3d 3d32 3a0a 2020 2020   elif j==2:.    
+0000e190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1a0: 7265 7475 726e 2073 656c 662e 6d33 330a  return self.m33.
+0000e1b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000e1c0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000e1d0: 5479 7065 4572 726f 722c 2269 6e64 6578  TypeError,"index
+0000e1e0: 206d 7573 7420 6265 2069 6e74 6567 6572   must be integer
+0000e1f0: 206f 7220 322d 7475 706c 6522 0a0a 2020   or 2-tuple"..  
+0000e200: 2020 6465 6620 5f5f 7365 7469 7465 6d5f    def __setitem_
+0000e210: 5f28 7365 6c66 2c20 6b65 792c 2076 616c  _(self, key, val
+0000e220: 7565 293a 0a20 2020 2020 2020 2022 2222  ue):.        """
+0000e230: 5365 7420 6120 636f 6c75 6d6e 206f 7220  Set a column or 
+0000e240: 6120 7369 6e67 6c65 206d 6174 7269 7820  a single matrix 
+0000e250: 656c 656d 656e 742e 0a0a 2020 2020 2020  element...      
+0000e260: 2020 5468 6520 636f 6c75 6d6e 206d 7573    The column mus
+0000e270: 7420 6265 2067 6976 656e 2061 7320 6120  t be given as a 
+0000e280: 332d 7365 7175 656e 6365 2028 7468 6973  3-sequence (this
+0000e290: 2069 6e63 6c75 6465 7320 7665 6333 2061   includes vec3 a
+0000e2a0: 7320 7765 6c6c 292e 0a20 2020 2020 2020  s well)..       
+0000e2b0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+0000e2c0: 6620 696e 7420 692c 6a0a 2020 2020 2020  f int i,j.      
+0000e2d0: 2020 6364 6566 2064 6f75 626c 6520 760a    cdef double v.
+0000e2e0: 0a20 2020 2020 2020 2054 3d74 7970 6528  .        T=type(
+0000e2f0: 6b65 7929 0a20 2020 2020 2020 2069 6620  key).        if 
+0000e300: 5420 6973 2069 6e74 206f 7220 5420 6973  T is int or T is
+0000e310: 206c 6f6e 673a 0a20 2020 2020 2020 2020   long:.         
+0000e320: 2020 2069 6620 6c65 6e28 7661 6c75 6529     if len(value)
+0000e330: 213d 333a 0a20 2020 2020 2020 2020 2020  !=3:.           
+0000e340: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000e350: 4572 726f 722c 2022 332d 7365 7175 656e  Error, "3-sequen
+0000e360: 6365 2065 7870 6563 7465 6422 0a20 2020  ce expected".   
+0000e370: 2020 2020 2020 2020 2069 203d 206b 6579           i = key
+0000e380: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000e390: 693d 3d30 3a0a 2020 2020 2020 2020 2020  i==0:.          
+0000e3a0: 2020 2020 2020 7365 6c66 2e6d 3131 203d        self.m11 =
+0000e3b0: 2076 616c 7565 5b30 5d0a 2020 2020 2020   value[0].      
+0000e3c0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+0000e3d0: 3231 203d 2076 616c 7565 5b31 5d0a 2020  21 = value[1].  
+0000e3e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000e3f0: 6c66 2e6d 3331 203d 2076 616c 7565 5b32  lf.m31 = value[2
+0000e400: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
+0000e410: 6966 2069 3d3d 313a 0a20 2020 2020 2020  if i==1:.       
+0000e420: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+0000e430: 3220 3d20 7661 6c75 655b 305d 0a20 2020  2 = value[0].   
+0000e440: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000e450: 662e 6d32 3220 3d20 7661 6c75 655b 315d  f.m22 = value[1]
+0000e460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e470: 2073 656c 662e 6d33 3220 3d20 7661 6c75   self.m32 = valu
+0000e480: 655b 325d 0a20 2020 2020 2020 2020 2020  e[2].           
+0000e490: 2065 6c69 6620 693d 3d32 3a0a 2020 2020   elif i==2:.    
+0000e4a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000e4b0: 2e6d 3133 203d 2076 616c 7565 5b30 5d0a  .m13 = value[0].
+0000e4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e4d0: 7365 6c66 2e6d 3233 203d 2076 616c 7565  self.m23 = value
+0000e4e0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+0000e4f0: 2020 2020 7365 6c66 2e6d 3333 203d 2076      self.m33 = v
+0000e500: 616c 7565 5b32 5d0a 2020 2020 2020 2020  alue[2].        
+0000e510: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000e520: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000e530: 496e 6465 7845 7272 6f72 2c20 2269 6e64  IndexError, "ind
+0000e540: 6578 206f 7574 206f 6620 7261 6e67 6522  ex out of range"
+0000e550: 0a20 2020 2020 2020 2065 6c69 6620 5420  .        elif T 
+0000e560: 6973 2074 7570 6c65 3a0a 2020 2020 2020  is tuple:.      
+0000e570: 2020 2020 2020 6966 206c 656e 286b 6579        if len(key
+0000e580: 2921 3d32 3a0a 2020 2020 2020 2020 2020  )!=2:.          
+0000e590: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000e5a0: 6545 7272 6f72 2c20 2269 6e64 6578 2074  eError, "index t
+0000e5b0: 7570 6c65 206d 7573 7420 6265 2061 2032  uple must be a 2
+0000e5c0: 2d74 7570 6c65 220a 2020 2020 2020 2020  -tuple".        
+0000e5d0: 2020 2020 6920 3d20 6b65 795b 305d 0a20      i = key[0]. 
+0000e5e0: 2020 2020 2020 2020 2020 206a 203d 206b             j = k
+0000e5f0: 6579 5b31 5d0a 2020 2020 2020 2020 2020  ey[1].          
+0000e600: 2020 7620 3d20 7661 6c75 650a 2020 2020    v = value.    
+0000e610: 2020 2020 2020 2020 6966 2069 3c30 206f          if i<0 o
+0000e620: 7220 693e 3220 6f72 206a 3c30 206f 7220  r i>2 or j<0 or 
+0000e630: 6a3e 323a 0a20 2020 2020 2020 2020 2020  j>2:.           
+0000e640: 2020 2020 2072 6169 7365 2049 6e64 6578       raise Index
+0000e650: 4572 726f 722c 2022 696e 6465 7820 6f75  Error, "index ou
+0000e660: 7420 6f66 2072 616e 6765 220a 0a20 2020  t of range"..   
+0000e670: 2020 2020 2020 2020 2069 6620 693d 3d30           if i==0
+0000e680: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000e690: 2020 6966 206a 3d3d 303a 0a20 2020 2020    if j==0:.     
+0000e6a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000e6b0: 656c 662e 6d31 3120 3d20 760a 2020 2020  elf.m11 = v.    
+0000e6c0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0000e6d0: 206a 3d3d 313a 0a20 2020 2020 2020 2020   j==1:.         
+0000e6e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000e6f0: 6d31 3220 3d20 760a 2020 2020 2020 2020  m12 = v.        
+0000e700: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
+0000e710: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
+0000e720: 2020 2020 2020 2073 656c 662e 6d31 3320         self.m13 
+0000e730: 3d20 760a 2020 2020 2020 2020 2020 2020  = v.            
+0000e740: 656c 6966 2069 3d3d 313a 0a20 2020 2020  elif i==1:.     
+0000e750: 2020 2020 2020 2020 2020 2069 6620 6a3d             if j=
+0000e760: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
+0000e770: 2020 2020 2020 2020 7365 6c66 2e6d 3231          self.m21
+0000e780: 203d 2076 0a20 2020 2020 2020 2020 2020   = v.           
+0000e790: 2020 2020 2065 6c69 6620 6a3d 3d31 3a0a       elif j==1:.
+0000e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e7b0: 2020 2020 7365 6c66 2e6d 3232 203d 2076      self.m22 = v
+0000e7c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e7d0: 2065 6c69 6620 6a3d 3d32 3a0a 2020 2020   elif j==2:.    
+0000e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e7f0: 7365 6c66 2e6d 3233 203d 2076 0a20 2020  self.m23 = v.   
+0000e800: 2020 2020 2020 2020 2065 6c69 6620 693d           elif i=
+0000e810: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
+0000e820: 2020 2020 6966 206a 3d3d 303a 0a20 2020      if j==0:.   
+0000e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e840: 2073 656c 662e 6d33 3120 3d20 760a 2020   self.m31 = v.  
+0000e850: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0000e860: 6966 206a 3d3d 313a 0a20 2020 2020 2020  if j==1:.       
+0000e870: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000e880: 662e 6d33 3220 3d20 760a 2020 2020 2020  f.m32 = v.      
+0000e890: 2020 2020 2020 2020 2020 656c 6966 206a            elif j
+0000e8a0: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
+0000e8b0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+0000e8c0: 3320 3d20 760a 2020 2020 2020 2020 656c  3 = v.        el
+0000e8d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000e8e0: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
+0000e8f0: 2269 6e64 6578 206d 7573 7420 6265 2069  "index must be i
+0000e900: 6e74 6567 6572 206f 7220 322d 7475 706c  nteger or 2-tupl
+0000e910: 6522 0a0a 2020 2020 6465 6620 6765 7452  e"..    def getR
+0000e920: 6f77 2873 656c 662c 2069 6478 293a 0a20  ow(self, idx):. 
+0000e930: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0000e940: 2072 6f77 2028 6173 2076 6563 3329 2e22   row (as vec3)."
+0000e950: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
+0000e960: 696e 7420 690a 0a20 2020 2020 2020 2054  int i..        T
+0000e970: 3d74 7970 6528 6964 7829 0a20 2020 2020  =type(idx).     
+0000e980: 2020 2069 6620 5421 3d69 6e74 2061 6e64     if T!=int and
+0000e990: 2054 213d 6c6f 6e67 3a0a 2020 2020 2020   T!=long:.      
+0000e9a0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+0000e9b0: 4572 726f 722c 2269 6e64 6578 206d 7573  Error,"index mus
+0000e9c0: 7420 6265 2069 6e74 6567 6572 220a 0a20  t be integer".. 
+0000e9d0: 2020 2020 2020 2069 203d 2069 6478 0a20         i = idx. 
+0000e9e0: 2020 2020 2020 2069 6620 693d 3d30 3a0a         if i==0:.
+0000e9f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000ea00: 726e 2076 6563 3328 7365 6c66 2e6d 3131  rn vec3(self.m11
+0000ea10: 2c20 7365 6c66 2e6d 3132 2c20 7365 6c66  , self.m12, self
+0000ea20: 2e6d 3133 290a 2020 2020 2020 2020 656c  .m13).        el
+0000ea30: 6966 2069 3d3d 313a 0a20 2020 2020 2020  if i==1:.       
+0000ea40: 2020 2020 2072 6574 7572 6e20 7665 6333       return vec3
+0000ea50: 2873 656c 662e 6d32 312c 2073 656c 662e  (self.m21, self.
+0000ea60: 6d32 322c 2073 656c 662e 6d32 3329 0a20  m22, self.m23). 
+0000ea70: 2020 2020 2020 2065 6c69 6620 693d 3d32         elif i==2
+0000ea80: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000ea90: 7475 726e 2076 6563 3328 7365 6c66 2e6d  turn vec3(self.m
+0000eaa0: 3331 2c20 7365 6c66 2e6d 3332 2c20 7365  31, self.m32, se
+0000eab0: 6c66 2e6d 3333 290a 2020 2020 2020 2020  lf.m33).        
+0000eac0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000ead0: 2020 7261 6973 6520 496e 6465 7845 7272    raise IndexErr
+0000eae0: 6f72 2c20 2269 6e64 6578 206f 7574 206f  or, "index out o
+0000eaf0: 6620 7261 6e67 6522 0a0a 2020 2020 6465  f range"..    de
+0000eb00: 6620 7365 7452 6f77 2873 656c 662c 2069  f setRow(self, i
+0000eb10: 6478 2c20 7661 6c75 6529 3a0a 2020 2020  dx, value):.    
+0000eb20: 2020 2020 2222 2253 6574 2072 6f77 2e22      """Set row."
+0000eb30: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
+0000eb40: 696e 7420 690a 0a20 2020 2020 2020 2054  int i..        T
+0000eb50: 3d74 7970 6528 6964 7829 0a20 2020 2020  =type(idx).     
+0000eb60: 2020 2069 6620 5421 3d69 6e74 2061 6e64     if T!=int and
+0000eb70: 2054 213d 6c6f 6e67 3a0a 2020 2020 2020   T!=long:.      
+0000eb80: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+0000eb90: 4572 726f 722c 2269 6e64 6578 206d 7573  Error,"index mus
+0000eba0: 7420 6265 2069 6e74 6567 6572 220a 0a20  t be integer".. 
+0000ebb0: 2020 2020 2020 2069 6620 6c65 6e28 7661         if len(va
+0000ebc0: 6c75 6529 213d 333a 0a20 2020 2020 2020  lue)!=3:.       
+0000ebd0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000ebe0: 4572 726f 722c 2022 332d 7365 7175 656e  Error, "3-sequen
+0000ebf0: 6365 2065 7870 6563 7465 6422 0a0a 2020  ce expected"..  
+0000ec00: 2020 2020 2020 6920 3d20 6964 780a 2020        i = idx.  
+0000ec10: 2020 2020 2020 6966 2069 3d3d 303a 0a20        if i==0:. 
+0000ec20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000ec30: 6d31 3120 3d20 7661 6c75 655b 305d 0a20  m11 = value[0]. 
+0000ec40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000ec50: 6d31 3220 3d20 7661 6c75 655b 315d 0a20  m12 = value[1]. 
+0000ec60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000ec70: 6d31 3320 3d20 7661 6c75 655b 325d 0a20  m13 = value[2]. 
+0000ec80: 2020 2020 2020 2065 6c69 6620 693d 3d31         elif i==1
+0000ec90: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0000eca0: 6c66 2e6d 3231 203d 2076 616c 7565 5b30  lf.m21 = value[0
+0000ecb0: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
+0000ecc0: 6c66 2e6d 3232 203d 2076 616c 7565 5b31  lf.m22 = value[1
+0000ecd0: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
+0000ece0: 6c66 2e6d 3233 203d 2076 616c 7565 5b32  lf.m23 = value[2
+0000ecf0: 5d0a 2020 2020 2020 2020 656c 6966 2069  ].        elif i
+0000ed00: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
+0000ed10: 2073 656c 662e 6d33 3120 3d20 7661 6c75   self.m31 = valu
+0000ed20: 655b 305d 0a20 2020 2020 2020 2020 2020  e[0].           
+0000ed30: 2073 656c 662e 6d33 3220 3d20 7661 6c75   self.m32 = valu
+0000ed40: 655b 315d 0a20 2020 2020 2020 2020 2020  e[1].           
+0000ed50: 2073 656c 662e 6d33 3320 3d20 7661 6c75   self.m33 = valu
+0000ed60: 655b 325d 0a20 2020 2020 2020 2065 6c73  e[2].        els
+0000ed70: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0000ed80: 6169 7365 2049 6e64 6578 4572 726f 722c  aise IndexError,
+0000ed90: 2022 696e 6465 7820 6f75 7420 6f66 2072   "index out of r
+0000eda0: 616e 6765 220a 0a0a 2020 2020 6465 6620  ange"...    def 
+0000edb0: 6765 7443 6f6c 756d 6e28 7365 6c66 2c20  getColumn(self, 
+0000edc0: 6964 7829 3a0a 2020 2020 2020 2020 2222  idx):.        ""
+0000edd0: 2252 6574 7572 6e20 636f 6c75 6d6e 2028  "Return column (
+0000ede0: 6173 2076 6563 3329 2e22 2222 0a20 2020  as vec3).""".   
+0000edf0: 2020 2020 2063 6465 6620 696e 7420 690a       cdef int i.
+0000ee00: 0a20 2020 2020 2020 2054 3d74 7970 6528  .        T=type(
+0000ee10: 6964 7829 0a20 2020 2020 2020 2069 6620  idx).        if 
+0000ee20: 5421 3d69 6e74 2061 6e64 2054 213d 6c6f  T!=int and T!=lo
+0000ee30: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+0000ee40: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
+0000ee50: 2269 6e64 6578 206d 7573 7420 6265 2069  "index must be i
+0000ee60: 6e74 6567 6572 220a 0a20 2020 2020 2020  nteger"..       
+0000ee70: 2069 203d 2069 6478 0a20 2020 2020 2020   i = idx.       
+0000ee80: 2069 6620 693d 3d30 3a0a 2020 2020 2020   if i==0:.      
+0000ee90: 2020 2020 2020 7265 7475 726e 2076 6563        return vec
+0000eea0: 3328 7365 6c66 2e6d 3131 2c20 7365 6c66  3(self.m11, self
+0000eeb0: 2e6d 3231 2c20 7365 6c66 2e6d 3331 290a  .m21, self.m31).
+0000eec0: 2020 2020 2020 2020 656c 6966 2069 3d3d          elif i==
+0000eed0: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
+0000eee0: 6574 7572 6e20 7665 6333 2873 656c 662e  eturn vec3(self.
+0000eef0: 6d31 322c 2073 656c 662e 6d32 322c 2073  m12, self.m22, s
+0000ef00: 656c 662e 6d33 3229 0a20 2020 2020 2020  elf.m32).       
+0000ef10: 2065 6c69 6620 693d 3d32 3a0a 2020 2020   elif i==2:.    
+0000ef20: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+0000ef30: 6563 3328 7365 6c66 2e6d 3133 2c20 7365  ec3(self.m13, se
+0000ef40: 6c66 2e6d 3233 2c20 7365 6c66 2e6d 3333  lf.m23, self.m33
+0000ef50: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+0000ef60: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000ef70: 6520 496e 6465 7845 7272 6f72 2c20 2269  e IndexError, "i
+0000ef80: 6e64 6578 206f 7574 206f 6620 7261 6e67  ndex out of rang
+0000ef90: 6522 0a0a 2020 2020 6465 6620 7365 7443  e"..    def setC
+0000efa0: 6f6c 756d 6e28 7365 6c66 2c20 6964 782c  olumn(self, idx,
+0000efb0: 2076 616c 7565 293a 0a20 2020 2020 2020   value):.       
+0000efc0: 2022 2222 5365 7420 636f 6c75 6d6e 2e22   """Set column."
+0000efd0: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
+0000efe0: 696e 7420 690a 0a20 2020 2020 2020 2054  int i..        T
+0000eff0: 3d74 7970 6528 6964 7829 0a20 2020 2020  =type(idx).     
+0000f000: 2020 2069 6620 5421 3d69 6e74 2061 6e64     if T!=int and
+0000f010: 2054 213d 6c6f 6e67 3a0a 2020 2020 2020   T!=long:.      
+0000f020: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+0000f030: 4572 726f 722c 2269 6e64 6578 206d 7573  Error,"index mus
+0000f040: 7420 6265 2069 6e74 6567 6572 220a 0a20  t be integer".. 
+0000f050: 2020 2020 2020 2069 6620 6c65 6e28 7661         if len(va
+0000f060: 6c75 6529 213d 333a 0a20 2020 2020 2020  lue)!=3:.       
+0000f070: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000f080: 4572 726f 722c 2022 332d 7365 7175 656e  Error, "3-sequen
+0000f090: 6365 2065 7870 6563 7465 6422 0a0a 2020  ce expected"..  
+0000f0a0: 2020 2020 2020 6920 3d20 6964 780a 2020        i = idx.  
+0000f0b0: 2020 2020 2020 6966 2069 3d3d 303a 0a20        if i==0:. 
+0000f0c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000f0d0: 6d31 3120 3d20 7661 6c75 655b 305d 0a20  m11 = value[0]. 
+0000f0e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000f0f0: 6d32 3120 3d20 7661 6c75 655b 315d 0a20  m21 = value[1]. 
+0000f100: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000f110: 6d33 3120 3d20 7661 6c75 655b 325d 0a20  m31 = value[2]. 
+0000f120: 2020 2020 2020 2065 6c69 6620 693d 3d31         elif i==1
+0000f130: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0000f140: 6c66 2e6d 3132 203d 2076 616c 7565 5b30  lf.m12 = value[0
+0000f150: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
+0000f160: 6c66 2e6d 3232 203d 2076 616c 7565 5b31  lf.m22 = value[1
+0000f170: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
+0000f180: 6c66 2e6d 3332 203d 2076 616c 7565 5b32  lf.m32 = value[2
+0000f190: 5d0a 2020 2020 2020 2020 656c 6966 2069  ].        elif i
+0000f1a0: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
+0000f1b0: 2073 656c 662e 6d31 3320 3d20 7661 6c75   self.m13 = valu
+0000f1c0: 655b 305d 0a20 2020 2020 2020 2020 2020  e[0].           
+0000f1d0: 2073 656c 662e 6d32 3320 3d20 7661 6c75   self.m23 = valu
+0000f1e0: 655b 315d 0a20 2020 2020 2020 2020 2020  e[1].           
+0000f1f0: 2073 656c 662e 6d33 3320 3d20 7661 6c75   self.m33 = valu
+0000f200: 655b 325d 0a20 2020 2020 2020 2065 6c73  e[2].        els
+0000f210: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0000f220: 6169 7365 2049 6e64 6578 4572 726f 722c  aise IndexError,
+0000f230: 2022 696e 6465 7820 6f75 7420 6f66 2072   "index out of r
+0000f240: 616e 6765 220a 0a0a 2020 2020 6465 6620  ange"...    def 
+0000f250: 746f 4c69 7374 2873 656c 662c 2072 6f77  toList(self, row
+0000f260: 6d61 6a6f 723d 3029 3a0a 2020 2020 2020  major=0):.      
+0000f270: 2020 2222 2252 6574 7572 6e20 6120 6c69    """Return a li
+0000f280: 7374 2063 6f6e 7461 696e 696e 6720 7468  st containing th
+0000f290: 6520 6d61 7472 6978 2065 6c65 6d65 6e74  e matrix element
+0000f2a0: 732e 0a0a 2020 2020 2020 2020 4279 2064  s...        By d
+0000f2b0: 6566 6175 6c74 2074 6865 206c 6973 7420  efault the list 
+0000f2c0: 6973 2069 6e20 636f 6c75 6d6e 2d6d 616a  is in column-maj
+0000f2d0: 6f72 206f 7264 6572 2e20 4966 2079 6f75  or order. If you
+0000f2e0: 2073 6574 2074 6865 0a20 2020 2020 2020   set the.       
+0000f2f0: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+0000f300: 6e74 2072 6f77 6d61 6a6f 7220 746f 2031  nt rowmajor to 1
+0000f310: 2c20 796f 7527 6c6c 2067 6574 2074 6865  , you'll get the
+0000f320: 206c 6973 7420 696e 2072 6f77 2d6d 616a   list in row-maj
+0000f330: 6f72 0a20 2020 2020 2020 206f 7264 6572  or.        order
+0000f340: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000f350: 2020 2020 2020 6966 2072 6f77 6d61 6a6f        if rowmajo
+0000f360: 723a 0a20 2020 2020 2020 2020 2020 2072  r:.            r
+0000f370: 6574 7572 6e20 5b73 656c 662e 6d31 312c  eturn [self.m11,
+0000f380: 2073 656c 662e 6d31 322c 2073 656c 662e   self.m12, self.
+0000f390: 6d31 332c 0a20 2020 2020 2020 2020 2020  m13,.           
+0000f3a0: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+0000f3b0: 312c 2073 656c 662e 6d32 322c 2073 656c  1, self.m22, sel
+0000f3c0: 662e 6d32 332c 0a20 2020 2020 2020 2020  f.m23,.         
+0000f3d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000f3e0: 6d33 312c 2073 656c 662e 6d33 322c 2073  m31, self.m32, s
+0000f3f0: 656c 662e 6d33 335d 0a20 2020 2020 2020  elf.m33].       
+0000f400: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000f410: 2020 2072 6574 7572 6e20 5b73 656c 662e     return [self.
+0000f420: 6d31 312c 2073 656c 662e 6d32 312c 2073  m11, self.m21, s
+0000f430: 656c 662e 6d33 312c 0a20 2020 2020 2020  elf.m31,.       
+0000f440: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000f450: 662e 6d31 322c 2073 656c 662e 6d32 322c  f.m12, self.m22,
+0000f460: 2073 656c 662e 6d33 322c 0a20 2020 2020   self.m32,.     
+0000f470: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000f480: 656c 662e 6d31 332c 2073 656c 662e 6d32  elf.m13, self.m2
+0000f490: 332c 2073 656c 662e 6d33 335d 0a0a 0a20  3, self.m33]... 
+0000f4a0: 2020 2064 6566 2069 6465 6e74 6974 7928     def identity(
+0000f4b0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0000f4c0: 2222 5265 7475 726e 2069 6465 6e74 6974  ""Return identit
+0000f4d0: 7920 6d61 7472 6978 2e0a 2020 2020 2020  y matrix..      
+0000f4e0: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
+0000f4f0: 6566 206d 6174 3320 7265 730a 2020 2020  ef mat3 res.    
+0000f500: 2020 2020 7265 7320 3d20 6d61 7433 2829      res = mat3()
+0000f510: 0a20 2020 2020 2020 2072 6573 2e6d 3131  .        res.m11
+0000f520: 203d 2031 2e30 0a20 2020 2020 2020 2072   = 1.0.        r
+0000f530: 6573 2e6d 3132 203d 2030 2e30 0a20 2020  es.m12 = 0.0.   
+0000f540: 2020 2020 2072 6573 2e6d 3133 203d 2030       res.m13 = 0
+0000f550: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
+0000f560: 3231 203d 2030 2e30 0a20 2020 2020 2020  21 = 0.0.       
+0000f570: 2072 6573 2e6d 3232 203d 2031 2e30 0a20   res.m22 = 1.0. 
+0000f580: 2020 2020 2020 2072 6573 2e6d 3233 203d         res.m23 =
+0000f590: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0000f5a0: 2e6d 3331 203d 2030 2e30 0a20 2020 2020  .m31 = 0.0.     
+0000f5b0: 2020 2072 6573 2e6d 3332 203d 2030 2e30     res.m32 = 0.0
+0000f5c0: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
+0000f5d0: 203d 2031 2e30 0a20 2020 2020 2020 2072   = 1.0.        r
+0000f5e0: 6574 7572 6e20 7265 730a 0a20 2020 2064  eturn res..    d
+0000f5f0: 6566 2074 7261 6e73 706f 7365 2873 656c  ef transpose(sel
+0000f600: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+0000f610: 6574 7572 6e20 7472 616e 7370 6f73 6520  eturn transpose 
+0000f620: 6d61 7472 6978 2e0a 2020 2020 2020 2020  matrix..        
+0000f630: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+0000f640: 206d 6174 3320 7265 730a 2020 2020 2020   mat3 res.      
+0000f650: 2020 7265 7320 3d20 6d61 7433 2829 0a20    res = mat3(). 
+0000f660: 2020 2020 2020 2072 6573 2e6d 3131 203d         res.m11 =
+0000f670: 2073 656c 662e 6d31 310a 2020 2020 2020   self.m11.      
+0000f680: 2020 7265 732e 6d31 3220 3d20 7365 6c66    res.m12 = self
+0000f690: 2e6d 3231 0a20 2020 2020 2020 2072 6573  .m21.        res
+0000f6a0: 2e6d 3133 203d 2073 656c 662e 6d33 310a  .m13 = self.m31.
+0000f6b0: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
+0000f6c0: 3d20 7365 6c66 2e6d 3132 0a20 2020 2020  = self.m12.     
+0000f6d0: 2020 2072 6573 2e6d 3232 203d 2073 656c     res.m22 = sel
+0000f6e0: 662e 6d32 320a 2020 2020 2020 2020 7265  f.m22.        re
+0000f6f0: 732e 6d32 3320 3d20 7365 6c66 2e6d 3332  s.m23 = self.m32
+0000f700: 0a20 2020 2020 2020 2072 6573 2e6d 3331  .        res.m31
+0000f710: 203d 2073 656c 662e 6d31 330a 2020 2020   = self.m13.    
+0000f720: 2020 2020 7265 732e 6d33 3220 3d20 7365      res.m32 = se
+0000f730: 6c66 2e6d 3233 0a20 2020 2020 2020 2072  lf.m23.        r
+0000f740: 6573 2e6d 3333 203d 2073 656c 662e 6d33  es.m33 = self.m3
+0000f750: 330a 2020 2020 2020 2020 7265 7475 726e  3.        return
+0000f760: 2072 6573 0a0a 2020 2020 6465 6620 6465   res..    def de
+0000f770: 7465 726d 696e 616e 7428 7365 6c66 293a  terminant(self):
+0000f780: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+0000f790: 726e 2064 6574 6572 6d69 6e61 6e74 2e0a  rn determinant..
+0000f7a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000f7b0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000f7c0: 6d31 312a 7365 6c66 2e6d 3232 2a73 656c  m11*self.m22*sel
+0000f7d0: 662e 6d33 332b 205c 0a20 2020 2020 2020  f.m33+ \.       
+0000f7e0: 2020 2020 2020 2020 7365 6c66 2e6d 3132          self.m12
+0000f7f0: 2a73 656c 662e 6d32 332a 7365 6c66 2e6d  *self.m23*self.m
+0000f800: 3331 2b20 5c0a 2020 2020 2020 2020 2020  31+ \.          
+0000f810: 2020 2020 2073 656c 662e 6d31 332a 7365       self.m13*se
+0000f820: 6c66 2e6d 3231 2a73 656c 662e 6d33 322d  lf.m21*self.m32-
+0000f830: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
+0000f840: 2020 7365 6c66 2e6d 3331 2a73 656c 662e    self.m31*self.
+0000f850: 6d32 322a 7365 6c66 2e6d 3133 2d20 5c0a  m22*self.m13- \.
+0000f860: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000f870: 656c 662e 6d33 322a 7365 6c66 2e6d 3233  elf.m32*self.m23
+0000f880: 2a73 656c 662e 6d31 312d 205c 0a20 2020  *self.m11- \.   
+0000f890: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000f8a0: 2e6d 3333 2a73 656c 662e 6d32 312a 7365  .m33*self.m21*se
+0000f8b0: 6c66 2e6d 3132 0a0a 2020 2020 6465 6620  lf.m12..    def 
+0000f8c0: 696e 7665 7273 6528 7365 6c66 293a 0a20  inverse(self):. 
+0000f8d0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+0000f8e0: 2069 6e76 6572 7365 206d 6174 7269 782e   inverse matrix.
+0000f8f0: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+0000f900: 206d 6174 3320 7265 730a 2020 2020 2020   mat3 res.      
+0000f910: 2020 6364 6566 2064 6f75 626c 6520 640a    cdef double d.
+0000f920: 0a20 2020 2020 2020 2064 203d 2073 656c  .        d = sel
+0000f930: 662e 6465 7465 726d 696e 616e 7428 290a  f.determinant().
+0000f940: 2020 2020 2020 2020 6966 2066 6162 7328          if fabs(
+0000f950: 6429 3c3d 6570 733a 0a20 2020 2020 2020  d)<=eps:.       
+0000f960: 2020 2020 2072 6169 7365 205a 6572 6f44       raise ZeroD
+0000f970: 6976 6973 696f 6e45 7272 6f72 2c20 226d  ivisionError, "m
+0000f980: 6174 7269 7820 6973 206e 6f74 2069 6e76  atrix is not inv
+0000f990: 6572 7469 626c 6522 0a0a 2020 2020 2020  ertible"..      
+0000f9a0: 2020 6420 3d20 312e 302f 640a 0a20 2020    d = 1.0/d..   
+0000f9b0: 2020 2020 2072 6573 3d6d 6174 3328 290a       res=mat3().
+0000f9c0: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
+0000f9d0: 3d20 642a 2873 656c 662e 6d32 322a 7365  = d*(self.m22*se
+0000f9e0: 6c66 2e6d 3333 2d73 656c 662e 6d32 332a  lf.m33-self.m23*
+0000f9f0: 7365 6c66 2e6d 3332 290a 2020 2020 2020  self.m32).      
+0000fa00: 2020 7265 732e 6d31 3220 3d20 642a 2873    res.m12 = d*(s
+0000fa10: 656c 662e 6d33 322a 7365 6c66 2e6d 3133  elf.m32*self.m13
+0000fa20: 2d73 656c 662e 6d31 322a 7365 6c66 2e6d  -self.m12*self.m
+0000fa30: 3333 290a 2020 2020 2020 2020 7265 732e  33).        res.
+0000fa40: 6d31 3320 3d20 642a 2873 656c 662e 6d31  m13 = d*(self.m1
+0000fa50: 322a 7365 6c66 2e6d 3233 2d73 656c 662e  2*self.m23-self.
+0000fa60: 6d32 322a 7365 6c66 2e6d 3133 290a 2020  m22*self.m13).  
+0000fa70: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
+0000fa80: 642a 2873 656c 662e 6d32 332a 7365 6c66  d*(self.m23*self
+0000fa90: 2e6d 3331 2d73 656c 662e 6d32 312a 7365  .m31-self.m21*se
+0000faa0: 6c66 2e6d 3333 290a 2020 2020 2020 2020  lf.m33).        
+0000fab0: 7265 732e 6d32 3220 3d20 642a 2873 656c  res.m22 = d*(sel
+0000fac0: 662e 6d31 312a 7365 6c66 2e6d 3333 2d73  f.m11*self.m33-s
+0000fad0: 656c 662e 6d33 312a 7365 6c66 2e6d 3133  elf.m31*self.m13
+0000fae0: 290a 2020 2020 2020 2020 7265 732e 6d32  ).        res.m2
+0000faf0: 3320 3d20 642a 2873 656c 662e 6d32 312a  3 = d*(self.m21*
+0000fb00: 7365 6c66 2e6d 3133 2d73 656c 662e 6d31  self.m13-self.m1
+0000fb10: 312a 7365 6c66 2e6d 3233 290a 2020 2020  1*self.m23).    
+0000fb20: 2020 2020 7265 732e 6d33 3120 3d20 642a      res.m31 = d*
+0000fb30: 2873 656c 662e 6d32 312a 7365 6c66 2e6d  (self.m21*self.m
+0000fb40: 3332 2d73 656c 662e 6d33 312a 7365 6c66  32-self.m31*self
+0000fb50: 2e6d 3232 290a 2020 2020 2020 2020 7265  .m22).        re
+0000fb60: 732e 6d33 3220 3d20 642a 2873 656c 662e  s.m32 = d*(self.
+0000fb70: 6d33 312a 7365 6c66 2e6d 3132 2d73 656c  m31*self.m12-sel
+0000fb80: 662e 6d31 312a 7365 6c66 2e6d 3332 290a  f.m11*self.m32).
+0000fb90: 2020 2020 2020 2020 7265 732e 6d33 3320          res.m33 
+0000fba0: 3d20 642a 2873 656c 662e 6d31 312a 7365  = d*(self.m11*se
+0000fbb0: 6c66 2e6d 3232 2d73 656c 662e 6d31 322a  lf.m22-self.m12*
+0000fbc0: 7365 6c66 2e6d 3231 290a 2020 2020 2020  self.m21).      
+0000fbd0: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
+0000fbe0: 2020 6465 6620 7363 616c 696e 6728 7365    def scaling(se
+0000fbf0: 6c66 2c20 7329 3a0a 2020 2020 2020 2020  lf, s):.        
+0000fc00: 2222 2252 6574 7572 6e20 7363 616c 696e  """Return scalin
+0000fc10: 6720 6d61 7472 6978 2e22 2222 0a20 2020  g matrix.""".   
+0000fc20: 2020 2020 2063 6465 6620 6d61 7433 2072       cdef mat3 r
+0000fc30: 6573 0a20 2020 2020 2020 2072 6573 203d  es.        res =
+0000fc40: 206d 6174 3328 290a 2020 2020 2020 2020   mat3().        
+0000fc50: 7265 732e 6d31 3120 3d20 735b 305d 0a20  res.m11 = s[0]. 
+0000fc60: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
+0000fc70: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0000fc80: 2e6d 3133 203d 2030 2e30 0a20 2020 2020  .m13 = 0.0.     
+0000fc90: 2020 2072 6573 2e6d 3231 203d 2030 2e30     res.m21 = 0.0
+0000fca0: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
+0000fcb0: 203d 2073 5b31 5d0a 2020 2020 2020 2020   = s[1].        
+0000fcc0: 7265 732e 6d32 3320 3d20 302e 300a 2020  res.m23 = 0.0.  
+0000fcd0: 2020 2020 2020 7265 732e 6d33 3120 3d20        res.m31 = 
+0000fce0: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
+0000fcf0: 6d33 3220 3d20 302e 300a 2020 2020 2020  m32 = 0.0.      
+0000fd00: 2020 7265 732e 6d33 3320 3d20 735b 325d    res.m33 = s[2]
+0000fd10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000fd20: 7265 730a 0a20 2020 2064 6566 2072 6f74  res..    def rot
+0000fd30: 6174 696f 6e28 7365 6c66 2c20 616e 676c  ation(self, angl
+0000fd40: 652c 2061 7869 7329 3a0a 2020 2020 2020  e, axis):.      
+0000fd50: 2020 2222 2252 6574 7572 6e20 726f 7461    """Return rota
+0000fd60: 7469 6f6e 206d 6174 7269 782e 0a0a 2020  tion matrix...  
+0000fd70: 2020 2020 2020 616e 676c 6520 6d75 7374        angle must
+0000fd80: 2062 6520 6769 7665 6e20 696e 2072 6164   be given in rad
+0000fd90: 6961 6e73 2e20 6178 6973 206d 7573 7420  ians. axis must 
+0000fda0: 6265 2061 2033 2d73 6571 7565 6e63 652e  be a 3-sequence.
+0000fdb0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000fdc0: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
+0000fdd0: 2063 616e 676c 652c 2061 782c 2061 792c   cangle, ax, ay,
+0000fde0: 2061 7a0a 2020 2020 2020 2020 6364 6566   az.        cdef
+0000fdf0: 2064 6f75 626c 6520 7371 725f 612c 2073   double sqr_a, s
+0000fe00: 7172 5f62 2c20 7371 725f 632c 206c 656e  qr_b, sqr_c, len
+0000fe10: 320a 2020 2020 2020 2020 6364 6566 2064  2.        cdef d
+0000fe20: 6f75 626c 6520 6b31 2c20 6b32 2c20 6b33  ouble k1, k2, k3
+0000fe30: 2c20 6b31 6162 2c20 6b31 6163 2c20 6b31  , k1ab, k1ac, k1
+0000fe40: 6263 2c20 6b33 612c 206b 3362 2c20 6b33  bc, k3a, k3b, k3
+0000fe50: 630a 2020 2020 2020 2020 6364 6566 206d  c.        cdef m
+0000fe60: 6174 3320 7265 730a 0a20 2020 2020 2020  at3 res..       
+0000fe70: 2063 616e 676c 6520 2020 3d20 616e 676c   cangle   = angl
+0000fe80: 650a 2020 2020 2020 2020 6178 2020 2020  e.        ax    
+0000fe90: 3d20 6178 6973 5b30 5d0a 2020 2020 2020  = axis[0].      
+0000fea0: 2020 6179 2020 2020 3d20 6178 6973 5b31    ay    = axis[1
+0000feb0: 5d0a 2020 2020 2020 2020 617a 2020 2020  ].        az    
+0000fec0: 3d20 6178 6973 5b32 5d0a 2020 2020 2020  = axis[2].      
+0000fed0: 2020 7371 725f 6120 3d20 6178 2a61 780a    sqr_a = ax*ax.
+0000fee0: 2020 2020 2020 2020 7371 725f 6220 3d20          sqr_b = 
+0000fef0: 6179 2a61 790a 2020 2020 2020 2020 7371  ay*ay.        sq
+0000ff00: 725f 6320 3d20 617a 2a61 7a0a 2020 2020  r_c = az*az.    
+0000ff10: 2020 2020 6c65 6e32 2020 3d20 7371 725f      len2  = sqr_
+0000ff20: 612b 7371 725f 622b 7371 725f 630a 0a20  a+sqr_b+sqr_c.. 
+0000ff30: 2020 2020 2020 206b 3220 2020 203d 2063         k2    = c
+0000ff40: 6f73 2863 616e 676c 6529 0a20 2020 2020  os(cangle).     
+0000ff50: 2020 206b 3120 2020 203d 2028 312e 302d     k1    = (1.0-
+0000ff60: 6b32 292f 6c65 6e32 0a20 2020 2020 2020  k2)/len2.       
+0000ff70: 206b 3320 2020 203d 2073 696e 2863 616e   k3    = sin(can
+0000ff80: 676c 6529 2f73 7172 7428 6c65 6e32 290a  gle)/sqrt(len2).
+0000ff90: 2020 2020 2020 2020 6b31 6162 2020 3d20          k1ab  = 
+0000ffa0: 6b31 2a61 782a 6179 0a20 2020 2020 2020  k1*ax*ay.       
+0000ffb0: 206b 3161 6320 203d 206b 312a 6178 2a61   k1ac  = k1*ax*a
+0000ffc0: 7a0a 2020 2020 2020 2020 6b31 6263 2020  z.        k1bc  
+0000ffd0: 3d20 6b31 2a61 792a 617a 0a20 2020 2020  = k1*ay*az.     
+0000ffe0: 2020 206b 3361 2020 203d 206b 332a 6178     k3a   = k3*ax
+0000fff0: 0a20 2020 2020 2020 206b 3362 2020 203d  .        k3b   =
+00010000: 206b 332a 6179 0a20 2020 2020 2020 206b   k3*ay.        k
+00010010: 3363 2020 203d 206b 332a 617a 0a0a 2020  3c   = k3*az..  
+00010020: 2020 2020 2020 7265 7320 3d20 6d61 7433        res = mat3
+00010030: 2829 0a20 2020 2020 2020 2072 6573 2e6d  ().        res.m
+00010040: 3131 203d 206b 312a 7371 725f 612b 6b32  11 = k1*sqr_a+k2
+00010050: 0a20 2020 2020 2020 2072 6573 2e6d 3132  .        res.m12
+00010060: 203d 206b 3161 622d 6b33 630a 2020 2020   = k1ab-k3c.    
+00010070: 2020 2020 7265 732e 6d31 3320 3d20 6b31      res.m13 = k1
+00010080: 6163 2b6b 3362 0a20 2020 2020 2020 2072  ac+k3b.        r
+00010090: 6573 2e6d 3231 203d 206b 3161 622b 6b33  es.m21 = k1ab+k3
+000100a0: 630a 2020 2020 2020 2020 7265 732e 6d32  c.        res.m2
+000100b0: 3220 3d20 6b31 2a73 7172 5f62 2b6b 320a  2 = k1*sqr_b+k2.
+000100c0: 2020 2020 2020 2020 7265 732e 6d32 3320          res.m23 
+000100d0: 3d20 6b31 6263 2d6b 3361 0a20 2020 2020  = k1bc-k3a.     
+000100e0: 2020 2072 6573 2e6d 3331 203d 206b 3161     res.m31 = k1a
+000100f0: 632d 6b33 620a 2020 2020 2020 2020 7265  c-k3b.        re
+00010100: 732e 6d33 3220 3d20 6b31 6263 2b6b 3361  s.m32 = k1bc+k3a
+00010110: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
+00010120: 203d 206b 312a 7371 725f 632b 6b32 0a20   = k1*sqr_c+k2. 
+00010130: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00010140: 730a 0a0a 2020 2020 6465 6620 7363 616c  s...    def scal
+00010150: 6528 7365 6c66 2c20 7329 3a0a 2020 2020  e(self, s):.    
+00010160: 2020 2020 2222 2243 6f6e 6361 7465 6e61      """Concatena
+00010170: 7465 2061 2073 6361 6c69 6e67 2e22 2222  te a scaling."""
+00010180: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
+00010190: 7562 6c65 2073 782c 2073 792c 2073 7a0a  uble sx, sy, sz.
+000101a0: 2020 2020 2020 2020 7378 203d 2073 5b30          sx = s[0
+000101b0: 5d0a 2020 2020 2020 2020 7379 203d 2073  ].        sy = s
+000101c0: 5b31 5d0a 2020 2020 2020 2020 737a 203d  [1].        sz =
+000101d0: 2073 5b32 5d0a 2020 2020 2020 2020 7365   s[2].        se
+000101e0: 6c66 2e6d 3131 203d 2073 656c 662e 6d31  lf.m11 = self.m1
+000101f0: 312a 7378 0a20 2020 2020 2020 2073 656c  1*sx.        sel
+00010200: 662e 6d31 3220 3d20 7365 6c66 2e6d 3132  f.m12 = self.m12
+00010210: 2a73 790a 2020 2020 2020 2020 7365 6c66  *sy.        self
+00010220: 2e6d 3133 203d 2073 656c 662e 6d31 332a  .m13 = self.m13*
+00010230: 737a 0a20 2020 2020 2020 2073 656c 662e  sz.        self.
+00010240: 6d32 3120 3d20 7365 6c66 2e6d 3231 2a73  m21 = self.m21*s
+00010250: 780a 2020 2020 2020 2020 7365 6c66 2e6d  x.        self.m
+00010260: 3232 203d 2073 656c 662e 6d32 322a 7379  22 = self.m22*sy
+00010270: 0a20 2020 2020 2020 2073 656c 662e 6d32  .        self.m2
+00010280: 3320 3d20 7365 6c66 2e6d 3233 2a73 7a0a  3 = self.m23*sz.
+00010290: 2020 2020 2020 2020 7365 6c66 2e6d 3331          self.m31
+000102a0: 203d 2073 656c 662e 6d33 312a 7378 0a20   = self.m31*sx. 
+000102b0: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
+000102c0: 3d20 7365 6c66 2e6d 3332 2a73 790a 2020  = self.m32*sy.  
+000102d0: 2020 2020 2020 7365 6c66 2e6d 3333 203d        self.m33 =
+000102e0: 2073 656c 662e 6d33 332a 737a 0a20 2020   self.m33*sz.   
+000102f0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00010300: 0a0a 2020 2020 6465 6620 726f 7461 7465  ..    def rotate
+00010310: 2873 656c 662c 2061 6e67 6c65 2c20 6178  (self, angle, ax
+00010320: 6973 293a 0a20 2020 2020 2020 2022 2222  is):.        """
+00010330: 436f 6e63 6174 656e 6174 6520 6120 726f  Concatenate a ro
+00010340: 7461 7469 6f6e 2e0a 0a20 2020 2020 2020  tation...       
+00010350: 2061 6e67 6c65 206d 7573 7420 6265 2067   angle must be g
+00010360: 6976 656e 2069 6e20 7261 6469 616e 732e  iven in radians.
+00010370: 2061 7869 7320 6d75 7374 2062 6520 6120   axis must be a 
+00010380: 332d 7365 7175 656e 6365 2e0a 2020 2020  3-sequence..    
+00010390: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000103a0: 6364 6566 206d 6174 3320 520a 2020 2020  cdef mat3 R.    
+000103b0: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
+000103c0: 6331 2c20 6332 2c20 6333 0a20 2020 2020  c1, c2, c3.     
+000103d0: 2020 2052 3d73 656c 662e 726f 7461 7469     R=self.rotati
+000103e0: 6f6e 2861 6e67 6c65 2c20 6178 6973 290a  on(angle, axis).
+000103f0: 0a20 2020 2020 2020 2023 2073 656c 662a  .        # self*
+00010400: 5220 2028 696e 2d70 6c61 6365 290a 2020  R  (in-place).  
+00010410: 2020 2020 2020 6331 203d 2073 656c 662e        c1 = self.
+00010420: 6d31 310a 2020 2020 2020 2020 6332 203d  m11.        c2 =
+00010430: 2073 656c 662e 6d31 320a 2020 2020 2020   self.m12.      
+00010440: 2020 6333 203d 2073 656c 662e 6d31 330a    c3 = self.m13.
+00010450: 2020 2020 2020 2020 7365 6c66 2e6d 3131          self.m11
+00010460: 203d 2063 312a 522e 6d31 312b 6332 2a52   = c1*R.m11+c2*R
+00010470: 2e6d 3231 2b63 332a 522e 6d33 310a 2020  .m21+c3*R.m31.  
+00010480: 2020 2020 2020 7365 6c66 2e6d 3132 203d        self.m12 =
+00010490: 2063 312a 522e 6d31 322b 6332 2a52 2e6d   c1*R.m12+c2*R.m
+000104a0: 3232 2b63 332a 522e 6d33 320a 2020 2020  22+c3*R.m32.    
+000104b0: 2020 2020 7365 6c66 2e6d 3133 203d 2063      self.m13 = c
+000104c0: 312a 522e 6d31 332b 6332 2a52 2e6d 3233  1*R.m13+c2*R.m23
+000104d0: 2b63 332a 522e 6d33 330a 0a20 2020 2020  +c3*R.m33..     
+000104e0: 2020 2063 3120 3d20 7365 6c66 2e6d 3231     c1 = self.m21
+000104f0: 0a20 2020 2020 2020 2063 3220 3d20 7365  .        c2 = se
+00010500: 6c66 2e6d 3232 0a20 2020 2020 2020 2063  lf.m22.        c
+00010510: 3320 3d20 7365 6c66 2e6d 3233 0a20 2020  3 = self.m23.   
+00010520: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
+00010530: 6331 2a52 2e6d 3131 2b63 322a 522e 6d32  c1*R.m11+c2*R.m2
+00010540: 312b 6333 2a52 2e6d 3331 0a20 2020 2020  1+c3*R.m31.     
+00010550: 2020 2073 656c 662e 6d32 3220 3d20 6331     self.m22 = c1
+00010560: 2a52 2e6d 3132 2b63 322a 522e 6d32 322b  *R.m12+c2*R.m22+
+00010570: 6333 2a52 2e6d 3332 0a20 2020 2020 2020  c3*R.m32.       
+00010580: 2073 656c 662e 6d32 3320 3d20 6331 2a52   self.m23 = c1*R
+00010590: 2e6d 3133 2b63 322a 522e 6d32 332b 6333  .m13+c2*R.m23+c3
+000105a0: 2a52 2e6d 3333 0a0a 2020 2020 2020 2020  *R.m33..        
+000105b0: 6331 203d 2073 656c 662e 6d33 310a 2020  c1 = self.m31.  
+000105c0: 2020 2020 2020 6332 203d 2073 656c 662e        c2 = self.
+000105d0: 6d33 320a 2020 2020 2020 2020 6333 203d  m32.        c3 =
+000105e0: 2073 656c 662e 6d33 330a 2020 2020 2020   self.m33.      
+000105f0: 2020 7365 6c66 2e6d 3331 203d 2063 312a    self.m31 = c1*
+00010600: 522e 6d31 312b 6332 2a52 2e6d 3231 2b63  R.m11+c2*R.m21+c
+00010610: 332a 522e 6d33 310a 2020 2020 2020 2020  3*R.m31.        
+00010620: 7365 6c66 2e6d 3332 203d 2063 312a 522e  self.m32 = c1*R.
+00010630: 6d31 322b 6332 2a52 2e6d 3232 2b63 332a  m12+c2*R.m22+c3*
+00010640: 522e 6d33 320a 2020 2020 2020 2020 7365  R.m32.        se
+00010650: 6c66 2e6d 3333 203d 2063 312a 522e 6d31  lf.m33 = c1*R.m1
+00010660: 332b 6332 2a52 2e6d 3233 2b63 332a 522e  3+c2*R.m23+c3*R.
+00010670: 6d33 330a 0a20 2020 2020 2020 2072 6574  m33..        ret
+00010680: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
+00010690: 6620 6f72 7468 6f28 7365 6c66 293a 0a20  f ortho(self):. 
+000106a0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+000106b0: 2061 206d 6174 7269 7820 7769 7468 206f   a matrix with o
+000106c0: 7274 686f 676f 6e61 6c20 6261 7365 2076  rthogonal base v
+000106d0: 6563 746f 7273 2e0a 0a20 2020 2020 2020  ectors...       
+000106e0: 204d 616b 6573 2074 6865 2078 2d2c 2079   Makes the x-, y
+000106f0: 2d20 616e 6420 7a2d 6178 6973 206f 7274  - and z-axis ort
+00010700: 686f 676f 6e61 6c2e 0a20 2020 2020 2020  hogonal..       
+00010710: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00010720: 6620 6d61 7433 2072 6573 0a20 2020 2020  f mat3 res.     
+00010730: 2020 2063 6465 6620 7665 6333 2078 2c79     cdef vec3 x,y
+00010740: 2c7a 0a0a 2020 2020 2020 2020 7820 3d20  ,z..        x = 
+00010750: 7665 6333 2873 656c 662e 6d31 312c 2073  vec3(self.m11, s
+00010760: 656c 662e 6d32 312c 2073 656c 662e 6d33  elf.m21, self.m3
+00010770: 3129 0a20 2020 2020 2020 2079 203d 2076  1).        y = v
+00010780: 6563 3328 7365 6c66 2e6d 3132 2c20 7365  ec3(self.m12, se
+00010790: 6c66 2e6d 3232 2c20 7365 6c66 2e6d 3332  lf.m22, self.m32
+000107a0: 290a 2020 2020 2020 2020 7a20 3d20 7665  ).        z = ve
+000107b0: 6333 2873 656c 662e 6d31 332c 2073 656c  c3(self.m13, sel
+000107c0: 662e 6d32 332c 2073 656c 662e 6d33 3329  f.m23, self.m33)
+000107d0: 0a0a 2020 2020 2020 2020 786c 203d 2078  ..        xl = x
+000107e0: 2e6c 656e 6774 6828 290a 2020 2020 2020  .length().      
+000107f0: 2020 786c 203d 2078 6c2a 786c 0a20 2020    xl = xl*xl.   
+00010800: 2020 2020 2079 203d 2079 202d 2028 2878       y = y - ((x
+00010810: 2a79 292f 786c 292a 780a 2020 2020 2020  *y)/xl)*x.      
+00010820: 2020 7a20 3d20 7a20 2d20 2828 782a 7a29    z = z - ((x*z)
+00010830: 2f78 6c29 2a78 0a0a 2020 2020 2020 2020  /xl)*x..        
+00010840: 796c 203d 2079 2e6c 656e 6774 6828 290a  yl = y.length().
+00010850: 2020 2020 2020 2020 796c 203d 2079 6c2a          yl = yl*
+00010860: 796c 0a20 2020 2020 2020 207a 203d 207a  yl.        z = z
+00010870: 202d 2028 2879 2a7a 292f 796c 292a 790a   - ((y*z)/yl)*y.
+00010880: 0a20 2020 2020 2020 2072 6573 203d 206d  .        res = m
+00010890: 6174 3328 290a 2020 2020 2020 2020 7265  at3().        re
+000108a0: 732e 6d31 3120 3d20 782e 780a 2020 2020  s.m11 = x.x.    
+000108b0: 2020 2020 7265 732e 6d31 3220 3d20 792e      res.m12 = y.
+000108c0: 780a 2020 2020 2020 2020 7265 732e 6d31  x.        res.m1
+000108d0: 3320 3d20 7a2e 780a 2020 2020 2020 2020  3 = z.x.        
+000108e0: 7265 732e 6d32 3120 3d20 782e 790a 2020  res.m21 = x.y.  
+000108f0: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
+00010900: 792e 790a 2020 2020 2020 2020 7265 732e  y.y.        res.
+00010910: 6d32 3320 3d20 7a2e 790a 2020 2020 2020  m23 = z.y.      
+00010920: 2020 7265 732e 6d33 3120 3d20 782e 7a0a    res.m31 = x.z.
+00010930: 2020 2020 2020 2020 7265 732e 6d33 3220          res.m32 
+00010940: 3d20 792e 7a0a 2020 2020 2020 2020 7265  = y.z.        re
+00010950: 732e 6d33 3320 3d20 7a2e 7a0a 2020 2020  s.m33 = z.z.    
+00010960: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
+00010970: 2020 2020 6465 6620 6465 636f 6d70 6f73      def decompos
+00010980: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+00010990: 2022 2222 4465 636f 6d70 6f73 6573 2074   """Decomposes t
+000109a0: 6865 206d 6174 7269 7820 696e 746f 2061  he matrix into a
+000109b0: 2072 6f74 6174 696f 6e20 616e 6420 7363   rotation and sc
+000109c0: 616c 696e 6720 7061 7274 2e0a 0a20 2020  aling part...   
+000109d0: 2020 2020 2052 6574 7572 6e73 2061 2074       Returns a t
+000109e0: 7570 6c65 2028 726f 7461 7469 6f6e 2c20  uple (rotation, 
+000109f0: 7363 616c 696e 6729 2e20 5468 6520 7363  scaling). The sc
+00010a00: 616c 696e 6720 7061 7274 2069 7320 6769  aling part is gi
+00010a10: 7665 6e0a 2020 2020 2020 2020 6173 2061  ven.        as a
+00010a20: 2076 6563 332c 2074 6865 2072 6f74 6174   vec3, the rotat
+00010a30: 696f 6e20 6973 2073 7469 6c6c 2061 206d  ion is still a m
+00010a40: 6174 332e 0a20 2020 2020 2020 2022 2222  at3..        """
+00010a50: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
+00010a60: 7433 206d 0a20 2020 2020 2020 2063 6465  t3 m.        cde
+00010a70: 6620 7665 6333 2061 2c62 2c63 0a20 2020  f vec3 a,b,c.   
+00010a80: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
+00010a90: 2061 6c2c 2062 6c2c 2063 6c0a 0a20 2020   al, bl, cl..   
+00010aa0: 2020 2020 206d 203d 2073 656c 662e 6f72       m = self.or
+00010ab0: 7468 6f28 290a 0a20 2020 2020 2020 2023  tho()..        #
+00010ac0: 2061 2c62 2c63 203d 2043 6f6c 756d 6e20   a,b,c = Column 
+00010ad0: 302c 312c 3220 6f66 206d 0a20 2020 2020  0,1,2 of m.     
+00010ae0: 2020 2061 203d 2076 6563 3328 290a 2020     a = vec3().  
+00010af0: 2020 2020 2020 6220 3d20 7665 6333 2829        b = vec3()
+00010b00: 0a20 2020 2020 2020 2063 203d 2076 6563  .        c = vec
+00010b10: 3328 290a 2020 2020 2020 2020 612e 7820  3().        a.x 
+00010b20: 3d20 6d2e 6d31 310a 2020 2020 2020 2020  = m.m11.        
+00010b30: 612e 7920 3d20 6d2e 6d32 310a 2020 2020  a.y = m.m21.    
+00010b40: 2020 2020 612e 7a20 3d20 6d2e 6d33 310a      a.z = m.m31.
+00010b50: 2020 2020 2020 2020 622e 7820 3d20 6d2e          b.x = m.
+00010b60: 6d31 320a 2020 2020 2020 2020 622e 7920  m12.        b.y 
+00010b70: 3d20 6d2e 6d32 320a 2020 2020 2020 2020  = m.m22.        
+00010b80: 622e 7a20 3d20 6d2e 6d33 320a 2020 2020  b.z = m.m32.    
+00010b90: 2020 2020 632e 7820 3d20 6d2e 6d31 330a      c.x = m.m13.
+00010ba0: 2020 2020 2020 2020 632e 7920 3d20 6d2e          c.y = m.
+00010bb0: 6d32 330a 2020 2020 2020 2020 632e 7a20  m23.        c.z 
+00010bc0: 3d20 6d2e 6d33 330a 0a20 2020 2020 2020  = m.m33..       
+00010bd0: 2023 2061 6c2c 626c 2c63 6c20 3d20 6c65   # al,bl,cl = le
+00010be0: 6e67 7468 206f 6620 612c 622c 6320 283d  ngth of a,b,c (=
+00010bf0: 2073 6361 6c69 6e67 2066 6163 746f 7273   scaling factors
+00010c00: 290a 2020 2020 2020 2020 616c 203d 2073  ).        al = s
+00010c10: 7172 7428 612e 782a 612e 7820 2b20 612e  qrt(a.x*a.x + a.
+00010c20: 792a 612e 7920 2b20 612e 7a2a 612e 7a29  y*a.y + a.z*a.z)
+00010c30: 0a20 2020 2020 2020 2062 6c20 3d20 7371  .        bl = sq
+00010c40: 7274 2862 2e78 2a62 2e78 202b 2062 2e79  rt(b.x*b.x + b.y
+00010c50: 2a62 2e79 202b 2062 2e7a 2a62 2e7a 290a  *b.y + b.z*b.z).
+00010c60: 2020 2020 2020 2020 636c 203d 2073 7172          cl = sqr
+00010c70: 7428 632e 782a 632e 7820 2b20 632e 792a  t(c.x*c.x + c.y*
+00010c80: 632e 7920 2b20 632e 7a2a 632e 7a29 0a20  c.y + c.z*c.z). 
+00010c90: 2020 2020 2020 2069 6620 616c 3c3d 6570         if al<=ep
+00010ca0: 7320 6f72 2062 6c3c 3d65 7073 206f 7220  s or bl<=eps or 
+00010cb0: 636c 3c3d 6570 733a 0a20 2020 2020 2020  cl<=eps:.       
+00010cc0: 2020 2020 2072 6169 7365 205a 6572 6f44       raise ZeroD
+00010cd0: 6976 6973 696f 6e45 7272 6f72 2c22 7472  ivisionError,"tr
+00010ce0: 616e 7366 6f72 6d61 7469 6f6e 2063 6f6e  ansformation con
+00010cf0: 7461 696e 7320 6120 3020 7363 616c 696e  tains a 0 scalin
+00010d00: 6722 0a0a 2020 2020 2020 2020 7363 616c  g"..        scal
+00010d10: 6520 3d20 7665 6333 2861 6c2c 626c 2c63  e = vec3(al,bl,c
+00010d20: 6c29 0a0a 2020 2020 2020 2020 2320 6e6f  l)..        # no
+00010d30: 726d 616c 697a 696e 6720 612c 622c 630a  rmalizing a,b,c.
+00010d40: 2320 2020 2020 2020 2061 2f3d 616c 0a23  #        a/=al.#
+00010d50: 2020 2020 2020 2020 622f 3d62 6c0a 2320          b/=bl.# 
+00010d60: 2020 2020 2020 2063 2f3d 636c 0a20 2020         c/=cl.   
+00010d70: 2020 2020 2061 2e78 203d 2061 2e78 2f61       a.x = a.x/a
+00010d80: 6c0a 2020 2020 2020 2020 612e 7920 3d20  l.        a.y = 
+00010d90: 612e 792f 616c 0a20 2020 2020 2020 2061  a.y/al.        a
+00010da0: 2e7a 203d 2061 2e7a 2f61 6c0a 2020 2020  .z = a.z/al.    
+00010db0: 2020 2020 622e 7820 3d20 622e 782f 626c      b.x = b.x/bl
+00010dc0: 0a20 2020 2020 2020 2062 2e79 203d 2062  .        b.y = b
+00010dd0: 2e79 2f62 6c0a 2020 2020 2020 2020 622e  .y/bl.        b.
+00010de0: 7a20 3d20 622e 7a2f 626c 0a20 2020 2020  z = b.z/bl.     
+00010df0: 2020 2063 2e78 203d 2063 2e78 2f63 6c0a     c.x = c.x/cl.
+00010e00: 2020 2020 2020 2020 632e 7920 3d20 632e          c.y = c.
+00010e10: 792f 636c 0a20 2020 2020 2020 2063 2e7a  y/cl.        c.z
+00010e20: 203d 2063 2e7a 2f63 6c0a 0a20 2020 2020   = c.z/cl..     
+00010e30: 2020 206d 2e6d 3131 203d 2061 2e78 0a20     m.m11 = a.x. 
+00010e40: 2020 2020 2020 206d 2e6d 3231 203d 2061         m.m21 = a
+00010e50: 2e79 0a20 2020 2020 2020 206d 2e6d 3331  .y.        m.m31
+00010e60: 203d 2061 2e7a 0a20 2020 2020 2020 206d   = a.z.        m
+00010e70: 2e6d 3132 203d 2062 2e78 0a20 2020 2020  .m12 = b.x.     
+00010e80: 2020 206d 2e6d 3232 203d 2062 2e79 0a20     m.m22 = b.y. 
+00010e90: 2020 2020 2020 206d 2e6d 3332 203d 2062         m.m32 = b
+00010ea0: 2e7a 0a20 2020 2020 2020 206d 2e6d 3133  .z.        m.m13
+00010eb0: 203d 2063 2e78 0a20 2020 2020 2020 206d   = c.x.        m
+00010ec0: 2e6d 3233 203d 2063 2e79 0a20 2020 2020  .m23 = c.y.     
+00010ed0: 2020 206d 2e6d 3333 203d 2063 2e7a 0a20     m.m33 = c.z. 
+00010ee0: 2020 2020 2020 2069 6620 6d2e 6465 7465         if m.dete
+00010ef0: 726d 696e 616e 7428 293c 302e 303a 0a20  rminant()<0.0:. 
+00010f00: 2020 2020 2020 2020 2020 206d 2e6d 3131             m.m11
+00010f10: 203d 202d 6d2e 6d31 310a 2020 2020 2020   = -m.m11.      
+00010f20: 2020 2020 2020 6d2e 6d32 3120 3d20 2d6d        m.m21 = -m
+00010f30: 2e6d 3231 0a20 2020 2020 2020 2020 2020  .m21.           
+00010f40: 206d 2e6d 3331 203d 202d 6d2e 6d33 310a   m.m31 = -m.m31.
+00010f50: 2020 2020 2020 2020 2020 2020 7363 616c              scal
+00010f60: 652e 7820 3d20 2d73 6361 6c65 2e78 0a0a  e.x = -scale.x..
+00010f70: 2020 2020 2020 2020 7265 7475 726e 2028          return (
+00010f80: 6d2c 2073 6361 6c65 290a 0a0a 2323 2323  m, scale)...####
+00010f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00010fa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00010fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00010fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00010fd0: 2323 0a0a 2320 6d61 7434 6974 6572 0a63  ##..# mat4iter.c
+00010fe0: 6465 6620 636c 6173 7320 6d61 7434 6974  def class mat4it
+00010ff0: 6572 3a0a 2020 2020 2222 226d 6174 2069  er:.    """mat i
+00011000: 7465 7261 746f 722e 2222 220a 2020 2020  terator.""".    
+00011010: 6364 6566 2069 6e74 2069 6478 0a20 2020  cdef int idx.   
+00011020: 2063 6465 6620 6f62 6a65 6374 206d 0a0a   cdef object m..
+00011030: 2020 2020 6465 6620 5f5f 6369 6e69 745f      def __cinit_
+00011040: 5f28 7365 6c66 2c20 6d29 3a0a 2020 2020  _(self, m):.    
+00011050: 2020 2020 7365 6c66 2e69 6478 203d 2030      self.idx = 0
+00011060: 0a20 2020 2020 2020 2073 656c 662e 6d20  .        self.m 
+00011070: 2020 3d20 6d0a 0a20 2020 2064 6566 205f    = m..    def _
+00011080: 5f69 7465 725f 5f28 7365 6c66 293a 0a20  _iter__(self):. 
+00011090: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000110a0: 6c66 0a0a 2020 2020 6465 6620 5f5f 6e65  lf..    def __ne
+000110b0: 7874 5f5f 2873 656c 6629 3a0a 2020 2020  xt__(self):.    
+000110c0: 2020 2020 6966 2073 656c 662e 6964 783d      if self.idx=
+000110d0: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
+000110e0: 7365 6c66 2e69 6478 3d31 0a20 2020 2020  self.idx=1.     
+000110f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00011100: 6c66 2e6d 5b30 5d0a 2020 2020 2020 2020  lf.m[0].        
+00011110: 656c 6966 2073 656c 662e 6964 783d 3d31  elif self.idx==1
+00011120: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00011130: 6c66 2e69 6478 3d32 0a20 2020 2020 2020  lf.idx=2.       
+00011140: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00011150: 2e6d 5b31 5d0a 2020 2020 2020 2020 656c  .m[1].        el
+00011160: 6966 2073 656c 662e 6964 783d 3d32 3a0a  if self.idx==2:.
+00011170: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011180: 2e69 6478 3d33 0a20 2020 2020 2020 2020  .idx=3.         
+00011190: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+000111a0: 5b32 5d0a 2020 2020 2020 2020 656c 6966  [2].        elif
+000111b0: 2073 656c 662e 6964 783d 3d33 3a0a 2020   self.idx==3:.  
+000111c0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
+000111d0: 6478 3d34 0a20 2020 2020 2020 2020 2020  dx=4.           
+000111e0: 2072 6574 7572 6e20 7365 6c66 2e6d 5b33   return self.m[3
+000111f0: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
+00011200: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00011210: 6520 5374 6f70 4974 6572 6174 696f 6e0a  e StopIteration.
+00011220: 0a23 2043 616c 6375 6c61 7465 7320 6d33  .# Calculates m3
+00011230: 2e64 6574 6572 6d69 6e61 6e74 2829 2077  .determinant() w
+00011240: 6865 7265 206d 3320 6973 2061 206d 6174  here m3 is a mat
+00011250: 3320 7468 6174 2069 7320 6261 7365 6420  3 that is based 
+00011260: 6f6e 206d 340a 2320 7768 6572 6520 726f  on m4.# where ro
+00011270: 7720 6920 616e 6420 636f 6c75 6d6e 206a  w i and column j
+00011280: 2061 7265 206c 6566 7420 6f75 742e 0a63   are left out..c
+00011290: 6465 6620 646f 7562 6c65 205f 7375 6264  def double _subd
+000112a0: 6574 2864 6f75 626c 6520 6d34 5b31 365d  et(double m4[16]
+000112b0: 2c20 7368 6f72 7420 692c 2073 686f 7274  , short i, short
+000112c0: 206a 293a 0a20 2020 2063 6465 6620 646f   j):.    cdef do
+000112d0: 7562 6c65 206d 335b 395d 0a20 2020 2063  uble m3[9].    c
+000112e0: 6465 6620 646f 7562 6c65 2a20 700a 2020  def double* p.  
+000112f0: 2020 6364 6566 2073 686f 7274 206b 2c20    cdef short k, 
+00011300: 6c0a 0a20 2020 2070 203d 206d 330a 2020  l..    p = m3.  
+00011310: 2020 6b3d 300a 2020 2020 7768 696c 6520    k=0.    while 
+00011320: 313a 0a20 2020 2020 2020 2069 6620 6b3d  1:.        if k=
+00011330: 3d69 3a0a 2020 2020 2020 2020 2020 2020  =i:.            
+00011340: 6b3d 6b2b 310a 2020 2020 2020 2020 6966  k=k+1.        if
+00011350: 206b 3d3d 343a 0a20 2020 2020 2020 2020   k==4:.         
+00011360: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+00011370: 206c 3d30 0a20 2020 2020 2020 2077 6869   l=0.        whi
+00011380: 6c65 2031 3a0a 2020 2020 2020 2020 2020  le 1:.          
+00011390: 2020 6966 206c 3d3d 6a3a 0a20 2020 2020    if l==j:.     
+000113a0: 2020 2020 2020 2020 2020 206c 3d6c 2b31             l=l+1
+000113b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000113c0: 6c3d 3d34 3a0a 2020 2020 2020 2020 2020  l==4:.          
+000113d0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
+000113e0: 2020 2020 2020 2020 705b 305d 3d6d 345b          p[0]=m4[
+000113f0: 6b2a 342b 6c5d 0a20 2020 2020 2020 2020  k*4+l].         
+00011400: 2020 2070 3d70 2b31 0a20 2020 2020 2020     p=p+1.       
+00011410: 2020 2020 206c 3d6c 2b31 0a20 2020 2020       l=l+1.     
+00011420: 2020 206b 3d6b 2b31 0a0a 2020 2020 7265     k=k+1..    re
+00011430: 7475 726e 206d 335b 305d 2a6d 335b 345d  turn m3[0]*m3[4]
+00011440: 2a6d 335b 385d 2b20 5c0a 2020 2020 2020  *m3[8]+ \.      
+00011450: 2020 2020 206d 335b 315d 2a6d 335b 355d       m3[1]*m3[5]
+00011460: 2a6d 335b 365d 2b20 5c0a 2020 2020 2020  *m3[6]+ \.      
+00011470: 2020 2020 206d 335b 325d 2a6d 335b 335d       m3[2]*m3[3]
+00011480: 2a6d 335b 375d 2d20 5c0a 2020 2020 2020  *m3[7]- \.      
+00011490: 2020 2020 206d 335b 365d 2a6d 335b 345d       m3[6]*m3[4]
+000114a0: 2a6d 335b 325d 2d20 5c0a 2020 2020 2020  *m3[2]- \.      
+000114b0: 2020 2020 206d 335b 375d 2a6d 335b 355d       m3[7]*m3[5]
+000114c0: 2a6d 335b 305d 2d20 5c0a 2020 2020 2020  *m3[0]- \.      
+000114d0: 2020 2020 206d 335b 385d 2a6d 335b 335d       m3[8]*m3[3]
+000114e0: 2a6d 335b 315d 0a0a 0a0a 2320 6d61 7434  *m3[1]....# mat4
+000114f0: 0a63 6465 6620 636c 6173 7320 6d61 7434  .cdef class mat4
+00011500: 3a0a 0a20 2020 2063 6465 6620 646f 7562  :..    cdef doub
+00011510: 6c65 206d 3131 2c20 6d31 322c 206d 3133  le m11, m12, m13
+00011520: 2c20 6d31 340a 2020 2020 6364 6566 2064  , m14.    cdef d
+00011530: 6f75 626c 6520 6d32 312c 206d 3232 2c20  ouble m21, m22, 
+00011540: 6d32 332c 206d 3234 0a20 2020 2063 6465  m23, m24.    cde
+00011550: 6620 646f 7562 6c65 206d 3331 2c20 6d33  f double m31, m3
+00011560: 322c 206d 3333 2c20 6d33 340a 2020 2020  2, m33, m34.    
+00011570: 6364 6566 2064 6f75 626c 6520 6d34 312c  cdef double m41,
+00011580: 206d 3432 2c20 6d34 332c 206d 3434 0a0a   m42, m43, m44..
+00011590: 2020 2020 6465 6620 5f5f 6369 6e69 745f      def __cinit_
+000115a0: 5f28 7365 6c66 2c20 2a61 7267 7329 3a0a  _(self, *args):.
+000115b0: 2020 2020 2020 2020 6364 6566 2069 6e74          cdef int
+000115c0: 2061 7267 6c65 6e0a 2020 2020 2020 2020   arglen.        
+000115d0: 6364 6566 206d 6174 3420 420a 2020 2020  cdef mat4 B.    
+000115e0: 2020 2020 6172 676c 656e 203d 206c 656e      arglen = len
+000115f0: 2861 7267 7329 0a0a 2020 2020 2020 2020  (args)..        
+00011600: 2320 4e6f 2061 7267 756d 656e 7473 0a20  # No arguments. 
+00011610: 2020 2020 2020 2069 6620 6172 676c 656e         if arglen
+00011620: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
+00011630: 206d 3131 3d6d 3132 3d6d 3133 3d6d 3134   m11=m12=m13=m14
+00011640: 3d30 2e30 0a20 2020 2020 2020 2020 2020  =0.0.           
+00011650: 206d 3231 3d6d 3232 3d6d 3233 3d6d 3234   m21=m22=m23=m24
+00011660: 3d30 2e30 0a20 2020 2020 2020 2020 2020  =0.0.           
+00011670: 206d 3331 3d6d 3332 3d6d 3333 3d6d 3334   m31=m32=m33=m34
+00011680: 3d30 2e30 0a20 2020 2020 2020 2020 2020  =0.0.           
+00011690: 206d 3431 3d6d 3432 3d6d 3433 3d6d 3434   m41=m42=m43=m44
+000116a0: 3d30 2e30 0a0a 2020 2020 2020 2020 2320  =0.0..        # 
+000116b0: 3120 6172 6775 6d65 6e74 2028 6c69 7374  1 argument (list
+000116c0: 2c20 7363 616c 6172 206f 7220 6d61 7434  , scalar or mat4
+000116d0: 290a 2020 2020 2020 2020 656c 6966 2061  ).        elif a
+000116e0: 7267 6c65 6e3d 3d31 3a0a 2020 2020 2020  rglen==1:.      
+000116f0: 2020 2020 2020 5420 3d20 7479 7065 2861        T = type(a
+00011700: 7267 735b 305d 290a 2020 2020 2020 2020  rgs[0]).        
+00011710: 2020 2020 2320 7363 616c 6172 0a20 2020      # scalar.   
+00011720: 2020 2020 2020 2020 2069 6620 5420 6973           if T is
+00011730: 2066 6c6f 6174 206f 7220 5420 6973 2069   float or T is i
+00011740: 6e74 206f 7220 5420 6973 206c 6f6e 673a  nt or T is long:
+00011750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011760: 2073 656c 662e 6d31 3120 3d20 6172 6773   self.m11 = args
+00011770: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+00011780: 2020 2020 7365 6c66 2e6d 3132 203d 2030      self.m12 = 0
+00011790: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
+000117a0: 2020 2073 656c 662e 6d31 3320 3d20 302e     self.m13 = 0.
+000117b0: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+000117c0: 2020 7365 6c66 2e6d 3134 203d 2030 2e30    self.m14 = 0.0
+000117d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000117e0: 2073 656c 662e 6d32 3120 3d20 302e 300a   self.m21 = 0.0.
+000117f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011800: 7365 6c66 2e6d 3232 203d 2073 656c 662e  self.m22 = self.
+00011810: 6d31 310a 2020 2020 2020 2020 2020 2020  m11.            
+00011820: 2020 2020 7365 6c66 2e6d 3233 203d 2030      self.m23 = 0
+00011830: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
+00011840: 2020 2073 656c 662e 6d32 3420 3d20 302e     self.m24 = 0.
+00011850: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+00011860: 2020 7365 6c66 2e6d 3331 203d 2030 2e30    self.m31 = 0.0
+00011870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011880: 2073 656c 662e 6d33 3220 3d20 302e 300a   self.m32 = 0.0.
+00011890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000118a0: 7365 6c66 2e6d 3333 203d 2073 656c 662e  self.m33 = self.
+000118b0: 6d31 310a 2020 2020 2020 2020 2020 2020  m11.            
+000118c0: 2020 2020 7365 6c66 2e6d 3334 203d 2030      self.m34 = 0
+000118d0: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
+000118e0: 2020 2073 656c 662e 6d34 3120 3d20 302e     self.m41 = 0.
+000118f0: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+00011900: 2020 7365 6c66 2e6d 3432 203d 2030 2e30    self.m42 = 0.0
+00011910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011920: 2073 656c 662e 6d34 3320 3d20 302e 300a   self.m43 = 0.0.
+00011930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011940: 7365 6c66 2e6d 3434 203d 2073 656c 662e  self.m44 = self.
+00011950: 6d31 310a 2020 2020 2020 2020 2020 2020  m11.            
+00011960: 2320 6d61 7434 0a20 2020 2020 2020 2020  # mat4.         
+00011970: 2020 2065 6c69 6620 5420 6973 206d 6174     elif T is mat
+00011980: 343a 0a20 2020 2020 2020 2020 2020 2020  4:.             
+00011990: 2020 2042 203d 2061 7267 735b 305d 0a20     B = args[0]. 
+000119a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000119b0: 656c 662e 6d31 3120 3d20 422e 6d31 310a  elf.m11 = B.m11.
+000119c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000119d0: 7365 6c66 2e6d 3132 203d 2042 2e6d 3132  self.m12 = B.m12
+000119e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000119f0: 2073 656c 662e 6d31 3320 3d20 422e 6d31   self.m13 = B.m1
+00011a00: 330a 2020 2020 2020 2020 2020 2020 2020  3.              
+00011a10: 2020 7365 6c66 2e6d 3134 203d 2042 2e6d    self.m14 = B.m
+00011a20: 3134 0a20 2020 2020 2020 2020 2020 2020  14.             
+00011a30: 2020 2073 656c 662e 6d32 3120 3d20 422e     self.m21 = B.
+00011a40: 6d32 310a 2020 2020 2020 2020 2020 2020  m21.            
+00011a50: 2020 2020 7365 6c66 2e6d 3232 203d 2042      self.m22 = B
+00011a60: 2e6d 3232 0a20 2020 2020 2020 2020 2020  .m22.           
+00011a70: 2020 2020 2073 656c 662e 6d32 3320 3d20       self.m23 = 
+00011a80: 422e 6d32 330a 2020 2020 2020 2020 2020  B.m23.          
+00011a90: 2020 2020 2020 7365 6c66 2e6d 3234 203d        self.m24 =
+00011aa0: 2042 2e6d 3234 0a20 2020 2020 2020 2020   B.m24.         
+00011ab0: 2020 2020 2020 2073 656c 662e 6d33 3120         self.m31 
+00011ac0: 3d20 422e 6d33 310a 2020 2020 2020 2020  = B.m31.        
+00011ad0: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
+00011ae0: 203d 2042 2e6d 3332 0a20 2020 2020 2020   = B.m32.       
+00011af0: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+00011b00: 3320 3d20 422e 6d33 330a 2020 2020 2020  3 = B.m33.      
+00011b10: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00011b20: 3334 203d 2042 2e6d 3334 0a20 2020 2020  34 = B.m34.     
+00011b30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00011b40: 6d34 3120 3d20 422e 6d34 310a 2020 2020  m41 = B.m41.    
+00011b50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011b60: 2e6d 3432 203d 2042 2e6d 3432 0a20 2020  .m42 = B.m42.   
+00011b70: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00011b80: 662e 6d34 3320 3d20 422e 6d34 330a 2020  f.m43 = B.m43.  
+00011b90: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00011ba0: 6c66 2e6d 3434 203d 2042 2e6d 3434 0a20  lf.m44 = B.m44. 
+00011bb0: 2020 2020 2020 2020 2020 2023 2053 7472             # Str
+00011bc0: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00011bd0: 656c 6966 2054 2069 7320 7374 7220 6f72  elif T is str or
+00011be0: 2054 2069 7320 756e 6963 6f64 653a 0a20   T is unicode:. 
+00011bf0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00011c00: 3d61 7267 735b 305d 2e72 6570 6c61 6365  =args[0].replace
+00011c10: 2822 2c22 2c22 2022 292e 7265 706c 6163  (","," ").replac
+00011c20: 6528 2220 2022 2c22 2022 292e 7374 7269  e("  "," ").stri
+00011c30: 7028 292e 7370 6c69 7428 2220 2229 0a20  p().split(" "). 
+00011c40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00011c50: 6620 733d 3d5b 2222 5d3a 0a20 2020 2020  f s==[""]:.     
+00011c60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00011c70: 3d5b 5d0a 2020 2020 2020 2020 2020 2020  =[].            
+00011c80: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00011c90: 6765 286c 656e 2873 2929 3a0a 2020 2020  ge(len(s)):.    
+00011ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011cb0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00011cc0: 2020 2020 2020 2020 2020 2020 2073 5b69               s[i
+00011cd0: 5d20 3d20 666c 6f61 7428 735b 695d 290a  ] = float(s[i]).
+00011ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011cf0: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
+00011d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d10: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00011d20: 7272 6f72 2c22 6d61 7434 2829 2061 7267  rror,"mat4() arg
+00011d30: 2069 7320 6120 6d61 6c66 6f72 6d65 6420   is a malformed 
+00011d40: 7374 7269 6e67 220a 2020 2020 2020 2020  string".        
+00011d50: 2020 2020 2020 2020 4220 3d20 6d61 7434          B = mat4
+00011d60: 2873 290a 2020 2020 2020 2020 2020 2020  (s).            
+00011d70: 2020 2020 7365 6c66 2e6d 3131 203d 2042      self.m11 = B
+00011d80: 2e6d 3131 0a20 2020 2020 2020 2020 2020  .m11.           
+00011d90: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
+00011da0: 422e 6d31 320a 2020 2020 2020 2020 2020  B.m12.          
+00011db0: 2020 2020 2020 7365 6c66 2e6d 3133 203d        self.m13 =
+00011dc0: 2042 2e6d 3133 0a20 2020 2020 2020 2020   B.m13.         
+00011dd0: 2020 2020 2020 2073 656c 662e 6d31 3420         self.m14 
+00011de0: 3d20 422e 6d31 340a 2020 2020 2020 2020  = B.m14.        
+00011df0: 2020 2020 2020 2020 7365 6c66 2e6d 3231          self.m21
+00011e00: 203d 2042 2e6d 3231 0a20 2020 2020 2020   = B.m21.       
+00011e10: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+00011e20: 3220 3d20 422e 6d32 320a 2020 2020 2020  2 = B.m22.      
+00011e30: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00011e40: 3233 203d 2042 2e6d 3233 0a20 2020 2020  23 = B.m23.     
+00011e50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00011e60: 6d32 3420 3d20 422e 6d32 340a 2020 2020  m24 = B.m24.    
+00011e70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011e80: 2e6d 3331 203d 2042 2e6d 3331 0a20 2020  .m31 = B.m31.   
+00011e90: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00011ea0: 662e 6d33 3220 3d20 422e 6d33 320a 2020  f.m32 = B.m32.  
+00011eb0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00011ec0: 6c66 2e6d 3333 203d 2042 2e6d 3333 0a20  lf.m33 = B.m33. 
+00011ed0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00011ee0: 656c 662e 6d33 3420 3d20 422e 6d33 340a  elf.m34 = B.m34.
+00011ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011f00: 7365 6c66 2e6d 3431 203d 2042 2e6d 3431  self.m41 = B.m41
+00011f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011f20: 2073 656c 662e 6d34 3220 3d20 422e 6d34   self.m42 = B.m4
+00011f30: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
+00011f40: 2020 7365 6c66 2e6d 3433 203d 2042 2e6d    self.m43 = B.m
+00011f50: 3433 0a20 2020 2020 2020 2020 2020 2020  43.             
+00011f60: 2020 2073 656c 662e 6d34 3420 3d20 422e     self.m44 = B.
+00011f70: 6d34 340a 2020 2020 2020 2020 2020 2020  m44.            
+00011f80: 2320 5365 7175 656e 6365 206f 6620 3136  # Sequence of 16
+00011f90: 2066 6c6f 6174 7320 6f72 2034 2034 2d73   floats or 4 4-s
+00011fa0: 6571 7565 6e63 6573 0a20 2020 2020 2020  equences.       
+00011fb0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00011fc0: 2020 2020 2020 2020 2020 2073 6571 203d             seq =
+00011fd0: 2061 7267 735b 305d 0a20 2020 2020 2020   args[0].       
+00011fe0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
+00011ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012000: 2020 7365 716c 656e 203d 206c 656e 2873    seqlen = len(s
+00012010: 6571 290a 2020 2020 2020 2020 2020 2020  eq).            
+00012020: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
+00012030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012040: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
+00012050: 226d 6174 3428 2920 6172 6720 6361 6e27  "mat4() arg can'
+00012060: 7420 6265 2063 6f6e 7665 7274 6564 2074  t be converted t
+00012070: 6f20 6d61 7434 220a 0a20 2020 2020 2020  o mat4"..       
+00012080: 2020 2020 2020 2020 2069 6620 7365 716c           if seql
+00012090: 656e 3d3d 3136 3a0a 2020 2020 2020 2020  en==16:.        
+000120a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000120b0: 2e6d 3131 203d 2073 6571 5b30 5d0a 2020  .m11 = seq[0].  
 000120c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000120d0: 2073 656c 662e 6d33 3120 3d20 7365 715b   self.m31 = seq[
-000120e0: 385d 0a20 2020 2020 2020 2020 2020 2020  8].             
-000120f0: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
-00012100: 3d20 7365 715b 395d 0a20 2020 2020 2020  = seq[9].       
-00012110: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00012120: 662e 6d33 3320 3d20 7365 715b 3130 5d0a  f.m33 = seq[10].
+000120d0: 2020 7365 6c66 2e6d 3132 203d 2073 6571    self.m12 = seq
+000120e0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+000120f0: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
+00012100: 203d 2073 6571 5b32 5d0a 2020 2020 2020   = seq[2].      
+00012110: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00012120: 6c66 2e6d 3134 203d 2073 6571 5b33 5d0a  lf.m14 = seq[3].
 00012130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012140: 2020 2020 7365 6c66 2e6d 3334 203d 2073      self.m34 = s
-00012150: 6571 5b31 315d 0a20 2020 2020 2020 2020  eq[11].         
-00012160: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012170: 6d34 3120 3d20 7365 715b 3132 5d0a 2020  m41 = seq[12].  
+00012140: 2020 2020 7365 6c66 2e6d 3231 203d 2073      self.m21 = s
+00012150: 6571 5b34 5d0a 2020 2020 2020 2020 2020  eq[4].          
+00012160: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00012170: 3232 203d 2073 6571 5b35 5d0a 2020 2020  22 = seq[5].    
 00012180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012190: 2020 7365 6c66 2e6d 3432 203d 2073 6571    self.m42 = seq
-000121a0: 5b31 335d 0a20 2020 2020 2020 2020 2020  [13].           
-000121b0: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
-000121c0: 3320 3d20 7365 715b 3134 5d0a 2020 2020  3 = seq[14].    
-000121d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000121e0: 7365 6c66 2e6d 3434 203d 2073 6571 5b31  self.m44 = seq[1
-000121f0: 355d 0a20 2020 2020 2020 2020 2020 2020  5].             
-00012200: 2020 2065 6c69 6620 7365 716c 656e 3d3d     elif seqlen==
-00012210: 343a 0a20 2020 2020 2020 2020 2020 2020  4:.             
-00012220: 2020 2020 2020 2062 203d 2073 6571 5b30         b = seq[0
-00012230: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00012240: 2020 2020 2020 7365 6c66 2e6d 3131 203d        self.m11 =
-00012250: 2062 5b30 5d0a 2020 2020 2020 2020 2020   b[0].          
-00012260: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00012270: 3231 203d 2062 5b31 5d0a 2020 2020 2020  21 = b[1].      
-00012280: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00012290: 6c66 2e6d 3331 203d 2062 5b32 5d0a 2020  lf.m31 = b[2].  
-000122a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000122b0: 2020 7365 6c66 2e6d 3431 203d 2062 5b33    self.m41 = b[3
-000122c0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000122d0: 2020 2020 2020 6220 3d20 7365 715b 315d        b = seq[1]
-000122e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000122f0: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
-00012300: 625b 305d 0a20 2020 2020 2020 2020 2020  b[0].           
-00012310: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-00012320: 3220 3d20 625b 315d 0a20 2020 2020 2020  2 = b[1].       
-00012330: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00012340: 662e 6d33 3220 3d20 625b 325d 0a20 2020  f.m32 = b[2].   
-00012350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012360: 2073 656c 662e 6d34 3220 3d20 625b 335d   self.m42 = b[3]
-00012370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012380: 2020 2020 2062 203d 2073 6571 5b32 5d0a       b = seq[2].
-00012390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000123a0: 2020 2020 7365 6c66 2e6d 3133 203d 2062      self.m13 = b
-000123b0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-000123c0: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
-000123d0: 203d 2062 5b31 5d0a 2020 2020 2020 2020   = b[1].        
-000123e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000123f0: 2e6d 3333 203d 2062 5b32 5d0a 2020 2020  .m33 = b[2].    
-00012400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012410: 7365 6c66 2e6d 3433 203d 2062 5b33 5d0a  self.m43 = b[3].
-00012420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012430: 2020 2020 6220 3d20 7365 715b 335d 0a20      b = seq[3]. 
-00012440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012450: 2020 2073 656c 662e 6d31 3420 3d20 625b     self.m14 = b[
-00012460: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
-00012470: 2020 2020 2020 2073 656c 662e 6d32 3420         self.m24 
-00012480: 3d20 625b 315d 0a20 2020 2020 2020 2020  = b[1].         
-00012490: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000124a0: 6d33 3420 3d20 625b 325d 0a20 2020 2020  m34 = b[2].     
-000124b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000124c0: 656c 662e 6d34 3420 3d20 625b 335d 0a20  elf.m44 = b[3]. 
-000124d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000124e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000124f0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00012500: 7970 6545 7272 6f72 2c20 226d 6174 3428  ypeError, "mat4(
-00012510: 2920 7461 6b65 7320 6174 206d 6f73 7420  ) takes at most 
-00012520: 3136 2061 7267 756d 656e 7473 220a 0a20  16 arguments".. 
-00012530: 2020 2020 2020 2023 2034 2061 7267 756d         # 4 argum
-00012540: 656e 7473 2028 636f 6c75 6d6e 7320 6173  ents (columns as
-00012550: 2073 6571 7565 6e63 6573 290a 2020 2020   sequences).    
-00012560: 2020 2020 656c 6966 2061 7267 6c65 6e3d      elif arglen=
-00012570: 3d34 3a0a 2020 2020 2020 2020 2020 2020  =4:.            
-00012580: 612c 622c 632c 643d 6172 6773 0a20 2020  a,b,c,d=args.   
-00012590: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-000125a0: 3120 3d20 615b 305d 0a20 2020 2020 2020  1 = a[0].       
-000125b0: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
-000125c0: 625b 305d 0a20 2020 2020 2020 2020 2020  b[0].           
-000125d0: 2073 656c 662e 6d31 3320 3d20 635b 305d   self.m13 = c[0]
-000125e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000125f0: 662e 6d31 3420 3d20 645b 305d 0a20 2020  f.m14 = d[0].   
-00012600: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-00012610: 3120 3d20 615b 315d 0a20 2020 2020 2020  1 = a[1].       
-00012620: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
-00012630: 625b 315d 0a20 2020 2020 2020 2020 2020  b[1].           
-00012640: 2073 656c 662e 6d32 3320 3d20 635b 315d   self.m23 = c[1]
-00012650: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00012660: 662e 6d32 3420 3d20 645b 315d 0a20 2020  f.m24 = d[1].   
-00012670: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
-00012680: 3120 3d20 615b 325d 0a20 2020 2020 2020  1 = a[2].       
-00012690: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
-000126a0: 625b 325d 0a20 2020 2020 2020 2020 2020  b[2].           
-000126b0: 2073 656c 662e 6d33 3320 3d20 635b 325d   self.m33 = c[2]
-000126c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000126d0: 662e 6d33 3420 3d20 645b 325d 0a20 2020  f.m34 = d[2].   
-000126e0: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
-000126f0: 3120 3d20 615b 335d 0a20 2020 2020 2020  1 = a[3].       
-00012700: 2020 2020 2073 656c 662e 6d34 3220 3d20       self.m42 = 
-00012710: 625b 335d 0a20 2020 2020 2020 2020 2020  b[3].           
-00012720: 2073 656c 662e 6d34 3320 3d20 635b 335d   self.m43 = c[3]
-00012730: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00012740: 662e 6d34 3420 3d20 645b 335d 0a0a 2020  f.m44 = d[3]..  
-00012750: 2020 2020 2020 2320 3136 2061 7267 756d        # 16 argum
-00012760: 656e 7473 0a20 2020 2020 2020 2065 6c69  ents.        eli
-00012770: 6620 6172 676c 656e 3d3d 3136 3a0a 2020  f arglen==16:.  
-00012780: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00012790: 3131 203d 2061 7267 735b 305d 0a20 2020  11 = args[0].   
-000127a0: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-000127b0: 3220 3d20 6172 6773 5b31 5d0a 2020 2020  2 = args[1].    
-000127c0: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
-000127d0: 203d 2061 7267 735b 325d 0a20 2020 2020   = args[2].     
-000127e0: 2020 2020 2020 2073 656c 662e 6d31 3420         self.m14 
-000127f0: 3d20 6172 6773 5b33 5d0a 2020 2020 2020  = args[3].      
-00012800: 2020 2020 2020 7365 6c66 2e6d 3231 203d        self.m21 =
-00012810: 2061 7267 735b 345d 0a20 2020 2020 2020   args[4].       
-00012820: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
-00012830: 6172 6773 5b35 5d0a 2020 2020 2020 2020  args[5].        
-00012840: 2020 2020 7365 6c66 2e6d 3233 203d 2061      self.m23 = a
-00012850: 7267 735b 365d 0a20 2020 2020 2020 2020  rgs[6].         
-00012860: 2020 2073 656c 662e 6d32 3420 3d20 6172     self.m24 = ar
-00012870: 6773 5b37 5d0a 2020 2020 2020 2020 2020  gs[7].          
-00012880: 2020 7365 6c66 2e6d 3331 203d 2061 7267    self.m31 = arg
-00012890: 735b 385d 0a20 2020 2020 2020 2020 2020  s[8].           
-000128a0: 2073 656c 662e 6d33 3220 3d20 6172 6773   self.m32 = args
-000128b0: 5b39 5d0a 2020 2020 2020 2020 2020 2020  [9].            
-000128c0: 7365 6c66 2e6d 3333 203d 2061 7267 735b  self.m33 = args[
-000128d0: 3130 5d0a 2020 2020 2020 2020 2020 2020  10].            
-000128e0: 7365 6c66 2e6d 3334 203d 2061 7267 735b  self.m34 = args[
-000128f0: 3131 5d0a 2020 2020 2020 2020 2020 2020  11].            
-00012900: 7365 6c66 2e6d 3431 203d 2061 7267 735b  self.m41 = args[
-00012910: 3132 5d0a 2020 2020 2020 2020 2020 2020  12].            
-00012920: 7365 6c66 2e6d 3432 203d 2061 7267 735b  self.m42 = args[
-00012930: 3133 5d0a 2020 2020 2020 2020 2020 2020  13].            
-00012940: 7365 6c66 2e6d 3433 203d 2061 7267 735b  self.m43 = args[
-00012950: 3134 5d0a 2020 2020 2020 2020 2020 2020  14].            
-00012960: 7365 6c66 2e6d 3434 203d 2061 7267 735b  self.m44 = args[
-00012970: 3135 5d0a 0a20 2020 2020 2020 2065 6c73  15]..        els
-00012980: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00012990: 6169 7365 2054 7970 6545 7272 6f72 2c22  aise TypeError,"
-000129a0: 6d61 7434 2829 2061 7267 2063 616e 2774  mat4() arg can't
-000129b0: 2062 6520 636f 6e76 6572 7465 6420 746f   be converted to
-000129c0: 206d 6174 3422 0a0a 2020 2020 6465 6620   mat4"..    def 
-000129d0: 5f5f 7265 6475 6365 5f5f 2873 656c 6629  __reduce__(self)
-000129e0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000129f0: 2028 5f6d 6174 3463 6f6e 7374 7275 6374   (_mat4construct
-00012a00: 2c20 2873 656c 665b 305d 2c20 7365 6c66  , (self[0], self
-00012a10: 5b31 5d2c 2073 656c 665b 325d 2c20 7365  [1], self[2], se
-00012a20: 6c66 5b33 5d29 290a 0a20 2020 2064 6566  lf[3]))..    def
-00012a30: 205f 5f72 6570 725f 5f28 7365 6c66 293a   __repr__(self):
-00012a40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00012a50: 276d 6174 3428 2573 2c20 2573 2c20 2573  'mat4(%s, %s, %s
-00012a60: 2c20 2573 2c20 2573 2c20 2573 2c20 2573  , %s, %s, %s, %s
-00012a70: 2c20 2573 2c20 2573 2c20 2573 2c20 2573  , %s, %s, %s, %s
-00012a80: 2c20 2573 2c20 2573 2c20 2573 2c20 2573  , %s, %s, %s, %s
-00012a90: 2c20 2573 2927 2528 0a20 2020 2020 2020  , %s)'%(.       
-00012aa0: 2020 2020 2072 6570 7228 7365 6c66 2e6d       repr(self.m
-00012ab0: 3131 292c 7265 7072 2873 656c 662e 6d31  11),repr(self.m1
-00012ac0: 3229 2c72 6570 7228 7365 6c66 2e6d 3133  2),repr(self.m13
-00012ad0: 292c 7265 7072 2873 656c 662e 6d31 3429  ),repr(self.m14)
-00012ae0: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
-00012af0: 7072 2873 656c 662e 6d32 3129 2c72 6570  pr(self.m21),rep
-00012b00: 7228 7365 6c66 2e6d 3232 292c 7265 7072  r(self.m22),repr
-00012b10: 2873 656c 662e 6d32 3329 2c72 6570 7228  (self.m23),repr(
-00012b20: 7365 6c66 2e6d 3234 292c 0a20 2020 2020  self.m24),.     
-00012b30: 2020 2020 2020 2072 6570 7228 7365 6c66         repr(self
-00012b40: 2e6d 3331 292c 7265 7072 2873 656c 662e  .m31),repr(self.
-00012b50: 6d33 3229 2c72 6570 7228 7365 6c66 2e6d  m32),repr(self.m
-00012b60: 3333 292c 7265 7072 2873 656c 662e 6d33  33),repr(self.m3
-00012b70: 3429 2c0a 2020 2020 2020 2020 2020 2020  4),.            
-00012b80: 7265 7072 2873 656c 662e 6d34 3129 2c72  repr(self.m41),r
-00012b90: 6570 7228 7365 6c66 2e6d 3432 292c 7265  epr(self.m42),re
-00012ba0: 7072 2873 656c 662e 6d34 3329 2c72 6570  pr(self.m43),rep
-00012bb0: 7228 7365 6c66 2e6d 3434 2929 0a0a 2020  r(self.m44))..  
-00012bc0: 2020 6465 6620 5f5f 7374 725f 5f28 7365    def __str__(se
-00012bd0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00012be0: 7572 6e20 225b 2539 2e34 662c 2025 392e  urn "[%9.4f, %9.
-00012bf0: 3466 2c20 2539 2e34 662c 2025 392e 3466  4f, %9.4f, %9.4f
-00012c00: 5d5c 6e5b 2539 2e34 662c 2025 392e 3466  ]\n[%9.4f, %9.4f
-00012c10: 2c20 2539 2e34 662c 2025 392e 3466 5d5c  , %9.4f, %9.4f]\
-00012c20: 6e5b 2539 2e34 662c 2025 392e 3466 2c20  n[%9.4f, %9.4f, 
-00012c30: 2539 2e34 662c 2025 392e 3466 5d5c 6e5b  %9.4f, %9.4f]\n[
-00012c40: 2539 2e34 662c 2025 392e 3466 2c20 2539  %9.4f, %9.4f, %9
-00012c50: 2e34 662c 2025 392e 3466 5d22 2528 0a20  .4f, %9.4f]"%(. 
-00012c60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012c70: 6d31 312c 2073 656c 662e 6d31 322c 2073  m11, self.m12, s
-00012c80: 656c 662e 6d31 332c 2073 656c 662e 6d31  elf.m13, self.m1
-00012c90: 342c 0a20 2020 2020 2020 2020 2020 2073  4,.            s
-00012ca0: 656c 662e 6d32 312c 2073 656c 662e 6d32  elf.m21, self.m2
-00012cb0: 322c 2073 656c 662e 6d32 332c 2073 656c  2, self.m23, sel
-00012cc0: 662e 6d32 342c 0a20 2020 2020 2020 2020  f.m24,.         
-00012cd0: 2020 2073 656c 662e 6d33 312c 2073 656c     self.m31, sel
-00012ce0: 662e 6d33 322c 2073 656c 662e 6d33 332c  f.m32, self.m33,
-00012cf0: 2073 656c 662e 6d33 342c 0a20 2020 2020   self.m34,.     
-00012d00: 2020 2020 2020 2073 656c 662e 6d34 312c         self.m41,
-00012d10: 2073 656c 662e 6d34 322c 2073 656c 662e   self.m42, self.
-00012d20: 6d34 332c 2073 656c 662e 6d34 3429 0a0a  m43, self.m44)..
-00012d30: 2020 2020 6465 6620 5f5f 6974 6572 5f5f      def __iter__
-00012d40: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00012d50: 7265 7475 726e 206d 6174 3469 7465 7228  return mat4iter(
-00012d60: 7365 6c66 290a 0a20 2020 2064 6566 205f  self)..    def _
-00012d70: 5f72 6963 6863 6d70 5f5f 2861 2c62 2c6f  _richcmp__(a,b,o
-00012d80: 7029 3a0a 2020 2020 2020 2020 6364 6566  p):.        cdef
-00012d90: 206d 6174 3420 6d61 2c20 6d62 0a20 2020   mat4 ma, mb.   
-00012da0: 2020 2020 2063 6465 6620 696e 7420 636f       cdef int co
-00012db0: 700a 0a20 2020 2020 2020 2063 6f70 203d  p..        cop =
-00012dc0: 206f 700a 0a20 2020 2020 2020 2074 6120   op..        ta 
-00012dd0: 3d20 7479 7065 2861 290a 2020 2020 2020  = type(a).      
-00012de0: 2020 7462 203d 2074 7970 6528 6229 0a20    tb = type(b). 
-00012df0: 2020 2020 2020 2069 6620 2874 6121 3d6d         if (ta!=m
-00012e00: 6174 3420 6f72 2074 6221 3d6d 6174 3429  at4 or tb!=mat4)
-00012e10: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00012e20: 2063 6f70 3d3d 333a 0a20 2020 2020 2020   cop==3:.       
-00012e30: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00012e40: 310a 2020 2020 2020 2020 2020 2020 656c  1.            el
-00012e50: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00012e60: 2020 2020 7265 7475 726e 2030 0a0a 2020      return 0..  
-00012e70: 2020 2020 2020 6d61 203d 2061 0a20 2020        ma = a.   
-00012e80: 2020 2020 206d 6220 3d20 620a 0a20 2020       mb = b..   
-00012e90: 2020 2020 2023 203c 0a20 2020 2020 2020       # <.       
-00012ea0: 2069 6620 636f 703d 3d30 3a0a 2020 2020   if cop==0:.    
-00012eb0: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
-00012ec0: 0a20 2020 2020 2020 2023 203c 3d0a 2020  .        # <=.  
-00012ed0: 2020 2020 2020 656c 6966 2063 6f70 3d3d        elif cop==
-00012ee0: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
-00012ef0: 6574 7572 6e20 300a 2020 2020 2020 2020  eturn 0.        
-00012f00: 2320 3d3d 0a20 2020 2020 2020 2065 6c69  # ==.        eli
-00012f10: 6620 636f 703d 3d32 3a0a 2020 2020 2020  f cop==2:.      
-00012f20: 2020 2020 2020 7265 7475 726e 2028 6661        return (fa
-00012f30: 6273 286d 612e 6d31 312d 6d62 2e6d 3131  bs(ma.m11-mb.m11
-00012f40: 293c 3d65 7073 2061 6e64 2066 6162 7328  )<=eps and fabs(
-00012f50: 6d61 2e6d 3132 2d6d 622e 6d31 3229 3c3d  ma.m12-mb.m12)<=
-00012f60: 6570 7320 616e 640a 2020 2020 2020 2020  eps and.        
-00012f70: 2020 2020 2020 2020 2020 2020 6661 6273              fabs
-00012f80: 286d 612e 6d31 332d 6d62 2e6d 3133 293c  (ma.m13-mb.m13)<
-00012f90: 3d65 7073 2061 6e64 2066 6162 7328 6d61  =eps and fabs(ma
-00012fa0: 2e6d 3134 2d6d 622e 6d31 3429 3c3d 6570  .m14-mb.m14)<=ep
-00012fb0: 7320 616e 640a 2020 2020 2020 2020 2020  s and.          
-00012fc0: 2020 2020 2020 2020 2020 6661 6273 286d            fabs(m
-00012fd0: 612e 6d32 312d 6d62 2e6d 3231 293c 3d65  a.m21-mb.m21)<=e
-00012fe0: 7073 2061 6e64 2066 6162 7328 6d61 2e6d  ps and fabs(ma.m
-00012ff0: 3232 2d6d 622e 6d32 3229 3c3d 6570 7320  22-mb.m22)<=eps 
-00013000: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-00013010: 2020 2020 2020 2020 6661 6273 286d 612e          fabs(ma.
-00013020: 6d32 332d 6d62 2e6d 3233 293c 3d65 7073  m23-mb.m23)<=eps
-00013030: 2061 6e64 2066 6162 7328 6d61 2e6d 3234   and fabs(ma.m24
-00013040: 2d6d 622e 6d32 3429 3c3d 6570 7320 616e  -mb.m24)<=eps an
-00013050: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00013060: 2020 2020 2020 6661 6273 286d 612e 6d33        fabs(ma.m3
-00013070: 312d 6d62 2e6d 3331 293c 3d65 7073 2061  1-mb.m31)<=eps a
-00013080: 6e64 2066 6162 7328 6d61 2e6d 3332 2d6d  nd fabs(ma.m32-m
-00013090: 622e 6d33 3229 3c3d 6570 7320 616e 640a  b.m32)<=eps and.
-000130a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000130b0: 2020 2020 6661 6273 286d 612e 6d33 332d      fabs(ma.m33-
-000130c0: 6d62 2e6d 3333 293c 3d65 7073 2061 6e64  mb.m33)<=eps and
-000130d0: 2066 6162 7328 6d61 2e6d 3334 2d6d 622e   fabs(ma.m34-mb.
-000130e0: 6d33 3429 3c3d 6570 7320 616e 640a 2020  m34)<=eps and.  
-000130f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013100: 2020 6661 6273 286d 612e 6d34 312d 6d62    fabs(ma.m41-mb
-00013110: 2e6d 3431 293c 3d65 7073 2061 6e64 2066  .m41)<=eps and f
-00013120: 6162 7328 6d61 2e6d 3432 2d6d 622e 6d34  abs(ma.m42-mb.m4
-00013130: 3229 3c3d 6570 7320 616e 640a 2020 2020  2)<=eps and.    
-00013140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013150: 6661 6273 286d 612e 6d34 332d 6d62 2e6d  fabs(ma.m43-mb.m
-00013160: 3433 293c 3d65 7073 2061 6e64 2066 6162  43)<=eps and fab
-00013170: 7328 6d61 2e6d 3434 2d6d 622e 6d34 3429  s(ma.m44-mb.m44)
-00013180: 3c3d 6570 7329 0a20 2020 2020 2020 2023  <=eps).        #
-00013190: 2021 3d0a 2020 2020 2020 2020 656c 6966   !=.        elif
-000131a0: 2063 6f70 3d3d 333a 0a20 2020 2020 2020   cop==3:.       
-000131b0: 2020 2020 2072 6574 7572 6e20 2866 6162       return (fab
-000131c0: 7328 6d61 2e6d 3131 2d6d 622e 6d31 3129  s(ma.m11-mb.m11)
-000131d0: 3e65 7073 206f 7220 6661 6273 286d 612e  >eps or fabs(ma.
-000131e0: 6d31 322d 6d62 2e6d 3132 293e 6570 7320  m12-mb.m12)>eps 
-000131f0: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-00013200: 2020 2020 2020 2066 6162 7328 6d61 2e6d         fabs(ma.m
-00013210: 3133 2d6d 622e 6d31 3329 3e65 7073 206f  13-mb.m13)>eps o
-00013220: 7220 6661 6273 286d 612e 6d31 342d 6d62  r fabs(ma.m14-mb
-00013230: 2e6d 3134 293e 6570 7320 6f72 0a20 2020  .m14)>eps or.   
-00013240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013250: 2066 6162 7328 6d61 2e6d 3231 2d6d 622e   fabs(ma.m21-mb.
-00013260: 6d32 3129 3e65 7073 206f 7220 6661 6273  m21)>eps or fabs
-00013270: 286d 612e 6d32 322d 6d62 2e6d 3232 293e  (ma.m22-mb.m22)>
-00013280: 6570 7320 6f72 0a20 2020 2020 2020 2020  eps or.         
-00013290: 2020 2020 2020 2020 2020 2066 6162 7328             fabs(
-000132a0: 6d61 2e6d 3233 2d6d 622e 6d32 3329 3e65  ma.m23-mb.m23)>e
-000132b0: 7073 206f 7220 6661 6273 286d 612e 6d32  ps or fabs(ma.m2
-000132c0: 342d 6d62 2e6d 3234 293e 6570 7320 6f72  4-mb.m24)>eps or
-000132d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000132e0: 2020 2020 2066 6162 7328 6d61 2e6d 3331       fabs(ma.m31
-000132f0: 2d6d 622e 6d33 3129 3e65 7073 206f 7220  -mb.m31)>eps or 
-00013300: 6661 6273 286d 612e 6d33 322d 6d62 2e6d  fabs(ma.m32-mb.m
-00013310: 3332 293e 6570 7320 6f72 0a20 2020 2020  32)>eps or.     
-00013320: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00013330: 6162 7328 6d61 2e6d 3333 2d6d 622e 6d33  abs(ma.m33-mb.m3
-00013340: 3329 3e65 7073 206f 7220 6661 6273 286d  3)>eps or fabs(m
-00013350: 612e 6d33 342d 6d62 2e6d 3334 293e 6570  a.m34-mb.m34)>ep
-00013360: 7320 6f72 0a20 2020 2020 2020 2020 2020  s or.           
-00013370: 2020 2020 2020 2020 2066 6162 7328 6d61           fabs(ma
-00013380: 2e6d 3431 2d6d 622e 6d34 3129 3e65 7073  .m41-mb.m41)>eps
-00013390: 206f 7220 6661 6273 286d 612e 6d34 322d   or fabs(ma.m42-
-000133a0: 6d62 2e6d 3432 293e 6570 7320 6f72 0a20  mb.m42)>eps or. 
-000133b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133c0: 2020 2066 6162 7328 6d61 2e6d 3433 2d6d     fabs(ma.m43-m
-000133d0: 622e 6d34 3329 3e65 7073 206f 7220 6661  b.m43)>eps or fa
-000133e0: 6273 286d 612e 6d34 342d 6d62 2e6d 3434  bs(ma.m44-mb.m44
-000133f0: 293e 6570 7329 0a20 2020 2020 2020 2023  )>eps).        #
-00013400: 203e 0a20 2020 2020 2020 2065 6c69 6620   >.        elif 
-00013410: 636f 703d 3d34 3a0a 2020 2020 2020 2020  cop==4:.        
-00013420: 2020 2020 7265 7475 726e 2030 0a20 2020      return 0.   
-00013430: 2020 2020 2023 203e 3d0a 2020 2020 2020       # >=.      
-00013440: 2020 656c 6966 2063 6f70 3d3d 353a 0a20    elif cop==5:. 
-00013450: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00013460: 6e20 300a 2020 2020 2020 2020 2320 736f  n 0.        # so
-00013470: 6e73 7420 2846 6568 6c65 7229 0a20 2020  nst (Fehler).   
-00013480: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00013490: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-000134a0: 7565 4572 726f 722c 2269 6e74 6572 6e61  ueError,"interna
-000134b0: 6c20 6572 726f 723a 2069 6c6c 6567 616c  l error: illegal
-000134c0: 2072 6963 6820 636f 6d70 6172 6973 6f6e   rich comparison
-000134d0: 206e 756d 6265 7222 0a0a 0a20 2020 2064   number"...    d
-000134e0: 6566 205f 5f61 6464 5f5f 286d 6174 3420  ef __add__(mat4 
-000134f0: 612c 206d 6174 3420 6229 3a0a 2020 2020  a, mat4 b):.    
-00013500: 2020 2020 2222 224d 6174 7269 7820 6164      """Matrix ad
-00013510: 6469 7469 6f6e 2e0a 0a20 2020 2020 2020  dition...       
-00013520: 203e 3e3e 204d 3d6d 6174 3428 312c 322c   >>> M=mat4(1,2,
-00013530: 332c 342c 352c 362c 372c 382c 392c 3130  3,4,5,6,7,8,9,10
-00013540: 2c31 312c 3132 2c31 332c 3134 2c31 352c  ,11,12,13,14,15,
-00013550: 3136 290a 2020 2020 2020 2020 3e3e 3e20  16).        >>> 
-00013560: 7072 696e 7420 4d2b 4d0a 2020 2020 2020  print M+M.      
-00013570: 2020 5b20 2020 322e 3030 3030 2c20 2020    [   2.0000,   
-00013580: 2034 2e30 3030 302c 2020 2020 362e 3030   4.0000,    6.00
-00013590: 3030 2c20 2020 2038 2e30 3030 305d 0a20  00,    8.0000]. 
-000135a0: 2020 2020 2020 205b 2020 3130 2e30 3030         [  10.000
-000135b0: 302c 2020 2031 322e 3030 3030 2c20 2020  0,   12.0000,   
-000135c0: 3134 2e30 3030 302c 2020 2031 362e 3030  14.0000,   16.00
-000135d0: 3030 5d0a 2020 2020 2020 2020 5b20 2031  00].        [  1
-000135e0: 382e 3030 3030 2c20 2020 3230 2e30 3030  8.0000,   20.000
-000135f0: 302c 2020 2032 322e 3030 3030 2c20 2020  0,   22.0000,   
-00013600: 3234 2e30 3030 305d 0a20 2020 2020 2020  24.0000].       
-00013610: 205b 2020 3236 2e30 3030 302c 2020 2032   [  26.0000,   2
-00013620: 382e 3030 3030 2c20 2020 3330 2e30 3030  8.0000,   30.000
-00013630: 302c 2020 2033 322e 3030 3030 5d0a 2020  0,   32.0000].  
-00013640: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00013650: 2020 6364 6566 206d 6174 3420 7265 730a    cdef mat4 res.
-00013660: 2020 2020 2020 2020 7265 7320 3d20 6d61          res = ma
-00013670: 7434 2829 0a20 2020 2020 2020 2072 6573  t4().        res
-00013680: 2e6d 3131 203d 2061 2e6d 3131 202b 2062  .m11 = a.m11 + b
-00013690: 2e6d 3131 0a20 2020 2020 2020 2072 6573  .m11.        res
-000136a0: 2e6d 3132 203d 2061 2e6d 3132 202b 2062  .m12 = a.m12 + b
-000136b0: 2e6d 3132 0a20 2020 2020 2020 2072 6573  .m12.        res
-000136c0: 2e6d 3133 203d 2061 2e6d 3133 202b 2062  .m13 = a.m13 + b
-000136d0: 2e6d 3133 0a20 2020 2020 2020 2072 6573  .m13.        res
-000136e0: 2e6d 3134 203d 2061 2e6d 3134 202b 2062  .m14 = a.m14 + b
-000136f0: 2e6d 3134 0a20 2020 2020 2020 2072 6573  .m14.        res
-00013700: 2e6d 3231 203d 2061 2e6d 3231 202b 2062  .m21 = a.m21 + b
-00013710: 2e6d 3231 0a20 2020 2020 2020 2072 6573  .m21.        res
-00013720: 2e6d 3232 203d 2061 2e6d 3232 202b 2062  .m22 = a.m22 + b
-00013730: 2e6d 3232 0a20 2020 2020 2020 2072 6573  .m22.        res
-00013740: 2e6d 3233 203d 2061 2e6d 3233 202b 2062  .m23 = a.m23 + b
-00013750: 2e6d 3233 0a20 2020 2020 2020 2072 6573  .m23.        res
-00013760: 2e6d 3234 203d 2061 2e6d 3234 202b 2062  .m24 = a.m24 + b
-00013770: 2e6d 3234 0a20 2020 2020 2020 2072 6573  .m24.        res
-00013780: 2e6d 3331 203d 2061 2e6d 3331 202b 2062  .m31 = a.m31 + b
-00013790: 2e6d 3331 0a20 2020 2020 2020 2072 6573  .m31.        res
-000137a0: 2e6d 3332 203d 2061 2e6d 3332 202b 2062  .m32 = a.m32 + b
-000137b0: 2e6d 3332 0a20 2020 2020 2020 2072 6573  .m32.        res
-000137c0: 2e6d 3333 203d 2061 2e6d 3333 202b 2062  .m33 = a.m33 + b
-000137d0: 2e6d 3333 0a20 2020 2020 2020 2072 6573  .m33.        res
-000137e0: 2e6d 3334 203d 2061 2e6d 3334 202b 2062  .m34 = a.m34 + b
-000137f0: 2e6d 3334 0a20 2020 2020 2020 2072 6573  .m34.        res
-00013800: 2e6d 3431 203d 2061 2e6d 3431 202b 2062  .m41 = a.m41 + b
-00013810: 2e6d 3431 0a20 2020 2020 2020 2072 6573  .m41.        res
-00013820: 2e6d 3432 203d 2061 2e6d 3432 202b 2062  .m42 = a.m42 + b
-00013830: 2e6d 3432 0a20 2020 2020 2020 2072 6573  .m42.        res
-00013840: 2e6d 3433 203d 2061 2e6d 3433 202b 2062  .m43 = a.m43 + b
-00013850: 2e6d 3433 0a20 2020 2020 2020 2072 6573  .m43.        res
-00013860: 2e6d 3434 203d 2061 2e6d 3434 202b 2062  .m44 = a.m44 + b
-00013870: 2e6d 3434 0a20 2020 2020 2020 2072 6574  .m44.        ret
-00013880: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
-00013890: 205f 5f73 7562 5f5f 286d 6174 3420 612c   __sub__(mat4 a,
-000138a0: 206d 6174 3420 6229 3a0a 2020 2020 2020   mat4 b):.      
-000138b0: 2020 2222 224d 6174 7269 7820 7375 6274    """Matrix subt
-000138c0: 7261 6374 696f 6e2e 0a0a 2020 2020 2020  raction...      
-000138d0: 2020 3e3e 3e20 4d3d 6d61 7434 2831 2c32    >>> M=mat4(1,2
-000138e0: 2c33 2c34 2c35 2c36 2c37 2c38 2c39 2c31  ,3,4,5,6,7,8,9,1
-000138f0: 302c 3131 2c31 322c 3133 2c31 342c 3135  0,11,12,13,14,15
-00013900: 2c31 3629 0a20 2020 2020 2020 203e 3e3e  ,16).        >>>
-00013910: 2070 7269 6e74 204d 2d4d 0a20 2020 2020   print M-M.     
-00013920: 2020 205b 2020 2030 2e30 3030 302c 2020     [   0.0000,  
-00013930: 2020 302e 3030 3030 2c20 2020 2030 2e30    0.0000,    0.0
-00013940: 3030 302c 2020 2020 302e 3030 3030 5d0a  000,    0.0000].
-00013950: 2020 2020 2020 2020 5b20 2020 302e 3030          [   0.00
-00013960: 3030 2c20 2020 2030 2e30 3030 302c 2020  00,    0.0000,  
-00013970: 2020 302e 3030 3030 2c20 2020 2030 2e30    0.0000,    0.0
-00013980: 3030 305d 0a20 2020 2020 2020 205b 2020  000].        [  
-00013990: 2030 2e30 3030 302c 2020 2020 302e 3030   0.0000,    0.00
-000139a0: 3030 2c20 2020 2030 2e30 3030 302c 2020  00,    0.0000,  
-000139b0: 2020 302e 3030 3030 5d0a 2020 2020 2020    0.0000].      
-000139c0: 2020 5b20 2020 302e 3030 3030 2c20 2020    [   0.0000,   
-000139d0: 2030 2e30 3030 302c 2020 2020 302e 3030   0.0000,    0.00
-000139e0: 3030 2c20 2020 2030 2e30 3030 305d 0a20  00,    0.0000]. 
-000139f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00013a00: 2020 2063 6465 6620 6d61 7434 2072 6573     cdef mat4 res
-00013a10: 0a20 2020 2020 2020 2072 6573 203d 206d  .        res = m
-00013a20: 6174 3428 290a 2020 2020 2020 2020 7265  at4().        re
-00013a30: 732e 6d31 3120 3d20 612e 6d31 3120 2d20  s.m11 = a.m11 - 
-00013a40: 622e 6d31 310a 2020 2020 2020 2020 7265  b.m11.        re
-00013a50: 732e 6d31 3220 3d20 612e 6d31 3220 2d20  s.m12 = a.m12 - 
-00013a60: 622e 6d31 320a 2020 2020 2020 2020 7265  b.m12.        re
-00013a70: 732e 6d31 3320 3d20 612e 6d31 3320 2d20  s.m13 = a.m13 - 
-00013a80: 622e 6d31 330a 2020 2020 2020 2020 7265  b.m13.        re
-00013a90: 732e 6d31 3420 3d20 612e 6d31 3420 2d20  s.m14 = a.m14 - 
-00013aa0: 622e 6d31 340a 2020 2020 2020 2020 7265  b.m14.        re
-00013ab0: 732e 6d32 3120 3d20 612e 6d32 3120 2d20  s.m21 = a.m21 - 
-00013ac0: 622e 6d32 310a 2020 2020 2020 2020 7265  b.m21.        re
-00013ad0: 732e 6d32 3220 3d20 612e 6d32 3220 2d20  s.m22 = a.m22 - 
-00013ae0: 622e 6d32 320a 2020 2020 2020 2020 7265  b.m22.        re
-00013af0: 732e 6d32 3320 3d20 612e 6d32 3320 2d20  s.m23 = a.m23 - 
-00013b00: 622e 6d32 330a 2020 2020 2020 2020 7265  b.m23.        re
-00013b10: 732e 6d32 3420 3d20 612e 6d32 3420 2d20  s.m24 = a.m24 - 
-00013b20: 622e 6d32 340a 2020 2020 2020 2020 7265  b.m24.        re
-00013b30: 732e 6d33 3120 3d20 612e 6d33 3120 2d20  s.m31 = a.m31 - 
-00013b40: 622e 6d33 310a 2020 2020 2020 2020 7265  b.m31.        re
-00013b50: 732e 6d33 3220 3d20 612e 6d33 3220 2d20  s.m32 = a.m32 - 
-00013b60: 622e 6d33 320a 2020 2020 2020 2020 7265  b.m32.        re
-00013b70: 732e 6d33 3320 3d20 612e 6d33 3320 2d20  s.m33 = a.m33 - 
-00013b80: 622e 6d33 330a 2020 2020 2020 2020 7265  b.m33.        re
-00013b90: 732e 6d33 3420 3d20 612e 6d33 3420 2d20  s.m34 = a.m34 - 
-00013ba0: 622e 6d33 340a 2020 2020 2020 2020 7265  b.m34.        re
-00013bb0: 732e 6d34 3120 3d20 612e 6d34 3120 2d20  s.m41 = a.m41 - 
-00013bc0: 622e 6d34 310a 2020 2020 2020 2020 7265  b.m41.        re
-00013bd0: 732e 6d34 3220 3d20 612e 6d34 3220 2d20  s.m42 = a.m42 - 
-00013be0: 622e 6d34 320a 2020 2020 2020 2020 7265  b.m42.        re
-00013bf0: 732e 6d34 3320 3d20 612e 6d34 3320 2d20  s.m43 = a.m43 - 
-00013c00: 622e 6d34 330a 2020 2020 2020 2020 7265  b.m43.        re
-00013c10: 732e 6d34 3420 3d20 612e 6d34 3420 2d20  s.m44 = a.m44 - 
-00013c20: 622e 6d34 340a 2020 2020 2020 2020 7265  b.m44.        re
-00013c30: 7475 726e 2072 6573 0a0a 2020 2020 6465  turn res..    de
-00013c40: 6620 5f5f 6d75 6c5f 5f28 612c 2062 293a  f __mul__(a, b):
-00013c50: 0a20 2020 2020 2020 2022 2222 4d75 6c74  .        """Mult
-00013c60: 6970 6c69 6361 7469 6f6e 2e0a 0a20 2020  iplication...   
-00013c70: 2020 2020 203e 3e3e 204d 3d6d 6174 3428       >>> M=mat4(
-00013c80: 312c 322c 332c 342c 352c 362c 372c 382c  1,2,3,4,5,6,7,8,
-00013c90: 392c 3130 2c31 312c 3132 2c31 332c 3134  9,10,11,12,13,14
-00013ca0: 2c31 352c 3136 290a 2020 2020 2020 2020  ,15,16).        
-00013cb0: 3e3e 3e20 7072 696e 7420 4d2a 322e 300a  >>> print M*2.0.
-00013cc0: 2020 2020 2020 2020 5b20 2020 322e 3030          [   2.00
-00013cd0: 3030 2c20 2020 2034 2e30 3030 302c 2020  00,    4.0000,  
-00013ce0: 2020 362e 3030 3030 2c20 2020 2038 2e30    6.0000,    8.0
-00013cf0: 3030 305d 0a20 2020 2020 2020 205b 2020  000].        [  
-00013d00: 3130 2e30 3030 302c 2020 2031 322e 3030  10.0000,   12.00
-00013d10: 3030 2c20 2020 3134 2e30 3030 302c 2020  00,   14.0000,  
-00013d20: 2031 362e 3030 3030 5d0a 2020 2020 2020   16.0000].      
-00013d30: 2020 5b20 2031 382e 3030 3030 2c20 2020    [  18.0000,   
-00013d40: 3230 2e30 3030 302c 2020 2032 322e 3030  20.0000,   22.00
-00013d50: 3030 2c20 2020 3234 2e30 3030 305d 0a20  00,   24.0000]. 
-00013d60: 2020 2020 2020 205b 2020 3236 2e30 3030         [  26.000
-00013d70: 302c 2020 2032 382e 3030 3030 2c20 2020  0,   28.0000,   
-00013d80: 3330 2e30 3030 302c 2020 2033 322e 3030  30.0000,   32.00
-00013d90: 3030 5d0a 2020 2020 2020 2020 3e3e 3e20  00].        >>> 
-00013da0: 7072 696e 7420 322e 302a 4d0a 2020 2020  print 2.0*M.    
-00013db0: 2020 2020 5b20 2020 322e 3030 3030 2c20      [   2.0000, 
-00013dc0: 2020 2034 2e30 3030 302c 2020 2020 362e     4.0000,    6.
-00013dd0: 3030 3030 2c20 2020 2038 2e30 3030 305d  0000,    8.0000]
-00013de0: 0a20 2020 2020 2020 205b 2020 3130 2e30  .        [  10.0
-00013df0: 3030 302c 2020 2031 322e 3030 3030 2c20  000,   12.0000, 
-00013e00: 2020 3134 2e30 3030 302c 2020 2031 362e    14.0000,   16.
-00013e10: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
-00013e20: 2031 382e 3030 3030 2c20 2020 3230 2e30   18.0000,   20.0
-00013e30: 3030 302c 2020 2032 322e 3030 3030 2c20  000,   22.0000, 
-00013e40: 2020 3234 2e30 3030 305d 0a20 2020 2020    24.0000].     
-00013e50: 2020 205b 2020 3236 2e30 3030 302c 2020     [  26.0000,  
-00013e60: 2032 382e 3030 3030 2c20 2020 3330 2e30   28.0000,   30.0
-00013e70: 3030 302c 2020 2033 322e 3030 3030 5d0a  000,   32.0000].
-00013e80: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00013e90: 7420 4d2a 4d0a 2020 2020 2020 2020 5b20  t M*M.        [ 
-00013ea0: 2039 302e 3030 3030 2c20 2031 3030 2e30   90.0000,  100.0
-00013eb0: 3030 302c 2020 3131 302e 3030 3030 2c20  000,  110.0000, 
-00013ec0: 2031 3230 2e30 3030 305d 0a20 2020 2020   120.0000].     
-00013ed0: 2020 205b 2032 3032 2e30 3030 302c 2020     [ 202.0000,  
-00013ee0: 3232 382e 3030 3030 2c20 2032 3534 2e30  228.0000,  254.0
-00013ef0: 3030 302c 2020 3238 302e 3030 3030 5d0a  000,  280.0000].
-00013f00: 2020 2020 2020 2020 5b20 3331 342e 3030          [ 314.00
-00013f10: 3030 2c20 2033 3536 2e30 3030 302c 2020  00,  356.0000,  
-00013f20: 3339 382e 3030 3030 2c20 2034 3430 2e30  398.0000,  440.0
-00013f30: 3030 305d 0a20 2020 2020 2020 205b 2034  000].        [ 4
-00013f40: 3236 2e30 3030 302c 2020 3438 342e 3030  26.0000,  484.00
-00013f50: 3030 2c20 2035 3432 2e30 3030 302c 2020  00,  542.0000,  
-00013f60: 3630 302e 3030 3030 5d0a 2020 2020 2020  600.0000].      
-00013f70: 2020 3e3e 3e20 7072 696e 7420 4d2a 5f76    >>> print M*_v
-00013f80: 6563 3328 312c 322c 3329 0a20 2020 2020  ec3(1,2,3).     
-00013f90: 2020 2028 302e 3137 3635 2c20 302e 3435     (0.1765, 0.45
-00013fa0: 3130 2c20 302e 3732 3535 290a 2020 2020  10, 0.7255).    
-00013fb0: 2020 2020 3e3e 3e20 7072 696e 7420 5f76      >>> print _v
-00013fc0: 6563 3328 312c 322c 3329 2a4d 0a20 2020  ec3(1,2,3)*M.   
-00013fd0: 2020 2020 2028 302e 3730 3833 2c20 302e       (0.7083, 0.
-00013fe0: 3830 3536 2c20 302e 3930 3238 290a 2020  8056, 0.9028).  
-00013ff0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00014000: 2020 6364 6566 206d 6174 3420 6d61 2c20    cdef mat4 ma, 
-00014010: 6d62 2c20 7265 730a 2020 2020 2020 2020  mb, res.        
-00014020: 6364 6566 2076 6563 3320 7661 2c20 7662  cdef vec3 va, vb
-00014030: 2c20 7672 6573 0a20 2020 2020 2020 2063  , vres.        c
-00014040: 6465 6620 7665 6334 2077 612c 2077 622c  def vec4 wa, wb,
-00014050: 2077 7265 730a 2020 2020 2020 2020 6364   wres.        cd
-00014060: 6566 2064 6f75 626c 6520 722c 2077 0a0a  ef double r, w..
-00014070: 2020 2020 2020 2020 7461 203d 2074 7970          ta = typ
-00014080: 6528 6129 0a20 2020 2020 2020 2074 6220  e(a).        tb 
-00014090: 3d20 7479 7065 2862 290a 0a20 2020 2020  = type(b)..     
-000140a0: 2020 2023 206d 6174 3420 6f6e 2074 6865     # mat4 on the
-000140b0: 206c 6566 743f 0a20 2020 2020 2020 2069   left?.        i
-000140c0: 6620 7461 2069 7320 6d61 7434 3a0a 2020  f ta is mat4:.  
-000140d0: 2020 2020 2020 2020 2020 6d61 203d 2061            ma = a
-000140e0: 0a20 2020 2020 2020 2020 2020 2023 206d  .            # m
-000140f0: 6174 3420 6f6e 2074 6865 2072 6967 6874  at4 on the right
-00014100: 3f0a 2020 2020 2020 2020 2020 2020 6966  ?.            if
-00014110: 2074 6220 6973 206d 6174 343a 0a20 2020   tb is mat4:.   
-00014120: 2020 2020 2020 2020 2020 2020 2023 206d               # m
-00014130: 6174 342a 6d61 7434 0a20 2020 2020 2020  at4*mat4.       
-00014140: 2020 2020 2020 2020 2072 6573 203d 206d           res = m
-00014150: 6174 3428 290a 2020 2020 2020 2020 2020  at4().          
-00014160: 2020 2020 2020 6d62 203d 2062 0a20 2020        mb = b.   
-00014170: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00014180: 2e6d 3131 203d 206d 612e 6d31 312a 6d62  .m11 = ma.m11*mb
-00014190: 2e6d 3131 2b6d 612e 6d31 322a 6d62 2e6d  .m11+ma.m12*mb.m
-000141a0: 3231 2b6d 612e 6d31 332a 6d62 2e6d 3331  21+ma.m13*mb.m31
-000141b0: 2b6d 612e 6d31 342a 6d62 2e6d 3431 0a20  +ma.m14*mb.m41. 
-000141c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000141d0: 6573 2e6d 3132 203d 206d 612e 6d31 312a  es.m12 = ma.m11*
-000141e0: 6d62 2e6d 3132 2b6d 612e 6d31 322a 6d62  mb.m12+ma.m12*mb
-000141f0: 2e6d 3232 2b6d 612e 6d31 332a 6d62 2e6d  .m22+ma.m13*mb.m
-00014200: 3332 2b6d 612e 6d31 342a 6d62 2e6d 3432  32+ma.m14*mb.m42
-00014210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014220: 2072 6573 2e6d 3133 203d 206d 612e 6d31   res.m13 = ma.m1
-00014230: 312a 6d62 2e6d 3133 2b6d 612e 6d31 322a  1*mb.m13+ma.m12*
-00014240: 6d62 2e6d 3233 2b6d 612e 6d31 332a 6d62  mb.m23+ma.m13*mb
-00014250: 2e6d 3333 2b6d 612e 6d31 342a 6d62 2e6d  .m33+ma.m14*mb.m
-00014260: 3433 0a20 2020 2020 2020 2020 2020 2020  43.             
-00014270: 2020 2072 6573 2e6d 3134 203d 206d 612e     res.m14 = ma.
-00014280: 6d31 312a 6d62 2e6d 3134 2b6d 612e 6d31  m11*mb.m14+ma.m1
-00014290: 322a 6d62 2e6d 3234 2b6d 612e 6d31 332a  2*mb.m24+ma.m13*
-000142a0: 6d62 2e6d 3334 2b6d 612e 6d31 342a 6d62  mb.m34+ma.m14*mb
-000142b0: 2e6d 3434 0a20 2020 2020 2020 2020 2020  .m44.           
-000142c0: 2020 2020 2072 6573 2e6d 3231 203d 206d       res.m21 = m
-000142d0: 612e 6d32 312a 6d62 2e6d 3131 2b6d 612e  a.m21*mb.m11+ma.
-000142e0: 6d32 322a 6d62 2e6d 3231 2b6d 612e 6d32  m22*mb.m21+ma.m2
-000142f0: 332a 6d62 2e6d 3331 2b6d 612e 6d32 342a  3*mb.m31+ma.m24*
-00014300: 6d62 2e6d 3431 0a20 2020 2020 2020 2020  mb.m41.         
-00014310: 2020 2020 2020 2072 6573 2e6d 3232 203d         res.m22 =
-00014320: 206d 612e 6d32 312a 6d62 2e6d 3132 2b6d   ma.m21*mb.m12+m
-00014330: 612e 6d32 322a 6d62 2e6d 3232 2b6d 612e  a.m22*mb.m22+ma.
-00014340: 6d32 332a 6d62 2e6d 3332 2b6d 612e 6d32  m23*mb.m32+ma.m2
-00014350: 342a 6d62 2e6d 3432 0a20 2020 2020 2020  4*mb.m42.       
-00014360: 2020 2020 2020 2020 2072 6573 2e6d 3233           res.m23
-00014370: 203d 206d 612e 6d32 312a 6d62 2e6d 3133   = ma.m21*mb.m13
-00014380: 2b6d 612e 6d32 322a 6d62 2e6d 3233 2b6d  +ma.m22*mb.m23+m
-00014390: 612e 6d32 332a 6d62 2e6d 3333 2b6d 612e  a.m23*mb.m33+ma.
-000143a0: 6d32 342a 6d62 2e6d 3433 0a20 2020 2020  m24*mb.m43.     
-000143b0: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-000143c0: 3234 203d 206d 612e 6d32 312a 6d62 2e6d  24 = ma.m21*mb.m
-000143d0: 3134 2b6d 612e 6d32 322a 6d62 2e6d 3234  14+ma.m22*mb.m24
-000143e0: 2b6d 612e 6d32 332a 6d62 2e6d 3334 2b6d  +ma.m23*mb.m34+m
-000143f0: 612e 6d32 342a 6d62 2e6d 3434 0a20 2020  a.m24*mb.m44.   
-00014400: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00014410: 2e6d 3331 203d 206d 612e 6d33 312a 6d62  .m31 = ma.m31*mb
-00014420: 2e6d 3131 2b6d 612e 6d33 322a 6d62 2e6d  .m11+ma.m32*mb.m
-00014430: 3231 2b6d 612e 6d33 332a 6d62 2e6d 3331  21+ma.m33*mb.m31
-00014440: 2b6d 612e 6d33 342a 6d62 2e6d 3431 0a20  +ma.m34*mb.m41. 
-00014450: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00014460: 6573 2e6d 3332 203d 206d 612e 6d33 312a  es.m32 = ma.m31*
-00014470: 6d62 2e6d 3132 2b6d 612e 6d33 322a 6d62  mb.m12+ma.m32*mb
-00014480: 2e6d 3232 2b6d 612e 6d33 332a 6d62 2e6d  .m22+ma.m33*mb.m
-00014490: 3332 2b6d 612e 6d33 342a 6d62 2e6d 3432  32+ma.m34*mb.m42
-000144a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000144b0: 2072 6573 2e6d 3333 203d 206d 612e 6d33   res.m33 = ma.m3
-000144c0: 312a 6d62 2e6d 3133 2b6d 612e 6d33 322a  1*mb.m13+ma.m32*
-000144d0: 6d62 2e6d 3233 2b6d 612e 6d33 332a 6d62  mb.m23+ma.m33*mb
-000144e0: 2e6d 3333 2b6d 612e 6d33 342a 6d62 2e6d  .m33+ma.m34*mb.m
-000144f0: 3433 0a20 2020 2020 2020 2020 2020 2020  43.             
-00014500: 2020 2072 6573 2e6d 3334 203d 206d 612e     res.m34 = ma.
-00014510: 6d33 312a 6d62 2e6d 3134 2b6d 612e 6d33  m31*mb.m14+ma.m3
-00014520: 322a 6d62 2e6d 3234 2b6d 612e 6d33 332a  2*mb.m24+ma.m33*
-00014530: 6d62 2e6d 3334 2b6d 612e 6d33 342a 6d62  mb.m34+ma.m34*mb
-00014540: 2e6d 3434 0a20 2020 2020 2020 2020 2020  .m44.           
-00014550: 2020 2020 2072 6573 2e6d 3431 203d 206d       res.m41 = m
-00014560: 612e 6d34 312a 6d62 2e6d 3131 2b6d 612e  a.m41*mb.m11+ma.
-00014570: 6d34 322a 6d62 2e6d 3231 2b6d 612e 6d34  m42*mb.m21+ma.m4
-00014580: 332a 6d62 2e6d 3331 2b6d 612e 6d34 342a  3*mb.m31+ma.m44*
-00014590: 6d62 2e6d 3431 0a20 2020 2020 2020 2020  mb.m41.         
-000145a0: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
-000145b0: 206d 612e 6d34 312a 6d62 2e6d 3132 2b6d   ma.m41*mb.m12+m
-000145c0: 612e 6d34 322a 6d62 2e6d 3232 2b6d 612e  a.m42*mb.m22+ma.
-000145d0: 6d34 332a 6d62 2e6d 3332 2b6d 612e 6d34  m43*mb.m32+ma.m4
-000145e0: 342a 6d62 2e6d 3432 0a20 2020 2020 2020  4*mb.m42.       
-000145f0: 2020 2020 2020 2020 2072 6573 2e6d 3433           res.m43
-00014600: 203d 206d 612e 6d34 312a 6d62 2e6d 3133   = ma.m41*mb.m13
-00014610: 2b6d 612e 6d34 322a 6d62 2e6d 3233 2b6d  +ma.m42*mb.m23+m
-00014620: 612e 6d34 332a 6d62 2e6d 3333 2b6d 612e  a.m43*mb.m33+ma.
-00014630: 6d34 342a 6d62 2e6d 3433 0a20 2020 2020  m44*mb.m43.     
-00014640: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-00014650: 3434 203d 206d 612e 6d34 312a 6d62 2e6d  44 = ma.m41*mb.m
-00014660: 3134 2b6d 612e 6d34 322a 6d62 2e6d 3234  14+ma.m42*mb.m24
-00014670: 2b6d 612e 6d34 332a 6d62 2e6d 3334 2b6d  +ma.m43*mb.m34+m
-00014680: 612e 6d34 342a 6d62 2e6d 3434 0a20 2020  a.m44*mb.m44.   
-00014690: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-000146a0: 7572 6e20 7265 730a 2020 2020 2020 2020  urn res.        
-000146b0: 2020 2020 2320 7665 6334 206f 6e20 7468      # vec4 on th
-000146c0: 6520 7269 6768 743f 0a20 2020 2020 2020  e right?.       
-000146d0: 2020 2020 2065 6c69 6620 7462 2069 7320       elif tb is 
-000146e0: 7665 6334 3a0a 2020 2020 2020 2020 2020  vec4:.          
-000146f0: 2020 2020 2020 2320 6d61 7434 2a76 6563        # mat4*vec
-00014700: 340a 2020 2020 2020 2020 2020 2020 2020  4.              
-00014710: 2020 7772 6573 203d 2076 6563 3428 290a    wres = vec4().
-00014720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014730: 7762 2020 203d 2062 0a20 2020 2020 2020  wb   = b.       
-00014740: 2020 2020 2020 2020 2077 7265 732e 7820           wres.x 
-00014750: 3d20 6d61 2e6d 3131 2a77 622e 7820 2b20  = ma.m11*wb.x + 
-00014760: 6d61 2e6d 3132 2a77 622e 7920 2b20 6d61  ma.m12*wb.y + ma
-00014770: 2e6d 3133 2a77 622e 7a20 2b20 6d61 2e6d  .m13*wb.z + ma.m
-00014780: 3134 2a77 622e 770a 2020 2020 2020 2020  14*wb.w.        
-00014790: 2020 2020 2020 2020 7772 6573 2e79 203d          wres.y =
-000147a0: 206d 612e 6d32 312a 7762 2e78 202b 206d   ma.m21*wb.x + m
-000147b0: 612e 6d32 322a 7762 2e79 202b 206d 612e  a.m22*wb.y + ma.
-000147c0: 6d32 332a 7762 2e7a 202b 206d 612e 6d32  m23*wb.z + ma.m2
-000147d0: 342a 7762 2e77 0a20 2020 2020 2020 2020  4*wb.w.         
-000147e0: 2020 2020 2020 2077 7265 732e 7a20 3d20         wres.z = 
-000147f0: 6d61 2e6d 3331 2a77 622e 7820 2b20 6d61  ma.m31*wb.x + ma
-00014800: 2e6d 3332 2a77 622e 7920 2b20 6d61 2e6d  .m32*wb.y + ma.m
-00014810: 3333 2a77 622e 7a20 2b20 6d61 2e6d 3334  33*wb.z + ma.m34
-00014820: 2a77 622e 770a 2020 2020 2020 2020 2020  *wb.w.          
-00014830: 2020 2020 2020 7772 6573 2e77 203d 206d        wres.w = m
-00014840: 612e 6d34 312a 7762 2e78 202b 206d 612e  a.m41*wb.x + ma.
-00014850: 6d34 322a 7762 2e79 202b 206d 612e 6d34  m42*wb.y + ma.m4
-00014860: 332a 7762 2e7a 202b 206d 612e 6d34 342a  3*wb.z + ma.m44*
-00014870: 7762 2e77 0a20 2020 2020 2020 2020 2020  wb.w.           
-00014880: 2020 2020 2072 6574 7572 6e20 7772 6573       return wres
-00014890: 0a20 2020 2020 2020 2020 2020 2023 2076  .            # v
-000148a0: 6563 3320 6f6e 2074 6865 2072 6967 6874  ec3 on the right
-000148b0: 3f0a 2020 2020 2020 2020 2020 2020 656c  ?.            el
-000148c0: 6966 2074 6220 6973 2076 6563 333a 0a20  if tb is vec3:. 
-000148d0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000148e0: 206d 6174 342a 7665 6333 0a20 2020 2020   mat4*vec3.     
-000148f0: 2020 2020 2020 2020 2020 2076 7265 7320             vres 
-00014900: 3d20 7665 6333 2829 0a20 2020 2020 2020  = vec3().       
-00014910: 2020 2020 2020 2020 2076 6220 2020 3d20           vb   = 
-00014920: 620a 2020 2020 2020 2020 2020 2020 2020  b.              
-00014930: 2020 7672 6573 2e78 203d 206d 612e 6d31    vres.x = ma.m1
-00014940: 312a 7662 2e78 202b 206d 612e 6d31 322a  1*vb.x + ma.m12*
-00014950: 7662 2e79 202b 206d 612e 6d31 332a 7662  vb.y + ma.m13*vb
-00014960: 2e7a 202b 206d 612e 6d31 340a 2020 2020  .z + ma.m14.    
-00014970: 2020 2020 2020 2020 2020 2020 7672 6573              vres
-00014980: 2e79 203d 206d 612e 6d32 312a 7662 2e78  .y = ma.m21*vb.x
-00014990: 202b 206d 612e 6d32 322a 7662 2e79 202b   + ma.m22*vb.y +
-000149a0: 206d 612e 6d32 332a 7662 2e7a 202b 206d   ma.m23*vb.z + m
-000149b0: 612e 6d32 340a 2020 2020 2020 2020 2020  a.m24.          
-000149c0: 2020 2020 2020 7672 6573 2e7a 203d 206d        vres.z = m
-000149d0: 612e 6d33 312a 7662 2e78 202b 206d 612e  a.m31*vb.x + ma.
-000149e0: 6d33 322a 7662 2e79 202b 206d 612e 6d33  m32*vb.y + ma.m3
-000149f0: 332a 7662 2e7a 202b 206d 612e 6d33 340a  3*vb.z + ma.m34.
-00014a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a10: 7720 2020 203d 206d 612e 6d34 312a 7662  w    = ma.m41*vb
-00014a20: 2e78 202b 206d 612e 6d34 322a 7662 2e79  .x + ma.m42*vb.y
-00014a30: 202b 206d 612e 6d34 332a 7662 2e7a 202b   + ma.m43*vb.z +
-00014a40: 206d 612e 6d34 340a 2020 2020 2020 2020   ma.m44.        
-00014a50: 2020 2020 2020 2020 6966 2066 6162 7328          if fabs(
-00014a60: 7729 3e65 7073 3a0a 2020 2020 2020 2020  w)>eps:.        
-00014a70: 2020 2020 2020 2020 2020 2020 7672 6573              vres
-00014a80: 2e78 203d 2076 7265 732e 782f 770a 2020  .x = vres.x/w.  
-00014a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014aa0: 2020 7672 6573 2e79 203d 2076 7265 732e    vres.y = vres.
-00014ab0: 792f 770a 2020 2020 2020 2020 2020 2020  y/w.            
-00014ac0: 2020 2020 2020 2020 7672 6573 2e7a 203d          vres.z =
-00014ad0: 2076 7265 732e 7a2f 770a 2020 2020 2020   vres.z/w.      
-00014ae0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00014af0: 2076 7265 730a 2020 2020 2020 2020 2020   vres.          
-00014b00: 2020 2320 5363 616c 6172 206f 6e20 7468    # Scalar on th
-00014b10: 6520 7269 6768 743f 0a20 2020 2020 2020  e right?.       
-00014b20: 2020 2020 2065 6c69 6620 7462 2069 7320       elif tb is 
-00014b30: 666c 6f61 7420 6f72 2074 6220 6973 2069  float or tb is i
-00014b40: 6e74 206f 7220 7462 2069 7320 6c6f 6e67  nt or tb is long
-00014b50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00014b60: 2020 7265 7320 3d20 6d61 7434 2829 0a20    res = mat4(). 
-00014b70: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00014b80: 203d 2062 0a20 2020 2020 2020 2020 2020   = b.           
-00014b90: 2020 2020 2072 6573 2e6d 3131 203d 206d       res.m11 = m
-00014ba0: 612e 6d31 312a 720a 2020 2020 2020 2020  a.m11*r.        
-00014bb0: 2020 2020 2020 2020 7265 732e 6d31 3220          res.m12 
-00014bc0: 3d20 6d61 2e6d 3132 2a72 0a20 2020 2020  = ma.m12*r.     
-00014bd0: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-00014be0: 3133 203d 206d 612e 6d31 332a 720a 2020  13 = ma.m13*r.  
-00014bf0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00014c00: 732e 6d31 3420 3d20 6d61 2e6d 3134 2a72  s.m14 = ma.m14*r
-00014c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014c20: 2072 6573 2e6d 3231 203d 206d 612e 6d32   res.m21 = ma.m2
-00014c30: 312a 720a 2020 2020 2020 2020 2020 2020  1*r.            
-00014c40: 2020 2020 7265 732e 6d32 3220 3d20 6d61      res.m22 = ma
-00014c50: 2e6d 3232 2a72 0a20 2020 2020 2020 2020  .m22*r.         
-00014c60: 2020 2020 2020 2072 6573 2e6d 3233 203d         res.m23 =
-00014c70: 206d 612e 6d32 332a 720a 2020 2020 2020   ma.m23*r.      
-00014c80: 2020 2020 2020 2020 2020 7265 732e 6d32            res.m2
-00014c90: 3420 3d20 6d61 2e6d 3234 2a72 0a20 2020  4 = ma.m24*r.   
-00014ca0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00014cb0: 2e6d 3331 203d 206d 612e 6d33 312a 720a  .m31 = ma.m31*r.
-00014cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014cd0: 7265 732e 6d33 3220 3d20 6d61 2e6d 3332  res.m32 = ma.m32
-00014ce0: 2a72 0a20 2020 2020 2020 2020 2020 2020  *r.             
-00014cf0: 2020 2072 6573 2e6d 3333 203d 206d 612e     res.m33 = ma.
-00014d00: 6d33 332a 720a 2020 2020 2020 2020 2020  m33*r.          
-00014d10: 2020 2020 2020 7265 732e 6d33 3420 3d20        res.m34 = 
-00014d20: 6d61 2e6d 3334 2a72 0a20 2020 2020 2020  ma.m34*r.       
-00014d30: 2020 2020 2020 2020 2072 6573 2e6d 3431           res.m41
-00014d40: 203d 206d 612e 6d34 312a 720a 2020 2020   = ma.m41*r.    
-00014d50: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00014d60: 6d34 3220 3d20 6d61 2e6d 3432 2a72 0a20  m42 = ma.m42*r. 
-00014d70: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00014d80: 6573 2e6d 3433 203d 206d 612e 6d34 332a  es.m43 = ma.m43*
-00014d90: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-00014da0: 2020 7265 732e 6d34 3420 3d20 6d61 2e6d    res.m44 = ma.m
-00014db0: 3434 2a72 0a20 2020 2020 2020 2020 2020  44*r.           
-00014dc0: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-00014dd0: 0a20 2020 2020 2020 2023 2076 6563 3420  .        # vec4 
-00014de0: 6f6e 2074 6865 206c 6566 743f 2028 7468  on the left? (th
-00014df0: 656e 2074 6865 7265 206d 7573 7420 6265  en there must be
-00014e00: 2061 206d 6174 3420 6f6e 2074 6865 2072   a mat4 on the r
-00014e10: 6967 6874 290a 2020 2020 2020 2020 656c  ight).        el
-00014e20: 6966 2074 6120 6973 2076 6563 343a 0a20  if ta is vec4:. 
-00014e30: 2020 2020 2020 2020 2020 2023 2076 6563             # vec
-00014e40: 342a 6d61 7434 0a20 2020 2020 2020 2020  4*mat4.         
-00014e50: 2020 2077 7265 7320 3d20 7665 6334 2829     wres = vec4()
-00014e60: 0a20 2020 2020 2020 2020 2020 2077 6120  .            wa 
-00014e70: 2020 3d20 610a 2020 2020 2020 2020 2020    = a.          
-00014e80: 2020 6d62 2020 203d 2062 0a20 2020 2020    mb   = b.     
-00014e90: 2020 2020 2020 2077 7265 732e 7820 3d20         wres.x = 
-00014ea0: 7761 2e78 2a6d 622e 6d31 3120 2b20 7761  wa.x*mb.m11 + wa
-00014eb0: 2e79 2a6d 622e 6d32 3120 2b20 7761 2e7a  .y*mb.m21 + wa.z
-00014ec0: 2a6d 622e 6d33 3120 2b20 7761 2e77 2a6d  *mb.m31 + wa.w*m
-00014ed0: 622e 6d34 310a 2020 2020 2020 2020 2020  b.m41.          
-00014ee0: 2020 7772 6573 2e79 203d 2077 612e 782a    wres.y = wa.x*
-00014ef0: 6d62 2e6d 3132 202b 2077 612e 792a 6d62  mb.m12 + wa.y*mb
-00014f00: 2e6d 3232 202b 2077 612e 7a2a 6d62 2e6d  .m22 + wa.z*mb.m
-00014f10: 3332 202b 2077 612e 772a 6d62 2e6d 3432  32 + wa.w*mb.m42
-00014f20: 0a20 2020 2020 2020 2020 2020 2077 7265  .            wre
-00014f30: 732e 7a20 3d20 7761 2e78 2a6d 622e 6d31  s.z = wa.x*mb.m1
-00014f40: 3320 2b20 7761 2e79 2a6d 622e 6d32 3320  3 + wa.y*mb.m23 
-00014f50: 2b20 7761 2e7a 2a6d 622e 6d33 3320 2b20  + wa.z*mb.m33 + 
-00014f60: 7761 2e77 2a6d 622e 6d34 330a 2020 2020  wa.w*mb.m43.    
-00014f70: 2020 2020 2020 2020 7772 6573 2e77 203d          wres.w =
-00014f80: 2077 612e 782a 6d62 2e6d 3134 202b 2077   wa.x*mb.m14 + w
-00014f90: 612e 792a 6d62 2e6d 3234 202b 2077 612e  a.y*mb.m24 + wa.
-00014fa0: 7a2a 6d62 2e6d 3334 202b 2077 612e 772a  z*mb.m34 + wa.w*
-00014fb0: 6d62 2e6d 3434 0a20 2020 2020 2020 2020  mb.m44.         
-00014fc0: 2020 2072 6574 7572 6e20 7772 6573 0a0a     return wres..
-00014fd0: 2020 2020 2020 2020 2320 7665 6333 206f          # vec3 o
-00014fe0: 6e20 7468 6520 6c65 6674 3f20 2874 6865  n the left? (the
-00014ff0: 6e20 7468 6572 6520 6d75 7374 2062 6520  n there must be 
-00015000: 6120 6d61 7434 206f 6e20 7468 6520 7269  a mat4 on the ri
-00015010: 6768 7429 0a20 2020 2020 2020 2065 6c69  ght).        eli
-00015020: 6620 7461 2069 7320 7665 6333 3a0a 2020  f ta is vec3:.  
-00015030: 2020 2020 2020 2020 2020 2320 7665 6333            # vec3
-00015040: 2a6d 6174 340a 2020 2020 2020 2020 2020  *mat4.          
-00015050: 2020 7672 6573 203d 2076 6563 3328 290a    vres = vec3().
-00015060: 2020 2020 2020 2020 2020 2020 7661 2020              va  
-00015070: 203d 2061 0a20 2020 2020 2020 2020 2020   = a.           
-00015080: 206d 6220 2020 3d20 620a 2020 2020 2020   mb   = b.      
-00015090: 2020 2020 2020 7672 6573 2e78 203d 2076        vres.x = v
-000150a0: 612e 782a 6d62 2e6d 3131 202b 2076 612e  a.x*mb.m11 + va.
-000150b0: 792a 6d62 2e6d 3231 202b 2076 612e 7a2a  y*mb.m21 + va.z*
-000150c0: 6d62 2e6d 3331 202b 206d 622e 6d34 310a  mb.m31 + mb.m41.
-000150d0: 2020 2020 2020 2020 2020 2020 7672 6573              vres
-000150e0: 2e79 203d 2076 612e 782a 6d62 2e6d 3132  .y = va.x*mb.m12
-000150f0: 202b 2076 612e 792a 6d62 2e6d 3232 202b   + va.y*mb.m22 +
-00015100: 2076 612e 7a2a 6d62 2e6d 3332 202b 206d   va.z*mb.m32 + m
-00015110: 622e 6d34 320a 2020 2020 2020 2020 2020  b.m42.          
-00015120: 2020 7672 6573 2e7a 203d 2076 612e 782a    vres.z = va.x*
-00015130: 6d62 2e6d 3133 202b 2076 612e 792a 6d62  mb.m13 + va.y*mb
-00015140: 2e6d 3233 202b 2076 612e 7a2a 6d62 2e6d  .m23 + va.z*mb.m
-00015150: 3333 202b 206d 622e 6d34 330a 2020 2020  33 + mb.m43.    
-00015160: 2020 2020 2020 2020 7720 3d20 7661 2e78          w = va.x
-00015170: 2a6d 622e 6d31 3420 2b20 7661 2e79 2a6d  *mb.m14 + va.y*m
-00015180: 622e 6d32 3420 2b20 7661 2e7a 2a6d 622e  b.m24 + va.z*mb.
-00015190: 6d33 3420 2b20 6d62 2e6d 3434 0a20 2020  m34 + mb.m44.   
-000151a0: 2020 2020 2020 2020 2069 6620 6661 6273           if fabs
-000151b0: 2877 293e 6570 733a 0a20 2020 2020 2020  (w)>eps:.       
-000151c0: 2020 2020 2020 2020 2076 7265 732e 7820           vres.x 
-000151d0: 3d20 7672 6573 2e78 2f77 0a20 2020 2020  = vres.x/w.     
-000151e0: 2020 2020 2020 2020 2020 2076 7265 732e             vres.
-000151f0: 7920 3d20 7672 6573 2e79 2f77 0a20 2020  y = vres.y/w.   
-00015200: 2020 2020 2020 2020 2020 2020 2076 7265               vre
-00015210: 732e 7a20 3d20 7672 6573 2e7a 2f77 0a20  s.z = vres.z/w. 
-00015220: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00015230: 6e20 7672 6573 0a0a 2020 2020 2020 2020  n vres..        
-00015240: 2320 5363 616c 6172 206f 6e20 7468 6520  # Scalar on the 
-00015250: 6c65 6674 3f20 2874 6865 6e20 7468 6572  left? (then ther
-00015260: 6520 6d75 7374 2062 6520 6120 6d61 7434  e must be a mat4
-00015270: 206f 6e20 7468 6520 7269 6768 7429 0a20   on the right). 
-00015280: 2020 2020 2020 2065 6c69 6620 7461 2069         elif ta i
-00015290: 7320 666c 6f61 7420 6f72 2074 6120 6973  s float or ta is
-000152a0: 2069 6e74 206f 7220 7461 2069 7320 6c6f   int or ta is lo
-000152b0: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
-000152c0: 7265 7320 3d20 6d61 7434 2829 0a20 2020  res = mat4().   
-000152d0: 2020 2020 2020 2020 2072 2020 3d20 610a           r  = a.
-000152e0: 2020 2020 2020 2020 2020 2020 6d62 203d              mb =
-000152f0: 2062 0a20 2020 2020 2020 2020 2020 2072   b.            r
-00015300: 6573 2e6d 3131 203d 2072 2a6d 622e 6d31  es.m11 = r*mb.m1
-00015310: 310a 2020 2020 2020 2020 2020 2020 7265  1.            re
-00015320: 732e 6d31 3220 3d20 722a 6d62 2e6d 3132  s.m12 = r*mb.m12
-00015330: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00015340: 2e6d 3133 203d 2072 2a6d 622e 6d31 330a  .m13 = r*mb.m13.
-00015350: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00015360: 6d31 3420 3d20 722a 6d62 2e6d 3134 0a20  m14 = r*mb.m14. 
-00015370: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-00015380: 3231 203d 2072 2a6d 622e 6d32 310a 2020  21 = r*mb.m21.  
-00015390: 2020 2020 2020 2020 2020 7265 732e 6d32            res.m2
-000153a0: 3220 3d20 722a 6d62 2e6d 3232 0a20 2020  2 = r*mb.m22.   
-000153b0: 2020 2020 2020 2020 2072 6573 2e6d 3233           res.m23
-000153c0: 203d 2072 2a6d 622e 6d32 330a 2020 2020   = r*mb.m23.    
-000153d0: 2020 2020 2020 2020 7265 732e 6d32 3420          res.m24 
-000153e0: 3d20 722a 6d62 2e6d 3234 0a20 2020 2020  = r*mb.m24.     
-000153f0: 2020 2020 2020 2072 6573 2e6d 3331 203d         res.m31 =
-00015400: 2072 2a6d 622e 6d33 310a 2020 2020 2020   r*mb.m31.      
-00015410: 2020 2020 2020 7265 732e 6d33 3220 3d20        res.m32 = 
-00015420: 722a 6d62 2e6d 3332 0a20 2020 2020 2020  r*mb.m32.       
-00015430: 2020 2020 2072 6573 2e6d 3333 203d 2072       res.m33 = r
-00015440: 2a6d 622e 6d33 330a 2020 2020 2020 2020  *mb.m33.        
-00015450: 2020 2020 7265 732e 6d33 3420 3d20 722a      res.m34 = r*
-00015460: 6d62 2e6d 3334 0a20 2020 2020 2020 2020  mb.m34.         
-00015470: 2020 2072 6573 2e6d 3431 203d 2072 2a6d     res.m41 = r*m
-00015480: 622e 6d34 310a 2020 2020 2020 2020 2020  b.m41.          
-00015490: 2020 7265 732e 6d34 3220 3d20 722a 6d62    res.m42 = r*mb
-000154a0: 2e6d 3432 0a20 2020 2020 2020 2020 2020  .m42.           
-000154b0: 2072 6573 2e6d 3433 203d 2072 2a6d 622e   res.m43 = r*mb.
-000154c0: 6d34 330a 2020 2020 2020 2020 2020 2020  m43.            
-000154d0: 7265 732e 6d34 3420 3d20 722a 6d62 2e6d  res.m44 = r*mb.m
-000154e0: 3434 0a20 2020 2020 2020 2020 2020 2072  44.            r
-000154f0: 6574 7572 6e20 7265 730a 0a20 2020 2020  eturn res..     
-00015500: 2020 2023 204e 6f20 7661 6c69 6420 636f     # No valid co
-00015510: 6d62 696e 6174 696f 6e20 666f 756e 640a  mbination found.
-00015520: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00015530: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
-00015540: 6f72 7465 6420 6f70 6572 616e 6420 7479  orted operand ty
-00015550: 7065 2066 6f72 202a 220a 0a20 2020 2064  pe for *"..    d
-00015560: 6566 205f 5f64 6976 5f5f 286d 6174 3420  ef __div__(mat4 
-00015570: 612c 2062 293a 0a20 2020 2020 2020 2022  a, b):.        "
-00015580: 2222 4469 7669 7369 6f6e 2e0a 0a20 2020  ""Division...   
-00015590: 2020 2020 203e 3e3e 204d 3d6d 6174 3428       >>> M=mat4(
-000155a0: 312c 322c 332c 342c 352c 362c 372c 382c  1,2,3,4,5,6,7,8,
-000155b0: 392c 3130 2c31 312c 3132 2c31 332c 3134  9,10,11,12,13,14
-000155c0: 2c31 352c 3136 290a 2020 2020 2020 2020  ,15,16).        
-000155d0: 3e3e 3e20 7072 696e 7420 4d2f 322e 300a  >>> print M/2.0.
-000155e0: 2020 2020 2020 2020 5b20 2020 302e 3530          [   0.50
-000155f0: 3030 2c20 2020 2031 2e30 3030 302c 2020  00,    1.0000,  
-00015600: 2020 312e 3530 3030 2c20 2020 2032 2e30    1.5000,    2.0
-00015610: 3030 305d 0a20 2020 2020 2020 205b 2020  000].        [  
-00015620: 2032 2e35 3030 302c 2020 2020 332e 3030   2.5000,    3.00
-00015630: 3030 2c20 2020 2033 2e35 3030 302c 2020  00,    3.5000,  
-00015640: 2020 342e 3030 3030 5d0a 2020 2020 2020    4.0000].      
-00015650: 2020 5b20 2020 342e 3530 3030 2c20 2020    [   4.5000,   
-00015660: 2035 2e30 3030 302c 2020 2020 352e 3530   5.0000,    5.50
-00015670: 3030 2c20 2020 2036 2e30 3030 305d 0a20  00,    6.0000]. 
-00015680: 2020 2020 2020 205b 2020 2036 2e35 3030         [   6.500
-00015690: 302c 2020 2020 372e 3030 3030 2c20 2020  0,    7.0000,   
-000156a0: 2037 2e35 3030 302c 2020 2020 382e 3030   7.5000,    8.00
-000156b0: 3030 5d0a 2020 2020 2020 2020 2222 220a  00].        """.
-000156c0: 2020 2020 2020 2020 6364 6566 206d 6174          cdef mat
-000156d0: 3420 7265 730a 2020 2020 2020 2020 6364  4 res.        cd
-000156e0: 6566 2064 6f75 626c 6520 720a 0a20 2020  ef double r..   
-000156f0: 2020 2020 2074 6220 3d20 7479 7065 2862       tb = type(b
-00015700: 290a 0a20 2020 2020 2020 2069 6620 7462  )..        if tb
-00015710: 2069 7320 666c 6f61 7420 6f72 2074 6220   is float or tb 
-00015720: 6973 2069 6e74 206f 7220 7462 2069 7320  is int or tb is 
-00015730: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
-00015740: 2020 2320 6d61 7434 2f73 6361 6c61 720a    # mat4/scalar.
-00015750: 2020 2020 2020 2020 2020 2020 7265 7320              res 
-00015760: 3d20 6d61 7434 2829 0a20 2020 2020 2020  = mat4().       
-00015770: 2020 2020 2072 203d 2062 0a20 2020 2020       r = b.     
-00015780: 2020 2020 2020 2069 6620 6661 6273 2872         if fabs(r
-00015790: 293c 3d65 7073 3a0a 2020 2020 2020 2020  )<=eps:.        
-000157a0: 2020 2020 2020 2020 7261 6973 6520 5a65          raise Ze
-000157b0: 726f 4469 7669 7369 6f6e 4572 726f 722c  roDivisionError,
-000157c0: 226d 6174 3420 6469 7669 7369 6f6e 220a  "mat4 division".
-000157d0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-000157e0: 6d31 3120 3d20 612e 6d31 312f 720a 2020  m11 = a.m11/r.  
-000157f0: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
-00015800: 3220 3d20 612e 6d31 322f 720a 2020 2020  2 = a.m12/r.    
-00015810: 2020 2020 2020 2020 7265 732e 6d31 3320          res.m13 
-00015820: 3d20 612e 6d31 332f 720a 2020 2020 2020  = a.m13/r.      
-00015830: 2020 2020 2020 7265 732e 6d31 3420 3d20        res.m14 = 
-00015840: 612e 6d31 342f 720a 2020 2020 2020 2020  a.m14/r.        
-00015850: 2020 2020 7265 732e 6d32 3120 3d20 612e      res.m21 = a.
-00015860: 6d32 312f 720a 2020 2020 2020 2020 2020  m21/r.          
-00015870: 2020 7265 732e 6d32 3220 3d20 612e 6d32    res.m22 = a.m2
-00015880: 322f 720a 2020 2020 2020 2020 2020 2020  2/r.            
-00015890: 7265 732e 6d32 3320 3d20 612e 6d32 332f  res.m23 = a.m23/
-000158a0: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
-000158b0: 732e 6d32 3420 3d20 612e 6d32 342f 720a  s.m24 = a.m24/r.
-000158c0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-000158d0: 6d33 3120 3d20 612e 6d33 312f 720a 2020  m31 = a.m31/r.  
-000158e0: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
-000158f0: 3220 3d20 612e 6d33 322f 720a 2020 2020  2 = a.m32/r.    
-00015900: 2020 2020 2020 2020 7265 732e 6d33 3320          res.m33 
-00015910: 3d20 612e 6d33 332f 720a 2020 2020 2020  = a.m33/r.      
-00015920: 2020 2020 2020 7265 732e 6d33 3420 3d20        res.m34 = 
-00015930: 612e 6d33 342f 720a 2020 2020 2020 2020  a.m34/r.        
-00015940: 2020 2020 7265 732e 6d34 3120 3d20 612e      res.m41 = a.
-00015950: 6d34 312f 720a 2020 2020 2020 2020 2020  m41/r.          
-00015960: 2020 7265 732e 6d34 3220 3d20 612e 6d34    res.m42 = a.m4
-00015970: 322f 720a 2020 2020 2020 2020 2020 2020  2/r.            
-00015980: 7265 732e 6d34 3320 3d20 612e 6d34 332f  res.m43 = a.m43/
-00015990: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
-000159a0: 732e 6d34 3420 3d20 612e 6d34 342f 720a  s.m44 = a.m44/r.
-000159b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000159c0: 726e 2072 6573 0a20 2020 2020 2020 2065  rn res.        e
-000159d0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000159e0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-000159f0: 2c20 2275 6e73 7570 706f 7274 6564 206f  , "unsupported o
-00015a00: 7065 7261 6e64 2074 7970 6520 666f 7220  perand type for 
-00015a10: 2f22 0a0a 2020 2020 6465 6620 5f5f 6d6f  /"..    def __mo
-00015a20: 645f 5f28 6d61 7434 2073 656c 662c 206f  d__(mat4 self, o
-00015a30: 7468 6572 293a 0a20 2020 2020 2020 2022  ther):.        "
-00015a40: 2222 4d6f 6475 6c6f 2e0a 0a20 2020 2020  ""Modulo...     
-00015a50: 2020 203e 3e3e 204d 3d6d 6174 3428 312c     >>> M=mat4(1,
-00015a60: 322c 332c 342c 352c 362c 372c 382c 392c  2,3,4,5,6,7,8,9,
-00015a70: 3130 2c31 312c 3132 2c31 332c 3134 2c31  10,11,12,13,14,1
-00015a80: 352c 3136 290a 2020 2020 2020 2020 3e3e  5,16).        >>
-00015a90: 3e20 7072 696e 7420 4d25 352e 300a 2020  > print M%5.0.  
-00015aa0: 2020 2020 2020 5b20 2020 312e 3030 3030        [   1.0000
-00015ab0: 2c20 2020 2032 2e30 3030 302c 2020 2020  ,    2.0000,    
-00015ac0: 332e 3030 3030 2c20 2020 2034 2e30 3030  3.0000,    4.000
-00015ad0: 305d 0a20 2020 2020 2020 205b 2020 2030  0].        [   0
-00015ae0: 2e30 3030 302c 2020 2020 312e 3030 3030  .0000,    1.0000
-00015af0: 2c20 2020 2032 2e30 3030 302c 2020 2020  ,    2.0000,    
-00015b00: 332e 3030 3030 5d0a 2020 2020 2020 2020  3.0000].        
-00015b10: 5b20 2020 342e 3030 3030 2c20 2020 2030  [   4.0000,    0
-00015b20: 2e30 3030 302c 2020 2020 312e 3030 3030  .0000,    1.0000
-00015b30: 2c20 2020 2032 2e30 3030 305d 0a20 2020  ,    2.0000].   
-00015b40: 2020 2020 205b 2020 2033 2e30 3030 302c       [   3.0000,
-00015b50: 2020 2020 342e 3030 3030 2c20 2020 2030      4.0000,    0
-00015b60: 2e30 3030 302c 2020 2020 312e 3030 3030  .0000,    1.0000
-00015b70: 5d0a 2020 2020 2020 2020 2222 220a 2020  ].        """.  
-00015b80: 2020 2020 2020 6364 6566 206d 6174 3420        cdef mat4 
-00015b90: 6d62 2c20 7265 730a 0a20 2020 2020 2020  mb, res..       
-00015ba0: 2074 6220 3d20 7479 7065 286f 7468 6572   tb = type(other
-00015bb0: 290a 0a20 2020 2020 2020 2069 6620 7462  )..        if tb
-00015bc0: 2069 7320 666c 6f61 7420 6f72 2074 6220   is float or tb 
-00015bd0: 6973 2069 6e74 206f 7220 7462 2069 7320  is int or tb is 
-00015be0: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
-00015bf0: 2020 7220 3d20 6f74 6865 720a 2020 2020    r = other.    
-00015c00: 2020 2020 2020 2020 6966 2066 6162 7328          if fabs(
-00015c10: 7229 3c3d 6570 733a 0a20 2020 2020 2020  r)<=eps:.       
-00015c20: 2020 2020 2020 2020 2072 6169 7365 205a           raise Z
-00015c30: 6572 6f44 6976 6973 696f 6e45 7272 6f72  eroDivisionError
-00015c40: 2c22 6d61 7434 206d 6f64 756c 6f22 0a20  ,"mat4 modulo". 
-00015c50: 2020 2020 2020 2020 2020 2072 6573 203d             res =
-00015c60: 206d 6174 3428 290a 2020 2020 2020 2020   mat4().        
-00015c70: 2020 2020 7265 732e 6d31 3120 3d20 5f66      res.m11 = _f
-00015c80: 6d6f 6428 7365 6c66 2e6d 3131 2c20 7229  mod(self.m11, r)
-00015c90: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00015ca0: 2e6d 3132 203d 205f 666d 6f64 2873 656c  .m12 = _fmod(sel
-00015cb0: 662e 6d31 322c 2072 290a 2020 2020 2020  f.m12, r).      
-00015cc0: 2020 2020 2020 7265 732e 6d31 3320 3d20        res.m13 = 
-00015cd0: 5f66 6d6f 6428 7365 6c66 2e6d 3133 2c20  _fmod(self.m13, 
-00015ce0: 7229 0a20 2020 2020 2020 2020 2020 2072  r).            r
-00015cf0: 6573 2e6d 3134 203d 205f 666d 6f64 2873  es.m14 = _fmod(s
-00015d00: 656c 662e 6d31 342c 2072 290a 2020 2020  elf.m14, r).    
-00015d10: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
-00015d20: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3231  = _fmod(self.m21
-00015d30: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
-00015d40: 2072 6573 2e6d 3232 203d 205f 666d 6f64   res.m22 = _fmod
-00015d50: 2873 656c 662e 6d32 322c 2072 290a 2020  (self.m22, r).  
-00015d60: 2020 2020 2020 2020 2020 7265 732e 6d32            res.m2
-00015d70: 3320 3d20 5f66 6d6f 6428 7365 6c66 2e6d  3 = _fmod(self.m
-00015d80: 3233 2c20 7229 0a20 2020 2020 2020 2020  23, r).         
-00015d90: 2020 2072 6573 2e6d 3234 203d 205f 666d     res.m24 = _fm
-00015da0: 6f64 2873 656c 662e 6d32 342c 2072 290a  od(self.m24, r).
-00015db0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00015dc0: 6d33 3120 3d20 5f66 6d6f 6428 7365 6c66  m31 = _fmod(self
-00015dd0: 2e6d 3331 2c20 7229 0a20 2020 2020 2020  .m31, r).       
-00015de0: 2020 2020 2072 6573 2e6d 3332 203d 205f       res.m32 = _
-00015df0: 666d 6f64 2873 656c 662e 6d33 322c 2072  fmod(self.m32, r
-00015e00: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00015e10: 732e 6d33 3320 3d20 5f66 6d6f 6428 7365  s.m33 = _fmod(se
-00015e20: 6c66 2e6d 3333 2c20 7229 0a20 2020 2020  lf.m33, r).     
-00015e30: 2020 2020 2020 2072 6573 2e6d 3334 203d         res.m34 =
-00015e40: 205f 666d 6f64 2873 656c 662e 6d33 342c   _fmod(self.m34,
-00015e50: 2072 290a 2020 2020 2020 2020 2020 2020   r).            
-00015e60: 7265 732e 6d34 3120 3d20 5f66 6d6f 6428  res.m41 = _fmod(
-00015e70: 7365 6c66 2e6d 3431 2c20 7229 0a20 2020  self.m41, r).   
-00015e80: 2020 2020 2020 2020 2072 6573 2e6d 3432           res.m42
-00015e90: 203d 205f 666d 6f64 2873 656c 662e 6d34   = _fmod(self.m4
-00015ea0: 322c 2072 290a 2020 2020 2020 2020 2020  2, r).          
-00015eb0: 2020 7265 732e 6d34 3320 3d20 5f66 6d6f    res.m43 = _fmo
-00015ec0: 6428 7365 6c66 2e6d 3433 2c20 7229 0a20  d(self.m43, r). 
-00015ed0: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
-00015ee0: 3434 203d 205f 666d 6f64 2873 656c 662e  44 = _fmod(self.
-00015ef0: 6d34 342c 2072 290a 2020 2020 2020 2020  m44, r).        
-00015f00: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-00015f10: 2020 2020 2020 2020 656c 6966 2074 6220          elif tb 
-00015f20: 6973 206d 6174 343a 0a20 2020 2020 2020  is mat4:.       
-00015f30: 2020 2020 206d 6220 3d20 6f74 6865 720a       mb = other.
-00015f40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00015f50: 2866 6162 7328 6d62 2e6d 3131 293c 3d65  (fabs(mb.m11)<=e
-00015f60: 7073 206f 7220 6661 6273 286d 622e 6d31  ps or fabs(mb.m1
-00015f70: 3229 3c3d 6570 7320 6f72 2066 6162 7328  2)<=eps or fabs(
-00015f80: 6d62 2e6d 3133 293c 3d65 7073 206f 720a  mb.m13)<=eps or.
-00015f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015fa0: 6661 6273 286d 622e 6d31 3429 3c3d 6570  fabs(mb.m14)<=ep
-00015fb0: 7320 6f72 0a20 2020 2020 2020 2020 2020  s or.           
-00015fc0: 2020 2020 2066 6162 7328 6d62 2e6d 3231       fabs(mb.m21
-00015fd0: 293c 3d65 7073 206f 7220 6661 6273 286d  )<=eps or fabs(m
-00015fe0: 622e 6d32 3229 3c3d 6570 7320 6f72 2066  b.m22)<=eps or f
-00015ff0: 6162 7328 6d62 2e6d 3233 293c 3d65 7073  abs(mb.m23)<=eps
-00016000: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
-00016010: 2020 2020 6661 6273 286d 622e 6d32 3429      fabs(mb.m24)
-00016020: 3c3d 6570 7320 6f72 0a20 2020 2020 2020  <=eps or.       
-00016030: 2020 2020 2020 2020 2066 6162 7328 6d62           fabs(mb
-00016040: 2e6d 3331 293c 3d65 7073 206f 7220 6661  .m31)<=eps or fa
-00016050: 6273 286d 622e 6d33 3229 3c3d 6570 7320  bs(mb.m32)<=eps 
-00016060: 6f72 2066 6162 7328 6d62 2e6d 3333 293c  or fabs(mb.m33)<
-00016070: 3d65 7073 206f 720a 2020 2020 2020 2020  =eps or.        
-00016080: 2020 2020 2020 2020 6661 6273 286d 622e          fabs(mb.
-00016090: 6d33 3429 3c3d 6570 7320 6f72 0a20 2020  m34)<=eps or.   
-000160a0: 2020 2020 2020 2020 2020 2020 2066 6162               fab
-000160b0: 7328 6d62 2e6d 3431 293c 3d65 7073 206f  s(mb.m41)<=eps o
-000160c0: 7220 6661 6273 286d 622e 6d34 3229 3c3d  r fabs(mb.m42)<=
-000160d0: 6570 7320 6f72 2066 6162 7328 6d62 2e6d  eps or fabs(mb.m
-000160e0: 3433 293c 3d65 7073 206f 720a 2020 2020  43)<=eps or.    
-000160f0: 2020 2020 2020 2020 2020 2020 6661 6273              fabs
-00016100: 286d 622e 6d34 3429 3c3d 6570 7329 3a0a  (mb.m44)<=eps):.
-00016110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016120: 7261 6973 6520 5a65 726f 4469 7669 7369  raise ZeroDivisi
-00016130: 6f6e 4572 726f 722c 226d 6174 3420 6d6f  onError,"mat4 mo
-00016140: 6475 6c6f 220a 0a20 2020 2020 2020 2020  dulo"..         
-00016150: 2020 2072 6573 3d6d 6174 3428 290a 2020     res=mat4().  
-00016160: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
-00016170: 3120 3d20 5f66 6d6f 6428 7365 6c66 2e6d  1 = _fmod(self.m
-00016180: 3131 2c20 6d62 2e6d 3131 290a 2020 2020  11, mb.m11).    
-00016190: 2020 2020 2020 2020 7265 732e 6d31 3220          res.m12 
-000161a0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3132  = _fmod(self.m12
-000161b0: 2c20 6d62 2e6d 3132 290a 2020 2020 2020  , mb.m12).      
-000161c0: 2020 2020 2020 7265 732e 6d31 3320 3d20        res.m13 = 
-000161d0: 5f66 6d6f 6428 7365 6c66 2e6d 3133 2c20  _fmod(self.m13, 
-000161e0: 6d62 2e6d 3133 290a 2020 2020 2020 2020  mb.m13).        
-000161f0: 2020 2020 7265 732e 6d31 3420 3d20 5f66      res.m14 = _f
-00016200: 6d6f 6428 7365 6c66 2e6d 3134 2c20 6d62  mod(self.m14, mb
-00016210: 2e6d 3134 290a 2020 2020 2020 2020 2020  .m14).          
-00016220: 2020 7265 732e 6d32 3120 3d20 5f66 6d6f    res.m21 = _fmo
-00016230: 6428 7365 6c66 2e6d 3231 2c20 6d62 2e6d  d(self.m21, mb.m
-00016240: 3231 290a 2020 2020 2020 2020 2020 2020  21).            
-00016250: 7265 732e 6d32 3220 3d20 5f66 6d6f 6428  res.m22 = _fmod(
-00016260: 7365 6c66 2e6d 3232 2c20 6d62 2e6d 3232  self.m22, mb.m22
-00016270: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00016280: 732e 6d32 3320 3d20 5f66 6d6f 6428 7365  s.m23 = _fmod(se
-00016290: 6c66 2e6d 3233 2c20 6d62 2e6d 3233 290a  lf.m23, mb.m23).
-000162a0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-000162b0: 6d32 3420 3d20 5f66 6d6f 6428 7365 6c66  m24 = _fmod(self
-000162c0: 2e6d 3234 2c20 6d62 2e6d 3234 290a 2020  .m24, mb.m24).  
-000162d0: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
-000162e0: 3120 3d20 5f66 6d6f 6428 7365 6c66 2e6d  1 = _fmod(self.m
-000162f0: 3331 2c20 6d62 2e6d 3331 290a 2020 2020  31, mb.m31).    
-00016300: 2020 2020 2020 2020 7265 732e 6d33 3220          res.m32 
-00016310: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3332  = _fmod(self.m32
-00016320: 2c20 6d62 2e6d 3332 290a 2020 2020 2020  , mb.m32).      
-00016330: 2020 2020 2020 7265 732e 6d33 3320 3d20        res.m33 = 
-00016340: 5f66 6d6f 6428 7365 6c66 2e6d 3333 2c20  _fmod(self.m33, 
-00016350: 6d62 2e6d 3333 290a 2020 2020 2020 2020  mb.m33).        
-00016360: 2020 2020 7265 732e 6d33 3420 3d20 5f66      res.m34 = _f
-00016370: 6d6f 6428 7365 6c66 2e6d 3334 2c20 6d62  mod(self.m34, mb
-00016380: 2e6d 3334 290a 2020 2020 2020 2020 2020  .m34).          
-00016390: 2020 7265 732e 6d34 3120 3d20 5f66 6d6f    res.m41 = _fmo
-000163a0: 6428 7365 6c66 2e6d 3431 2c20 6d62 2e6d  d(self.m41, mb.m
-000163b0: 3431 290a 2020 2020 2020 2020 2020 2020  41).            
-000163c0: 7265 732e 6d34 3220 3d20 5f66 6d6f 6428  res.m42 = _fmod(
-000163d0: 7365 6c66 2e6d 3432 2c20 6d62 2e6d 3432  self.m42, mb.m42
-000163e0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-000163f0: 732e 6d34 3320 3d20 5f66 6d6f 6428 7365  s.m43 = _fmod(se
-00016400: 6c66 2e6d 3433 2c20 6d62 2e6d 3433 290a  lf.m43, mb.m43).
-00016410: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00016420: 6d34 3420 3d20 5f66 6d6f 6428 7365 6c66  m44 = _fmod(self
-00016430: 2e6d 3434 2c20 6d62 2e6d 3434 290a 2020  .m44, mb.m44).  
-00016440: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00016450: 2072 6573 0a0a 2020 2020 2020 2020 656c   res..        el
-00016460: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00016470: 7261 6973 6520 5479 7065 4572 726f 722c  raise TypeError,
-00016480: 2022 756e 7375 7070 6f72 7465 6420 6f70   "unsupported op
-00016490: 6572 616e 6420 7479 7065 2066 6f72 2025  erand type for %
-000164a0: 220a 0a0a 2020 2020 6465 6620 5f5f 6e65  "...    def __ne
-000164b0: 675f 5f28 7365 6c66 293a 0a20 2020 2020  g__(self):.     
-000164c0: 2020 2022 2222 4e65 6761 7469 6f6e 2e0a     """Negation..
-000164d0: 0a20 2020 2020 2020 203e 3e3e 204d 3d6d  .        >>> M=m
-000164e0: 6174 3428 312c 322c 332c 342c 352c 362c  at4(1,2,3,4,5,6,
-000164f0: 372c 382c 392c 3130 2c31 312c 3132 2c31  7,8,9,10,11,12,1
-00016500: 332c 3134 2c31 352c 3136 290a 2020 2020  3,14,15,16).    
-00016510: 2020 2020 3e3e 3e20 7072 696e 7420 2d4d      >>> print -M
-00016520: 0a20 2020 2020 2020 205b 2020 2d31 2e30  .        [  -1.0
-00016530: 3030 302c 2020 202d 322e 3030 3030 2c20  000,   -2.0000, 
-00016540: 2020 2d33 2e30 3030 302c 2020 202d 342e    -3.0000,   -4.
-00016550: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
-00016560: 202d 352e 3030 3030 2c20 2020 2d36 2e30   -5.0000,   -6.0
-00016570: 3030 302c 2020 202d 372e 3030 3030 2c20  000,   -7.0000, 
-00016580: 2020 2d38 2e30 3030 305d 0a20 2020 2020    -8.0000].     
-00016590: 2020 205b 2020 2d39 2e30 3030 302c 2020     [  -9.0000,  
-000165a0: 2d31 302e 3030 3030 2c20 202d 3131 2e30  -10.0000,  -11.0
-000165b0: 3030 302c 2020 2d31 322e 3030 3030 5d0a  000,  -12.0000].
-000165c0: 2020 2020 2020 2020 5b20 2d31 332e 3030          [ -13.00
-000165d0: 3030 2c20 202d 3134 2e30 3030 302c 2020  00,  -14.0000,  
-000165e0: 2d31 352e 3030 3030 2c20 202d 3136 2e30  -15.0000,  -16.0
-000165f0: 3030 305d 0a20 2020 2020 2020 2022 2222  000].        """
-00016600: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
-00016610: 7434 2072 6573 0a20 2020 2020 2020 2072  t4 res.        r
-00016620: 6573 203d 206d 6174 3428 290a 2020 2020  es = mat4().    
-00016630: 2020 2020 7265 732e 6d31 3120 3d20 2d73      res.m11 = -s
-00016640: 656c 662e 6d31 310a 2020 2020 2020 2020  elf.m11.        
-00016650: 7265 732e 6d31 3220 3d20 2d73 656c 662e  res.m12 = -self.
-00016660: 6d31 320a 2020 2020 2020 2020 7265 732e  m12.        res.
-00016670: 6d31 3320 3d20 2d73 656c 662e 6d31 330a  m13 = -self.m13.
-00016680: 2020 2020 2020 2020 7265 732e 6d31 3420          res.m14 
-00016690: 3d20 2d73 656c 662e 6d31 340a 2020 2020  = -self.m14.    
-000166a0: 2020 2020 7265 732e 6d32 3120 3d20 2d73      res.m21 = -s
-000166b0: 656c 662e 6d32 310a 2020 2020 2020 2020  elf.m21.        
-000166c0: 7265 732e 6d32 3220 3d20 2d73 656c 662e  res.m22 = -self.
-000166d0: 6d32 320a 2020 2020 2020 2020 7265 732e  m22.        res.
-000166e0: 6d32 3320 3d20 2d73 656c 662e 6d32 330a  m23 = -self.m23.
-000166f0: 2020 2020 2020 2020 7265 732e 6d32 3420          res.m24 
-00016700: 3d20 2d73 656c 662e 6d32 340a 2020 2020  = -self.m24.    
-00016710: 2020 2020 7265 732e 6d33 3120 3d20 2d73      res.m31 = -s
-00016720: 656c 662e 6d33 310a 2020 2020 2020 2020  elf.m31.        
-00016730: 7265 732e 6d33 3220 3d20 2d73 656c 662e  res.m32 = -self.
-00016740: 6d33 320a 2020 2020 2020 2020 7265 732e  m32.        res.
-00016750: 6d33 3320 3d20 2d73 656c 662e 6d33 330a  m33 = -self.m33.
-00016760: 2020 2020 2020 2020 7265 732e 6d33 3420          res.m34 
-00016770: 3d20 2d73 656c 662e 6d33 340a 2020 2020  = -self.m34.    
-00016780: 2020 2020 7265 732e 6d34 3120 3d20 2d73      res.m41 = -s
-00016790: 656c 662e 6d34 310a 2020 2020 2020 2020  elf.m41.        
-000167a0: 7265 732e 6d34 3220 3d20 2d73 656c 662e  res.m42 = -self.
-000167b0: 6d34 320a 2020 2020 2020 2020 7265 732e  m42.        res.
-000167c0: 6d34 3320 3d20 2d73 656c 662e 6d34 330a  m43 = -self.m43.
-000167d0: 2020 2020 2020 2020 7265 732e 6d34 3420          res.m44 
-000167e0: 3d20 2d73 656c 662e 6d34 340a 2020 2020  = -self.m44.    
-000167f0: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-00016800: 2020 2020 6465 6620 5f5f 706f 735f 5f28      def __pos__(
-00016810: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00016820: 2222 0a20 2020 2020 2020 203e 3e3e 204d  "".        >>> M
-00016830: 3d6d 6174 3428 312c 322c 332c 342c 352c  =mat4(1,2,3,4,5,
-00016840: 362c 372c 382c 392c 3130 2c31 312c 3132  6,7,8,9,10,11,12
-00016850: 2c31 332c 3134 2c31 352c 3136 290a 2020  ,13,14,15,16).  
-00016860: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00016870: 2b4d 0a20 2020 2020 2020 205b 2020 2031  +M.        [   1
-00016880: 2e30 3030 302c 2020 2020 322e 3030 3030  .0000,    2.0000
-00016890: 2c20 2020 2033 2e30 3030 302c 2020 2020  ,    3.0000,    
-000168a0: 342e 3030 3030 5d0a 2020 2020 2020 2020  4.0000].        
-000168b0: 5b20 2020 352e 3030 3030 2c20 2020 2036  [   5.0000,    6
-000168c0: 2e30 3030 302c 2020 2020 372e 3030 3030  .0000,    7.0000
-000168d0: 2c20 2020 2038 2e30 3030 305d 0a20 2020  ,    8.0000].   
-000168e0: 2020 2020 205b 2020 2039 2e30 3030 302c       [   9.0000,
-000168f0: 2020 2031 302e 3030 3030 2c20 2020 3131     10.0000,   11
-00016900: 2e30 3030 302c 2020 2031 322e 3030 3030  .0000,   12.0000
-00016910: 5d0a 2020 2020 2020 2020 5b20 2031 332e  ].        [  13.
-00016920: 3030 3030 2c20 2020 3134 2e30 3030 302c  0000,   14.0000,
-00016930: 2020 2031 352e 3030 3030 2c20 2020 3136     15.0000,   16
-00016940: 2e30 3030 305d 0a20 2020 2020 2020 2022  .0000].        "
-00016950: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-00016960: 6d61 7434 2072 6573 0a20 2020 2020 2020  mat4 res.       
-00016970: 2072 6573 203d 206d 6174 3428 290a 2020   res = mat4().  
-00016980: 2020 2020 2020 7265 732e 6d31 3120 3d20        res.m11 = 
-00016990: 7365 6c66 2e6d 3131 0a20 2020 2020 2020  self.m11.       
-000169a0: 2072 6573 2e6d 3132 203d 2073 656c 662e   res.m12 = self.
-000169b0: 6d31 320a 2020 2020 2020 2020 7265 732e  m12.        res.
-000169c0: 6d31 3320 3d20 7365 6c66 2e6d 3133 0a20  m13 = self.m13. 
-000169d0: 2020 2020 2020 2072 6573 2e6d 3134 203d         res.m14 =
-000169e0: 2073 656c 662e 6d31 340a 2020 2020 2020   self.m14.      
-000169f0: 2020 7265 732e 6d32 3120 3d20 7365 6c66    res.m21 = self
-00016a00: 2e6d 3231 0a20 2020 2020 2020 2072 6573  .m21.        res
-00016a10: 2e6d 3232 203d 2073 656c 662e 6d32 320a  .m22 = self.m22.
-00016a20: 2020 2020 2020 2020 7265 732e 6d32 3320          res.m23 
-00016a30: 3d20 7365 6c66 2e6d 3233 0a20 2020 2020  = self.m23.     
-00016a40: 2020 2072 6573 2e6d 3234 203d 2073 656c     res.m24 = sel
-00016a50: 662e 6d32 340a 2020 2020 2020 2020 7265  f.m24.        re
-00016a60: 732e 6d33 3120 3d20 7365 6c66 2e6d 3331  s.m31 = self.m31
-00016a70: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
-00016a80: 203d 2073 656c 662e 6d33 320a 2020 2020   = self.m32.    
-00016a90: 2020 2020 7265 732e 6d33 3320 3d20 7365      res.m33 = se
-00016aa0: 6c66 2e6d 3333 0a20 2020 2020 2020 2072  lf.m33.        r
-00016ab0: 6573 2e6d 3334 203d 2073 656c 662e 6d33  es.m34 = self.m3
-00016ac0: 340a 2020 2020 2020 2020 7265 732e 6d34  4.        res.m4
-00016ad0: 3120 3d20 7365 6c66 2e6d 3431 0a20 2020  1 = self.m41.   
-00016ae0: 2020 2020 2072 6573 2e6d 3432 203d 2073       res.m42 = s
-00016af0: 656c 662e 6d34 320a 2020 2020 2020 2020  elf.m42.        
-00016b00: 7265 732e 6d34 3320 3d20 7365 6c66 2e6d  res.m43 = self.m
-00016b10: 3433 0a20 2020 2020 2020 2072 6573 2e6d  43.        res.m
-00016b20: 3434 203d 2073 656c 662e 6d34 340a 2020  44 = self.m44.  
-00016b30: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00016b40: 0a0a 2020 2020 6465 6620 5f5f 6961 6464  ..    def __iadd
-00016b50: 5f5f 2873 656c 662c 206d 6174 3420 6f74  __(self, mat4 ot
-00016b60: 6865 7229 3a0a 2020 2020 2020 2020 2222  her):.        ""
-00016b70: 2249 6e6c 696e 6520 6d61 7472 6978 2061  "Inline matrix a
-00016b80: 6464 6974 696f 6e2e 0a20 2020 2020 2020  ddition..       
-00016b90: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
-00016ba0: 662e 6d31 3120 3d20 7365 6c66 2e6d 3131  f.m11 = self.m11
-00016bb0: 202b 206f 7468 6572 2e6d 3131 0a20 2020   + other.m11.   
-00016bc0: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
-00016bd0: 7365 6c66 2e6d 3132 202b 206f 7468 6572  self.m12 + other
-00016be0: 2e6d 3132 0a20 2020 2020 2020 2073 656c  .m12.        sel
-00016bf0: 662e 6d31 3320 3d20 7365 6c66 2e6d 3133  f.m13 = self.m13
-00016c00: 202b 206f 7468 6572 2e6d 3133 0a20 2020   + other.m13.   
-00016c10: 2020 2020 2073 656c 662e 6d31 3420 3d20       self.m14 = 
-00016c20: 7365 6c66 2e6d 3134 202b 206f 7468 6572  self.m14 + other
-00016c30: 2e6d 3134 0a20 2020 2020 2020 2073 656c  .m14.        sel
-00016c40: 662e 6d32 3120 3d20 7365 6c66 2e6d 3231  f.m21 = self.m21
-00016c50: 202b 206f 7468 6572 2e6d 3231 0a20 2020   + other.m21.   
-00016c60: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
-00016c70: 7365 6c66 2e6d 3232 202b 206f 7468 6572  self.m22 + other
-00016c80: 2e6d 3232 0a20 2020 2020 2020 2073 656c  .m22.        sel
-00016c90: 662e 6d32 3320 3d20 7365 6c66 2e6d 3233  f.m23 = self.m23
-00016ca0: 202b 206f 7468 6572 2e6d 3233 0a20 2020   + other.m23.   
-00016cb0: 2020 2020 2073 656c 662e 6d32 3420 3d20       self.m24 = 
-00016cc0: 7365 6c66 2e6d 3234 202b 206f 7468 6572  self.m24 + other
-00016cd0: 2e6d 3234 0a20 2020 2020 2020 2073 656c  .m24.        sel
-00016ce0: 662e 6d33 3120 3d20 7365 6c66 2e6d 3331  f.m31 = self.m31
-00016cf0: 202b 206f 7468 6572 2e6d 3331 0a20 2020   + other.m31.   
-00016d00: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
-00016d10: 7365 6c66 2e6d 3332 202b 206f 7468 6572  self.m32 + other
-00016d20: 2e6d 3332 0a20 2020 2020 2020 2073 656c  .m32.        sel
-00016d30: 662e 6d33 3320 3d20 7365 6c66 2e6d 3333  f.m33 = self.m33
-00016d40: 202b 206f 7468 6572 2e6d 3333 0a20 2020   + other.m33.   
-00016d50: 2020 2020 2073 656c 662e 6d33 3420 3d20       self.m34 = 
-00016d60: 7365 6c66 2e6d 3334 202b 206f 7468 6572  self.m34 + other
-00016d70: 2e6d 3334 0a20 2020 2020 2020 2073 656c  .m34.        sel
-00016d80: 662e 6d34 3120 3d20 7365 6c66 2e6d 3431  f.m41 = self.m41
-00016d90: 202b 206f 7468 6572 2e6d 3431 0a20 2020   + other.m41.   
-00016da0: 2020 2020 2073 656c 662e 6d34 3220 3d20       self.m42 = 
-00016db0: 7365 6c66 2e6d 3432 202b 206f 7468 6572  self.m42 + other
-00016dc0: 2e6d 3432 0a20 2020 2020 2020 2073 656c  .m42.        sel
-00016dd0: 662e 6d34 3320 3d20 7365 6c66 2e6d 3433  f.m43 = self.m43
-00016de0: 202b 206f 7468 6572 2e6d 3433 0a20 2020   + other.m43.   
-00016df0: 2020 2020 2073 656c 662e 6d34 3420 3d20       self.m44 = 
-00016e00: 7365 6c66 2e6d 3434 202b 206f 7468 6572  self.m44 + other
-00016e10: 2e6d 3434 0a20 2020 2020 2020 2072 6574  .m44.        ret
-00016e20: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
-00016e30: 6620 5f5f 6973 7562 5f5f 2873 656c 662c  f __isub__(self,
-00016e40: 206d 6174 3420 6f74 6865 7229 3a0a 2020   mat4 other):.  
-00016e50: 2020 2020 2020 2222 2249 6e6c 696e 6520        """Inline 
-00016e60: 6d61 7472 6978 2073 7562 7472 6163 7469  matrix subtracti
-00016e70: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
-00016e80: 2020 2020 2020 2020 7365 6c66 2e6d 3131          self.m11
-00016e90: 203d 2073 656c 662e 6d31 3120 2d20 6f74   = self.m11 - ot
-00016ea0: 6865 722e 6d31 310a 2020 2020 2020 2020  her.m11.        
-00016eb0: 7365 6c66 2e6d 3132 203d 2073 656c 662e  self.m12 = self.
-00016ec0: 6d31 3220 2d20 6f74 6865 722e 6d31 320a  m12 - other.m12.
-00016ed0: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
-00016ee0: 203d 2073 656c 662e 6d31 3320 2d20 6f74   = self.m13 - ot
-00016ef0: 6865 722e 6d31 330a 2020 2020 2020 2020  her.m13.        
-00016f00: 7365 6c66 2e6d 3134 203d 2073 656c 662e  self.m14 = self.
-00016f10: 6d31 3420 2d20 6f74 6865 722e 6d31 340a  m14 - other.m14.
-00016f20: 2020 2020 2020 2020 7365 6c66 2e6d 3231          self.m21
-00016f30: 203d 2073 656c 662e 6d32 3120 2d20 6f74   = self.m21 - ot
-00016f40: 6865 722e 6d32 310a 2020 2020 2020 2020  her.m21.        
-00016f50: 7365 6c66 2e6d 3232 203d 2073 656c 662e  self.m22 = self.
-00016f60: 6d32 3220 2d20 6f74 6865 722e 6d32 320a  m22 - other.m22.
-00016f70: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
-00016f80: 203d 2073 656c 662e 6d32 3320 2d20 6f74   = self.m23 - ot
-00016f90: 6865 722e 6d32 330a 2020 2020 2020 2020  her.m23.        
-00016fa0: 7365 6c66 2e6d 3234 203d 2073 656c 662e  self.m24 = self.
-00016fb0: 6d32 3420 2d20 6f74 6865 722e 6d32 340a  m24 - other.m24.
-00016fc0: 2020 2020 2020 2020 7365 6c66 2e6d 3331          self.m31
-00016fd0: 203d 2073 656c 662e 6d33 3120 2d20 6f74   = self.m31 - ot
-00016fe0: 6865 722e 6d33 310a 2020 2020 2020 2020  her.m31.        
-00016ff0: 7365 6c66 2e6d 3332 203d 2073 656c 662e  self.m32 = self.
-00017000: 6d33 3220 2d20 6f74 6865 722e 6d33 320a  m32 - other.m32.
-00017010: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
-00017020: 203d 2073 656c 662e 6d33 3320 2d20 6f74   = self.m33 - ot
-00017030: 6865 722e 6d33 330a 2020 2020 2020 2020  her.m33.        
-00017040: 7365 6c66 2e6d 3334 203d 2073 656c 662e  self.m34 = self.
-00017050: 6d33 3420 2d20 6f74 6865 722e 6d33 340a  m34 - other.m34.
-00017060: 2020 2020 2020 2020 7365 6c66 2e6d 3431          self.m41
-00017070: 203d 2073 656c 662e 6d34 3120 2d20 6f74   = self.m41 - ot
-00017080: 6865 722e 6d34 310a 2020 2020 2020 2020  her.m41.        
-00017090: 7365 6c66 2e6d 3432 203d 2073 656c 662e  self.m42 = self.
-000170a0: 6d34 3220 2d20 6f74 6865 722e 6d34 320a  m42 - other.m42.
-000170b0: 2020 2020 2020 2020 7365 6c66 2e6d 3433          self.m43
-000170c0: 203d 2073 656c 662e 6d34 3320 2d20 6f74   = self.m43 - ot
-000170d0: 6865 722e 6d34 330a 2020 2020 2020 2020  her.m43.        
-000170e0: 7365 6c66 2e6d 3434 203d 2073 656c 662e  self.m44 = self.
-000170f0: 6d34 3420 2d20 6f74 6865 722e 6d34 340a  m44 - other.m44.
-00017100: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00017110: 656c 660a 0a20 2020 2064 6566 205f 5f69  elf..    def __i
-00017120: 6d75 6c5f 5f28 7365 6c66 2c20 6f74 6865  mul__(self, othe
-00017130: 7229 3a0a 2020 2020 2020 2020 2222 2249  r):.        """I
-00017140: 6e6c 696e 6520 6d75 6c74 6970 6c69 6361  nline multiplica
-00017150: 7469 6f6e 2028 7363 616c 6172 206f 7220  tion (scalar or 
-00017160: 6d61 7472 6978 292e 0a20 2020 2020 2020  matrix)..       
-00017170: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-00017180: 6620 646f 7562 6c65 2072 2c20 612c 622c  f double r, a,b,
-00017190: 632c 640a 2020 2020 2020 2020 6364 6566  c,d.        cdef
-000171a0: 206d 6174 3420 6d62 0a0a 2020 2020 2020   mat4 mb..      
-000171b0: 2020 7462 203d 2074 7970 6528 6f74 6865    tb = type(othe
-000171c0: 7229 0a20 2020 2020 2020 2069 6620 7462  r).        if tb
-000171d0: 2069 7320 666c 6f61 7420 6f72 2074 6220   is float or tb 
-000171e0: 6973 2069 6e74 206f 7220 7462 2069 7320  is int or tb is 
-000171f0: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
-00017200: 2020 723d 6f74 6865 720a 2020 2020 2020    r=other.      
-00017210: 2020 2020 2020 7365 6c66 2e6d 3131 203d        self.m11 =
-00017220: 2073 656c 662e 6d31 312a 720a 2020 2020   self.m11*r.    
-00017230: 2020 2020 2020 2020 7365 6c66 2e6d 3132          self.m12
-00017240: 203d 2073 656c 662e 6d31 322a 720a 2020   = self.m12*r.  
-00017250: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00017260: 3133 203d 2073 656c 662e 6d31 332a 720a  13 = self.m13*r.
-00017270: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017280: 2e6d 3134 203d 2073 656c 662e 6d31 342a  .m14 = self.m14*
-00017290: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-000172a0: 6c66 2e6d 3231 203d 2073 656c 662e 6d32  lf.m21 = self.m2
-000172b0: 312a 720a 2020 2020 2020 2020 2020 2020  1*r.            
-000172c0: 7365 6c66 2e6d 3232 203d 2073 656c 662e  self.m22 = self.
-000172d0: 6d32 322a 720a 2020 2020 2020 2020 2020  m22*r.          
-000172e0: 2020 7365 6c66 2e6d 3233 203d 2073 656c    self.m23 = sel
-000172f0: 662e 6d32 332a 720a 2020 2020 2020 2020  f.m23*r.        
-00017300: 2020 2020 7365 6c66 2e6d 3234 203d 2073      self.m24 = s
-00017310: 656c 662e 6d32 342a 720a 2020 2020 2020  elf.m24*r.      
-00017320: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
-00017330: 2073 656c 662e 6d33 312a 720a 2020 2020   self.m31*r.    
-00017340: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
-00017350: 203d 2073 656c 662e 6d33 322a 720a 2020   = self.m32*r.  
-00017360: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00017370: 3333 203d 2073 656c 662e 6d33 332a 720a  33 = self.m33*r.
-00017380: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017390: 2e6d 3334 203d 2073 656c 662e 6d33 342a  .m34 = self.m34*
-000173a0: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-000173b0: 6c66 2e6d 3431 203d 2073 656c 662e 6d34  lf.m41 = self.m4
-000173c0: 312a 720a 2020 2020 2020 2020 2020 2020  1*r.            
-000173d0: 7365 6c66 2e6d 3432 203d 2073 656c 662e  self.m42 = self.
-000173e0: 6d34 322a 720a 2020 2020 2020 2020 2020  m42*r.          
-000173f0: 2020 7365 6c66 2e6d 3433 203d 2073 656c    self.m43 = sel
-00017400: 662e 6d34 332a 720a 2020 2020 2020 2020  f.m43*r.        
-00017410: 2020 2020 7365 6c66 2e6d 3434 203d 2073      self.m44 = s
-00017420: 656c 662e 6d34 342a 720a 2020 2020 2020  elf.m44*r.      
-00017430: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00017440: 660a 2020 2020 2020 2020 656c 6966 2074  f.        elif t
-00017450: 6220 6973 206d 6174 343a 0a20 2020 2020  b is mat4:.     
-00017460: 2020 2020 2020 206d 6220 3d20 6f74 6865         mb = othe
-00017470: 720a 2020 2020 2020 2020 2020 2020 6120  r.            a 
-00017480: 3d20 7365 6c66 2e6d 3131 0a20 2020 2020  = self.m11.     
-00017490: 2020 2020 2020 2062 203d 2073 656c 662e         b = self.
-000174a0: 6d31 320a 2020 2020 2020 2020 2020 2020  m12.            
-000174b0: 6320 3d20 7365 6c66 2e6d 3133 0a20 2020  c = self.m13.   
-000174c0: 2020 2020 2020 2020 2064 203d 2073 656c           d = sel
-000174d0: 662e 6d31 340a 2020 2020 2020 2020 2020  f.m14.          
-000174e0: 2020 7365 6c66 2e6d 3131 203d 2061 2a6d    self.m11 = a*m
-000174f0: 622e 6d31 312b 622a 6d62 2e6d 3231 2b63  b.m11+b*mb.m21+c
-00017500: 2a6d 622e 6d33 312b 642a 6d62 2e6d 3431  *mb.m31+d*mb.m41
-00017510: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00017520: 662e 6d31 3220 3d20 612a 6d62 2e6d 3132  f.m12 = a*mb.m12
-00017530: 2b62 2a6d 622e 6d32 322b 632a 6d62 2e6d  +b*mb.m22+c*mb.m
-00017540: 3332 2b64 2a6d 622e 6d34 320a 2020 2020  32+d*mb.m42.    
-00017550: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
-00017560: 203d 2061 2a6d 622e 6d31 332b 622a 6d62   = a*mb.m13+b*mb
-00017570: 2e6d 3233 2b63 2a6d 622e 6d33 332b 642a  .m23+c*mb.m33+d*
-00017580: 6d62 2e6d 3433 0a20 2020 2020 2020 2020  mb.m43.         
-00017590: 2020 2073 656c 662e 6d31 3420 3d20 612a     self.m14 = a*
-000175a0: 6d62 2e6d 3134 2b62 2a6d 622e 6d32 342b  mb.m14+b*mb.m24+
-000175b0: 632a 6d62 2e6d 3334 2b64 2a6d 622e 6d34  c*mb.m34+d*mb.m4
-000175c0: 340a 2020 2020 2020 2020 2020 2020 6120  4.            a 
-000175d0: 3d20 7365 6c66 2e6d 3231 0a20 2020 2020  = self.m21.     
-000175e0: 2020 2020 2020 2062 203d 2073 656c 662e         b = self.
-000175f0: 6d32 320a 2020 2020 2020 2020 2020 2020  m22.            
-00017600: 6320 3d20 7365 6c66 2e6d 3233 0a20 2020  c = self.m23.   
-00017610: 2020 2020 2020 2020 2064 203d 2073 656c           d = sel
-00017620: 662e 6d32 340a 2020 2020 2020 2020 2020  f.m24.          
-00017630: 2020 7365 6c66 2e6d 3231 203d 2061 2a6d    self.m21 = a*m
-00017640: 622e 6d31 312b 622a 6d62 2e6d 3231 2b63  b.m11+b*mb.m21+c
-00017650: 2a6d 622e 6d33 312b 642a 6d62 2e6d 3431  *mb.m31+d*mb.m41
-00017660: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00017670: 662e 6d32 3220 3d20 612a 6d62 2e6d 3132  f.m22 = a*mb.m12
-00017680: 2b62 2a6d 622e 6d32 322b 632a 6d62 2e6d  +b*mb.m22+c*mb.m
-00017690: 3332 2b64 2a6d 622e 6d34 320a 2020 2020  32+d*mb.m42.    
-000176a0: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
-000176b0: 203d 2061 2a6d 622e 6d31 332b 622a 6d62   = a*mb.m13+b*mb
-000176c0: 2e6d 3233 2b63 2a6d 622e 6d33 332b 642a  .m23+c*mb.m33+d*
-000176d0: 6d62 2e6d 3433 0a20 2020 2020 2020 2020  mb.m43.         
-000176e0: 2020 2073 656c 662e 6d32 3420 3d20 612a     self.m24 = a*
-000176f0: 6d62 2e6d 3134 2b62 2a6d 622e 6d32 342b  mb.m14+b*mb.m24+
-00017700: 632a 6d62 2e6d 3334 2b64 2a6d 622e 6d34  c*mb.m34+d*mb.m4
-00017710: 340a 2020 2020 2020 2020 2020 2020 6120  4.            a 
-00017720: 3d20 7365 6c66 2e6d 3331 0a20 2020 2020  = self.m31.     
-00017730: 2020 2020 2020 2062 203d 2073 656c 662e         b = self.
-00017740: 6d33 320a 2020 2020 2020 2020 2020 2020  m32.            
-00017750: 6320 3d20 7365 6c66 2e6d 3333 0a20 2020  c = self.m33.   
-00017760: 2020 2020 2020 2020 2064 203d 2073 656c           d = sel
-00017770: 662e 6d33 340a 2020 2020 2020 2020 2020  f.m34.          
-00017780: 2020 7365 6c66 2e6d 3331 203d 2061 2a6d    self.m31 = a*m
-00017790: 622e 6d31 312b 622a 6d62 2e6d 3231 2b63  b.m11+b*mb.m21+c
-000177a0: 2a6d 622e 6d33 312b 642a 6d62 2e6d 3431  *mb.m31+d*mb.m41
-000177b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000177c0: 662e 6d33 3220 3d20 612a 6d62 2e6d 3132  f.m32 = a*mb.m12
-000177d0: 2b62 2a6d 622e 6d32 322b 632a 6d62 2e6d  +b*mb.m22+c*mb.m
-000177e0: 3332 2b64 2a6d 622e 6d34 320a 2020 2020  32+d*mb.m42.    
-000177f0: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
-00017800: 203d 2061 2a6d 622e 6d31 332b 622a 6d62   = a*mb.m13+b*mb
-00017810: 2e6d 3233 2b63 2a6d 622e 6d33 332b 642a  .m23+c*mb.m33+d*
-00017820: 6d62 2e6d 3433 0a20 2020 2020 2020 2020  mb.m43.         
-00017830: 2020 2073 656c 662e 6d33 3420 3d20 612a     self.m34 = a*
-00017840: 6d62 2e6d 3134 2b62 2a6d 622e 6d32 342b  mb.m14+b*mb.m24+
-00017850: 632a 6d62 2e6d 3334 2b64 2a6d 622e 6d34  c*mb.m34+d*mb.m4
-00017860: 340a 2020 2020 2020 2020 2020 2020 6120  4.            a 
-00017870: 3d20 7365 6c66 2e6d 3431 0a20 2020 2020  = self.m41.     
-00017880: 2020 2020 2020 2062 203d 2073 656c 662e         b = self.
-00017890: 6d34 320a 2020 2020 2020 2020 2020 2020  m42.            
-000178a0: 6320 3d20 7365 6c66 2e6d 3433 0a20 2020  c = self.m43.   
-000178b0: 2020 2020 2020 2020 2064 203d 2073 656c           d = sel
-000178c0: 662e 6d34 340a 2020 2020 2020 2020 2020  f.m44.          
-000178d0: 2020 7365 6c66 2e6d 3431 203d 2061 2a6d    self.m41 = a*m
-000178e0: 622e 6d31 312b 622a 6d62 2e6d 3231 2b63  b.m11+b*mb.m21+c
-000178f0: 2a6d 622e 6d33 312b 642a 6d62 2e6d 3431  *mb.m31+d*mb.m41
-00017900: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00017910: 662e 6d34 3220 3d20 612a 6d62 2e6d 3132  f.m42 = a*mb.m12
-00017920: 2b62 2a6d 622e 6d32 322b 632a 6d62 2e6d  +b*mb.m22+c*mb.m
-00017930: 3332 2b64 2a6d 622e 6d34 320a 2020 2020  32+d*mb.m42.    
-00017940: 2020 2020 2020 2020 7365 6c66 2e6d 3433          self.m43
-00017950: 203d 2061 2a6d 622e 6d31 332b 622a 6d62   = a*mb.m13+b*mb
-00017960: 2e6d 3233 2b63 2a6d 622e 6d33 332b 642a  .m23+c*mb.m33+d*
-00017970: 6d62 2e6d 3433 0a20 2020 2020 2020 2020  mb.m43.         
-00017980: 2020 2073 656c 662e 6d34 3420 3d20 612a     self.m44 = a*
-00017990: 6d62 2e6d 3134 2b62 2a6d 622e 6d32 342b  mb.m14+b*mb.m24+
-000179a0: 632a 6d62 2e6d 3334 2b64 2a6d 622e 6d34  c*mb.m34+d*mb.m4
-000179b0: 340a 2020 2020 2020 2020 2020 2020 7265  4.            re
-000179c0: 7475 726e 2073 656c 660a 2020 2020 2020  turn self.      
-000179d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000179e0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-000179f0: 726f 722c 2022 756e 7375 7070 6f72 7465  ror, "unsupporte
-00017a00: 6420 6f70 6572 616e 6420 7479 7065 2066  d operand type f
-00017a10: 6f72 202a 3d22 0a0a 2020 2020 6465 6620  or *="..    def 
-00017a20: 5f5f 6964 6976 5f5f 2873 656c 662c 206f  __idiv__(self, o
-00017a30: 7468 6572 293a 0a20 2020 2020 2020 2022  ther):.        "
-00017a40: 2222 496e 6c69 6e65 2064 6976 6973 696f  ""Inline divisio
-00017a50: 6e20 7769 7468 2073 6361 6c61 722e 0a20  n with scalar.. 
-00017a60: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00017a70: 2020 2063 6465 6620 646f 7562 6c65 2072     cdef double r
-00017a80: 0a20 2020 2020 2020 2074 6220 3d20 7479  .        tb = ty
-00017a90: 7065 286f 7468 6572 290a 2020 2020 2020  pe(other).      
-00017aa0: 2020 6966 2074 6220 6973 2066 6c6f 6174    if tb is float
-00017ab0: 206f 7220 7462 2069 7320 696e 7420 6f72   or tb is int or
-00017ac0: 2074 6220 6973 206c 6f6e 673a 0a20 2020   tb is long:.   
-00017ad0: 2020 2020 2020 2020 2072 3d6f 7468 6572           r=other
-00017ae0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00017af0: 6661 6273 2872 293c 3d65 7073 3a0a 2020  fabs(r)<=eps:.  
-00017b00: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00017b10: 6973 6520 5a65 726f 4469 7669 7369 6f6e  ise ZeroDivision
-00017b20: 4572 726f 722c 226d 6174 3420 6469 7669  Error,"mat4 divi
-00017b30: 7369 6f6e 220a 2020 2020 2020 2020 2020  sion".          
-00017b40: 2020 7365 6c66 2e6d 3131 203d 2073 656c    self.m11 = sel
-00017b50: 662e 6d31 312f 720a 2020 2020 2020 2020  f.m11/r.        
-00017b60: 2020 2020 7365 6c66 2e6d 3132 203d 2073      self.m12 = s
-00017b70: 656c 662e 6d31 322f 720a 2020 2020 2020  elf.m12/r.      
-00017b80: 2020 2020 2020 7365 6c66 2e6d 3133 203d        self.m13 =
-00017b90: 2073 656c 662e 6d31 332f 720a 2020 2020   self.m13/r.    
-00017ba0: 2020 2020 2020 2020 7365 6c66 2e6d 3134          self.m14
-00017bb0: 203d 2073 656c 662e 6d31 342f 720a 2020   = self.m14/r.  
-00017bc0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00017bd0: 3231 203d 2073 656c 662e 6d32 312f 720a  21 = self.m21/r.
-00017be0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017bf0: 2e6d 3232 203d 2073 656c 662e 6d32 322f  .m22 = self.m22/
-00017c00: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-00017c10: 6c66 2e6d 3233 203d 2073 656c 662e 6d32  lf.m23 = self.m2
-00017c20: 332f 720a 2020 2020 2020 2020 2020 2020  3/r.            
-00017c30: 7365 6c66 2e6d 3234 203d 2073 656c 662e  self.m24 = self.
-00017c40: 6d32 342f 720a 2020 2020 2020 2020 2020  m24/r.          
-00017c50: 2020 7365 6c66 2e6d 3331 203d 2073 656c    self.m31 = sel
-00017c60: 662e 6d33 312f 720a 2020 2020 2020 2020  f.m31/r.        
-00017c70: 2020 2020 7365 6c66 2e6d 3332 203d 2073      self.m32 = s
-00017c80: 656c 662e 6d33 322f 720a 2020 2020 2020  elf.m32/r.      
-00017c90: 2020 2020 2020 7365 6c66 2e6d 3333 203d        self.m33 =
-00017ca0: 2073 656c 662e 6d33 332f 720a 2020 2020   self.m33/r.    
-00017cb0: 2020 2020 2020 2020 7365 6c66 2e6d 3334          self.m34
-00017cc0: 203d 2073 656c 662e 6d33 342f 720a 2020   = self.m34/r.  
-00017cd0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00017ce0: 3431 203d 2073 656c 662e 6d34 312f 720a  41 = self.m41/r.
-00017cf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00017d00: 2e6d 3432 203d 2073 656c 662e 6d34 322f  .m42 = self.m42/
-00017d10: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
-00017d20: 6c66 2e6d 3433 203d 2073 656c 662e 6d34  lf.m43 = self.m4
-00017d30: 332f 720a 2020 2020 2020 2020 2020 2020  3/r.            
-00017d40: 7365 6c66 2e6d 3434 203d 2073 656c 662e  self.m44 = self.
-00017d50: 6d34 342f 720a 2020 2020 2020 2020 2020  m44/r.          
-00017d60: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
-00017d70: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00017d80: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00017d90: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
-00017da0: 6f72 7465 6420 6f70 6572 616e 6420 7479  orted operand ty
-00017db0: 7065 2066 6f72 202f 3d22 0a0a 2020 2020  pe for /="..    
-00017dc0: 6465 6620 5f5f 696d 6f64 5f5f 2873 656c  def __imod__(sel
-00017dd0: 662c 2062 293a 0a20 2020 2020 2020 2022  f, b):.        "
-00017de0: 2222 496e 6c69 6e65 206d 6f64 756c 6f2e  ""Inline modulo.
-00017df0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00017e00: 2020 2020 2063 6465 6620 6d61 7434 206d       cdef mat4 m
-00017e10: 620a 2020 2020 2020 2020 6364 6566 2064  b.        cdef d
-00017e20: 6f75 626c 6520 720a 0a20 2020 2020 2020  ouble r..       
-00017e30: 2074 6220 3d20 7479 7065 2862 290a 0a20   tb = type(b).. 
-00017e40: 2020 2020 2020 2069 6620 7462 2069 7320         if tb is 
-00017e50: 666c 6f61 7420 6f72 2074 6220 6973 2069  float or tb is i
-00017e60: 6e74 206f 7220 7462 2069 7320 6c6f 6e67  nt or tb is long
-00017e70: 3a0a 2020 2020 2020 2020 2020 2020 7220  :.            r 
-00017e80: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
-00017e90: 6966 2066 6162 7328 7229 3c3d 6570 733a  if fabs(r)<=eps:
-00017ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017eb0: 2072 6169 7365 205a 6572 6f44 6976 6973   raise ZeroDivis
-00017ec0: 696f 6e45 7272 6f72 2c22 6d61 7434 206d  ionError,"mat4 m
-00017ed0: 6f64 756c 6f22 0a20 2020 2020 2020 2020  odulo".         
-00017ee0: 2020 2073 656c 662e 6d31 3120 3d20 5f66     self.m11 = _f
-00017ef0: 6d6f 6428 7365 6c66 2e6d 3131 2c20 7229  mod(self.m11, r)
-00017f00: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00017f10: 662e 6d31 3220 3d20 5f66 6d6f 6428 7365  f.m12 = _fmod(se
-00017f20: 6c66 2e6d 3132 2c20 7229 0a20 2020 2020  lf.m12, r).     
-00017f30: 2020 2020 2020 2073 656c 662e 6d31 3320         self.m13 
-00017f40: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3133  = _fmod(self.m13
-00017f50: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
-00017f60: 2073 656c 662e 6d31 3420 3d20 5f66 6d6f   self.m14 = _fmo
-00017f70: 6428 7365 6c66 2e6d 3134 2c20 7229 0a20  d(self.m14, r). 
-00017f80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00017f90: 6d32 3120 3d20 5f66 6d6f 6428 7365 6c66  m21 = _fmod(self
-00017fa0: 2e6d 3231 2c20 7229 0a20 2020 2020 2020  .m21, r).       
-00017fb0: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
-00017fc0: 5f66 6d6f 6428 7365 6c66 2e6d 3232 2c20  _fmod(self.m22, 
-00017fd0: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
-00017fe0: 656c 662e 6d32 3320 3d20 5f66 6d6f 6428  elf.m23 = _fmod(
-00017ff0: 7365 6c66 2e6d 3233 2c20 7229 0a20 2020  self.m23, r).   
-00018000: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
-00018010: 3420 3d20 5f66 6d6f 6428 7365 6c66 2e6d  4 = _fmod(self.m
-00018020: 3234 2c20 7229 0a20 2020 2020 2020 2020  24, r).         
-00018030: 2020 2073 656c 662e 6d33 3120 3d20 5f66     self.m31 = _f
-00018040: 6d6f 6428 7365 6c66 2e6d 3331 2c20 7229  mod(self.m31, r)
-00018050: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00018060: 662e 6d33 3220 3d20 5f66 6d6f 6428 7365  f.m32 = _fmod(se
-00018070: 6c66 2e6d 3332 2c20 7229 0a20 2020 2020  lf.m32, r).     
-00018080: 2020 2020 2020 2073 656c 662e 6d33 3320         self.m33 
-00018090: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3333  = _fmod(self.m33
-000180a0: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
-000180b0: 2073 656c 662e 6d33 3420 3d20 5f66 6d6f   self.m34 = _fmo
-000180c0: 6428 7365 6c66 2e6d 3334 2c20 7229 0a20  d(self.m34, r). 
-000180d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000180e0: 6d34 3120 3d20 5f66 6d6f 6428 7365 6c66  m41 = _fmod(self
-000180f0: 2e6d 3431 2c20 7229 0a20 2020 2020 2020  .m41, r).       
-00018100: 2020 2020 2073 656c 662e 6d34 3220 3d20       self.m42 = 
-00018110: 5f66 6d6f 6428 7365 6c66 2e6d 3432 2c20  _fmod(self.m42, 
-00018120: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
-00018130: 656c 662e 6d34 3320 3d20 5f66 6d6f 6428  elf.m43 = _fmod(
-00018140: 7365 6c66 2e6d 3433 2c20 7229 0a20 2020  self.m43, r).   
-00018150: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
-00018160: 3420 3d20 5f66 6d6f 6428 7365 6c66 2e6d  4 = _fmod(self.m
-00018170: 3434 2c20 7229 0a20 2020 2020 2020 2020  44, r).         
-00018180: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
-00018190: 2020 2020 2020 2065 6c69 6620 7462 2069         elif tb i
-000181a0: 7320 6d61 7434 3a0a 2020 2020 2020 2020  s mat4:.        
-000181b0: 2020 2020 6d62 203d 2062 0a20 2020 2020      mb = b.     
-000181c0: 2020 2020 2020 2069 6620 2866 6162 7328         if (fabs(
-000181d0: 6d62 2e6d 3131 293c 3d65 7073 206f 7220  mb.m11)<=eps or 
-000181e0: 6661 6273 286d 622e 6d31 3229 3c3d 6570  fabs(mb.m12)<=ep
-000181f0: 7320 6f72 2066 6162 7328 6d62 2e6d 3133  s or fabs(mb.m13
-00018200: 293c 3d65 7073 206f 720a 2020 2020 2020  )<=eps or.      
-00018210: 2020 2020 2020 2020 2020 6661 6273 286d            fabs(m
-00018220: 622e 6d31 3429 3c3d 6570 7320 6f72 0a20  b.m14)<=eps or. 
-00018230: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00018240: 6162 7328 6d62 2e6d 3231 293c 3d65 7073  abs(mb.m21)<=eps
-00018250: 206f 7220 6661 6273 286d 622e 6d32 3229   or fabs(mb.m22)
-00018260: 3c3d 6570 7320 6f72 2066 6162 7328 6d62  <=eps or fabs(mb
-00018270: 2e6d 3233 293c 3d65 7073 206f 720a 2020  .m23)<=eps or.  
-00018280: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-00018290: 6273 286d 622e 6d32 3429 3c3d 6570 7320  bs(mb.m24)<=eps 
-000182a0: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-000182b0: 2020 2066 6162 7328 6d62 2e6d 3331 293c     fabs(mb.m31)<
-000182c0: 3d65 7073 206f 7220 6661 6273 286d 622e  =eps or fabs(mb.
-000182d0: 6d33 3229 3c3d 6570 7320 6f72 2066 6162  m32)<=eps or fab
-000182e0: 7328 6d62 2e6d 3333 293c 3d65 7073 206f  s(mb.m33)<=eps o
-000182f0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-00018300: 2020 6661 6273 286d 622e 6d33 3429 3c3d    fabs(mb.m34)<=
-00018310: 6570 7320 6f72 0a20 2020 2020 2020 2020  eps or.         
-00018320: 2020 2020 2020 2066 6162 7328 6d62 2e6d         fabs(mb.m
-00018330: 3431 293c 3d65 7073 206f 7220 6661 6273  41)<=eps or fabs
-00018340: 286d 622e 6d34 3229 3c3d 6570 7320 6f72  (mb.m42)<=eps or
-00018350: 2066 6162 7328 6d62 2e6d 3433 293c 3d65   fabs(mb.m43)<=e
-00018360: 7073 206f 720a 2020 2020 2020 2020 2020  ps or.          
-00018370: 2020 2020 2020 6661 6273 286d 622e 6d34        fabs(mb.m4
-00018380: 3429 3c3d 6570 7329 3a0a 2020 2020 2020  4)<=eps):.      
-00018390: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000183a0: 5a65 726f 4469 7669 7369 6f6e 4572 726f  ZeroDivisionErro
-000183b0: 722c 226d 6174 3420 6d6f 6475 6c6f 220a  r,"mat4 modulo".
-000183c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000183d0: 2e6d 3131 203d 205f 666d 6f64 2873 656c  .m11 = _fmod(sel
-000183e0: 662e 6d31 312c 206d 622e 6d31 3129 0a20  f.m11, mb.m11). 
-000183f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00018400: 6d31 3220 3d20 5f66 6d6f 6428 7365 6c66  m12 = _fmod(self
-00018410: 2e6d 3132 2c20 6d62 2e6d 3132 290a 2020  .m12, mb.m12).  
-00018420: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00018430: 3133 203d 205f 666d 6f64 2873 656c 662e  13 = _fmod(self.
-00018440: 6d31 332c 206d 622e 6d31 3329 0a20 2020  m13, mb.m13).   
-00018450: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-00018460: 3420 3d20 5f66 6d6f 6428 7365 6c66 2e6d  4 = _fmod(self.m
-00018470: 3134 2c20 6d62 2e6d 3133 290a 2020 2020  14, mb.m13).    
-00018480: 2020 2020 2020 2020 7365 6c66 2e6d 3231          self.m21
-00018490: 203d 205f 666d 6f64 2873 656c 662e 6d32   = _fmod(self.m2
-000184a0: 312c 206d 622e 6d32 3129 0a20 2020 2020  1, mb.m21).     
-000184b0: 2020 2020 2020 2073 656c 662e 6d32 3220         self.m22 
-000184c0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3232  = _fmod(self.m22
-000184d0: 2c20 6d62 2e6d 3232 290a 2020 2020 2020  , mb.m22).      
-000184e0: 2020 2020 2020 7365 6c66 2e6d 3233 203d        self.m23 =
-000184f0: 205f 666d 6f64 2873 656c 662e 6d32 332c   _fmod(self.m23,
-00018500: 206d 622e 6d32 3329 0a20 2020 2020 2020   mb.m23).       
-00018510: 2020 2020 2073 656c 662e 6d32 3420 3d20       self.m24 = 
-00018520: 5f66 6d6f 6428 7365 6c66 2e6d 3234 2c20  _fmod(self.m24, 
-00018530: 6d62 2e6d 3233 290a 2020 2020 2020 2020  mb.m23).        
-00018540: 2020 2020 7365 6c66 2e6d 3331 203d 205f      self.m31 = _
-00018550: 666d 6f64 2873 656c 662e 6d33 312c 206d  fmod(self.m31, m
-00018560: 622e 6d33 3129 0a20 2020 2020 2020 2020  b.m31).         
-00018570: 2020 2073 656c 662e 6d33 3220 3d20 5f66     self.m32 = _f
-00018580: 6d6f 6428 7365 6c66 2e6d 3332 2c20 6d62  mod(self.m32, mb
-00018590: 2e6d 3332 290a 2020 2020 2020 2020 2020  .m32).          
-000185a0: 2020 7365 6c66 2e6d 3333 203d 205f 666d    self.m33 = _fm
-000185b0: 6f64 2873 656c 662e 6d33 332c 206d 622e  od(self.m33, mb.
-000185c0: 6d33 3329 0a20 2020 2020 2020 2020 2020  m33).           
-000185d0: 2073 656c 662e 6d33 3420 3d20 5f66 6d6f   self.m34 = _fmo
-000185e0: 6428 7365 6c66 2e6d 3334 2c20 6d62 2e6d  d(self.m34, mb.m
-000185f0: 3333 290a 2020 2020 2020 2020 2020 2020  33).            
-00018600: 7365 6c66 2e6d 3431 203d 205f 666d 6f64  self.m41 = _fmod
-00018610: 2873 656c 662e 6d34 312c 206d 622e 6d34  (self.m41, mb.m4
-00018620: 3129 0a20 2020 2020 2020 2020 2020 2073  1).            s
-00018630: 656c 662e 6d34 3220 3d20 5f66 6d6f 6428  elf.m42 = _fmod(
-00018640: 7365 6c66 2e6d 3432 2c20 6d62 2e6d 3432  self.m42, mb.m42
-00018650: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00018660: 6c66 2e6d 3433 203d 205f 666d 6f64 2873  lf.m43 = _fmod(s
-00018670: 656c 662e 6d34 332c 206d 622e 6d34 3329  elf.m43, mb.m43)
-00018680: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00018690: 662e 6d34 3420 3d20 5f66 6d6f 6428 7365  f.m44 = _fmod(se
-000186a0: 6c66 2e6d 3434 2c20 6d62 2e6d 3433 290a  lf.m44, mb.m43).
-000186b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000186c0: 726e 2073 656c 660a 2020 2020 2020 2020  rn self.        
-000186d0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000186e0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-000186f0: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
-00018700: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
-00018710: 2025 3d22 0a0a 2020 2020 6465 6620 5f5f   %="..    def __
-00018720: 6c65 6e5f 5f28 7365 6c66 293a 0a20 2020  len__(self):.   
-00018730: 2020 2020 2022 2222 4c65 6e67 7468 206f       """Length o
-00018740: 6620 7468 6520 7365 7175 656e 6365 2028  f the sequence (
-00018750: 616c 7761 7973 2034 292e 2222 220a 2020  always 4).""".  
-00018760: 2020 2020 2020 7265 7475 726e 2034 0a0a        return 4..
-00018770: 2020 2020 6465 6620 5f5f 6765 7469 7465      def __getite
-00018780: 6d5f 5f28 6d61 7434 2073 656c 662c 206b  m__(mat4 self, k
-00018790: 6579 293a 0a20 2020 2020 2020 2022 2222  ey):.        """
-000187a0: 5265 7475 726e 2061 2063 6f6c 756d 6e20  Return a column 
-000187b0: 6f72 2061 2073 696e 676c 6520 6d61 7472  or a single matr
-000187c0: 6978 2065 6c65 6d65 6e74 2e0a 2020 2020  ix element..    
-000187d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000187e0: 6364 6566 2069 6e74 2069 2c6a 0a0a 2020  cdef int i,j..  
-000187f0: 2020 2020 2020 543d 7479 7065 286b 6579        T=type(key
-00018800: 290a 2020 2020 2020 2020 6966 2054 2069  ).        if T i
-00018810: 7320 696e 7420 6f72 2054 2069 7320 6c6f  s int or T is lo
-00018820: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
-00018830: 6920 3d20 6b65 790a 2020 2020 2020 2020  i = key.        
-00018840: 2020 2020 6966 2069 3d3d 303a 0a20 2020      if i==0:.   
-00018850: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00018860: 7572 6e20 7665 6334 2873 656c 662e 6d31  urn vec4(self.m1
-00018870: 312c 2073 656c 662e 6d32 312c 2073 656c  1, self.m21, sel
-00018880: 662e 6d33 312c 2073 656c 662e 6d34 3129  f.m31, self.m41)
-00018890: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-000188a0: 6620 693d 3d31 3a0a 2020 2020 2020 2020  f i==1:.        
-000188b0: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-000188c0: 6563 3428 7365 6c66 2e6d 3132 2c20 7365  ec4(self.m12, se
-000188d0: 6c66 2e6d 3232 2c20 7365 6c66 2e6d 3332  lf.m22, self.m32
-000188e0: 2c20 7365 6c66 2e6d 3432 290a 2020 2020  , self.m42).    
-000188f0: 2020 2020 2020 2020 656c 6966 2069 3d3d          elif i==
-00018900: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-00018910: 2020 2072 6574 7572 6e20 7665 6334 2873     return vec4(s
-00018920: 656c 662e 6d31 332c 2073 656c 662e 6d32  elf.m13, self.m2
-00018930: 332c 2073 656c 662e 6d33 332c 2073 656c  3, self.m33, sel
-00018940: 662e 6d34 3329 0a20 2020 2020 2020 2020  f.m43).         
-00018950: 2020 2065 6c69 6620 693d 3d33 3a0a 2020     elif i==3:.  
-00018960: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00018970: 7475 726e 2076 6563 3428 7365 6c66 2e6d  turn vec4(self.m
-00018980: 3134 2c20 7365 6c66 2e6d 3234 2c20 7365  14, self.m24, se
-00018990: 6c66 2e6d 3334 2c20 7365 6c66 2e6d 3434  lf.m34, self.m44
-000189a0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-000189b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000189c0: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
-000189d0: 7272 6f72 2c20 2269 6e64 6578 206f 7574  rror, "index out
-000189e0: 206f 6620 7261 6e67 6522 0a20 2020 2020   of range".     
-000189f0: 2020 2065 6c69 6620 5420 6973 2074 7570     elif T is tup
-00018a00: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-00018a10: 6966 206c 656e 286b 6579 2921 3d32 3a0a  if len(key)!=2:.
-00018a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018a30: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00018a40: 2c20 2269 6e64 6578 2074 7570 6c65 206d  , "index tuple m
-00018a50: 7573 7420 6265 2061 2032 2d74 7570 6c65  ust be a 2-tuple
-00018a60: 220a 2020 2020 2020 2020 2020 2020 6920  ".            i 
-00018a70: 3d20 6b65 795b 305d 0a20 2020 2020 2020  = key[0].       
-00018a80: 2020 2020 206a 203d 206b 6579 5b31 5d0a       j = key[1].
-00018a90: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00018aa0: 3c30 206f 7220 693e 3320 6f72 206a 3c30  <0 or i>3 or j<0
-00018ab0: 206f 7220 6a3e 333a 0a20 2020 2020 2020   or j>3:.       
-00018ac0: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
-00018ad0: 6e64 6578 4572 726f 722c 2022 696e 6465  ndexError, "inde
-00018ae0: 7820 6f75 7420 6f66 2072 616e 6765 220a  x out of range".
-00018af0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00018b00: 693d 3d30 3a0a 2020 2020 2020 2020 2020  i==0:.          
-00018b10: 2020 2020 2020 6966 206a 3d3d 303a 0a20        if j==0:. 
-00018b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b30: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00018b40: 3131 0a20 2020 2020 2020 2020 2020 2020  11.             
-00018b50: 2020 2065 6c69 6620 6a3d 3d31 3a0a 2020     elif j==1:.  
-00018b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b70: 2020 7265 7475 726e 2073 656c 662e 6d31    return self.m1
-00018b80: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
-00018b90: 2020 656c 6966 206a 3d3d 323a 0a20 2020    elif j==2:.   
-00018ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018bb0: 2072 6574 7572 6e20 7365 6c66 2e6d 3133   return self.m13
-00018bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018bd0: 2065 6c69 6620 6a3d 3d33 3a0a 2020 2020   elif j==3:.    
-00018be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018bf0: 7265 7475 726e 2073 656c 662e 6d31 340a  return self.m14.
-00018c00: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00018c10: 2069 3d3d 313a 0a20 2020 2020 2020 2020   i==1:.         
-00018c20: 2020 2020 2020 2069 6620 6a3d 3d30 3a0a         if j==0:.
-00018c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018c40: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00018c50: 6d32 310a 2020 2020 2020 2020 2020 2020  m21.            
-00018c60: 2020 2020 656c 6966 206a 3d3d 313a 0a20      elif j==1:. 
-00018c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018c80: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00018c90: 3232 0a20 2020 2020 2020 2020 2020 2020  22.             
-00018ca0: 2020 2065 6c69 6620 6a3d 3d32 3a0a 2020     elif j==2:.  
-00018cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018cc0: 2020 7265 7475 726e 2073 656c 662e 6d32    return self.m2
-00018cd0: 330a 2020 2020 2020 2020 2020 2020 2020  3.              
-00018ce0: 2020 656c 6966 206a 3d3d 333a 0a20 2020    elif j==3:.   
-00018cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d00: 2072 6574 7572 6e20 7365 6c66 2e6d 3234   return self.m24
-00018d10: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00018d20: 6620 693d 3d32 3a0a 2020 2020 2020 2020  f i==2:.        
-00018d30: 2020 2020 2020 2020 6966 206a 3d3d 303a          if j==0:
-00018d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018d50: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00018d60: 2e6d 3331 0a20 2020 2020 2020 2020 2020  .m31.           
-00018d70: 2020 2020 2065 6c69 6620 6a3d 3d31 3a0a       elif j==1:.
-00018d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d90: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00018da0: 6d33 320a 2020 2020 2020 2020 2020 2020  m32.            
-00018db0: 2020 2020 656c 6966 206a 3d3d 323a 0a20      elif j==2:. 
-00018dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018dd0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00018de0: 3333 0a20 2020 2020 2020 2020 2020 2020  33.             
-00018df0: 2020 2065 6c69 6620 6a3d 3d33 3a0a 2020     elif j==3:.  
-00018e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e10: 2020 7265 7475 726e 2073 656c 662e 6d33    return self.m3
-00018e20: 340a 2020 2020 2020 2020 2020 2020 656c  4.            el
-00018e30: 6966 2069 3d3d 333a 0a20 2020 2020 2020  if i==3:.       
-00018e40: 2020 2020 2020 2020 2069 6620 6a3d 3d30           if j==0
-00018e50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00018e60: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00018e70: 662e 6d34 310a 2020 2020 2020 2020 2020  f.m41.          
-00018e80: 2020 2020 2020 656c 6966 206a 3d3d 313a        elif j==1:
-00018e90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018ea0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00018eb0: 2e6d 3432 0a20 2020 2020 2020 2020 2020  .m42.           
-00018ec0: 2020 2020 2065 6c69 6620 6a3d 3d32 3a0a       elif j==2:.
-00018ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ee0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00018ef0: 6d34 330a 2020 2020 2020 2020 2020 2020  m43.            
-00018f00: 2020 2020 656c 6966 206a 3d3d 333a 0a20      elif j==3:. 
-00018f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018f20: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00018f30: 3434 0a20 2020 2020 2020 2065 6c73 653a  44.        else:
-00018f40: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00018f50: 7365 2054 7970 6545 7272 6f72 2c22 696e  se TypeError,"in
-00018f60: 6465 7820 6d75 7374 2062 6520 696e 7465  dex must be inte
-00018f70: 6765 7220 6f72 2032 2d74 7570 6c65 220a  ger or 2-tuple".
-00018f80: 0a20 2020 2064 6566 205f 5f73 6574 6974  .    def __setit
-00018f90: 656d 5f5f 2873 656c 662c 206b 6579 2c20  em__(self, key, 
-00018fa0: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
-00018fb0: 2222 2253 6574 2061 2063 6f6c 756d 6e20  """Set a column 
-00018fc0: 6f72 2061 2073 696e 676c 6520 6d61 7472  or a single matr
-00018fd0: 6978 2065 6c65 6d65 6e74 2e0a 0a20 2020  ix element...   
-00018fe0: 2020 2020 2054 6865 2063 6f6c 756d 6e20       The column 
-00018ff0: 6d75 7374 2062 6520 6769 7665 6e20 6173  must be given as
-00019000: 2061 2034 2d73 6571 7565 6e63 6520 2874   a 4-sequence (t
-00019010: 6869 7320 696e 636c 7564 6573 2076 6563  his includes vec
-00019020: 3420 6173 2077 656c 6c29 2e0a 2020 2020  4 as well)..    
-00019030: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00019040: 6364 6566 2069 6e74 2069 2c6a 0a20 2020  cdef int i,j.   
-00019050: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
-00019060: 2076 0a0a 2020 2020 2020 2020 543d 7479   v..        T=ty
-00019070: 7065 286b 6579 290a 2020 2020 2020 2020  pe(key).        
-00019080: 6966 2054 2069 7320 696e 7420 6f72 2054  if T is int or T
-00019090: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
-000190a0: 2020 2020 2020 6966 206c 656e 2876 616c        if len(val
-000190b0: 7565 2921 3d34 3a0a 2020 2020 2020 2020  ue)!=4:.        
-000190c0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-000190d0: 6c75 6545 7272 6f72 2c20 2234 2d73 6571  lueError, "4-seq
-000190e0: 7565 6e63 6520 6578 7065 6374 6564 220a  uence expected".
-000190f0: 2020 2020 2020 2020 2020 2020 6920 3d20              i = 
-00019100: 6b65 790a 2020 2020 2020 2020 2020 2020  key.            
-00019110: 6966 2069 3d3d 303a 0a20 2020 2020 2020  if i==0:.       
-00019120: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-00019130: 3120 3d20 7661 6c75 655b 305d 0a20 2020  1 = value[0].   
-00019140: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00019150: 662e 6d32 3120 3d20 7661 6c75 655b 315d  f.m21 = value[1]
-00019160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019170: 2073 656c 662e 6d33 3120 3d20 7661 6c75   self.m31 = valu
-00019180: 655b 325d 0a20 2020 2020 2020 2020 2020  e[2].           
-00019190: 2020 2020 2073 656c 662e 6d34 3120 3d20       self.m41 = 
-000191a0: 7661 6c75 655b 335d 0a20 2020 2020 2020  value[3].       
-000191b0: 2020 2020 2065 6c69 6620 693d 3d31 3a0a       elif i==1:.
-000191c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000191d0: 7365 6c66 2e6d 3132 203d 2076 616c 7565  self.m12 = value
-000191e0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-000191f0: 2020 2020 7365 6c66 2e6d 3232 203d 2076      self.m22 = v
-00019200: 616c 7565 5b31 5d0a 2020 2020 2020 2020  alue[1].        
-00019210: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
-00019220: 203d 2076 616c 7565 5b32 5d0a 2020 2020   = value[2].    
-00019230: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00019240: 2e6d 3432 203d 2076 616c 7565 5b33 5d0a  .m42 = value[3].
-00019250: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00019260: 2069 3d3d 323a 0a20 2020 2020 2020 2020   i==2:.         
-00019270: 2020 2020 2020 2073 656c 662e 6d31 3320         self.m13 
-00019280: 3d20 7661 6c75 655b 305d 0a20 2020 2020  = value[0].     
-00019290: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000192a0: 6d32 3320 3d20 7661 6c75 655b 315d 0a20  m23 = value[1]. 
-000192b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000192c0: 656c 662e 6d33 3320 3d20 7661 6c75 655b  elf.m33 = value[
-000192d0: 325d 0a20 2020 2020 2020 2020 2020 2020  2].             
-000192e0: 2020 2073 656c 662e 6d34 3320 3d20 7661     self.m43 = va
-000192f0: 6c75 655b 335d 0a20 2020 2020 2020 2020  lue[3].         
-00019300: 2020 2065 6c69 6620 693d 3d33 3a0a 2020     elif i==3:.  
-00019310: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00019320: 6c66 2e6d 3134 203d 2076 616c 7565 5b30  lf.m14 = value[0
-00019330: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00019340: 2020 7365 6c66 2e6d 3234 203d 2076 616c    self.m24 = val
-00019350: 7565 5b31 5d0a 2020 2020 2020 2020 2020  ue[1].          
-00019360: 2020 2020 2020 7365 6c66 2e6d 3334 203d        self.m34 =
-00019370: 2076 616c 7565 5b32 5d0a 2020 2020 2020   value[2].      
-00019380: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00019390: 3434 203d 2076 616c 7565 5b33 5d0a 2020  44 = value[3].  
-000193a0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-000193b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000193c0: 7261 6973 6520 496e 6465 7845 7272 6f72  raise IndexError
-000193d0: 2c20 2269 6e64 6578 206f 7574 206f 6620  , "index out of 
-000193e0: 7261 6e67 6522 0a20 2020 2020 2020 2065  range".        e
-000193f0: 6c69 6620 5420 6973 2074 7570 6c65 3a0a  lif T is tuple:.
-00019400: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00019410: 656e 286b 6579 2921 3d32 3a0a 2020 2020  en(key)!=2:.    
-00019420: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00019430: 6520 5661 6c75 6545 7272 6f72 2c20 2269  e ValueError, "i
-00019440: 6e64 6578 2074 7570 6c65 206d 7573 7420  ndex tuple must 
-00019450: 6265 2061 2032 2d74 7570 6c65 220a 2020  be a 2-tuple".  
-00019460: 2020 2020 2020 2020 2020 6920 3d20 6b65            i = ke
-00019470: 795b 305d 0a20 2020 2020 2020 2020 2020  y[0].           
-00019480: 206a 203d 206b 6579 5b31 5d0a 2020 2020   j = key[1].    
-00019490: 2020 2020 2020 2020 7620 3d20 7661 6c75          v = valu
-000194a0: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
-000194b0: 2069 3c30 206f 7220 693e 3320 6f72 206a   i<0 or i>3 or j
-000194c0: 3c30 206f 7220 6a3e 333a 0a20 2020 2020  <0 or j>3:.     
-000194d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000194e0: 2049 6e64 6578 4572 726f 722c 2022 696e   IndexError, "in
-000194f0: 6465 7820 6f75 7420 6f66 2072 616e 6765  dex out of range
-00019500: 220a 0a20 2020 2020 2020 2020 2020 2069  "..            i
-00019510: 6620 693d 3d30 3a0a 2020 2020 2020 2020  f i==0:.        
-00019520: 2020 2020 2020 2020 6966 206a 3d3d 303a          if j==0:
-00019530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019540: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
-00019550: 760a 2020 2020 2020 2020 2020 2020 2020  v.              
-00019560: 2020 656c 6966 206a 3d3d 313a 0a20 2020    elif j==1:.   
-00019570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019580: 2073 656c 662e 6d31 3220 3d20 760a 2020   self.m12 = v.  
-00019590: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000195a0: 6966 206a 3d3d 323a 0a20 2020 2020 2020  if j==2:.       
-000195b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000195c0: 662e 6d31 3320 3d20 760a 2020 2020 2020  f.m13 = v.      
-000195d0: 2020 2020 2020 2020 2020 656c 6966 206a            elif j
-000195e0: 3d3d 333a 0a20 2020 2020 2020 2020 2020  ==3:.           
-000195f0: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
-00019600: 3420 3d20 760a 2020 2020 2020 2020 2020  4 = v.          
-00019610: 2020 656c 6966 2069 3d3d 313a 0a20 2020    elif i==1:.   
-00019620: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00019630: 6a3d 3d30 3a0a 2020 2020 2020 2020 2020  j==0:.          
-00019640: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-00019650: 3231 203d 2076 0a20 2020 2020 2020 2020  21 = v.         
-00019660: 2020 2020 2020 2065 6c69 6620 6a3d 3d31         elif j==1
-00019670: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00019680: 2020 2020 2020 7365 6c66 2e6d 3232 203d        self.m22 =
-00019690: 2076 0a20 2020 2020 2020 2020 2020 2020   v.             
-000196a0: 2020 2065 6c69 6620 6a3d 3d32 3a0a 2020     elif j==2:.  
-000196b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000196c0: 2020 7365 6c66 2e6d 3233 203d 2076 0a20    self.m23 = v. 
-000196d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000196e0: 6c69 6620 6a3d 3d33 3a0a 2020 2020 2020  lif j==3:.      
-000196f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00019700: 6c66 2e6d 3234 203d 2076 0a20 2020 2020  lf.m24 = v.     
-00019710: 2020 2020 2020 2065 6c69 6620 693d 3d32         elif i==2
-00019720: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00019730: 2020 6966 206a 3d3d 303a 0a20 2020 2020    if j==0:.     
-00019740: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00019750: 656c 662e 6d33 3120 3d20 760a 2020 2020  elf.m31 = v.    
-00019760: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00019770: 206a 3d3d 313a 0a20 2020 2020 2020 2020   j==1:.         
-00019780: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00019790: 6d33 3220 3d20 760a 2020 2020 2020 2020  m32 = v.        
-000197a0: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
-000197b0: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-000197c0: 2020 2020 2020 2073 656c 662e 6d33 3320         self.m33 
-000197d0: 3d20 760a 2020 2020 2020 2020 2020 2020  = v.            
-000197e0: 2020 2020 656c 6966 206a 3d3d 333a 0a20      elif j==3:. 
-000197f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019800: 2020 2073 656c 662e 6d33 3420 3d20 760a     self.m34 = v.
-00019810: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00019820: 2069 3d3d 333a 0a20 2020 2020 2020 2020   i==3:.         
-00019830: 2020 2020 2020 2069 6620 6a3d 3d30 3a0a         if j==0:.
-00019840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019850: 2020 2020 7365 6c66 2e6d 3431 203d 2076      self.m41 = v
-00019860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019870: 2065 6c69 6620 6a3d 3d31 3a0a 2020 2020   elif j==1:.    
-00019880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019890: 7365 6c66 2e6d 3432 203d 2076 0a20 2020  self.m42 = v.   
-000198a0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-000198b0: 6620 6a3d 3d32 3a0a 2020 2020 2020 2020  f j==2:.        
-000198c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000198d0: 2e6d 3433 203d 2076 0a20 2020 2020 2020  .m43 = v.       
-000198e0: 2020 2020 2020 2020 2065 6c69 6620 6a3d           elif j=
-000198f0: 3d33 3a0a 2020 2020 2020 2020 2020 2020  =3:.            
-00019900: 2020 2020 2020 2020 7365 6c66 2e6d 3434          self.m44
-00019910: 203d 2076 0a20 2020 2020 2020 2065 6c73   = v.        els
-00019920: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00019930: 6169 7365 2054 7970 6545 7272 6f72 2c22  aise TypeError,"
-00019940: 696e 6465 7820 6d75 7374 2062 6520 696e  index must be in
-00019950: 7465 6765 7220 6f72 2032 2d74 7570 6c65  teger or 2-tuple
-00019960: 220a 0a20 2020 2064 6566 2067 6574 526f  "..    def getRo
-00019970: 7728 7365 6c66 2c20 6964 7829 3a0a 2020  w(self, idx):.  
-00019980: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-00019990: 726f 7720 2861 7320 7665 6334 292e 2222  row (as vec4).""
-000199a0: 220a 2020 2020 2020 2020 6364 6566 2069  ".        cdef i
-000199b0: 6e74 2069 0a0a 2020 2020 2020 2020 543d  nt i..        T=
-000199c0: 7479 7065 2869 6478 290a 2020 2020 2020  type(idx).      
-000199d0: 2020 6966 2054 213d 696e 7420 616e 6420    if T!=int and 
-000199e0: 5421 3d6c 6f6e 673a 0a20 2020 2020 2020  T!=long:.       
-000199f0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00019a00: 7272 6f72 2c22 696e 6465 7820 6d75 7374  rror,"index must
-00019a10: 2062 6520 696e 7465 6765 7222 0a0a 2020   be integer"..  
-00019a20: 2020 2020 2020 6920 3d20 6964 780a 2020        i = idx.  
-00019a30: 2020 2020 2020 6966 2069 3d3d 303a 0a20        if i==0:. 
-00019a40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00019a50: 6e20 7665 6334 2873 656c 662e 6d31 312c  n vec4(self.m11,
-00019a60: 2073 656c 662e 6d31 322c 2073 656c 662e   self.m12, self.
-00019a70: 6d31 332c 2073 656c 662e 6d31 3429 0a20  m13, self.m14). 
-00019a80: 2020 2020 2020 2065 6c69 6620 693d 3d31         elif i==1
-00019a90: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00019aa0: 7475 726e 2076 6563 3428 7365 6c66 2e6d  turn vec4(self.m
-00019ab0: 3231 2c20 7365 6c66 2e6d 3232 2c20 7365  21, self.m22, se
-00019ac0: 6c66 2e6d 3233 2c20 7365 6c66 2e6d 3234  lf.m23, self.m24
-00019ad0: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-00019ae0: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
-00019af0: 2072 6574 7572 6e20 7665 6334 2873 656c   return vec4(sel
-00019b00: 662e 6d33 312c 2073 656c 662e 6d33 322c  f.m31, self.m32,
-00019b10: 2073 656c 662e 6d33 332c 2073 656c 662e   self.m33, self.
-00019b20: 6d33 3429 0a20 2020 2020 2020 2065 6c69  m34).        eli
-00019b30: 6620 693d 3d33 3a0a 2020 2020 2020 2020  f i==3:.        
-00019b40: 2020 2020 7265 7475 726e 2076 6563 3428      return vec4(
-00019b50: 7365 6c66 2e6d 3431 2c20 7365 6c66 2e6d  self.m41, self.m
-00019b60: 3432 2c20 7365 6c66 2e6d 3433 2c20 7365  42, self.m43, se
-00019b70: 6c66 2e6d 3434 290a 2020 2020 2020 2020  lf.m44).        
-00019b80: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00019b90: 2020 7261 6973 6520 496e 6465 7845 7272    raise IndexErr
-00019ba0: 6f72 2c20 2269 6e64 6578 206f 7574 206f  or, "index out o
-00019bb0: 6620 7261 6e67 6522 0a0a 2020 2020 6465  f range"..    de
-00019bc0: 6620 7365 7452 6f77 2873 656c 662c 2069  f setRow(self, i
-00019bd0: 6478 2c20 7661 6c75 6529 3a0a 2020 2020  dx, value):.    
-00019be0: 2020 2020 2222 2253 6574 2072 6f77 2e22      """Set row."
-00019bf0: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-00019c00: 696e 7420 690a 0a20 2020 2020 2020 2054  int i..        T
-00019c10: 3d74 7970 6528 6964 7829 0a20 2020 2020  =type(idx).     
-00019c20: 2020 2069 6620 5421 3d69 6e74 2061 6e64     if T!=int and
-00019c30: 2054 213d 6c6f 6e67 3a0a 2020 2020 2020   T!=long:.      
-00019c40: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00019c50: 4572 726f 722c 2269 6e64 6578 206d 7573  Error,"index mus
-00019c60: 7420 6265 2069 6e74 6567 6572 220a 0a20  t be integer".. 
-00019c70: 2020 2020 2020 2069 6620 6c65 6e28 7661         if len(va
-00019c80: 6c75 6529 213d 343a 0a20 2020 2020 2020  lue)!=4:.       
-00019c90: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00019ca0: 4572 726f 722c 2022 342d 7365 7175 656e  Error, "4-sequen
-00019cb0: 6365 2065 7870 6563 7465 6422 0a0a 2020  ce expected"..  
-00019cc0: 2020 2020 2020 6920 3d20 6964 780a 2020        i = idx.  
-00019cd0: 2020 2020 2020 6966 2069 3d3d 303a 0a20        if i==0:. 
-00019ce0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00019cf0: 6d31 3120 3d20 7661 6c75 655b 305d 0a20  m11 = value[0]. 
-00019d00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00019d10: 6d31 3220 3d20 7661 6c75 655b 315d 0a20  m12 = value[1]. 
-00019d20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00019d30: 6d31 3320 3d20 7661 6c75 655b 325d 0a20  m13 = value[2]. 
-00019d40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00019d50: 6d31 3420 3d20 7661 6c75 655b 335d 0a20  m14 = value[3]. 
-00019d60: 2020 2020 2020 2065 6c69 6620 693d 3d31         elif i==1
-00019d70: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00019d80: 6c66 2e6d 3231 203d 2076 616c 7565 5b30  lf.m21 = value[0
-00019d90: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-00019da0: 6c66 2e6d 3232 203d 2076 616c 7565 5b31  lf.m22 = value[1
-00019db0: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-00019dc0: 6c66 2e6d 3233 203d 2076 616c 7565 5b32  lf.m23 = value[2
-00019dd0: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-00019de0: 6c66 2e6d 3234 203d 2076 616c 7565 5b33  lf.m24 = value[3
-00019df0: 5d0a 2020 2020 2020 2020 656c 6966 2069  ].        elif i
-00019e00: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
-00019e10: 2073 656c 662e 6d33 3120 3d20 7661 6c75   self.m31 = valu
-00019e20: 655b 305d 0a20 2020 2020 2020 2020 2020  e[0].           
-00019e30: 2073 656c 662e 6d33 3220 3d20 7661 6c75   self.m32 = valu
-00019e40: 655b 315d 0a20 2020 2020 2020 2020 2020  e[1].           
-00019e50: 2073 656c 662e 6d33 3320 3d20 7661 6c75   self.m33 = valu
-00019e60: 655b 325d 0a20 2020 2020 2020 2020 2020  e[2].           
-00019e70: 2073 656c 662e 6d33 3420 3d20 7661 6c75   self.m34 = valu
-00019e80: 655b 335d 0a20 2020 2020 2020 2065 6c69  e[3].        eli
-00019e90: 6620 693d 3d33 3a0a 2020 2020 2020 2020  f i==3:.        
-00019ea0: 2020 2020 7365 6c66 2e6d 3431 203d 2076      self.m41 = v
-00019eb0: 616c 7565 5b30 5d0a 2020 2020 2020 2020  alue[0].        
-00019ec0: 2020 2020 7365 6c66 2e6d 3432 203d 2076      self.m42 = v
-00019ed0: 616c 7565 5b31 5d0a 2020 2020 2020 2020  alue[1].        
-00019ee0: 2020 2020 7365 6c66 2e6d 3433 203d 2076      self.m43 = v
-00019ef0: 616c 7565 5b32 5d0a 2020 2020 2020 2020  alue[2].        
-00019f00: 2020 2020 7365 6c66 2e6d 3434 203d 2076      self.m44 = v
-00019f10: 616c 7565 5b33 5d0a 2020 2020 2020 2020  alue[3].        
-00019f20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00019f30: 2020 7261 6973 6520 496e 6465 7845 7272    raise IndexErr
-00019f40: 6f72 2c20 2269 6e64 6578 206f 7574 206f  or, "index out o
-00019f50: 6620 7261 6e67 6522 0a0a 2020 2020 6465  f range"..    de
-00019f60: 6620 6765 7443 6f6c 756d 6e28 7365 6c66  f getColumn(self
-00019f70: 2c20 6964 7829 3a0a 2020 2020 2020 2020  , idx):.        
-00019f80: 2222 2252 6574 7572 6e20 636f 6c75 6d6e  """Return column
-00019f90: 2028 6173 2076 6563 3429 2e22 2222 0a20   (as vec4).""". 
-00019fa0: 2020 2020 2020 2063 6465 6620 696e 7420         cdef int 
-00019fb0: 690a 0a20 2020 2020 2020 2054 3d74 7970  i..        T=typ
-00019fc0: 6528 6964 7829 0a20 2020 2020 2020 2069  e(idx).        i
-00019fd0: 6620 5421 3d69 6e74 2061 6e64 2054 213d  f T!=int and T!=
-00019fe0: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
-00019ff0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-0001a000: 722c 2269 6e64 6578 206d 7573 7420 6265  r,"index must be
-0001a010: 2069 6e74 6567 6572 220a 0a20 2020 2020   integer"..     
-0001a020: 2020 2069 203d 2069 6478 0a20 2020 2020     i = idx.     
-0001a030: 2020 2069 6620 693d 3d30 3a0a 2020 2020     if i==0:.    
-0001a040: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-0001a050: 6563 3428 7365 6c66 2e6d 3131 2c20 7365  ec4(self.m11, se
-0001a060: 6c66 2e6d 3231 2c20 7365 6c66 2e6d 3331  lf.m21, self.m31
-0001a070: 2c20 7365 6c66 2e6d 3431 290a 2020 2020  , self.m41).    
-0001a080: 2020 2020 656c 6966 2069 3d3d 313a 0a20      elif i==1:. 
-0001a090: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001a0a0: 6e20 7665 6334 2873 656c 662e 6d31 322c  n vec4(self.m12,
-0001a0b0: 2073 656c 662e 6d32 322c 2073 656c 662e   self.m22, self.
-0001a0c0: 6d33 322c 2073 656c 662e 6d34 3229 0a20  m32, self.m42). 
-0001a0d0: 2020 2020 2020 2065 6c69 6620 693d 3d32         elif i==2
-0001a0e0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0001a0f0: 7475 726e 2076 6563 3428 7365 6c66 2e6d  turn vec4(self.m
-0001a100: 3133 2c20 7365 6c66 2e6d 3233 2c20 7365  13, self.m23, se
-0001a110: 6c66 2e6d 3333 2c20 7365 6c66 2e6d 3433  lf.m33, self.m43
-0001a120: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-0001a130: 3d3d 333a 0a20 2020 2020 2020 2020 2020  ==3:.           
-0001a140: 2072 6574 7572 6e20 7665 6334 2873 656c   return vec4(sel
-0001a150: 662e 6d31 342c 2073 656c 662e 6d32 342c  f.m14, self.m24,
-0001a160: 2073 656c 662e 6d33 342c 2073 656c 662e   self.m34, self.
-0001a170: 6d34 3429 0a20 2020 2020 2020 2065 6c73  m44).        els
-0001a180: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0001a190: 6169 7365 2049 6e64 6578 4572 726f 722c  aise IndexError,
-0001a1a0: 2022 696e 6465 7820 6f75 7420 6f66 2072   "index out of r
-0001a1b0: 616e 6765 220a 0a20 2020 2064 6566 2073  ange"..    def s
-0001a1c0: 6574 436f 6c75 6d6e 2873 656c 662c 2069  etColumn(self, i
-0001a1d0: 6478 2c20 7661 6c75 6529 3a0a 2020 2020  dx, value):.    
-0001a1e0: 2020 2020 2222 2253 6574 2063 6f6c 756d      """Set colum
-0001a1f0: 6e2e 2222 220a 2020 2020 2020 2020 6364  n.""".        cd
-0001a200: 6566 2069 6e74 2069 0a0a 2020 2020 2020  ef int i..      
-0001a210: 2020 543d 7479 7065 2869 6478 290a 2020    T=type(idx).  
-0001a220: 2020 2020 2020 6966 2054 213d 696e 7420        if T!=int 
-0001a230: 616e 6420 5421 3d6c 6f6e 673a 0a20 2020  and T!=long:.   
-0001a240: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0001a250: 7970 6545 7272 6f72 2c22 696e 6465 7820  ypeError,"index 
-0001a260: 6d75 7374 2062 6520 696e 7465 6765 7222  must be integer"
-0001a270: 0a0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
-0001a280: 2876 616c 7565 2921 3d34 3a0a 2020 2020  (value)!=4:.    
-0001a290: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0001a2a0: 6c75 6545 7272 6f72 2c20 2234 2d73 6571  lueError, "4-seq
-0001a2b0: 7565 6e63 6520 6578 7065 6374 6564 220a  uence expected".
-0001a2c0: 0a20 2020 2020 2020 2069 203d 2069 6478  .        i = idx
-0001a2d0: 0a20 2020 2020 2020 2069 6620 693d 3d30  .        if i==0
-0001a2e0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0001a2f0: 6c66 2e6d 3131 203d 2076 616c 7565 5b30  lf.m11 = value[0
-0001a300: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0001a310: 6c66 2e6d 3231 203d 2076 616c 7565 5b31  lf.m21 = value[1
-0001a320: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0001a330: 6c66 2e6d 3331 203d 2076 616c 7565 5b32  lf.m31 = value[2
-0001a340: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0001a350: 6c66 2e6d 3431 203d 2076 616c 7565 5b33  lf.m41 = value[3
-0001a360: 5d0a 2020 2020 2020 2020 656c 6966 2069  ].        elif i
-0001a370: 3d3d 313a 0a20 2020 2020 2020 2020 2020  ==1:.           
-0001a380: 2073 656c 662e 6d31 3220 3d20 7661 6c75   self.m12 = valu
-0001a390: 655b 305d 0a20 2020 2020 2020 2020 2020  e[0].           
-0001a3a0: 2073 656c 662e 6d32 3220 3d20 7661 6c75   self.m22 = valu
-0001a3b0: 655b 315d 0a20 2020 2020 2020 2020 2020  e[1].           
-0001a3c0: 2073 656c 662e 6d33 3220 3d20 7661 6c75   self.m32 = valu
-0001a3d0: 655b 325d 0a20 2020 2020 2020 2020 2020  e[2].           
-0001a3e0: 2073 656c 662e 6d34 3220 3d20 7661 6c75   self.m42 = valu
-0001a3f0: 655b 335d 0a20 2020 2020 2020 2065 6c69  e[3].        eli
-0001a400: 6620 693d 3d32 3a0a 2020 2020 2020 2020  f i==2:.        
-0001a410: 2020 2020 7365 6c66 2e6d 3133 203d 2076      self.m13 = v
-0001a420: 616c 7565 5b30 5d0a 2020 2020 2020 2020  alue[0].        
-0001a430: 2020 2020 7365 6c66 2e6d 3233 203d 2076      self.m23 = v
-0001a440: 616c 7565 5b31 5d0a 2020 2020 2020 2020  alue[1].        
-0001a450: 2020 2020 7365 6c66 2e6d 3333 203d 2076      self.m33 = v
-0001a460: 616c 7565 5b32 5d0a 2020 2020 2020 2020  alue[2].        
-0001a470: 2020 2020 7365 6c66 2e6d 3433 203d 2076      self.m43 = v
-0001a480: 616c 7565 5b33 5d0a 2020 2020 2020 2020  alue[3].        
-0001a490: 656c 6966 2069 3d3d 333a 0a20 2020 2020  elif i==3:.     
-0001a4a0: 2020 2020 2020 2073 656c 662e 6d31 3420         self.m14 
-0001a4b0: 3d20 7661 6c75 655b 305d 0a20 2020 2020  = value[0].     
-0001a4c0: 2020 2020 2020 2073 656c 662e 6d32 3420         self.m24 
-0001a4d0: 3d20 7661 6c75 655b 315d 0a20 2020 2020  = value[1].     
-0001a4e0: 2020 2020 2020 2073 656c 662e 6d33 3420         self.m34 
-0001a4f0: 3d20 7661 6c75 655b 325d 0a20 2020 2020  = value[2].     
-0001a500: 2020 2020 2020 2073 656c 662e 6d34 3420         self.m44 
-0001a510: 3d20 7661 6c75 655b 335d 0a20 2020 2020  = value[3].     
-0001a520: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001a530: 2020 2020 2072 6169 7365 2049 6e64 6578       raise Index
-0001a540: 4572 726f 722c 2022 696e 6465 7820 6f75  Error, "index ou
-0001a550: 7420 6f66 2072 616e 6765 220a 0a0a 2020  t of range"...  
-0001a560: 2020 6465 6620 746f 4c69 7374 2873 656c    def toList(sel
-0001a570: 662c 2072 6f77 6d61 6a6f 723d 3029 3a0a  f, rowmajor=0):.
-0001a580: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-0001a590: 6e20 6120 6c69 7374 2063 6f6e 7461 696e  n a list contain
-0001a5a0: 696e 6720 7468 6520 6d61 7472 6978 2065  ing the matrix e
-0001a5b0: 6c65 6d65 6e74 732e 0a0a 2020 2020 2020  lements...      
-0001a5c0: 2020 4279 2064 6566 6175 6c74 2074 6865    By default the
-0001a5d0: 206c 6973 7420 6973 2069 6e20 636f 6c75   list is in colu
-0001a5e0: 6d6e 2d6d 616a 6f72 206f 7264 6572 2028  mn-major order (
-0001a5f0: 7768 6963 6820 6361 6e20 6469 7265 6374  which can direct
-0001a600: 6c79 2062 650a 2020 2020 2020 2020 7573  ly be.        us
-0001a610: 6564 2069 6e20 4f70 656e 474c 206f 7220  ed in OpenGL or 
-0001a620: 5265 6e64 6572 4d61 6e29 2e20 4966 2079  RenderMan). If y
-0001a630: 6f75 2073 6574 2074 6865 206f 7074 696f  ou set the optio
-0001a640: 6e61 6c20 6172 6775 6d65 6e74 0a20 2020  nal argument.   
-0001a650: 2020 2020 2072 6f77 6d61 6a6f 7220 746f       rowmajor to
-0001a660: 2031 2c20 796f 7527 6c6c 2067 6574 2074   1, you'll get t
-0001a670: 6865 206c 6973 7420 696e 2072 6f77 2d6d  he list in row-m
-0001a680: 616a 6f72 206f 7264 6572 2e0a 0a20 2020  ajor order...   
-0001a690: 2020 2020 203e 3e3e 204d 3d6d 6174 3428       >>> M=mat4(
-0001a6a0: 312c 322c 332c 342c 352c 362c 372c 382c  1,2,3,4,5,6,7,8,
-0001a6b0: 392c 3130 2c31 312c 3132 2c31 332c 3134  9,10,11,12,13,14
-0001a6c0: 2c31 352c 3136 290a 2020 2020 2020 2020  ,15,16).        
-0001a6d0: 3e3e 3e20 7072 696e 7420 4d2e 746f 4c69  >>> print M.toLi
-0001a6e0: 7374 2829 0a20 2020 2020 2020 205b 312c  st().        [1,
-0001a6f0: 2035 2c20 392c 2031 332c 2032 2c20 362c   5, 9, 13, 2, 6,
-0001a700: 2031 302c 2031 342c 2033 2c20 372c 2031   10, 14, 3, 7, 1
-0001a710: 312c 2031 352c 2034 2c20 382c 2031 322c  1, 15, 4, 8, 12,
-0001a720: 2031 365d 0a20 2020 2020 2020 203e 3e3e   16].        >>>
-0001a730: 2070 7269 6e74 204d 2e74 6f4c 6973 7428   print M.toList(
-0001a740: 726f 776d 616a 6f72 3d31 290a 2020 2020  rowmajor=1).    
-0001a750: 2020 2020 5b31 2c20 322c 2033 2c20 342c      [1, 2, 3, 4,
-0001a760: 2035 2c20 362c 2037 2c20 382c 2039 2c20   5, 6, 7, 8, 9, 
-0001a770: 3130 2c20 3131 2c20 3132 2c20 3133 2c20  10, 11, 12, 13, 
-0001a780: 3134 2c20 3135 2c20 3136 5d0a 2020 2020  14, 15, 16].    
-0001a790: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001a7a0: 6966 2072 6f77 6d61 6a6f 723a 0a20 2020  if rowmajor:.   
-0001a7b0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001a7c0: 5b73 656c 662e 6d31 312c 2073 656c 662e  [self.m11, self.
-0001a7d0: 6d31 322c 2073 656c 662e 6d31 332c 2073  m12, self.m13, s
-0001a7e0: 656c 662e 6d31 342c 0a20 2020 2020 2020  elf.m14,.       
-0001a7f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001a800: 662e 6d32 312c 2073 656c 662e 6d32 322c  f.m21, self.m22,
-0001a810: 2073 656c 662e 6d32 332c 2073 656c 662e   self.m23, self.
-0001a820: 6d32 342c 0a20 2020 2020 2020 2020 2020  m24,.           
-0001a830: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
-0001a840: 312c 2073 656c 662e 6d33 322c 2073 656c  1, self.m32, sel
-0001a850: 662e 6d33 332c 2073 656c 662e 6d33 342c  f.m33, self.m34,
-0001a860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a870: 2020 2020 2073 656c 662e 6d34 312c 2073       self.m41, s
-0001a880: 656c 662e 6d34 322c 2073 656c 662e 6d34  elf.m42, self.m4
-0001a890: 332c 2073 656c 662e 6d34 345d 0a20 2020  3, self.m44].   
-0001a8a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001a8b0: 2020 2020 2020 2072 6574 7572 6e20 5b73         return [s
-0001a8c0: 656c 662e 6d31 312c 2073 656c 662e 6d32  elf.m11, self.m2
-0001a8d0: 312c 2073 656c 662e 6d33 312c 2073 656c  1, self.m31, sel
-0001a8e0: 662e 6d34 312c 0a20 2020 2020 2020 2020  f.m41,.         
-0001a8f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001a900: 6d31 322c 2073 656c 662e 6d32 322c 2073  m12, self.m22, s
-0001a910: 656c 662e 6d33 322c 2073 656c 662e 6d34  elf.m32, self.m4
-0001a920: 322c 0a20 2020 2020 2020 2020 2020 2020  2,.             
-0001a930: 2020 2020 2020 2073 656c 662e 6d31 332c         self.m13,
-0001a940: 2073 656c 662e 6d32 332c 2073 656c 662e   self.m23, self.
-0001a950: 6d33 332c 2073 656c 662e 6d34 332c 0a20  m33, self.m43,. 
-0001a960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a970: 2020 2073 656c 662e 6d31 342c 2073 656c     self.m14, sel
-0001a980: 662e 6d32 342c 2073 656c 662e 6d33 342c  f.m24, self.m34,
-0001a990: 2073 656c 662e 6d34 345d 0a0a 0a20 2020   self.m44]...   
-0001a9a0: 2064 6566 2069 6465 6e74 6974 7928 7365   def identity(se
-0001a9b0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0001a9c0: 5265 7475 726e 2069 6465 6e74 6974 7920  Return identity 
-0001a9d0: 6d61 7472 6978 2e0a 0a20 2020 2020 2020  matrix...       
-0001a9e0: 203e 3e3e 2070 7269 6e74 206d 6174 3428   >>> print mat4(
-0001a9f0: 292e 6964 656e 7469 7479 2829 0a20 2020  ).identity().   
-0001aa00: 2020 2020 205b 2020 2031 2e30 3030 302c       [   1.0000,
-0001aa10: 2020 2020 302e 3030 3030 2c20 2020 2030      0.0000,    0
-0001aa20: 2e30 3030 302c 2020 2020 302e 3030 3030  .0000,    0.0000
-0001aa30: 5d0a 2020 2020 2020 2020 5b20 2020 302e  ].        [   0.
-0001aa40: 3030 3030 2c20 2020 2031 2e30 3030 302c  0000,    1.0000,
-0001aa50: 2020 2020 302e 3030 3030 2c20 2020 2030      0.0000,    0
-0001aa60: 2e30 3030 305d 0a20 2020 2020 2020 205b  .0000].        [
-0001aa70: 2020 2030 2e30 3030 302c 2020 2020 302e     0.0000,    0.
-0001aa80: 3030 3030 2c20 2020 2031 2e30 3030 302c  0000,    1.0000,
-0001aa90: 2020 2020 302e 3030 3030 5d0a 2020 2020      0.0000].    
-0001aaa0: 2020 2020 5b20 2020 302e 3030 3030 2c20      [   0.0000, 
-0001aab0: 2020 2030 2e30 3030 302c 2020 2020 302e     0.0000,    0.
-0001aac0: 3030 3030 2c20 2020 2031 2e30 3030 305d  0000,    1.0000]
-0001aad0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001aae0: 2020 2020 2063 6465 6620 6d61 7434 2072       cdef mat4 r
-0001aaf0: 6573 0a20 2020 2020 2020 2072 6573 203d  es.        res =
-0001ab00: 206d 6174 3428 290a 2020 2020 2020 2020   mat4().        
-0001ab10: 7265 732e 6d31 3120 3d20 312e 300a 2020  res.m11 = 1.0.  
-0001ab20: 2020 2020 2020 7265 732e 6d31 3220 3d20        res.m12 = 
-0001ab30: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
-0001ab40: 6d31 3320 3d20 302e 300a 2020 2020 2020  m13 = 0.0.      
-0001ab50: 2020 7265 732e 6d31 3420 3d20 302e 300a    res.m14 = 0.0.
-0001ab60: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
-0001ab70: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
-0001ab80: 732e 6d32 3220 3d20 312e 300a 2020 2020  s.m22 = 1.0.    
-0001ab90: 2020 2020 7265 732e 6d32 3320 3d20 302e      res.m23 = 0.
-0001aba0: 300a 2020 2020 2020 2020 7265 732e 6d32  0.        res.m2
-0001abb0: 3420 3d20 302e 300a 2020 2020 2020 2020  4 = 0.0.        
-0001abc0: 7265 732e 6d33 3120 3d20 302e 300a 2020  res.m31 = 0.0.  
-0001abd0: 2020 2020 2020 7265 732e 6d33 3220 3d20        res.m32 = 
-0001abe0: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
-0001abf0: 6d33 3320 3d20 312e 300a 2020 2020 2020  m33 = 1.0.      
-0001ac00: 2020 7265 732e 6d33 3420 3d20 302e 300a    res.m34 = 0.0.
-0001ac10: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
-0001ac20: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
-0001ac30: 732e 6d34 3220 3d20 302e 300a 2020 2020  s.m42 = 0.0.    
-0001ac40: 2020 2020 7265 732e 6d34 3320 3d20 302e      res.m43 = 0.
-0001ac50: 300a 2020 2020 2020 2020 7265 732e 6d34  0.        res.m4
-0001ac60: 3420 3d20 312e 300a 2020 2020 2020 2020  4 = 1.0.        
-0001ac70: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
-0001ac80: 6465 6620 7472 616e 7370 6f73 6528 7365  def transpose(se
-0001ac90: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0001aca0: 5265 7475 726e 2074 7261 6e73 706f 7365  Return transpose
-0001acb0: 206d 6174 7269 782e 0a0a 2020 2020 2020   matrix...      
-0001acc0: 2020 3e3e 3e20 4d3d 6d61 7434 2831 2c32    >>> M=mat4(1,2
-0001acd0: 2c33 2c34 2c35 2c36 2c37 2c38 2c39 2c31  ,3,4,5,6,7,8,9,1
-0001ace0: 302c 3131 2c31 322c 3133 2c31 342c 3135  0,11,12,13,14,15
-0001acf0: 2c31 3629 0a20 2020 2020 2020 203e 3e3e  ,16).        >>>
-0001ad00: 2070 7269 6e74 204d 2e74 7261 6e73 706f   print M.transpo
-0001ad10: 7365 2829 0a20 2020 2020 2020 205b 2020  se().        [  
-0001ad20: 2031 2e30 3030 302c 2020 2020 352e 3030   1.0000,    5.00
-0001ad30: 3030 2c20 2020 2039 2e30 3030 302c 2020  00,    9.0000,  
-0001ad40: 2031 332e 3030 3030 5d0a 2020 2020 2020   13.0000].      
-0001ad50: 2020 5b20 2020 322e 3030 3030 2c20 2020    [   2.0000,   
-0001ad60: 2036 2e30 3030 302c 2020 2031 302e 3030   6.0000,   10.00
-0001ad70: 3030 2c20 2020 3134 2e30 3030 305d 0a20  00,   14.0000]. 
-0001ad80: 2020 2020 2020 205b 2020 2033 2e30 3030         [   3.000
-0001ad90: 302c 2020 2020 372e 3030 3030 2c20 2020  0,    7.0000,   
-0001ada0: 3131 2e30 3030 302c 2020 2031 352e 3030  11.0000,   15.00
-0001adb0: 3030 5d0a 2020 2020 2020 2020 5b20 2020  00].        [   
-0001adc0: 342e 3030 3030 2c20 2020 2038 2e30 3030  4.0000,    8.000
-0001add0: 302c 2020 2031 322e 3030 3030 2c20 2020  0,   12.0000,   
-0001ade0: 3136 2e30 3030 305d 0a20 2020 2020 2020  16.0000].       
-0001adf0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-0001ae00: 6620 6d61 7434 2072 6573 0a20 2020 2020  f mat4 res.     
-0001ae10: 2020 2072 6573 203d 206d 6174 3428 290a     res = mat4().
-0001ae20: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
-0001ae30: 3d20 7365 6c66 2e6d 3131 0a20 2020 2020  = self.m11.     
-0001ae40: 2020 2072 6573 2e6d 3132 203d 2073 656c     res.m12 = sel
-0001ae50: 662e 6d32 310a 2020 2020 2020 2020 7265  f.m21.        re
-0001ae60: 732e 6d31 3320 3d20 7365 6c66 2e6d 3331  s.m13 = self.m31
-0001ae70: 0a20 2020 2020 2020 2072 6573 2e6d 3134  .        res.m14
-0001ae80: 203d 2073 656c 662e 6d34 310a 2020 2020   = self.m41.    
-0001ae90: 2020 2020 7265 732e 6d32 3120 3d20 7365      res.m21 = se
-0001aea0: 6c66 2e6d 3132 0a20 2020 2020 2020 2072  lf.m12.        r
-0001aeb0: 6573 2e6d 3232 203d 2073 656c 662e 6d32  es.m22 = self.m2
-0001aec0: 320a 2020 2020 2020 2020 7265 732e 6d32  2.        res.m2
-0001aed0: 3320 3d20 7365 6c66 2e6d 3332 0a20 2020  3 = self.m32.   
-0001aee0: 2020 2020 2072 6573 2e6d 3234 203d 2073       res.m24 = s
-0001aef0: 656c 662e 6d34 320a 2020 2020 2020 2020  elf.m42.        
-0001af00: 7265 732e 6d33 3120 3d20 7365 6c66 2e6d  res.m31 = self.m
-0001af10: 3133 0a20 2020 2020 2020 2072 6573 2e6d  13.        res.m
-0001af20: 3332 203d 2073 656c 662e 6d32 330a 2020  32 = self.m23.  
-0001af30: 2020 2020 2020 7265 732e 6d33 3320 3d20        res.m33 = 
-0001af40: 7365 6c66 2e6d 3333 0a20 2020 2020 2020  self.m33.       
-0001af50: 2072 6573 2e6d 3334 203d 2073 656c 662e   res.m34 = self.
-0001af60: 6d34 330a 2020 2020 2020 2020 7265 732e  m43.        res.
-0001af70: 6d34 3120 3d20 7365 6c66 2e6d 3134 0a20  m41 = self.m14. 
-0001af80: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
-0001af90: 2073 656c 662e 6d32 340a 2020 2020 2020   self.m24.      
-0001afa0: 2020 7265 732e 6d34 3320 3d20 7365 6c66    res.m43 = self
-0001afb0: 2e6d 3334 0a20 2020 2020 2020 2072 6573  .m34.        res
-0001afc0: 2e6d 3434 203d 2073 656c 662e 6d34 340a  .m44 = self.m44.
-0001afd0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0001afe0: 6573 0a0a 2020 2020 6465 6620 6465 7465  es..    def dete
-0001aff0: 726d 696e 616e 7428 7365 6c66 293a 0a20  rminant(self):. 
-0001b000: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-0001b010: 2064 6574 6572 6d69 6e61 6e74 2e0a 0a20   determinant... 
-0001b020: 2020 2020 2020 203e 3e3e 204d 3d6d 6174         >>> M=mat
-0001b030: 3428 322e 302c 302c 302c 302c 2030 2c32  4(2.0,0,0,0, 0,2
-0001b040: 2e30 2c30 2c30 2c20 302c 302c 322e 302c  .0,0,0, 0,0,2.0,
-0001b050: 302c 2030 2c30 2c30 2c32 2e30 290a 2020  0, 0,0,0,2.0).  
-0001b060: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-0001b070: 4d2e 6465 7465 726d 696e 616e 7428 290a  M.determinant().
-0001b080: 2020 2020 2020 2020 3136 2e30 0a20 2020          16.0.   
-0001b090: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001b0a0: 2072 6574 7572 6e20 7365 6c66 2e6d 3131   return self.m11
-0001b0b0: 2a73 656c 662e 6d32 322a 7365 6c66 2e6d  *self.m22*self.m
-0001b0c0: 3333 2a73 656c 662e 6d34 3420 5c0a 2020  33*self.m44 \.  
-0001b0d0: 2020 2020 2020 2020 2020 2020 202d 7365               -se
-0001b0e0: 6c66 2e6d 3131 2a73 656c 662e 6d32 322a  lf.m11*self.m22*
-0001b0f0: 7365 6c66 2e6d 3334 2a73 656c 662e 6d34  self.m34*self.m4
-0001b100: 3320 5c0a 2020 2020 2020 2020 2020 2020  3 \.            
-0001b110: 2020 202b 7365 6c66 2e6d 3131 2a73 656c     +self.m11*sel
-0001b120: 662e 6d32 332a 7365 6c66 2e6d 3334 2a73  f.m23*self.m34*s
-0001b130: 656c 662e 6d34 3220 5c0a 2020 2020 2020  elf.m42 \.      
-0001b140: 2020 2020 2020 2020 202d 7365 6c66 2e6d           -self.m
-0001b150: 3131 2a73 656c 662e 6d32 332a 7365 6c66  11*self.m23*self
-0001b160: 2e6d 3332 2a73 656c 662e 6d34 3420 5c0a  .m32*self.m44 \.
-0001b170: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-0001b180: 7365 6c66 2e6d 3131 2a73 656c 662e 6d32  self.m11*self.m2
-0001b190: 342a 7365 6c66 2e6d 3332 2a73 656c 662e  4*self.m32*self.
-0001b1a0: 6d34 3320 5c0a 2020 2020 2020 2020 2020  m43 \.          
-0001b1b0: 2020 2020 202d 7365 6c66 2e6d 3131 2a73       -self.m11*s
-0001b1c0: 656c 662e 6d32 342a 7365 6c66 2e6d 3333  elf.m24*self.m33
-0001b1d0: 2a73 656c 662e 6d34 3220 5c0a 2020 2020  *self.m42 \.    
-0001b1e0: 2020 2020 2020 2020 2020 202d 7365 6c66             -self
-0001b1f0: 2e6d 3132 2a73 656c 662e 6d32 332a 7365  .m12*self.m23*se
-0001b200: 6c66 2e6d 3334 2a73 656c 662e 6d34 3120  lf.m34*self.m41 
-0001b210: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0001b220: 202b 7365 6c66 2e6d 3132 2a73 656c 662e   +self.m12*self.
-0001b230: 6d32 332a 7365 6c66 2e6d 3331 2a73 656c  m23*self.m31*sel
-0001b240: 662e 6d34 3420 5c0a 2020 2020 2020 2020  f.m44 \.        
-0001b250: 2020 2020 2020 202d 7365 6c66 2e6d 3132         -self.m12
-0001b260: 2a73 656c 662e 6d32 342a 7365 6c66 2e6d  *self.m24*self.m
-0001b270: 3331 2a73 656c 662e 6d34 3320 5c0a 2020  31*self.m43 \.  
-0001b280: 2020 2020 2020 2020 2020 2020 202b 7365               +se
-0001b290: 6c66 2e6d 3132 2a73 656c 662e 6d32 342a  lf.m12*self.m24*
-0001b2a0: 7365 6c66 2e6d 3333 2a73 656c 662e 6d34  self.m33*self.m4
-0001b2b0: 3120 5c0a 2020 2020 2020 2020 2020 2020  1 \.            
-0001b2c0: 2020 202d 7365 6c66 2e6d 3132 2a73 656c     -self.m12*sel
-0001b2d0: 662e 6d32 312a 7365 6c66 2e6d 3333 2a73  f.m21*self.m33*s
-0001b2e0: 656c 662e 6d34 3420 5c0a 2020 2020 2020  elf.m44 \.      
-0001b2f0: 2020 2020 2020 2020 202b 7365 6c66 2e6d           +self.m
-0001b300: 3132 2a73 656c 662e 6d32 312a 7365 6c66  12*self.m21*self
-0001b310: 2e6d 3334 2a73 656c 662e 6d34 3320 5c0a  .m34*self.m43 \.
-0001b320: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-0001b330: 7365 6c66 2e6d 3133 2a73 656c 662e 6d32  self.m13*self.m2
-0001b340: 342a 7365 6c66 2e6d 3331 2a73 656c 662e  4*self.m31*self.
-0001b350: 6d34 3220 5c0a 2020 2020 2020 2020 2020  m42 \.          
-0001b360: 2020 2020 202d 7365 6c66 2e6d 3133 2a73       -self.m13*s
-0001b370: 656c 662e 6d32 342a 7365 6c66 2e6d 3332  elf.m24*self.m32
-0001b380: 2a73 656c 662e 6d34 3120 5c0a 2020 2020  *self.m41 \.    
-0001b390: 2020 2020 2020 2020 2020 202b 7365 6c66             +self
-0001b3a0: 2e6d 3133 2a73 656c 662e 6d32 312a 7365  .m13*self.m21*se
-0001b3b0: 6c66 2e6d 3332 2a73 656c 662e 6d34 3420  lf.m32*self.m44 
-0001b3c0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0001b3d0: 202d 7365 6c66 2e6d 3133 2a73 656c 662e   -self.m13*self.
-0001b3e0: 6d32 312a 7365 6c66 2e6d 3334 2a73 656c  m21*self.m34*sel
-0001b3f0: 662e 6d34 3220 5c0a 2020 2020 2020 2020  f.m42 \.        
-0001b400: 2020 2020 2020 202b 7365 6c66 2e6d 3133         +self.m13
-0001b410: 2a73 656c 662e 6d32 322a 7365 6c66 2e6d  *self.m22*self.m
-0001b420: 3334 2a73 656c 662e 6d34 3120 5c0a 2020  34*self.m41 \.  
-0001b430: 2020 2020 2020 2020 2020 2020 202d 7365               -se
-0001b440: 6c66 2e6d 3133 2a73 656c 662e 6d32 322a  lf.m13*self.m22*
-0001b450: 7365 6c66 2e6d 3331 2a73 656c 662e 6d34  self.m31*self.m4
-0001b460: 3420 5c0a 2020 2020 2020 2020 2020 2020  4 \.            
-0001b470: 2020 202d 7365 6c66 2e6d 3134 2a73 656c     -self.m14*sel
-0001b480: 662e 6d32 312a 7365 6c66 2e6d 3332 2a73  f.m21*self.m32*s
-0001b490: 656c 662e 6d34 3320 5c0a 2020 2020 2020  elf.m43 \.      
-0001b4a0: 2020 2020 2020 2020 202b 7365 6c66 2e6d           +self.m
-0001b4b0: 3134 2a73 656c 662e 6d32 312a 7365 6c66  14*self.m21*self
-0001b4c0: 2e6d 3333 2a73 656c 662e 6d34 3220 5c0a  .m33*self.m42 \.
-0001b4d0: 2020 2020 2020 2020 2020 2020 2020 202d                 -
-0001b4e0: 7365 6c66 2e6d 3134 2a73 656c 662e 6d32  self.m14*self.m2
-0001b4f0: 322a 7365 6c66 2e6d 3333 2a73 656c 662e  2*self.m33*self.
-0001b500: 6d34 3120 5c0a 2020 2020 2020 2020 2020  m41 \.          
-0001b510: 2020 2020 202b 7365 6c66 2e6d 3134 2a73       +self.m14*s
-0001b520: 656c 662e 6d32 322a 7365 6c66 2e6d 3331  elf.m22*self.m31
-0001b530: 2a73 656c 662e 6d34 3320 5c0a 2020 2020  *self.m43 \.    
-0001b540: 2020 2020 2020 2020 2020 202d 7365 6c66             -self
-0001b550: 2e6d 3134 2a73 656c 662e 6d32 332a 7365  .m14*self.m23*se
-0001b560: 6c66 2e6d 3331 2a73 656c 662e 6d34 3220  lf.m31*self.m42 
-0001b570: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-0001b580: 202b 7365 6c66 2e6d 3134 2a73 656c 662e   +self.m14*self.
-0001b590: 6d32 332a 7365 6c66 2e6d 3332 2a73 656c  m23*self.m32*sel
-0001b5a0: 662e 6d34 310a 0a20 2020 2064 6566 205f  f.m41..    def _
-0001b5b0: 7375 626d 6174 2873 656c 662c 206d 6174  submat(self, mat
-0001b5c0: 3320 4d33 2c20 692c 6a29 3a0a 2020 2020  3 M3, i,j):.    
-0001b5d0: 2020 2020 6364 6566 2069 6e74 206b 2c6c      cdef int k,l
-0001b5e0: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
-0001b5f0: 7562 6c65 2076 0a0a 2320 2020 2020 2020  uble v..#       
-0001b600: 204d 3d6d 6174 3328 290a 2020 2020 2020   M=mat3().      
-0001b610: 2020 6b3d 300a 2020 2020 2020 2020 7768    k=0.        wh
-0001b620: 696c 6520 6b3c 333a 0a20 2020 2020 2020  ile k<3:.       
-0001b630: 2020 2020 206c 3d30 0a20 2020 2020 2020       l=0.       
-0001b640: 2020 2020 2077 6869 6c65 206c 3c33 3a0a       while l<3:.
-0001b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b660: 743d 286b 2c6c 290a 2020 2020 2020 2020  t=(k,l).        
-0001b670: 2020 2020 2020 2020 6966 206b 3e3d 693a          if k>=i:
-0001b680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b690: 2020 2020 2074 3d28 6b2b 312c 745b 315d       t=(k+1,t[1]
-0001b6a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001b6b0: 2020 6966 206c 3e3d 6a3a 0a20 2020 2020    if l>=j:.     
-0001b6c0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0001b6d0: 3d28 745b 305d 2c6c 2b31 290a 0a23 2020  =(t[0],l+1)..#  
-0001b6e0: 2020 2020 2020 2020 2020 2020 2020 4d33                M3
-0001b6f0: 5b6b 2c6c 5d20 3d20 7365 6c66 5b74 5d0a  [k,l] = self[t].
-0001b700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b710: 7620 3d20 7365 6c66 5b74 5d0a 2020 2020  v = self[t].    
-0001b720: 2020 2020 2020 2020 2020 2020 6966 206b              if k
-0001b730: 3d3d 3020 616e 6420 6c3d 3d30 3a0a 2020  ==0 and l==0:.  
-0001b740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b750: 2020 4d33 2e6d 3131 203d 2076 0a20 2020    M3.m11 = v.   
-0001b760: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001b770: 6b3d 3d30 2061 6e64 206c 3d3d 313a 0a20  k==0 and l==1:. 
-0001b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b790: 2020 204d 332e 6d31 3220 3d20 760a 2020     M3.m12 = v.  
-0001b7a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001b7b0: 206b 3d3d 3020 616e 6420 6c3d 3d32 3a0a   k==0 and l==2:.
-0001b7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b7d0: 2020 2020 4d33 2e6d 3133 203d 2076 0a20      M3.m13 = v. 
-0001b7e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001b7f0: 6620 6b3d 3d31 2061 6e64 206c 3d3d 303a  f k==1 and l==0:
-0001b800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b810: 2020 2020 204d 332e 6d32 3120 3d20 760a       M3.m21 = v.
+00012190: 7365 6c66 2e6d 3233 203d 2073 6571 5b36  self.m23 = seq[6
+000121a0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000121b0: 2020 2020 2020 7365 6c66 2e6d 3234 203d        self.m24 =
+000121c0: 2073 6571 5b37 5d0a 2020 2020 2020 2020   seq[7].        
+000121d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000121e0: 2e6d 3331 203d 2073 6571 5b38 5d0a 2020  .m31 = seq[8].  
+000121f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012200: 2020 7365 6c66 2e6d 3332 203d 2073 6571    self.m32 = seq
+00012210: 5b39 5d0a 2020 2020 2020 2020 2020 2020  [9].            
+00012220: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
+00012230: 203d 2073 6571 5b31 305d 0a20 2020 2020   = seq[10].     
+00012240: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00012250: 656c 662e 6d33 3420 3d20 7365 715b 3131  elf.m34 = seq[11
+00012260: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00012270: 2020 2020 2020 7365 6c66 2e6d 3431 203d        self.m41 =
+00012280: 2073 6571 5b31 325d 0a20 2020 2020 2020   seq[12].       
+00012290: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000122a0: 662e 6d34 3220 3d20 7365 715b 3133 5d0a  f.m42 = seq[13].
+000122b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000122c0: 2020 2020 7365 6c66 2e6d 3433 203d 2073      self.m43 = s
+000122d0: 6571 5b31 345d 0a20 2020 2020 2020 2020  eq[14].         
+000122e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000122f0: 6d34 3420 3d20 7365 715b 3135 5d0a 2020  m44 = seq[15].  
+00012300: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00012310: 6966 2073 6571 6c65 6e3d 3d34 3a0a 2020  if seqlen==4:.  
+00012320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012330: 2020 6220 3d20 7365 715b 305d 0a20 2020    b = seq[0].   
+00012340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012350: 2073 656c 662e 6d31 3120 3d20 625b 305d   self.m11 = b[0]
+00012360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012370: 2020 2020 2073 656c 662e 6d32 3120 3d20       self.m21 = 
+00012380: 625b 315d 0a20 2020 2020 2020 2020 2020  b[1].           
+00012390: 2020 2020 2020 2020 2073 656c 662e 6d33           self.m3
+000123a0: 3120 3d20 625b 325d 0a20 2020 2020 2020  1 = b[2].       
+000123b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000123c0: 662e 6d34 3120 3d20 625b 335d 0a20 2020  f.m41 = b[3].   
+000123d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123e0: 2062 203d 2073 6571 5b31 5d0a 2020 2020   b = seq[1].    
+000123f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012400: 7365 6c66 2e6d 3132 203d 2062 5b30 5d0a  self.m12 = b[0].
+00012410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012420: 2020 2020 7365 6c66 2e6d 3232 203d 2062      self.m22 = b
+00012430: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00012440: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
+00012450: 203d 2062 5b32 5d0a 2020 2020 2020 2020   = b[2].        
+00012460: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00012470: 2e6d 3432 203d 2062 5b33 5d0a 2020 2020  .m42 = b[3].    
+00012480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012490: 6220 3d20 7365 715b 325d 0a20 2020 2020  b = seq[2].     
+000124a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000124b0: 656c 662e 6d31 3320 3d20 625b 305d 0a20  elf.m13 = b[0]. 
+000124c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000124d0: 2020 2073 656c 662e 6d32 3320 3d20 625b     self.m23 = b[
+000124e0: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+000124f0: 2020 2020 2020 2073 656c 662e 6d33 3320         self.m33 
+00012500: 3d20 625b 325d 0a20 2020 2020 2020 2020  = b[2].         
+00012510: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012520: 6d34 3320 3d20 625b 335d 0a20 2020 2020  m43 = b[3].     
+00012530: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00012540: 203d 2073 6571 5b33 5d0a 2020 2020 2020   = seq[3].      
+00012550: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00012560: 6c66 2e6d 3134 203d 2062 5b30 5d0a 2020  lf.m14 = b[0].  
+00012570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012580: 2020 7365 6c66 2e6d 3234 203d 2062 5b31    self.m24 = b[1
+00012590: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000125a0: 2020 2020 2020 7365 6c66 2e6d 3334 203d        self.m34 =
+000125b0: 2062 5b32 5d0a 2020 2020 2020 2020 2020   b[2].          
+000125c0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+000125d0: 3434 203d 2062 5b33 5d0a 2020 2020 2020  44 = b[3].      
+000125e0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000125f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012600: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00012610: 726f 722c 2022 6d61 7434 2829 2074 616b  ror, "mat4() tak
+00012620: 6573 2061 7420 6d6f 7374 2031 3620 6172  es at most 16 ar
+00012630: 6775 6d65 6e74 7322 0a0a 2020 2020 2020  guments"..      
+00012640: 2020 2320 3420 6172 6775 6d65 6e74 7320    # 4 arguments 
+00012650: 2863 6f6c 756d 6e73 2061 7320 7365 7175  (columns as sequ
+00012660: 656e 6365 7329 0a20 2020 2020 2020 2065  ences).        e
+00012670: 6c69 6620 6172 676c 656e 3d3d 343a 0a20  lif arglen==4:. 
+00012680: 2020 2020 2020 2020 2020 2061 2c62 2c63             a,b,c
+00012690: 2c64 3d61 7267 730a 2020 2020 2020 2020  ,d=args.        
+000126a0: 2020 2020 7365 6c66 2e6d 3131 203d 2061      self.m11 = a
+000126b0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+000126c0: 7365 6c66 2e6d 3132 203d 2062 5b30 5d0a  self.m12 = b[0].
+000126d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000126e0: 2e6d 3133 203d 2063 5b30 5d0a 2020 2020  .m13 = c[0].    
+000126f0: 2020 2020 2020 2020 7365 6c66 2e6d 3134          self.m14
+00012700: 203d 2064 5b30 5d0a 2020 2020 2020 2020   = d[0].        
+00012710: 2020 2020 7365 6c66 2e6d 3231 203d 2061      self.m21 = a
+00012720: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00012730: 7365 6c66 2e6d 3232 203d 2062 5b31 5d0a  self.m22 = b[1].
+00012740: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00012750: 2e6d 3233 203d 2063 5b31 5d0a 2020 2020  .m23 = c[1].    
+00012760: 2020 2020 2020 2020 7365 6c66 2e6d 3234          self.m24
+00012770: 203d 2064 5b31 5d0a 2020 2020 2020 2020   = d[1].        
+00012780: 2020 2020 7365 6c66 2e6d 3331 203d 2061      self.m31 = a
+00012790: 5b32 5d0a 2020 2020 2020 2020 2020 2020  [2].            
+000127a0: 7365 6c66 2e6d 3332 203d 2062 5b32 5d0a  self.m32 = b[2].
+000127b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000127c0: 2e6d 3333 203d 2063 5b32 5d0a 2020 2020  .m33 = c[2].    
+000127d0: 2020 2020 2020 2020 7365 6c66 2e6d 3334          self.m34
+000127e0: 203d 2064 5b32 5d0a 2020 2020 2020 2020   = d[2].        
+000127f0: 2020 2020 7365 6c66 2e6d 3431 203d 2061      self.m41 = a
+00012800: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
+00012810: 7365 6c66 2e6d 3432 203d 2062 5b33 5d0a  self.m42 = b[3].
+00012820: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00012830: 2e6d 3433 203d 2063 5b33 5d0a 2020 2020  .m43 = c[3].    
+00012840: 2020 2020 2020 2020 7365 6c66 2e6d 3434          self.m44
+00012850: 203d 2064 5b33 5d0a 0a20 2020 2020 2020   = d[3]..       
+00012860: 2023 2031 3620 6172 6775 6d65 6e74 730a   # 16 arguments.
+00012870: 2020 2020 2020 2020 656c 6966 2061 7267          elif arg
+00012880: 6c65 6e3d 3d31 363a 0a20 2020 2020 2020  len==16:.       
+00012890: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
+000128a0: 6172 6773 5b30 5d0a 2020 2020 2020 2020  args[0].        
+000128b0: 2020 2020 7365 6c66 2e6d 3132 203d 2061      self.m12 = a
+000128c0: 7267 735b 315d 0a20 2020 2020 2020 2020  rgs[1].         
+000128d0: 2020 2073 656c 662e 6d31 3320 3d20 6172     self.m13 = ar
+000128e0: 6773 5b32 5d0a 2020 2020 2020 2020 2020  gs[2].          
+000128f0: 2020 7365 6c66 2e6d 3134 203d 2061 7267    self.m14 = arg
+00012900: 735b 335d 0a20 2020 2020 2020 2020 2020  s[3].           
+00012910: 2073 656c 662e 6d32 3120 3d20 6172 6773   self.m21 = args
+00012920: 5b34 5d0a 2020 2020 2020 2020 2020 2020  [4].            
+00012930: 7365 6c66 2e6d 3232 203d 2061 7267 735b  self.m22 = args[
+00012940: 355d 0a20 2020 2020 2020 2020 2020 2073  5].            s
+00012950: 656c 662e 6d32 3320 3d20 6172 6773 5b36  elf.m23 = args[6
+00012960: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
+00012970: 6c66 2e6d 3234 203d 2061 7267 735b 375d  lf.m24 = args[7]
+00012980: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00012990: 662e 6d33 3120 3d20 6172 6773 5b38 5d0a  f.m31 = args[8].
+000129a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000129b0: 2e6d 3332 203d 2061 7267 735b 395d 0a20  .m32 = args[9]. 
+000129c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000129d0: 6d33 3320 3d20 6172 6773 5b31 305d 0a20  m33 = args[10]. 
+000129e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000129f0: 6d33 3420 3d20 6172 6773 5b31 315d 0a20  m34 = args[11]. 
+00012a00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012a10: 6d34 3120 3d20 6172 6773 5b31 325d 0a20  m41 = args[12]. 
+00012a20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012a30: 6d34 3220 3d20 6172 6773 5b31 335d 0a20  m42 = args[13]. 
+00012a40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012a50: 6d34 3320 3d20 6172 6773 5b31 345d 0a20  m43 = args[14]. 
+00012a60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012a70: 6d34 3420 3d20 6172 6773 5b31 355d 0a0a  m44 = args[15]..
+00012a80: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00012a90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00012aa0: 5479 7065 4572 726f 722c 226d 6174 3428  TypeError,"mat4(
+00012ab0: 2920 6172 6720 6361 6e27 7420 6265 2063  ) arg can't be c
+00012ac0: 6f6e 7665 7274 6564 2074 6f20 6d61 7434  onverted to mat4
+00012ad0: 220a 0a20 2020 2064 6566 205f 5f72 6564  "..    def __red
+00012ae0: 7563 655f 5f28 7365 6c66 293a 0a20 2020  uce__(self):.   
+00012af0: 2020 2020 2072 6574 7572 6e20 285f 6d61       return (_ma
+00012b00: 7434 636f 6e73 7472 7563 742c 2028 7365  t4construct, (se
+00012b10: 6c66 5b30 5d2c 2073 656c 665b 315d 2c20  lf[0], self[1], 
+00012b20: 7365 6c66 5b32 5d2c 2073 656c 665b 335d  self[2], self[3]
+00012b30: 2929 0a0a 2020 2020 6465 6620 5f5f 7265  ))..    def __re
+00012b40: 7072 5f5f 2873 656c 6629 3a0a 2020 2020  pr__(self):.    
+00012b50: 2020 2020 7265 7475 726e 2027 6d61 7434      return 'mat4
+00012b60: 2825 732c 2025 732c 2025 732c 2025 732c  (%s, %s, %s, %s,
+00012b70: 2025 732c 2025 732c 2025 732c 2025 732c   %s, %s, %s, %s,
+00012b80: 2025 732c 2025 732c 2025 732c 2025 732c   %s, %s, %s, %s,
+00012b90: 2025 732c 2025 732c 2025 732c 2025 7329   %s, %s, %s, %s)
+00012ba0: 2725 280a 2020 2020 2020 2020 2020 2020  '%(.            
+00012bb0: 7265 7072 2873 656c 662e 6d31 3129 2c72  repr(self.m11),r
+00012bc0: 6570 7228 7365 6c66 2e6d 3132 292c 7265  epr(self.m12),re
+00012bd0: 7072 2873 656c 662e 6d31 3329 2c72 6570  pr(self.m13),rep
+00012be0: 7228 7365 6c66 2e6d 3134 292c 0a20 2020  r(self.m14),.   
+00012bf0: 2020 2020 2020 2020 2072 6570 7228 7365           repr(se
+00012c00: 6c66 2e6d 3231 292c 7265 7072 2873 656c  lf.m21),repr(sel
+00012c10: 662e 6d32 3229 2c72 6570 7228 7365 6c66  f.m22),repr(self
+00012c20: 2e6d 3233 292c 7265 7072 2873 656c 662e  .m23),repr(self.
+00012c30: 6d32 3429 2c0a 2020 2020 2020 2020 2020  m24),.          
+00012c40: 2020 7265 7072 2873 656c 662e 6d33 3129    repr(self.m31)
+00012c50: 2c72 6570 7228 7365 6c66 2e6d 3332 292c  ,repr(self.m32),
+00012c60: 7265 7072 2873 656c 662e 6d33 3329 2c72  repr(self.m33),r
+00012c70: 6570 7228 7365 6c66 2e6d 3334 292c 0a20  epr(self.m34),. 
+00012c80: 2020 2020 2020 2020 2020 2072 6570 7228             repr(
+00012c90: 7365 6c66 2e6d 3431 292c 7265 7072 2873  self.m41),repr(s
+00012ca0: 656c 662e 6d34 3229 2c72 6570 7228 7365  elf.m42),repr(se
+00012cb0: 6c66 2e6d 3433 292c 7265 7072 2873 656c  lf.m43),repr(sel
+00012cc0: 662e 6d34 3429 290a 0a20 2020 2064 6566  f.m44))..    def
+00012cd0: 205f 5f73 7472 5f5f 2873 656c 6629 3a0a   __str__(self):.
+00012ce0: 2020 2020 2020 2020 7265 7475 726e 2022          return "
+00012cf0: 5b25 392e 3466 2c20 2539 2e34 662c 2025  [%9.4f, %9.4f, %
+00012d00: 392e 3466 2c20 2539 2e34 665d 5c6e 5b25  9.4f, %9.4f]\n[%
+00012d10: 392e 3466 2c20 2539 2e34 662c 2025 392e  9.4f, %9.4f, %9.
+00012d20: 3466 2c20 2539 2e34 665d 5c6e 5b25 392e  4f, %9.4f]\n[%9.
+00012d30: 3466 2c20 2539 2e34 662c 2025 392e 3466  4f, %9.4f, %9.4f
+00012d40: 2c20 2539 2e34 665d 5c6e 5b25 392e 3466  , %9.4f]\n[%9.4f
+00012d50: 2c20 2539 2e34 662c 2025 392e 3466 2c20  , %9.4f, %9.4f, 
+00012d60: 2539 2e34 665d 2225 280a 2020 2020 2020  %9.4f]"%(.      
+00012d70: 2020 2020 2020 7365 6c66 2e6d 3131 2c20        self.m11, 
+00012d80: 7365 6c66 2e6d 3132 2c20 7365 6c66 2e6d  self.m12, self.m
+00012d90: 3133 2c20 7365 6c66 2e6d 3134 2c0a 2020  13, self.m14,.  
+00012da0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00012db0: 3231 2c20 7365 6c66 2e6d 3232 2c20 7365  21, self.m22, se
+00012dc0: 6c66 2e6d 3233 2c20 7365 6c66 2e6d 3234  lf.m23, self.m24
+00012dd0: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
+00012de0: 6c66 2e6d 3331 2c20 7365 6c66 2e6d 3332  lf.m31, self.m32
+00012df0: 2c20 7365 6c66 2e6d 3333 2c20 7365 6c66  , self.m33, self
+00012e00: 2e6d 3334 2c0a 2020 2020 2020 2020 2020  .m34,.          
+00012e10: 2020 7365 6c66 2e6d 3431 2c20 7365 6c66    self.m41, self
+00012e20: 2e6d 3432 2c20 7365 6c66 2e6d 3433 2c20  .m42, self.m43, 
+00012e30: 7365 6c66 2e6d 3434 290a 0a20 2020 2064  self.m44)..    d
+00012e40: 6566 205f 5f69 7465 725f 5f28 7365 6c66  ef __iter__(self
+00012e50: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00012e60: 6e20 6d61 7434 6974 6572 2873 656c 6629  n mat4iter(self)
+00012e70: 0a0a 2020 2020 6465 6620 5f5f 7269 6368  ..    def __rich
+00012e80: 636d 705f 5f28 612c 622c 6f70 293a 0a20  cmp__(a,b,op):. 
+00012e90: 2020 2020 2020 2063 6465 6620 6d61 7434         cdef mat4
+00012ea0: 206d 612c 206d 620a 2020 2020 2020 2020   ma, mb.        
+00012eb0: 6364 6566 2069 6e74 2063 6f70 0a0a 2020  cdef int cop..  
+00012ec0: 2020 2020 2020 636f 7020 3d20 6f70 0a0a        cop = op..
+00012ed0: 2020 2020 2020 2020 7461 203d 2074 7970          ta = typ
+00012ee0: 6528 6129 0a20 2020 2020 2020 2074 6220  e(a).        tb 
+00012ef0: 3d20 7479 7065 2862 290a 2020 2020 2020  = type(b).      
+00012f00: 2020 6966 2028 7461 213d 6d61 7434 206f    if (ta!=mat4 o
+00012f10: 7220 7462 213d 6d61 7434 293a 0a20 2020  r tb!=mat4):.   
+00012f20: 2020 2020 2020 2020 2069 6620 636f 703d           if cop=
+00012f30: 3d33 3a0a 2020 2020 2020 2020 2020 2020  =3:.            
+00012f40: 2020 2020 7265 7475 726e 2031 0a20 2020      return 1.   
+00012f50: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00012f60: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00012f70: 6574 7572 6e20 300a 0a20 2020 2020 2020  eturn 0..       
+00012f80: 206d 6120 3d20 610a 2020 2020 2020 2020   ma = a.        
+00012f90: 6d62 203d 2062 0a0a 2020 2020 2020 2020  mb = b..        
+00012fa0: 2320 3c0a 2020 2020 2020 2020 6966 2063  # <.        if c
+00012fb0: 6f70 3d3d 303a 0a20 2020 2020 2020 2020  op==0:.         
+00012fc0: 2020 2072 6574 7572 6e20 300a 2020 2020     return 0.    
+00012fd0: 2020 2020 2320 3c3d 0a20 2020 2020 2020      # <=.       
+00012fe0: 2065 6c69 6620 636f 703d 3d31 3a0a 2020   elif cop==1:.  
+00012ff0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013000: 2030 0a20 2020 2020 2020 2023 203d 3d0a   0.        # ==.
+00013010: 2020 2020 2020 2020 656c 6966 2063 6f70          elif cop
+00013020: 3d3d 323a 0a20 2020 2020 2020 2020 2020  ==2:.           
+00013030: 2072 6574 7572 6e20 2866 6162 7328 6d61   return (fabs(ma
+00013040: 2e6d 3131 2d6d 622e 6d31 3129 3c3d 6570  .m11-mb.m11)<=ep
+00013050: 7320 616e 6420 6661 6273 286d 612e 6d31  s and fabs(ma.m1
+00013060: 322d 6d62 2e6d 3132 293c 3d65 7073 2061  2-mb.m12)<=eps a
+00013070: 6e64 0a20 2020 2020 2020 2020 2020 2020  nd.             
+00013080: 2020 2020 2020 2066 6162 7328 6d61 2e6d         fabs(ma.m
+00013090: 3133 2d6d 622e 6d31 3329 3c3d 6570 7320  13-mb.m13)<=eps 
+000130a0: 616e 6420 6661 6273 286d 612e 6d31 342d  and fabs(ma.m14-
+000130b0: 6d62 2e6d 3134 293c 3d65 7073 2061 6e64  mb.m14)<=eps and
+000130c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000130d0: 2020 2020 2066 6162 7328 6d61 2e6d 3231       fabs(ma.m21
+000130e0: 2d6d 622e 6d32 3129 3c3d 6570 7320 616e  -mb.m21)<=eps an
+000130f0: 6420 6661 6273 286d 612e 6d32 322d 6d62  d fabs(ma.m22-mb
+00013100: 2e6d 3232 293c 3d65 7073 2061 6e64 0a20  .m22)<=eps and. 
+00013110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013120: 2020 2066 6162 7328 6d61 2e6d 3233 2d6d     fabs(ma.m23-m
+00013130: 622e 6d32 3329 3c3d 6570 7320 616e 6420  b.m23)<=eps and 
+00013140: 6661 6273 286d 612e 6d32 342d 6d62 2e6d  fabs(ma.m24-mb.m
+00013150: 3234 293c 3d65 7073 2061 6e64 0a20 2020  24)<=eps and.   
+00013160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013170: 2066 6162 7328 6d61 2e6d 3331 2d6d 622e   fabs(ma.m31-mb.
+00013180: 6d33 3129 3c3d 6570 7320 616e 6420 6661  m31)<=eps and fa
+00013190: 6273 286d 612e 6d33 322d 6d62 2e6d 3332  bs(ma.m32-mb.m32
+000131a0: 293c 3d65 7073 2061 6e64 0a20 2020 2020  )<=eps and.     
+000131b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000131c0: 6162 7328 6d61 2e6d 3333 2d6d 622e 6d33  abs(ma.m33-mb.m3
+000131d0: 3329 3c3d 6570 7320 616e 6420 6661 6273  3)<=eps and fabs
+000131e0: 286d 612e 6d33 342d 6d62 2e6d 3334 293c  (ma.m34-mb.m34)<
+000131f0: 3d65 7073 2061 6e64 0a20 2020 2020 2020  =eps and.       
+00013200: 2020 2020 2020 2020 2020 2020 2066 6162               fab
+00013210: 7328 6d61 2e6d 3431 2d6d 622e 6d34 3129  s(ma.m41-mb.m41)
+00013220: 3c3d 6570 7320 616e 6420 6661 6273 286d  <=eps and fabs(m
+00013230: 612e 6d34 322d 6d62 2e6d 3432 293c 3d65  a.m42-mb.m42)<=e
+00013240: 7073 2061 6e64 0a20 2020 2020 2020 2020  ps and.         
+00013250: 2020 2020 2020 2020 2020 2066 6162 7328             fabs(
+00013260: 6d61 2e6d 3433 2d6d 622e 6d34 3329 3c3d  ma.m43-mb.m43)<=
+00013270: 6570 7320 616e 6420 6661 6273 286d 612e  eps and fabs(ma.
+00013280: 6d34 342d 6d62 2e6d 3434 293c 3d65 7073  m44-mb.m44)<=eps
+00013290: 290a 2020 2020 2020 2020 2320 213d 0a20  ).        # !=. 
+000132a0: 2020 2020 2020 2065 6c69 6620 636f 703d         elif cop=
+000132b0: 3d33 3a0a 2020 2020 2020 2020 2020 2020  =3:.            
+000132c0: 7265 7475 726e 2028 6661 6273 286d 612e  return (fabs(ma.
+000132d0: 6d31 312d 6d62 2e6d 3131 293e 6570 7320  m11-mb.m11)>eps 
+000132e0: 6f72 2066 6162 7328 6d61 2e6d 3132 2d6d  or fabs(ma.m12-m
+000132f0: 622e 6d31 3229 3e65 7073 206f 720a 2020  b.m12)>eps or.  
+00013300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013310: 2020 6661 6273 286d 612e 6d31 332d 6d62    fabs(ma.m13-mb
+00013320: 2e6d 3133 293e 6570 7320 6f72 2066 6162  .m13)>eps or fab
+00013330: 7328 6d61 2e6d 3134 2d6d 622e 6d31 3429  s(ma.m14-mb.m14)
+00013340: 3e65 7073 206f 720a 2020 2020 2020 2020  >eps or.        
+00013350: 2020 2020 2020 2020 2020 2020 6661 6273              fabs
+00013360: 286d 612e 6d32 312d 6d62 2e6d 3231 293e  (ma.m21-mb.m21)>
+00013370: 6570 7320 6f72 2066 6162 7328 6d61 2e6d  eps or fabs(ma.m
+00013380: 3232 2d6d 622e 6d32 3229 3e65 7073 206f  22-mb.m22)>eps o
+00013390: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+000133a0: 2020 2020 2020 6661 6273 286d 612e 6d32        fabs(ma.m2
+000133b0: 332d 6d62 2e6d 3233 293e 6570 7320 6f72  3-mb.m23)>eps or
+000133c0: 2066 6162 7328 6d61 2e6d 3234 2d6d 622e   fabs(ma.m24-mb.
+000133d0: 6d32 3429 3e65 7073 206f 720a 2020 2020  m24)>eps or.    
+000133e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000133f0: 6661 6273 286d 612e 6d33 312d 6d62 2e6d  fabs(ma.m31-mb.m
+00013400: 3331 293e 6570 7320 6f72 2066 6162 7328  31)>eps or fabs(
+00013410: 6d61 2e6d 3332 2d6d 622e 6d33 3229 3e65  ma.m32-mb.m32)>e
+00013420: 7073 206f 720a 2020 2020 2020 2020 2020  ps or.          
+00013430: 2020 2020 2020 2020 2020 6661 6273 286d            fabs(m
+00013440: 612e 6d33 332d 6d62 2e6d 3333 293e 6570  a.m33-mb.m33)>ep
+00013450: 7320 6f72 2066 6162 7328 6d61 2e6d 3334  s or fabs(ma.m34
+00013460: 2d6d 622e 6d33 3429 3e65 7073 206f 720a  -mb.m34)>eps or.
+00013470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013480: 2020 2020 6661 6273 286d 612e 6d34 312d      fabs(ma.m41-
+00013490: 6d62 2e6d 3431 293e 6570 7320 6f72 2066  mb.m41)>eps or f
+000134a0: 6162 7328 6d61 2e6d 3432 2d6d 622e 6d34  abs(ma.m42-mb.m4
+000134b0: 3229 3e65 7073 206f 720a 2020 2020 2020  2)>eps or.      
+000134c0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+000134d0: 6273 286d 612e 6d34 332d 6d62 2e6d 3433  bs(ma.m43-mb.m43
+000134e0: 293e 6570 7320 6f72 2066 6162 7328 6d61  )>eps or fabs(ma
+000134f0: 2e6d 3434 2d6d 622e 6d34 3429 3e65 7073  .m44-mb.m44)>eps
+00013500: 290a 2020 2020 2020 2020 2320 3e0a 2020  ).        # >.  
+00013510: 2020 2020 2020 656c 6966 2063 6f70 3d3d        elif cop==
+00013520: 343a 0a20 2020 2020 2020 2020 2020 2072  4:.            r
+00013530: 6574 7572 6e20 300a 2020 2020 2020 2020  eturn 0.        
+00013540: 2320 3e3d 0a20 2020 2020 2020 2065 6c69  # >=.        eli
+00013550: 6620 636f 703d 3d35 3a0a 2020 2020 2020  f cop==5:.      
+00013560: 2020 2020 2020 7265 7475 726e 2030 0a20        return 0. 
+00013570: 2020 2020 2020 2023 2073 6f6e 7374 2028         # sonst (
+00013580: 4665 686c 6572 290a 2020 2020 2020 2020  Fehler).        
+00013590: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000135a0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000135b0: 6f72 2c22 696e 7465 726e 616c 2065 7272  or,"internal err
+000135c0: 6f72 3a20 696c 6c65 6761 6c20 7269 6368  or: illegal rich
+000135d0: 2063 6f6d 7061 7269 736f 6e20 6e75 6d62   comparison numb
+000135e0: 6572 220a 0a0a 2020 2020 6465 6620 5f5f  er"...    def __
+000135f0: 6164 645f 5f28 6d61 7434 2061 2c20 6d61  add__(mat4 a, ma
+00013600: 7434 2062 293a 0a20 2020 2020 2020 2022  t4 b):.        "
+00013610: 2222 4d61 7472 6978 2061 6464 6974 696f  ""Matrix additio
+00013620: 6e2e 0a0a 2020 2020 2020 2020 3e3e 3e20  n...        >>> 
+00013630: 4d3d 6d61 7434 2831 2c32 2c33 2c34 2c35  M=mat4(1,2,3,4,5
+00013640: 2c36 2c37 2c38 2c39 2c31 302c 3131 2c31  ,6,7,8,9,10,11,1
+00013650: 322c 3133 2c31 342c 3135 2c31 3629 0a20  2,13,14,15,16). 
+00013660: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+00013670: 204d 2b4d 0a20 2020 2020 2020 205b 2020   M+M.        [  
+00013680: 2032 2e30 3030 302c 2020 2020 342e 3030   2.0000,    4.00
+00013690: 3030 2c20 2020 2036 2e30 3030 302c 2020  00,    6.0000,  
+000136a0: 2020 382e 3030 3030 5d0a 2020 2020 2020    8.0000].      
+000136b0: 2020 5b20 2031 302e 3030 3030 2c20 2020    [  10.0000,   
+000136c0: 3132 2e30 3030 302c 2020 2031 342e 3030  12.0000,   14.00
+000136d0: 3030 2c20 2020 3136 2e30 3030 305d 0a20  00,   16.0000]. 
+000136e0: 2020 2020 2020 205b 2020 3138 2e30 3030         [  18.000
+000136f0: 302c 2020 2032 302e 3030 3030 2c20 2020  0,   20.0000,   
+00013700: 3232 2e30 3030 302c 2020 2032 342e 3030  22.0000,   24.00
+00013710: 3030 5d0a 2020 2020 2020 2020 5b20 2032  00].        [  2
+00013720: 362e 3030 3030 2c20 2020 3238 2e30 3030  6.0000,   28.000
+00013730: 302c 2020 2033 302e 3030 3030 2c20 2020  0,   30.0000,   
+00013740: 3332 2e30 3030 305d 0a20 2020 2020 2020  32.0000].       
+00013750: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00013760: 6620 6d61 7434 2072 6573 0a20 2020 2020  f mat4 res.     
+00013770: 2020 2072 6573 203d 206d 6174 3428 290a     res = mat4().
+00013780: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
+00013790: 3d20 612e 6d31 3120 2b20 622e 6d31 310a  = a.m11 + b.m11.
+000137a0: 2020 2020 2020 2020 7265 732e 6d31 3220          res.m12 
+000137b0: 3d20 612e 6d31 3220 2b20 622e 6d31 320a  = a.m12 + b.m12.
+000137c0: 2020 2020 2020 2020 7265 732e 6d31 3320          res.m13 
+000137d0: 3d20 612e 6d31 3320 2b20 622e 6d31 330a  = a.m13 + b.m13.
+000137e0: 2020 2020 2020 2020 7265 732e 6d31 3420          res.m14 
+000137f0: 3d20 612e 6d31 3420 2b20 622e 6d31 340a  = a.m14 + b.m14.
+00013800: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
+00013810: 3d20 612e 6d32 3120 2b20 622e 6d32 310a  = a.m21 + b.m21.
+00013820: 2020 2020 2020 2020 7265 732e 6d32 3220          res.m22 
+00013830: 3d20 612e 6d32 3220 2b20 622e 6d32 320a  = a.m22 + b.m22.
+00013840: 2020 2020 2020 2020 7265 732e 6d32 3320          res.m23 
+00013850: 3d20 612e 6d32 3320 2b20 622e 6d32 330a  = a.m23 + b.m23.
+00013860: 2020 2020 2020 2020 7265 732e 6d32 3420          res.m24 
+00013870: 3d20 612e 6d32 3420 2b20 622e 6d32 340a  = a.m24 + b.m24.
+00013880: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
+00013890: 3d20 612e 6d33 3120 2b20 622e 6d33 310a  = a.m31 + b.m31.
+000138a0: 2020 2020 2020 2020 7265 732e 6d33 3220          res.m32 
+000138b0: 3d20 612e 6d33 3220 2b20 622e 6d33 320a  = a.m32 + b.m32.
+000138c0: 2020 2020 2020 2020 7265 732e 6d33 3320          res.m33 
+000138d0: 3d20 612e 6d33 3320 2b20 622e 6d33 330a  = a.m33 + b.m33.
+000138e0: 2020 2020 2020 2020 7265 732e 6d33 3420          res.m34 
+000138f0: 3d20 612e 6d33 3420 2b20 622e 6d33 340a  = a.m34 + b.m34.
+00013900: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
+00013910: 3d20 612e 6d34 3120 2b20 622e 6d34 310a  = a.m41 + b.m41.
+00013920: 2020 2020 2020 2020 7265 732e 6d34 3220          res.m42 
+00013930: 3d20 612e 6d34 3220 2b20 622e 6d34 320a  = a.m42 + b.m42.
+00013940: 2020 2020 2020 2020 7265 732e 6d34 3320          res.m43 
+00013950: 3d20 612e 6d34 3320 2b20 622e 6d34 330a  = a.m43 + b.m43.
+00013960: 2020 2020 2020 2020 7265 732e 6d34 3420          res.m44 
+00013970: 3d20 612e 6d34 3420 2b20 622e 6d34 340a  = a.m44 + b.m44.
+00013980: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00013990: 6573 0a0a 2020 2020 6465 6620 5f5f 7375  es..    def __su
+000139a0: 625f 5f28 6d61 7434 2061 2c20 6d61 7434  b__(mat4 a, mat4
+000139b0: 2062 293a 0a20 2020 2020 2020 2022 2222   b):.        """
+000139c0: 4d61 7472 6978 2073 7562 7472 6163 7469  Matrix subtracti
+000139d0: 6f6e 2e0a 0a20 2020 2020 2020 203e 3e3e  on...        >>>
+000139e0: 204d 3d6d 6174 3428 312c 322c 332c 342c   M=mat4(1,2,3,4,
+000139f0: 352c 362c 372c 382c 392c 3130 2c31 312c  5,6,7,8,9,10,11,
+00013a00: 3132 2c31 332c 3134 2c31 352c 3136 290a  12,13,14,15,16).
+00013a10: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00013a20: 7420 4d2d 4d0a 2020 2020 2020 2020 5b20  t M-M.        [ 
+00013a30: 2020 302e 3030 3030 2c20 2020 2030 2e30    0.0000,    0.0
+00013a40: 3030 302c 2020 2020 302e 3030 3030 2c20  000,    0.0000, 
+00013a50: 2020 2030 2e30 3030 305d 0a20 2020 2020     0.0000].     
+00013a60: 2020 205b 2020 2030 2e30 3030 302c 2020     [   0.0000,  
+00013a70: 2020 302e 3030 3030 2c20 2020 2030 2e30    0.0000,    0.0
+00013a80: 3030 302c 2020 2020 302e 3030 3030 5d0a  000,    0.0000].
+00013a90: 2020 2020 2020 2020 5b20 2020 302e 3030          [   0.00
+00013aa0: 3030 2c20 2020 2030 2e30 3030 302c 2020  00,    0.0000,  
+00013ab0: 2020 302e 3030 3030 2c20 2020 2030 2e30    0.0000,    0.0
+00013ac0: 3030 305d 0a20 2020 2020 2020 205b 2020  000].        [  
+00013ad0: 2030 2e30 3030 302c 2020 2020 302e 3030   0.0000,    0.00
+00013ae0: 3030 2c20 2020 2030 2e30 3030 302c 2020  00,    0.0000,  
+00013af0: 2020 302e 3030 3030 5d0a 2020 2020 2020    0.0000].      
+00013b00: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
+00013b10: 6566 206d 6174 3420 7265 730a 2020 2020  ef mat4 res.    
+00013b20: 2020 2020 7265 7320 3d20 6d61 7434 2829      res = mat4()
+00013b30: 0a20 2020 2020 2020 2072 6573 2e6d 3131  .        res.m11
+00013b40: 203d 2061 2e6d 3131 202d 2062 2e6d 3131   = a.m11 - b.m11
+00013b50: 0a20 2020 2020 2020 2072 6573 2e6d 3132  .        res.m12
+00013b60: 203d 2061 2e6d 3132 202d 2062 2e6d 3132   = a.m12 - b.m12
+00013b70: 0a20 2020 2020 2020 2072 6573 2e6d 3133  .        res.m13
+00013b80: 203d 2061 2e6d 3133 202d 2062 2e6d 3133   = a.m13 - b.m13
+00013b90: 0a20 2020 2020 2020 2072 6573 2e6d 3134  .        res.m14
+00013ba0: 203d 2061 2e6d 3134 202d 2062 2e6d 3134   = a.m14 - b.m14
+00013bb0: 0a20 2020 2020 2020 2072 6573 2e6d 3231  .        res.m21
+00013bc0: 203d 2061 2e6d 3231 202d 2062 2e6d 3231   = a.m21 - b.m21
+00013bd0: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
+00013be0: 203d 2061 2e6d 3232 202d 2062 2e6d 3232   = a.m22 - b.m22
+00013bf0: 0a20 2020 2020 2020 2072 6573 2e6d 3233  .        res.m23
+00013c00: 203d 2061 2e6d 3233 202d 2062 2e6d 3233   = a.m23 - b.m23
+00013c10: 0a20 2020 2020 2020 2072 6573 2e6d 3234  .        res.m24
+00013c20: 203d 2061 2e6d 3234 202d 2062 2e6d 3234   = a.m24 - b.m24
+00013c30: 0a20 2020 2020 2020 2072 6573 2e6d 3331  .        res.m31
+00013c40: 203d 2061 2e6d 3331 202d 2062 2e6d 3331   = a.m31 - b.m31
+00013c50: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
+00013c60: 203d 2061 2e6d 3332 202d 2062 2e6d 3332   = a.m32 - b.m32
+00013c70: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
+00013c80: 203d 2061 2e6d 3333 202d 2062 2e6d 3333   = a.m33 - b.m33
+00013c90: 0a20 2020 2020 2020 2072 6573 2e6d 3334  .        res.m34
+00013ca0: 203d 2061 2e6d 3334 202d 2062 2e6d 3334   = a.m34 - b.m34
+00013cb0: 0a20 2020 2020 2020 2072 6573 2e6d 3431  .        res.m41
+00013cc0: 203d 2061 2e6d 3431 202d 2062 2e6d 3431   = a.m41 - b.m41
+00013cd0: 0a20 2020 2020 2020 2072 6573 2e6d 3432  .        res.m42
+00013ce0: 203d 2061 2e6d 3432 202d 2062 2e6d 3432   = a.m42 - b.m42
+00013cf0: 0a20 2020 2020 2020 2072 6573 2e6d 3433  .        res.m43
+00013d00: 203d 2061 2e6d 3433 202d 2062 2e6d 3433   = a.m43 - b.m43
+00013d10: 0a20 2020 2020 2020 2072 6573 2e6d 3434  .        res.m44
+00013d20: 203d 2061 2e6d 3434 202d 2062 2e6d 3434   = a.m44 - b.m44
+00013d30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00013d40: 7265 730a 0a20 2020 2064 6566 205f 5f6d  res..    def __m
+00013d50: 756c 5f5f 2861 2c20 6229 3a0a 2020 2020  ul__(a, b):.    
+00013d60: 2020 2020 2222 224d 756c 7469 706c 6963      """Multiplic
+00013d70: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+00013d80: 3e3e 3e20 4d3d 6d61 7434 2831 2c32 2c33  >>> M=mat4(1,2,3
+00013d90: 2c34 2c35 2c36 2c37 2c38 2c39 2c31 302c  ,4,5,6,7,8,9,10,
+00013da0: 3131 2c31 322c 3133 2c31 342c 3135 2c31  11,12,13,14,15,1
+00013db0: 3629 0a20 2020 2020 2020 203e 3e3e 2070  6).        >>> p
+00013dc0: 7269 6e74 204d 2a32 2e30 0a20 2020 2020  rint M*2.0.     
+00013dd0: 2020 205b 2020 2032 2e30 3030 302c 2020     [   2.0000,  
+00013de0: 2020 342e 3030 3030 2c20 2020 2036 2e30    4.0000,    6.0
+00013df0: 3030 302c 2020 2020 382e 3030 3030 5d0a  000,    8.0000].
+00013e00: 2020 2020 2020 2020 5b20 2031 302e 3030          [  10.00
+00013e10: 3030 2c20 2020 3132 2e30 3030 302c 2020  00,   12.0000,  
+00013e20: 2031 342e 3030 3030 2c20 2020 3136 2e30   14.0000,   16.0
+00013e30: 3030 305d 0a20 2020 2020 2020 205b 2020  000].        [  
+00013e40: 3138 2e30 3030 302c 2020 2032 302e 3030  18.0000,   20.00
+00013e50: 3030 2c20 2020 3232 2e30 3030 302c 2020  00,   22.0000,  
+00013e60: 2032 342e 3030 3030 5d0a 2020 2020 2020   24.0000].      
+00013e70: 2020 5b20 2032 362e 3030 3030 2c20 2020    [  26.0000,   
+00013e80: 3238 2e30 3030 302c 2020 2033 302e 3030  28.0000,   30.00
+00013e90: 3030 2c20 2020 3332 2e30 3030 305d 0a20  00,   32.0000]. 
+00013ea0: 2020 2020 2020 203e 3e3e 2070 7269 6e74         >>> print
+00013eb0: 2032 2e30 2a4d 0a20 2020 2020 2020 205b   2.0*M.        [
+00013ec0: 2020 2032 2e30 3030 302c 2020 2020 342e     2.0000,    4.
+00013ed0: 3030 3030 2c20 2020 2036 2e30 3030 302c  0000,    6.0000,
+00013ee0: 2020 2020 382e 3030 3030 5d0a 2020 2020      8.0000].    
+00013ef0: 2020 2020 5b20 2031 302e 3030 3030 2c20      [  10.0000, 
+00013f00: 2020 3132 2e30 3030 302c 2020 2031 342e    12.0000,   14.
+00013f10: 3030 3030 2c20 2020 3136 2e30 3030 305d  0000,   16.0000]
+00013f20: 0a20 2020 2020 2020 205b 2020 3138 2e30  .        [  18.0
+00013f30: 3030 302c 2020 2032 302e 3030 3030 2c20  000,   20.0000, 
+00013f40: 2020 3232 2e30 3030 302c 2020 2032 342e    22.0000,   24.
+00013f50: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
+00013f60: 2032 362e 3030 3030 2c20 2020 3238 2e30   26.0000,   28.0
+00013f70: 3030 302c 2020 2033 302e 3030 3030 2c20  000,   30.0000, 
+00013f80: 2020 3332 2e30 3030 305d 0a20 2020 2020    32.0000].     
+00013f90: 2020 203e 3e3e 2070 7269 6e74 204d 2a4d     >>> print M*M
+00013fa0: 0a20 2020 2020 2020 205b 2020 3930 2e30  .        [  90.0
+00013fb0: 3030 302c 2020 3130 302e 3030 3030 2c20  000,  100.0000, 
+00013fc0: 2031 3130 2e30 3030 302c 2020 3132 302e   110.0000,  120.
+00013fd0: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
+00013fe0: 3230 322e 3030 3030 2c20 2032 3238 2e30  202.0000,  228.0
+00013ff0: 3030 302c 2020 3235 342e 3030 3030 2c20  000,  254.0000, 
+00014000: 2032 3830 2e30 3030 305d 0a20 2020 2020   280.0000].     
+00014010: 2020 205b 2033 3134 2e30 3030 302c 2020     [ 314.0000,  
+00014020: 3335 362e 3030 3030 2c20 2033 3938 2e30  356.0000,  398.0
+00014030: 3030 302c 2020 3434 302e 3030 3030 5d0a  000,  440.0000].
+00014040: 2020 2020 2020 2020 5b20 3432 362e 3030          [ 426.00
+00014050: 3030 2c20 2034 3834 2e30 3030 302c 2020  00,  484.0000,  
+00014060: 3534 322e 3030 3030 2c20 2036 3030 2e30  542.0000,  600.0
+00014070: 3030 305d 0a20 2020 2020 2020 203e 3e3e  000].        >>>
+00014080: 2070 7269 6e74 204d 2a5f 7665 6333 2831   print M*_vec3(1
+00014090: 2c32 2c33 290a 2020 2020 2020 2020 2830  ,2,3).        (0
+000140a0: 2e31 3736 352c 2030 2e34 3531 302c 2030  .1765, 0.4510, 0
+000140b0: 2e37 3235 3529 0a20 2020 2020 2020 203e  .7255).        >
+000140c0: 3e3e 2070 7269 6e74 205f 7665 6333 2831  >> print _vec3(1
+000140d0: 2c32 2c33 292a 4d0a 2020 2020 2020 2020  ,2,3)*M.        
+000140e0: 2830 2e37 3038 332c 2030 2e38 3035 362c  (0.7083, 0.8056,
+000140f0: 2030 2e39 3032 3829 0a20 2020 2020 2020   0.9028).       
+00014100: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00014110: 6620 6d61 7434 206d 612c 206d 622c 2072  f mat4 ma, mb, r
+00014120: 6573 0a20 2020 2020 2020 2063 6465 6620  es.        cdef 
+00014130: 7665 6333 2076 612c 2076 622c 2076 7265  vec3 va, vb, vre
+00014140: 730a 2020 2020 2020 2020 6364 6566 2076  s.        cdef v
+00014150: 6563 3420 7761 2c20 7762 2c20 7772 6573  ec4 wa, wb, wres
+00014160: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
+00014170: 7562 6c65 2072 2c20 770a 0a20 2020 2020  uble r, w..     
+00014180: 2020 2074 6120 3d20 7479 7065 2861 290a     ta = type(a).
+00014190: 2020 2020 2020 2020 7462 203d 2074 7970          tb = typ
+000141a0: 6528 6229 0a0a 2020 2020 2020 2020 2320  e(b)..        # 
+000141b0: 6d61 7434 206f 6e20 7468 6520 6c65 6674  mat4 on the left
+000141c0: 3f0a 2020 2020 2020 2020 6966 2074 6120  ?.        if ta 
+000141d0: 6973 206d 6174 343a 0a20 2020 2020 2020  is mat4:.       
+000141e0: 2020 2020 206d 6120 3d20 610a 2020 2020       ma = a.    
+000141f0: 2020 2020 2020 2020 2320 6d61 7434 206f          # mat4 o
+00014200: 6e20 7468 6520 7269 6768 743f 0a20 2020  n the right?.   
+00014210: 2020 2020 2020 2020 2069 6620 7462 2069           if tb i
+00014220: 7320 6d61 7434 3a0a 2020 2020 2020 2020  s mat4:.        
+00014230: 2020 2020 2020 2020 2320 6d61 7434 2a6d          # mat4*m
+00014240: 6174 340a 2020 2020 2020 2020 2020 2020  at4.            
+00014250: 2020 2020 7265 7320 3d20 6d61 7434 2829      res = mat4()
+00014260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014270: 206d 6220 3d20 620a 2020 2020 2020 2020   mb = b.        
+00014280: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
+00014290: 3d20 6d61 2e6d 3131 2a6d 622e 6d31 312b  = ma.m11*mb.m11+
+000142a0: 6d61 2e6d 3132 2a6d 622e 6d32 312b 6d61  ma.m12*mb.m21+ma
+000142b0: 2e6d 3133 2a6d 622e 6d33 312b 6d61 2e6d  .m13*mb.m31+ma.m
+000142c0: 3134 2a6d 622e 6d34 310a 2020 2020 2020  14*mb.m41.      
+000142d0: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+000142e0: 3220 3d20 6d61 2e6d 3131 2a6d 622e 6d31  2 = ma.m11*mb.m1
+000142f0: 322b 6d61 2e6d 3132 2a6d 622e 6d32 322b  2+ma.m12*mb.m22+
+00014300: 6d61 2e6d 3133 2a6d 622e 6d33 322b 6d61  ma.m13*mb.m32+ma
+00014310: 2e6d 3134 2a6d 622e 6d34 320a 2020 2020  .m14*mb.m42.    
+00014320: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00014330: 6d31 3320 3d20 6d61 2e6d 3131 2a6d 622e  m13 = ma.m11*mb.
+00014340: 6d31 332b 6d61 2e6d 3132 2a6d 622e 6d32  m13+ma.m12*mb.m2
+00014350: 332b 6d61 2e6d 3133 2a6d 622e 6d33 332b  3+ma.m13*mb.m33+
+00014360: 6d61 2e6d 3134 2a6d 622e 6d34 330a 2020  ma.m14*mb.m43.  
+00014370: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00014380: 732e 6d31 3420 3d20 6d61 2e6d 3131 2a6d  s.m14 = ma.m11*m
+00014390: 622e 6d31 342b 6d61 2e6d 3132 2a6d 622e  b.m14+ma.m12*mb.
+000143a0: 6d32 342b 6d61 2e6d 3133 2a6d 622e 6d33  m24+ma.m13*mb.m3
+000143b0: 342b 6d61 2e6d 3134 2a6d 622e 6d34 340a  4+ma.m14*mb.m44.
+000143c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000143d0: 7265 732e 6d32 3120 3d20 6d61 2e6d 3231  res.m21 = ma.m21
+000143e0: 2a6d 622e 6d31 312b 6d61 2e6d 3232 2a6d  *mb.m11+ma.m22*m
+000143f0: 622e 6d32 312b 6d61 2e6d 3233 2a6d 622e  b.m21+ma.m23*mb.
+00014400: 6d33 312b 6d61 2e6d 3234 2a6d 622e 6d34  m31+ma.m24*mb.m4
+00014410: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+00014420: 2020 7265 732e 6d32 3220 3d20 6d61 2e6d    res.m22 = ma.m
+00014430: 3231 2a6d 622e 6d31 322b 6d61 2e6d 3232  21*mb.m12+ma.m22
+00014440: 2a6d 622e 6d32 322b 6d61 2e6d 3233 2a6d  *mb.m22+ma.m23*m
+00014450: 622e 6d33 322b 6d61 2e6d 3234 2a6d 622e  b.m32+ma.m24*mb.
+00014460: 6d34 320a 2020 2020 2020 2020 2020 2020  m42.            
+00014470: 2020 2020 7265 732e 6d32 3320 3d20 6d61      res.m23 = ma
+00014480: 2e6d 3231 2a6d 622e 6d31 332b 6d61 2e6d  .m21*mb.m13+ma.m
+00014490: 3232 2a6d 622e 6d32 332b 6d61 2e6d 3233  22*mb.m23+ma.m23
+000144a0: 2a6d 622e 6d33 332b 6d61 2e6d 3234 2a6d  *mb.m33+ma.m24*m
+000144b0: 622e 6d34 330a 2020 2020 2020 2020 2020  b.m43.          
+000144c0: 2020 2020 2020 7265 732e 6d32 3420 3d20        res.m24 = 
+000144d0: 6d61 2e6d 3231 2a6d 622e 6d31 342b 6d61  ma.m21*mb.m14+ma
+000144e0: 2e6d 3232 2a6d 622e 6d32 342b 6d61 2e6d  .m22*mb.m24+ma.m
+000144f0: 3233 2a6d 622e 6d33 342b 6d61 2e6d 3234  23*mb.m34+ma.m24
+00014500: 2a6d 622e 6d34 340a 2020 2020 2020 2020  *mb.m44.        
+00014510: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
+00014520: 3d20 6d61 2e6d 3331 2a6d 622e 6d31 312b  = ma.m31*mb.m11+
+00014530: 6d61 2e6d 3332 2a6d 622e 6d32 312b 6d61  ma.m32*mb.m21+ma
+00014540: 2e6d 3333 2a6d 622e 6d33 312b 6d61 2e6d  .m33*mb.m31+ma.m
+00014550: 3334 2a6d 622e 6d34 310a 2020 2020 2020  34*mb.m41.      
+00014560: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
+00014570: 3220 3d20 6d61 2e6d 3331 2a6d 622e 6d31  2 = ma.m31*mb.m1
+00014580: 322b 6d61 2e6d 3332 2a6d 622e 6d32 322b  2+ma.m32*mb.m22+
+00014590: 6d61 2e6d 3333 2a6d 622e 6d33 322b 6d61  ma.m33*mb.m32+ma
+000145a0: 2e6d 3334 2a6d 622e 6d34 320a 2020 2020  .m34*mb.m42.    
+000145b0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+000145c0: 6d33 3320 3d20 6d61 2e6d 3331 2a6d 622e  m33 = ma.m31*mb.
+000145d0: 6d31 332b 6d61 2e6d 3332 2a6d 622e 6d32  m13+ma.m32*mb.m2
+000145e0: 332b 6d61 2e6d 3333 2a6d 622e 6d33 332b  3+ma.m33*mb.m33+
+000145f0: 6d61 2e6d 3334 2a6d 622e 6d34 330a 2020  ma.m34*mb.m43.  
+00014600: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00014610: 732e 6d33 3420 3d20 6d61 2e6d 3331 2a6d  s.m34 = ma.m31*m
+00014620: 622e 6d31 342b 6d61 2e6d 3332 2a6d 622e  b.m14+ma.m32*mb.
+00014630: 6d32 342b 6d61 2e6d 3333 2a6d 622e 6d33  m24+ma.m33*mb.m3
+00014640: 342b 6d61 2e6d 3334 2a6d 622e 6d34 340a  4+ma.m34*mb.m44.
+00014650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014660: 7265 732e 6d34 3120 3d20 6d61 2e6d 3431  res.m41 = ma.m41
+00014670: 2a6d 622e 6d31 312b 6d61 2e6d 3432 2a6d  *mb.m11+ma.m42*m
+00014680: 622e 6d32 312b 6d61 2e6d 3433 2a6d 622e  b.m21+ma.m43*mb.
+00014690: 6d33 312b 6d61 2e6d 3434 2a6d 622e 6d34  m31+ma.m44*mb.m4
+000146a0: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+000146b0: 2020 7265 732e 6d34 3220 3d20 6d61 2e6d    res.m42 = ma.m
+000146c0: 3431 2a6d 622e 6d31 322b 6d61 2e6d 3432  41*mb.m12+ma.m42
+000146d0: 2a6d 622e 6d32 322b 6d61 2e6d 3433 2a6d  *mb.m22+ma.m43*m
+000146e0: 622e 6d33 322b 6d61 2e6d 3434 2a6d 622e  b.m32+ma.m44*mb.
+000146f0: 6d34 320a 2020 2020 2020 2020 2020 2020  m42.            
+00014700: 2020 2020 7265 732e 6d34 3320 3d20 6d61      res.m43 = ma
+00014710: 2e6d 3431 2a6d 622e 6d31 332b 6d61 2e6d  .m41*mb.m13+ma.m
+00014720: 3432 2a6d 622e 6d32 332b 6d61 2e6d 3433  42*mb.m23+ma.m43
+00014730: 2a6d 622e 6d33 332b 6d61 2e6d 3434 2a6d  *mb.m33+ma.m44*m
+00014740: 622e 6d34 330a 2020 2020 2020 2020 2020  b.m43.          
+00014750: 2020 2020 2020 7265 732e 6d34 3420 3d20        res.m44 = 
+00014760: 6d61 2e6d 3431 2a6d 622e 6d31 342b 6d61  ma.m41*mb.m14+ma
+00014770: 2e6d 3432 2a6d 622e 6d32 342b 6d61 2e6d  .m42*mb.m24+ma.m
+00014780: 3433 2a6d 622e 6d33 342b 6d61 2e6d 3434  43*mb.m34+ma.m44
+00014790: 2a6d 622e 6d34 340a 2020 2020 2020 2020  *mb.m44.        
+000147a0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+000147b0: 6573 0a20 2020 2020 2020 2020 2020 2023  es.            #
+000147c0: 2076 6563 3420 6f6e 2074 6865 2072 6967   vec4 on the rig
+000147d0: 6874 3f0a 2020 2020 2020 2020 2020 2020  ht?.            
+000147e0: 656c 6966 2074 6220 6973 2076 6563 343a  elif tb is vec4:
+000147f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014800: 2023 206d 6174 342a 7665 6334 0a20 2020   # mat4*vec4.   
+00014810: 2020 2020 2020 2020 2020 2020 2077 7265               wre
+00014820: 7320 3d20 7665 6334 2829 0a20 2020 2020  s = vec4().     
+00014830: 2020 2020 2020 2020 2020 2077 6220 2020             wb   
+00014840: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
+00014850: 2020 2020 7772 6573 2e78 203d 206d 612e      wres.x = ma.
+00014860: 6d31 312a 7762 2e78 202b 206d 612e 6d31  m11*wb.x + ma.m1
+00014870: 322a 7762 2e79 202b 206d 612e 6d31 332a  2*wb.y + ma.m13*
+00014880: 7762 2e7a 202b 206d 612e 6d31 342a 7762  wb.z + ma.m14*wb
+00014890: 2e77 0a20 2020 2020 2020 2020 2020 2020  .w.             
+000148a0: 2020 2077 7265 732e 7920 3d20 6d61 2e6d     wres.y = ma.m
+000148b0: 3231 2a77 622e 7820 2b20 6d61 2e6d 3232  21*wb.x + ma.m22
+000148c0: 2a77 622e 7920 2b20 6d61 2e6d 3233 2a77  *wb.y + ma.m23*w
+000148d0: 622e 7a20 2b20 6d61 2e6d 3234 2a77 622e  b.z + ma.m24*wb.
+000148e0: 770a 2020 2020 2020 2020 2020 2020 2020  w.              
+000148f0: 2020 7772 6573 2e7a 203d 206d 612e 6d33    wres.z = ma.m3
+00014900: 312a 7762 2e78 202b 206d 612e 6d33 322a  1*wb.x + ma.m32*
+00014910: 7762 2e79 202b 206d 612e 6d33 332a 7762  wb.y + ma.m33*wb
+00014920: 2e7a 202b 206d 612e 6d33 342a 7762 2e77  .z + ma.m34*wb.w
+00014930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014940: 2077 7265 732e 7720 3d20 6d61 2e6d 3431   wres.w = ma.m41
+00014950: 2a77 622e 7820 2b20 6d61 2e6d 3432 2a77  *wb.x + ma.m42*w
+00014960: 622e 7920 2b20 6d61 2e6d 3433 2a77 622e  b.y + ma.m43*wb.
+00014970: 7a20 2b20 6d61 2e6d 3434 2a77 622e 770a  z + ma.m44*wb.w.
+00014980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014990: 7265 7475 726e 2077 7265 730a 2020 2020  return wres.    
+000149a0: 2020 2020 2020 2020 2320 7665 6333 206f          # vec3 o
+000149b0: 6e20 7468 6520 7269 6768 743f 0a20 2020  n the right?.   
+000149c0: 2020 2020 2020 2020 2065 6c69 6620 7462           elif tb
+000149d0: 2069 7320 7665 6333 3a0a 2020 2020 2020   is vec3:.      
+000149e0: 2020 2020 2020 2020 2020 2320 6d61 7434            # mat4
+000149f0: 2a76 6563 330a 2020 2020 2020 2020 2020  *vec3.          
+00014a00: 2020 2020 2020 7672 6573 203d 2076 6563        vres = vec
+00014a10: 3328 290a 2020 2020 2020 2020 2020 2020  3().            
+00014a20: 2020 2020 7662 2020 203d 2062 0a20 2020      vb   = b.   
+00014a30: 2020 2020 2020 2020 2020 2020 2076 7265               vre
+00014a40: 732e 7820 3d20 6d61 2e6d 3131 2a76 622e  s.x = ma.m11*vb.
+00014a50: 7820 2b20 6d61 2e6d 3132 2a76 622e 7920  x + ma.m12*vb.y 
+00014a60: 2b20 6d61 2e6d 3133 2a76 622e 7a20 2b20  + ma.m13*vb.z + 
+00014a70: 6d61 2e6d 3134 0a20 2020 2020 2020 2020  ma.m14.         
+00014a80: 2020 2020 2020 2076 7265 732e 7920 3d20         vres.y = 
+00014a90: 6d61 2e6d 3231 2a76 622e 7820 2b20 6d61  ma.m21*vb.x + ma
+00014aa0: 2e6d 3232 2a76 622e 7920 2b20 6d61 2e6d  .m22*vb.y + ma.m
+00014ab0: 3233 2a76 622e 7a20 2b20 6d61 2e6d 3234  23*vb.z + ma.m24
+00014ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014ad0: 2076 7265 732e 7a20 3d20 6d61 2e6d 3331   vres.z = ma.m31
+00014ae0: 2a76 622e 7820 2b20 6d61 2e6d 3332 2a76  *vb.x + ma.m32*v
+00014af0: 622e 7920 2b20 6d61 2e6d 3333 2a76 622e  b.y + ma.m33*vb.
+00014b00: 7a20 2b20 6d61 2e6d 3334 0a20 2020 2020  z + ma.m34.     
+00014b10: 2020 2020 2020 2020 2020 2077 2020 2020             w    
+00014b20: 3d20 6d61 2e6d 3431 2a76 622e 7820 2b20  = ma.m41*vb.x + 
+00014b30: 6d61 2e6d 3432 2a76 622e 7920 2b20 6d61  ma.m42*vb.y + ma
+00014b40: 2e6d 3433 2a76 622e 7a20 2b20 6d61 2e6d  .m43*vb.z + ma.m
+00014b50: 3434 0a20 2020 2020 2020 2020 2020 2020  44.             
+00014b60: 2020 2069 6620 6661 6273 2877 293e 6570     if fabs(w)>ep
+00014b70: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00014b80: 2020 2020 2020 2076 7265 732e 7820 3d20         vres.x = 
+00014b90: 7672 6573 2e78 2f77 0a20 2020 2020 2020  vres.x/w.       
+00014ba0: 2020 2020 2020 2020 2020 2020 2076 7265               vre
+00014bb0: 732e 7920 3d20 7672 6573 2e79 2f77 0a20  s.y = vres.y/w. 
+00014bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014bd0: 2020 2076 7265 732e 7a20 3d20 7672 6573     vres.z = vres
+00014be0: 2e7a 2f77 0a20 2020 2020 2020 2020 2020  .z/w.           
+00014bf0: 2020 2020 2072 6574 7572 6e20 7672 6573       return vres
+00014c00: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
+00014c10: 6361 6c61 7220 6f6e 2074 6865 2072 6967  calar on the rig
+00014c20: 6874 3f0a 2020 2020 2020 2020 2020 2020  ht?.            
+00014c30: 656c 6966 2074 6220 6973 2066 6c6f 6174  elif tb is float
+00014c40: 206f 7220 7462 2069 7320 696e 7420 6f72   or tb is int or
+00014c50: 2074 6220 6973 206c 6f6e 673a 0a20 2020   tb is long:.   
+00014c60: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00014c70: 203d 206d 6174 3428 290a 2020 2020 2020   = mat4().      
+00014c80: 2020 2020 2020 2020 2020 7220 3d20 620a            r = b.
+00014c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ca0: 7265 732e 6d31 3120 3d20 6d61 2e6d 3131  res.m11 = ma.m11
+00014cb0: 2a72 0a20 2020 2020 2020 2020 2020 2020  *r.             
+00014cc0: 2020 2072 6573 2e6d 3132 203d 206d 612e     res.m12 = ma.
+00014cd0: 6d31 322a 720a 2020 2020 2020 2020 2020  m12*r.          
+00014ce0: 2020 2020 2020 7265 732e 6d31 3320 3d20        res.m13 = 
+00014cf0: 6d61 2e6d 3133 2a72 0a20 2020 2020 2020  ma.m13*r.       
+00014d00: 2020 2020 2020 2020 2072 6573 2e6d 3134           res.m14
+00014d10: 203d 206d 612e 6d31 342a 720a 2020 2020   = ma.m14*r.    
+00014d20: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00014d30: 6d32 3120 3d20 6d61 2e6d 3231 2a72 0a20  m21 = ma.m21*r. 
+00014d40: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00014d50: 6573 2e6d 3232 203d 206d 612e 6d32 322a  es.m22 = ma.m22*
+00014d60: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00014d70: 2020 7265 732e 6d32 3320 3d20 6d61 2e6d    res.m23 = ma.m
+00014d80: 3233 2a72 0a20 2020 2020 2020 2020 2020  23*r.           
+00014d90: 2020 2020 2072 6573 2e6d 3234 203d 206d       res.m24 = m
+00014da0: 612e 6d32 342a 720a 2020 2020 2020 2020  a.m24*r.        
+00014db0: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
+00014dc0: 3d20 6d61 2e6d 3331 2a72 0a20 2020 2020  = ma.m31*r.     
+00014dd0: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+00014de0: 3332 203d 206d 612e 6d33 322a 720a 2020  32 = ma.m32*r.  
+00014df0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00014e00: 732e 6d33 3320 3d20 6d61 2e6d 3333 2a72  s.m33 = ma.m33*r
+00014e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014e20: 2072 6573 2e6d 3334 203d 206d 612e 6d33   res.m34 = ma.m3
+00014e30: 342a 720a 2020 2020 2020 2020 2020 2020  4*r.            
+00014e40: 2020 2020 7265 732e 6d34 3120 3d20 6d61      res.m41 = ma
+00014e50: 2e6d 3431 2a72 0a20 2020 2020 2020 2020  .m41*r.         
+00014e60: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
+00014e70: 206d 612e 6d34 322a 720a 2020 2020 2020   ma.m42*r.      
+00014e80: 2020 2020 2020 2020 2020 7265 732e 6d34            res.m4
+00014e90: 3320 3d20 6d61 2e6d 3433 2a72 0a20 2020  3 = ma.m43*r.   
+00014ea0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00014eb0: 2e6d 3434 203d 206d 612e 6d34 342a 720a  .m44 = ma.m44*r.
+00014ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ed0: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
+00014ee0: 2020 2020 2320 7665 6334 206f 6e20 7468      # vec4 on th
+00014ef0: 6520 6c65 6674 3f20 2874 6865 6e20 7468  e left? (then th
+00014f00: 6572 6520 6d75 7374 2062 6520 6120 6d61  ere must be a ma
+00014f10: 7434 206f 6e20 7468 6520 7269 6768 7429  t4 on the right)
+00014f20: 0a20 2020 2020 2020 2065 6c69 6620 7461  .        elif ta
+00014f30: 2069 7320 7665 6334 3a0a 2020 2020 2020   is vec4:.      
+00014f40: 2020 2020 2020 2320 7665 6334 2a6d 6174        # vec4*mat
+00014f50: 340a 2020 2020 2020 2020 2020 2020 7772  4.            wr
+00014f60: 6573 203d 2076 6563 3428 290a 2020 2020  es = vec4().    
+00014f70: 2020 2020 2020 2020 7761 2020 203d 2061          wa   = a
+00014f80: 0a20 2020 2020 2020 2020 2020 206d 6220  .            mb 
+00014f90: 2020 3d20 620a 2020 2020 2020 2020 2020    = b.          
+00014fa0: 2020 7772 6573 2e78 203d 2077 612e 782a    wres.x = wa.x*
+00014fb0: 6d62 2e6d 3131 202b 2077 612e 792a 6d62  mb.m11 + wa.y*mb
+00014fc0: 2e6d 3231 202b 2077 612e 7a2a 6d62 2e6d  .m21 + wa.z*mb.m
+00014fd0: 3331 202b 2077 612e 772a 6d62 2e6d 3431  31 + wa.w*mb.m41
+00014fe0: 0a20 2020 2020 2020 2020 2020 2077 7265  .            wre
+00014ff0: 732e 7920 3d20 7761 2e78 2a6d 622e 6d31  s.y = wa.x*mb.m1
+00015000: 3220 2b20 7761 2e79 2a6d 622e 6d32 3220  2 + wa.y*mb.m22 
+00015010: 2b20 7761 2e7a 2a6d 622e 6d33 3220 2b20  + wa.z*mb.m32 + 
+00015020: 7761 2e77 2a6d 622e 6d34 320a 2020 2020  wa.w*mb.m42.    
+00015030: 2020 2020 2020 2020 7772 6573 2e7a 203d          wres.z =
+00015040: 2077 612e 782a 6d62 2e6d 3133 202b 2077   wa.x*mb.m13 + w
+00015050: 612e 792a 6d62 2e6d 3233 202b 2077 612e  a.y*mb.m23 + wa.
+00015060: 7a2a 6d62 2e6d 3333 202b 2077 612e 772a  z*mb.m33 + wa.w*
+00015070: 6d62 2e6d 3433 0a20 2020 2020 2020 2020  mb.m43.         
+00015080: 2020 2077 7265 732e 7720 3d20 7761 2e78     wres.w = wa.x
+00015090: 2a6d 622e 6d31 3420 2b20 7761 2e79 2a6d  *mb.m14 + wa.y*m
+000150a0: 622e 6d32 3420 2b20 7761 2e7a 2a6d 622e  b.m24 + wa.z*mb.
+000150b0: 6d33 3420 2b20 7761 2e77 2a6d 622e 6d34  m34 + wa.w*mb.m4
+000150c0: 340a 2020 2020 2020 2020 2020 2020 7265  4.            re
+000150d0: 7475 726e 2077 7265 730a 0a20 2020 2020  turn wres..     
+000150e0: 2020 2023 2076 6563 3320 6f6e 2074 6865     # vec3 on the
+000150f0: 206c 6566 743f 2028 7468 656e 2074 6865   left? (then the
+00015100: 7265 206d 7573 7420 6265 2061 206d 6174  re must be a mat
+00015110: 3420 6f6e 2074 6865 2072 6967 6874 290a  4 on the right).
+00015120: 2020 2020 2020 2020 656c 6966 2074 6120          elif ta 
+00015130: 6973 2076 6563 333a 0a20 2020 2020 2020  is vec3:.       
+00015140: 2020 2020 2023 2076 6563 332a 6d61 7434       # vec3*mat4
+00015150: 0a20 2020 2020 2020 2020 2020 2076 7265  .            vre
+00015160: 7320 3d20 7665 6333 2829 0a20 2020 2020  s = vec3().     
+00015170: 2020 2020 2020 2076 6120 2020 3d20 610a         va   = a.
+00015180: 2020 2020 2020 2020 2020 2020 6d62 2020              mb  
+00015190: 203d 2062 0a20 2020 2020 2020 2020 2020   = b.           
+000151a0: 2076 7265 732e 7820 3d20 7661 2e78 2a6d   vres.x = va.x*m
+000151b0: 622e 6d31 3120 2b20 7661 2e79 2a6d 622e  b.m11 + va.y*mb.
+000151c0: 6d32 3120 2b20 7661 2e7a 2a6d 622e 6d33  m21 + va.z*mb.m3
+000151d0: 3120 2b20 6d62 2e6d 3431 0a20 2020 2020  1 + mb.m41.     
+000151e0: 2020 2020 2020 2076 7265 732e 7920 3d20         vres.y = 
+000151f0: 7661 2e78 2a6d 622e 6d31 3220 2b20 7661  va.x*mb.m12 + va
+00015200: 2e79 2a6d 622e 6d32 3220 2b20 7661 2e7a  .y*mb.m22 + va.z
+00015210: 2a6d 622e 6d33 3220 2b20 6d62 2e6d 3432  *mb.m32 + mb.m42
+00015220: 0a20 2020 2020 2020 2020 2020 2076 7265  .            vre
+00015230: 732e 7a20 3d20 7661 2e78 2a6d 622e 6d31  s.z = va.x*mb.m1
+00015240: 3320 2b20 7661 2e79 2a6d 622e 6d32 3320  3 + va.y*mb.m23 
+00015250: 2b20 7661 2e7a 2a6d 622e 6d33 3320 2b20  + va.z*mb.m33 + 
+00015260: 6d62 2e6d 3433 0a20 2020 2020 2020 2020  mb.m43.         
+00015270: 2020 2077 203d 2076 612e 782a 6d62 2e6d     w = va.x*mb.m
+00015280: 3134 202b 2076 612e 792a 6d62 2e6d 3234  14 + va.y*mb.m24
+00015290: 202b 2076 612e 7a2a 6d62 2e6d 3334 202b   + va.z*mb.m34 +
+000152a0: 206d 622e 6d34 340a 2020 2020 2020 2020   mb.m44.        
+000152b0: 2020 2020 6966 2066 6162 7328 7729 3e65      if fabs(w)>e
+000152c0: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
+000152d0: 2020 2020 7672 6573 2e78 203d 2076 7265      vres.x = vre
+000152e0: 732e 782f 770a 2020 2020 2020 2020 2020  s.x/w.          
+000152f0: 2020 2020 2020 7672 6573 2e79 203d 2076        vres.y = v
+00015300: 7265 732e 792f 770a 2020 2020 2020 2020  res.y/w.        
+00015310: 2020 2020 2020 2020 7672 6573 2e7a 203d          vres.z =
+00015320: 2076 7265 732e 7a2f 770a 2020 2020 2020   vres.z/w.      
+00015330: 2020 2020 2020 7265 7475 726e 2076 7265        return vre
+00015340: 730a 0a20 2020 2020 2020 2023 2053 6361  s..        # Sca
+00015350: 6c61 7220 6f6e 2074 6865 206c 6566 743f  lar on the left?
+00015360: 2028 7468 656e 2074 6865 7265 206d 7573   (then there mus
+00015370: 7420 6265 2061 206d 6174 3420 6f6e 2074  t be a mat4 on t
+00015380: 6865 2072 6967 6874 290a 2020 2020 2020  he right).      
+00015390: 2020 656c 6966 2074 6120 6973 2066 6c6f    elif ta is flo
+000153a0: 6174 206f 7220 7461 2069 7320 696e 7420  at or ta is int 
+000153b0: 6f72 2074 6120 6973 206c 6f6e 673a 0a20  or ta is long:. 
+000153c0: 2020 2020 2020 2020 2020 2072 6573 203d             res =
+000153d0: 206d 6174 3428 290a 2020 2020 2020 2020   mat4().        
+000153e0: 2020 2020 7220 203d 2061 0a20 2020 2020      r  = a.     
+000153f0: 2020 2020 2020 206d 6220 3d20 620a 2020         mb = b.  
+00015400: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+00015410: 3120 3d20 722a 6d62 2e6d 3131 0a20 2020  1 = r*mb.m11.   
+00015420: 2020 2020 2020 2020 2072 6573 2e6d 3132           res.m12
+00015430: 203d 2072 2a6d 622e 6d31 320a 2020 2020   = r*mb.m12.    
+00015440: 2020 2020 2020 2020 7265 732e 6d31 3320          res.m13 
+00015450: 3d20 722a 6d62 2e6d 3133 0a20 2020 2020  = r*mb.m13.     
+00015460: 2020 2020 2020 2072 6573 2e6d 3134 203d         res.m14 =
+00015470: 2072 2a6d 622e 6d31 340a 2020 2020 2020   r*mb.m14.      
+00015480: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
+00015490: 722a 6d62 2e6d 3231 0a20 2020 2020 2020  r*mb.m21.       
+000154a0: 2020 2020 2072 6573 2e6d 3232 203d 2072       res.m22 = r
+000154b0: 2a6d 622e 6d32 320a 2020 2020 2020 2020  *mb.m22.        
+000154c0: 2020 2020 7265 732e 6d32 3320 3d20 722a      res.m23 = r*
+000154d0: 6d62 2e6d 3233 0a20 2020 2020 2020 2020  mb.m23.         
+000154e0: 2020 2072 6573 2e6d 3234 203d 2072 2a6d     res.m24 = r*m
+000154f0: 622e 6d32 340a 2020 2020 2020 2020 2020  b.m24.          
+00015500: 2020 7265 732e 6d33 3120 3d20 722a 6d62    res.m31 = r*mb
+00015510: 2e6d 3331 0a20 2020 2020 2020 2020 2020  .m31.           
+00015520: 2072 6573 2e6d 3332 203d 2072 2a6d 622e   res.m32 = r*mb.
+00015530: 6d33 320a 2020 2020 2020 2020 2020 2020  m32.            
+00015540: 7265 732e 6d33 3320 3d20 722a 6d62 2e6d  res.m33 = r*mb.m
+00015550: 3333 0a20 2020 2020 2020 2020 2020 2072  33.            r
+00015560: 6573 2e6d 3334 203d 2072 2a6d 622e 6d33  es.m34 = r*mb.m3
+00015570: 340a 2020 2020 2020 2020 2020 2020 7265  4.            re
+00015580: 732e 6d34 3120 3d20 722a 6d62 2e6d 3431  s.m41 = r*mb.m41
+00015590: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+000155a0: 2e6d 3432 203d 2072 2a6d 622e 6d34 320a  .m42 = r*mb.m42.
+000155b0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+000155c0: 6d34 3320 3d20 722a 6d62 2e6d 3433 0a20  m43 = r*mb.m43. 
+000155d0: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+000155e0: 3434 203d 2072 2a6d 622e 6d34 340a 2020  44 = r*mb.m44.  
+000155f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00015600: 2072 6573 0a0a 2020 2020 2020 2020 2320   res..        # 
+00015610: 4e6f 2076 616c 6964 2063 6f6d 6269 6e61  No valid combina
+00015620: 7469 6f6e 2066 6f75 6e64 0a20 2020 2020  tion found.     
+00015630: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00015640: 6f72 2c20 2275 6e73 7570 706f 7274 6564  or, "unsupported
+00015650: 206f 7065 7261 6e64 2074 7970 6520 666f   operand type fo
+00015660: 7220 2a22 0a0a 2020 2020 6465 6620 5f5f  r *"..    def __
+00015670: 6469 765f 5f28 6d61 7434 2061 2c20 6229  div__(mat4 a, b)
+00015680: 3a0a 2020 2020 2020 2020 2320 5079 7468  :.        # Pyth
+00015690: 6f6e 2032 0a20 2020 2020 2020 2072 6574  on 2.        ret
+000156a0: 7572 6e20 6d61 7434 2e5f 5f74 7275 6564  urn mat4.__trued
+000156b0: 6976 5f5f 2861 2c62 290a 0a20 2020 2064  iv__(a,b)..    d
+000156c0: 6566 205f 5f74 7275 6564 6976 5f5f 286d  ef __truediv__(m
+000156d0: 6174 3420 612c 2062 293a 0a20 2020 2020  at4 a, b):.     
+000156e0: 2020 2022 2222 4469 7669 7369 6f6e 2e0a     """Division..
+000156f0: 0a20 2020 2020 2020 203e 3e3e 204d 3d6d  .        >>> M=m
+00015700: 6174 3428 312c 322c 332c 342c 352c 362c  at4(1,2,3,4,5,6,
+00015710: 372c 382c 392c 3130 2c31 312c 3132 2c31  7,8,9,10,11,12,1
+00015720: 332c 3134 2c31 352c 3136 290a 2020 2020  3,14,15,16).    
+00015730: 2020 2020 3e3e 3e20 7072 696e 7420 4d2f      >>> print M/
+00015740: 322e 300a 2020 2020 2020 2020 5b20 2020  2.0.        [   
+00015750: 302e 3530 3030 2c20 2020 2031 2e30 3030  0.5000,    1.000
+00015760: 302c 2020 2020 312e 3530 3030 2c20 2020  0,    1.5000,   
+00015770: 2032 2e30 3030 305d 0a20 2020 2020 2020   2.0000].       
+00015780: 205b 2020 2032 2e35 3030 302c 2020 2020   [   2.5000,    
+00015790: 332e 3030 3030 2c20 2020 2033 2e35 3030  3.0000,    3.500
+000157a0: 302c 2020 2020 342e 3030 3030 5d0a 2020  0,    4.0000].  
+000157b0: 2020 2020 2020 5b20 2020 342e 3530 3030        [   4.5000
+000157c0: 2c20 2020 2035 2e30 3030 302c 2020 2020  ,    5.0000,    
+000157d0: 352e 3530 3030 2c20 2020 2036 2e30 3030  5.5000,    6.000
+000157e0: 305d 0a20 2020 2020 2020 205b 2020 2036  0].        [   6
+000157f0: 2e35 3030 302c 2020 2020 372e 3030 3030  .5000,    7.0000
+00015800: 2c20 2020 2037 2e35 3030 302c 2020 2020  ,    7.5000,    
+00015810: 382e 3030 3030 5d0a 2020 2020 2020 2020  8.0000].        
+00015820: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+00015830: 206d 6174 3420 7265 730a 2020 2020 2020   mat4 res.      
+00015840: 2020 6364 6566 2064 6f75 626c 6520 720a    cdef double r.
+00015850: 0a20 2020 2020 2020 2074 6220 3d20 7479  .        tb = ty
+00015860: 7065 2862 290a 0a20 2020 2020 2020 2069  pe(b)..        i
+00015870: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
+00015880: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
+00015890: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
+000158a0: 2020 2020 2020 2320 6d61 7434 2f73 6361        # mat4/sca
+000158b0: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
+000158c0: 7265 7320 3d20 6d61 7434 2829 0a20 2020  res = mat4().   
+000158d0: 2020 2020 2020 2020 2072 203d 2062 0a20           r = b. 
+000158e0: 2020 2020 2020 2020 2020 2069 6620 6661             if fa
+000158f0: 6273 2872 293c 3d65 7073 3a0a 2020 2020  bs(r)<=eps:.    
+00015900: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00015910: 6520 5a65 726f 4469 7669 7369 6f6e 4572  e ZeroDivisionEr
+00015920: 726f 722c 226d 6174 3420 6469 7669 7369  ror,"mat4 divisi
+00015930: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
+00015940: 7265 732e 6d31 3120 3d20 612e 6d31 312f  res.m11 = a.m11/
+00015950: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
+00015960: 732e 6d31 3220 3d20 612e 6d31 322f 720a  s.m12 = a.m12/r.
+00015970: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00015980: 6d31 3320 3d20 612e 6d31 332f 720a 2020  m13 = a.m13/r.  
+00015990: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+000159a0: 3420 3d20 612e 6d31 342f 720a 2020 2020  4 = a.m14/r.    
+000159b0: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
+000159c0: 3d20 612e 6d32 312f 720a 2020 2020 2020  = a.m21/r.      
+000159d0: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
+000159e0: 612e 6d32 322f 720a 2020 2020 2020 2020  a.m22/r.        
+000159f0: 2020 2020 7265 732e 6d32 3320 3d20 612e      res.m23 = a.
+00015a00: 6d32 332f 720a 2020 2020 2020 2020 2020  m23/r.          
+00015a10: 2020 7265 732e 6d32 3420 3d20 612e 6d32    res.m24 = a.m2
+00015a20: 342f 720a 2020 2020 2020 2020 2020 2020  4/r.            
+00015a30: 7265 732e 6d33 3120 3d20 612e 6d33 312f  res.m31 = a.m31/
+00015a40: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
+00015a50: 732e 6d33 3220 3d20 612e 6d33 322f 720a  s.m32 = a.m32/r.
+00015a60: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00015a70: 6d33 3320 3d20 612e 6d33 332f 720a 2020  m33 = a.m33/r.  
+00015a80: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
+00015a90: 3420 3d20 612e 6d33 342f 720a 2020 2020  4 = a.m34/r.    
+00015aa0: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
+00015ab0: 3d20 612e 6d34 312f 720a 2020 2020 2020  = a.m41/r.      
+00015ac0: 2020 2020 2020 7265 732e 6d34 3220 3d20        res.m42 = 
+00015ad0: 612e 6d34 322f 720a 2020 2020 2020 2020  a.m42/r.        
+00015ae0: 2020 2020 7265 732e 6d34 3320 3d20 612e      res.m43 = a.
+00015af0: 6d34 332f 720a 2020 2020 2020 2020 2020  m43/r.          
+00015b00: 2020 7265 732e 6d34 3420 3d20 612e 6d34    res.m44 = a.m4
+00015b10: 342f 720a 2020 2020 2020 2020 2020 2020  4/r.            
+00015b20: 7265 7475 726e 2072 6573 0a20 2020 2020  return res.     
+00015b30: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00015b40: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00015b50: 7272 6f72 2c20 2275 6e73 7570 706f 7274  rror, "unsupport
+00015b60: 6564 206f 7065 7261 6e64 2074 7970 6520  ed operand type 
+00015b70: 666f 7220 2f22 0a0a 2020 2020 6465 6620  for /"..    def 
+00015b80: 5f5f 6d6f 645f 5f28 6d61 7434 2073 656c  __mod__(mat4 sel
+00015b90: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
+00015ba0: 2020 2022 2222 4d6f 6475 6c6f 2e0a 0a20     """Modulo... 
+00015bb0: 2020 2020 2020 203e 3e3e 204d 3d6d 6174         >>> M=mat
+00015bc0: 3428 312c 322c 332c 342c 352c 362c 372c  4(1,2,3,4,5,6,7,
+00015bd0: 382c 392c 3130 2c31 312c 3132 2c31 332c  8,9,10,11,12,13,
+00015be0: 3134 2c31 352c 3136 290a 2020 2020 2020  14,15,16).      
+00015bf0: 2020 3e3e 3e20 7072 696e 7420 4d25 352e    >>> print M%5.
+00015c00: 300a 2020 2020 2020 2020 5b20 2020 312e  0.        [   1.
+00015c10: 3030 3030 2c20 2020 2032 2e30 3030 302c  0000,    2.0000,
+00015c20: 2020 2020 332e 3030 3030 2c20 2020 2034      3.0000,    4
+00015c30: 2e30 3030 305d 0a20 2020 2020 2020 205b  .0000].        [
+00015c40: 2020 2030 2e30 3030 302c 2020 2020 312e     0.0000,    1.
+00015c50: 3030 3030 2c20 2020 2032 2e30 3030 302c  0000,    2.0000,
+00015c60: 2020 2020 332e 3030 3030 5d0a 2020 2020      3.0000].    
+00015c70: 2020 2020 5b20 2020 342e 3030 3030 2c20      [   4.0000, 
+00015c80: 2020 2030 2e30 3030 302c 2020 2020 312e     0.0000,    1.
+00015c90: 3030 3030 2c20 2020 2032 2e30 3030 305d  0000,    2.0000]
+00015ca0: 0a20 2020 2020 2020 205b 2020 2033 2e30  .        [   3.0
+00015cb0: 3030 302c 2020 2020 342e 3030 3030 2c20  000,    4.0000, 
+00015cc0: 2020 2030 2e30 3030 302c 2020 2020 312e     0.0000,    1.
+00015cd0: 3030 3030 5d0a 2020 2020 2020 2020 2222  0000].        ""
+00015ce0: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
+00015cf0: 6174 3420 6d62 2c20 7265 730a 0a20 2020  at4 mb, res..   
+00015d00: 2020 2020 2074 6220 3d20 7479 7065 286f       tb = type(o
+00015d10: 7468 6572 290a 0a20 2020 2020 2020 2069  ther)..        i
+00015d20: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
+00015d30: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
+00015d40: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
+00015d50: 2020 2020 2020 7220 3d20 6f74 6865 720a        r = other.
+00015d60: 2020 2020 2020 2020 2020 2020 6966 2066              if f
+00015d70: 6162 7328 7229 3c3d 6570 733a 0a20 2020  abs(r)<=eps:.   
+00015d80: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00015d90: 7365 205a 6572 6f44 6976 6973 696f 6e45  se ZeroDivisionE
+00015da0: 7272 6f72 2c22 6d61 7434 206d 6f64 756c  rror,"mat4 modul
+00015db0: 6f22 0a20 2020 2020 2020 2020 2020 2072  o".            r
+00015dc0: 6573 203d 206d 6174 3428 290a 2020 2020  es = mat4().    
+00015dd0: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
+00015de0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3131  = _fmod(self.m11
+00015df0: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
+00015e00: 2072 6573 2e6d 3132 203d 205f 666d 6f64   res.m12 = _fmod
+00015e10: 2873 656c 662e 6d31 322c 2072 290a 2020  (self.m12, r).  
+00015e20: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+00015e30: 3320 3d20 5f66 6d6f 6428 7365 6c66 2e6d  3 = _fmod(self.m
+00015e40: 3133 2c20 7229 0a20 2020 2020 2020 2020  13, r).         
+00015e50: 2020 2072 6573 2e6d 3134 203d 205f 666d     res.m14 = _fm
+00015e60: 6f64 2873 656c 662e 6d31 342c 2072 290a  od(self.m14, r).
+00015e70: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00015e80: 6d32 3120 3d20 5f66 6d6f 6428 7365 6c66  m21 = _fmod(self
+00015e90: 2e6d 3231 2c20 7229 0a20 2020 2020 2020  .m21, r).       
+00015ea0: 2020 2020 2072 6573 2e6d 3232 203d 205f       res.m22 = _
+00015eb0: 666d 6f64 2873 656c 662e 6d32 322c 2072  fmod(self.m22, r
+00015ec0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00015ed0: 732e 6d32 3320 3d20 5f66 6d6f 6428 7365  s.m23 = _fmod(se
+00015ee0: 6c66 2e6d 3233 2c20 7229 0a20 2020 2020  lf.m23, r).     
+00015ef0: 2020 2020 2020 2072 6573 2e6d 3234 203d         res.m24 =
+00015f00: 205f 666d 6f64 2873 656c 662e 6d32 342c   _fmod(self.m24,
+00015f10: 2072 290a 2020 2020 2020 2020 2020 2020   r).            
+00015f20: 7265 732e 6d33 3120 3d20 5f66 6d6f 6428  res.m31 = _fmod(
+00015f30: 7365 6c66 2e6d 3331 2c20 7229 0a20 2020  self.m31, r).   
+00015f40: 2020 2020 2020 2020 2072 6573 2e6d 3332           res.m32
+00015f50: 203d 205f 666d 6f64 2873 656c 662e 6d33   = _fmod(self.m3
+00015f60: 322c 2072 290a 2020 2020 2020 2020 2020  2, r).          
+00015f70: 2020 7265 732e 6d33 3320 3d20 5f66 6d6f    res.m33 = _fmo
+00015f80: 6428 7365 6c66 2e6d 3333 2c20 7229 0a20  d(self.m33, r). 
+00015f90: 2020 2020 2020 2020 2020 2072 6573 2e6d             res.m
+00015fa0: 3334 203d 205f 666d 6f64 2873 656c 662e  34 = _fmod(self.
+00015fb0: 6d33 342c 2072 290a 2020 2020 2020 2020  m34, r).        
+00015fc0: 2020 2020 7265 732e 6d34 3120 3d20 5f66      res.m41 = _f
+00015fd0: 6d6f 6428 7365 6c66 2e6d 3431 2c20 7229  mod(self.m41, r)
+00015fe0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00015ff0: 2e6d 3432 203d 205f 666d 6f64 2873 656c  .m42 = _fmod(sel
+00016000: 662e 6d34 322c 2072 290a 2020 2020 2020  f.m42, r).      
+00016010: 2020 2020 2020 7265 732e 6d34 3320 3d20        res.m43 = 
+00016020: 5f66 6d6f 6428 7365 6c66 2e6d 3433 2c20  _fmod(self.m43, 
+00016030: 7229 0a20 2020 2020 2020 2020 2020 2072  r).            r
+00016040: 6573 2e6d 3434 203d 205f 666d 6f64 2873  es.m44 = _fmod(s
+00016050: 656c 662e 6d34 342c 2072 290a 2020 2020  elf.m44, r).    
+00016060: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00016070: 6573 0a0a 2020 2020 2020 2020 656c 6966  es..        elif
+00016080: 2074 6220 6973 206d 6174 343a 0a20 2020   tb is mat4:.   
+00016090: 2020 2020 2020 2020 206d 6220 3d20 6f74           mb = ot
+000160a0: 6865 720a 0a20 2020 2020 2020 2020 2020  her..           
+000160b0: 2069 6620 2866 6162 7328 6d62 2e6d 3131   if (fabs(mb.m11
+000160c0: 293c 3d65 7073 206f 7220 6661 6273 286d  )<=eps or fabs(m
+000160d0: 622e 6d31 3229 3c3d 6570 7320 6f72 2066  b.m12)<=eps or f
+000160e0: 6162 7328 6d62 2e6d 3133 293c 3d65 7073  abs(mb.m13)<=eps
+000160f0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
+00016100: 2020 2020 6661 6273 286d 622e 6d31 3429      fabs(mb.m14)
+00016110: 3c3d 6570 7320 6f72 0a20 2020 2020 2020  <=eps or.       
+00016120: 2020 2020 2020 2020 2066 6162 7328 6d62           fabs(mb
+00016130: 2e6d 3231 293c 3d65 7073 206f 7220 6661  .m21)<=eps or fa
+00016140: 6273 286d 622e 6d32 3229 3c3d 6570 7320  bs(mb.m22)<=eps 
+00016150: 6f72 2066 6162 7328 6d62 2e6d 3233 293c  or fabs(mb.m23)<
+00016160: 3d65 7073 206f 720a 2020 2020 2020 2020  =eps or.        
+00016170: 2020 2020 2020 2020 6661 6273 286d 622e          fabs(mb.
+00016180: 6d32 3429 3c3d 6570 7320 6f72 0a20 2020  m24)<=eps or.   
+00016190: 2020 2020 2020 2020 2020 2020 2066 6162               fab
+000161a0: 7328 6d62 2e6d 3331 293c 3d65 7073 206f  s(mb.m31)<=eps o
+000161b0: 7220 6661 6273 286d 622e 6d33 3229 3c3d  r fabs(mb.m32)<=
+000161c0: 6570 7320 6f72 2066 6162 7328 6d62 2e6d  eps or fabs(mb.m
+000161d0: 3333 293c 3d65 7073 206f 720a 2020 2020  33)<=eps or.    
+000161e0: 2020 2020 2020 2020 2020 2020 6661 6273              fabs
+000161f0: 286d 622e 6d33 3429 3c3d 6570 7320 6f72  (mb.m34)<=eps or
+00016200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016210: 2066 6162 7328 6d62 2e6d 3431 293c 3d65   fabs(mb.m41)<=e
+00016220: 7073 206f 7220 6661 6273 286d 622e 6d34  ps or fabs(mb.m4
+00016230: 3229 3c3d 6570 7320 6f72 2066 6162 7328  2)<=eps or fabs(
+00016240: 6d62 2e6d 3433 293c 3d65 7073 206f 720a  mb.m43)<=eps or.
+00016250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016260: 6661 6273 286d 622e 6d34 3429 3c3d 6570  fabs(mb.m44)<=ep
+00016270: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00016280: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
+00016290: 7669 7369 6f6e 4572 726f 722c 226d 6174  visionError,"mat
+000162a0: 3420 6d6f 6475 6c6f 220a 0a20 2020 2020  4 modulo"..     
+000162b0: 2020 2020 2020 2072 6573 3d6d 6174 3428         res=mat4(
+000162c0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+000162d0: 732e 6d31 3120 3d20 5f66 6d6f 6428 7365  s.m11 = _fmod(se
+000162e0: 6c66 2e6d 3131 2c20 6d62 2e6d 3131 290a  lf.m11, mb.m11).
+000162f0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00016300: 6d31 3220 3d20 5f66 6d6f 6428 7365 6c66  m12 = _fmod(self
+00016310: 2e6d 3132 2c20 6d62 2e6d 3132 290a 2020  .m12, mb.m12).  
+00016320: 2020 2020 2020 2020 2020 7265 732e 6d31            res.m1
+00016330: 3320 3d20 5f66 6d6f 6428 7365 6c66 2e6d  3 = _fmod(self.m
+00016340: 3133 2c20 6d62 2e6d 3133 290a 2020 2020  13, mb.m13).    
+00016350: 2020 2020 2020 2020 7265 732e 6d31 3420          res.m14 
+00016360: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3134  = _fmod(self.m14
+00016370: 2c20 6d62 2e6d 3134 290a 2020 2020 2020  , mb.m14).      
+00016380: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
+00016390: 5f66 6d6f 6428 7365 6c66 2e6d 3231 2c20  _fmod(self.m21, 
+000163a0: 6d62 2e6d 3231 290a 2020 2020 2020 2020  mb.m21).        
+000163b0: 2020 2020 7265 732e 6d32 3220 3d20 5f66      res.m22 = _f
+000163c0: 6d6f 6428 7365 6c66 2e6d 3232 2c20 6d62  mod(self.m22, mb
+000163d0: 2e6d 3232 290a 2020 2020 2020 2020 2020  .m22).          
+000163e0: 2020 7265 732e 6d32 3320 3d20 5f66 6d6f    res.m23 = _fmo
+000163f0: 6428 7365 6c66 2e6d 3233 2c20 6d62 2e6d  d(self.m23, mb.m
+00016400: 3233 290a 2020 2020 2020 2020 2020 2020  23).            
+00016410: 7265 732e 6d32 3420 3d20 5f66 6d6f 6428  res.m24 = _fmod(
+00016420: 7365 6c66 2e6d 3234 2c20 6d62 2e6d 3234  self.m24, mb.m24
+00016430: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00016440: 732e 6d33 3120 3d20 5f66 6d6f 6428 7365  s.m31 = _fmod(se
+00016450: 6c66 2e6d 3331 2c20 6d62 2e6d 3331 290a  lf.m31, mb.m31).
+00016460: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00016470: 6d33 3220 3d20 5f66 6d6f 6428 7365 6c66  m32 = _fmod(self
+00016480: 2e6d 3332 2c20 6d62 2e6d 3332 290a 2020  .m32, mb.m32).  
+00016490: 2020 2020 2020 2020 2020 7265 732e 6d33            res.m3
+000164a0: 3320 3d20 5f66 6d6f 6428 7365 6c66 2e6d  3 = _fmod(self.m
+000164b0: 3333 2c20 6d62 2e6d 3333 290a 2020 2020  33, mb.m33).    
+000164c0: 2020 2020 2020 2020 7265 732e 6d33 3420          res.m34 
+000164d0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3334  = _fmod(self.m34
+000164e0: 2c20 6d62 2e6d 3334 290a 2020 2020 2020  , mb.m34).      
+000164f0: 2020 2020 2020 7265 732e 6d34 3120 3d20        res.m41 = 
+00016500: 5f66 6d6f 6428 7365 6c66 2e6d 3431 2c20  _fmod(self.m41, 
+00016510: 6d62 2e6d 3431 290a 2020 2020 2020 2020  mb.m41).        
+00016520: 2020 2020 7265 732e 6d34 3220 3d20 5f66      res.m42 = _f
+00016530: 6d6f 6428 7365 6c66 2e6d 3432 2c20 6d62  mod(self.m42, mb
+00016540: 2e6d 3432 290a 2020 2020 2020 2020 2020  .m42).          
+00016550: 2020 7265 732e 6d34 3320 3d20 5f66 6d6f    res.m43 = _fmo
+00016560: 6428 7365 6c66 2e6d 3433 2c20 6d62 2e6d  d(self.m43, mb.m
+00016570: 3433 290a 2020 2020 2020 2020 2020 2020  43).            
+00016580: 7265 732e 6d34 3420 3d20 5f66 6d6f 6428  res.m44 = _fmod(
+00016590: 7365 6c66 2e6d 3434 2c20 6d62 2e6d 3434  self.m44, mb.m44
+000165a0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+000165b0: 7475 726e 2072 6573 0a0a 2020 2020 2020  turn res..      
+000165c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000165d0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+000165e0: 726f 722c 2022 756e 7375 7070 6f72 7465  ror, "unsupporte
+000165f0: 6420 6f70 6572 616e 6420 7479 7065 2066  d operand type f
+00016600: 6f72 2025 220a 0a0a 2020 2020 6465 6620  or %"...    def 
+00016610: 5f5f 6e65 675f 5f28 7365 6c66 293a 0a20  __neg__(self):. 
+00016620: 2020 2020 2020 2022 2222 4e65 6761 7469         """Negati
+00016630: 6f6e 2e0a 0a20 2020 2020 2020 203e 3e3e  on...        >>>
+00016640: 204d 3d6d 6174 3428 312c 322c 332c 342c   M=mat4(1,2,3,4,
+00016650: 352c 362c 372c 382c 392c 3130 2c31 312c  5,6,7,8,9,10,11,
+00016660: 3132 2c31 332c 3134 2c31 352c 3136 290a  12,13,14,15,16).
+00016670: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
+00016680: 7420 2d4d 0a20 2020 2020 2020 205b 2020  t -M.        [  
+00016690: 2d31 2e30 3030 302c 2020 202d 322e 3030  -1.0000,   -2.00
+000166a0: 3030 2c20 2020 2d33 2e30 3030 302c 2020  00,   -3.0000,  
+000166b0: 202d 342e 3030 3030 5d0a 2020 2020 2020   -4.0000].      
+000166c0: 2020 5b20 202d 352e 3030 3030 2c20 2020    [  -5.0000,   
+000166d0: 2d36 2e30 3030 302c 2020 202d 372e 3030  -6.0000,   -7.00
+000166e0: 3030 2c20 2020 2d38 2e30 3030 305d 0a20  00,   -8.0000]. 
+000166f0: 2020 2020 2020 205b 2020 2d39 2e30 3030         [  -9.000
+00016700: 302c 2020 2d31 302e 3030 3030 2c20 202d  0,  -10.0000,  -
+00016710: 3131 2e30 3030 302c 2020 2d31 322e 3030  11.0000,  -12.00
+00016720: 3030 5d0a 2020 2020 2020 2020 5b20 2d31  00].        [ -1
+00016730: 332e 3030 3030 2c20 202d 3134 2e30 3030  3.0000,  -14.000
+00016740: 302c 2020 2d31 352e 3030 3030 2c20 202d  0,  -15.0000,  -
+00016750: 3136 2e30 3030 305d 0a20 2020 2020 2020  16.0000].       
+00016760: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00016770: 6620 6d61 7434 2072 6573 0a20 2020 2020  f mat4 res.     
+00016780: 2020 2072 6573 203d 206d 6174 3428 290a     res = mat4().
+00016790: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
+000167a0: 3d20 2d73 656c 662e 6d31 310a 2020 2020  = -self.m11.    
+000167b0: 2020 2020 7265 732e 6d31 3220 3d20 2d73      res.m12 = -s
+000167c0: 656c 662e 6d31 320a 2020 2020 2020 2020  elf.m12.        
+000167d0: 7265 732e 6d31 3320 3d20 2d73 656c 662e  res.m13 = -self.
+000167e0: 6d31 330a 2020 2020 2020 2020 7265 732e  m13.        res.
+000167f0: 6d31 3420 3d20 2d73 656c 662e 6d31 340a  m14 = -self.m14.
+00016800: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
+00016810: 3d20 2d73 656c 662e 6d32 310a 2020 2020  = -self.m21.    
+00016820: 2020 2020 7265 732e 6d32 3220 3d20 2d73      res.m22 = -s
+00016830: 656c 662e 6d32 320a 2020 2020 2020 2020  elf.m22.        
+00016840: 7265 732e 6d32 3320 3d20 2d73 656c 662e  res.m23 = -self.
+00016850: 6d32 330a 2020 2020 2020 2020 7265 732e  m23.        res.
+00016860: 6d32 3420 3d20 2d73 656c 662e 6d32 340a  m24 = -self.m24.
+00016870: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
+00016880: 3d20 2d73 656c 662e 6d33 310a 2020 2020  = -self.m31.    
+00016890: 2020 2020 7265 732e 6d33 3220 3d20 2d73      res.m32 = -s
+000168a0: 656c 662e 6d33 320a 2020 2020 2020 2020  elf.m32.        
+000168b0: 7265 732e 6d33 3320 3d20 2d73 656c 662e  res.m33 = -self.
+000168c0: 6d33 330a 2020 2020 2020 2020 7265 732e  m33.        res.
+000168d0: 6d33 3420 3d20 2d73 656c 662e 6d33 340a  m34 = -self.m34.
+000168e0: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
+000168f0: 3d20 2d73 656c 662e 6d34 310a 2020 2020  = -self.m41.    
+00016900: 2020 2020 7265 732e 6d34 3220 3d20 2d73      res.m42 = -s
+00016910: 656c 662e 6d34 320a 2020 2020 2020 2020  elf.m42.        
+00016920: 7265 732e 6d34 3320 3d20 2d73 656c 662e  res.m43 = -self.
+00016930: 6d34 330a 2020 2020 2020 2020 7265 732e  m43.        res.
+00016940: 6d34 3420 3d20 2d73 656c 662e 6d34 340a  m44 = -self.m44.
+00016950: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00016960: 6573 0a0a 2020 2020 6465 6620 5f5f 706f  es..    def __po
+00016970: 735f 5f28 7365 6c66 293a 0a20 2020 2020  s__(self):.     
+00016980: 2020 2022 2222 0a20 2020 2020 2020 203e     """.        >
+00016990: 3e3e 204d 3d6d 6174 3428 312c 322c 332c  >> M=mat4(1,2,3,
+000169a0: 342c 352c 362c 372c 382c 392c 3130 2c31  4,5,6,7,8,9,10,1
+000169b0: 312c 3132 2c31 332c 3134 2c31 352c 3136  1,12,13,14,15,16
+000169c0: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
+000169d0: 696e 7420 2b4d 0a20 2020 2020 2020 205b  int +M.        [
+000169e0: 2020 2031 2e30 3030 302c 2020 2020 322e     1.0000,    2.
+000169f0: 3030 3030 2c20 2020 2033 2e30 3030 302c  0000,    3.0000,
+00016a00: 2020 2020 342e 3030 3030 5d0a 2020 2020      4.0000].    
+00016a10: 2020 2020 5b20 2020 352e 3030 3030 2c20      [   5.0000, 
+00016a20: 2020 2036 2e30 3030 302c 2020 2020 372e     6.0000,    7.
+00016a30: 3030 3030 2c20 2020 2038 2e30 3030 305d  0000,    8.0000]
+00016a40: 0a20 2020 2020 2020 205b 2020 2039 2e30  .        [   9.0
+00016a50: 3030 302c 2020 2031 302e 3030 3030 2c20  000,   10.0000, 
+00016a60: 2020 3131 2e30 3030 302c 2020 2031 322e    11.0000,   12.
+00016a70: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
+00016a80: 2031 332e 3030 3030 2c20 2020 3134 2e30   13.0000,   14.0
+00016a90: 3030 302c 2020 2031 352e 3030 3030 2c20  000,   15.0000, 
+00016aa0: 2020 3136 2e30 3030 305d 0a20 2020 2020    16.0000].     
+00016ab0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+00016ac0: 6465 6620 6d61 7434 2072 6573 0a20 2020  def mat4 res.   
+00016ad0: 2020 2020 2072 6573 203d 206d 6174 3428       res = mat4(
+00016ae0: 290a 2020 2020 2020 2020 7265 732e 6d31  ).        res.m1
+00016af0: 3120 3d20 7365 6c66 2e6d 3131 0a20 2020  1 = self.m11.   
+00016b00: 2020 2020 2072 6573 2e6d 3132 203d 2073       res.m12 = s
+00016b10: 656c 662e 6d31 320a 2020 2020 2020 2020  elf.m12.        
+00016b20: 7265 732e 6d31 3320 3d20 7365 6c66 2e6d  res.m13 = self.m
+00016b30: 3133 0a20 2020 2020 2020 2072 6573 2e6d  13.        res.m
+00016b40: 3134 203d 2073 656c 662e 6d31 340a 2020  14 = self.m14.  
+00016b50: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
+00016b60: 7365 6c66 2e6d 3231 0a20 2020 2020 2020  self.m21.       
+00016b70: 2072 6573 2e6d 3232 203d 2073 656c 662e   res.m22 = self.
+00016b80: 6d32 320a 2020 2020 2020 2020 7265 732e  m22.        res.
+00016b90: 6d32 3320 3d20 7365 6c66 2e6d 3233 0a20  m23 = self.m23. 
+00016ba0: 2020 2020 2020 2072 6573 2e6d 3234 203d         res.m24 =
+00016bb0: 2073 656c 662e 6d32 340a 2020 2020 2020   self.m24.      
+00016bc0: 2020 7265 732e 6d33 3120 3d20 7365 6c66    res.m31 = self
+00016bd0: 2e6d 3331 0a20 2020 2020 2020 2072 6573  .m31.        res
+00016be0: 2e6d 3332 203d 2073 656c 662e 6d33 320a  .m32 = self.m32.
+00016bf0: 2020 2020 2020 2020 7265 732e 6d33 3320          res.m33 
+00016c00: 3d20 7365 6c66 2e6d 3333 0a20 2020 2020  = self.m33.     
+00016c10: 2020 2072 6573 2e6d 3334 203d 2073 656c     res.m34 = sel
+00016c20: 662e 6d33 340a 2020 2020 2020 2020 7265  f.m34.        re
+00016c30: 732e 6d34 3120 3d20 7365 6c66 2e6d 3431  s.m41 = self.m41
+00016c40: 0a20 2020 2020 2020 2072 6573 2e6d 3432  .        res.m42
+00016c50: 203d 2073 656c 662e 6d34 320a 2020 2020   = self.m42.    
+00016c60: 2020 2020 7265 732e 6d34 3320 3d20 7365      res.m43 = se
+00016c70: 6c66 2e6d 3433 0a20 2020 2020 2020 2072  lf.m43.        r
+00016c80: 6573 2e6d 3434 203d 2073 656c 662e 6d34  es.m44 = self.m4
+00016c90: 340a 2020 2020 2020 2020 7265 7475 726e  4.        return
+00016ca0: 2072 6573 0a0a 2020 2020 6465 6620 5f5f   res..    def __
+00016cb0: 6961 6464 5f5f 2873 656c 662c 206d 6174  iadd__(self, mat
+00016cc0: 3420 6f74 6865 7229 3a0a 2020 2020 2020  4 other):.      
+00016cd0: 2020 2222 2249 6e6c 696e 6520 6d61 7472    """Inline matr
+00016ce0: 6978 2061 6464 6974 696f 6e2e 0a20 2020  ix addition..   
+00016cf0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00016d00: 2073 656c 662e 6d31 3120 3d20 7365 6c66   self.m11 = self
+00016d10: 2e6d 3131 202b 206f 7468 6572 2e6d 3131  .m11 + other.m11
+00016d20: 0a20 2020 2020 2020 2073 656c 662e 6d31  .        self.m1
+00016d30: 3220 3d20 7365 6c66 2e6d 3132 202b 206f  2 = self.m12 + o
+00016d40: 7468 6572 2e6d 3132 0a20 2020 2020 2020  ther.m12.       
+00016d50: 2073 656c 662e 6d31 3320 3d20 7365 6c66   self.m13 = self
+00016d60: 2e6d 3133 202b 206f 7468 6572 2e6d 3133  .m13 + other.m13
+00016d70: 0a20 2020 2020 2020 2073 656c 662e 6d31  .        self.m1
+00016d80: 3420 3d20 7365 6c66 2e6d 3134 202b 206f  4 = self.m14 + o
+00016d90: 7468 6572 2e6d 3134 0a20 2020 2020 2020  ther.m14.       
+00016da0: 2073 656c 662e 6d32 3120 3d20 7365 6c66   self.m21 = self
+00016db0: 2e6d 3231 202b 206f 7468 6572 2e6d 3231  .m21 + other.m21
+00016dc0: 0a20 2020 2020 2020 2073 656c 662e 6d32  .        self.m2
+00016dd0: 3220 3d20 7365 6c66 2e6d 3232 202b 206f  2 = self.m22 + o
+00016de0: 7468 6572 2e6d 3232 0a20 2020 2020 2020  ther.m22.       
+00016df0: 2073 656c 662e 6d32 3320 3d20 7365 6c66   self.m23 = self
+00016e00: 2e6d 3233 202b 206f 7468 6572 2e6d 3233  .m23 + other.m23
+00016e10: 0a20 2020 2020 2020 2073 656c 662e 6d32  .        self.m2
+00016e20: 3420 3d20 7365 6c66 2e6d 3234 202b 206f  4 = self.m24 + o
+00016e30: 7468 6572 2e6d 3234 0a20 2020 2020 2020  ther.m24.       
+00016e40: 2073 656c 662e 6d33 3120 3d20 7365 6c66   self.m31 = self
+00016e50: 2e6d 3331 202b 206f 7468 6572 2e6d 3331  .m31 + other.m31
+00016e60: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
+00016e70: 3220 3d20 7365 6c66 2e6d 3332 202b 206f  2 = self.m32 + o
+00016e80: 7468 6572 2e6d 3332 0a20 2020 2020 2020  ther.m32.       
+00016e90: 2073 656c 662e 6d33 3320 3d20 7365 6c66   self.m33 = self
+00016ea0: 2e6d 3333 202b 206f 7468 6572 2e6d 3333  .m33 + other.m33
+00016eb0: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
+00016ec0: 3420 3d20 7365 6c66 2e6d 3334 202b 206f  4 = self.m34 + o
+00016ed0: 7468 6572 2e6d 3334 0a20 2020 2020 2020  ther.m34.       
+00016ee0: 2073 656c 662e 6d34 3120 3d20 7365 6c66   self.m41 = self
+00016ef0: 2e6d 3431 202b 206f 7468 6572 2e6d 3431  .m41 + other.m41
+00016f00: 0a20 2020 2020 2020 2073 656c 662e 6d34  .        self.m4
+00016f10: 3220 3d20 7365 6c66 2e6d 3432 202b 206f  2 = self.m42 + o
+00016f20: 7468 6572 2e6d 3432 0a20 2020 2020 2020  ther.m42.       
+00016f30: 2073 656c 662e 6d34 3320 3d20 7365 6c66   self.m43 = self
+00016f40: 2e6d 3433 202b 206f 7468 6572 2e6d 3433  .m43 + other.m43
+00016f50: 0a20 2020 2020 2020 2073 656c 662e 6d34  .        self.m4
+00016f60: 3420 3d20 7365 6c66 2e6d 3434 202b 206f  4 = self.m44 + o
+00016f70: 7468 6572 2e6d 3434 0a20 2020 2020 2020  ther.m44.       
+00016f80: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
+00016f90: 2020 6465 6620 5f5f 6973 7562 5f5f 2873    def __isub__(s
+00016fa0: 656c 662c 206d 6174 3420 6f74 6865 7229  elf, mat4 other)
+00016fb0: 3a0a 2020 2020 2020 2020 2222 2249 6e6c  :.        """Inl
+00016fc0: 696e 6520 6d61 7472 6978 2073 7562 7472  ine matrix subtr
+00016fd0: 6163 7469 6f6e 2e0a 2020 2020 2020 2020  action..        
+00016fe0: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
+00016ff0: 2e6d 3131 203d 2073 656c 662e 6d31 3120  .m11 = self.m11 
+00017000: 2d20 6f74 6865 722e 6d31 310a 2020 2020  - other.m11.    
+00017010: 2020 2020 7365 6c66 2e6d 3132 203d 2073      self.m12 = s
+00017020: 656c 662e 6d31 3220 2d20 6f74 6865 722e  elf.m12 - other.
+00017030: 6d31 320a 2020 2020 2020 2020 7365 6c66  m12.        self
+00017040: 2e6d 3133 203d 2073 656c 662e 6d31 3320  .m13 = self.m13 
+00017050: 2d20 6f74 6865 722e 6d31 330a 2020 2020  - other.m13.    
+00017060: 2020 2020 7365 6c66 2e6d 3134 203d 2073      self.m14 = s
+00017070: 656c 662e 6d31 3420 2d20 6f74 6865 722e  elf.m14 - other.
+00017080: 6d31 340a 2020 2020 2020 2020 7365 6c66  m14.        self
+00017090: 2e6d 3231 203d 2073 656c 662e 6d32 3120  .m21 = self.m21 
+000170a0: 2d20 6f74 6865 722e 6d32 310a 2020 2020  - other.m21.    
+000170b0: 2020 2020 7365 6c66 2e6d 3232 203d 2073      self.m22 = s
+000170c0: 656c 662e 6d32 3220 2d20 6f74 6865 722e  elf.m22 - other.
+000170d0: 6d32 320a 2020 2020 2020 2020 7365 6c66  m22.        self
+000170e0: 2e6d 3233 203d 2073 656c 662e 6d32 3320  .m23 = self.m23 
+000170f0: 2d20 6f74 6865 722e 6d32 330a 2020 2020  - other.m23.    
+00017100: 2020 2020 7365 6c66 2e6d 3234 203d 2073      self.m24 = s
+00017110: 656c 662e 6d32 3420 2d20 6f74 6865 722e  elf.m24 - other.
+00017120: 6d32 340a 2020 2020 2020 2020 7365 6c66  m24.        self
+00017130: 2e6d 3331 203d 2073 656c 662e 6d33 3120  .m31 = self.m31 
+00017140: 2d20 6f74 6865 722e 6d33 310a 2020 2020  - other.m31.    
+00017150: 2020 2020 7365 6c66 2e6d 3332 203d 2073      self.m32 = s
+00017160: 656c 662e 6d33 3220 2d20 6f74 6865 722e  elf.m32 - other.
+00017170: 6d33 320a 2020 2020 2020 2020 7365 6c66  m32.        self
+00017180: 2e6d 3333 203d 2073 656c 662e 6d33 3320  .m33 = self.m33 
+00017190: 2d20 6f74 6865 722e 6d33 330a 2020 2020  - other.m33.    
+000171a0: 2020 2020 7365 6c66 2e6d 3334 203d 2073      self.m34 = s
+000171b0: 656c 662e 6d33 3420 2d20 6f74 6865 722e  elf.m34 - other.
+000171c0: 6d33 340a 2020 2020 2020 2020 7365 6c66  m34.        self
+000171d0: 2e6d 3431 203d 2073 656c 662e 6d34 3120  .m41 = self.m41 
+000171e0: 2d20 6f74 6865 722e 6d34 310a 2020 2020  - other.m41.    
+000171f0: 2020 2020 7365 6c66 2e6d 3432 203d 2073      self.m42 = s
+00017200: 656c 662e 6d34 3220 2d20 6f74 6865 722e  elf.m42 - other.
+00017210: 6d34 320a 2020 2020 2020 2020 7365 6c66  m42.        self
+00017220: 2e6d 3433 203d 2073 656c 662e 6d34 3320  .m43 = self.m43 
+00017230: 2d20 6f74 6865 722e 6d34 330a 2020 2020  - other.m43.    
+00017240: 2020 2020 7365 6c66 2e6d 3434 203d 2073      self.m44 = s
+00017250: 656c 662e 6d34 3420 2d20 6f74 6865 722e  elf.m44 - other.
+00017260: 6d34 340a 2020 2020 2020 2020 7265 7475  m44.        retu
+00017270: 726e 2073 656c 660a 0a20 2020 2064 6566  rn self..    def
+00017280: 205f 5f69 6d75 6c5f 5f28 7365 6c66 2c20   __imul__(self, 
+00017290: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+000172a0: 2222 2249 6e6c 696e 6520 6d75 6c74 6970  """Inline multip
+000172b0: 6c69 6361 7469 6f6e 2028 7363 616c 6172  lication (scalar
+000172c0: 206f 7220 6d61 7472 6978 292e 0a20 2020   or matrix)..   
+000172d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000172e0: 2063 6465 6620 646f 7562 6c65 2072 2c20   cdef double r, 
+000172f0: 612c 622c 632c 640a 2020 2020 2020 2020  a,b,c,d.        
+00017300: 6364 6566 206d 6174 3420 6d62 0a0a 2020  cdef mat4 mb..  
+00017310: 2020 2020 2020 7462 203d 2074 7970 6528        tb = type(
+00017320: 6f74 6865 7229 0a20 2020 2020 2020 2069  other).        i
+00017330: 6620 7462 2069 7320 666c 6f61 7420 6f72  f tb is float or
+00017340: 2074 6220 6973 2069 6e74 206f 7220 7462   tb is int or tb
+00017350: 2069 7320 6c6f 6e67 3a0a 2020 2020 2020   is long:.      
+00017360: 2020 2020 2020 723d 6f74 6865 720a 2020        r=other.  
+00017370: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00017380: 3131 203d 2073 656c 662e 6d31 312a 720a  11 = self.m11*r.
+00017390: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000173a0: 2e6d 3132 203d 2073 656c 662e 6d31 322a  .m12 = self.m12*
+000173b0: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
+000173c0: 6c66 2e6d 3133 203d 2073 656c 662e 6d31  lf.m13 = self.m1
+000173d0: 332a 720a 2020 2020 2020 2020 2020 2020  3*r.            
+000173e0: 7365 6c66 2e6d 3134 203d 2073 656c 662e  self.m14 = self.
+000173f0: 6d31 342a 720a 2020 2020 2020 2020 2020  m14*r.          
+00017400: 2020 7365 6c66 2e6d 3231 203d 2073 656c    self.m21 = sel
+00017410: 662e 6d32 312a 720a 2020 2020 2020 2020  f.m21*r.        
+00017420: 2020 2020 7365 6c66 2e6d 3232 203d 2073      self.m22 = s
+00017430: 656c 662e 6d32 322a 720a 2020 2020 2020  elf.m22*r.      
+00017440: 2020 2020 2020 7365 6c66 2e6d 3233 203d        self.m23 =
+00017450: 2073 656c 662e 6d32 332a 720a 2020 2020   self.m23*r.    
+00017460: 2020 2020 2020 2020 7365 6c66 2e6d 3234          self.m24
+00017470: 203d 2073 656c 662e 6d32 342a 720a 2020   = self.m24*r.  
+00017480: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00017490: 3331 203d 2073 656c 662e 6d33 312a 720a  31 = self.m31*r.
+000174a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000174b0: 2e6d 3332 203d 2073 656c 662e 6d33 322a  .m32 = self.m32*
+000174c0: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
+000174d0: 6c66 2e6d 3333 203d 2073 656c 662e 6d33  lf.m33 = self.m3
+000174e0: 332a 720a 2020 2020 2020 2020 2020 2020  3*r.            
+000174f0: 7365 6c66 2e6d 3334 203d 2073 656c 662e  self.m34 = self.
+00017500: 6d33 342a 720a 2020 2020 2020 2020 2020  m34*r.          
+00017510: 2020 7365 6c66 2e6d 3431 203d 2073 656c    self.m41 = sel
+00017520: 662e 6d34 312a 720a 2020 2020 2020 2020  f.m41*r.        
+00017530: 2020 2020 7365 6c66 2e6d 3432 203d 2073      self.m42 = s
+00017540: 656c 662e 6d34 322a 720a 2020 2020 2020  elf.m42*r.      
+00017550: 2020 2020 2020 7365 6c66 2e6d 3433 203d        self.m43 =
+00017560: 2073 656c 662e 6d34 332a 720a 2020 2020   self.m43*r.    
+00017570: 2020 2020 2020 2020 7365 6c66 2e6d 3434          self.m44
+00017580: 203d 2073 656c 662e 6d34 342a 720a 2020   = self.m44*r.  
+00017590: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000175a0: 2073 656c 660a 2020 2020 2020 2020 656c   self.        el
+000175b0: 6966 2074 6220 6973 206d 6174 343a 0a20  if tb is mat4:. 
+000175c0: 2020 2020 2020 2020 2020 206d 6220 3d20             mb = 
+000175d0: 6f74 6865 720a 2020 2020 2020 2020 2020  other.          
+000175e0: 2020 6120 3d20 7365 6c66 2e6d 3131 0a20    a = self.m11. 
+000175f0: 2020 2020 2020 2020 2020 2062 203d 2073             b = s
+00017600: 656c 662e 6d31 320a 2020 2020 2020 2020  elf.m12.        
+00017610: 2020 2020 6320 3d20 7365 6c66 2e6d 3133      c = self.m13
+00017620: 0a20 2020 2020 2020 2020 2020 2064 203d  .            d =
+00017630: 2073 656c 662e 6d31 340a 2020 2020 2020   self.m14.      
+00017640: 2020 2020 2020 7365 6c66 2e6d 3131 203d        self.m11 =
+00017650: 2061 2a6d 622e 6d31 312b 622a 6d62 2e6d   a*mb.m11+b*mb.m
+00017660: 3231 2b63 2a6d 622e 6d33 312b 642a 6d62  21+c*mb.m31+d*mb
+00017670: 2e6d 3431 0a20 2020 2020 2020 2020 2020  .m41.           
+00017680: 2073 656c 662e 6d31 3220 3d20 612a 6d62   self.m12 = a*mb
+00017690: 2e6d 3132 2b62 2a6d 622e 6d32 322b 632a  .m12+b*mb.m22+c*
+000176a0: 6d62 2e6d 3332 2b64 2a6d 622e 6d34 320a  mb.m32+d*mb.m42.
+000176b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000176c0: 2e6d 3133 203d 2061 2a6d 622e 6d31 332b  .m13 = a*mb.m13+
+000176d0: 622a 6d62 2e6d 3233 2b63 2a6d 622e 6d33  b*mb.m23+c*mb.m3
+000176e0: 332b 642a 6d62 2e6d 3433 0a20 2020 2020  3+d*mb.m43.     
+000176f0: 2020 2020 2020 2073 656c 662e 6d31 3420         self.m14 
+00017700: 3d20 612a 6d62 2e6d 3134 2b62 2a6d 622e  = a*mb.m14+b*mb.
+00017710: 6d32 342b 632a 6d62 2e6d 3334 2b64 2a6d  m24+c*mb.m34+d*m
+00017720: 622e 6d34 340a 2020 2020 2020 2020 2020  b.m44.          
+00017730: 2020 6120 3d20 7365 6c66 2e6d 3231 0a20    a = self.m21. 
+00017740: 2020 2020 2020 2020 2020 2062 203d 2073             b = s
+00017750: 656c 662e 6d32 320a 2020 2020 2020 2020  elf.m22.        
+00017760: 2020 2020 6320 3d20 7365 6c66 2e6d 3233      c = self.m23
+00017770: 0a20 2020 2020 2020 2020 2020 2064 203d  .            d =
+00017780: 2073 656c 662e 6d32 340a 2020 2020 2020   self.m24.      
+00017790: 2020 2020 2020 7365 6c66 2e6d 3231 203d        self.m21 =
+000177a0: 2061 2a6d 622e 6d31 312b 622a 6d62 2e6d   a*mb.m11+b*mb.m
+000177b0: 3231 2b63 2a6d 622e 6d33 312b 642a 6d62  21+c*mb.m31+d*mb
+000177c0: 2e6d 3431 0a20 2020 2020 2020 2020 2020  .m41.           
+000177d0: 2073 656c 662e 6d32 3220 3d20 612a 6d62   self.m22 = a*mb
+000177e0: 2e6d 3132 2b62 2a6d 622e 6d32 322b 632a  .m12+b*mb.m22+c*
+000177f0: 6d62 2e6d 3332 2b64 2a6d 622e 6d34 320a  mb.m32+d*mb.m42.
+00017800: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017810: 2e6d 3233 203d 2061 2a6d 622e 6d31 332b  .m23 = a*mb.m13+
+00017820: 622a 6d62 2e6d 3233 2b63 2a6d 622e 6d33  b*mb.m23+c*mb.m3
+00017830: 332b 642a 6d62 2e6d 3433 0a20 2020 2020  3+d*mb.m43.     
+00017840: 2020 2020 2020 2073 656c 662e 6d32 3420         self.m24 
+00017850: 3d20 612a 6d62 2e6d 3134 2b62 2a6d 622e  = a*mb.m14+b*mb.
+00017860: 6d32 342b 632a 6d62 2e6d 3334 2b64 2a6d  m24+c*mb.m34+d*m
+00017870: 622e 6d34 340a 2020 2020 2020 2020 2020  b.m44.          
+00017880: 2020 6120 3d20 7365 6c66 2e6d 3331 0a20    a = self.m31. 
+00017890: 2020 2020 2020 2020 2020 2062 203d 2073             b = s
+000178a0: 656c 662e 6d33 320a 2020 2020 2020 2020  elf.m32.        
+000178b0: 2020 2020 6320 3d20 7365 6c66 2e6d 3333      c = self.m33
+000178c0: 0a20 2020 2020 2020 2020 2020 2064 203d  .            d =
+000178d0: 2073 656c 662e 6d33 340a 2020 2020 2020   self.m34.      
+000178e0: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
+000178f0: 2061 2a6d 622e 6d31 312b 622a 6d62 2e6d   a*mb.m11+b*mb.m
+00017900: 3231 2b63 2a6d 622e 6d33 312b 642a 6d62  21+c*mb.m31+d*mb
+00017910: 2e6d 3431 0a20 2020 2020 2020 2020 2020  .m41.           
+00017920: 2073 656c 662e 6d33 3220 3d20 612a 6d62   self.m32 = a*mb
+00017930: 2e6d 3132 2b62 2a6d 622e 6d32 322b 632a  .m12+b*mb.m22+c*
+00017940: 6d62 2e6d 3332 2b64 2a6d 622e 6d34 320a  mb.m32+d*mb.m42.
+00017950: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017960: 2e6d 3333 203d 2061 2a6d 622e 6d31 332b  .m33 = a*mb.m13+
+00017970: 622a 6d62 2e6d 3233 2b63 2a6d 622e 6d33  b*mb.m23+c*mb.m3
+00017980: 332b 642a 6d62 2e6d 3433 0a20 2020 2020  3+d*mb.m43.     
+00017990: 2020 2020 2020 2073 656c 662e 6d33 3420         self.m34 
+000179a0: 3d20 612a 6d62 2e6d 3134 2b62 2a6d 622e  = a*mb.m14+b*mb.
+000179b0: 6d32 342b 632a 6d62 2e6d 3334 2b64 2a6d  m24+c*mb.m34+d*m
+000179c0: 622e 6d34 340a 2020 2020 2020 2020 2020  b.m44.          
+000179d0: 2020 6120 3d20 7365 6c66 2e6d 3431 0a20    a = self.m41. 
+000179e0: 2020 2020 2020 2020 2020 2062 203d 2073             b = s
+000179f0: 656c 662e 6d34 320a 2020 2020 2020 2020  elf.m42.        
+00017a00: 2020 2020 6320 3d20 7365 6c66 2e6d 3433      c = self.m43
+00017a10: 0a20 2020 2020 2020 2020 2020 2064 203d  .            d =
+00017a20: 2073 656c 662e 6d34 340a 2020 2020 2020   self.m44.      
+00017a30: 2020 2020 2020 7365 6c66 2e6d 3431 203d        self.m41 =
+00017a40: 2061 2a6d 622e 6d31 312b 622a 6d62 2e6d   a*mb.m11+b*mb.m
+00017a50: 3231 2b63 2a6d 622e 6d33 312b 642a 6d62  21+c*mb.m31+d*mb
+00017a60: 2e6d 3431 0a20 2020 2020 2020 2020 2020  .m41.           
+00017a70: 2073 656c 662e 6d34 3220 3d20 612a 6d62   self.m42 = a*mb
+00017a80: 2e6d 3132 2b62 2a6d 622e 6d32 322b 632a  .m12+b*mb.m22+c*
+00017a90: 6d62 2e6d 3332 2b64 2a6d 622e 6d34 320a  mb.m32+d*mb.m42.
+00017aa0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017ab0: 2e6d 3433 203d 2061 2a6d 622e 6d31 332b  .m43 = a*mb.m13+
+00017ac0: 622a 6d62 2e6d 3233 2b63 2a6d 622e 6d33  b*mb.m23+c*mb.m3
+00017ad0: 332b 642a 6d62 2e6d 3433 0a20 2020 2020  3+d*mb.m43.     
+00017ae0: 2020 2020 2020 2073 656c 662e 6d34 3420         self.m44 
+00017af0: 3d20 612a 6d62 2e6d 3134 2b62 2a6d 622e  = a*mb.m14+b*mb.
+00017b00: 6d32 342b 632a 6d62 2e6d 3334 2b64 2a6d  m24+c*mb.m34+d*m
+00017b10: 622e 6d34 340a 2020 2020 2020 2020 2020  b.m44.          
+00017b20: 2020 7265 7475 726e 2073 656c 660a 2020    return self.  
+00017b30: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00017b40: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00017b50: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
+00017b60: 6f72 7465 6420 6f70 6572 616e 6420 7479  orted operand ty
+00017b70: 7065 2066 6f72 202a 3d22 0a0a 2020 2020  pe for *="..    
+00017b80: 6465 6620 5f5f 6964 6976 5f5f 2873 656c  def __idiv__(sel
+00017b90: 662c 206f 7468 6572 293a 0a20 2020 2020  f, other):.     
+00017ba0: 2020 2022 2222 496e 6c69 6e65 2064 6976     """Inline div
+00017bb0: 6973 696f 6e20 7769 7468 2073 6361 6c61  ision with scala
+00017bc0: 722e 0a20 2020 2020 2020 2022 2222 0a20  r..        """. 
+00017bd0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
+00017be0: 6c65 2072 0a20 2020 2020 2020 2074 6220  le r.        tb 
+00017bf0: 3d20 7479 7065 286f 7468 6572 290a 2020  = type(other).  
+00017c00: 2020 2020 2020 6966 2074 6220 6973 2066        if tb is f
+00017c10: 6c6f 6174 206f 7220 7462 2069 7320 696e  loat or tb is in
+00017c20: 7420 6f72 2074 6220 6973 206c 6f6e 673a  t or tb is long:
+00017c30: 0a20 2020 2020 2020 2020 2020 2072 3d6f  .            r=o
+00017c40: 7468 6572 0a20 2020 2020 2020 2020 2020  ther.           
+00017c50: 2069 6620 6661 6273 2872 293c 3d65 7073   if fabs(r)<=eps
+00017c60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00017c70: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
+00017c80: 7369 6f6e 4572 726f 722c 226d 6174 3420  sionError,"mat4 
+00017c90: 6469 7669 7369 6f6e 220a 2020 2020 2020  division".      
+00017ca0: 2020 2020 2020 7365 6c66 2e6d 3131 203d        self.m11 =
+00017cb0: 2073 656c 662e 6d31 312f 720a 2020 2020   self.m11/r.    
+00017cc0: 2020 2020 2020 2020 7365 6c66 2e6d 3132          self.m12
+00017cd0: 203d 2073 656c 662e 6d31 322f 720a 2020   = self.m12/r.  
+00017ce0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00017cf0: 3133 203d 2073 656c 662e 6d31 332f 720a  13 = self.m13/r.
+00017d00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017d10: 2e6d 3134 203d 2073 656c 662e 6d31 342f  .m14 = self.m14/
+00017d20: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
+00017d30: 6c66 2e6d 3231 203d 2073 656c 662e 6d32  lf.m21 = self.m2
+00017d40: 312f 720a 2020 2020 2020 2020 2020 2020  1/r.            
+00017d50: 7365 6c66 2e6d 3232 203d 2073 656c 662e  self.m22 = self.
+00017d60: 6d32 322f 720a 2020 2020 2020 2020 2020  m22/r.          
+00017d70: 2020 7365 6c66 2e6d 3233 203d 2073 656c    self.m23 = sel
+00017d80: 662e 6d32 332f 720a 2020 2020 2020 2020  f.m23/r.        
+00017d90: 2020 2020 7365 6c66 2e6d 3234 203d 2073      self.m24 = s
+00017da0: 656c 662e 6d32 342f 720a 2020 2020 2020  elf.m24/r.      
+00017db0: 2020 2020 2020 7365 6c66 2e6d 3331 203d        self.m31 =
+00017dc0: 2073 656c 662e 6d33 312f 720a 2020 2020   self.m31/r.    
+00017dd0: 2020 2020 2020 2020 7365 6c66 2e6d 3332          self.m32
+00017de0: 203d 2073 656c 662e 6d33 322f 720a 2020   = self.m32/r.  
+00017df0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00017e00: 3333 203d 2073 656c 662e 6d33 332f 720a  33 = self.m33/r.
+00017e10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017e20: 2e6d 3334 203d 2073 656c 662e 6d33 342f  .m34 = self.m34/
+00017e30: 720a 2020 2020 2020 2020 2020 2020 7365  r.            se
+00017e40: 6c66 2e6d 3431 203d 2073 656c 662e 6d34  lf.m41 = self.m4
+00017e50: 312f 720a 2020 2020 2020 2020 2020 2020  1/r.            
+00017e60: 7365 6c66 2e6d 3432 203d 2073 656c 662e  self.m42 = self.
+00017e70: 6d34 322f 720a 2020 2020 2020 2020 2020  m42/r.          
+00017e80: 2020 7365 6c66 2e6d 3433 203d 2073 656c    self.m43 = sel
+00017e90: 662e 6d34 332f 720a 2020 2020 2020 2020  f.m43/r.        
+00017ea0: 2020 2020 7365 6c66 2e6d 3434 203d 2073      self.m44 = s
+00017eb0: 656c 662e 6d34 342f 720a 2020 2020 2020  elf.m44/r.      
+00017ec0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00017ed0: 660a 2020 2020 2020 2020 656c 7365 3a0a  f.        else:.
+00017ee0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00017ef0: 6520 5479 7065 4572 726f 722c 2022 756e  e TypeError, "un
+00017f00: 7375 7070 6f72 7465 6420 6f70 6572 616e  supported operan
+00017f10: 6420 7479 7065 2066 6f72 202f 3d22 0a0a  d type for /="..
+00017f20: 2020 2020 6465 6620 5f5f 696d 6f64 5f5f      def __imod__
+00017f30: 2873 656c 662c 2062 293a 0a20 2020 2020  (self, b):.     
+00017f40: 2020 2022 2222 496e 6c69 6e65 206d 6f64     """Inline mod
+00017f50: 756c 6f2e 0a20 2020 2020 2020 2022 2222  ulo..        """
+00017f60: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
+00017f70: 7434 206d 620a 2020 2020 2020 2020 6364  t4 mb.        cd
+00017f80: 6566 2064 6f75 626c 6520 720a 0a20 2020  ef double r..   
+00017f90: 2020 2020 2074 6220 3d20 7479 7065 2862       tb = type(b
+00017fa0: 290a 0a20 2020 2020 2020 2069 6620 7462  )..        if tb
+00017fb0: 2069 7320 666c 6f61 7420 6f72 2074 6220   is float or tb 
+00017fc0: 6973 2069 6e74 206f 7220 7462 2069 7320  is int or tb is 
+00017fd0: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
+00017fe0: 2020 7220 3d20 620a 2020 2020 2020 2020    r = b.        
+00017ff0: 2020 2020 6966 2066 6162 7328 7229 3c3d      if fabs(r)<=
+00018000: 6570 733a 0a20 2020 2020 2020 2020 2020  eps:.           
+00018010: 2020 2020 2072 6169 7365 205a 6572 6f44       raise ZeroD
+00018020: 6976 6973 696f 6e45 7272 6f72 2c22 6d61  ivisionError,"ma
+00018030: 7434 206d 6f64 756c 6f22 0a20 2020 2020  t4 modulo".     
+00018040: 2020 2020 2020 2073 656c 662e 6d31 3120         self.m11 
+00018050: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3131  = _fmod(self.m11
+00018060: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
+00018070: 2073 656c 662e 6d31 3220 3d20 5f66 6d6f   self.m12 = _fmo
+00018080: 6428 7365 6c66 2e6d 3132 2c20 7229 0a20  d(self.m12, r). 
+00018090: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000180a0: 6d31 3320 3d20 5f66 6d6f 6428 7365 6c66  m13 = _fmod(self
+000180b0: 2e6d 3133 2c20 7229 0a20 2020 2020 2020  .m13, r).       
+000180c0: 2020 2020 2073 656c 662e 6d31 3420 3d20       self.m14 = 
+000180d0: 5f66 6d6f 6428 7365 6c66 2e6d 3134 2c20  _fmod(self.m14, 
+000180e0: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
+000180f0: 656c 662e 6d32 3120 3d20 5f66 6d6f 6428  elf.m21 = _fmod(
+00018100: 7365 6c66 2e6d 3231 2c20 7229 0a20 2020  self.m21, r).   
+00018110: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+00018120: 3220 3d20 5f66 6d6f 6428 7365 6c66 2e6d  2 = _fmod(self.m
+00018130: 3232 2c20 7229 0a20 2020 2020 2020 2020  22, r).         
+00018140: 2020 2073 656c 662e 6d32 3320 3d20 5f66     self.m23 = _f
+00018150: 6d6f 6428 7365 6c66 2e6d 3233 2c20 7229  mod(self.m23, r)
+00018160: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00018170: 662e 6d32 3420 3d20 5f66 6d6f 6428 7365  f.m24 = _fmod(se
+00018180: 6c66 2e6d 3234 2c20 7229 0a20 2020 2020  lf.m24, r).     
+00018190: 2020 2020 2020 2073 656c 662e 6d33 3120         self.m31 
+000181a0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3331  = _fmod(self.m31
+000181b0: 2c20 7229 0a20 2020 2020 2020 2020 2020  , r).           
+000181c0: 2073 656c 662e 6d33 3220 3d20 5f66 6d6f   self.m32 = _fmo
+000181d0: 6428 7365 6c66 2e6d 3332 2c20 7229 0a20  d(self.m32, r). 
+000181e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000181f0: 6d33 3320 3d20 5f66 6d6f 6428 7365 6c66  m33 = _fmod(self
+00018200: 2e6d 3333 2c20 7229 0a20 2020 2020 2020  .m33, r).       
+00018210: 2020 2020 2073 656c 662e 6d33 3420 3d20       self.m34 = 
+00018220: 5f66 6d6f 6428 7365 6c66 2e6d 3334 2c20  _fmod(self.m34, 
+00018230: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
+00018240: 656c 662e 6d34 3120 3d20 5f66 6d6f 6428  elf.m41 = _fmod(
+00018250: 7365 6c66 2e6d 3431 2c20 7229 0a20 2020  self.m41, r).   
+00018260: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
+00018270: 3220 3d20 5f66 6d6f 6428 7365 6c66 2e6d  2 = _fmod(self.m
+00018280: 3432 2c20 7229 0a20 2020 2020 2020 2020  42, r).         
+00018290: 2020 2073 656c 662e 6d34 3320 3d20 5f66     self.m43 = _f
+000182a0: 6d6f 6428 7365 6c66 2e6d 3433 2c20 7229  mod(self.m43, r)
+000182b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000182c0: 662e 6d34 3420 3d20 5f66 6d6f 6428 7365  f.m44 = _fmod(se
+000182d0: 6c66 2e6d 3434 2c20 7229 0a20 2020 2020  lf.m44, r).     
+000182e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000182f0: 6c66 0a20 2020 2020 2020 2065 6c69 6620  lf.        elif 
+00018300: 7462 2069 7320 6d61 7434 3a0a 2020 2020  tb is mat4:.    
+00018310: 2020 2020 2020 2020 6d62 203d 2062 0a20          mb = b. 
+00018320: 2020 2020 2020 2020 2020 2069 6620 2866             if (f
+00018330: 6162 7328 6d62 2e6d 3131 293c 3d65 7073  abs(mb.m11)<=eps
+00018340: 206f 7220 6661 6273 286d 622e 6d31 3229   or fabs(mb.m12)
+00018350: 3c3d 6570 7320 6f72 2066 6162 7328 6d62  <=eps or fabs(mb
+00018360: 2e6d 3133 293c 3d65 7073 206f 720a 2020  .m13)<=eps or.  
+00018370: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+00018380: 6273 286d 622e 6d31 3429 3c3d 6570 7320  bs(mb.m14)<=eps 
+00018390: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
+000183a0: 2020 2066 6162 7328 6d62 2e6d 3231 293c     fabs(mb.m21)<
+000183b0: 3d65 7073 206f 7220 6661 6273 286d 622e  =eps or fabs(mb.
+000183c0: 6d32 3229 3c3d 6570 7320 6f72 2066 6162  m22)<=eps or fab
+000183d0: 7328 6d62 2e6d 3233 293c 3d65 7073 206f  s(mb.m23)<=eps o
+000183e0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+000183f0: 2020 6661 6273 286d 622e 6d32 3429 3c3d    fabs(mb.m24)<=
+00018400: 6570 7320 6f72 0a20 2020 2020 2020 2020  eps or.         
+00018410: 2020 2020 2020 2066 6162 7328 6d62 2e6d         fabs(mb.m
+00018420: 3331 293c 3d65 7073 206f 7220 6661 6273  31)<=eps or fabs
+00018430: 286d 622e 6d33 3229 3c3d 6570 7320 6f72  (mb.m32)<=eps or
+00018440: 2066 6162 7328 6d62 2e6d 3333 293c 3d65   fabs(mb.m33)<=e
+00018450: 7073 206f 720a 2020 2020 2020 2020 2020  ps or.          
+00018460: 2020 2020 2020 6661 6273 286d 622e 6d33        fabs(mb.m3
+00018470: 3429 3c3d 6570 7320 6f72 0a20 2020 2020  4)<=eps or.     
+00018480: 2020 2020 2020 2020 2020 2066 6162 7328             fabs(
+00018490: 6d62 2e6d 3431 293c 3d65 7073 206f 7220  mb.m41)<=eps or 
+000184a0: 6661 6273 286d 622e 6d34 3229 3c3d 6570  fabs(mb.m42)<=ep
+000184b0: 7320 6f72 2066 6162 7328 6d62 2e6d 3433  s or fabs(mb.m43
+000184c0: 293c 3d65 7073 206f 720a 2020 2020 2020  )<=eps or.      
+000184d0: 2020 2020 2020 2020 2020 6661 6273 286d            fabs(m
+000184e0: 622e 6d34 3429 3c3d 6570 7329 3a0a 2020  b.m44)<=eps):.  
+000184f0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00018500: 6973 6520 5a65 726f 4469 7669 7369 6f6e  ise ZeroDivision
+00018510: 4572 726f 722c 226d 6174 3420 6d6f 6475  Error,"mat4 modu
+00018520: 6c6f 220a 2020 2020 2020 2020 2020 2020  lo".            
+00018530: 7365 6c66 2e6d 3131 203d 205f 666d 6f64  self.m11 = _fmod
+00018540: 2873 656c 662e 6d31 312c 206d 622e 6d31  (self.m11, mb.m1
+00018550: 3129 0a20 2020 2020 2020 2020 2020 2073  1).            s
+00018560: 656c 662e 6d31 3220 3d20 5f66 6d6f 6428  elf.m12 = _fmod(
+00018570: 7365 6c66 2e6d 3132 2c20 6d62 2e6d 3132  self.m12, mb.m12
+00018580: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00018590: 6c66 2e6d 3133 203d 205f 666d 6f64 2873  lf.m13 = _fmod(s
+000185a0: 656c 662e 6d31 332c 206d 622e 6d31 3329  elf.m13, mb.m13)
+000185b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000185c0: 662e 6d31 3420 3d20 5f66 6d6f 6428 7365  f.m14 = _fmod(se
+000185d0: 6c66 2e6d 3134 2c20 6d62 2e6d 3133 290a  lf.m14, mb.m13).
+000185e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000185f0: 2e6d 3231 203d 205f 666d 6f64 2873 656c  .m21 = _fmod(sel
+00018600: 662e 6d32 312c 206d 622e 6d32 3129 0a20  f.m21, mb.m21). 
+00018610: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00018620: 6d32 3220 3d20 5f66 6d6f 6428 7365 6c66  m22 = _fmod(self
+00018630: 2e6d 3232 2c20 6d62 2e6d 3232 290a 2020  .m22, mb.m22).  
+00018640: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00018650: 3233 203d 205f 666d 6f64 2873 656c 662e  23 = _fmod(self.
+00018660: 6d32 332c 206d 622e 6d32 3329 0a20 2020  m23, mb.m23).   
+00018670: 2020 2020 2020 2020 2073 656c 662e 6d32           self.m2
+00018680: 3420 3d20 5f66 6d6f 6428 7365 6c66 2e6d  4 = _fmod(self.m
+00018690: 3234 2c20 6d62 2e6d 3233 290a 2020 2020  24, mb.m23).    
+000186a0: 2020 2020 2020 2020 7365 6c66 2e6d 3331          self.m31
+000186b0: 203d 205f 666d 6f64 2873 656c 662e 6d33   = _fmod(self.m3
+000186c0: 312c 206d 622e 6d33 3129 0a20 2020 2020  1, mb.m31).     
+000186d0: 2020 2020 2020 2073 656c 662e 6d33 3220         self.m32 
+000186e0: 3d20 5f66 6d6f 6428 7365 6c66 2e6d 3332  = _fmod(self.m32
+000186f0: 2c20 6d62 2e6d 3332 290a 2020 2020 2020  , mb.m32).      
+00018700: 2020 2020 2020 7365 6c66 2e6d 3333 203d        self.m33 =
+00018710: 205f 666d 6f64 2873 656c 662e 6d33 332c   _fmod(self.m33,
+00018720: 206d 622e 6d33 3329 0a20 2020 2020 2020   mb.m33).       
+00018730: 2020 2020 2073 656c 662e 6d33 3420 3d20       self.m34 = 
+00018740: 5f66 6d6f 6428 7365 6c66 2e6d 3334 2c20  _fmod(self.m34, 
+00018750: 6d62 2e6d 3333 290a 2020 2020 2020 2020  mb.m33).        
+00018760: 2020 2020 7365 6c66 2e6d 3431 203d 205f      self.m41 = _
+00018770: 666d 6f64 2873 656c 662e 6d34 312c 206d  fmod(self.m41, m
+00018780: 622e 6d34 3129 0a20 2020 2020 2020 2020  b.m41).         
+00018790: 2020 2073 656c 662e 6d34 3220 3d20 5f66     self.m42 = _f
+000187a0: 6d6f 6428 7365 6c66 2e6d 3432 2c20 6d62  mod(self.m42, mb
+000187b0: 2e6d 3432 290a 2020 2020 2020 2020 2020  .m42).          
+000187c0: 2020 7365 6c66 2e6d 3433 203d 205f 666d    self.m43 = _fm
+000187d0: 6f64 2873 656c 662e 6d34 332c 206d 622e  od(self.m43, mb.
+000187e0: 6d34 3329 0a20 2020 2020 2020 2020 2020  m43).           
+000187f0: 2073 656c 662e 6d34 3420 3d20 5f66 6d6f   self.m44 = _fmo
+00018800: 6428 7365 6c66 2e6d 3434 2c20 6d62 2e6d  d(self.m44, mb.m
+00018810: 3433 290a 2020 2020 2020 2020 2020 2020  43).            
+00018820: 7265 7475 726e 2073 656c 660a 2020 2020  return self.    
+00018830: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00018840: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00018850: 4572 726f 722c 2022 756e 7375 7070 6f72  Error, "unsuppor
+00018860: 7465 6420 6f70 6572 616e 6420 7479 7065  ted operand type
+00018870: 2066 6f72 2025 3d22 0a0a 2020 2020 6465   for %="..    de
+00018880: 6620 5f5f 6c65 6e5f 5f28 7365 6c66 293a  f __len__(self):
+00018890: 0a20 2020 2020 2020 2022 2222 4c65 6e67  .        """Leng
+000188a0: 7468 206f 6620 7468 6520 7365 7175 656e  th of the sequen
+000188b0: 6365 2028 616c 7761 7973 2034 292e 2222  ce (always 4).""
+000188c0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+000188d0: 2034 0a0a 2020 2020 6465 6620 5f5f 6765   4..    def __ge
+000188e0: 7469 7465 6d5f 5f28 6d61 7434 2073 656c  titem__(mat4 sel
+000188f0: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
+00018900: 2022 2222 5265 7475 726e 2061 2063 6f6c   """Return a col
+00018910: 756d 6e20 6f72 2061 2073 696e 676c 6520  umn or a single 
+00018920: 6d61 7472 6978 2065 6c65 6d65 6e74 2e0a  matrix element..
+00018930: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00018940: 2020 2020 6364 6566 2069 6e74 2069 2c6a      cdef int i,j
+00018950: 0a0a 2020 2020 2020 2020 543d 7479 7065  ..        T=type
+00018960: 286b 6579 290a 2020 2020 2020 2020 6966  (key).        if
+00018970: 2054 2069 7320 696e 7420 6f72 2054 2069   T is int or T i
+00018980: 7320 6c6f 6e67 3a0a 2020 2020 2020 2020  s long:.        
+00018990: 2020 2020 6920 3d20 6b65 790a 2020 2020      i = key.    
+000189a0: 2020 2020 2020 2020 6966 2069 3d3d 303a          if i==0:
+000189b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000189c0: 2072 6574 7572 6e20 7665 6334 2873 656c   return vec4(sel
+000189d0: 662e 6d31 312c 2073 656c 662e 6d32 312c  f.m11, self.m21,
+000189e0: 2073 656c 662e 6d33 312c 2073 656c 662e   self.m31, self.
+000189f0: 6d34 3129 0a20 2020 2020 2020 2020 2020  m41).           
+00018a00: 2065 6c69 6620 693d 3d31 3a0a 2020 2020   elif i==1:.    
+00018a10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00018a20: 726e 2076 6563 3428 7365 6c66 2e6d 3132  rn vec4(self.m12
+00018a30: 2c20 7365 6c66 2e6d 3232 2c20 7365 6c66  , self.m22, self
+00018a40: 2e6d 3332 2c20 7365 6c66 2e6d 3432 290a  .m32, self.m42).
+00018a50: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00018a60: 2069 3d3d 323a 0a20 2020 2020 2020 2020   i==2:.         
+00018a70: 2020 2020 2020 2072 6574 7572 6e20 7665         return ve
+00018a80: 6334 2873 656c 662e 6d31 332c 2073 656c  c4(self.m13, sel
+00018a90: 662e 6d32 332c 2073 656c 662e 6d33 332c  f.m23, self.m33,
+00018aa0: 2073 656c 662e 6d34 3329 0a20 2020 2020   self.m43).     
+00018ab0: 2020 2020 2020 2065 6c69 6620 693d 3d33         elif i==3
+00018ac0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018ad0: 2020 7265 7475 726e 2076 6563 3428 7365    return vec4(se
+00018ae0: 6c66 2e6d 3134 2c20 7365 6c66 2e6d 3234  lf.m14, self.m24
+00018af0: 2c20 7365 6c66 2e6d 3334 2c20 7365 6c66  , self.m34, self
+00018b00: 2e6d 3434 290a 2020 2020 2020 2020 2020  .m44).          
+00018b10: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00018b20: 2020 2020 2020 2020 7261 6973 6520 496e          raise In
+00018b30: 6465 7845 7272 6f72 2c20 2269 6e64 6578  dexError, "index
+00018b40: 206f 7574 206f 6620 7261 6e67 6522 0a20   out of range". 
+00018b50: 2020 2020 2020 2065 6c69 6620 5420 6973         elif T is
+00018b60: 2074 7570 6c65 3a0a 2020 2020 2020 2020   tuple:.        
+00018b70: 2020 2020 6966 206c 656e 286b 6579 2921      if len(key)!
+00018b80: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
+00018b90: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00018ba0: 7272 6f72 2c20 2269 6e64 6578 2074 7570  rror, "index tup
+00018bb0: 6c65 206d 7573 7420 6265 2061 2032 2d74  le must be a 2-t
+00018bc0: 7570 6c65 220a 2020 2020 2020 2020 2020  uple".          
+00018bd0: 2020 6920 3d20 6b65 795b 305d 0a20 2020    i = key[0].   
+00018be0: 2020 2020 2020 2020 206a 203d 206b 6579           j = key
+00018bf0: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00018c00: 6966 2069 3c30 206f 7220 693e 3320 6f72  if i<0 or i>3 or
+00018c10: 206a 3c30 206f 7220 6a3e 333a 0a20 2020   j<0 or j>3:.   
+00018c20: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00018c30: 7365 2049 6e64 6578 4572 726f 722c 2022  se IndexError, "
+00018c40: 696e 6465 7820 6f75 7420 6f66 2072 616e  index out of ran
+00018c50: 6765 220a 0a20 2020 2020 2020 2020 2020  ge"..           
+00018c60: 2069 6620 693d 3d30 3a0a 2020 2020 2020   if i==0:.      
+00018c70: 2020 2020 2020 2020 2020 6966 206a 3d3d            if j==
+00018c80: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+00018c90: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00018ca0: 6c66 2e6d 3131 0a20 2020 2020 2020 2020  lf.m11.         
+00018cb0: 2020 2020 2020 2065 6c69 6620 6a3d 3d31         elif j==1
+00018cc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018cd0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00018ce0: 662e 6d31 320a 2020 2020 2020 2020 2020  f.m12.          
+00018cf0: 2020 2020 2020 656c 6966 206a 3d3d 323a        elif j==2:
+00018d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018d10: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00018d20: 2e6d 3133 0a20 2020 2020 2020 2020 2020  .m13.           
+00018d30: 2020 2020 2065 6c69 6620 6a3d 3d33 3a0a       elif j==3:.
+00018d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d50: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00018d60: 6d31 340a 2020 2020 2020 2020 2020 2020  m14.            
+00018d70: 656c 6966 2069 3d3d 313a 0a20 2020 2020  elif i==1:.     
+00018d80: 2020 2020 2020 2020 2020 2069 6620 6a3d             if j=
+00018d90: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
+00018da0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00018db0: 656c 662e 6d32 310a 2020 2020 2020 2020  elf.m21.        
+00018dc0: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
+00018dd0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+00018de0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00018df0: 6c66 2e6d 3232 0a20 2020 2020 2020 2020  lf.m22.         
+00018e00: 2020 2020 2020 2065 6c69 6620 6a3d 3d32         elif j==2
+00018e10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018e20: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00018e30: 662e 6d32 330a 2020 2020 2020 2020 2020  f.m23.          
+00018e40: 2020 2020 2020 656c 6966 206a 3d3d 333a        elif j==3:
+00018e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018e60: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00018e70: 2e6d 3234 0a20 2020 2020 2020 2020 2020  .m24.           
+00018e80: 2065 6c69 6620 693d 3d32 3a0a 2020 2020   elif i==2:.    
+00018e90: 2020 2020 2020 2020 2020 2020 6966 206a              if j
+00018ea0: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
+00018eb0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00018ec0: 7365 6c66 2e6d 3331 0a20 2020 2020 2020  self.m31.       
+00018ed0: 2020 2020 2020 2020 2065 6c69 6620 6a3d           elif j=
+00018ee0: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
+00018ef0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00018f00: 656c 662e 6d33 320a 2020 2020 2020 2020  elf.m32.        
+00018f10: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
+00018f20: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
+00018f30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00018f40: 6c66 2e6d 3333 0a20 2020 2020 2020 2020  lf.m33.         
+00018f50: 2020 2020 2020 2065 6c69 6620 6a3d 3d33         elif j==3
+00018f60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018f70: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00018f80: 662e 6d33 340a 2020 2020 2020 2020 2020  f.m34.          
+00018f90: 2020 656c 6966 2069 3d3d 333a 0a20 2020    elif i==3:.   
+00018fa0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00018fb0: 6a3d 3d30 3a0a 2020 2020 2020 2020 2020  j==0:.          
+00018fc0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00018fd0: 2073 656c 662e 6d34 310a 2020 2020 2020   self.m41.      
+00018fe0: 2020 2020 2020 2020 2020 656c 6966 206a            elif j
+00018ff0: 3d3d 313a 0a20 2020 2020 2020 2020 2020  ==1:.           
+00019000: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00019010: 7365 6c66 2e6d 3432 0a20 2020 2020 2020  self.m42.       
+00019020: 2020 2020 2020 2020 2065 6c69 6620 6a3d           elif j=
+00019030: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
+00019040: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00019050: 656c 662e 6d34 330a 2020 2020 2020 2020  elf.m43.        
+00019060: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
+00019070: 333a 0a20 2020 2020 2020 2020 2020 2020  3:.             
+00019080: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00019090: 6c66 2e6d 3434 0a20 2020 2020 2020 2065  lf.m44.        e
+000190a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000190b0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+000190c0: 2c22 696e 6465 7820 6d75 7374 2062 6520  ,"index must be 
+000190d0: 696e 7465 6765 7220 6f72 2032 2d74 7570  integer or 2-tup
+000190e0: 6c65 220a 0a20 2020 2064 6566 205f 5f73  le"..    def __s
+000190f0: 6574 6974 656d 5f5f 2873 656c 662c 206b  etitem__(self, k
+00019100: 6579 2c20 7661 6c75 6529 3a0a 2020 2020  ey, value):.    
+00019110: 2020 2020 2222 2253 6574 2061 2063 6f6c      """Set a col
+00019120: 756d 6e20 6f72 2061 2073 696e 676c 6520  umn or a single 
+00019130: 6d61 7472 6978 2065 6c65 6d65 6e74 2e0a  matrix element..
+00019140: 0a20 2020 2020 2020 2054 6865 2063 6f6c  .        The col
+00019150: 756d 6e20 6d75 7374 2062 6520 6769 7665  umn must be give
+00019160: 6e20 6173 2061 2034 2d73 6571 7565 6e63  n as a 4-sequenc
+00019170: 6520 2874 6869 7320 696e 636c 7564 6573  e (this includes
+00019180: 2076 6563 3420 6173 2077 656c 6c29 2e0a   vec4 as well)..
+00019190: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000191a0: 2020 2020 6364 6566 2069 6e74 2069 2c6a      cdef int i,j
+000191b0: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
+000191c0: 7562 6c65 2076 0a0a 2020 2020 2020 2020  uble v..        
+000191d0: 543d 7479 7065 286b 6579 290a 2020 2020  T=type(key).    
+000191e0: 2020 2020 6966 2054 2069 7320 696e 7420      if T is int 
+000191f0: 6f72 2054 2069 7320 6c6f 6e67 3a0a 2020  or T is long:.  
+00019200: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+00019210: 2876 616c 7565 2921 3d34 3a0a 2020 2020  (value)!=4:.    
+00019220: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00019230: 6520 5661 6c75 6545 7272 6f72 2c20 2234  e ValueError, "4
+00019240: 2d73 6571 7565 6e63 6520 6578 7065 6374  -sequence expect
+00019250: 6564 220a 2020 2020 2020 2020 2020 2020  ed".            
+00019260: 6920 3d20 6b65 790a 2020 2020 2020 2020  i = key.        
+00019270: 2020 2020 6966 2069 3d3d 303a 0a20 2020      if i==0:.   
+00019280: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00019290: 662e 6d31 3120 3d20 7661 6c75 655b 305d  f.m11 = value[0]
+000192a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000192b0: 2073 656c 662e 6d32 3120 3d20 7661 6c75   self.m21 = valu
+000192c0: 655b 315d 0a20 2020 2020 2020 2020 2020  e[1].           
+000192d0: 2020 2020 2073 656c 662e 6d33 3120 3d20       self.m31 = 
+000192e0: 7661 6c75 655b 325d 0a20 2020 2020 2020  value[2].       
+000192f0: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
+00019300: 3120 3d20 7661 6c75 655b 335d 0a20 2020  1 = value[3].   
+00019310: 2020 2020 2020 2020 2065 6c69 6620 693d           elif i=
+00019320: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
+00019330: 2020 2020 7365 6c66 2e6d 3132 203d 2076      self.m12 = v
+00019340: 616c 7565 5b30 5d0a 2020 2020 2020 2020  alue[0].        
+00019350: 2020 2020 2020 2020 7365 6c66 2e6d 3232          self.m22
+00019360: 203d 2076 616c 7565 5b31 5d0a 2020 2020   = value[1].    
+00019370: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00019380: 2e6d 3332 203d 2076 616c 7565 5b32 5d0a  .m32 = value[2].
+00019390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000193a0: 7365 6c66 2e6d 3432 203d 2076 616c 7565  self.m42 = value
+000193b0: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
+000193c0: 656c 6966 2069 3d3d 323a 0a20 2020 2020  elif i==2:.     
+000193d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000193e0: 6d31 3320 3d20 7661 6c75 655b 305d 0a20  m13 = value[0]. 
+000193f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00019400: 656c 662e 6d32 3320 3d20 7661 6c75 655b  elf.m23 = value[
+00019410: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+00019420: 2020 2073 656c 662e 6d33 3320 3d20 7661     self.m33 = va
+00019430: 6c75 655b 325d 0a20 2020 2020 2020 2020  lue[2].         
+00019440: 2020 2020 2020 2073 656c 662e 6d34 3320         self.m43 
+00019450: 3d20 7661 6c75 655b 335d 0a20 2020 2020  = value[3].     
+00019460: 2020 2020 2020 2065 6c69 6620 693d 3d33         elif i==3
+00019470: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00019480: 2020 7365 6c66 2e6d 3134 203d 2076 616c    self.m14 = val
+00019490: 7565 5b30 5d0a 2020 2020 2020 2020 2020  ue[0].          
+000194a0: 2020 2020 2020 7365 6c66 2e6d 3234 203d        self.m24 =
+000194b0: 2076 616c 7565 5b31 5d0a 2020 2020 2020   value[1].      
+000194c0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+000194d0: 3334 203d 2076 616c 7565 5b32 5d0a 2020  34 = value[2].  
+000194e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000194f0: 6c66 2e6d 3434 203d 2076 616c 7565 5b33  lf.m44 = value[3
+00019500: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
+00019510: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00019520: 2020 2020 7261 6973 6520 496e 6465 7845      raise IndexE
+00019530: 7272 6f72 2c20 2269 6e64 6578 206f 7574  rror, "index out
+00019540: 206f 6620 7261 6e67 6522 0a20 2020 2020   of range".     
+00019550: 2020 2065 6c69 6620 5420 6973 2074 7570     elif T is tup
+00019560: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+00019570: 6966 206c 656e 286b 6579 2921 3d32 3a0a  if len(key)!=2:.
+00019580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019590: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+000195a0: 2c20 2269 6e64 6578 2074 7570 6c65 206d  , "index tuple m
+000195b0: 7573 7420 6265 2061 2032 2d74 7570 6c65  ust be a 2-tuple
+000195c0: 220a 2020 2020 2020 2020 2020 2020 6920  ".            i 
+000195d0: 3d20 6b65 795b 305d 0a20 2020 2020 2020  = key[0].       
+000195e0: 2020 2020 206a 203d 206b 6579 5b31 5d0a       j = key[1].
+000195f0: 2020 2020 2020 2020 2020 2020 7620 3d20              v = 
+00019600: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
+00019610: 2020 6966 2069 3c30 206f 7220 693e 3320    if i<0 or i>3 
+00019620: 6f72 206a 3c30 206f 7220 6a3e 333a 0a20  or j<0 or j>3:. 
+00019630: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00019640: 6169 7365 2049 6e64 6578 4572 726f 722c  aise IndexError,
+00019650: 2022 696e 6465 7820 6f75 7420 6f66 2072   "index out of r
+00019660: 616e 6765 220a 0a20 2020 2020 2020 2020  ange"..         
+00019670: 2020 2069 6620 693d 3d30 3a0a 2020 2020     if i==0:.    
+00019680: 2020 2020 2020 2020 2020 2020 6966 206a              if j
+00019690: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
+000196a0: 2020 2020 2020 2020 2073 656c 662e 6d31           self.m1
+000196b0: 3120 3d20 760a 2020 2020 2020 2020 2020  1 = v.          
+000196c0: 2020 2020 2020 656c 6966 206a 3d3d 313a        elif j==1:
+000196d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000196e0: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
+000196f0: 760a 2020 2020 2020 2020 2020 2020 2020  v.              
+00019700: 2020 656c 6966 206a 3d3d 323a 0a20 2020    elif j==2:.   
+00019710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019720: 2073 656c 662e 6d31 3320 3d20 760a 2020   self.m13 = v.  
+00019730: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00019740: 6966 206a 3d3d 333a 0a20 2020 2020 2020  if j==3:.       
+00019750: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00019760: 662e 6d31 3420 3d20 760a 2020 2020 2020  f.m14 = v.      
+00019770: 2020 2020 2020 656c 6966 2069 3d3d 313a        elif i==1:
+00019780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019790: 2069 6620 6a3d 3d30 3a0a 2020 2020 2020   if j==0:.      
+000197a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000197b0: 6c66 2e6d 3231 203d 2076 0a20 2020 2020  lf.m21 = v.     
+000197c0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+000197d0: 6a3d 3d31 3a0a 2020 2020 2020 2020 2020  j==1:.          
+000197e0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+000197f0: 3232 203d 2076 0a20 2020 2020 2020 2020  22 = v.         
+00019800: 2020 2020 2020 2065 6c69 6620 6a3d 3d32         elif j==2
+00019810: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00019820: 2020 2020 2020 7365 6c66 2e6d 3233 203d        self.m23 =
+00019830: 2076 0a20 2020 2020 2020 2020 2020 2020   v.             
+00019840: 2020 2065 6c69 6620 6a3d 3d33 3a0a 2020     elif j==3:.  
+00019850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019860: 2020 7365 6c66 2e6d 3234 203d 2076 0a20    self.m24 = v. 
+00019870: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00019880: 693d 3d32 3a0a 2020 2020 2020 2020 2020  i==2:.          
+00019890: 2020 2020 2020 6966 206a 3d3d 303a 0a20        if j==0:. 
+000198a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198b0: 2020 2073 656c 662e 6d33 3120 3d20 760a     self.m31 = v.
+000198c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198d0: 656c 6966 206a 3d3d 313a 0a20 2020 2020  elif j==1:.     
+000198e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000198f0: 656c 662e 6d33 3220 3d20 760a 2020 2020  elf.m32 = v.    
+00019900: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00019910: 206a 3d3d 323a 0a20 2020 2020 2020 2020   j==2:.         
+00019920: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00019930: 6d33 3320 3d20 760a 2020 2020 2020 2020  m33 = v.        
+00019940: 2020 2020 2020 2020 656c 6966 206a 3d3d          elif j==
+00019950: 333a 0a20 2020 2020 2020 2020 2020 2020  3:.             
+00019960: 2020 2020 2020 2073 656c 662e 6d33 3420         self.m34 
+00019970: 3d20 760a 2020 2020 2020 2020 2020 2020  = v.            
+00019980: 656c 6966 2069 3d3d 333a 0a20 2020 2020  elif i==3:.     
+00019990: 2020 2020 2020 2020 2020 2069 6620 6a3d             if j=
+000199a0: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
+000199b0: 2020 2020 2020 2020 7365 6c66 2e6d 3431          self.m41
+000199c0: 203d 2076 0a20 2020 2020 2020 2020 2020   = v.           
+000199d0: 2020 2020 2065 6c69 6620 6a3d 3d31 3a0a       elif j==1:.
+000199e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000199f0: 2020 2020 7365 6c66 2e6d 3432 203d 2076      self.m42 = v
+00019a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019a10: 2065 6c69 6620 6a3d 3d32 3a0a 2020 2020   elif j==2:.    
+00019a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019a30: 7365 6c66 2e6d 3433 203d 2076 0a20 2020  self.m43 = v.   
+00019a40: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00019a50: 6620 6a3d 3d33 3a0a 2020 2020 2020 2020  f j==3:.        
+00019a60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00019a70: 2e6d 3434 203d 2076 0a20 2020 2020 2020  .m44 = v.       
+00019a80: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00019a90: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00019aa0: 6f72 2c22 696e 6465 7820 6d75 7374 2062  or,"index must b
+00019ab0: 6520 696e 7465 6765 7220 6f72 2032 2d74  e integer or 2-t
+00019ac0: 7570 6c65 220a 0a20 2020 2064 6566 2067  uple"..    def g
+00019ad0: 6574 526f 7728 7365 6c66 2c20 6964 7829  etRow(self, idx)
+00019ae0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+00019af0: 7572 6e20 726f 7720 2861 7320 7665 6334  urn row (as vec4
+00019b00: 292e 2222 220a 2020 2020 2020 2020 6364  ).""".        cd
+00019b10: 6566 2069 6e74 2069 0a0a 2020 2020 2020  ef int i..      
+00019b20: 2020 543d 7479 7065 2869 6478 290a 2020    T=type(idx).  
+00019b30: 2020 2020 2020 6966 2054 213d 696e 7420        if T!=int 
+00019b40: 616e 6420 5421 3d6c 6f6e 673a 0a20 2020  and T!=long:.   
+00019b50: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00019b60: 7970 6545 7272 6f72 2c22 696e 6465 7820  ypeError,"index 
+00019b70: 6d75 7374 2062 6520 696e 7465 6765 7222  must be integer"
+00019b80: 0a0a 2020 2020 2020 2020 6920 3d20 6964  ..        i = id
+00019b90: 780a 2020 2020 2020 2020 6966 2069 3d3d  x.        if i==
+00019ba0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
+00019bb0: 6574 7572 6e20 7665 6334 2873 656c 662e  eturn vec4(self.
+00019bc0: 6d31 312c 2073 656c 662e 6d31 322c 2073  m11, self.m12, s
+00019bd0: 656c 662e 6d31 332c 2073 656c 662e 6d31  elf.m13, self.m1
+00019be0: 3429 0a20 2020 2020 2020 2065 6c69 6620  4).        elif 
+00019bf0: 693d 3d31 3a0a 2020 2020 2020 2020 2020  i==1:.          
+00019c00: 2020 7265 7475 726e 2076 6563 3428 7365    return vec4(se
+00019c10: 6c66 2e6d 3231 2c20 7365 6c66 2e6d 3232  lf.m21, self.m22
+00019c20: 2c20 7365 6c66 2e6d 3233 2c20 7365 6c66  , self.m23, self
+00019c30: 2e6d 3234 290a 2020 2020 2020 2020 656c  .m24).        el
+00019c40: 6966 2069 3d3d 323a 0a20 2020 2020 2020  if i==2:.       
+00019c50: 2020 2020 2072 6574 7572 6e20 7665 6334       return vec4
+00019c60: 2873 656c 662e 6d33 312c 2073 656c 662e  (self.m31, self.
+00019c70: 6d33 322c 2073 656c 662e 6d33 332c 2073  m32, self.m33, s
+00019c80: 656c 662e 6d33 3429 0a20 2020 2020 2020  elf.m34).       
+00019c90: 2065 6c69 6620 693d 3d33 3a0a 2020 2020   elif i==3:.    
+00019ca0: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+00019cb0: 6563 3428 7365 6c66 2e6d 3431 2c20 7365  ec4(self.m41, se
+00019cc0: 6c66 2e6d 3432 2c20 7365 6c66 2e6d 3433  lf.m42, self.m43
+00019cd0: 2c20 7365 6c66 2e6d 3434 290a 2020 2020  , self.m44).    
+00019ce0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00019cf0: 2020 2020 2020 7261 6973 6520 496e 6465        raise Inde
+00019d00: 7845 7272 6f72 2c20 2269 6e64 6578 206f  xError, "index o
+00019d10: 7574 206f 6620 7261 6e67 6522 0a0a 2020  ut of range"..  
+00019d20: 2020 6465 6620 7365 7452 6f77 2873 656c    def setRow(sel
+00019d30: 662c 2069 6478 2c20 7661 6c75 6529 3a0a  f, idx, value):.
+00019d40: 2020 2020 2020 2020 2222 2253 6574 2072          """Set r
+00019d50: 6f77 2e22 2222 0a20 2020 2020 2020 2063  ow.""".        c
+00019d60: 6465 6620 696e 7420 690a 0a20 2020 2020  def int i..     
+00019d70: 2020 2054 3d74 7970 6528 6964 7829 0a20     T=type(idx). 
+00019d80: 2020 2020 2020 2069 6620 5421 3d69 6e74         if T!=int
+00019d90: 2061 6e64 2054 213d 6c6f 6e67 3a0a 2020   and T!=long:.  
+00019da0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00019db0: 5479 7065 4572 726f 722c 2269 6e64 6578  TypeError,"index
+00019dc0: 206d 7573 7420 6265 2069 6e74 6567 6572   must be integer
+00019dd0: 220a 0a20 2020 2020 2020 2069 6620 6c65  "..        if le
+00019de0: 6e28 7661 6c75 6529 213d 343a 0a20 2020  n(value)!=4:.   
+00019df0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00019e00: 616c 7565 4572 726f 722c 2022 342d 7365  alueError, "4-se
+00019e10: 7175 656e 6365 2065 7870 6563 7465 6422  quence expected"
+00019e20: 0a0a 2020 2020 2020 2020 6920 3d20 6964  ..        i = id
+00019e30: 780a 2020 2020 2020 2020 6966 2069 3d3d  x.        if i==
+00019e40: 303a 0a20 2020 2020 2020 2020 2020 2073  0:.            s
+00019e50: 656c 662e 6d31 3120 3d20 7661 6c75 655b  elf.m11 = value[
+00019e60: 305d 0a20 2020 2020 2020 2020 2020 2073  0].            s
+00019e70: 656c 662e 6d31 3220 3d20 7661 6c75 655b  elf.m12 = value[
+00019e80: 315d 0a20 2020 2020 2020 2020 2020 2073  1].            s
+00019e90: 656c 662e 6d31 3320 3d20 7661 6c75 655b  elf.m13 = value[
+00019ea0: 325d 0a20 2020 2020 2020 2020 2020 2073  2].            s
+00019eb0: 656c 662e 6d31 3420 3d20 7661 6c75 655b  elf.m14 = value[
+00019ec0: 335d 0a20 2020 2020 2020 2065 6c69 6620  3].        elif 
+00019ed0: 693d 3d31 3a0a 2020 2020 2020 2020 2020  i==1:.          
+00019ee0: 2020 7365 6c66 2e6d 3231 203d 2076 616c    self.m21 = val
+00019ef0: 7565 5b30 5d0a 2020 2020 2020 2020 2020  ue[0].          
+00019f00: 2020 7365 6c66 2e6d 3232 203d 2076 616c    self.m22 = val
+00019f10: 7565 5b31 5d0a 2020 2020 2020 2020 2020  ue[1].          
+00019f20: 2020 7365 6c66 2e6d 3233 203d 2076 616c    self.m23 = val
+00019f30: 7565 5b32 5d0a 2020 2020 2020 2020 2020  ue[2].          
+00019f40: 2020 7365 6c66 2e6d 3234 203d 2076 616c    self.m24 = val
+00019f50: 7565 5b33 5d0a 2020 2020 2020 2020 656c  ue[3].        el
+00019f60: 6966 2069 3d3d 323a 0a20 2020 2020 2020  if i==2:.       
+00019f70: 2020 2020 2073 656c 662e 6d33 3120 3d20       self.m31 = 
+00019f80: 7661 6c75 655b 305d 0a20 2020 2020 2020  value[0].       
+00019f90: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
+00019fa0: 7661 6c75 655b 315d 0a20 2020 2020 2020  value[1].       
+00019fb0: 2020 2020 2073 656c 662e 6d33 3320 3d20       self.m33 = 
+00019fc0: 7661 6c75 655b 325d 0a20 2020 2020 2020  value[2].       
+00019fd0: 2020 2020 2073 656c 662e 6d33 3420 3d20       self.m34 = 
+00019fe0: 7661 6c75 655b 335d 0a20 2020 2020 2020  value[3].       
+00019ff0: 2065 6c69 6620 693d 3d33 3a0a 2020 2020   elif i==3:.    
+0001a000: 2020 2020 2020 2020 7365 6c66 2e6d 3431          self.m41
+0001a010: 203d 2076 616c 7565 5b30 5d0a 2020 2020   = value[0].    
+0001a020: 2020 2020 2020 2020 7365 6c66 2e6d 3432          self.m42
+0001a030: 203d 2076 616c 7565 5b31 5d0a 2020 2020   = value[1].    
+0001a040: 2020 2020 2020 2020 7365 6c66 2e6d 3433          self.m43
+0001a050: 203d 2076 616c 7565 5b32 5d0a 2020 2020   = value[2].    
+0001a060: 2020 2020 2020 2020 7365 6c66 2e6d 3434          self.m44
+0001a070: 203d 2076 616c 7565 5b33 5d0a 2020 2020   = value[3].    
+0001a080: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001a090: 2020 2020 2020 7261 6973 6520 496e 6465        raise Inde
+0001a0a0: 7845 7272 6f72 2c20 2269 6e64 6578 206f  xError, "index o
+0001a0b0: 7574 206f 6620 7261 6e67 6522 0a0a 2020  ut of range"..  
+0001a0c0: 2020 6465 6620 6765 7443 6f6c 756d 6e28    def getColumn(
+0001a0d0: 7365 6c66 2c20 6964 7829 3a0a 2020 2020  self, idx):.    
+0001a0e0: 2020 2020 2222 2252 6574 7572 6e20 636f      """Return co
+0001a0f0: 6c75 6d6e 2028 6173 2076 6563 3429 2e22  lumn (as vec4)."
+0001a100: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
+0001a110: 696e 7420 690a 0a20 2020 2020 2020 2054  int i..        T
+0001a120: 3d74 7970 6528 6964 7829 0a20 2020 2020  =type(idx).     
+0001a130: 2020 2069 6620 5421 3d69 6e74 2061 6e64     if T!=int and
+0001a140: 2054 213d 6c6f 6e67 3a0a 2020 2020 2020   T!=long:.      
+0001a150: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+0001a160: 4572 726f 722c 2269 6e64 6578 206d 7573  Error,"index mus
+0001a170: 7420 6265 2069 6e74 6567 6572 220a 0a20  t be integer".. 
+0001a180: 2020 2020 2020 2069 203d 2069 6478 0a20         i = idx. 
+0001a190: 2020 2020 2020 2069 6620 693d 3d30 3a0a         if i==0:.
+0001a1a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001a1b0: 726e 2076 6563 3428 7365 6c66 2e6d 3131  rn vec4(self.m11
+0001a1c0: 2c20 7365 6c66 2e6d 3231 2c20 7365 6c66  , self.m21, self
+0001a1d0: 2e6d 3331 2c20 7365 6c66 2e6d 3431 290a  .m31, self.m41).
+0001a1e0: 2020 2020 2020 2020 656c 6966 2069 3d3d          elif i==
+0001a1f0: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
+0001a200: 6574 7572 6e20 7665 6334 2873 656c 662e  eturn vec4(self.
+0001a210: 6d31 322c 2073 656c 662e 6d32 322c 2073  m12, self.m22, s
+0001a220: 656c 662e 6d33 322c 2073 656c 662e 6d34  elf.m32, self.m4
+0001a230: 3229 0a20 2020 2020 2020 2065 6c69 6620  2).        elif 
+0001a240: 693d 3d32 3a0a 2020 2020 2020 2020 2020  i==2:.          
+0001a250: 2020 7265 7475 726e 2076 6563 3428 7365    return vec4(se
+0001a260: 6c66 2e6d 3133 2c20 7365 6c66 2e6d 3233  lf.m13, self.m23
+0001a270: 2c20 7365 6c66 2e6d 3333 2c20 7365 6c66  , self.m33, self
+0001a280: 2e6d 3433 290a 2020 2020 2020 2020 656c  .m43).        el
+0001a290: 6966 2069 3d3d 333a 0a20 2020 2020 2020  if i==3:.       
+0001a2a0: 2020 2020 2072 6574 7572 6e20 7665 6334       return vec4
+0001a2b0: 2873 656c 662e 6d31 342c 2073 656c 662e  (self.m14, self.
+0001a2c0: 6d32 342c 2073 656c 662e 6d33 342c 2073  m24, self.m34, s
+0001a2d0: 656c 662e 6d34 3429 0a20 2020 2020 2020  elf.m44).       
+0001a2e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001a2f0: 2020 2072 6169 7365 2049 6e64 6578 4572     raise IndexEr
+0001a300: 726f 722c 2022 696e 6465 7820 6f75 7420  ror, "index out 
+0001a310: 6f66 2072 616e 6765 220a 0a20 2020 2064  of range"..    d
+0001a320: 6566 2073 6574 436f 6c75 6d6e 2873 656c  ef setColumn(sel
+0001a330: 662c 2069 6478 2c20 7661 6c75 6529 3a0a  f, idx, value):.
+0001a340: 2020 2020 2020 2020 2222 2253 6574 2063          """Set c
+0001a350: 6f6c 756d 6e2e 2222 220a 2020 2020 2020  olumn.""".      
+0001a360: 2020 6364 6566 2069 6e74 2069 0a0a 2020    cdef int i..  
+0001a370: 2020 2020 2020 543d 7479 7065 2869 6478        T=type(idx
+0001a380: 290a 2020 2020 2020 2020 6966 2054 213d  ).        if T!=
+0001a390: 696e 7420 616e 6420 5421 3d6c 6f6e 673a  int and T!=long:
+0001a3a0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0001a3b0: 7365 2054 7970 6545 7272 6f72 2c22 696e  se TypeError,"in
+0001a3c0: 6465 7820 6d75 7374 2062 6520 696e 7465  dex must be inte
+0001a3d0: 6765 7222 0a0a 2020 2020 2020 2020 6966  ger"..        if
+0001a3e0: 206c 656e 2876 616c 7565 2921 3d34 3a0a   len(value)!=4:.
+0001a3f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001a400: 6520 5661 6c75 6545 7272 6f72 2c20 2234  e ValueError, "4
+0001a410: 2d73 6571 7565 6e63 6520 6578 7065 6374  -sequence expect
+0001a420: 6564 220a 0a20 2020 2020 2020 2069 203d  ed"..        i =
+0001a430: 2069 6478 0a20 2020 2020 2020 2069 6620   idx.        if 
+0001a440: 693d 3d30 3a0a 2020 2020 2020 2020 2020  i==0:.          
+0001a450: 2020 7365 6c66 2e6d 3131 203d 2076 616c    self.m11 = val
+0001a460: 7565 5b30 5d0a 2020 2020 2020 2020 2020  ue[0].          
+0001a470: 2020 7365 6c66 2e6d 3231 203d 2076 616c    self.m21 = val
+0001a480: 7565 5b31 5d0a 2020 2020 2020 2020 2020  ue[1].          
+0001a490: 2020 7365 6c66 2e6d 3331 203d 2076 616c    self.m31 = val
+0001a4a0: 7565 5b32 5d0a 2020 2020 2020 2020 2020  ue[2].          
+0001a4b0: 2020 7365 6c66 2e6d 3431 203d 2076 616c    self.m41 = val
+0001a4c0: 7565 5b33 5d0a 2020 2020 2020 2020 656c  ue[3].        el
+0001a4d0: 6966 2069 3d3d 313a 0a20 2020 2020 2020  if i==1:.       
+0001a4e0: 2020 2020 2073 656c 662e 6d31 3220 3d20       self.m12 = 
+0001a4f0: 7661 6c75 655b 305d 0a20 2020 2020 2020  value[0].       
+0001a500: 2020 2020 2073 656c 662e 6d32 3220 3d20       self.m22 = 
+0001a510: 7661 6c75 655b 315d 0a20 2020 2020 2020  value[1].       
+0001a520: 2020 2020 2073 656c 662e 6d33 3220 3d20       self.m32 = 
+0001a530: 7661 6c75 655b 325d 0a20 2020 2020 2020  value[2].       
+0001a540: 2020 2020 2073 656c 662e 6d34 3220 3d20       self.m42 = 
+0001a550: 7661 6c75 655b 335d 0a20 2020 2020 2020  value[3].       
+0001a560: 2065 6c69 6620 693d 3d32 3a0a 2020 2020   elif i==2:.    
+0001a570: 2020 2020 2020 2020 7365 6c66 2e6d 3133          self.m13
+0001a580: 203d 2076 616c 7565 5b30 5d0a 2020 2020   = value[0].    
+0001a590: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
+0001a5a0: 203d 2076 616c 7565 5b31 5d0a 2020 2020   = value[1].    
+0001a5b0: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
+0001a5c0: 203d 2076 616c 7565 5b32 5d0a 2020 2020   = value[2].    
+0001a5d0: 2020 2020 2020 2020 7365 6c66 2e6d 3433          self.m43
+0001a5e0: 203d 2076 616c 7565 5b33 5d0a 2020 2020   = value[3].    
+0001a5f0: 2020 2020 656c 6966 2069 3d3d 333a 0a20      elif i==3:. 
+0001a600: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001a610: 6d31 3420 3d20 7661 6c75 655b 305d 0a20  m14 = value[0]. 
+0001a620: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001a630: 6d32 3420 3d20 7661 6c75 655b 315d 0a20  m24 = value[1]. 
+0001a640: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001a650: 6d33 3420 3d20 7661 6c75 655b 325d 0a20  m34 = value[2]. 
+0001a660: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001a670: 6d34 3420 3d20 7661 6c75 655b 335d 0a20  m44 = value[3]. 
+0001a680: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001a690: 2020 2020 2020 2020 2072 6169 7365 2049           raise I
+0001a6a0: 6e64 6578 4572 726f 722c 2022 696e 6465  ndexError, "inde
+0001a6b0: 7820 6f75 7420 6f66 2072 616e 6765 220a  x out of range".
+0001a6c0: 0a0a 2020 2020 6465 6620 746f 4c69 7374  ..    def toList
+0001a6d0: 2873 656c 662c 2072 6f77 6d61 6a6f 723d  (self, rowmajor=
+0001a6e0: 3029 3a0a 2020 2020 2020 2020 2222 2252  0):.        """R
+0001a6f0: 6574 7572 6e20 6120 6c69 7374 2063 6f6e  eturn a list con
+0001a700: 7461 696e 696e 6720 7468 6520 6d61 7472  taining the matr
+0001a710: 6978 2065 6c65 6d65 6e74 732e 0a0a 2020  ix elements...  
+0001a720: 2020 2020 2020 4279 2064 6566 6175 6c74        By default
+0001a730: 2074 6865 206c 6973 7420 6973 2069 6e20   the list is in 
+0001a740: 636f 6c75 6d6e 2d6d 616a 6f72 206f 7264  column-major ord
+0001a750: 6572 2028 7768 6963 6820 6361 6e20 6469  er (which can di
+0001a760: 7265 6374 6c79 2062 650a 2020 2020 2020  rectly be.      
+0001a770: 2020 7573 6564 2069 6e20 4f70 656e 474c    used in OpenGL
+0001a780: 206f 7220 5265 6e64 6572 4d61 6e29 2e20   or RenderMan). 
+0001a790: 4966 2079 6f75 2073 6574 2074 6865 206f  If you set the o
+0001a7a0: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
+0001a7b0: 0a20 2020 2020 2020 2072 6f77 6d61 6a6f  .        rowmajo
+0001a7c0: 7220 746f 2031 2c20 796f 7527 6c6c 2067  r to 1, you'll g
+0001a7d0: 6574 2074 6865 206c 6973 7420 696e 2072  et the list in r
+0001a7e0: 6f77 2d6d 616a 6f72 206f 7264 6572 2e0a  ow-major order..
+0001a7f0: 0a20 2020 2020 2020 203e 3e3e 204d 3d6d  .        >>> M=m
+0001a800: 6174 3428 312c 322c 332c 342c 352c 362c  at4(1,2,3,4,5,6,
+0001a810: 372c 382c 392c 3130 2c31 312c 3132 2c31  7,8,9,10,11,12,1
+0001a820: 332c 3134 2c31 352c 3136 290a 2020 2020  3,14,15,16).    
+0001a830: 2020 2020 3e3e 3e20 7072 696e 7420 4d2e      >>> print M.
+0001a840: 746f 4c69 7374 2829 0a20 2020 2020 2020  toList().       
+0001a850: 205b 312c 2035 2c20 392c 2031 332c 2032   [1, 5, 9, 13, 2
+0001a860: 2c20 362c 2031 302c 2031 342c 2033 2c20  , 6, 10, 14, 3, 
+0001a870: 372c 2031 312c 2031 352c 2034 2c20 382c  7, 11, 15, 4, 8,
+0001a880: 2031 322c 2031 365d 0a20 2020 2020 2020   12, 16].       
+0001a890: 203e 3e3e 2070 7269 6e74 204d 2e74 6f4c   >>> print M.toL
+0001a8a0: 6973 7428 726f 776d 616a 6f72 3d31 290a  ist(rowmajor=1).
+0001a8b0: 2020 2020 2020 2020 5b31 2c20 322c 2033          [1, 2, 3
+0001a8c0: 2c20 342c 2035 2c20 362c 2037 2c20 382c  , 4, 5, 6, 7, 8,
+0001a8d0: 2039 2c20 3130 2c20 3131 2c20 3132 2c20   9, 10, 11, 12, 
+0001a8e0: 3133 2c20 3134 2c20 3135 2c20 3136 5d0a  13, 14, 15, 16].
+0001a8f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001a900: 2020 2020 6966 2072 6f77 6d61 6a6f 723a      if rowmajor:
+0001a910: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001a920: 7572 6e20 5b73 656c 662e 6d31 312c 2073  urn [self.m11, s
+0001a930: 656c 662e 6d31 322c 2073 656c 662e 6d31  elf.m12, self.m1
+0001a940: 332c 2073 656c 662e 6d31 342c 0a20 2020  3, self.m14,.   
+0001a950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a960: 2073 656c 662e 6d32 312c 2073 656c 662e   self.m21, self.
+0001a970: 6d32 322c 2073 656c 662e 6d32 332c 2073  m22, self.m23, s
+0001a980: 656c 662e 6d32 342c 0a20 2020 2020 2020  elf.m24,.       
+0001a990: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001a9a0: 662e 6d33 312c 2073 656c 662e 6d33 322c  f.m31, self.m32,
+0001a9b0: 2073 656c 662e 6d33 332c 2073 656c 662e   self.m33, self.
+0001a9c0: 6d33 342c 0a20 2020 2020 2020 2020 2020  m34,.           
+0001a9d0: 2020 2020 2020 2020 2073 656c 662e 6d34           self.m4
+0001a9e0: 312c 2073 656c 662e 6d34 322c 2073 656c  1, self.m42, sel
+0001a9f0: 662e 6d34 332c 2073 656c 662e 6d34 345d  f.m43, self.m44]
+0001aa00: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0001aa10: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001aa20: 6e20 5b73 656c 662e 6d31 312c 2073 656c  n [self.m11, sel
+0001aa30: 662e 6d32 312c 2073 656c 662e 6d33 312c  f.m21, self.m31,
+0001aa40: 2073 656c 662e 6d34 312c 0a20 2020 2020   self.m41,.     
+0001aa50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001aa60: 656c 662e 6d31 322c 2073 656c 662e 6d32  elf.m12, self.m2
+0001aa70: 322c 2073 656c 662e 6d33 322c 2073 656c  2, self.m32, sel
+0001aa80: 662e 6d34 322c 0a20 2020 2020 2020 2020  f.m42,.         
+0001aa90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001aaa0: 6d31 332c 2073 656c 662e 6d32 332c 2073  m13, self.m23, s
+0001aab0: 656c 662e 6d33 332c 2073 656c 662e 6d34  elf.m33, self.m4
+0001aac0: 332c 0a20 2020 2020 2020 2020 2020 2020  3,.             
+0001aad0: 2020 2020 2020 2073 656c 662e 6d31 342c         self.m14,
+0001aae0: 2073 656c 662e 6d32 342c 2073 656c 662e   self.m24, self.
+0001aaf0: 6d33 342c 2073 656c 662e 6d34 345d 0a0a  m34, self.m44]..
+0001ab00: 0a20 2020 2064 6566 2069 6465 6e74 6974  .    def identit
+0001ab10: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
+0001ab20: 2022 2222 5265 7475 726e 2069 6465 6e74   """Return ident
+0001ab30: 6974 7920 6d61 7472 6978 2e0a 0a20 2020  ity matrix...   
+0001ab40: 2020 2020 203e 3e3e 2070 7269 6e74 206d       >>> print m
+0001ab50: 6174 3428 292e 6964 656e 7469 7479 2829  at4().identity()
+0001ab60: 0a20 2020 2020 2020 205b 2020 2031 2e30  .        [   1.0
+0001ab70: 3030 302c 2020 2020 302e 3030 3030 2c20  000,    0.0000, 
+0001ab80: 2020 2030 2e30 3030 302c 2020 2020 302e     0.0000,    0.
+0001ab90: 3030 3030 5d0a 2020 2020 2020 2020 5b20  0000].        [ 
+0001aba0: 2020 302e 3030 3030 2c20 2020 2031 2e30    0.0000,    1.0
+0001abb0: 3030 302c 2020 2020 302e 3030 3030 2c20  000,    0.0000, 
+0001abc0: 2020 2030 2e30 3030 305d 0a20 2020 2020     0.0000].     
+0001abd0: 2020 205b 2020 2030 2e30 3030 302c 2020     [   0.0000,  
+0001abe0: 2020 302e 3030 3030 2c20 2020 2031 2e30    0.0000,    1.0
+0001abf0: 3030 302c 2020 2020 302e 3030 3030 5d0a  000,    0.0000].
+0001ac00: 2020 2020 2020 2020 5b20 2020 302e 3030          [   0.00
+0001ac10: 3030 2c20 2020 2030 2e30 3030 302c 2020  00,    0.0000,  
+0001ac20: 2020 302e 3030 3030 2c20 2020 2031 2e30    0.0000,    1.0
+0001ac30: 3030 305d 0a20 2020 2020 2020 2022 2222  000].        """
+0001ac40: 0a20 2020 2020 2020 2063 6465 6620 6d61  .        cdef ma
+0001ac50: 7434 2072 6573 0a20 2020 2020 2020 2072  t4 res.        r
+0001ac60: 6573 203d 206d 6174 3428 290a 2020 2020  es = mat4().    
+0001ac70: 2020 2020 7265 732e 6d31 3120 3d20 312e      res.m11 = 1.
+0001ac80: 300a 2020 2020 2020 2020 7265 732e 6d31  0.        res.m1
+0001ac90: 3220 3d20 302e 300a 2020 2020 2020 2020  2 = 0.0.        
+0001aca0: 7265 732e 6d31 3320 3d20 302e 300a 2020  res.m13 = 0.0.  
+0001acb0: 2020 2020 2020 7265 732e 6d31 3420 3d20        res.m14 = 
+0001acc0: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
+0001acd0: 6d32 3120 3d20 302e 300a 2020 2020 2020  m21 = 0.0.      
+0001ace0: 2020 7265 732e 6d32 3220 3d20 312e 300a    res.m22 = 1.0.
+0001acf0: 2020 2020 2020 2020 7265 732e 6d32 3320          res.m23 
+0001ad00: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
+0001ad10: 732e 6d32 3420 3d20 302e 300a 2020 2020  s.m24 = 0.0.    
+0001ad20: 2020 2020 7265 732e 6d33 3120 3d20 302e      res.m31 = 0.
+0001ad30: 300a 2020 2020 2020 2020 7265 732e 6d33  0.        res.m3
+0001ad40: 3220 3d20 302e 300a 2020 2020 2020 2020  2 = 0.0.        
+0001ad50: 7265 732e 6d33 3320 3d20 312e 300a 2020  res.m33 = 1.0.  
+0001ad60: 2020 2020 2020 7265 732e 6d33 3420 3d20        res.m34 = 
+0001ad70: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
+0001ad80: 6d34 3120 3d20 302e 300a 2020 2020 2020  m41 = 0.0.      
+0001ad90: 2020 7265 732e 6d34 3220 3d20 302e 300a    res.m42 = 0.0.
+0001ada0: 2020 2020 2020 2020 7265 732e 6d34 3320          res.m43 
+0001adb0: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
+0001adc0: 732e 6d34 3420 3d20 312e 300a 2020 2020  s.m44 = 1.0.    
+0001add0: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
+0001ade0: 2020 2020 6465 6620 7472 616e 7370 6f73      def transpos
+0001adf0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+0001ae00: 2022 2222 5265 7475 726e 2074 7261 6e73   """Return trans
+0001ae10: 706f 7365 206d 6174 7269 782e 0a0a 2020  pose matrix...  
+0001ae20: 2020 2020 2020 3e3e 3e20 4d3d 6d61 7434        >>> M=mat4
+0001ae30: 2831 2c32 2c33 2c34 2c35 2c36 2c37 2c38  (1,2,3,4,5,6,7,8
+0001ae40: 2c39 2c31 302c 3131 2c31 322c 3133 2c31  ,9,10,11,12,13,1
+0001ae50: 342c 3135 2c31 3629 0a20 2020 2020 2020  4,15,16).       
+0001ae60: 203e 3e3e 2070 7269 6e74 204d 2e74 7261   >>> print M.tra
+0001ae70: 6e73 706f 7365 2829 0a20 2020 2020 2020  nspose().       
+0001ae80: 205b 2020 2031 2e30 3030 302c 2020 2020   [   1.0000,    
+0001ae90: 352e 3030 3030 2c20 2020 2039 2e30 3030  5.0000,    9.000
+0001aea0: 302c 2020 2031 332e 3030 3030 5d0a 2020  0,   13.0000].  
+0001aeb0: 2020 2020 2020 5b20 2020 322e 3030 3030        [   2.0000
+0001aec0: 2c20 2020 2036 2e30 3030 302c 2020 2031  ,    6.0000,   1
+0001aed0: 302e 3030 3030 2c20 2020 3134 2e30 3030  0.0000,   14.000
+0001aee0: 305d 0a20 2020 2020 2020 205b 2020 2033  0].        [   3
+0001aef0: 2e30 3030 302c 2020 2020 372e 3030 3030  .0000,    7.0000
+0001af00: 2c20 2020 3131 2e30 3030 302c 2020 2031  ,   11.0000,   1
+0001af10: 352e 3030 3030 5d0a 2020 2020 2020 2020  5.0000].        
+0001af20: 5b20 2020 342e 3030 3030 2c20 2020 2038  [   4.0000,    8
+0001af30: 2e30 3030 302c 2020 2031 322e 3030 3030  .0000,   12.0000
+0001af40: 2c20 2020 3136 2e30 3030 305d 0a20 2020  ,   16.0000].   
+0001af50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001af60: 2063 6465 6620 6d61 7434 2072 6573 0a20   cdef mat4 res. 
+0001af70: 2020 2020 2020 2072 6573 203d 206d 6174         res = mat
+0001af80: 3428 290a 2020 2020 2020 2020 7265 732e  4().        res.
+0001af90: 6d31 3120 3d20 7365 6c66 2e6d 3131 0a20  m11 = self.m11. 
+0001afa0: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
+0001afb0: 2073 656c 662e 6d32 310a 2020 2020 2020   self.m21.      
+0001afc0: 2020 7265 732e 6d31 3320 3d20 7365 6c66    res.m13 = self
+0001afd0: 2e6d 3331 0a20 2020 2020 2020 2072 6573  .m31.        res
+0001afe0: 2e6d 3134 203d 2073 656c 662e 6d34 310a  .m14 = self.m41.
+0001aff0: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
+0001b000: 3d20 7365 6c66 2e6d 3132 0a20 2020 2020  = self.m12.     
+0001b010: 2020 2072 6573 2e6d 3232 203d 2073 656c     res.m22 = sel
+0001b020: 662e 6d32 320a 2020 2020 2020 2020 7265  f.m22.        re
+0001b030: 732e 6d32 3320 3d20 7365 6c66 2e6d 3332  s.m23 = self.m32
+0001b040: 0a20 2020 2020 2020 2072 6573 2e6d 3234  .        res.m24
+0001b050: 203d 2073 656c 662e 6d34 320a 2020 2020   = self.m42.    
+0001b060: 2020 2020 7265 732e 6d33 3120 3d20 7365      res.m31 = se
+0001b070: 6c66 2e6d 3133 0a20 2020 2020 2020 2072  lf.m13.        r
+0001b080: 6573 2e6d 3332 203d 2073 656c 662e 6d32  es.m32 = self.m2
+0001b090: 330a 2020 2020 2020 2020 7265 732e 6d33  3.        res.m3
+0001b0a0: 3320 3d20 7365 6c66 2e6d 3333 0a20 2020  3 = self.m33.   
+0001b0b0: 2020 2020 2072 6573 2e6d 3334 203d 2073       res.m34 = s
+0001b0c0: 656c 662e 6d34 330a 2020 2020 2020 2020  elf.m43.        
+0001b0d0: 7265 732e 6d34 3120 3d20 7365 6c66 2e6d  res.m41 = self.m
+0001b0e0: 3134 0a20 2020 2020 2020 2072 6573 2e6d  14.        res.m
+0001b0f0: 3432 203d 2073 656c 662e 6d32 340a 2020  42 = self.m24.  
+0001b100: 2020 2020 2020 7265 732e 6d34 3320 3d20        res.m43 = 
+0001b110: 7365 6c66 2e6d 3334 0a20 2020 2020 2020  self.m34.       
+0001b120: 2072 6573 2e6d 3434 203d 2073 656c 662e   res.m44 = self.
+0001b130: 6d34 340a 2020 2020 2020 2020 7265 7475  m44.        retu
+0001b140: 726e 2072 6573 0a0a 2020 2020 6465 6620  rn res..    def 
+0001b150: 6465 7465 726d 696e 616e 7428 7365 6c66  determinant(self
+0001b160: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+0001b170: 7475 726e 2064 6574 6572 6d69 6e61 6e74  turn determinant
+0001b180: 2e0a 0a20 2020 2020 2020 203e 3e3e 204d  ...        >>> M
+0001b190: 3d6d 6174 3428 322e 302c 302c 302c 302c  =mat4(2.0,0,0,0,
+0001b1a0: 2030 2c32 2e30 2c30 2c30 2c20 302c 302c   0,2.0,0,0, 0,0,
+0001b1b0: 322e 302c 302c 2030 2c30 2c30 2c32 2e30  2.0,0, 0,0,0,2.0
+0001b1c0: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
+0001b1d0: 696e 7420 4d2e 6465 7465 726d 696e 616e  int M.determinan
+0001b1e0: 7428 290a 2020 2020 2020 2020 3136 2e30  t().        16.0
+0001b1f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001b200: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001b210: 2e6d 3131 2a73 656c 662e 6d32 322a 7365  .m11*self.m22*se
+0001b220: 6c66 2e6d 3333 2a73 656c 662e 6d34 3420  lf.m33*self.m44 
+0001b230: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+0001b240: 202d 7365 6c66 2e6d 3131 2a73 656c 662e   -self.m11*self.
+0001b250: 6d32 322a 7365 6c66 2e6d 3334 2a73 656c  m22*self.m34*sel
+0001b260: 662e 6d34 3320 5c0a 2020 2020 2020 2020  f.m43 \.        
+0001b270: 2020 2020 2020 202b 7365 6c66 2e6d 3131         +self.m11
+0001b280: 2a73 656c 662e 6d32 332a 7365 6c66 2e6d  *self.m23*self.m
+0001b290: 3334 2a73 656c 662e 6d34 3220 5c0a 2020  34*self.m42 \.  
+0001b2a0: 2020 2020 2020 2020 2020 2020 202d 7365               -se
+0001b2b0: 6c66 2e6d 3131 2a73 656c 662e 6d32 332a  lf.m11*self.m23*
+0001b2c0: 7365 6c66 2e6d 3332 2a73 656c 662e 6d34  self.m32*self.m4
+0001b2d0: 3420 5c0a 2020 2020 2020 2020 2020 2020  4 \.            
+0001b2e0: 2020 202b 7365 6c66 2e6d 3131 2a73 656c     +self.m11*sel
+0001b2f0: 662e 6d32 342a 7365 6c66 2e6d 3332 2a73  f.m24*self.m32*s
+0001b300: 656c 662e 6d34 3320 5c0a 2020 2020 2020  elf.m43 \.      
+0001b310: 2020 2020 2020 2020 202d 7365 6c66 2e6d           -self.m
+0001b320: 3131 2a73 656c 662e 6d32 342a 7365 6c66  11*self.m24*self
+0001b330: 2e6d 3333 2a73 656c 662e 6d34 3220 5c0a  .m33*self.m42 \.
+0001b340: 2020 2020 2020 2020 2020 2020 2020 202d                 -
+0001b350: 7365 6c66 2e6d 3132 2a73 656c 662e 6d32  self.m12*self.m2
+0001b360: 332a 7365 6c66 2e6d 3334 2a73 656c 662e  3*self.m34*self.
+0001b370: 6d34 3120 5c0a 2020 2020 2020 2020 2020  m41 \.          
+0001b380: 2020 2020 202b 7365 6c66 2e6d 3132 2a73       +self.m12*s
+0001b390: 656c 662e 6d32 332a 7365 6c66 2e6d 3331  elf.m23*self.m31
+0001b3a0: 2a73 656c 662e 6d34 3420 5c0a 2020 2020  *self.m44 \.    
+0001b3b0: 2020 2020 2020 2020 2020 202d 7365 6c66             -self
+0001b3c0: 2e6d 3132 2a73 656c 662e 6d32 342a 7365  .m12*self.m24*se
+0001b3d0: 6c66 2e6d 3331 2a73 656c 662e 6d34 3320  lf.m31*self.m43 
+0001b3e0: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+0001b3f0: 202b 7365 6c66 2e6d 3132 2a73 656c 662e   +self.m12*self.
+0001b400: 6d32 342a 7365 6c66 2e6d 3333 2a73 656c  m24*self.m33*sel
+0001b410: 662e 6d34 3120 5c0a 2020 2020 2020 2020  f.m41 \.        
+0001b420: 2020 2020 2020 202d 7365 6c66 2e6d 3132         -self.m12
+0001b430: 2a73 656c 662e 6d32 312a 7365 6c66 2e6d  *self.m21*self.m
+0001b440: 3333 2a73 656c 662e 6d34 3420 5c0a 2020  33*self.m44 \.  
+0001b450: 2020 2020 2020 2020 2020 2020 202b 7365               +se
+0001b460: 6c66 2e6d 3132 2a73 656c 662e 6d32 312a  lf.m12*self.m21*
+0001b470: 7365 6c66 2e6d 3334 2a73 656c 662e 6d34  self.m34*self.m4
+0001b480: 3320 5c0a 2020 2020 2020 2020 2020 2020  3 \.            
+0001b490: 2020 202b 7365 6c66 2e6d 3133 2a73 656c     +self.m13*sel
+0001b4a0: 662e 6d32 342a 7365 6c66 2e6d 3331 2a73  f.m24*self.m31*s
+0001b4b0: 656c 662e 6d34 3220 5c0a 2020 2020 2020  elf.m42 \.      
+0001b4c0: 2020 2020 2020 2020 202d 7365 6c66 2e6d           -self.m
+0001b4d0: 3133 2a73 656c 662e 6d32 342a 7365 6c66  13*self.m24*self
+0001b4e0: 2e6d 3332 2a73 656c 662e 6d34 3120 5c0a  .m32*self.m41 \.
+0001b4f0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
+0001b500: 7365 6c66 2e6d 3133 2a73 656c 662e 6d32  self.m13*self.m2
+0001b510: 312a 7365 6c66 2e6d 3332 2a73 656c 662e  1*self.m32*self.
+0001b520: 6d34 3420 5c0a 2020 2020 2020 2020 2020  m44 \.          
+0001b530: 2020 2020 202d 7365 6c66 2e6d 3133 2a73       -self.m13*s
+0001b540: 656c 662e 6d32 312a 7365 6c66 2e6d 3334  elf.m21*self.m34
+0001b550: 2a73 656c 662e 6d34 3220 5c0a 2020 2020  *self.m42 \.    
+0001b560: 2020 2020 2020 2020 2020 202b 7365 6c66             +self
+0001b570: 2e6d 3133 2a73 656c 662e 6d32 322a 7365  .m13*self.m22*se
+0001b580: 6c66 2e6d 3334 2a73 656c 662e 6d34 3120  lf.m34*self.m41 
+0001b590: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
+0001b5a0: 202d 7365 6c66 2e6d 3133 2a73 656c 662e   -self.m13*self.
+0001b5b0: 6d32 322a 7365 6c66 2e6d 3331 2a73 656c  m22*self.m31*sel
+0001b5c0: 662e 6d34 3420 5c0a 2020 2020 2020 2020  f.m44 \.        
+0001b5d0: 2020 2020 2020 202d 7365 6c66 2e6d 3134         -self.m14
+0001b5e0: 2a73 656c 662e 6d32 312a 7365 6c66 2e6d  *self.m21*self.m
+0001b5f0: 3332 2a73 656c 662e 6d34 3320 5c0a 2020  32*self.m43 \.  
+0001b600: 2020 2020 2020 2020 2020 2020 202b 7365               +se
+0001b610: 6c66 2e6d 3134 2a73 656c 662e 6d32 312a  lf.m14*self.m21*
+0001b620: 7365 6c66 2e6d 3333 2a73 656c 662e 6d34  self.m33*self.m4
+0001b630: 3220 5c0a 2020 2020 2020 2020 2020 2020  2 \.            
+0001b640: 2020 202d 7365 6c66 2e6d 3134 2a73 656c     -self.m14*sel
+0001b650: 662e 6d32 322a 7365 6c66 2e6d 3333 2a73  f.m22*self.m33*s
+0001b660: 656c 662e 6d34 3120 5c0a 2020 2020 2020  elf.m41 \.      
+0001b670: 2020 2020 2020 2020 202b 7365 6c66 2e6d           +self.m
+0001b680: 3134 2a73 656c 662e 6d32 322a 7365 6c66  14*self.m22*self
+0001b690: 2e6d 3331 2a73 656c 662e 6d34 3320 5c0a  .m31*self.m43 \.
+0001b6a0: 2020 2020 2020 2020 2020 2020 2020 202d                 -
+0001b6b0: 7365 6c66 2e6d 3134 2a73 656c 662e 6d32  self.m14*self.m2
+0001b6c0: 332a 7365 6c66 2e6d 3331 2a73 656c 662e  3*self.m31*self.
+0001b6d0: 6d34 3220 5c0a 2020 2020 2020 2020 2020  m42 \.          
+0001b6e0: 2020 2020 202b 7365 6c66 2e6d 3134 2a73       +self.m14*s
+0001b6f0: 656c 662e 6d32 332a 7365 6c66 2e6d 3332  elf.m23*self.m32
+0001b700: 2a73 656c 662e 6d34 310a 0a20 2020 2064  *self.m41..    d
+0001b710: 6566 205f 7375 626d 6174 2873 656c 662c  ef _submat(self,
+0001b720: 206d 6174 3320 4d33 2c20 692c 6a29 3a0a   mat3 M3, i,j):.
+0001b730: 2020 2020 2020 2020 6364 6566 2069 6e74          cdef int
+0001b740: 206b 2c6c 0a20 2020 2020 2020 2063 6465   k,l.        cde
+0001b750: 6620 646f 7562 6c65 2076 0a0a 2320 2020  f double v..#   
+0001b760: 2020 2020 204d 3d6d 6174 3328 290a 2020       M=mat3().  
+0001b770: 2020 2020 2020 6b3d 300a 2020 2020 2020        k=0.      
+0001b780: 2020 7768 696c 6520 6b3c 333a 0a20 2020    while k<3:.   
+0001b790: 2020 2020 2020 2020 206c 3d30 0a20 2020           l=0.   
+0001b7a0: 2020 2020 2020 2020 2077 6869 6c65 206c           while l
+0001b7b0: 3c33 3a0a 2020 2020 2020 2020 2020 2020  <3:.            
+0001b7c0: 2020 2020 743d 286b 2c6c 290a 2020 2020      t=(k,l).    
+0001b7d0: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+0001b7e0: 3e3d 693a 0a20 2020 2020 2020 2020 2020  >=i:.           
+0001b7f0: 2020 2020 2020 2020 2074 3d28 6b2b 312c           t=(k+1,
+0001b800: 745b 315d 290a 2020 2020 2020 2020 2020  t[1]).          
+0001b810: 2020 2020 2020 6966 206c 3e3d 6a3a 0a20        if l>=j:. 
 0001b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b830: 6966 206b 3d3d 3120 616e 6420 6c3d 3d31  if k==1 and l==1
-0001b840: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001b850: 2020 2020 2020 4d33 2e6d 3232 203d 2076        M3.m22 = v
-0001b860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b870: 2069 6620 6b3d 3d31 2061 6e64 206c 3d3d   if k==1 and l==
-0001b880: 323a 0a20 2020 2020 2020 2020 2020 2020  2:.             
-0001b890: 2020 2020 2020 204d 332e 6d32 3320 3d20         M3.m23 = 
-0001b8a0: 760a 2020 2020 2020 2020 2020 2020 2020  v.              
-0001b8b0: 2020 6966 206b 3d3d 3220 616e 6420 6c3d    if k==2 and l=
-0001b8c0: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
-0001b8d0: 2020 2020 2020 2020 4d33 2e6d 3331 203d          M3.m31 =
-0001b8e0: 2076 0a20 2020 2020 2020 2020 2020 2020   v.             
-0001b8f0: 2020 2069 6620 6b3d 3d32 2061 6e64 206c     if k==2 and l
-0001b900: 3d3d 313a 0a20 2020 2020 2020 2020 2020  ==1:.           
-0001b910: 2020 2020 2020 2020 204d 332e 6d33 3220           M3.m32 
-0001b920: 3d20 760a 2020 2020 2020 2020 2020 2020  = v.            
-0001b930: 2020 2020 6966 206b 3d3d 3220 616e 6420      if k==2 and 
-0001b940: 6c3d 3d32 3a0a 2020 2020 2020 2020 2020  l==2:.          
-0001b950: 2020 2020 2020 2020 2020 4d33 2e6d 3333            M3.m33
-0001b960: 203d 2076 0a0a 2020 2020 2020 2020 2020   = v..          
-0001b970: 2020 2020 2020 6c3d 6c2b 310a 2020 2020        l=l+1.    
-0001b980: 2020 2020 2020 2020 6b3d 6b2b 310a 2020          k=k+1.  
-0001b990: 2020 2020 2020 7265 7475 726e 204d 330a        return M3.
-0001b9a0: 0a20 2020 2064 6566 2069 6e76 6572 7365  .    def inverse
-0001b9b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001b9c0: 2222 2252 6574 7572 6e20 696e 7665 7273  """Return invers
-0001b9d0: 6520 6d61 7472 6978 2e0a 0a20 2020 2020  e matrix...     
-0001b9e0: 2020 203e 3e3e 204d 3d6d 6174 3428 302c     >>> M=mat4(0,
-0001b9f0: 2d32 2e30 2c30 2c30 2c20 322e 302c 302c  -2.0,0,0, 2.0,0,
-0001ba00: 302c 302c 2030 2c30 2c32 2c30 2c20 302c  0,0, 0,0,2,0, 0,
-0001ba10: 302c 302c 3229 0a20 2020 2020 2020 203e  0,0,2).        >
-0001ba20: 3e3e 2070 7269 6e74 204d 2e69 6e76 6572  >> print M.inver
-0001ba30: 7365 2829 0a20 2020 2020 2020 205b 2020  se().        [  
-0001ba40: 2030 2e30 3030 302c 2020 2020 302e 3530   0.0000,    0.50
-0001ba50: 3030 2c20 2020 2030 2e30 3030 302c 2020  00,    0.0000,  
-0001ba60: 2020 302e 3030 3030 5d0a 2020 2020 2020    0.0000].      
-0001ba70: 2020 5b20 202d 302e 3530 3030 2c20 2020    [  -0.5000,   
-0001ba80: 2030 2e30 3030 302c 2020 2020 302e 3030   0.0000,    0.00
-0001ba90: 3030 2c20 2020 2030 2e30 3030 305d 0a20  00,    0.0000]. 
-0001baa0: 2020 2020 2020 205b 2020 2030 2e30 3030         [   0.000
-0001bab0: 302c 2020 2020 302e 3030 3030 2c20 2020  0,    0.0000,   
-0001bac0: 2030 2e35 3030 302c 2020 2020 302e 3030   0.5000,    0.00
-0001bad0: 3030 5d0a 2020 2020 2020 2020 5b20 2020  00].        [   
-0001bae0: 302e 3030 3030 2c20 2020 2030 2e30 3030  0.0000,    0.000
-0001baf0: 302c 2020 2020 302e 3030 3030 2c20 2020  0,    0.0000,   
-0001bb00: 2030 2e35 3030 305d 0a20 2020 2020 2020   0.5000].       
-0001bb10: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
-0001bb20: 6620 6d61 7434 2072 6573 0a20 2020 2020  f mat4 res.     
-0001bb30: 2020 2063 6465 6620 7368 6f72 7420 692c     cdef short i,
-0001bb40: 6a2c 2073 6967 6e0a 2020 2020 2020 2020  j, sign.        
-0001bb50: 6364 6566 2064 6f75 626c 6520 6d34 5b31  cdef double m4[1
-0001bb60: 365d 0a20 2020 2020 2020 2063 6465 6620  6].        cdef 
-0001bb70: 646f 7562 6c65 206d 345f 7265 735b 3136  double m4_res[16
-0001bb80: 5d0a 2020 2020 2020 2020 6364 6566 2064  ].        cdef d
-0001bb90: 6f75 626c 6520 6465 742c 2064 0a0a 2020  ouble det, d..  
-0001bba0: 2020 2020 2020 6d34 5b30 5d20 3d20 7365        m4[0] = se
-0001bbb0: 6c66 2e6d 3131 0a20 2020 2020 2020 206d  lf.m11.        m
-0001bbc0: 345b 315d 203d 2073 656c 662e 6d31 320a  4[1] = self.m12.
-0001bbd0: 2020 2020 2020 2020 6d34 5b32 5d20 3d20          m4[2] = 
-0001bbe0: 7365 6c66 2e6d 3133 0a20 2020 2020 2020  self.m13.       
-0001bbf0: 206d 345b 335d 203d 2073 656c 662e 6d31   m4[3] = self.m1
-0001bc00: 340a 2020 2020 2020 2020 6d34 5b34 5d20  4.        m4[4] 
-0001bc10: 3d20 7365 6c66 2e6d 3231 0a20 2020 2020  = self.m21.     
-0001bc20: 2020 206d 345b 355d 203d 2073 656c 662e     m4[5] = self.
-0001bc30: 6d32 320a 2020 2020 2020 2020 6d34 5b36  m22.        m4[6
-0001bc40: 5d20 3d20 7365 6c66 2e6d 3233 0a20 2020  ] = self.m23.   
-0001bc50: 2020 2020 206d 345b 375d 203d 2073 656c       m4[7] = sel
-0001bc60: 662e 6d32 340a 2020 2020 2020 2020 6d34  f.m24.        m4
-0001bc70: 5b38 5d20 3d20 7365 6c66 2e6d 3331 0a20  [8] = self.m31. 
-0001bc80: 2020 2020 2020 206d 345b 395d 203d 2073         m4[9] = s
-0001bc90: 656c 662e 6d33 320a 2020 2020 2020 2020  elf.m32.        
-0001bca0: 6d34 5b31 305d 203d 2073 656c 662e 6d33  m4[10] = self.m3
-0001bcb0: 330a 2020 2020 2020 2020 6d34 5b31 315d  3.        m4[11]
-0001bcc0: 203d 2073 656c 662e 6d33 340a 2020 2020   = self.m34.    
-0001bcd0: 2020 2020 6d34 5b31 325d 203d 2073 656c      m4[12] = sel
-0001bce0: 662e 6d34 310a 2020 2020 2020 2020 6d34  f.m41.        m4
-0001bcf0: 5b31 335d 203d 2073 656c 662e 6d34 320a  [13] = self.m42.
-0001bd00: 2020 2020 2020 2020 6d34 5b31 345d 203d          m4[14] =
-0001bd10: 2073 656c 662e 6d34 330a 2020 2020 2020   self.m43.      
-0001bd20: 2020 6d34 5b31 355d 203d 2073 656c 662e    m4[15] = self.
-0001bd30: 6d34 340a 0a20 2020 2020 2020 2064 6574  m44..        det
-0001bd40: 3d73 656c 662e 6465 7465 726d 696e 616e  =self.determinan
-0001bd50: 7428 290a 2020 2020 2020 2020 6966 2066  t().        if f
-0001bd60: 6162 7328 6465 7429 3c3d 6570 733a 0a20  abs(det)<=eps:. 
-0001bd70: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001bd80: 205a 6572 6f44 6976 6973 696f 6e45 7272   ZeroDivisionErr
-0001bd90: 6f72 2c22 6d61 7472 6978 206e 6f74 2069  or,"matrix not i
-0001bda0: 6e76 6572 7469 626c 6522 0a0a 2020 2020  nvertible"..    
-0001bdb0: 2020 2020 693d 300a 2020 2020 2020 2020      i=0.        
-0001bdc0: 7768 696c 6520 693c 343a 0a20 2020 2020  while i<4:.     
-0001bdd0: 2020 2020 2020 206a 3d30 0a20 2020 2020         j=0.     
-0001bde0: 2020 2020 2020 2077 6869 6c65 206a 3c34         while j<4
-0001bdf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001be00: 2020 7369 676e 3d31 2d28 2869 2b6a 2925    sign=1-((i+j)%
-0001be10: 3229 2a32 0a20 2020 2020 2020 2020 2020  2)*2.           
-0001be20: 2020 2020 2064 203d 205f 7375 6264 6574       d = _subdet
-0001be30: 286d 342c 692c 6a29 0a20 2020 2020 2020  (m4,i,j).       
-0001be40: 2020 2020 2020 2020 206d 345f 7265 735b           m4_res[
-0001be50: 6a2a 342b 695d 3d73 6967 6e2a 642f 6465  j*4+i]=sign*d/de
-0001be60: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-0001be70: 2020 6a3d 6a2b 310a 2020 2020 2020 2020    j=j+1.        
-0001be80: 2020 2020 693d 692b 310a 0a20 2020 2020      i=i+1..     
-0001be90: 2020 2072 6573 203d 206d 6174 3428 290a     res = mat4().
-0001bea0: 2020 2020 2020 2020 7265 732e 6d31 3120          res.m11 
-0001beb0: 3d20 6d34 5f72 6573 5b30 5d0a 2020 2020  = m4_res[0].    
-0001bec0: 2020 2020 7265 732e 6d31 3220 3d20 6d34      res.m12 = m4
-0001bed0: 5f72 6573 5b31 5d0a 2020 2020 2020 2020  _res[1].        
-0001bee0: 7265 732e 6d31 3320 3d20 6d34 5f72 6573  res.m13 = m4_res
-0001bef0: 5b32 5d0a 2020 2020 2020 2020 7265 732e  [2].        res.
-0001bf00: 6d31 3420 3d20 6d34 5f72 6573 5b33 5d0a  m14 = m4_res[3].
-0001bf10: 2020 2020 2020 2020 7265 732e 6d32 3120          res.m21 
-0001bf20: 3d20 6d34 5f72 6573 5b34 5d0a 2020 2020  = m4_res[4].    
-0001bf30: 2020 2020 7265 732e 6d32 3220 3d20 6d34      res.m22 = m4
-0001bf40: 5f72 6573 5b35 5d0a 2020 2020 2020 2020  _res[5].        
-0001bf50: 7265 732e 6d32 3320 3d20 6d34 5f72 6573  res.m23 = m4_res
-0001bf60: 5b36 5d0a 2020 2020 2020 2020 7265 732e  [6].        res.
-0001bf70: 6d32 3420 3d20 6d34 5f72 6573 5b37 5d0a  m24 = m4_res[7].
-0001bf80: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
-0001bf90: 3d20 6d34 5f72 6573 5b38 5d0a 2020 2020  = m4_res[8].    
-0001bfa0: 2020 2020 7265 732e 6d33 3220 3d20 6d34      res.m32 = m4
-0001bfb0: 5f72 6573 5b39 5d0a 2020 2020 2020 2020  _res[9].        
-0001bfc0: 7265 732e 6d33 3320 3d20 6d34 5f72 6573  res.m33 = m4_res
-0001bfd0: 5b31 305d 0a20 2020 2020 2020 2072 6573  [10].        res
-0001bfe0: 2e6d 3334 203d 206d 345f 7265 735b 3131  .m34 = m4_res[11
-0001bff0: 5d0a 2020 2020 2020 2020 7265 732e 6d34  ].        res.m4
-0001c000: 3120 3d20 6d34 5f72 6573 5b31 325d 0a20  1 = m4_res[12]. 
-0001c010: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
-0001c020: 206d 345f 7265 735b 3133 5d0a 2020 2020   m4_res[13].    
-0001c030: 2020 2020 7265 732e 6d34 3320 3d20 6d34      res.m43 = m4
-0001c040: 5f72 6573 5b31 345d 0a20 2020 2020 2020  _res[14].       
-0001c050: 2072 6573 2e6d 3434 203d 206d 345f 7265   res.m44 = m4_re
-0001c060: 735b 3135 5d0a 2020 2020 2020 2020 7265  s[15].        re
-0001c070: 7475 726e 2072 6573 0a0a 0a20 2020 2064  turn res...    d
-0001c080: 6566 2074 7261 6e73 6c61 7469 6f6e 2873  ef translation(s
-0001c090: 656c 662c 2074 293a 0a20 2020 2020 2020  elf, t):.       
-0001c0a0: 2022 2222 5265 7475 726e 2074 7261 6e73   """Return trans
-0001c0b0: 6c61 7469 6f6e 206d 6174 7269 782e 0a0a  lation matrix...
-0001c0c0: 2020 2020 2020 2020 7420 6d75 7374 2062          t must b
-0001c0d0: 6520 6120 332d 7365 7175 656e 6365 2028  e a 3-sequence (
-0001c0e0: 652e 672e 2061 2076 6563 3329 2e0a 2020  e.g. a vec3)..  
-0001c0f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001c100: 2020 6364 6566 206d 6174 3420 7265 730a    cdef mat4 res.
-0001c110: 2020 2020 2020 2020 7265 7320 3d20 6d61          res = ma
-0001c120: 7434 2829 0a20 2020 2020 2020 2072 6573  t4().        res
-0001c130: 2e6d 3131 203d 2031 2e30 0a20 2020 2020  .m11 = 1.0.     
-0001c140: 2020 2072 6573 2e6d 3132 203d 2030 2e30     res.m12 = 0.0
-0001c150: 0a20 2020 2020 2020 2072 6573 2e6d 3133  .        res.m13
-0001c160: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001c170: 6573 2e6d 3134 203d 2074 5b30 5d0a 2020  es.m14 = t[0].  
-0001c180: 2020 2020 2020 7265 732e 6d32 3120 3d20        res.m21 = 
-0001c190: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
-0001c1a0: 6d32 3220 3d20 312e 300a 2020 2020 2020  m22 = 1.0.      
-0001c1b0: 2020 7265 732e 6d32 3320 3d20 302e 300a    res.m23 = 0.0.
-0001c1c0: 2020 2020 2020 2020 7265 732e 6d32 3420          res.m24 
-0001c1d0: 3d20 745b 315d 0a20 2020 2020 2020 2072  = t[1].        r
-0001c1e0: 6573 2e6d 3331 203d 2030 2e30 0a20 2020  es.m31 = 0.0.   
-0001c1f0: 2020 2020 2072 6573 2e6d 3332 203d 2030       res.m32 = 0
-0001c200: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
-0001c210: 3333 203d 2031 2e30 0a20 2020 2020 2020  33 = 1.0.       
-0001c220: 2072 6573 2e6d 3334 203d 2074 5b32 5d0a   res.m34 = t[2].
-0001c230: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
-0001c240: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
-0001c250: 732e 6d34 3220 3d20 302e 300a 2020 2020  s.m42 = 0.0.    
-0001c260: 2020 2020 7265 732e 6d34 3320 3d20 302e      res.m43 = 0.
-0001c270: 300a 2020 2020 2020 2020 7265 732e 6d34  0.        res.m4
-0001c280: 3420 3d20 312e 300a 2020 2020 2020 2020  4 = 1.0.        
-0001c290: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
-0001c2a0: 6465 6620 7363 616c 696e 6728 7365 6c66  def scaling(self
-0001c2b0: 2c20 7329 3a0a 2020 2020 2020 2020 2222  , s):.        ""
-0001c2c0: 2252 6574 7572 6e20 7363 616c 696e 6720  "Return scaling 
-0001c2d0: 6d61 7472 6978 2e0a 0a20 2020 2020 2020  matrix...       
-0001c2e0: 2073 206d 7573 7420 6265 2061 2033 2d73   s must be a 3-s
-0001c2f0: 6571 7565 6e63 6520 2865 2e67 2e20 6120  equence (e.g. a 
-0001c300: 7665 6333 292e 0a20 2020 2020 2020 2022  vec3)..        "
-0001c310: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-0001c320: 6d61 7434 2072 6573 0a20 2020 2020 2020  mat4 res.       
-0001c330: 2072 6573 203d 206d 6174 3428 290a 2020   res = mat4().  
-0001c340: 2020 2020 2020 7265 732e 6d31 3120 3d20        res.m11 = 
-0001c350: 735b 305d 0a20 2020 2020 2020 2072 6573  s[0].        res
-0001c360: 2e6d 3132 203d 2030 2e30 0a20 2020 2020  .m12 = 0.0.     
-0001c370: 2020 2072 6573 2e6d 3133 203d 2030 2e30     res.m13 = 0.0
-0001c380: 0a20 2020 2020 2020 2072 6573 2e6d 3134  .        res.m14
-0001c390: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001c3a0: 6573 2e6d 3231 203d 2030 2e30 0a20 2020  es.m21 = 0.0.   
-0001c3b0: 2020 2020 2072 6573 2e6d 3232 203d 2073       res.m22 = s
-0001c3c0: 5b31 5d0a 2020 2020 2020 2020 7265 732e  [1].        res.
-0001c3d0: 6d32 3320 3d20 302e 300a 2020 2020 2020  m23 = 0.0.      
-0001c3e0: 2020 7265 732e 6d32 3420 3d20 302e 300a    res.m24 = 0.0.
-0001c3f0: 2020 2020 2020 2020 7265 732e 6d33 3120          res.m31 
-0001c400: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
-0001c410: 732e 6d33 3220 3d20 302e 300a 2020 2020  s.m32 = 0.0.    
-0001c420: 2020 2020 7265 732e 6d33 3320 3d20 735b      res.m33 = s[
-0001c430: 325d 0a20 2020 2020 2020 2072 6573 2e6d  2].        res.m
-0001c440: 3334 203d 2030 2e30 0a20 2020 2020 2020  34 = 0.0.       
-0001c450: 2072 6573 2e6d 3431 203d 2030 2e30 0a20   res.m41 = 0.0. 
-0001c460: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
-0001c470: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
-0001c480: 2e6d 3433 203d 2030 2e30 0a20 2020 2020  .m43 = 0.0.     
-0001c490: 2020 2072 6573 2e6d 3434 203d 2031 2e30     res.m44 = 1.0
-0001c4a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001c4b0: 7265 730a 0a20 2020 2064 6566 2072 6f74  res..    def rot
-0001c4c0: 6174 696f 6e28 7365 6c66 2c20 616e 676c  ation(self, angl
-0001c4d0: 652c 2061 7869 7329 3a0a 2020 2020 2020  e, axis):.      
-0001c4e0: 2020 2222 2252 6574 7572 6e20 726f 7461    """Return rota
-0001c4f0: 7469 6f6e 206d 6174 7269 782e 0a0a 2020  tion matrix...  
-0001c500: 2020 2020 2020 616e 676c 6520 6d75 7374        angle must
-0001c510: 2062 6520 6769 7665 6e20 696e 2072 6164   be given in rad
-0001c520: 6961 6e73 2e20 6178 6973 206d 7573 7420  ians. axis must 
-0001c530: 6265 2061 2033 2d73 6571 7565 6e63 652e  be a 3-sequence.
-0001c540: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001c550: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
-0001c560: 2063 616e 676c 652c 2061 782c 2061 792c   cangle, ax, ay,
-0001c570: 2061 7a0a 2020 2020 2020 2020 6364 6566   az.        cdef
-0001c580: 2064 6f75 626c 6520 7371 725f 612c 2073   double sqr_a, s
-0001c590: 7172 5f62 2c20 7371 725f 632c 206c 656e  qr_b, sqr_c, len
-0001c5a0: 320a 2020 2020 2020 2020 6364 6566 2064  2.        cdef d
-0001c5b0: 6f75 626c 6520 6b31 2c20 6b32 2c20 6b33  ouble k1, k2, k3
-0001c5c0: 2c20 6b31 6162 2c20 6b31 6163 2c20 6b31  , k1ab, k1ac, k1
-0001c5d0: 6263 2c20 6b33 612c 206b 3362 2c20 6b33  bc, k3a, k3b, k3
-0001c5e0: 630a 2020 2020 2020 2020 6364 6566 206d  c.        cdef m
-0001c5f0: 6174 3420 7265 730a 0a20 2020 2020 2020  at4 res..       
-0001c600: 2063 616e 676c 6520 2020 3d20 616e 676c   cangle   = angl
-0001c610: 650a 2020 2020 2020 2020 6178 2020 2020  e.        ax    
-0001c620: 3d20 6178 6973 5b30 5d0a 2020 2020 2020  = axis[0].      
-0001c630: 2020 6179 2020 2020 3d20 6178 6973 5b31    ay    = axis[1
-0001c640: 5d0a 2020 2020 2020 2020 617a 2020 2020  ].        az    
-0001c650: 3d20 6178 6973 5b32 5d0a 2020 2020 2020  = axis[2].      
-0001c660: 2020 7371 725f 6120 3d20 6178 2a61 780a    sqr_a = ax*ax.
-0001c670: 2020 2020 2020 2020 7371 725f 6220 3d20          sqr_b = 
-0001c680: 6179 2a61 790a 2020 2020 2020 2020 7371  ay*ay.        sq
-0001c690: 725f 6320 3d20 617a 2a61 7a0a 2020 2020  r_c = az*az.    
-0001c6a0: 2020 2020 6c65 6e32 2020 3d20 7371 725f      len2  = sqr_
-0001c6b0: 612b 7371 725f 622b 7371 725f 630a 0a20  a+sqr_b+sqr_c.. 
-0001c6c0: 2020 2020 2020 206b 3220 2020 203d 2063         k2    = c
-0001c6d0: 6f73 2863 616e 676c 6529 0a20 2020 2020  os(cangle).     
-0001c6e0: 2020 206b 3120 2020 203d 2028 312e 302d     k1    = (1.0-
-0001c6f0: 6b32 292f 6c65 6e32 0a20 2020 2020 2020  k2)/len2.       
-0001c700: 206b 3320 2020 203d 2073 696e 2863 616e   k3    = sin(can
-0001c710: 676c 6529 2f73 7172 7428 6c65 6e32 290a  gle)/sqrt(len2).
-0001c720: 2020 2020 2020 2020 6b31 6162 2020 3d20          k1ab  = 
-0001c730: 6b31 2a61 782a 6179 0a20 2020 2020 2020  k1*ax*ay.       
-0001c740: 206b 3161 6320 203d 206b 312a 6178 2a61   k1ac  = k1*ax*a
-0001c750: 7a0a 2020 2020 2020 2020 6b31 6263 2020  z.        k1bc  
-0001c760: 3d20 6b31 2a61 792a 617a 0a20 2020 2020  = k1*ay*az.     
-0001c770: 2020 206b 3361 2020 203d 206b 332a 6178     k3a   = k3*ax
-0001c780: 0a20 2020 2020 2020 206b 3362 2020 203d  .        k3b   =
-0001c790: 206b 332a 6179 0a20 2020 2020 2020 206b   k3*ay.        k
-0001c7a0: 3363 2020 203d 206b 332a 617a 0a0a 2020  3c   = k3*az..  
-0001c7b0: 2020 2020 2020 7265 7320 3d20 6d61 7434        res = mat4
-0001c7c0: 2829 0a20 2020 2020 2020 2072 6573 2e6d  ().        res.m
-0001c7d0: 3131 203d 206b 312a 7371 725f 612b 6b32  11 = k1*sqr_a+k2
-0001c7e0: 0a20 2020 2020 2020 2072 6573 2e6d 3132  .        res.m12
-0001c7f0: 203d 206b 3161 622d 6b33 630a 2020 2020   = k1ab-k3c.    
-0001c800: 2020 2020 7265 732e 6d31 3320 3d20 6b31      res.m13 = k1
-0001c810: 6163 2b6b 3362 0a20 2020 2020 2020 2072  ac+k3b.        r
-0001c820: 6573 2e6d 3134 203d 2030 2e30 0a20 2020  es.m14 = 0.0.   
-0001c830: 2020 2020 2072 6573 2e6d 3231 203d 206b       res.m21 = k
-0001c840: 3161 622b 6b33 630a 2020 2020 2020 2020  1ab+k3c.        
-0001c850: 7265 732e 6d32 3220 3d20 6b31 2a73 7172  res.m22 = k1*sqr
-0001c860: 5f62 2b6b 320a 2020 2020 2020 2020 7265  _b+k2.        re
-0001c870: 732e 6d32 3320 3d20 6b31 6263 2d6b 3361  s.m23 = k1bc-k3a
-0001c880: 0a20 2020 2020 2020 2072 6573 2e6d 3234  .        res.m24
-0001c890: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001c8a0: 6573 2e6d 3331 203d 206b 3161 632d 6b33  es.m31 = k1ac-k3
-0001c8b0: 620a 2020 2020 2020 2020 7265 732e 6d33  b.        res.m3
-0001c8c0: 3220 3d20 6b31 6263 2b6b 3361 0a20 2020  2 = k1bc+k3a.   
-0001c8d0: 2020 2020 2072 6573 2e6d 3333 203d 206b       res.m33 = k
-0001c8e0: 312a 7371 725f 632b 6b32 0a20 2020 2020  1*sqr_c+k2.     
-0001c8f0: 2020 2072 6573 2e6d 3334 203d 2030 2e30     res.m34 = 0.0
-0001c900: 0a20 2020 2020 2020 2072 6573 2e6d 3431  .        res.m41
-0001c910: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001c920: 6573 2e6d 3432 203d 2030 2e30 0a20 2020  es.m42 = 0.0.   
-0001c930: 2020 2020 2072 6573 2e6d 3433 203d 2030       res.m43 = 0
-0001c940: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
-0001c950: 3434 203d 2031 2e30 0a20 2020 2020 2020  44 = 1.0.       
-0001c960: 2072 6574 7572 6e20 7265 730a 0a0a 2020   return res...  
-0001c970: 2020 6465 6620 7472 616e 736c 6174 6528    def translate(
-0001c980: 7365 6c66 2c20 7429 3a0a 2020 2020 2020  self, t):.      
-0001c990: 2020 2222 2243 6f6e 6361 7465 6e61 7465    """Concatenate
-0001c9a0: 2061 2074 7261 6e73 6c61 7469 6f6e 2e0a   a translation..
-0001c9b0: 0a20 2020 2020 2020 2074 206d 7573 7420  .        t must 
-0001c9c0: 6265 2061 2033 2d73 6571 7565 6e63 6520  be a 3-sequence 
-0001c9d0: 2865 2e67 2e20 6120 7665 6333 292e 0a20  (e.g. a vec3).. 
-0001c9e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001c9f0: 2020 2063 6465 6620 646f 7562 6c65 2074     cdef double t
-0001ca00: 782c 2074 792c 2074 7a0a 2020 2020 2020  x, ty, tz.      
-0001ca10: 2020 7478 203d 2074 5b30 5d0a 2020 2020    tx = t[0].    
-0001ca20: 2020 2020 7479 203d 2074 5b31 5d0a 2020      ty = t[1].  
-0001ca30: 2020 2020 2020 747a 203d 2074 5b32 5d0a        tz = t[2].
-0001ca40: 0a20 2020 2020 2020 2073 656c 662e 6d31  .        self.m1
-0001ca50: 3420 3d20 7365 6c66 2e6d 3131 2a74 7820  4 = self.m11*tx 
-0001ca60: 2b20 7365 6c66 2e6d 3132 2a74 7920 2b20  + self.m12*ty + 
-0001ca70: 7365 6c66 2e6d 3133 2a74 7a20 2b20 7365  self.m13*tz + se
-0001ca80: 6c66 2e6d 3134 0a20 2020 2020 2020 2073  lf.m14.        s
-0001ca90: 656c 662e 6d32 3420 3d20 7365 6c66 2e6d  elf.m24 = self.m
-0001caa0: 3231 2a74 7820 2b20 7365 6c66 2e6d 3232  21*tx + self.m22
-0001cab0: 2a74 7920 2b20 7365 6c66 2e6d 3233 2a74  *ty + self.m23*t
-0001cac0: 7a20 2b20 7365 6c66 2e6d 3234 0a20 2020  z + self.m24.   
-0001cad0: 2020 2020 2073 656c 662e 6d33 3420 3d20       self.m34 = 
-0001cae0: 7365 6c66 2e6d 3331 2a74 7820 2b20 7365  self.m31*tx + se
-0001caf0: 6c66 2e6d 3332 2a74 7920 2b20 7365 6c66  lf.m32*ty + self
-0001cb00: 2e6d 3333 2a74 7a20 2b20 7365 6c66 2e6d  .m33*tz + self.m
-0001cb10: 3334 0a20 2020 2020 2020 2073 656c 662e  34.        self.
-0001cb20: 6d34 3420 3d20 7365 6c66 2e6d 3431 2a74  m44 = self.m41*t
-0001cb30: 7820 2b20 7365 6c66 2e6d 3432 2a74 7920  x + self.m42*ty 
-0001cb40: 2b20 7365 6c66 2e6d 3433 2a74 7a20 2b20  + self.m43*tz + 
-0001cb50: 7365 6c66 2e6d 3434 0a20 2020 2020 2020  self.m44.       
-0001cb60: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-0001cb70: 2020 6465 6620 7363 616c 6528 7365 6c66    def scale(self
-0001cb80: 2c20 7329 3a0a 2020 2020 2020 2020 2222  , s):.        ""
-0001cb90: 2243 6f6e 6361 7465 6e61 7465 2061 2073  "Concatenate a s
-0001cba0: 6361 6c69 6e67 2e0a 0a20 2020 2020 2020  caling...       
-0001cbb0: 2073 206d 7573 7420 6265 2061 2033 2d73   s must be a 3-s
-0001cbc0: 6571 7565 6e63 6520 2865 2e67 2e20 6120  equence (e.g. a 
-0001cbd0: 7665 6333 292e 0a20 2020 2020 2020 2022  vec3)..        "
-0001cbe0: 2222 0a20 2020 2020 2020 2063 6465 6620  "".        cdef 
-0001cbf0: 646f 7562 6c65 2073 782c 2073 792c 2073  double sx, sy, s
-0001cc00: 7a0a 2020 2020 2020 2020 7378 203d 2073  z.        sx = s
-0001cc10: 5b30 5d0a 2020 2020 2020 2020 7379 203d  [0].        sy =
-0001cc20: 2073 5b31 5d0a 2020 2020 2020 2020 737a   s[1].        sz
-0001cc30: 203d 2073 5b32 5d0a 2020 2020 2020 2020   = s[2].        
-0001cc40: 7365 6c66 2e6d 3131 203d 2073 656c 662e  self.m11 = self.
-0001cc50: 6d31 312a 7378 0a20 2020 2020 2020 2073  m11*sx.        s
-0001cc60: 656c 662e 6d31 3220 3d20 7365 6c66 2e6d  elf.m12 = self.m
-0001cc70: 3132 2a73 790a 2020 2020 2020 2020 7365  12*sy.        se
-0001cc80: 6c66 2e6d 3133 203d 2073 656c 662e 6d31  lf.m13 = self.m1
-0001cc90: 332a 737a 0a20 2020 2020 2020 2073 656c  3*sz.        sel
-0001cca0: 662e 6d32 3120 3d20 7365 6c66 2e6d 3231  f.m21 = self.m21
-0001ccb0: 2a73 780a 2020 2020 2020 2020 7365 6c66  *sx.        self
-0001ccc0: 2e6d 3232 203d 2073 656c 662e 6d32 322a  .m22 = self.m22*
-0001ccd0: 7379 0a20 2020 2020 2020 2073 656c 662e  sy.        self.
-0001cce0: 6d32 3320 3d20 7365 6c66 2e6d 3233 2a73  m23 = self.m23*s
-0001ccf0: 7a0a 2020 2020 2020 2020 7365 6c66 2e6d  z.        self.m
-0001cd00: 3331 203d 2073 656c 662e 6d33 312a 7378  31 = self.m31*sx
-0001cd10: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
-0001cd20: 3220 3d20 7365 6c66 2e6d 3332 2a73 790a  2 = self.m32*sy.
-0001cd30: 2020 2020 2020 2020 7365 6c66 2e6d 3333          self.m33
-0001cd40: 203d 2073 656c 662e 6d33 332a 737a 0a20   = self.m33*sz. 
-0001cd50: 2020 2020 2020 2073 656c 662e 6d34 3120         self.m41 
-0001cd60: 3d20 7365 6c66 2e6d 3431 2a73 780a 2020  = self.m41*sx.  
-0001cd70: 2020 2020 2020 7365 6c66 2e6d 3432 203d        self.m42 =
-0001cd80: 2073 656c 662e 6d34 322a 7379 0a20 2020   self.m42*sy.   
-0001cd90: 2020 2020 2073 656c 662e 6d34 3320 3d20       self.m43 = 
-0001cda0: 7365 6c66 2e6d 3433 2a73 7a0a 2020 2020  self.m43*sz.    
-0001cdb0: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
-0001cdc0: 0a20 2020 2064 6566 2072 6f74 6174 6528  .    def rotate(
-0001cdd0: 7365 6c66 2c20 616e 676c 652c 2061 7869  self, angle, axi
-0001cde0: 7329 3a0a 2020 2020 2020 2020 2222 2243  s):.        """C
-0001cdf0: 6f6e 6361 7465 6e61 7465 2061 2072 6f74  oncatenate a rot
-0001ce00: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-0001ce10: 616e 676c 6520 6d75 7374 2062 6520 6769  angle must be gi
-0001ce20: 7665 6e20 696e 2072 6164 6961 6e73 2e20  ven in radians. 
-0001ce30: 6178 6973 206d 7573 7420 6265 2061 2033  axis must be a 3
-0001ce40: 2d73 6571 7565 6e63 652e 0a20 2020 2020  -sequence..     
-0001ce50: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-0001ce60: 6465 6620 6d61 7434 2052 0a20 2020 2020  def mat4 R.     
-0001ce70: 2020 2063 6465 6620 646f 7562 6c65 2063     cdef double c
-0001ce80: 312c 2063 322c 2063 332c 2063 340a 2020  1, c2, c3, c4.  
-0001ce90: 2020 2020 2020 523d 7365 6c66 2e72 6f74        R=self.rot
-0001cea0: 6174 696f 6e28 616e 676c 652c 2061 7869  ation(angle, axi
-0001ceb0: 7329 0a0a 2020 2020 2020 2020 2320 7365  s)..        # se
-0001cec0: 6c66 2a52 2020 2869 6e2d 706c 6163 6529  lf*R  (in-place)
-0001ced0: 0a20 2020 2020 2020 2063 3120 3d20 7365  .        c1 = se
-0001cee0: 6c66 2e6d 3131 0a20 2020 2020 2020 2063  lf.m11.        c
-0001cef0: 3220 3d20 7365 6c66 2e6d 3132 0a20 2020  2 = self.m12.   
-0001cf00: 2020 2020 2063 3320 3d20 7365 6c66 2e6d       c3 = self.m
-0001cf10: 3133 0a20 2020 2020 2020 2063 3420 3d20  13.        c4 = 
-0001cf20: 7365 6c66 2e6d 3134 0a20 2020 2020 2020  self.m14.       
-0001cf30: 2073 656c 662e 6d31 3120 3d20 6331 2a52   self.m11 = c1*R
-0001cf40: 2e6d 3131 2b63 322a 522e 6d32 312b 6333  .m11+c2*R.m21+c3
-0001cf50: 2a52 2e6d 3331 2b63 342a 522e 6d34 310a  *R.m31+c4*R.m41.
-0001cf60: 2020 2020 2020 2020 7365 6c66 2e6d 3132          self.m12
-0001cf70: 203d 2063 312a 522e 6d31 322b 6332 2a52   = c1*R.m12+c2*R
-0001cf80: 2e6d 3232 2b63 332a 522e 6d33 322b 6334  .m22+c3*R.m32+c4
-0001cf90: 2a52 2e6d 3432 0a20 2020 2020 2020 2073  *R.m42.        s
-0001cfa0: 656c 662e 6d31 3320 3d20 6331 2a52 2e6d  elf.m13 = c1*R.m
-0001cfb0: 3133 2b63 322a 522e 6d32 332b 6333 2a52  13+c2*R.m23+c3*R
-0001cfc0: 2e6d 3333 2b63 342a 522e 6d34 330a 2020  .m33+c4*R.m43.  
-0001cfd0: 2020 2020 2020 7365 6c66 2e6d 3134 203d        self.m14 =
-0001cfe0: 2063 312a 522e 6d31 342b 6332 2a52 2e6d   c1*R.m14+c2*R.m
-0001cff0: 3234 2b63 332a 522e 6d33 342b 6334 2a52  24+c3*R.m34+c4*R
-0001d000: 2e6d 3434 0a0a 2020 2020 2020 2020 6331  .m44..        c1
-0001d010: 203d 2073 656c 662e 6d32 310a 2020 2020   = self.m21.    
-0001d020: 2020 2020 6332 203d 2073 656c 662e 6d32      c2 = self.m2
-0001d030: 320a 2020 2020 2020 2020 6333 203d 2073  2.        c3 = s
-0001d040: 656c 662e 6d32 330a 2020 2020 2020 2020  elf.m23.        
-0001d050: 6334 203d 2073 656c 662e 6d32 340a 2020  c4 = self.m24.  
-0001d060: 2020 2020 2020 7365 6c66 2e6d 3231 203d        self.m21 =
-0001d070: 2063 312a 522e 6d31 312b 6332 2a52 2e6d   c1*R.m11+c2*R.m
-0001d080: 3231 2b63 332a 522e 6d33 312b 6334 2a52  21+c3*R.m31+c4*R
-0001d090: 2e6d 3431 0a20 2020 2020 2020 2073 656c  .m41.        sel
-0001d0a0: 662e 6d32 3220 3d20 6331 2a52 2e6d 3132  f.m22 = c1*R.m12
-0001d0b0: 2b63 322a 522e 6d32 322b 6333 2a52 2e6d  +c2*R.m22+c3*R.m
-0001d0c0: 3332 2b63 342a 522e 6d34 320a 2020 2020  32+c4*R.m42.    
-0001d0d0: 2020 2020 7365 6c66 2e6d 3233 203d 2063      self.m23 = c
-0001d0e0: 312a 522e 6d31 332b 6332 2a52 2e6d 3233  1*R.m13+c2*R.m23
-0001d0f0: 2b63 332a 522e 6d33 332b 6334 2a52 2e6d  +c3*R.m33+c4*R.m
-0001d100: 3433 0a20 2020 2020 2020 2073 656c 662e  43.        self.
-0001d110: 6d32 3420 3d20 6331 2a52 2e6d 3134 2b63  m24 = c1*R.m14+c
-0001d120: 322a 522e 6d32 342b 6333 2a52 2e6d 3334  2*R.m24+c3*R.m34
-0001d130: 2b63 342a 522e 6d34 340a 0a20 2020 2020  +c4*R.m44..     
-0001d140: 2020 2063 3120 3d20 7365 6c66 2e6d 3331     c1 = self.m31
-0001d150: 0a20 2020 2020 2020 2063 3220 3d20 7365  .        c2 = se
-0001d160: 6c66 2e6d 3332 0a20 2020 2020 2020 2063  lf.m32.        c
-0001d170: 3320 3d20 7365 6c66 2e6d 3333 0a20 2020  3 = self.m33.   
-0001d180: 2020 2020 2063 3420 3d20 7365 6c66 2e6d       c4 = self.m
-0001d190: 3334 0a20 2020 2020 2020 2073 656c 662e  34.        self.
-0001d1a0: 6d33 3120 3d20 6331 2a52 2e6d 3131 2b63  m31 = c1*R.m11+c
-0001d1b0: 322a 522e 6d32 312b 6333 2a52 2e6d 3331  2*R.m21+c3*R.m31
-0001d1c0: 2b63 342a 522e 6d34 310a 2020 2020 2020  +c4*R.m41.      
-0001d1d0: 2020 7365 6c66 2e6d 3332 203d 2063 312a    self.m32 = c1*
-0001d1e0: 522e 6d31 322b 6332 2a52 2e6d 3232 2b63  R.m12+c2*R.m22+c
-0001d1f0: 332a 522e 6d33 322b 6334 2a52 2e6d 3432  3*R.m32+c4*R.m42
-0001d200: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
-0001d210: 3320 3d20 6331 2a52 2e6d 3133 2b63 322a  3 = c1*R.m13+c2*
-0001d220: 522e 6d32 332b 6333 2a52 2e6d 3333 2b63  R.m23+c3*R.m33+c
-0001d230: 342a 522e 6d34 330a 2020 2020 2020 2020  4*R.m43.        
-0001d240: 7365 6c66 2e6d 3334 203d 2063 312a 522e  self.m34 = c1*R.
-0001d250: 6d31 342b 6332 2a52 2e6d 3234 2b63 332a  m14+c2*R.m24+c3*
-0001d260: 522e 6d33 342b 6334 2a52 2e6d 3434 0a0a  R.m34+c4*R.m44..
-0001d270: 2020 2020 2020 2020 6331 203d 2073 656c          c1 = sel
-0001d280: 662e 6d34 310a 2020 2020 2020 2020 6332  f.m41.        c2
-0001d290: 203d 2073 656c 662e 6d34 320a 2020 2020   = self.m42.    
-0001d2a0: 2020 2020 6333 203d 2073 656c 662e 6d34      c3 = self.m4
-0001d2b0: 330a 2020 2020 2020 2020 6334 203d 2073  3.        c4 = s
-0001d2c0: 656c 662e 6d34 340a 2020 2020 2020 2020  elf.m44.        
-0001d2d0: 7365 6c66 2e6d 3431 203d 2063 312a 522e  self.m41 = c1*R.
-0001d2e0: 6d31 312b 6332 2a52 2e6d 3231 2b63 332a  m11+c2*R.m21+c3*
-0001d2f0: 522e 6d33 312b 6334 2a52 2e6d 3431 0a20  R.m31+c4*R.m41. 
-0001d300: 2020 2020 2020 2073 656c 662e 6d34 3220         self.m42 
-0001d310: 3d20 6331 2a52 2e6d 3132 2b63 322a 522e  = c1*R.m12+c2*R.
-0001d320: 6d32 322b 6333 2a52 2e6d 3332 2b63 342a  m22+c3*R.m32+c4*
-0001d330: 522e 6d34 320a 2020 2020 2020 2020 7365  R.m42.        se
-0001d340: 6c66 2e6d 3433 203d 2063 312a 522e 6d31  lf.m43 = c1*R.m1
-0001d350: 332b 6332 2a52 2e6d 3233 2b63 332a 522e  3+c2*R.m23+c3*R.
-0001d360: 6d33 332b 6334 2a52 2e6d 3433 0a20 2020  m33+c4*R.m43.   
-0001d370: 2020 2020 2073 656c 662e 6d34 3420 3d20       self.m44 = 
-0001d380: 6331 2a52 2e6d 3134 2b63 322a 522e 6d32  c1*R.m14+c2*R.m2
-0001d390: 342b 6333 2a52 2e6d 3334 2b63 342a 522e  4+c3*R.m34+c4*R.
-0001d3a0: 6d34 340a 0a20 2020 2020 2020 2072 6574  m44..        ret
-0001d3b0: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
-0001d3c0: 6620 6f72 7468 6f67 7261 7068 6963 2873  f orthographic(s
-0001d3d0: 656c 662c 206c 6566 742c 2072 6967 6874  elf, left, right
-0001d3e0: 2c20 626f 7474 6f6d 2c20 746f 702c 206e  , bottom, top, n
-0001d3f0: 6561 722c 2066 6172 293a 0a20 2020 2020  ear, far):.     
-0001d400: 2020 2022 2222 6571 7569 7661 6c65 6e74     """equivalent
-0001d410: 2074 6f20 7468 6520 4f70 656e 474c 2063   to the OpenGL c
-0001d420: 6f6d 6d61 6e64 2067 6c4f 7274 686f 2829  ommand glOrtho()
-0001d430: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
-0001d440: 206d 6174 3420 7265 730a 2020 2020 2020   mat4 res.      
-0001d450: 2020 6364 6566 2064 6f75 626c 6520 6c2c    cdef double l,
-0001d460: 722c 622c 742c 6e2c 662c 2072 5f6c 2c20  r,b,t,n,f, r_l, 
-0001d470: 745f 622c 2066 5f6e 0a0a 2020 2020 2020  t_b, f_n..      
-0001d480: 2020 6c20 3d20 6c65 6674 0a20 2020 2020    l = left.     
-0001d490: 2020 2072 203d 2072 6967 6874 0a20 2020     r = right.   
-0001d4a0: 2020 2020 2062 203d 2062 6f74 746f 6d0a       b = bottom.
-0001d4b0: 2020 2020 2020 2020 7420 3d20 746f 700a          t = top.
-0001d4c0: 2020 2020 2020 2020 6e20 3d20 6e65 6172          n = near
-0001d4d0: 0a20 2020 2020 2020 2066 203d 2066 6172  .        f = far
-0001d4e0: 0a0a 2020 2020 2020 2020 725f 6c20 3d20  ..        r_l = 
-0001d4f0: 722d 6c0a 2020 2020 2020 2020 745f 6220  r-l.        t_b 
-0001d500: 3d20 742d 620a 2020 2020 2020 2020 665f  = t-b.        f_
-0001d510: 6e20 3d20 662d 6e0a 0a20 2020 2020 2020  n = f-n..       
-0001d520: 2069 6620 725f 6c3c 3d65 7073 3a0a 2020   if r_l<=eps:.  
-0001d530: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001d540: 5661 6c75 6545 7272 6f72 2c20 2272 6967  ValueError, "rig
-0001d550: 6874 2d76 616c 7565 206d 7573 7420 6265  ht-value must be
-0001d560: 2067 7265 6174 6572 2074 6861 6e20 6c65   greater than le
-0001d570: 6674 2d76 616c 7565 220a 2020 2020 2020  ft-value".      
-0001d580: 2020 6966 2074 5f62 3c3d 6570 733a 0a20    if t_b<=eps:. 
-0001d590: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001d5a0: 2056 616c 7565 4572 726f 722c 2022 746f   ValueError, "to
-0001d5b0: 702d 7661 6c75 6520 6d75 7374 2062 6520  p-value must be 
-0001d5c0: 6772 6561 7465 7220 7468 616e 2062 6f74  greater than bot
-0001d5d0: 746f 6d2d 7661 6c75 6522 0a20 2020 2020  tom-value".     
-0001d5e0: 2020 2069 6620 665f 6e3c 3d65 7073 3a0a     if f_n<=eps:.
-0001d5f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001d600: 6520 5661 6c75 6545 7272 6f72 2c20 2266  e ValueError, "f
-0001d610: 6172 2d76 616c 7565 206d 7573 7420 6265  ar-value must be
-0001d620: 2067 7265 6174 6572 2074 6861 6e20 6e65   greater than ne
-0001d630: 6172 2d76 616c 7565 220a 0a20 2020 2020  ar-value"..     
-0001d640: 2020 2072 6573 203d 206d 6174 3428 290a     res = mat4().
-0001d650: 0a20 2020 2020 2020 2072 6573 2e6d 3131  .        res.m11
-0001d660: 203d 2032 2e30 2f72 5f6c 0a20 2020 2020   = 2.0/r_l.     
-0001d670: 2020 2072 6573 2e6d 3132 203d 2030 2e30     res.m12 = 0.0
-0001d680: 0a20 2020 2020 2020 2072 6573 2e6d 3133  .        res.m13
-0001d690: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001d6a0: 6573 2e6d 3134 203d 202d 2872 2b6c 292f  es.m14 = -(r+l)/
-0001d6b0: 725f 6c0a 2020 2020 2020 2020 7265 732e  r_l.        res.
-0001d6c0: 6d32 3120 3d20 302e 300a 2020 2020 2020  m21 = 0.0.      
-0001d6d0: 2020 7265 732e 6d32 3220 3d20 322e 302f    res.m22 = 2.0/
-0001d6e0: 745f 620a 2020 2020 2020 2020 7265 732e  t_b.        res.
-0001d6f0: 6d32 3320 3d20 302e 300a 2020 2020 2020  m23 = 0.0.      
-0001d700: 2020 7265 732e 6d32 3420 3d20 2d28 742b    res.m24 = -(t+
-0001d710: 6229 2f74 5f62 0a20 2020 2020 2020 2072  b)/t_b.        r
-0001d720: 6573 2e6d 3331 203d 2030 2e30 0a20 2020  es.m31 = 0.0.   
-0001d730: 2020 2020 2072 6573 2e6d 3332 203d 2030       res.m32 = 0
-0001d740: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
-0001d750: 3333 203d 202d 322e 302f 665f 6e0a 2020  33 = -2.0/f_n.  
-0001d760: 2020 2020 2020 7265 732e 6d33 3420 3d20        res.m34 = 
-0001d770: 2d28 662b 6e29 2f66 5f6e 0a20 2020 2020  -(f+n)/f_n.     
-0001d780: 2020 2072 6573 2e6d 3431 203d 2030 2e30     res.m41 = 0.0
-0001d790: 0a20 2020 2020 2020 2072 6573 2e6d 3432  .        res.m42
-0001d7a0: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001d7b0: 6573 2e6d 3433 203d 2030 2e30 0a20 2020  es.m43 = 0.0.   
-0001d7c0: 2020 2020 2072 6573 2e6d 3434 203d 2031       res.m44 = 1
-0001d7d0: 2e30 0a20 2020 2020 2020 2072 6574 7572  .0.        retur
-0001d7e0: 6e20 7265 730a 0a20 2020 2064 6566 2066  n res..    def f
-0001d7f0: 7275 7374 756d 2873 656c 662c 206c 6566  rustum(self, lef
-0001d800: 742c 2072 6967 6874 2c20 626f 7474 6f6d  t, right, bottom
-0001d810: 2c20 746f 702c 206e 6561 722c 2066 6172  , top, near, far
-0001d820: 293a 0a20 2020 2020 2020 2022 2222 6571  ):.        """eq
-0001d830: 7569 7661 6c65 6e74 2074 6f20 7468 6520  uivalent to the 
-0001d840: 4f70 656e 474c 2063 6f6d 6d61 6e64 2067  OpenGL command g
-0001d850: 6c46 7275 7374 756d 2829 2222 220a 2020  lFrustum()""".  
-0001d860: 2020 2020 2020 6364 6566 206d 6174 3420        cdef mat4 
-0001d870: 7265 730a 2020 2020 2020 2020 6364 6566  res.        cdef
-0001d880: 2064 6f75 626c 6520 6c2c 722c 622c 742c   double l,r,b,t,
-0001d890: 6e2c 662c 2072 5f6c 2c20 745f 622c 2066  n,f, r_l, t_b, f
-0001d8a0: 5f6e 0a0a 2020 2020 2020 2020 6c20 3d20  _n..        l = 
-0001d8b0: 6c65 6674 0a20 2020 2020 2020 2072 203d  left.        r =
-0001d8c0: 2072 6967 6874 0a20 2020 2020 2020 2062   right.        b
-0001d8d0: 203d 2062 6f74 746f 6d0a 2020 2020 2020   = bottom.      
-0001d8e0: 2020 7420 3d20 746f 700a 2020 2020 2020    t = top.      
-0001d8f0: 2020 6e20 3d20 6e65 6172 0a20 2020 2020    n = near.     
-0001d900: 2020 2066 203d 2066 6172 0a0a 2020 2020     f = far..    
-0001d910: 2020 2020 725f 6c20 3d20 722d 6c0a 2020      r_l = r-l.  
-0001d920: 2020 2020 2020 745f 6220 3d20 742d 620a        t_b = t-b.
-0001d930: 2020 2020 2020 2020 665f 6e20 3d20 662d          f_n = f-
-0001d940: 6e0a 0a20 2020 2020 2020 2069 6620 725f  n..        if r_
-0001d950: 6c3c 3d65 7073 3a0a 2020 2020 2020 2020  l<=eps:.        
-0001d960: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001d970: 7272 6f72 2c20 2272 6967 6874 2d76 616c  rror, "right-val
-0001d980: 7565 206d 7573 7420 6265 2067 7265 6174  ue must be great
-0001d990: 6572 2074 6861 6e20 6c65 6674 2d76 616c  er than left-val
-0001d9a0: 7565 220a 2020 2020 2020 2020 6966 2074  ue".        if t
-0001d9b0: 5f62 3c3d 6570 733a 0a20 2020 2020 2020  _b<=eps:.       
-0001d9c0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0001d9d0: 4572 726f 722c 2022 746f 702d 7661 6c75  Error, "top-valu
-0001d9e0: 6520 6d75 7374 2062 6520 6772 6561 7465  e must be greate
-0001d9f0: 7220 7468 616e 2062 6f74 746f 6d2d 7661  r than bottom-va
-0001da00: 6c75 6522 0a20 2020 2020 2020 2069 6620  lue".        if 
-0001da10: 665f 6e3c 3d65 7073 3a0a 2020 2020 2020  f_n<=eps:.      
-0001da20: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0001da30: 6545 7272 6f72 2c20 2266 6172 2d76 616c  eError, "far-val
-0001da40: 7565 206d 7573 7420 6265 2067 7265 6174  ue must be great
-0001da50: 6572 2074 6861 6e20 6e65 6172 2d76 616c  er than near-val
-0001da60: 7565 220a 0a20 2020 2020 2020 2072 6573  ue"..        res
-0001da70: 203d 206d 6174 3428 290a 0a20 2020 2020   = mat4()..     
-0001da80: 2020 2072 6573 2e6d 3131 203d 2028 322e     res.m11 = (2.
-0001da90: 302a 6e29 2f72 5f6c 0a20 2020 2020 2020  0*n)/r_l.       
-0001daa0: 2072 6573 2e6d 3132 203d 2030 2e30 0a20   res.m12 = 0.0. 
-0001dab0: 2020 2020 2020 2072 6573 2e6d 3133 203d         res.m13 =
-0001dac0: 2028 722b 6c29 2f72 5f6c 0a20 2020 2020   (r+l)/r_l.     
-0001dad0: 2020 2072 6573 2e6d 3134 203d 2030 2e30     res.m14 = 0.0
-0001dae0: 0a20 2020 2020 2020 2072 6573 2e6d 3231  .        res.m21
-0001daf0: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001db00: 6573 2e6d 3232 203d 2028 322e 302a 6e29  es.m22 = (2.0*n)
-0001db10: 2f74 5f62 0a20 2020 2020 2020 2072 6573  /t_b.        res
-0001db20: 2e6d 3233 203d 2028 742b 6229 2f74 5f62  .m23 = (t+b)/t_b
-0001db30: 0a20 2020 2020 2020 2072 6573 2e6d 3234  .        res.m24
-0001db40: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001db50: 6573 2e6d 3331 203d 2030 2e30 0a20 2020  es.m31 = 0.0.   
-0001db60: 2020 2020 2072 6573 2e6d 3332 203d 2030       res.m32 = 0
-0001db70: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
-0001db80: 3333 203d 202d 2866 2b6e 292f 665f 6e0a  33 = -(f+n)/f_n.
-0001db90: 2020 2020 2020 2020 7265 732e 6d33 3420          res.m34 
-0001dba0: 3d20 282d 322e 302a 662a 6e29 2f66 5f6e  = (-2.0*f*n)/f_n
-0001dbb0: 0a20 2020 2020 2020 2072 6573 2e6d 3431  .        res.m41
-0001dbc0: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001dbd0: 6573 2e6d 3432 203d 2030 2e30 0a20 2020  es.m42 = 0.0.   
-0001dbe0: 2020 2020 2072 6573 2e6d 3433 203d 202d       res.m43 = -
-0001dbf0: 312e 300a 2020 2020 2020 2020 7265 732e  1.0.        res.
-0001dc00: 6d34 3420 3d20 302e 300a 2020 2020 2020  m44 = 0.0.      
-0001dc10: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
-0001dc20: 2020 6465 6620 7065 7273 7065 6374 6976    def perspectiv
-0001dc30: 6528 7365 6c66 2c20 666f 7679 2c20 6173  e(self, fovy, as
-0001dc40: 7065 6374 2c20 6e65 6172 2c20 6661 7229  pect, near, far)
-0001dc50: 3a0a 2020 2020 2020 2020 2222 2276 6f6e  :.        """von
-0001dc60: 204d 6573 6120 c3bc 6265 726e 6f6d 6d65   Mesa ..bernomme
-0001dc70: 6e20 2867 6c75 2e63 2922 2222 0a20 2020  n (glu.c)""".   
-0001dc80: 2020 2020 2063 6465 6620 646f 7562 6c65       cdef double
-0001dc90: 2066 2c20 610a 2020 2020 2020 2020 6364   f, a.        cd
-0001dca0: 6566 2064 6f75 626c 6520 746f 702c 2062  ef double top, b
-0001dcb0: 6f74 746f 6d2c 206c 6566 742c 2072 6967  ottom, left, rig
-0001dcc0: 6874 0a0a 2020 2020 2020 2020 6620 3d20  ht..        f = 
-0001dcd0: 666f 7679 0a20 2020 2020 2020 2061 203d  fovy.        a =
-0001dce0: 2061 7370 6563 740a 0a20 2020 2020 2020   aspect..       
-0001dcf0: 2074 6f70 2020 2020 3d20 6e65 6172 202a   top    = near *
-0001dd00: 2074 616e 2866 202a 2033 2e31 3431 3539   tan(f * 3.14159
-0001dd10: 3236 3533 3538 3937 3933 3120 2f20 3336  26535897931 / 36
-0001dd20: 302e 3029 0a20 2020 2020 2020 2062 6f74  0.0).        bot
-0001dd30: 746f 6d20 3d20 2d74 6f70 0a20 2020 2020  tom = -top.     
-0001dd40: 2020 206c 6566 7420 2020 3d20 626f 7474     left   = bott
-0001dd50: 6f6d 202a 2061 0a20 2020 2020 2020 2072  om * a.        r
-0001dd60: 6967 6874 2020 3d20 746f 7020 2a20 610a  ight  = top * a.
-0001dd70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001dd80: 7365 6c66 2e66 7275 7374 756d 286c 6566  self.frustum(lef
-0001dd90: 742c 2072 6967 6874 2c20 626f 7474 6f6d  t, right, bottom
-0001dda0: 2c20 746f 702c 206e 6561 722c 2066 6172  , top, near, far
-0001ddb0: 290a 0a20 2020 2064 6566 206c 6f6f 6b41  )..    def lookA
-0001ddc0: 7428 7365 6c66 2c20 706f 732c 2074 6172  t(self, pos, tar
-0001ddd0: 6765 742c 2075 703d 2830 2c30 2c31 2929  get, up=(0,0,1))
-0001dde0: 3a0a 2020 2020 2020 2020 2222 224c 6f6f  :.        """Loo
-0001ddf0: 6b20 6672 6f6d 2070 6f73 2074 6f20 7461  k from pos to ta
-0001de00: 7267 6574 2e0a 0a20 2020 2020 2020 2054  rget...        T
-0001de10: 6865 2072 6573 756c 7469 6e67 2074 7261  he resulting tra
-0001de20: 6e73 666f 726d 6174 696f 6e20 6d6f 7665  nsformation move
-0001de30: 7320 7468 6520 6f72 6967 696e 2074 6f20  s the origin to 
-0001de40: 706f 7320 616e 640a 2020 2020 2020 2020  pos and.        
-0001de50: 726f 7461 7465 7320 736f 2074 6861 7420  rotates so that 
-0001de60: 5468 6520 7a2d 6178 6973 2070 6f69 6e74  The z-axis point
-0001de70: 7320 746f 2074 6172 6765 742e 2054 6865  s to target. The
-0001de80: 2079 2d61 7869 7320 6973 0a20 2020 2020   y-axis is.     
-0001de90: 2020 2061 7320 636c 6f73 6520 6173 2070     as close as p
-0001dea0: 6f73 7369 626c 6520 746f 2074 6865 2075  ossible to the u
-0001deb0: 7020 7665 6374 6f72 2e0a 2020 2020 2020  p vector..      
-0001dec0: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
-0001ded0: 6566 206d 6174 3420 7265 730a 2020 2020  ef mat4 res.    
-0001dee0: 2020 2020 6364 6566 2076 6563 3320 7269      cdef vec3 ri
-0001def0: 6768 742c 7675 702c 6469 720a 0a20 2020  ght,vup,dir..   
-0001df00: 2020 2020 2070 6f73 2020 2020 3d20 7665       pos    = ve
-0001df10: 6333 2870 6f73 290a 2020 2020 2020 2020  c3(pos).        
-0001df20: 7461 7267 6574 203d 2076 6563 3328 7461  target = vec3(ta
-0001df30: 7267 6574 290a 2020 2020 2020 2020 7675  rget).        vu
-0001df40: 7020 2020 203d 2076 6563 3328 7570 290a  p    = vec3(up).
-0001df50: 0a20 2020 2020 2020 2064 6972 203d 2028  .        dir = (
-0001df60: 7461 7267 6574 202d 2070 6f73 292e 6e6f  target - pos).no
-0001df70: 726d 616c 697a 6528 290a 2020 2020 2020  rmalize().      
-0001df80: 2020 7675 7020 3d20 7675 702e 6e6f 726d    vup = vup.norm
-0001df90: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
-0001dfa0: 7675 7020 3d20 7675 7020 2d20 2876 7570  vup = vup - (vup
-0001dfb0: 202a 2064 6972 2920 2a20 6469 720a 2020   * dir) * dir.  
-0001dfc0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-0001dfd0: 2020 2020 2020 2076 7570 2020 3d20 7675         vup  = vu
-0001dfe0: 702e 6e6f 726d 616c 697a 6528 290a 2020  p.normalize().  
-0001dff0: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
-0001e000: 2020 2020 2020 2020 2020 2320 5765 2772            # We'r
-0001e010: 6520 6c6f 6f6b 696e 6720 616c 6f6e 6720  e looking along 
-0001e020: 7468 6520 7570 2064 6972 6563 7469 6f6e  the up direction
-0001e030: 2c20 736f 2063 686f 6f73 650a 2020 2020  , so choose.    
-0001e040: 2020 2020 2020 2020 2320 616e 2061 7262          # an arb
-0001e050: 6974 7261 7279 2064 6972 6563 7469 6f6e  itrary direction
-0001e060: 2074 6861 7420 6973 2070 6572 7065 6e64   that is perpend
-0001e070: 6963 756c 6172 2074 6f20 6469 720a 2020  icular to dir.  
-0001e080: 2020 2020 2020 2020 2020 2320 6173 206e            # as n
-0001e090: 6577 2075 702e 0a20 2020 2020 2020 2020  ew up..         
-0001e0a0: 2020 2076 7570 203d 2064 6972 2e6f 7274     vup = dir.ort
-0001e0b0: 686f 2829 0a0a 2020 2020 2020 2020 7269  ho()..        ri
-0001e0c0: 6768 7420 3d20 7675 702e 6372 6f73 7328  ght = vup.cross(
-0001e0d0: 6469 7229 2e6e 6f72 6d61 6c69 7a65 2829  dir).normalize()
-0001e0e0: 0a0a 2020 2020 2020 2020 7265 7320 3d20  ..        res = 
-0001e0f0: 6d61 7434 2829 0a20 2020 2020 2020 2072  mat4().        r
-0001e100: 6573 2e6d 3131 203d 2072 6967 6874 2e78  es.m11 = right.x
-0001e110: 0a20 2020 2020 2020 2072 6573 2e6d 3231  .        res.m21
-0001e120: 203d 2072 6967 6874 2e79 0a20 2020 2020   = right.y.     
-0001e130: 2020 2072 6573 2e6d 3331 203d 2072 6967     res.m31 = rig
-0001e140: 6874 2e7a 0a20 2020 2020 2020 2072 6573  ht.z.        res
-0001e150: 2e6d 3431 203d 2030 2e30 0a20 2020 2020  .m41 = 0.0.     
-0001e160: 2020 2072 6573 2e6d 3132 203d 2076 7570     res.m12 = vup
-0001e170: 2e78 0a20 2020 2020 2020 2072 6573 2e6d  .x.        res.m
-0001e180: 3232 203d 2076 7570 2e79 0a20 2020 2020  22 = vup.y.     
-0001e190: 2020 2072 6573 2e6d 3332 203d 2076 7570     res.m32 = vup
-0001e1a0: 2e7a 0a20 2020 2020 2020 2072 6573 2e6d  .z.        res.m
-0001e1b0: 3432 203d 2030 2e30 0a20 2020 2020 2020  42 = 0.0.       
-0001e1c0: 2072 6573 2e6d 3133 203d 2064 6972 2e78   res.m13 = dir.x
-0001e1d0: 0a20 2020 2020 2020 2072 6573 2e6d 3233  .        res.m23
-0001e1e0: 203d 2064 6972 2e79 0a20 2020 2020 2020   = dir.y.       
-0001e1f0: 2072 6573 2e6d 3333 203d 2064 6972 2e7a   res.m33 = dir.z
-0001e200: 0a20 2020 2020 2020 2072 6573 2e6d 3433  .        res.m43
-0001e210: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
-0001e220: 6573 2e6d 3134 203d 2070 6f73 2e78 0a20  es.m14 = pos.x. 
-0001e230: 2020 2020 2020 2072 6573 2e6d 3234 203d         res.m24 =
-0001e240: 2070 6f73 2e79 0a20 2020 2020 2020 2072   pos.y.        r
-0001e250: 6573 2e6d 3334 203d 2070 6f73 2e7a 0a20  es.m34 = pos.z. 
-0001e260: 2020 2020 2020 2072 6573 2e6d 3434 203d         res.m44 =
-0001e270: 2031 2e30 0a20 2020 2020 2020 2072 6574   1.0.        ret
-0001e280: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
-0001e290: 206f 7274 686f 2873 656c 6629 3a0a 2020   ortho(self):.  
-0001e2a0: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
-0001e2b0: 6120 6d61 7472 6978 2077 6974 6820 6f72  a matrix with or
-0001e2c0: 7468 6f67 6f6e 616c 2062 6173 6520 7665  thogonal base ve
-0001e2d0: 6374 6f72 732e 0a0a 2020 2020 2020 2020  ctors...        
-0001e2e0: 4d61 6b65 7320 7468 6520 782d 2c20 792d  Makes the x-, y-
-0001e2f0: 2061 6e64 207a 2d61 7869 7320 6f72 7468   and z-axis orth
-0001e300: 6f67 6f6e 616c 2e0a 2020 2020 2020 2020  ogonal..        
-0001e310: 5468 6520 666f 7572 7468 2063 6f6c 756d  The fourth colum
-0001e320: 6e20 616e 6420 726f 7720 7265 6d61 696e  n and row remain
-0001e330: 2075 6e74 6f75 6368 6564 2e0a 2020 2020   untouched..    
-0001e340: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001e350: 6364 6566 206d 6174 3420 7265 730a 2020  cdef mat4 res.  
-0001e360: 2020 2020 2020 6364 6566 2076 6563 3320        cdef vec3 
-0001e370: 782c 792c 7a0a 0a20 2020 2020 2020 2078  x,y,z..        x
-0001e380: 203d 2076 6563 3328 7365 6c66 2e6d 3131   = vec3(self.m11
-0001e390: 2c20 7365 6c66 2e6d 3231 2c20 7365 6c66  , self.m21, self
-0001e3a0: 2e6d 3331 290a 2020 2020 2020 2020 7920  .m31).        y 
-0001e3b0: 3d20 7665 6333 2873 656c 662e 6d31 322c  = vec3(self.m12,
-0001e3c0: 2073 656c 662e 6d32 322c 2073 656c 662e   self.m22, self.
-0001e3d0: 6d33 3229 0a20 2020 2020 2020 207a 203d  m32).        z =
-0001e3e0: 2076 6563 3328 7365 6c66 2e6d 3133 2c20   vec3(self.m13, 
-0001e3f0: 7365 6c66 2e6d 3233 2c20 7365 6c66 2e6d  self.m23, self.m
-0001e400: 3333 290a 0a20 2020 2020 2020 2078 6c20  33)..        xl 
-0001e410: 3d20 782e 6c65 6e67 7468 2829 0a20 2020  = x.length().   
-0001e420: 2020 2020 2078 6c20 3d20 786c 2a78 6c0a       xl = xl*xl.
-0001e430: 2020 2020 2020 2020 7920 3d20 7920 2d20          y = y - 
-0001e440: 2828 782a 7929 2f78 6c29 2a78 0a20 2020  ((x*y)/xl)*x.   
-0001e450: 2020 2020 207a 203d 207a 202d 2028 2878       z = z - ((x
-0001e460: 2a7a 292f 786c 292a 780a 0a20 2020 2020  *z)/xl)*x..     
-0001e470: 2020 2079 6c20 3d20 792e 6c65 6e67 7468     yl = y.length
-0001e480: 2829 0a20 2020 2020 2020 2079 6c20 3d20  ().        yl = 
-0001e490: 796c 2a79 6c0a 2020 2020 2020 2020 7a20  yl*yl.        z 
-0001e4a0: 3d20 7a20 2d20 2828 792a 7a29 2f79 6c29  = z - ((y*z)/yl)
-0001e4b0: 2a79 0a0a 2020 2020 2020 2020 7265 7320  *y..        res 
-0001e4c0: 3d20 6d61 7434 2829 0a20 2020 2020 2020  = mat4().       
-0001e4d0: 2072 6573 2e6d 3131 203d 2078 2e78 0a20   res.m11 = x.x. 
-0001e4e0: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
-0001e4f0: 2079 2e78 0a20 2020 2020 2020 2072 6573   y.x.        res
-0001e500: 2e6d 3133 203d 207a 2e78 0a20 2020 2020  .m13 = z.x.     
-0001e510: 2020 2072 6573 2e6d 3134 203d 2073 656c     res.m14 = sel
-0001e520: 662e 6d31 340a 2020 2020 2020 2020 7265  f.m14.        re
-0001e530: 732e 6d32 3120 3d20 782e 790a 2020 2020  s.m21 = x.y.    
-0001e540: 2020 2020 7265 732e 6d32 3220 3d20 792e      res.m22 = y.
-0001e550: 790a 2020 2020 2020 2020 7265 732e 6d32  y.        res.m2
-0001e560: 3320 3d20 7a2e 790a 2020 2020 2020 2020  3 = z.y.        
-0001e570: 7265 732e 6d32 3420 3d20 7365 6c66 2e6d  res.m24 = self.m
-0001e580: 3234 0a20 2020 2020 2020 2072 6573 2e6d  24.        res.m
-0001e590: 3331 203d 2078 2e7a 0a20 2020 2020 2020  31 = x.z.       
-0001e5a0: 2072 6573 2e6d 3332 203d 2079 2e7a 0a20   res.m32 = y.z. 
-0001e5b0: 2020 2020 2020 2072 6573 2e6d 3333 203d         res.m33 =
-0001e5c0: 207a 2e7a 0a20 2020 2020 2020 2072 6573   z.z.        res
-0001e5d0: 2e6d 3334 203d 2073 656c 662e 6d33 340a  .m34 = self.m34.
-0001e5e0: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
-0001e5f0: 3d20 7365 6c66 2e6d 3431 0a20 2020 2020  = self.m41.     
-0001e600: 2020 2072 6573 2e6d 3432 203d 2073 656c     res.m42 = sel
-0001e610: 662e 6d34 320a 2020 2020 2020 2020 7265  f.m42.        re
-0001e620: 732e 6d34 3320 3d20 7365 6c66 2e6d 3433  s.m43 = self.m43
-0001e630: 0a20 2020 2020 2020 2072 6573 2e6d 3434  .        res.m44
-0001e640: 203d 2073 656c 662e 6d34 340a 2020 2020   = self.m44.    
-0001e650: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-0001e660: 2020 2020 6465 6620 6465 636f 6d70 6f73      def decompos
-0001e670: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-0001e680: 2022 2222 4465 636f 6d70 6f73 6573 2074   """Decomposes t
-0001e690: 6865 206d 6174 7269 7820 696e 746f 2061  he matrix into a
-0001e6a0: 2074 7261 6e73 6c61 7469 6f6e 2c20 726f   translation, ro
-0001e6b0: 7461 7469 6f6e 2061 6e64 2073 6361 6c69  tation and scali
-0001e6c0: 6e67 2070 6172 742e 0a0a 2020 2020 2020  ng part...      
-0001e6d0: 2020 5265 7475 726e 7320 6120 7475 706c    Returns a tupl
-0001e6e0: 6520 2874 7261 6e73 6c61 7469 6f6e 2c20  e (translation, 
-0001e6f0: 726f 7461 7469 6f6e 2c20 7363 616c 696e  rotation, scalin
-0001e700: 6729 2e20 5468 650a 2020 2020 2020 2020  g). The.        
-0001e710: 7472 616e 736c 6174 696f 6e20 616e 6420  translation and 
-0001e720: 7363 616c 696e 6720 7061 7274 7320 6172  scaling parts ar
-0001e730: 6520 6769 7665 6e20 6173 2076 6563 3327  e given as vec3'
-0001e740: 732c 2074 6865 2072 6f74 6174 696f 6e0a  s, the rotation.
-0001e750: 2020 2020 2020 2020 6973 2073 7469 6c6c          is still
-0001e760: 2067 6976 656e 2061 7320 6120 6d61 7434   given as a mat4
-0001e770: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001e780: 2020 2020 2020 6364 6566 206d 6174 3420        cdef mat4 
-0001e790: 6d0a 2020 2020 2020 2020 6364 6566 2076  m.        cdef v
-0001e7a0: 6563 3320 612c 622c 630a 2020 2020 2020  ec3 a,b,c.      
-0001e7b0: 2020 6364 6566 2064 6f75 626c 6520 616c    cdef double al
-0001e7c0: 2c20 626c 2c20 636c 0a0a 2020 2020 2020  , bl, cl..      
-0001e7d0: 2020 6d20 3d20 7365 6c66 2e6f 7274 686f    m = self.ortho
-0001e7e0: 2829 0a20 2020 2020 2020 206d 2e6d 3134  ().        m.m14
-0001e7f0: 203d 2030 2e30 0a20 2020 2020 2020 206d   = 0.0.        m
-0001e800: 2e6d 3234 203d 2030 2e30 0a20 2020 2020  .m24 = 0.0.     
-0001e810: 2020 206d 2e6d 3334 203d 2030 2e30 0a20     m.m34 = 0.0. 
-0001e820: 2020 2020 2020 206d 2e6d 3434 203d 2031         m.m44 = 1
-0001e830: 2e30 0a20 2020 2020 2020 206d 2e6d 3431  .0.        m.m41
-0001e840: 203d 2030 2e30 0a20 2020 2020 2020 206d   = 0.0.        m
-0001e850: 2e6d 3432 203d 2030 2e30 0a20 2020 2020  .m42 = 0.0.     
-0001e860: 2020 206d 2e6d 3433 203d 2030 2e30 0a0a     m.m43 = 0.0..
-0001e870: 2020 2020 2020 2020 2320 612c 622c 6320          # a,b,c 
-0001e880: 3d20 436f 6c75 6d6e 2030 2c31 2c32 206f  = Column 0,1,2 o
-0001e890: 6620 6d0a 2020 2020 2020 2020 6120 3d20  f m.        a = 
-0001e8a0: 7665 6333 2829 0a20 2020 2020 2020 2062  vec3().        b
-0001e8b0: 203d 2076 6563 3328 290a 2020 2020 2020   = vec3().      
-0001e8c0: 2020 6320 3d20 7665 6333 2829 0a20 2020    c = vec3().   
-0001e8d0: 2020 2020 2061 2e78 203d 206d 2e6d 3131       a.x = m.m11
-0001e8e0: 0a20 2020 2020 2020 2061 2e79 203d 206d  .        a.y = m
-0001e8f0: 2e6d 3231 0a20 2020 2020 2020 2061 2e7a  .m21.        a.z
-0001e900: 203d 206d 2e6d 3331 0a20 2020 2020 2020   = m.m31.       
-0001e910: 2062 2e78 203d 206d 2e6d 3132 0a20 2020   b.x = m.m12.   
-0001e920: 2020 2020 2062 2e79 203d 206d 2e6d 3232       b.y = m.m22
-0001e930: 0a20 2020 2020 2020 2062 2e7a 203d 206d  .        b.z = m
-0001e940: 2e6d 3332 0a20 2020 2020 2020 2063 2e78  .m32.        c.x
-0001e950: 203d 206d 2e6d 3133 0a20 2020 2020 2020   = m.m13.       
-0001e960: 2063 2e79 203d 206d 2e6d 3233 0a20 2020   c.y = m.m23.   
-0001e970: 2020 2020 2063 2e7a 203d 206d 2e6d 3333       c.z = m.m33
-0001e980: 0a0a 2020 2020 2020 2020 2320 616c 2c62  ..        # al,b
-0001e990: 6c2c 636c 203d 206c 656e 6774 6820 6f66  l,cl = length of
-0001e9a0: 2061 2c62 2c63 2028 3d20 7363 616c 696e   a,b,c (= scalin
-0001e9b0: 6720 6661 6374 6f72 7329 0a20 2020 2020  g factors).     
-0001e9c0: 2020 2061 6c20 3d20 7371 7274 2861 2e78     al = sqrt(a.x
-0001e9d0: 2a61 2e78 202b 2061 2e79 2a61 2e79 202b  *a.x + a.y*a.y +
-0001e9e0: 2061 2e7a 2a61 2e7a 290a 2020 2020 2020   a.z*a.z).      
-0001e9f0: 2020 626c 203d 2073 7172 7428 622e 782a    bl = sqrt(b.x*
-0001ea00: 622e 7820 2b20 622e 792a 622e 7920 2b20  b.x + b.y*b.y + 
-0001ea10: 622e 7a2a 622e 7a29 0a20 2020 2020 2020  b.z*b.z).       
-0001ea20: 2063 6c20 3d20 7371 7274 2863 2e78 2a63   cl = sqrt(c.x*c
-0001ea30: 2e78 202b 2063 2e79 2a63 2e79 202b 2063  .x + c.y*c.y + c
-0001ea40: 2e7a 2a63 2e7a 290a 2020 2020 2020 2020  .z*c.z).        
-0001ea50: 6966 2061 6c3c 3d65 7073 206f 7220 626c  if al<=eps or bl
-0001ea60: 3c3d 6570 7320 6f72 2063 6c3c 3d65 7073  <=eps or cl<=eps
-0001ea70: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0001ea80: 6973 6520 5a65 726f 4469 7669 7369 6f6e  ise ZeroDivision
-0001ea90: 4572 726f 722c 2274 7261 6e73 666f 726d  Error,"transform
-0001eaa0: 6174 696f 6e20 636f 6e74 6169 6e73 2061  ation contains a
-0001eab0: 2030 2073 6361 6c69 6e67 220a 0a20 2020   0 scaling"..   
-0001eac0: 2020 2020 2073 6361 6c65 203d 2076 6563       scale = vec
-0001ead0: 3328 616c 2c62 6c2c 636c 290a 0a20 2020  3(al,bl,cl)..   
-0001eae0: 2020 2020 2023 206e 6f72 6d61 6c69 7a69       # normalizi
-0001eaf0: 6e67 2061 2c62 2c63 0a23 2020 2020 2020  ng a,b,c.#      
-0001eb00: 2020 612f 3d61 6c0a 2320 2020 2020 2020    a/=al.#       
-0001eb10: 2062 2f3d 626c 0a23 2020 2020 2020 2020   b/=bl.#        
-0001eb20: 632f 3d63 6c0a 2020 2020 2020 2020 612e  c/=cl.        a.
-0001eb30: 7820 3d20 612e 782f 616c 0a20 2020 2020  x = a.x/al.     
-0001eb40: 2020 2061 2e79 203d 2061 2e79 2f61 6c0a     a.y = a.y/al.
-0001eb50: 2020 2020 2020 2020 612e 7a20 3d20 612e          a.z = a.
-0001eb60: 7a2f 616c 0a20 2020 2020 2020 2062 2e78  z/al.        b.x
-0001eb70: 203d 2062 2e78 2f62 6c0a 2020 2020 2020   = b.x/bl.      
-0001eb80: 2020 622e 7920 3d20 622e 792f 626c 0a20    b.y = b.y/bl. 
-0001eb90: 2020 2020 2020 2062 2e7a 203d 2062 2e7a         b.z = b.z
-0001eba0: 2f62 6c0a 2020 2020 2020 2020 632e 7820  /bl.        c.x 
-0001ebb0: 3d20 632e 782f 636c 0a20 2020 2020 2020  = c.x/cl.       
-0001ebc0: 2063 2e79 203d 2063 2e79 2f63 6c0a 2020   c.y = c.y/cl.  
-0001ebd0: 2020 2020 2020 632e 7a20 3d20 632e 7a2f        c.z = c.z/
-0001ebe0: 636c 0a0a 2020 2020 2020 2020 6d2e 6d31  cl..        m.m1
-0001ebf0: 3120 3d20 612e 780a 2020 2020 2020 2020  1 = a.x.        
-0001ec00: 6d2e 6d32 3120 3d20 612e 790a 2020 2020  m.m21 = a.y.    
-0001ec10: 2020 2020 6d2e 6d33 3120 3d20 612e 7a0a      m.m31 = a.z.
-0001ec20: 2020 2020 2020 2020 6d2e 6d31 3220 3d20          m.m12 = 
-0001ec30: 622e 780a 2020 2020 2020 2020 6d2e 6d32  b.x.        m.m2
-0001ec40: 3220 3d20 622e 790a 2020 2020 2020 2020  2 = b.y.        
-0001ec50: 6d2e 6d33 3220 3d20 622e 7a0a 2020 2020  m.m32 = b.z.    
-0001ec60: 2020 2020 6d2e 6d31 3320 3d20 632e 780a      m.m13 = c.x.
-0001ec70: 2020 2020 2020 2020 6d2e 6d32 3320 3d20          m.m23 = 
-0001ec80: 632e 790a 2020 2020 2020 2020 6d2e 6d33  c.y.        m.m3
-0001ec90: 3320 3d20 632e 7a0a 2020 2020 2020 2020  3 = c.z.        
-0001eca0: 6966 206d 2e64 6574 6572 6d69 6e61 6e74  if m.determinant
-0001ecb0: 2829 3c30 2e30 3a0a 2020 2020 2020 2020  ()<0.0:.        
-0001ecc0: 2020 2020 6d2e 6d31 3120 3d20 2d6d 2e6d      m.m11 = -m.m
-0001ecd0: 3131 0a20 2020 2020 2020 2020 2020 206d  11.            m
-0001ece0: 2e6d 3231 203d 202d 6d2e 6d32 310a 2020  .m21 = -m.m21.  
-0001ecf0: 2020 2020 2020 2020 2020 6d2e 6d33 3120            m.m31 
-0001ed00: 3d20 2d6d 2e6d 3331 0a20 2020 2020 2020  = -m.m31.       
-0001ed10: 2020 2020 2073 6361 6c65 2e78 203d 202d       scale.x = -
-0001ed20: 7363 616c 652e 780a 0a20 2020 2020 2020  scale.x..       
-0001ed30: 2072 6574 7572 6e20 2876 6563 3328 7365   return (vec3(se
-0001ed40: 6c66 2e6d 3134 2c20 7365 6c66 2e6d 3234  lf.m14, self.m24
-0001ed50: 2c20 7365 6c66 2e6d 3334 292c 206d 2c20  , self.m34), m, 
-0001ed60: 7363 616c 6529 0a0a 2020 2020 6465 6620  scale)..    def 
-0001ed70: 6765 744d 6174 3328 7365 6c66 293a 0a20  getMat3(self):. 
-0001ed80: 2020 2020 2020 2022 2222 436f 6e76 6572         """Conver
-0001ed90: 7420 746f 206d 6174 3320 6279 2064 6973  t to mat3 by dis
-0001eda0: 6361 7264 696e 6720 3474 6820 726f 7720  carding 4th row 
-0001edb0: 616e 6420 636f 6c75 6d6e 2e0a 2020 2020  and column..    
-0001edc0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001edd0: 6364 6566 206d 6174 3320 7265 730a 2020  cdef mat3 res.  
-0001ede0: 2020 2020 2020 7265 7320 3d20 6d61 7433        res = mat3
-0001edf0: 2829 0a20 2020 2020 2020 2072 6573 2e6d  ().        res.m
-0001ee00: 3131 203d 2073 656c 662e 6d31 310a 2020  11 = self.m11.  
-0001ee10: 2020 2020 2020 7265 732e 6d31 3220 3d20        res.m12 = 
-0001ee20: 7365 6c66 2e6d 3132 0a20 2020 2020 2020  self.m12.       
-0001ee30: 2072 6573 2e6d 3133 203d 2073 656c 662e   res.m13 = self.
-0001ee40: 6d31 330a 2020 2020 2020 2020 7265 732e  m13.        res.
-0001ee50: 6d32 3120 3d20 7365 6c66 2e6d 3231 0a20  m21 = self.m21. 
-0001ee60: 2020 2020 2020 2072 6573 2e6d 3232 203d         res.m22 =
-0001ee70: 2073 656c 662e 6d32 320a 2020 2020 2020   self.m22.      
-0001ee80: 2020 7265 732e 6d32 3320 3d20 7365 6c66    res.m23 = self
-0001ee90: 2e6d 3233 0a20 2020 2020 2020 2072 6573  .m23.        res
-0001eea0: 2e6d 3331 203d 2073 656c 662e 6d33 310a  .m31 = self.m31.
-0001eeb0: 2020 2020 2020 2020 7265 732e 6d33 3220          res.m32 
-0001eec0: 3d20 7365 6c66 2e6d 3332 0a20 2020 2020  = self.m32.     
-0001eed0: 2020 2072 6573 2e6d 3333 203d 2073 656c     res.m33 = sel
-0001eee0: 662e 6d33 330a 2020 2020 2020 2020 7265  f.m33.        re
-0001eef0: 7475 726e 2072 6573 0a0a 2020 2020 6465  turn res..    de
-0001ef00: 6620 7365 744d 6174 3328 7365 6c66 2c20  f setMat3(self, 
-0001ef10: 6d61 7433 206d 293a 0a20 2020 2020 2020  mat3 m):.       
-0001ef20: 2022 2222 5365 7420 7468 6520 6d61 7433   """Set the mat3
-0001ef30: 2070 6172 7420 6f66 2073 656c 662e 0a20   part of self.. 
-0001ef40: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001ef50: 2020 2073 656c 662e 6d31 3120 3d20 6d2e     self.m11 = m.
-0001ef60: 6d31 310a 2020 2020 2020 2020 7365 6c66  m11.        self
-0001ef70: 2e6d 3132 203d 206d 2e6d 3132 0a20 2020  .m12 = m.m12.   
-0001ef80: 2020 2020 2073 656c 662e 6d31 3320 3d20       self.m13 = 
-0001ef90: 6d2e 6d31 330a 2020 2020 2020 2020 7365  m.m13.        se
-0001efa0: 6c66 2e6d 3231 203d 206d 2e6d 3231 0a20  lf.m21 = m.m21. 
-0001efb0: 2020 2020 2020 2073 656c 662e 6d32 3220         self.m22 
-0001efc0: 3d20 6d2e 6d32 320a 2020 2020 2020 2020  = m.m22.        
-0001efd0: 7365 6c66 2e6d 3233 203d 206d 2e6d 3233  self.m23 = m.m23
-0001efe0: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
-0001eff0: 3120 3d20 6d2e 6d33 310a 2020 2020 2020  1 = m.m31.      
-0001f000: 2020 7365 6c66 2e6d 3332 203d 206d 2e6d    self.m32 = m.m
-0001f010: 3332 0a20 2020 2020 2020 2073 656c 662e  32.        self.
-0001f020: 6d33 3320 3d20 6d2e 6d33 330a 0a23 2323  m33 = m.m33..###
-0001f030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0001f070: 2323 230a 0a23 2071 7561 740a 6364 6566  ###..# quat.cdef
-0001f080: 2063 6c61 7373 2071 7561 743a 0a20 2020   class quat:.   
-0001f090: 2022 2222 5175 6174 6572 6e69 6f6e 2063   """Quaternion c
-0001f0a0: 6c61 7373 2e0a 0a20 2020 2051 7561 7465  lass...    Quate
-0001f0b0: 726e 696f 6e73 2061 7265 2061 6e20 6578  rnions are an ex
-0001f0c0: 7465 6e73 696f 6e20 746f 2063 6f6d 706c  tension to compl
-0001f0d0: 6578 206e 756d 6265 7273 2061 6e64 2063  ex numbers and c
-0001f0e0: 616e 2062 6520 7573 6564 0a20 2020 2074  an be used.    t
-0001f0f0: 6f20 7374 6f72 6520 726f 7461 7469 6f6e  o store rotation
-0001f100: 732e 2054 6865 7920 6172 6520 636f 6d70  s. They are comp
-0001f110: 6f73 6564 206f 6620 666f 7572 2066 6c6f  osed of four flo
-0001f120: 6174 7320 7768 6963 6820 6361 6e20 6265  ats which can be
-0001f130: 0a20 2020 2073 6565 6e20 6173 2061 6e20  .    seen as an 
-0001f140: 616e 676c 6520 616e 6420 616e 2061 7869  angle and an axi
-0001f150: 7320 6f66 2072 6f74 6174 696f 6e2e 0a20  s of rotation.. 
-0001f160: 2020 2022 2222 0a0a 2020 2020 6364 6566     """..    cdef
-0001f170: 2064 6f75 626c 6520 772c 782c 792c 7a0a   double w,x,y,z.
-0001f180: 0a20 2020 2064 6566 205f 5f63 696e 6974  .    def __cinit
-0001f190: 5f5f 2873 656c 662c 202a 6172 6773 293a  __(self, *args):
-0001f1a0: 0a20 2020 2020 2020 2022 2222 436f 6e73  .        """Cons
-0001f1b0: 7472 7563 746f 722e 0a0a 2020 2020 2020  tructor...      
-0001f1c0: 2020 3020 6172 6775 6d65 6e74 733a 207a    0 arguments: z
-0001f1d0: 6572 6f65 730a 2020 2020 2020 2020 3120  eroes.        1 
-0001f1e0: 666c 6f61 7420 6172 6775 6d65 6e74 3a20  float argument: 
-0001f1f0: 2077 2063 6f6d 706f 6e65 6e74 2c20 782c   w component, x,
-0001f200: 792c 7a20 3d20 2830 2c30 2c30 290a 2020  y,z = (0,0,0).  
-0001f210: 2020 2020 2020 3120 7175 6174 2061 7267        1 quat arg
-0001f220: 756d 656e 743a 204d 616b 6520 6120 636f  ument: Make a co
-0001f230: 7079 0a20 2020 2020 2020 2031 206d 6174  py.        1 mat
-0001f240: 3320 6172 6775 6d65 6e74 3a20 496e 6974  3 argument: Init
-0001f250: 6961 6c69 7a65 2062 7920 726f 7461 7469  ialize by rotati
-0001f260: 6f6e 206d 6174 7269 780a 2020 2020 2020  on matrix.      
-0001f270: 2020 3120 6d61 7434 2061 7267 756d 656e    1 mat4 argumen
-0001f280: 743a 2049 6e69 7469 616c 697a 6520 6279  t: Initialize by
-0001f290: 2072 6f74 6174 696f 6e20 6d61 7472 6978   rotation matrix
-0001f2a0: 0a20 2020 2020 2020 2032 2061 7267 756d  .        2 argum
-0001f2b0: 656e 7473 3a20 616e 676c 6520 2620 6178  ents: angle & ax
-0001f2c0: 6973 2028 646f 6573 6e27 7420 6861 7665  is (doesn't have
-0001f2d0: 2074 6f20 6265 206f 6620 756e 6974 206c   to be of unit l
-0001f2e0: 656e 6774 6829 0a20 2020 2020 2020 2034  ength).        4
-0001f2f0: 2061 7267 756d 656e 7473 3a20 636f 6d70   arguments: comp
-0001f300: 6f6e 656e 7473 2077 2c78 2c79 2c7a 0a20  onents w,x,y,z. 
-0001f310: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0001f320: 2020 2020 6364 6566 2069 6e74 2061 7267      cdef int arg
-0001f330: 6c65 6e2c 2073 6571 6c65 6e0a 2020 2020  len, seqlen.    
-0001f340: 2020 2020 6364 6566 2071 7561 7420 710a      cdef quat q.
-0001f350: 2020 2020 2020 2020 6172 676c 656e 203d          arglen =
-0001f360: 206c 656e 2861 7267 7329 0a0a 2020 2020   len(args)..    
-0001f370: 2020 2020 2320 3020 6172 6775 6d65 6e74      # 0 argument
-0001f380: 730a 2020 2020 2020 2020 6966 2061 7267  s.        if arg
-0001f390: 6c65 6e3d 3d30 3a0a 2020 2020 2020 2020  len==0:.        
-0001f3a0: 2020 2020 7365 6c66 2e77 203d 2030 2e30      self.w = 0.0
-0001f3b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001f3c0: 662e 7820 3d20 302e 300a 2020 2020 2020  f.x = 0.0.      
-0001f3d0: 2020 2020 2020 7365 6c66 2e79 203d 2030        self.y = 0
-0001f3e0: 2e30 0a20 2020 2020 2020 2020 2020 2073  .0.            s
-0001f3f0: 656c 662e 7a20 3d20 302e 300a 0a20 2020  elf.z = 0.0..   
-0001f400: 2020 2020 2023 2031 2061 7267 756d 656e       # 1 argumen
-0001f410: 740a 2020 2020 2020 2020 656c 6966 2061  t.        elif a
-0001f420: 7267 6c65 6e3d 3d31 3a0a 2020 2020 2020  rglen==1:.      
-0001f430: 2020 2020 2020 5420 3d20 7479 7065 2861        T = type(a
-0001f440: 7267 735b 305d 290a 2020 2020 2020 2020  rgs[0]).        
-0001f450: 2020 2020 2320 7363 616c 6172 0a20 2020      # scalar.   
-0001f460: 2020 2020 2020 2020 2069 6620 5420 6973           if T is
-0001f470: 2066 6c6f 6174 206f 7220 5420 6973 2069   float or T is i
-0001f480: 6e74 206f 7220 5420 6973 206c 6f6e 673a  nt or T is long:
-0001f490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f4a0: 2073 656c 662e 7720 3d20 6172 6773 5b30   self.w = args[0
-0001f4b0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0001f4c0: 2020 7365 6c66 2e78 203d 2030 2e30 0a20    self.x = 0.0. 
-0001f4d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001f4e0: 656c 662e 7920 3d20 302e 300a 2020 2020  elf.y = 0.0.    
-0001f4f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001f500: 2e7a 203d 2030 2e30 0a20 2020 2020 2020  .z = 0.0.       
-0001f510: 2020 2020 2023 2071 7561 740a 2020 2020       # quat.    
-0001f520: 2020 2020 2020 2020 656c 6966 2054 2069          elif T i
-0001f530: 7320 7175 6174 3a0a 2020 2020 2020 2020  s quat:.        
-0001f540: 2020 2020 2020 2020 7120 3d20 6172 6773          q = args
-0001f550: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-0001f560: 2020 2020 7365 6c66 2e77 203d 2071 2e77      self.w = q.w
-0001f570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f580: 2073 656c 662e 7820 3d20 712e 780a 2020   self.x = q.x.  
-0001f590: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001f5a0: 6c66 2e79 203d 2071 2e79 0a20 2020 2020  lf.y = q.y.     
-0001f5b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001f5c0: 7a20 3d20 712e 7a0a 2020 2020 2020 2020  z = q.z.        
-0001f5d0: 2020 2020 2320 5374 7269 6e67 0a20 2020      # String.   
-0001f5e0: 2020 2020 2020 2020 2065 6c69 6620 5420           elif T 
-0001f5f0: 6973 2073 7472 206f 7220 5420 6973 2075  is str or T is u
-0001f600: 6e69 636f 6465 3a0a 2020 2020 2020 2020  nicode:.        
-0001f610: 2020 2020 2020 2020 733d 6172 6773 5b30          s=args[0
-0001f620: 5d2e 7265 706c 6163 6528 222c 222c 2220  ].replace(","," 
-0001f630: 2229 2e72 6570 6c61 6365 2822 2020 222c  ").replace("  ",
-0001f640: 2220 2229 2e73 7472 6970 2829 2e73 706c  " ").strip().spl
-0001f650: 6974 2822 2022 290a 2020 2020 2020 2020  it(" ").        
-0001f660: 2020 2020 2020 2020 6966 2073 3d3d 5b22          if s==["
-0001f670: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
-0001f680: 2020 2020 2020 2020 733d 5b5d 0a20 2020          s=[].   
-0001f690: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0001f6a0: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
-0001f6b0: 7329 293a 0a20 2020 2020 2020 2020 2020  s)):.           
-0001f6c0: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-0001f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f6e0: 2020 2020 2020 735b 695d 203d 2066 6c6f        s[i] = flo
-0001f6f0: 6174 2873 5b69 5d29 0a20 2020 2020 2020  at(s[i]).       
-0001f700: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-0001f710: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
-0001f720: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001f730: 7365 2056 616c 7565 4572 726f 722c 2271  se ValueError,"q
-0001f740: 7561 7428 2920 6172 6720 6973 2061 206d  uat() arg is a m
-0001f750: 616c 666f 726d 6564 2073 7472 696e 6722  alformed string"
-0001f760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f770: 2071 203d 2071 7561 7428 7329 0a20 2020   q = quat(s).   
-0001f780: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001f790: 662e 7720 3d20 712e 770a 2020 2020 2020  f.w = q.w.      
-0001f7a0: 2020 2020 2020 2020 2020 7365 6c66 2e78            self.x
-0001f7b0: 203d 2071 2e78 0a20 2020 2020 2020 2020   = q.x.         
-0001f7c0: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
-0001f7d0: 712e 790a 2020 2020 2020 2020 2020 2020  q.y.            
-0001f7e0: 2020 2020 7365 6c66 2e7a 203d 2071 2e7a      self.z = q.z
-0001f7f0: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
-0001f800: 6571 7565 6e63 6520 6f66 2066 6c6f 6174  equence of float
-0001f810: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
-0001f820: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001f830: 2020 2020 7365 7120 3d20 6172 6773 5b30      seq = args[0
-0001f840: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0001f850: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-0001f860: 2020 2020 2020 2020 2020 2073 6571 6c65             seqle
-0001f870: 6e20 3d20 6c65 6e28 7365 7129 0a20 2020  n = len(seq).   
-0001f880: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-0001f890: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
-0001f8a0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0001f8b0: 7970 6545 7272 6f72 2c22 7175 6174 2829  ypeError,"quat()
-0001f8c0: 2061 7267 2063 616e 2774 2062 6520 636f   arg can't be co
-0001f8d0: 6e76 6572 7465 6420 746f 2071 7561 7422  nverted to quat"
-0001f8e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001f8f0: 2020 6966 2073 6571 6c65 6e3d 3d30 3a0a    if seqlen==0:.
-0001f900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f910: 2020 2020 7365 6c66 2e77 203d 2030 2e30      self.w = 0.0
-0001f920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f930: 2020 2020 2073 656c 662e 7820 3d20 302e       self.x = 0.
-0001f940: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
-0001f950: 2020 2020 2020 7365 6c66 2e79 203d 2030        self.y = 0
-0001f960: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-0001f970: 2020 2020 2020 2073 656c 662e 7a20 3d20         self.z = 
-0001f980: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-0001f990: 2020 2020 656c 6966 2073 6571 6c65 6e3d      elif seqlen=
-0001f9a0: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
-0001f9b0: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
-0001f9c0: 2073 6571 5b30 5d0a 2020 2020 2020 2020   seq[0].        
-0001f9d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001f9e0: 2e78 203d 2030 2e30 0a20 2020 2020 2020  .x = 0.0.       
-0001f9f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001fa00: 662e 7920 3d20 302e 300a 2020 2020 2020  f.y = 0.0.      
-0001fa10: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001fa20: 6c66 2e7a 203d 2030 2e30 0a20 2020 2020  lf.z = 0.0.     
-0001fa30: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0001fa40: 7365 716c 656e 3d3d 343a 0a20 2020 2020  seqlen==4:.     
-0001fa50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001fa60: 656c 662e 7720 3d20 7365 715b 305d 0a20  elf.w = seq[0]. 
-0001fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fa80: 2020 2073 656c 662e 7820 3d20 7365 715b     self.x = seq[
-0001fa90: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
-0001faa0: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
-0001fab0: 7365 715b 325d 0a20 2020 2020 2020 2020  seq[2].         
-0001fac0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001fad0: 7a20 3d20 7365 715b 335d 0a20 2020 2020  z = seq[3].     
-0001fae0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001faf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fb00: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0001fb10: 7272 6f72 2c20 2271 7561 7428 2920 6172  rror, "quat() ar
-0001fb20: 6720 6361 6e27 7420 6265 2063 6f6e 7665  g can't be conve
-0001fb30: 7274 6564 2074 6f20 7175 6174 220a 0a20  rted to quat".. 
-0001fb40: 2020 2020 2020 2023 2032 2061 7267 756d         # 2 argum
-0001fb50: 656e 7473 2028 616e 676c 6520 2620 6178  ents (angle & ax
-0001fb60: 6973 290a 2020 2020 2020 2020 656c 6966  is).        elif
-0001fb70: 2061 7267 6c65 6e3d 3d32 3a0a 2020 2020   arglen==2:.    
-0001fb80: 2020 2020 2020 2020 616e 676c 652c 2061          angle, a
-0001fb90: 7869 7320 3d20 6172 6773 0a20 2020 2020  xis = args.     
-0001fba0: 2020 2020 2020 2073 656c 662e 6672 6f6d         self.from
-0001fbb0: 416e 676c 6541 7869 7328 616e 676c 652c  AngleAxis(angle,
-0001fbc0: 6178 6973 290a 0a20 2020 2020 2020 2023  axis)..        #
-0001fbd0: 2034 2061 7267 756d 656e 7473 0a20 2020   4 arguments.   
-0001fbe0: 2020 2020 2065 6c69 6620 6172 676c 656e       elif arglen
-0001fbf0: 3d3d 343a 0a20 2020 2020 2020 2020 2020  ==4:.           
-0001fc00: 2073 656c 662e 7720 3d20 6172 6773 5b30   self.w = args[0
-0001fc10: 5d0a 2020 2020 2020 2020 2020 2020 7365  ].            se
-0001fc20: 6c66 2e78 203d 2061 7267 735b 315d 0a20  lf.x = args[1]. 
-0001fc30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001fc40: 7920 3d20 6172 6773 5b32 5d0a 2020 2020  y = args[2].    
-0001fc50: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
-0001fc60: 2061 7267 735b 335d 0a0a 2020 2020 2020   args[3]..      
-0001fc70: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001fc80: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-0001fc90: 726f 722c 2022 7175 6174 2829 2061 7267  ror, "quat() arg
-0001fca0: 2063 616e 2774 2062 6520 636f 6e76 6572   can't be conver
-0001fcb0: 7465 6420 746f 2071 7561 7422 0a0a 2020  ted to quat"..  
-0001fcc0: 2020 6465 6620 5f5f 7265 6475 6365 5f5f    def __reduce__
-0001fcd0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001fce0: 7265 7475 726e 2028 5f71 7561 7463 6f6e  return (_quatcon
-0001fcf0: 7374 7275 6374 2c20 2873 656c 662e 772c  struct, (self.w,
-0001fd00: 2073 656c 662e 782c 2073 656c 662e 792c   self.x, self.y,
-0001fd10: 2073 656c 662e 7a29 290a 0a20 2020 2064   self.z))..    d
-0001fd20: 6566 205f 5f72 6570 725f 5f28 7365 6c66  ef __repr__(self
-0001fd30: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0001fd40: 6e20 2771 7561 7428 2573 2c20 2573 2c20  n 'quat(%s, %s, 
-0001fd50: 2573 2c20 2573 2927 2528 7265 7072 2873  %s, %s)'%(repr(s
-0001fd60: 656c 662e 7729 2c72 6570 7228 7365 6c66  elf.w),repr(self
-0001fd70: 2e78 292c 7265 7072 2873 656c 662e 7929  .x),repr(self.y)
-0001fd80: 2c72 6570 7228 7365 6c66 2e7a 2929 0a0a  ,repr(self.z))..
-0001fd90: 2020 2020 6465 6620 5f5f 7374 725f 5f28      def __str__(
-0001fda0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-0001fdb0: 6574 7572 6e20 2228 2531 2e34 662c 2025  eturn "(%1.4f, %
-0001fdc0: 312e 3466 2c20 2531 2e34 662c 2025 312e  1.4f, %1.4f, %1.
-0001fdd0: 3466 2922 2528 7365 6c66 2e77 2c20 7365  4f)"%(self.w, se
-0001fde0: 6c66 2e78 2c20 7365 6c66 2e79 2c20 7365  lf.x, self.y, se
-0001fdf0: 6c66 2e7a 290a 0a0a 2020 2020 6465 6620  lf.z)...    def 
-0001fe00: 5f5f 7269 6368 636d 705f 5f28 612c 622c  __richcmp__(a,b,
-0001fe10: 6f70 293a 0a20 2020 2020 2020 2063 6465  op):.        cde
-0001fe20: 6620 7175 6174 2076 612c 2076 620a 2020  f quat va, vb.  
-0001fe30: 2020 2020 2020 6364 6566 2069 6e74 2063        cdef int c
-0001fe40: 6f70 0a0a 2020 2020 2020 2020 636f 7020  op..        cop 
-0001fe50: 3d20 6f70 0a0a 2020 2020 2020 2020 7461  = op..        ta
-0001fe60: 203d 2074 7970 6528 6129 0a20 2020 2020   = type(a).     
-0001fe70: 2020 2074 6220 3d20 7479 7065 2862 290a     tb = type(b).
-0001fe80: 2020 2020 2020 2020 6966 2028 7461 213d          if (ta!=
-0001fe90: 7175 6174 206f 7220 7462 213d 7175 6174  quat or tb!=quat
-0001fea0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-0001feb0: 6620 636f 703d 3d33 3a0a 2020 2020 2020  f cop==3:.      
-0001fec0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001fed0: 2031 0a20 2020 2020 2020 2020 2020 2065   1.            e
-0001fee0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001fef0: 2020 2020 2072 6574 7572 6e20 300a 0a20       return 0.. 
-0001ff00: 2020 2020 2020 2076 6120 3d20 610a 2020         va = a.  
-0001ff10: 2020 2020 2020 7662 203d 2062 0a0a 2020        vb = b..  
-0001ff20: 2020 2020 2020 2320 3c0a 2020 2020 2020        # <.      
-0001ff30: 2020 6966 2063 6f70 3d3d 303a 0a20 2020    if cop==0:.   
-0001ff40: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001ff50: 300a 2020 2020 2020 2020 2320 3c3d 0a20  0.        # <=. 
-0001ff60: 2020 2020 2020 2065 6c69 6620 636f 703d         elif cop=
-0001ff70: 3d31 3a0a 2020 2020 2020 2020 2020 2020  =1:.            
-0001ff80: 7265 7475 726e 2030 0a20 2020 2020 2020  return 0.       
-0001ff90: 2023 203d 3d0a 2020 2020 2020 2020 656c   # ==.        el
-0001ffa0: 6966 2063 6f70 3d3d 323a 0a20 2020 2020  if cop==2:.     
-0001ffb0: 2020 2020 2020 2072 6574 7572 6e20 2866         return (f
-0001ffc0: 6162 7328 7661 2e77 2d76 622e 7729 3c3d  abs(va.w-vb.w)<=
-0001ffd0: 6570 7320 616e 6420 6661 6273 2876 612e  eps and fabs(va.
-0001ffe0: 782d 7662 2e78 293c 3d65 7073 2061 6e64  x-vb.x)<=eps and
-0001fff0: 2066 6162 7328 7661 2e79 2d76 622e 7929   fabs(va.y-vb.y)
-00020000: 3c3d 6570 7320 616e 6420 6661 6273 2876  <=eps and fabs(v
-00020010: 612e 7a2d 7662 2e7a 293c 3d65 7073 290a  a.z-vb.z)<=eps).
-00020020: 2020 2020 2020 2020 2320 213d 0a20 2020          # !=.   
-00020030: 2020 2020 2065 6c69 6620 636f 703d 3d33       elif cop==3
-00020040: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00020050: 7475 726e 2028 6661 6273 2876 612e 772d  turn (fabs(va.w-
-00020060: 7662 2e77 293e 6570 7320 6f72 2066 6162  vb.w)>eps or fab
-00020070: 7328 7661 2e78 2d76 622e 7829 3e65 7073  s(va.x-vb.x)>eps
-00020080: 206f 7220 6661 6273 2876 612e 792d 7662   or fabs(va.y-vb
-00020090: 2e79 293e 6570 7320 616e 6420 6661 6273  .y)>eps and fabs
-000200a0: 2876 612e 7a2d 7662 2e7a 293e 6570 7329  (va.z-vb.z)>eps)
-000200b0: 0a20 2020 2020 2020 2023 203e 0a20 2020  .        # >.   
-000200c0: 2020 2020 2065 6c69 6620 636f 703d 3d34       elif cop==4
-000200d0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-000200e0: 7475 726e 2030 0a20 2020 2020 2020 2023  turn 0.        #
-000200f0: 203e 3d0a 2020 2020 2020 2020 656c 6966   >=.        elif
-00020100: 2063 6f70 3d3d 353a 0a20 2020 2020 2020   cop==5:.       
-00020110: 2020 2020 2072 6574 7572 6e20 300a 2020       return 0.  
-00020120: 2020 2020 2020 2320 736f 6e73 7420 2846        # sonst (F
-00020130: 6568 6c65 7229 0a20 2020 2020 2020 2065  ehler).        e
-00020140: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00020150: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00020160: 722c 2269 6e74 6572 6e61 6c20 6572 726f  r,"internal erro
-00020170: 723a 2069 6c6c 6567 616c 2072 6963 6820  r: illegal rich 
-00020180: 636f 6d70 6172 6973 6f6e 206e 756d 6265  comparison numbe
-00020190: 7222 0a0a 2020 2020 6465 6620 5f5f 6164  r"..    def __ad
-000201a0: 645f 5f28 7175 6174 2061 2c20 7175 6174  d__(quat a, quat
-000201b0: 2062 293a 0a20 2020 2020 2020 2022 2222   b):.        """
-000201c0: 4164 6469 7469 6f6e 2e0a 0a20 2020 2020  Addition...     
-000201d0: 2020 203e 3e3e 2071 3d71 7561 7428 302e     >>> q=quat(0.
-000201e0: 3936 3839 2c20 302e 3231 3630 2c20 302e  9689, 0.2160, 0.
-000201f0: 3130 3830 2c20 302e 3035 3430 290a 2020  1080, 0.0540).  
-00020200: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
-00020210: 712b 710a 2020 2020 2020 2020 2831 2e39  q+q.        (1.9
-00020220: 3337 382c 2030 2e34 3332 302c 2030 2e32  378, 0.4320, 0.2
-00020230: 3136 302c 2030 2e31 3038 3029 0a20 2020  160, 0.1080).   
-00020240: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00020250: 2063 6465 6620 7175 6174 2072 6573 0a20   cdef quat res. 
-00020260: 2020 2020 2020 2072 6573 203d 2071 7561         res = qua
-00020270: 7428 290a 2020 2020 2020 2020 7265 732e  t().        res.
-00020280: 7720 3d20 612e 772b 622e 770a 2020 2020  w = a.w+b.w.    
-00020290: 2020 2020 7265 732e 7820 3d20 612e 782b      res.x = a.x+
-000202a0: 622e 780a 2020 2020 2020 2020 7265 732e  b.x.        res.
-000202b0: 7920 3d20 612e 792b 622e 790a 2020 2020  y = a.y+b.y.    
-000202c0: 2020 2020 7265 732e 7a20 3d20 612e 7a2b      res.z = a.z+
-000202d0: 622e 7a0a 2020 2020 2020 2020 7265 7475  b.z.        retu
-000202e0: 726e 2072 6573 0a0a 2020 2020 6465 6620  rn res..    def 
-000202f0: 5f5f 7375 625f 5f28 7175 6174 2061 2c20  __sub__(quat a, 
-00020300: 7175 6174 2062 293a 0a20 2020 2020 2020  quat b):.       
-00020310: 2022 2222 5375 6274 7261 6374 696f 6e2e   """Subtraction.
-00020320: 0a0a 2020 2020 2020 2020 3e3e 3e20 713d  ..        >>> q=
-00020330: 7175 6174 2830 2e39 3638 392c 2030 2e32  quat(0.9689, 0.2
-00020340: 3136 302c 2030 2e31 3038 302c 2030 2e30  160, 0.1080, 0.0
-00020350: 3534 3029 0a20 2020 2020 2020 203e 3e3e  540).        >>>
-00020360: 2070 7269 6e74 2071 2d71 0a20 2020 2020   print q-q.     
-00020370: 2020 2028 302e 3030 3030 2c20 302e 3030     (0.0000, 0.00
-00020380: 3030 2c20 302e 3030 3030 2c20 302e 3030  00, 0.0000, 0.00
-00020390: 3030 290a 2020 2020 2020 2020 2222 220a  00).        """.
-000203a0: 2020 2020 2020 2020 6364 6566 2071 7561          cdef qua
-000203b0: 7420 7265 730a 2020 2020 2020 2020 7265  t res.        re
-000203c0: 7320 3d20 7175 6174 2829 0a20 2020 2020  s = quat().     
-000203d0: 2020 2072 6573 2e77 203d 2061 2e77 2d62     res.w = a.w-b
-000203e0: 2e77 0a20 2020 2020 2020 2072 6573 2e78  .w.        res.x
-000203f0: 203d 2061 2e78 2d62 2e78 0a20 2020 2020   = a.x-b.x.     
-00020400: 2020 2072 6573 2e79 203d 2061 2e79 2d62     res.y = a.y-b
-00020410: 2e79 0a20 2020 2020 2020 2072 6573 2e7a  .y.        res.z
-00020420: 203d 2061 2e7a 2d62 2e7a 0a20 2020 2020   = a.z-b.z.     
-00020430: 2020 2072 6574 7572 6e20 7265 730a 0a20     return res.. 
-00020440: 2020 2064 6566 205f 5f6d 756c 5f5f 2861     def __mul__(a
-00020450: 2c20 6229 3a0a 2020 2020 2020 2020 2222  , b):.        ""
-00020460: 224d 756c 7469 706c 6963 6174 696f 6e2e  "Multiplication.
-00020470: 0a0a 2020 2020 2020 2020 3e3e 3e20 713d  ..        >>> q=
-00020480: 7175 6174 2830 2e39 3638 392c 2030 2e32  quat(0.9689, 0.2
-00020490: 3136 302c 2030 2e31 3038 302c 2030 2e30  160, 0.1080, 0.0
-000204a0: 3534 3029 0a20 2020 2020 2020 203e 3e3e  540).        >>>
-000204b0: 2070 7269 6e74 2071 2a32 2e30 0a20 2020   print q*2.0.   
-000204c0: 2020 2020 2028 312e 3933 3738 2c20 302e       (1.9378, 0.
-000204d0: 3433 3230 2c20 302e 3231 3630 2c20 302e  4320, 0.2160, 0.
-000204e0: 3130 3830 290a 2020 2020 2020 2020 3e3e  1080).        >>
-000204f0: 3e20 7072 696e 7420 322e 302a 710a 2020  > print 2.0*q.  
-00020500: 2020 2020 2020 2831 2e39 3337 382c 2030        (1.9378, 0
-00020510: 2e34 3332 302c 2030 2e32 3136 302c 2030  .4320, 0.2160, 0
-00020520: 2e31 3038 3029 0a20 2020 2020 2020 203e  .1080).        >
-00020530: 3e3e 2070 7269 6e74 2071 2a71 0a20 2020  >> print q*q.   
-00020540: 2020 2020 2028 302e 3837 3735 2c20 302e       (0.8775, 0.
-00020550: 3431 3836 2c20 302e 3230 3933 2c20 302e  4186, 0.2093, 0.
-00020560: 3130 3436 290a 2020 2020 2020 2020 2222  1046).        ""
-00020570: 220a 2020 2020 2020 2020 6364 6566 2071  ".        cdef q
-00020580: 7561 7420 7265 732c 2076 612c 2076 620a  uat res, va, vb.
-00020590: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
-000205a0: 626c 6520 720a 0a20 2020 2020 2020 2074  ble r..        t
-000205b0: 6120 3d20 7479 7065 2861 290a 2020 2020  a = type(a).    
-000205c0: 2020 2020 7462 203d 2074 7970 6528 6229      tb = type(b)
-000205d0: 0a0a 2020 2020 2020 2020 6966 2074 6120  ..        if ta 
-000205e0: 6973 2071 7561 743a 0a20 2020 2020 2020  is quat:.       
-000205f0: 2020 2020 2076 6120 3d20 610a 2020 2020       va = a.    
-00020600: 2020 2020 2020 2020 6966 2074 6220 6973          if tb is
-00020610: 2071 7561 743a 0a20 2020 2020 2020 2020   quat:.         
-00020620: 2020 2020 2020 2023 2071 7561 742a 7175         # quat*qu
-00020630: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
-00020640: 2020 2076 6220 3d20 620a 2020 2020 2020     vb = b.      
-00020650: 2020 2020 2020 2020 2020 7265 7320 3d20            res = 
-00020660: 7175 6174 2829 0a20 2020 2020 2020 2020  quat().         
-00020670: 2020 2020 2020 2072 6573 2e77 203d 2076         res.w = v
-00020680: 612e 772a 7662 2e77 202d 2076 612e 782a  a.w*vb.w - va.x*
-00020690: 7662 2e78 202d 2076 612e 792a 7662 2e79  vb.x - va.y*vb.y
-000206a0: 202d 2076 612e 7a2a 7662 2e7a 0a20 2020   - va.z*vb.z.   
-000206b0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-000206c0: 2e78 203d 2076 612e 772a 7662 2e78 202b  .x = va.w*vb.x +
-000206d0: 2076 612e 782a 7662 2e77 202b 2076 612e   va.x*vb.w + va.
-000206e0: 792a 7662 2e7a 202d 2076 612e 7a2a 7662  y*vb.z - va.z*vb
-000206f0: 2e79 0a20 2020 2020 2020 2020 2020 2020  .y.             
-00020700: 2020 2072 6573 2e79 203d 2076 612e 772a     res.y = va.w*
-00020710: 7662 2e79 202b 2076 612e 792a 7662 2e77  vb.y + va.y*vb.w
-00020720: 202d 2076 612e 782a 7662 2e7a 202b 2076   - va.x*vb.z + v
-00020730: 612e 7a2a 7662 2e78 0a20 2020 2020 2020  a.z*vb.x.       
-00020740: 2020 2020 2020 2020 2072 6573 2e7a 203d           res.z =
-00020750: 2076 612e 772a 7662 2e7a 202b 2076 612e   va.w*vb.z + va.
-00020760: 7a2a 7662 2e77 202b 2076 612e 782a 7662  z*vb.w + va.x*vb
-00020770: 2e79 202d 2076 612e 792a 7662 2e78 0a20  .y - va.y*vb.x. 
-00020780: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00020790: 6574 7572 6e20 7265 730a 2020 2020 2020  eturn res.      
-000207a0: 2020 2020 2020 656c 6966 2074 6220 6973        elif tb is
-000207b0: 2066 6c6f 6174 206f 7220 7462 2069 7320   float or tb is 
-000207c0: 696e 7420 6f72 2074 6220 6973 206c 6f6e  int or tb is lon
-000207d0: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
-000207e0: 2020 2023 2071 7561 742a 7363 616c 6172     # quat*scalar
-000207f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020800: 2072 6573 203d 2071 7561 7428 290a 2020   res = quat().  
-00020810: 2020 2020 2020 2020 2020 2020 2020 7220                r 
-00020820: 2020 3d20 620a 2020 2020 2020 2020 2020    = b.          
-00020830: 2020 2020 2020 7265 732e 7720 3d20 7661        res.w = va
-00020840: 2e77 2a72 0a20 2020 2020 2020 2020 2020  .w*r.           
-00020850: 2020 2020 2072 6573 2e78 203d 2076 612e       res.x = va.
-00020860: 782a 720a 2020 2020 2020 2020 2020 2020  x*r.            
-00020870: 2020 2020 7265 732e 7920 3d20 7661 2e79      res.y = va.y
-00020880: 2a72 0a20 2020 2020 2020 2020 2020 2020  *r.             
-00020890: 2020 2072 6573 2e7a 203d 2076 612e 7a2a     res.z = va.z*
-000208a0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-000208b0: 2020 7265 7475 726e 2072 6573 0a20 2020    return res.   
-000208c0: 2020 2020 2065 6c69 6620 7461 2069 7320       elif ta is 
-000208d0: 666c 6f61 7420 6f72 2074 6120 6973 2069  float or ta is i
-000208e0: 6e74 206f 7220 7461 2069 7320 6c6f 6e67  nt or ta is long
-000208f0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00020900: 2074 6220 6973 2071 7561 743a 0a20 2020   tb is quat:.   
-00020910: 2020 2020 2020 2020 2020 2020 2023 2073               # s
-00020920: 6361 6c61 722a 7175 6174 0a20 2020 2020  calar*quat.     
-00020930: 2020 2020 2020 2020 2020 2072 6573 203d             res =
-00020940: 2071 7561 7428 290a 2020 2020 2020 2020   quat().        
-00020950: 2020 2020 2020 2020 7662 2020 3d20 620a          vb  = b.
-00020960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020970: 7220 2020 3d20 610a 2020 2020 2020 2020  r   = a.        
-00020980: 2020 2020 2020 2020 7265 732e 7720 3d20          res.w = 
-00020990: 722a 7662 2e77 0a20 2020 2020 2020 2020  r*vb.w.         
-000209a0: 2020 2020 2020 2072 6573 2e78 203d 2072         res.x = r
-000209b0: 2a76 622e 780a 2020 2020 2020 2020 2020  *vb.x.          
-000209c0: 2020 2020 2020 7265 732e 7920 3d20 722a        res.y = r*
-000209d0: 7662 2e79 0a20 2020 2020 2020 2020 2020  vb.y.           
-000209e0: 2020 2020 2072 6573 2e7a 203d 2072 2a76       res.z = r*v
-000209f0: 622e 7a0a 2020 2020 2020 2020 2020 2020  b.z.            
-00020a00: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
-00020a10: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00020a20: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
-00020a30: 6f72 7465 6420 6f70 6572 616e 6420 7479  orted operand ty
-00020a40: 7065 2066 6f72 202a 220a 0a20 2020 2064  pe for *"..    d
-00020a50: 6566 205f 5f64 6976 5f5f 2871 7561 7420  ef __div__(quat 
-00020a60: 612c 2062 293a 0a20 2020 2020 2020 2022  a, b):.        "
-00020a70: 2222 4469 7669 7369 6f6e 2e0a 0a20 2020  ""Division...   
-00020a80: 2020 2020 203e 3e3e 2071 3d71 7561 7428       >>> q=quat(
-00020a90: 302e 3936 3839 2c20 302e 3231 3630 2c20  0.9689, 0.2160, 
-00020aa0: 302e 3130 3830 2c20 302e 3035 3430 290a  0.1080, 0.0540).
-00020ab0: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00020ac0: 7420 712f 322e 300a 2020 2020 2020 2020  t q/2.0.        
-00020ad0: 2830 2e34 3834 342c 2030 2e31 3038 302c  (0.4844, 0.1080,
-00020ae0: 2030 2e30 3534 302c 2030 2e30 3237 3029   0.0540, 0.0270)
-00020af0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00020b00: 2020 2020 2063 6465 6620 7175 6174 2072       cdef quat r
-00020b10: 6573 0a20 2020 2020 2020 2063 6465 6620  es.        cdef 
-00020b20: 646f 7562 6c65 2072 0a0a 2020 2020 2020  double r..      
-00020b30: 2020 7462 203d 2074 7970 6528 6229 0a0a    tb = type(b)..
-00020b40: 2020 2020 2020 2020 6966 2074 6220 6973          if tb is
-00020b50: 2066 6c6f 6174 206f 7220 7462 2069 7320   float or tb is 
-00020b60: 696e 7420 6f72 2074 6220 6973 206c 6f6e  int or tb is lon
-00020b70: 673a 0a20 2020 2020 2020 2020 2020 2023  g:.            #
-00020b80: 2071 7561 742f 7363 616c 6172 0a20 2020   quat/scalar.   
-00020b90: 2020 2020 2020 2020 2072 6573 203d 2071           res = q
-00020ba0: 7561 7428 290a 2020 2020 2020 2020 2020  uat().          
-00020bb0: 2020 7220 3d20 620a 2020 2020 2020 2020    r = b.        
-00020bc0: 2020 2020 6966 2066 6162 7328 7229 3c3d      if fabs(r)<=
-00020bd0: 6570 733a 0a20 2020 2020 2020 2020 2020  eps:.           
-00020be0: 2020 2020 2072 6169 7365 205a 6572 6f44       raise ZeroD
-00020bf0: 6976 6973 696f 6e45 7272 6f72 2c22 7175  ivisionError,"qu
-00020c00: 6174 2064 6976 6973 696f 6e22 0a20 2020  at division".   
-00020c10: 2020 2020 2020 2020 2072 6573 2e77 203d           res.w =
-00020c20: 2061 2e77 2f72 0a20 2020 2020 2020 2020   a.w/r.         
-00020c30: 2020 2072 6573 2e78 203d 2061 2e78 2f72     res.x = a.x/r
-00020c40: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00020c50: 2e79 203d 2061 2e79 2f72 0a20 2020 2020  .y = a.y/r.     
-00020c60: 2020 2020 2020 2072 6573 2e7a 203d 2061         res.z = a
-00020c70: 2e7a 2f72 0a20 2020 2020 2020 2020 2020  .z/r.           
-00020c80: 2072 6574 7572 6e20 7265 730a 2020 2020   return res.    
-00020c90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00020ca0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00020cb0: 4572 726f 722c 2022 756e 7375 7070 6f72  Error, "unsuppor
-00020cc0: 7465 6420 6f70 6572 616e 6420 7479 7065  ted operand type
-00020cd0: 2066 6f72 202f 220a 0a20 2020 2064 6566   for /"..    def
-00020ce0: 205f 5f70 6f77 5f5f 2871 7561 7420 7365   __pow__(quat se
-00020cf0: 6c66 2c20 6f74 6865 722c 206d 6f64 756c  lf, other, modul
-00020d00: 6f29 3a0a 2020 2020 2020 2020 2222 2252  o):.        """R
-00020d10: 6574 7572 6e20 7365 6c66 2a2a 712e 2222  eturn self**q.""
-00020d20: 220a 2020 2020 2020 2020 6364 6566 2071  ".        cdef q
-00020d30: 7561 7420 710a 2020 2020 2020 2020 6966  uat q.        if
-00020d40: 206d 6f64 756c 6f21 3d4e 6f6e 653a 0a20   modulo!=None:. 
-00020d50: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00020d60: 2054 7970 6545 7272 6f72 2c20 2275 6e73   TypeError, "uns
-00020d70: 7570 706f 7274 6564 206f 7065 7261 7469  upported operati
-00020d80: 6f6e 220a 2020 2020 2020 2020 7120 3d20  on".        q = 
-00020d90: 7175 6174 286f 7468 6572 290a 2020 2020  quat(other).    
-00020da0: 2020 2020 7265 7475 726e 2028 712a 7365      return (q*se
-00020db0: 6c66 2e6c 6f67 2829 292e 6578 7028 290a  lf.log()).exp().
-00020dc0: 0a20 2020 2064 6566 205f 5f6e 6567 5f5f  .    def __neg__
-00020dd0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00020de0: 2222 224e 6567 6174 696f 6e2e 0a0a 2020  """Negation...  
-00020df0: 2020 2020 2020 3e3e 3e20 713d 7175 6174        >>> q=quat
-00020e00: 2830 2e39 3638 392c 2030 2e32 3136 302c  (0.9689, 0.2160,
-00020e10: 2030 2e31 3038 302c 2030 2e30 3534 3029   0.1080, 0.0540)
-00020e20: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
-00020e30: 6e74 202d 710a 2020 2020 2020 2020 282d  nt -q.        (-
-00020e40: 302e 3936 3839 2c20 2d30 2e32 3136 302c  0.9689, -0.2160,
-00020e50: 202d 302e 3130 3830 2c20 2d30 2e30 3534   -0.1080, -0.054
-00020e60: 3029 0a20 2020 2020 2020 2022 2222 0a20  0).        """. 
-00020e70: 2020 2020 2020 2063 6465 6620 7175 6174         cdef quat
-00020e80: 2072 6573 0a20 2020 2020 2020 2072 6573   res.        res
-00020e90: 203d 2071 7561 7428 290a 2020 2020 2020   = quat().      
-00020ea0: 2020 7265 732e 7720 3d20 2d73 656c 662e    res.w = -self.
-00020eb0: 770a 2020 2020 2020 2020 7265 732e 7820  w.        res.x 
-00020ec0: 3d20 2d73 656c 662e 780a 2020 2020 2020  = -self.x.      
-00020ed0: 2020 7265 732e 7920 3d20 2d73 656c 662e    res.y = -self.
-00020ee0: 790a 2020 2020 2020 2020 7265 732e 7a20  y.        res.z 
-00020ef0: 3d20 2d73 656c 662e 7a0a 2020 2020 2020  = -self.z.      
-00020f00: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
-00020f10: 2020 6465 6620 5f5f 706f 735f 5f28 7365    def __pos__(se
-00020f20: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00020f30: 0a20 2020 2020 2020 203e 3e3e 2071 3d71  .        >>> q=q
-00020f40: 7561 7428 302e 3936 3839 2c20 302e 3231  uat(0.9689, 0.21
-00020f50: 3630 2c20 302e 3130 3830 2c20 302e 3035  60, 0.1080, 0.05
-00020f60: 3430 290a 2020 2020 2020 2020 3e3e 3e20  40).        >>> 
-00020f70: 7072 696e 7420 2b71 0a20 2020 2020 2020  print +q.       
-00020f80: 2028 302e 3936 3839 2c20 302e 3231 3630   (0.9689, 0.2160
-00020f90: 2c20 302e 3130 3830 2c20 302e 3035 3430  , 0.1080, 0.0540
-00020fa0: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
-00020fb0: 2020 2020 2020 6364 6566 2071 7561 7420        cdef quat 
-00020fc0: 7265 730a 2020 2020 2020 2020 7265 7320  res.        res 
-00020fd0: 3d20 7175 6174 2829 0a20 2020 2020 2020  = quat().       
-00020fe0: 2072 6573 2e77 203d 2073 656c 662e 770a   res.w = self.w.
-00020ff0: 2020 2020 2020 2020 7265 732e 7820 3d20          res.x = 
-00021000: 7365 6c66 2e78 0a20 2020 2020 2020 2072  self.x.        r
-00021010: 6573 2e79 203d 2073 656c 662e 790a 2020  es.y = self.y.  
-00021020: 2020 2020 2020 7265 732e 7a20 3d20 7365        res.z = se
-00021030: 6c66 2e7a 0a20 2020 2020 2020 2072 6574  lf.z.        ret
-00021040: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
-00021050: 205f 5f69 6164 645f 5f28 7365 6c66 2c20   __iadd__(self, 
-00021060: 7175 6174 206f 7468 6572 293a 0a20 2020  quat other):.   
-00021070: 2020 2020 2022 2222 496e 6c69 6e65 2071       """Inline q
-00021080: 7561 7465 726e 696f 6e20 6164 6469 7469  uaternion additi
-00021090: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
-000210a0: 2020 2020 2020 2020 7365 6c66 2e77 3d73          self.w=s
-000210b0: 656c 662e 772b 6f74 6865 722e 770a 2020  elf.w+other.w.  
-000210c0: 2020 2020 2020 7365 6c66 2e78 3d73 656c        self.x=sel
-000210d0: 662e 782b 6f74 6865 722e 780a 2020 2020  f.x+other.x.    
-000210e0: 2020 2020 7365 6c66 2e79 3d73 656c 662e      self.y=self.
-000210f0: 792b 6f74 6865 722e 790a 2020 2020 2020  y+other.y.      
-00021100: 2020 7365 6c66 2e7a 3d73 656c 662e 7a2b    self.z=self.z+
-00021110: 6f74 6865 722e 7a0a 2020 2020 2020 2020  other.z.        
-00021120: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
-00021130: 2064 6566 205f 5f69 7375 625f 5f28 7365   def __isub__(se
-00021140: 6c66 2c20 7175 6174 206f 7468 6572 293a  lf, quat other):
-00021150: 0a20 2020 2020 2020 2022 2222 496e 6c69  .        """Inli
-00021160: 6e65 2071 7561 7465 726e 696f 6e20 7375  ne quaternion su
-00021170: 6274 7261 6374 696f 6e2e 0a20 2020 2020  btraction..     
-00021180: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
-00021190: 656c 662e 773d 7365 6c66 2e77 2d6f 7468  elf.w=self.w-oth
-000211a0: 6572 2e77 0a20 2020 2020 2020 2073 656c  er.w.        sel
-000211b0: 662e 783d 7365 6c66 2e78 2d6f 7468 6572  f.x=self.x-other
-000211c0: 2e78 0a20 2020 2020 2020 2073 656c 662e  .x.        self.
-000211d0: 793d 7365 6c66 2e79 2d6f 7468 6572 2e79  y=self.y-other.y
-000211e0: 0a20 2020 2020 2020 2073 656c 662e 7a3d  .        self.z=
-000211f0: 7365 6c66 2e7a 2d6f 7468 6572 2e7a 0a20  self.z-other.z. 
-00021200: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00021210: 6c66 0a0a 2020 2020 6465 6620 5f5f 696d  lf..    def __im
-00021220: 756c 5f5f 2873 656c 662c 206f 7468 6572  ul__(self, other
-00021230: 293a 0a20 2020 2020 2020 2022 2222 496e  ):.        """In
-00021240: 6c69 6e65 206d 756c 7469 706c 6963 6174  line multiplicat
-00021250: 696f 6e2e 0a20 2020 2020 2020 2022 2222  ion..        """
-00021260: 0a20 2020 2020 2020 2063 6465 6620 7175  .        cdef qu
-00021270: 6174 2076 620a 2020 2020 2020 2020 6364  at vb.        cd
-00021280: 6566 2064 6f75 626c 6520 720a 2020 2020  ef double r.    
-00021290: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
-000212a0: 772c 782c 792c 7a0a 0a20 2020 2020 2020  w,x,y,z..       
-000212b0: 2054 203d 2074 7970 6528 6f74 6865 7229   T = type(other)
-000212c0: 0a0a 2020 2020 2020 2020 6966 2054 2069  ..        if T i
-000212d0: 7320 7175 6174 3a0a 2020 2020 2020 2020  s quat:.        
-000212e0: 2020 2020 2320 7175 6174 2a3d 7175 6174      # quat*=quat
-000212f0: 0a20 2020 2020 2020 2020 2020 2076 6220  .            vb 
-00021300: 3d20 6f74 6865 720a 2020 2020 2020 2020  = other.        
-00021310: 2020 2020 7720 3d20 7365 6c66 2e77 2a76      w = self.w*v
-00021320: 622e 7720 2d20 7365 6c66 2e78 2a76 622e  b.w - self.x*vb.
-00021330: 7820 2d20 7365 6c66 2e79 2a76 622e 7920  x - self.y*vb.y 
-00021340: 2d20 7365 6c66 2e7a 2a76 622e 7a0a 2020  - self.z*vb.z.  
-00021350: 2020 2020 2020 2020 2020 7820 3d20 7365            x = se
-00021360: 6c66 2e77 2a76 622e 7820 2b20 7365 6c66  lf.w*vb.x + self
-00021370: 2e78 2a76 622e 7720 2b20 7365 6c66 2e79  .x*vb.w + self.y
-00021380: 2a76 622e 7a20 2d20 7365 6c66 2e7a 2a76  *vb.z - self.z*v
-00021390: 622e 790a 2020 2020 2020 2020 2020 2020  b.y.            
-000213a0: 7920 3d20 7365 6c66 2e77 2a76 622e 7920  y = self.w*vb.y 
-000213b0: 2b20 7365 6c66 2e79 2a76 622e 7720 2d20  + self.y*vb.w - 
-000213c0: 7365 6c66 2e78 2a76 622e 7a20 2b20 7365  self.x*vb.z + se
-000213d0: 6c66 2e7a 2a76 622e 780a 2020 2020 2020  lf.z*vb.x.      
-000213e0: 2020 2020 2020 7a20 3d20 7365 6c66 2e77        z = self.w
-000213f0: 2a76 622e 7a20 2b20 7365 6c66 2e7a 2a76  *vb.z + self.z*v
-00021400: 622e 7720 2b20 7365 6c66 2e78 2a76 622e  b.w + self.x*vb.
-00021410: 7920 2d20 7365 6c66 2e79 2a76 622e 780a  y - self.y*vb.x.
-00021420: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00021430: 2e77 203d 2077 0a20 2020 2020 2020 2020  .w = w.         
-00021440: 2020 2073 656c 662e 7820 3d20 780a 2020     self.x = x.  
-00021450: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
-00021460: 203d 2079 0a20 2020 2020 2020 2020 2020   = y.           
-00021470: 2073 656c 662e 7a20 3d20 7a0a 2020 2020   self.z = z.    
-00021480: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00021490: 656c 660a 0a20 2020 2020 2020 2065 6c69  elf..        eli
-000214a0: 6620 5420 6973 2066 6c6f 6174 206f 7220  f T is float or 
-000214b0: 5420 6973 2069 6e74 206f 7220 5420 6973  T is int or T is
-000214c0: 206c 6f6e 673a 0a20 2020 2020 2020 2020   long:.         
-000214d0: 2020 2023 2071 7561 742a 3d73 6361 6c61     # quat*=scala
-000214e0: 720a 2020 2020 2020 2020 2020 2020 7220  r.            r 
-000214f0: 2020 3d20 6f74 6865 720a 2020 2020 2020    = other.      
-00021500: 2020 2020 2020 7365 6c66 2e77 203d 2073        self.w = s
-00021510: 656c 662e 772a 720a 2020 2020 2020 2020  elf.w*r.        
-00021520: 2020 2020 7365 6c66 2e78 203d 2073 656c      self.x = sel
-00021530: 662e 782a 720a 2020 2020 2020 2020 2020  f.x*r.          
-00021540: 2020 7365 6c66 2e79 203d 2073 656c 662e    self.y = self.
-00021550: 792a 720a 2020 2020 2020 2020 2020 2020  y*r.            
-00021560: 7365 6c66 2e7a 203d 2073 656c 662e 7a2a  self.z = self.z*
-00021570: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
-00021580: 7475 726e 2073 656c 660a 0a20 2020 2020  turn self..     
-00021590: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000215a0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-000215b0: 7272 6f72 2c20 2275 6e73 7570 706f 7274  rror, "unsupport
-000215c0: 6564 206f 7065 7261 6e64 2074 7970 6520  ed operand type 
-000215d0: 666f 7220 2a3d 220a 0a20 2020 2064 6566  for *="..    def
-000215e0: 205f 5f69 6469 765f 5f28 7365 6c66 2c20   __idiv__(self, 
-000215f0: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-00021600: 2222 2249 6e6c 696e 6520 6469 7669 7369  """Inline divisi
-00021610: 6f6e 2077 6974 6820 7363 616c 6172 2e0a  on with scalar..
-00021620: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00021630: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
-00021640: 720a 2020 2020 2020 2020 7462 203d 2074  r.        tb = t
-00021650: 7970 6528 6f74 6865 7229 0a20 2020 2020  ype(other).     
-00021660: 2020 2069 6620 7462 2069 7320 666c 6f61     if tb is floa
-00021670: 7420 6f72 2074 6220 6973 2069 6e74 206f  t or tb is int o
-00021680: 7220 7462 2069 7320 6c6f 6e67 3a0a 2020  r tb is long:.  
-00021690: 2020 2020 2020 2020 2020 723d 6f74 6865            r=othe
-000216a0: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
-000216b0: 2066 6162 7328 7229 3c3d 6570 733a 0a20   fabs(r)<=eps:. 
-000216c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000216d0: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
-000216e0: 6e45 7272 6f72 2c22 7175 6174 2064 6976  nError,"quat div
-000216f0: 6973 696f 6e22 0a20 2020 2020 2020 2020  ision".         
-00021700: 2020 2073 656c 662e 773d 7365 6c66 2e77     self.w=self.w
-00021710: 2f72 0a20 2020 2020 2020 2020 2020 2073  /r.            s
-00021720: 656c 662e 783d 7365 6c66 2e78 2f72 0a20  elf.x=self.x/r. 
-00021730: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00021740: 793d 7365 6c66 2e79 2f72 0a20 2020 2020  y=self.y/r.     
-00021750: 2020 2020 2020 2073 656c 662e 7a3d 7365         self.z=se
-00021760: 6c66 2e7a 2f72 0a20 2020 2020 2020 2020  lf.z/r.         
-00021770: 2020 2072 6574 7572 6e20 7365 6c66 0a20     return self. 
-00021780: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00021790: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-000217a0: 7970 6545 7272 6f72 2c20 2275 6e73 7570  ypeError, "unsup
-000217b0: 706f 7274 6564 206f 7065 7261 6e64 2074  ported operand t
-000217c0: 7970 6520 666f 7220 2f3d 220a 0a20 2020  ype for /="..   
-000217d0: 2064 6566 205f 5f67 6574 6174 7472 5f5f   def __getattr__
-000217e0: 2873 656c 662c 206e 616d 6529 3a0a 2020  (self, name):.  
-000217f0: 2020 2020 2020 6966 206e 616d 653d 3d22        if name=="
-00021800: 7722 3a0a 2020 2020 2020 2020 2020 2020  w":.            
-00021810: 7265 7475 726e 2073 656c 662e 770a 2020  return self.w.  
-00021820: 2020 2020 2020 656c 6966 206e 616d 653d        elif name=
-00021830: 3d22 7822 3a0a 2020 2020 2020 2020 2020  ="x":.          
-00021840: 2020 7265 7475 726e 2073 656c 662e 780a    return self.x.
-00021850: 2020 2020 2020 2020 656c 6966 206e 616d          elif nam
-00021860: 653d 3d22 7922 3a0a 2020 2020 2020 2020  e=="y":.        
-00021870: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00021880: 790a 2020 2020 2020 2020 656c 6966 206e  y.        elif n
-00021890: 616d 653d 3d22 7a22 3a0a 2020 2020 2020  ame=="z":.      
-000218a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000218b0: 662e 7a0a 2020 2020 2020 2020 656c 7365  f.z.        else
-000218c0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-000218d0: 6973 6520 4174 7472 6962 7574 6545 7272  ise AttributeErr
-000218e0: 6f72 2c22 7175 6174 2068 6173 206e 6f20  or,"quat has no 
-000218f0: 6174 7472 6962 7574 6520 2722 2b6e 616d  attribute '"+nam
-00021900: 652b 2227 220a 0a20 2020 2064 6566 205f  e+"'"..    def _
-00021910: 5f73 6574 6174 7472 5f5f 2873 656c 662c  _setattr__(self,
-00021920: 206e 616d 652c 2076 616c 293a 0a20 2020   name, val):.   
-00021930: 2020 2020 2069 6620 6e61 6d65 3d3d 2277       if name=="w
-00021940: 223a 0a20 2020 2020 2020 2020 2020 2073  ":.            s
-00021950: 656c 662e 7720 3d20 7661 6c0a 2020 2020  elf.w = val.    
-00021960: 2020 2020 656c 6966 206e 616d 653d 3d22      elif name=="
-00021970: 7822 3a0a 2020 2020 2020 2020 2020 2020  x":.            
-00021980: 7365 6c66 2e78 203d 2076 616c 0a20 2020  self.x = val.   
-00021990: 2020 2020 2065 6c69 6620 6e61 6d65 3d3d       elif name==
-000219a0: 2279 223a 0a20 2020 2020 2020 2020 2020  "y":.           
-000219b0: 2073 656c 662e 7920 3d20 7661 6c0a 2020   self.y = val.  
-000219c0: 2020 2020 2020 656c 6966 206e 616d 653d        elif name=
-000219d0: 3d22 7a22 3a0a 2020 2020 2020 2020 2020  ="z":.          
-000219e0: 2020 7365 6c66 2e7a 203d 2076 616c 0a20    self.z = val. 
-000219f0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00021a00: 2020 2020 2020 2020 2072 6169 7365 2041           raise A
-00021a10: 7474 7269 6275 7465 4572 726f 722c 2271  ttributeError,"q
-00021a20: 7561 7420 6861 7320 6e6f 2077 7269 7461  uat has no writa
-00021a30: 626c 6520 6174 7472 6962 7574 6520 2722  ble attribute '"
-00021a40: 2b6e 616d 652b 2227 220a 0a0a 2020 2020  +name+"'"...    
-00021a50: 6465 6620 5f5f 6162 735f 5f28 7365 6c66  def __abs__(self
-00021a60: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-00021a70: 7475 726e 206d 6167 6e69 7475 6465 2e0a  turn magnitude..
-00021a80: 0a20 2020 2020 2020 203e 3e3e 2071 3d71  .        >>> q=q
-00021a90: 7561 7428 302e 3936 3839 2c20 302e 3231  uat(0.9689, 0.21
-00021aa0: 3630 2c20 302e 3130 3830 2c20 302e 3035  60, 0.1080, 0.05
-00021ab0: 3430 290a 2020 2020 2020 2020 3e3e 3e20  40).        >>> 
-00021ac0: 7072 696e 7420 726f 756e 6428 6162 7328  print round(abs(
-00021ad0: 7129 2c35 290a 2020 2020 2020 2020 312e  q),5).        1.
-00021ae0: 300a 2020 2020 2020 2020 2222 220a 2020  0.        """.  
-00021af0: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
-00021b00: 6520 610a 2020 2020 2020 2020 6120 3d20  e a.        a = 
-00021b10: 7365 6c66 2e77 2a73 656c 662e 7720 2b20  self.w*self.w + 
-00021b20: 7365 6c66 2e78 2a73 656c 662e 7820 2b20  self.x*self.x + 
-00021b30: 7365 6c66 2e79 2a73 656c 662e 7920 2b20  self.y*self.y + 
-00021b40: 7365 6c66 2e7a 2a73 656c 662e 7a0a 2020  self.z*self.z.  
-00021b50: 2020 2020 2020 7265 7475 726e 2073 7172        return sqr
-00021b60: 7428 6129 0a0a 2020 2020 6465 6620 636f  t(a)..    def co
-00021b70: 6e6a 7567 6174 6528 7365 6c66 293a 0a20  njugate(self):. 
-00021b80: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00021b90: 2063 6f6e 6a75 6761 7465 2e0a 0a20 2020   conjugate...   
-00021ba0: 2020 2020 203e 3e3e 2071 3d71 7561 7428       >>> q=quat(
-00021bb0: 302e 3936 3839 2c20 302e 3231 3630 2c20  0.9689, 0.2160, 
-00021bc0: 302e 3130 3830 2c20 302e 3035 3430 290a  0.1080, 0.0540).
-00021bd0: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00021be0: 7420 712e 636f 6e6a 7567 6174 6528 290a  t q.conjugate().
-00021bf0: 2020 2020 2020 2020 2830 2e39 3638 392c          (0.9689,
-00021c00: 202d 302e 3231 3630 2c20 2d30 2e31 3038   -0.2160, -0.108
-00021c10: 302c 202d 302e 3035 3430 290a 2020 2020  0, -0.0540).    
-00021c20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00021c30: 6364 6566 2071 7561 7420 7265 730a 2020  cdef quat res.  
-00021c40: 2020 2020 2020 7265 733d 7175 6174 2829        res=quat()
-00021c50: 0a20 2020 2020 2020 2072 6573 2e77 203d  .        res.w =
-00021c60: 2073 656c 662e 770a 2020 2020 2020 2020   self.w.        
-00021c70: 7265 732e 7820 3d20 2d73 656c 662e 780a  res.x = -self.x.
-00021c80: 2020 2020 2020 2020 7265 732e 7920 3d20          res.y = 
-00021c90: 2d73 656c 662e 790a 2020 2020 2020 2020  -self.y.        
-00021ca0: 7265 732e 7a20 3d20 2d73 656c 662e 7a0a  res.z = -self.z.
-00021cb0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00021cc0: 6573 0a0a 2020 2020 6465 6620 6e6f 726d  es..    def norm
-00021cd0: 616c 697a 6528 7365 6c66 293a 0a20 2020  alize(self):.   
-00021ce0: 2020 2020 2022 2222 5265 7475 726e 206e       """Return n
-00021cf0: 6f72 6d61 6c69 7a65 6420 7175 6174 6572  ormalized quater
-00021d00: 6e69 6f6e 2e0a 0a20 2020 2020 2020 203e  nion...        >
-00021d10: 3e3e 2071 3d71 7561 7428 302e 392c 2030  >> q=quat(0.9, 0
-00021d20: 2e35 2c20 302e 322c 2030 2e33 290a 2020  .5, 0.2, 0.3).  
-00021d30: 2020 2020 2020 3e3e 3e20 713d 712e 6e6f        >>> q=q.no
-00021d40: 726d 616c 697a 6528 290a 2020 2020 2020  rmalize().      
-00021d50: 2020 3e3e 3e20 7072 696e 7420 710a 2020    >>> print q.  
-00021d60: 2020 2020 2020 2830 2e38 3235 302c 2030        (0.8250, 0
-00021d70: 2e34 3538 332c 2030 2e31 3833 332c 2030  .4583, 0.1833, 0
-00021d80: 2e32 3735 3029 0a20 2020 2020 2020 203e  .2750).        >
-00021d90: 3e3e 2070 7269 6e74 2061 6273 2871 290a  >> print abs(q).
-00021da0: 2020 2020 2020 2020 312e 300a 2020 2020          1.0.    
-00021db0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00021dc0: 6364 6566 2071 7561 7420 7265 730a 2020  cdef quat res.  
-00021dd0: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
-00021de0: 6520 6e6c 656e 0a0a 2020 2020 2020 2020  e nlen..        
-00021df0: 6e6c 656e 203d 2073 7172 7428 7365 6c66  nlen = sqrt(self
-00021e00: 2e77 2a73 656c 662e 772b 7365 6c66 2e78  .w*self.w+self.x
-00021e10: 2a73 656c 662e 782b 7365 6c66 2e79 2a73  *self.x+self.y*s
-00021e20: 656c 662e 792b 7365 6c66 2e7a 2a73 656c  elf.y+self.z*sel
-00021e30: 662e 7a29 0a20 2020 2020 2020 2069 6620  f.z).        if 
-00021e40: 6e6c 656e 3c3d 6570 733a 0a20 2020 2020  nlen<=eps:.     
-00021e50: 2020 2020 2020 2072 6169 7365 205a 6572         raise Zer
-00021e60: 6f44 6976 6973 696f 6e45 7272 6f72 2c22  oDivisionError,"
-00021e70: 7175 6174 2064 6976 6973 696f 6e22 0a0a  quat division"..
-00021e80: 2020 2020 2020 2020 6e6c 656e 203d 2031          nlen = 1
-00021e90: 2e30 2f6e 6c65 6e0a 2020 2020 2020 2020  .0/nlen.        
-00021ea0: 7265 7320 3d20 7175 6174 2829 0a20 2020  res = quat().   
-00021eb0: 2020 2020 2072 6573 2e77 203d 2073 656c       res.w = sel
-00021ec0: 662e 772a 6e6c 656e 0a20 2020 2020 2020  f.w*nlen.       
-00021ed0: 2072 6573 2e78 203d 2073 656c 662e 782a   res.x = self.x*
-00021ee0: 6e6c 656e 0a20 2020 2020 2020 2072 6573  nlen.        res
-00021ef0: 2e79 203d 2073 656c 662e 792a 6e6c 656e  .y = self.y*nlen
-00021f00: 0a20 2020 2020 2020 2072 6573 2e7a 203d  .        res.z =
-00021f10: 2073 656c 662e 7a2a 6e6c 656e 0a20 2020   self.z*nlen.   
-00021f20: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-00021f30: 0a20 2020 2064 6566 2069 6e76 6572 7365  .    def inverse
-00021f40: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00021f50: 2222 2252 6574 7572 6e20 696e 7665 7273  """Return invers
-00021f60: 652e 0a0a 2020 2020 2020 2020 3e3e 3e20  e...        >>> 
-00021f70: 713d 7175 6174 2830 2e39 2c20 302e 352c  q=quat(0.9, 0.5,
-00021f80: 2030 2e32 2c20 302e 3329 0a20 2020 2020   0.2, 0.3).     
-00021f90: 2020 203e 3e3e 2070 7269 6e74 2071 2e69     >>> print q.i
-00021fa0: 6e76 6572 7365 2829 0a20 2020 2020 2020  nverse().       
-00021fb0: 2028 302e 3735 3633 2c20 2d30 2e34 3230   (0.7563, -0.420
-00021fc0: 322c 202d 302e 3136 3831 2c20 2d30 2e32  2, -0.1681, -0.2
-00021fd0: 3532 3129 0a20 2020 2020 2020 2022 2222  521).        """
-00021fe0: 0a20 2020 2020 2020 2063 6465 6620 7175  .        cdef qu
-00021ff0: 6174 2072 6573 0a0a 2020 2020 2020 2020  at res..        
-00022000: 6c65 6e5f 3220 3d20 7365 6c66 2e77 2a73  len_2 = self.w*s
-00022010: 656c 662e 772b 7365 6c66 2e78 2a73 656c  elf.w+self.x*sel
-00022020: 662e 782b 7365 6c66 2e79 2a73 656c 662e  f.x+self.y*self.
-00022030: 792b 7365 6c66 2e7a 2a73 656c 662e 7a0a  y+self.z*self.z.
-00022040: 2020 2020 2020 2020 6966 2066 6162 7328          if fabs(
-00022050: 6c65 6e5f 3229 3c3d 6570 733a 0a20 2020  len_2)<=eps:.   
-00022060: 2020 2020 2020 2020 2072 6169 7365 205a           raise Z
-00022070: 6572 6f44 6976 6973 696f 6e45 7272 6f72  eroDivisionError
-00022080: 2c22 7175 6174 2069 7320 6e6f 7420 696e  ,"quat is not in
-00022090: 7665 7274 6962 6c65 220a 0a20 2020 2020  vertible"..     
-000220a0: 2020 206c 656e 5f32 203d 2031 2e30 2f6c     len_2 = 1.0/l
-000220b0: 656e 5f32 0a20 2020 2020 2020 2072 6573  en_2.        res
-000220c0: 203d 2071 7561 7428 290a 2020 2020 2020   = quat().      
-000220d0: 2020 7265 732e 7720 3d20 2073 656c 662e    res.w =  self.
-000220e0: 772a 6c65 6e5f 320a 2020 2020 2020 2020  w*len_2.        
-000220f0: 7265 732e 7820 3d20 2d73 656c 662e 782a  res.x = -self.x*
-00022100: 6c65 6e5f 320a 2020 2020 2020 2020 7265  len_2.        re
-00022110: 732e 7920 3d20 2d73 656c 662e 792a 6c65  s.y = -self.y*le
-00022120: 6e5f 320a 2020 2020 2020 2020 7265 732e  n_2.        res.
-00022130: 7a20 3d20 2d73 656c 662e 7a2a 6c65 6e5f  z = -self.z*len_
-00022140: 320a 2020 2020 2020 2020 7265 7475 726e  2.        return
-00022150: 2072 6573 0a0a 2020 2020 6465 6620 746f   res..    def to
-00022160: 416e 676c 6541 7869 7328 7365 6c66 293a  AngleAxis(self):
-00022170: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00022180: 726e 2061 6e67 6c65 2028 696e 2072 6164  rn angle (in rad
-00022190: 6961 6e73 2920 616e 6420 726f 7461 7469  ians) and rotati
-000221a0: 6f6e 2061 7869 732e 0a0a 2020 2020 2020  on axis...      
-000221b0: 2020 3e3e 3e20 713d 7175 6174 2830 2e39    >>> q=quat(0.9
-000221c0: 2c20 302e 352c 2030 2e32 2c20 302e 3329  , 0.5, 0.2, 0.3)
-000221d0: 0a20 2020 2020 2020 203e 3e3e 2061 6e67  .        >>> ang
-000221e0: 6c65 2c20 6178 6973 203d 2071 2e74 6f41  le, axis = q.toA
-000221f0: 6e67 6c65 4178 6973 2829 0a20 2020 2020  ngleAxis().     
-00022200: 2020 203e 3e3e 2070 7269 6e74 2072 6f75     >>> print rou
-00022210: 6e64 2861 6e67 6c65 2c34 290a 2020 2020  nd(angle,4).    
-00022220: 2020 2020 312e 3230 3131 0a20 2020 2020      1.2011.     
-00022230: 2020 203e 3e3e 2070 7269 6e74 2061 7869     >>> print axi
-00022240: 730a 2020 2020 2020 2020 2830 2e38 3131  s.        (0.811
-00022250: 312c 2030 2e33 3234 342c 2030 2e34 3836  1, 0.3244, 0.486
-00022260: 3729 0a20 2020 2020 2020 2022 2222 0a20  7).        """. 
-00022270: 2020 2020 2020 2063 6465 6620 7175 6174         cdef quat
-00022280: 2071 0a20 2020 2020 2020 2063 6465 6620   q.        cdef 
-00022290: 646f 7562 6c65 2073 2c77 0a0a 2020 2020  double s,w..    
-000222a0: 2020 2020 7120 3d20 7365 6c66 2e6e 6f72      q = self.nor
-000222b0: 6d61 6c69 7a65 2829 0a0a 2020 2020 2020  malize()..      
-000222c0: 2020 2320 436c 616d 7020 6e73 656c 662e    # Clamp nself.
-000222d0: 7720 2873 696e 6365 2074 6865 2071 7561  w (since the qua
-000222e0: 7420 6861 7320 746f 2062 6520 6e6f 726d  t has to be norm
-000222f0: 616c 697a 6564 2069 7420 7368 6f75 6c64  alized it should
-00022300: 0a20 2020 2020 2020 2023 2062 6520 6265  .        # be be
-00022310: 7477 6565 6e20 2d31 2061 6e64 2031 2061  tween -1 and 1 a
-00022320: 6e79 7761 792c 2062 7574 2069 7420 6d69  nyway, but it mi
-00022330: 6768 7420 6265 2073 6c69 6768 746c 7920  ght be slightly 
-00022340: 6f66 6620 6475 650a 2020 2020 2020 2020  off due.        
-00022350: 2320 746f 206e 756d 6572 6963 616c 2069  # to numerical i
-00022360: 6e61 6363 7572 6163 6965 7329 0a20 2020  naccuracies).   
-00022370: 2020 2020 2069 6620 712e 773c 2d31 2e30       if q.w<-1.0
-00022380: 3a0a 2020 2020 2020 2020 2020 2020 7720  :.            w 
-00022390: 3d20 2d31 2e30 0a20 2020 2020 2020 2065  = -1.0.        e
-000223a0: 6c69 6620 712e 773e 312e 303a 0a20 2020  lif q.w>1.0:.   
-000223b0: 2020 2020 2020 2020 2077 203d 2031 2e30           w = 1.0
-000223c0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000223d0: 2020 2020 2020 2020 2020 2077 203d 2071             w = q
-000223e0: 2e77 0a0a 2020 2020 2020 2020 7720 3d20  .w..        w = 
-000223f0: 6163 6f73 2877 290a 2020 2020 2020 2020  acos(w).        
-00022400: 7320 3d20 7369 6e28 7729 0a20 2020 2020  s = sin(w).     
-00022410: 2020 2069 6620 733c 3d65 7073 3a0a 2020     if s<=eps:.  
-00022420: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00022430: 2028 302e 302c 2076 6563 3328 302e 302c   (0.0, vec3(0.0,
-00022440: 302e 302c 302e 3029 290a 0a20 2020 2020  0.0,0.0))..     
-00022450: 2020 2072 6574 7572 6e20 2832 2e30 2a77     return (2.0*w
-00022460: 2c20 7665 6333 2871 2e78 2f73 2c20 712e  , vec3(q.x/s, q.
-00022470: 792f 732c 2071 2e7a 2f73 2929 0a0a 2020  y/s, q.z/s))..  
-00022480: 2020 6465 6620 6672 6f6d 416e 676c 6541    def fromAngleA
-00022490: 7869 7328 7365 6c66 2c20 616e 676c 652c  xis(self, angle,
-000224a0: 2061 7869 7329 3a0a 2020 2020 2020 2020   axis):.        
-000224b0: 2222 2249 6e69 7469 616c 697a 6520 7365  """Initialize se
-000224c0: 6c66 2066 726f 6d20 616e 2061 6e67 6c65  lf from an angle
-000224d0: 2028 696e 2072 6164 6961 6e73 2920 616e   (in radians) an
-000224e0: 6420 616e 2061 7869 7320 616e 6420 7265  d an axis and re
-000224f0: 7475 726e 7320 7365 6c66 2e22 2222 0a20  turns self.""". 
-00022500: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
-00022510: 6c65 2061 2c6e 2c20 782c 792c 7a0a 2020  le a,n, x,y,z.  
-00022520: 2020 2020 2020 6364 6566 2071 7561 7420        cdef quat 
-00022530: 710a 0a20 2020 2020 2020 2061 203d 2061  q..        a = a
-00022540: 6e67 6c65 2f32 2e30 0a20 2020 2020 2020  ngle/2.0.       
-00022550: 2073 656c 662e 7720 3d20 636f 7328 6129   self.w = cos(a)
-00022560: 0a0a 2020 2020 2020 2020 7820 3d20 6178  ..        x = ax
-00022570: 6973 5b30 5d0a 2020 2020 2020 2020 7920  is[0].        y 
-00022580: 3d20 6178 6973 5b31 5d0a 2020 2020 2020  = axis[1].      
-00022590: 2020 7a20 3d20 6178 6973 5b32 5d0a 2020    z = axis[2].  
-000225a0: 2020 2020 2020 6e20 3d20 782a 782b 792a        n = x*x+y*
-000225b0: 792b 7a2a 7a0a 2020 2020 2020 2020 6966  y+z*z.        if
-000225c0: 206e 3c3d 6570 733a 0a20 2020 2020 2020   n<=eps:.       
-000225d0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000225e0: 4572 726f 722c 2261 7869 7320 6d75 7374  Error,"axis must
-000225f0: 6e27 7420 6265 2074 6865 206e 756c 6c20  n't be the null 
-00022600: 7665 6374 6f72 220a 0a20 2020 2020 2020  vector"..       
-00022610: 2073 203d 2073 696e 2861 292f 6e0a 2020   s = sin(a)/n.  
-00022620: 2020 2020 2020 7365 6c66 2e78 203d 2078        self.x = x
-00022630: 2a73 0a20 2020 2020 2020 2073 656c 662e  *s.        self.
-00022640: 7920 3d20 792a 730a 2020 2020 2020 2020  y = y*s.        
-00022650: 7365 6c66 2e7a 203d 207a 2a73 0a0a 2020  self.z = z*s..  
-00022660: 2020 2020 2020 2320 4e6f 726d 616c 697a        # Normaliz
-00022670: 6520 7468 6520 7175 6174 0a20 2020 2020  e the quat.     
-00022680: 2020 2071 203d 2073 656c 662e 6e6f 726d     q = self.norm
-00022690: 616c 697a 6528 290a 2020 2020 2020 2020  alize().        
-000226a0: 7365 6c66 2e77 203d 2071 2e77 0a20 2020  self.w = q.w.   
-000226b0: 2020 2020 2073 656c 662e 7820 3d20 712e       self.x = q.
-000226c0: 780a 2020 2020 2020 2020 7365 6c66 2e79  x.        self.y
-000226d0: 203d 2071 2e79 0a20 2020 2020 2020 2073   = q.y.        s
-000226e0: 656c 662e 7a20 3d20 712e 7a0a 2020 2020  elf.z = q.z.    
-000226f0: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
-00022700: 0a20 2020 2064 6566 2074 6f4d 6174 3328  .    def toMat3(
-00022710: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00022720: 2222 5265 7475 726e 2072 6f74 6174 696f  ""Return rotatio
-00022730: 6e20 6d61 7472 6978 2061 7320 6d61 7433  n matrix as mat3
-00022740: 2e22 2222 0a20 2020 2020 2020 2063 6465  .""".        cde
-00022750: 6620 6d61 7433 2072 6573 0a20 2020 2020  f mat3 res.     
-00022760: 2020 2063 6465 6620 7878 2c79 792c 7a7a     cdef xx,yy,zz
-00022770: 2c78 792c 7a77 2c78 7a2c 7977 2c79 7a2c  ,xy,zw,xz,yw,yz,
-00022780: 7877 0a0a 2020 2020 2020 2020 7878 203d  xw..        xx =
-00022790: 2032 2e30 2a73 656c 662e 782a 7365 6c66   2.0*self.x*self
-000227a0: 2e78 0a20 2020 2020 2020 2079 7920 3d20  .x.        yy = 
-000227b0: 322e 302a 7365 6c66 2e79 2a73 656c 662e  2.0*self.y*self.
-000227c0: 790a 2020 2020 2020 2020 7a7a 203d 2032  y.        zz = 2
-000227d0: 2e30 2a73 656c 662e 7a2a 7365 6c66 2e7a  .0*self.z*self.z
-000227e0: 0a20 2020 2020 2020 2078 7920 3d20 322e  .        xy = 2.
-000227f0: 302a 7365 6c66 2e78 2a73 656c 662e 790a  0*self.x*self.y.
-00022800: 2020 2020 2020 2020 7a77 203d 2032 2e30          zw = 2.0
-00022810: 2a73 656c 662e 7a2a 7365 6c66 2e77 0a20  *self.z*self.w. 
-00022820: 2020 2020 2020 2078 7a20 3d20 322e 302a         xz = 2.0*
-00022830: 7365 6c66 2e78 2a73 656c 662e 7a0a 2020  self.x*self.z.  
-00022840: 2020 2020 2020 7977 203d 2032 2e30 2a73        yw = 2.0*s
-00022850: 656c 662e 792a 7365 6c66 2e77 0a20 2020  elf.y*self.w.   
-00022860: 2020 2020 2079 7a20 3d20 322e 302a 7365       yz = 2.0*se
-00022870: 6c66 2e79 2a73 656c 662e 7a0a 2020 2020  lf.y*self.z.    
-00022880: 2020 2020 7877 203d 2032 2e30 2a73 656c      xw = 2.0*sel
-00022890: 662e 782a 7365 6c66 2e77 0a0a 2020 2020  f.x*self.w..    
-000228a0: 2020 2020 7265 7320 3d20 6d61 7433 2829      res = mat3()
-000228b0: 0a20 2020 2020 2020 2072 6573 2e6d 3131  .        res.m11
-000228c0: 203d 2031 2e30 2d79 792d 7a7a 0a20 2020   = 1.0-yy-zz.   
-000228d0: 2020 2020 2072 6573 2e6d 3132 203d 2078       res.m12 = x
-000228e0: 792d 7a77 0a20 2020 2020 2020 2072 6573  y-zw.        res
-000228f0: 2e6d 3133 203d 2078 7a2b 7977 0a20 2020  .m13 = xz+yw.   
-00022900: 2020 2020 2072 6573 2e6d 3231 203d 2078       res.m21 = x
-00022910: 792b 7a77 0a20 2020 2020 2020 2072 6573  y+zw.        res
-00022920: 2e6d 3232 203d 2031 2e30 2d78 782d 7a7a  .m22 = 1.0-xx-zz
-00022930: 0a20 2020 2020 2020 2072 6573 2e6d 3233  .        res.m23
-00022940: 203d 2079 7a2d 7877 0a20 2020 2020 2020   = yz-xw.       
-00022950: 2072 6573 2e6d 3331 203d 2078 7a2d 7977   res.m31 = xz-yw
-00022960: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
-00022970: 203d 2079 7a2b 7877 0a20 2020 2020 2020   = yz+xw.       
-00022980: 2072 6573 2e6d 3333 203d 2031 2e30 2d78   res.m33 = 1.0-x
-00022990: 782d 7979 0a20 2020 2020 2020 2072 6574  x-yy.        ret
-000229a0: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
-000229b0: 2074 6f4d 6174 3428 7365 6c66 293a 0a20   toMat4(self):. 
-000229c0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-000229d0: 2072 6f74 6174 696f 6e20 6d61 7472 6978   rotation matrix
-000229e0: 2061 7320 6d61 7434 2e22 2222 0a20 2020   as mat4.""".   
-000229f0: 2020 2020 2063 6465 6620 6d61 7434 2072       cdef mat4 r
-00022a00: 6573 0a20 2020 2020 2020 2063 6465 6620  es.        cdef 
-00022a10: 7878 2c79 792c 7a7a 2c78 792c 7a77 2c78  xx,yy,zz,xy,zw,x
-00022a20: 7a2c 7977 2c79 7a2c 7877 0a0a 2020 2020  z,yw,yz,xw..    
-00022a30: 2020 2020 7878 203d 2032 2e30 2a73 656c      xx = 2.0*sel
-00022a40: 662e 782a 7365 6c66 2e78 0a20 2020 2020  f.x*self.x.     
-00022a50: 2020 2079 7920 3d20 322e 302a 7365 6c66     yy = 2.0*self
-00022a60: 2e79 2a73 656c 662e 790a 2020 2020 2020  .y*self.y.      
-00022a70: 2020 7a7a 203d 2032 2e30 2a73 656c 662e    zz = 2.0*self.
-00022a80: 7a2a 7365 6c66 2e7a 0a20 2020 2020 2020  z*self.z.       
-00022a90: 2078 7920 3d20 322e 302a 7365 6c66 2e78   xy = 2.0*self.x
-00022aa0: 2a73 656c 662e 790a 2020 2020 2020 2020  *self.y.        
-00022ab0: 7a77 203d 2032 2e30 2a73 656c 662e 7a2a  zw = 2.0*self.z*
-00022ac0: 7365 6c66 2e77 0a20 2020 2020 2020 2078  self.w.        x
-00022ad0: 7a20 3d20 322e 302a 7365 6c66 2e78 2a73  z = 2.0*self.x*s
-00022ae0: 656c 662e 7a0a 2020 2020 2020 2020 7977  elf.z.        yw
-00022af0: 203d 2032 2e30 2a73 656c 662e 792a 7365   = 2.0*self.y*se
-00022b00: 6c66 2e77 0a20 2020 2020 2020 2079 7a20  lf.w.        yz 
-00022b10: 3d20 322e 302a 7365 6c66 2e79 2a73 656c  = 2.0*self.y*sel
-00022b20: 662e 7a0a 2020 2020 2020 2020 7877 203d  f.z.        xw =
-00022b30: 2032 2e30 2a73 656c 662e 782a 7365 6c66   2.0*self.x*self
-00022b40: 2e77 0a0a 2020 2020 2020 2020 7265 7320  .w..        res 
-00022b50: 3d20 6d61 7434 2829 0a0a 2020 2020 2020  = mat4()..      
-00022b60: 2020 7265 732e 6d31 3120 3d20 312e 302d    res.m11 = 1.0-
-00022b70: 7979 2d7a 7a0a 2020 2020 2020 2020 7265  yy-zz.        re
-00022b80: 732e 6d31 3220 3d20 7879 2d7a 770a 2020  s.m12 = xy-zw.  
-00022b90: 2020 2020 2020 7265 732e 6d31 3320 3d20        res.m13 = 
-00022ba0: 787a 2b79 770a 2020 2020 2020 2020 7265  xz+yw.        re
-00022bb0: 732e 6d31 3420 3d20 302e 300a 2020 2020  s.m14 = 0.0.    
-00022bc0: 2020 2020 7265 732e 6d32 3120 3d20 7879      res.m21 = xy
-00022bd0: 2b7a 770a 2020 2020 2020 2020 7265 732e  +zw.        res.
-00022be0: 6d32 3220 3d20 312e 302d 7878 2d7a 7a0a  m22 = 1.0-xx-zz.
-00022bf0: 2020 2020 2020 2020 7265 732e 6d32 3320          res.m23 
-00022c00: 3d20 797a 2d78 770a 2020 2020 2020 2020  = yz-xw.        
-00022c10: 7265 732e 6d32 3420 3d20 302e 300a 2020  res.m24 = 0.0.  
-00022c20: 2020 2020 2020 7265 732e 6d33 3120 3d20        res.m31 = 
-00022c30: 787a 2d79 770a 2020 2020 2020 2020 7265  xz-yw.        re
-00022c40: 732e 6d33 3220 3d20 797a 2b78 770a 2020  s.m32 = yz+xw.  
-00022c50: 2020 2020 2020 7265 732e 6d33 3320 3d20        res.m33 = 
-00022c60: 312e 302d 7878 2d79 790a 2020 2020 2020  1.0-xx-yy.      
-00022c70: 2020 7265 732e 6d33 3420 3d20 302e 300a    res.m34 = 0.0.
-00022c80: 2020 2020 2020 2020 7265 732e 6d34 3120          res.m41 
-00022c90: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
-00022ca0: 732e 6d34 3220 3d20 302e 300a 2020 2020  s.m42 = 0.0.    
-00022cb0: 2020 2020 7265 732e 6d34 3320 3d20 302e      res.m43 = 0.
-00022cc0: 300a 2020 2020 2020 2020 7265 732e 6d34  0.        res.m4
-00022cd0: 3420 3d20 312e 300a 2020 2020 2020 2020  4 = 1.0.        
-00022ce0: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
-00022cf0: 6465 6620 6672 6f6d 4d61 7428 7365 6c66  def fromMat(self
-00022d00: 2c20 6d29 3a0a 2020 2020 2020 2020 2222  , m):.        ""
-00022d10: 2249 6e69 7469 616c 697a 6520 7365 6c66  "Initialize self
-00022d20: 2066 726f 6d20 6569 7468 6572 2061 206d   from either a m
-00022d30: 6174 3320 6f72 206d 6174 3420 616e 6420  at3 or mat4 and 
-00022d40: 7265 7475 726e 7320 7365 6c66 2e22 2222  returns self."""
-00022d50: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
-00022d60: 7562 6c65 2064 312c 6432 2c64 332c 6164  uble d1,d2,d3,ad
-00022d70: 312c 6164 322c 6164 332c 742c 730a 0a20  1,ad2,ad3,t,s.. 
-00022d80: 2020 2020 2020 2064 3120 3d20 6d5b 302c         d1 = m[0,
-00022d90: 305d 0a20 2020 2020 2020 2064 3220 3d20  0].        d2 = 
-00022da0: 6d5b 312c 315d 0a20 2020 2020 2020 2064  m[1,1].        d
-00022db0: 3320 3d20 6d5b 322c 325d 0a20 2020 2020  3 = m[2,2].     
-00022dc0: 2020 2074 203d 2064 312b 6432 2b64 332b     t = d1+d2+d3+
-00022dd0: 312e 300a 2020 2020 2020 2020 6966 2074  1.0.        if t
-00022de0: 3e30 2e30 3a0a 2020 2020 2020 2020 2020  >0.0:.          
-00022df0: 2020 7320 3d20 302e 352f 7371 7274 2874    s = 0.5/sqrt(t
-00022e00: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00022e10: 6c66 2e77 203d 2030 2e32 352f 730a 2020  lf.w = 0.25/s.  
-00022e20: 2020 2020 2020 2020 2020 7365 6c66 2e78            self.x
-00022e30: 203d 2028 6d5b 322c 315d 2d6d 5b31 2c32   = (m[2,1]-m[1,2
-00022e40: 5d29 2a73 0a20 2020 2020 2020 2020 2020  ])*s.           
-00022e50: 2073 656c 662e 7920 3d20 286d 5b30 2c32   self.y = (m[0,2
-00022e60: 5d2d 6d5b 322c 305d 292a 730a 2020 2020  ]-m[2,0])*s.    
-00022e70: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
-00022e80: 2028 6d5b 312c 305d 2d6d 5b30 2c31 5d29   (m[1,0]-m[0,1])
-00022e90: 2a73 0a20 2020 2020 2020 2065 6c73 653a  *s.        else:
-00022ea0: 0a20 2020 2020 2020 2020 2020 2061 6431  .            ad1
-00022eb0: 203d 2066 6162 7328 6431 290a 2020 2020   = fabs(d1).    
-00022ec0: 2020 2020 2020 2020 6164 3220 3d20 6661          ad2 = fa
-00022ed0: 6273 2864 3229 0a20 2020 2020 2020 2020  bs(d2).         
-00022ee0: 2020 2061 6433 203d 2066 6162 7328 6433     ad3 = fabs(d3
-00022ef0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00022f00: 2061 6431 3e3d 6164 3220 616e 6420 6164   ad1>=ad2 and ad
-00022f10: 313e 3d61 6433 3a0a 2020 2020 2020 2020  1>=ad3:.        
-00022f20: 2020 2020 2020 2020 7320 3d20 7371 7274          s = sqrt
-00022f30: 2831 2e30 2b64 312d 6432 2d64 3329 2a32  (1.0+d1-d2-d3)*2
-00022f40: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-00022f50: 2020 2073 656c 662e 7820 3d20 302e 352f     self.x = 0.5/
-00022f60: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00022f70: 2020 7365 6c66 2e79 203d 2028 6d5b 302c    self.y = (m[0,
-00022f80: 315d 2b6d 5b31 2c30 5d29 2f73 0a20 2020  1]+m[1,0])/s.   
-00022f90: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00022fa0: 662e 7a20 3d20 286d 5b30 2c32 5d2b 6d5b  f.z = (m[0,2]+m[
-00022fb0: 322c 305d 292f 730a 2020 2020 2020 2020  2,0])/s.        
-00022fc0: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
-00022fd0: 2028 6d5b 312c 325d 2b6d 5b32 2c31 5d29   (m[1,2]+m[2,1])
-00022fe0: 2f73 0a20 2020 2020 2020 2020 2020 2065  /s.            e
-00022ff0: 6c69 6620 6164 323e 3d61 6431 2061 6e64  lif ad2>=ad1 and
-00023000: 2061 6432 3e3d 6164 333a 0a20 2020 2020   ad2>=ad3:.     
-00023010: 2020 2020 2020 2020 2020 2073 203d 2073             s = s
-00023020: 7172 7428 312e 302b 6432 2d64 312d 6433  qrt(1.0+d2-d1-d3
-00023030: 292a 322e 300a 2020 2020 2020 2020 2020  )*2.0.          
-00023040: 2020 2020 2020 7365 6c66 2e78 203d 2028        self.x = (
-00023050: 6d5b 302c 315d 2b6d 5b31 2c30 5d29 2f73  m[0,1]+m[1,0])/s
-00023060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023070: 2073 656c 662e 7920 3d20 302e 352f 730a   self.y = 0.5/s.
-00023080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023090: 7365 6c66 2e7a 203d 2028 6d5b 312c 325d  self.z = (m[1,2]
-000230a0: 2b6d 5b32 2c31 5d29 2f73 0a20 2020 2020  +m[2,1])/s.     
-000230b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000230c0: 7720 3d20 286d 5b30 2c32 5d2b 6d5b 322c  w = (m[0,2]+m[2,
-000230d0: 305d 292f 730a 2020 2020 2020 2020 2020  0])/s.          
-000230e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000230f0: 2020 2020 2020 2020 7320 3d20 7371 7274          s = sqrt
-00023100: 2831 2e30 2b64 332d 6431 2d64 3229 2a32  (1.0+d3-d1-d2)*2
-00023110: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
-00023120: 2020 2073 656c 662e 7820 3d20 286d 5b30     self.x = (m[0
-00023130: 2c32 5d2b 6d5b 322c 305d 292f 730a 2020  ,2]+m[2,0])/s.  
-00023140: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00023150: 6c66 2e79 203d 2028 6d5b 312c 325d 2b6d  lf.y = (m[1,2]+m
-00023160: 5b32 2c31 5d29 2f73 0a20 2020 2020 2020  [2,1])/s.       
-00023170: 2020 2020 2020 2020 2073 656c 662e 7a20           self.z 
-00023180: 3d20 302e 352f 730a 2020 2020 2020 2020  = 0.5/s.        
-00023190: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
-000231a0: 2028 6d5b 302c 315d 2b6d 5b31 2c30 5d29   (m[0,1]+m[1,0])
-000231b0: 2f73 0a0a 2020 2020 2020 2020 7265 7475  /s..        retu
-000231c0: 726e 2073 656c 660a 0a20 2020 2064 6566  rn self..    def
-000231d0: 2064 6f74 2873 656c 662c 2071 7561 7420   dot(self, quat 
-000231e0: 6229 3a0a 2020 2020 2020 2020 2222 2252  b):.        """R
-000231f0: 6574 7572 6e20 7468 6520 646f 7420 7072  eturn the dot pr
-00023200: 6f64 7563 7420 6f66 2073 656c 6620 616e  oduct of self an
-00023210: 6420 622e 2222 220a 2020 2020 2020 2020  d b.""".        
-00023220: 7265 7475 726e 2073 656c 662e 772a 622e  return self.w*b.
-00023230: 7720 2b20 7365 6c66 2e78 2a62 2e78 202b  w + self.x*b.x +
-00023240: 2073 656c 662e 792a 622e 7920 2b20 7365   self.y*b.y + se
-00023250: 6c66 2e7a 2a62 2e7a 0a0a 2020 2020 6465  lf.z*b.z..    de
-00023260: 6620 6c6f 6728 7365 6c66 293a 0a20 2020  f log(self):.   
-00023270: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
-00023280: 6865 206e 6174 7572 616c 206c 6f67 6172  he natural logar
-00023290: 6974 686d 206f 6620 7365 6c66 2e22 2222  ithm of self."""
-000232a0: 0a0a 2020 2020 2020 2020 6364 6566 2064  ..        cdef d
-000232b0: 6f75 626c 6520 622c 2074 2c20 662c 2063  ouble b, t, f, c
-000232c0: 742c 2072 0a20 2020 2020 2020 2063 6465  t, r.        cde
-000232d0: 6620 7175 6174 2072 6573 0a0a 2020 2020  f quat res..    
-000232e0: 2020 2020 6220 3d20 7371 7274 2873 656c      b = sqrt(sel
-000232f0: 662e 782a 7365 6c66 2e78 202b 2073 656c  f.x*self.x + sel
-00023300: 662e 792a 7365 6c66 2e79 202b 2073 656c  f.y*self.y + sel
-00023310: 662e 7a2a 7365 6c66 2e7a 290a 2020 2020  f.z*self.z).    
-00023320: 2020 2020 7265 7320 3d20 7175 6174 2829      res = quat()
-00023330: 0a20 2020 2020 2020 2069 6620 6661 6273  .        if fabs
-00023340: 2862 293c 3d65 7073 3a0a 2020 2020 2020  (b)<=eps:.      
-00023350: 2020 2020 2020 7265 732e 7820 3d20 302e        res.x = 0.
-00023360: 300a 2020 2020 2020 2020 2020 2020 7265  0.            re
-00023370: 732e 7920 3d20 302e 300a 2020 2020 2020  s.y = 0.0.      
-00023380: 2020 2020 2020 7265 732e 7a20 3d20 302e        res.z = 0.
-00023390: 300a 2020 2020 2020 2020 2020 2020 6966  0.            if
-000233a0: 2073 656c 662e 773c 3d65 7073 3a0a 2020   self.w<=eps:.  
-000233b0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000233c0: 6973 6520 5661 6c75 6545 7272 6f72 2c20  ise ValueError, 
-000233d0: 226d 6174 6820 646f 6d61 696e 2065 7272  "math domain err
-000233e0: 6f72 220a 2020 2020 2020 2020 2020 2020  or".            
-000233f0: 7265 732e 7720 3d20 6c6f 6728 7365 6c66  res.w = log(self
-00023400: 2e77 290a 2020 2020 2020 2020 656c 7365  .w).        else
-00023410: 3a0a 2020 2020 2020 2020 2020 2020 7420  :.            t 
-00023420: 3d20 6174 616e 3228 622c 2073 656c 662e  = atan2(b, self.
-00023430: 7729 0a20 2020 2020 2020 2020 2020 2066  w).            f
-00023440: 203d 2074 2f62 0a20 2020 2020 2020 2020   = t/b.         
-00023450: 2020 2072 6573 2e78 203d 2066 2a73 656c     res.x = f*sel
-00023460: 662e 780a 2020 2020 2020 2020 2020 2020  f.x.            
-00023470: 7265 732e 7920 3d20 662a 7365 6c66 2e79  res.y = f*self.y
-00023480: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00023490: 2e7a 203d 2066 2a73 656c 662e 7a0a 2020  .z = f*self.z.  
-000234a0: 2020 2020 2020 2020 2020 6374 203d 2063            ct = c
-000234b0: 6f73 2874 290a 2020 2020 2020 2020 2020  os(t).          
-000234c0: 2020 6966 2066 6162 7328 6374 293c 3d65    if fabs(ct)<=e
-000234d0: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
-000234e0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-000234f0: 7272 6f72 2c20 226d 6174 6820 646f 6d61  rror, "math doma
-00023500: 696e 2065 7272 6f72 220a 2020 2020 2020  in error".      
-00023510: 2020 2020 2020 7220 3d20 7365 6c66 2e77        r = self.w
-00023520: 2f63 740a 2020 2020 2020 2020 2020 2020  /ct.            
-00023530: 6966 2072 3c3d 6570 733a 0a20 2020 2020  if r<=eps:.     
-00023540: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00023550: 2056 616c 7565 4572 726f 722c 2022 6d61   ValueError, "ma
-00023560: 7468 2064 6f6d 6169 6e20 6572 726f 7222  th domain error"
-00023570: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00023580: 2e77 203d 206c 6f67 2872 290a 0a20 2020  .w = log(r)..   
-00023590: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
-000235a0: 0a20 2020 2064 6566 2065 7870 2873 656c  .    def exp(sel
-000235b0: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-000235c0: 6574 7572 6e20 7468 6520 6578 706f 6e65  eturn the expone
-000235d0: 6e74 6961 6c20 6f66 2073 656c 662e 2222  ntial of self.""
-000235e0: 220a 0a20 2020 2020 2020 2063 6465 6620  "..        cdef 
-000235f0: 646f 7562 6c65 2062 2c20 660a 2020 2020  double b, f.    
-00023600: 2020 2020 6364 6566 2071 7561 7420 7265      cdef quat re
-00023610: 730a 0a20 2020 2020 2020 2062 203d 2073  s..        b = s
-00023620: 7172 7428 7365 6c66 2e78 2a73 656c 662e  qrt(self.x*self.
-00023630: 7820 2b20 7365 6c66 2e79 2a73 656c 662e  x + self.y*self.
-00023640: 7920 2b20 7365 6c66 2e7a 2a73 656c 662e  y + self.z*self.
-00023650: 7a29 0a20 2020 2020 2020 2072 6573 203d  z).        res =
-00023660: 2071 7561 7428 290a 2020 2020 2020 2020   quat().        
-00023670: 6966 2066 6162 7328 6229 3c3d 6570 733a  if fabs(b)<=eps:
-00023680: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00023690: 2e78 203d 2030 2e30 0a20 2020 2020 2020  .x = 0.0.       
-000236a0: 2020 2020 2072 6573 2e79 203d 2030 2e30       res.y = 0.0
-000236b0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-000236c0: 2e7a 203d 2030 2e30 0a20 2020 2020 2020  .z = 0.0.       
-000236d0: 2020 2020 2072 6573 2e77 203d 2065 7870       res.w = exp
-000236e0: 2873 656c 662e 7729 0a20 2020 2020 2020  (self.w).       
-000236f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00023700: 2020 2066 203d 2073 696e 2862 292f 620a     f = sin(b)/b.
-00023710: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-00023720: 7820 3d20 662a 7365 6c66 2e78 0a20 2020  x = f*self.x.   
-00023730: 2020 2020 2020 2020 2072 6573 2e79 203d           res.y =
-00023740: 2066 2a73 656c 662e 790a 2020 2020 2020   f*self.y.      
-00023750: 2020 2020 2020 7265 732e 7a20 3d20 662a        res.z = f*
-00023760: 7365 6c66 2e7a 0a20 2020 2020 2020 2020  self.z.         
-00023770: 2020 2072 6573 2e77 203d 2065 7870 2873     res.w = exp(s
-00023780: 656c 662e 7729 2a63 6f73 2862 290a 0a20  elf.w)*cos(b).. 
-00023790: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-000237a0: 730a 0a0a 6465 6620 736c 6572 7028 646f  s...def slerp(do
-000237b0: 7562 6c65 2074 2c20 7175 6174 2071 302c  uble t, quat q0,
-000237c0: 2071 7561 7420 7131 293a 0a20 2020 2022   quat q1):.    "
-000237d0: 2222 5370 6865 7269 6361 6c20 6c69 6e65  ""Spherical line
-000237e0: 6172 2069 6e74 6572 706f 6c61 7469 6f6e  ar interpolation
-000237f0: 2062 6574 7765 656e 2074 776f 2071 7561   between two qua
-00023800: 7465 726e 696f 6e73 2e0a 0a20 2020 2054  ternions...    T
-00023810: 6865 2072 6574 7572 6e20 7661 6c75 6520  he return value 
-00023820: 6973 2061 6e20 696e 7465 7270 6f6c 6174  is an interpolat
-00023830: 696f 6e20 6265 7477 6565 6e20 7130 2061  ion between q0 a
-00023840: 6e64 2071 312e 2046 6f72 2074 3d30 2e30  nd q1. For t=0.0
-00023850: 0a20 2020 2074 6865 2072 6574 7572 6e20  .    the return 
-00023860: 7661 6c75 6520 6571 7561 6c73 2071 302c  value equals q0,
-00023870: 2066 6f72 2074 3d31 2e30 2069 7420 6571   for t=1.0 it eq
-00023880: 7561 6c73 2071 312e 0a20 2020 2071 3020  uals q1..    q0 
-00023890: 616e 6420 7131 206d 7573 7420 6265 2075  and q1 must be u
-000238a0: 6e69 7420 7175 6174 6572 6e69 6f6e 732e  nit quaternions.
-000238b0: 0a20 2020 2022 2222 0a20 2020 2063 6465  .    """.    cde
-000238c0: 6620 646f 7562 6c65 206f 2c73 6f2c 612c  f double o,so,a,
-000238d0: 620a 0a20 2020 206f 203d 2061 636f 7328  b..    o = acos(
-000238e0: 7130 2e64 6f74 2871 3129 290a 2020 2020  q0.dot(q1)).    
-000238f0: 736f 203d 2073 696e 286f 290a 0a20 2020  so = sin(o)..   
-00023900: 2069 6620 2866 6162 7328 736f 293c 6570   if (fabs(so)<ep
-00023910: 7329 3a0a 2020 2020 2020 2020 7265 7475  s):.        retu
-00023920: 726e 2071 7561 7428 7130 290a 0a20 2020  rn quat(q0)..   
-00023930: 2061 203d 2073 696e 286f 2a28 312e 302d   a = sin(o*(1.0-
-00023940: 7429 2920 2f20 736f 0a20 2020 2062 203d  t)) / so.    b =
-00023950: 2073 696e 286f 2a74 2920 2f20 736f 0a20   sin(o*t) / so. 
-00023960: 2020 2072 6574 7572 6e20 7130 2a61 202b     return q0*a +
-00023970: 2071 312a 620a 0a64 6566 2073 7175 6164   q1*b..def squad
-00023980: 2864 6f75 626c 6520 742c 2071 7561 7420  (double t, quat 
-00023990: 612c 2071 7561 7420 622c 2071 7561 7420  a, quat b, quat 
-000239a0: 632c 2071 7561 7420 6429 3a0a 2020 2020  c, quat d):.    
-000239b0: 2222 2253 7068 6572 6963 616c 2063 7562  """Spherical cub
-000239c0: 6963 2069 6e74 6572 706f 6c61 7469 6f6e  ic interpolation
-000239d0: 2e22 2222 0a20 2020 2072 6574 7572 6e20  .""".    return 
-000239e0: 736c 6572 7028 322a 742a 2831 2e30 2d74  slerp(2*t*(1.0-t
-000239f0: 292c 2073 6c65 7270 2874 2c61 2c64 292c  ), slerp(t,a,d),
-00023a00: 2073 6c65 7270 2874 2c62 2c63 2929 0a0a   slerp(t,b,c))..
-00023a10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023a20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00023a50: 2323 2323 2323 0a0a 696d 706f 7274 2073  ######..import s
-00023a60: 7973 0a69 6620 7379 732e 7665 7273 696f  ys.if sys.versio
-00023a70: 6e5f 696e 666f 5b30 5d20 3e3d 2033 3a0a  n_info[0] >= 3:.
-00023a80: 2020 2020 696d 706f 7274 2063 6f70 7972      import copyr
-00023a90: 6567 2061 7320 636f 7079 5f72 6567 0a65  eg as copy_reg.e
-00023aa0: 6c73 653a 0a20 2020 2069 6d70 6f72 7420  lse:.    import 
-00023ab0: 636f 7079 5f72 6567 0a0a 6465 6620 5f76  copy_reg..def _v
-00023ac0: 6563 3363 6f6e 7374 7275 6374 2878 2c79  ec3construct(x,y
-00023ad0: 2c7a 293a 0a20 2020 2072 6574 7572 6e20  ,z):.    return 
-00023ae0: 7665 6333 2878 2c79 2c7a 290a 0a64 6566  vec3(x,y,z)..def
-00023af0: 205f 7665 6334 636f 6e73 7472 7563 7428   _vec4construct(
-00023b00: 782c 792c 7a2c 7729 3a0a 2020 2020 7265  x,y,z,w):.    re
-00023b10: 7475 726e 2076 6563 3428 782c 792c 7a2c  turn vec4(x,y,z,
-00023b20: 7729 0a0a 6465 6620 5f6d 6174 3363 6f6e  w)..def _mat3con
-00023b30: 7374 7275 6374 2862 312c 6232 2c62 3329  struct(b1,b2,b3)
-00023b40: 3a0a 2020 2020 7265 7475 726e 206d 6174  :.    return mat
-00023b50: 3328 6231 2c62 322c 6233 290a 0a64 6566  3(b1,b2,b3)..def
-00023b60: 205f 6d61 7434 636f 6e73 7472 7563 7428   _mat4construct(
-00023b70: 6231 2c62 322c 6233 2c62 3429 3a0a 2020  b1,b2,b3,b4):.  
-00023b80: 2020 7265 7475 726e 206d 6174 3428 6231    return mat4(b1
-00023b90: 2c62 322c 6233 2c62 3429 0a0a 6465 6620  ,b2,b3,b4)..def 
-00023ba0: 5f71 7561 7463 6f6e 7374 7275 6374 2877  _quatconstruct(w
-00023bb0: 2c78 2c79 2c7a 293a 0a20 2020 2072 6574  ,x,y,z):.    ret
-00023bc0: 7572 6e20 7175 6174 2877 2c78 2c79 2c7a  urn quat(w,x,y,z
-00023bd0: 290a 0a63 6f70 795f 7265 672e 636f 6e73  )..copy_reg.cons
-00023be0: 7472 7563 746f 7228 5f76 6563 3363 6f6e  tructor(_vec3con
-00023bf0: 7374 7275 6374 290a 636f 7079 5f72 6567  struct).copy_reg
-00023c00: 2e63 6f6e 7374 7275 6374 6f72 285f 7665  .constructor(_ve
-00023c10: 6334 636f 6e73 7472 7563 7429 0a63 6f70  c4construct).cop
-00023c20: 795f 7265 672e 636f 6e73 7472 7563 746f  y_reg.constructo
-00023c30: 7228 5f6d 6174 3363 6f6e 7374 7275 6374  r(_mat3construct
-00023c40: 290a 636f 7079 5f72 6567 2e63 6f6e 7374  ).copy_reg.const
-00023c50: 7275 6374 6f72 285f 6d61 7434 636f 6e73  ructor(_mat4cons
-00023c60: 7472 7563 7429 0a63 6f70 795f 7265 672e  truct).copy_reg.
-00023c70: 636f 6e73 7472 7563 746f 7228 5f71 7561  constructor(_qua
-00023c80: 7463 6f6e 7374 7275 6374 290a            tconstruct).
+0001b830: 2020 2074 3d28 745b 305d 2c6c 2b31 290a     t=(t[0],l+1).
+0001b840: 0a23 2020 2020 2020 2020 2020 2020 2020  .#              
+0001b850: 2020 4d33 5b6b 2c6c 5d20 3d20 7365 6c66    M3[k,l] = self
+0001b860: 5b74 5d0a 2020 2020 2020 2020 2020 2020  [t].            
+0001b870: 2020 2020 7620 3d20 7365 6c66 5b74 5d0a      v = self[t].
+0001b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b890: 6966 206b 3d3d 3020 616e 6420 6c3d 3d30  if k==0 and l==0
+0001b8a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001b8b0: 2020 2020 2020 4d33 2e6d 3131 203d 2076        M3.m11 = v
+0001b8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b8d0: 2069 6620 6b3d 3d30 2061 6e64 206c 3d3d   if k==0 and l==
+0001b8e0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+0001b8f0: 2020 2020 2020 204d 332e 6d31 3220 3d20         M3.m12 = 
+0001b900: 760a 2020 2020 2020 2020 2020 2020 2020  v.              
+0001b910: 2020 6966 206b 3d3d 3020 616e 6420 6c3d    if k==0 and l=
+0001b920: 3d32 3a0a 2020 2020 2020 2020 2020 2020  =2:.            
+0001b930: 2020 2020 2020 2020 4d33 2e6d 3133 203d          M3.m13 =
+0001b940: 2076 0a20 2020 2020 2020 2020 2020 2020   v.             
+0001b950: 2020 2069 6620 6b3d 3d31 2061 6e64 206c     if k==1 and l
+0001b960: 3d3d 303a 0a20 2020 2020 2020 2020 2020  ==0:.           
+0001b970: 2020 2020 2020 2020 204d 332e 6d32 3120           M3.m21 
+0001b980: 3d20 760a 2020 2020 2020 2020 2020 2020  = v.            
+0001b990: 2020 2020 6966 206b 3d3d 3120 616e 6420      if k==1 and 
+0001b9a0: 6c3d 3d31 3a0a 2020 2020 2020 2020 2020  l==1:.          
+0001b9b0: 2020 2020 2020 2020 2020 4d33 2e6d 3232            M3.m22
+0001b9c0: 203d 2076 0a20 2020 2020 2020 2020 2020   = v.           
+0001b9d0: 2020 2020 2069 6620 6b3d 3d31 2061 6e64       if k==1 and
+0001b9e0: 206c 3d3d 323a 0a20 2020 2020 2020 2020   l==2:.         
+0001b9f0: 2020 2020 2020 2020 2020 204d 332e 6d32             M3.m2
+0001ba00: 3320 3d20 760a 2020 2020 2020 2020 2020  3 = v.          
+0001ba10: 2020 2020 2020 6966 206b 3d3d 3220 616e        if k==2 an
+0001ba20: 6420 6c3d 3d30 3a0a 2020 2020 2020 2020  d l==0:.        
+0001ba30: 2020 2020 2020 2020 2020 2020 4d33 2e6d              M3.m
+0001ba40: 3331 203d 2076 0a20 2020 2020 2020 2020  31 = v.         
+0001ba50: 2020 2020 2020 2069 6620 6b3d 3d32 2061         if k==2 a
+0001ba60: 6e64 206c 3d3d 313a 0a20 2020 2020 2020  nd l==1:.       
+0001ba70: 2020 2020 2020 2020 2020 2020 204d 332e               M3.
+0001ba80: 6d33 3220 3d20 760a 2020 2020 2020 2020  m32 = v.        
+0001ba90: 2020 2020 2020 2020 6966 206b 3d3d 3220          if k==2 
+0001baa0: 616e 6420 6c3d 3d32 3a0a 2020 2020 2020  and l==2:.      
+0001bab0: 2020 2020 2020 2020 2020 2020 2020 4d33                M3
+0001bac0: 2e6d 3333 203d 2076 0a0a 2020 2020 2020  .m33 = v..      
+0001bad0: 2020 2020 2020 2020 2020 6c3d 6c2b 310a            l=l+1.
+0001bae0: 2020 2020 2020 2020 2020 2020 6b3d 6b2b              k=k+
+0001baf0: 310a 2020 2020 2020 2020 7265 7475 726e  1.        return
+0001bb00: 204d 330a 0a20 2020 2064 6566 2069 6e76   M3..    def inv
+0001bb10: 6572 7365 2873 656c 6629 3a0a 2020 2020  erse(self):.    
+0001bb20: 2020 2020 2222 2252 6574 7572 6e20 696e      """Return in
+0001bb30: 7665 7273 6520 6d61 7472 6978 2e0a 0a20  verse matrix... 
+0001bb40: 2020 2020 2020 203e 3e3e 204d 3d6d 6174         >>> M=mat
+0001bb50: 3428 302c 2d32 2e30 2c30 2c30 2c20 322e  4(0,-2.0,0,0, 2.
+0001bb60: 302c 302c 302c 302c 2030 2c30 2c32 2c30  0,0,0,0, 0,0,2,0
+0001bb70: 2c20 302c 302c 302c 3229 0a20 2020 2020  , 0,0,0,2).     
+0001bb80: 2020 203e 3e3e 2070 7269 6e74 204d 2e69     >>> print M.i
+0001bb90: 6e76 6572 7365 2829 0a20 2020 2020 2020  nverse().       
+0001bba0: 205b 2020 2030 2e30 3030 302c 2020 2020   [   0.0000,    
+0001bbb0: 302e 3530 3030 2c20 2020 2030 2e30 3030  0.5000,    0.000
+0001bbc0: 302c 2020 2020 302e 3030 3030 5d0a 2020  0,    0.0000].  
+0001bbd0: 2020 2020 2020 5b20 202d 302e 3530 3030        [  -0.5000
+0001bbe0: 2c20 2020 2030 2e30 3030 302c 2020 2020  ,    0.0000,    
+0001bbf0: 302e 3030 3030 2c20 2020 2030 2e30 3030  0.0000,    0.000
+0001bc00: 305d 0a20 2020 2020 2020 205b 2020 2030  0].        [   0
+0001bc10: 2e30 3030 302c 2020 2020 302e 3030 3030  .0000,    0.0000
+0001bc20: 2c20 2020 2030 2e35 3030 302c 2020 2020  ,    0.5000,    
+0001bc30: 302e 3030 3030 5d0a 2020 2020 2020 2020  0.0000].        
+0001bc40: 5b20 2020 302e 3030 3030 2c20 2020 2030  [   0.0000,    0
+0001bc50: 2e30 3030 302c 2020 2020 302e 3030 3030  .0000,    0.0000
+0001bc60: 2c20 2020 2030 2e35 3030 305d 0a20 2020  ,    0.5000].   
+0001bc70: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001bc80: 2063 6465 6620 6d61 7434 2072 6573 0a20   cdef mat4 res. 
+0001bc90: 2020 2020 2020 2063 6465 6620 7368 6f72         cdef shor
+0001bca0: 7420 692c 6a2c 2073 6967 6e0a 2020 2020  t i,j, sign.    
+0001bcb0: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
+0001bcc0: 6d34 5b31 365d 0a20 2020 2020 2020 2063  m4[16].        c
+0001bcd0: 6465 6620 646f 7562 6c65 206d 345f 7265  def double m4_re
+0001bce0: 735b 3136 5d0a 2020 2020 2020 2020 6364  s[16].        cd
+0001bcf0: 6566 2064 6f75 626c 6520 6465 742c 2064  ef double det, d
+0001bd00: 0a0a 2020 2020 2020 2020 6d34 5b30 5d20  ..        m4[0] 
+0001bd10: 3d20 7365 6c66 2e6d 3131 0a20 2020 2020  = self.m11.     
+0001bd20: 2020 206d 345b 315d 203d 2073 656c 662e     m4[1] = self.
+0001bd30: 6d31 320a 2020 2020 2020 2020 6d34 5b32  m12.        m4[2
+0001bd40: 5d20 3d20 7365 6c66 2e6d 3133 0a20 2020  ] = self.m13.   
+0001bd50: 2020 2020 206d 345b 335d 203d 2073 656c       m4[3] = sel
+0001bd60: 662e 6d31 340a 2020 2020 2020 2020 6d34  f.m14.        m4
+0001bd70: 5b34 5d20 3d20 7365 6c66 2e6d 3231 0a20  [4] = self.m21. 
+0001bd80: 2020 2020 2020 206d 345b 355d 203d 2073         m4[5] = s
+0001bd90: 656c 662e 6d32 320a 2020 2020 2020 2020  elf.m22.        
+0001bda0: 6d34 5b36 5d20 3d20 7365 6c66 2e6d 3233  m4[6] = self.m23
+0001bdb0: 0a20 2020 2020 2020 206d 345b 375d 203d  .        m4[7] =
+0001bdc0: 2073 656c 662e 6d32 340a 2020 2020 2020   self.m24.      
+0001bdd0: 2020 6d34 5b38 5d20 3d20 7365 6c66 2e6d    m4[8] = self.m
+0001bde0: 3331 0a20 2020 2020 2020 206d 345b 395d  31.        m4[9]
+0001bdf0: 203d 2073 656c 662e 6d33 320a 2020 2020   = self.m32.    
+0001be00: 2020 2020 6d34 5b31 305d 203d 2073 656c      m4[10] = sel
+0001be10: 662e 6d33 330a 2020 2020 2020 2020 6d34  f.m33.        m4
+0001be20: 5b31 315d 203d 2073 656c 662e 6d33 340a  [11] = self.m34.
+0001be30: 2020 2020 2020 2020 6d34 5b31 325d 203d          m4[12] =
+0001be40: 2073 656c 662e 6d34 310a 2020 2020 2020   self.m41.      
+0001be50: 2020 6d34 5b31 335d 203d 2073 656c 662e    m4[13] = self.
+0001be60: 6d34 320a 2020 2020 2020 2020 6d34 5b31  m42.        m4[1
+0001be70: 345d 203d 2073 656c 662e 6d34 330a 2020  4] = self.m43.  
+0001be80: 2020 2020 2020 6d34 5b31 355d 203d 2073        m4[15] = s
+0001be90: 656c 662e 6d34 340a 0a20 2020 2020 2020  elf.m44..       
+0001bea0: 2064 6574 3d73 656c 662e 6465 7465 726d   det=self.determ
+0001beb0: 696e 616e 7428 290a 2020 2020 2020 2020  inant().        
+0001bec0: 6966 2066 6162 7328 6465 7429 3c3d 6570  if fabs(det)<=ep
+0001bed0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+0001bee0: 6169 7365 205a 6572 6f44 6976 6973 696f  aise ZeroDivisio
+0001bef0: 6e45 7272 6f72 2c22 6d61 7472 6978 206e  nError,"matrix n
+0001bf00: 6f74 2069 6e76 6572 7469 626c 6522 0a0a  ot invertible"..
+0001bf10: 2020 2020 2020 2020 693d 300a 2020 2020          i=0.    
+0001bf20: 2020 2020 7768 696c 6520 693c 343a 0a20      while i<4:. 
+0001bf30: 2020 2020 2020 2020 2020 206a 3d30 0a20             j=0. 
+0001bf40: 2020 2020 2020 2020 2020 2077 6869 6c65             while
+0001bf50: 206a 3c34 3a0a 2020 2020 2020 2020 2020   j<4:.          
+0001bf60: 2020 2020 2020 7369 676e 3d31 2d28 2869        sign=1-((i
+0001bf70: 2b6a 2925 3229 2a32 0a20 2020 2020 2020  +j)%2)*2.       
+0001bf80: 2020 2020 2020 2020 2064 203d 205f 7375           d = _su
+0001bf90: 6264 6574 286d 342c 692c 6a29 0a20 2020  bdet(m4,i,j).   
+0001bfa0: 2020 2020 2020 2020 2020 2020 206d 345f               m4_
+0001bfb0: 7265 735b 6a2a 342b 695d 3d73 6967 6e2a  res[j*4+i]=sign*
+0001bfc0: 642f 6465 740a 2020 2020 2020 2020 2020  d/det.          
+0001bfd0: 2020 2020 2020 6a3d 6a2b 310a 2020 2020        j=j+1.    
+0001bfe0: 2020 2020 2020 2020 693d 692b 310a 0a20          i=i+1.. 
+0001bff0: 2020 2020 2020 2072 6573 203d 206d 6174         res = mat
+0001c000: 3428 290a 2020 2020 2020 2020 7265 732e  4().        res.
+0001c010: 6d31 3120 3d20 6d34 5f72 6573 5b30 5d0a  m11 = m4_res[0].
+0001c020: 2020 2020 2020 2020 7265 732e 6d31 3220          res.m12 
+0001c030: 3d20 6d34 5f72 6573 5b31 5d0a 2020 2020  = m4_res[1].    
+0001c040: 2020 2020 7265 732e 6d31 3320 3d20 6d34      res.m13 = m4
+0001c050: 5f72 6573 5b32 5d0a 2020 2020 2020 2020  _res[2].        
+0001c060: 7265 732e 6d31 3420 3d20 6d34 5f72 6573  res.m14 = m4_res
+0001c070: 5b33 5d0a 2020 2020 2020 2020 7265 732e  [3].        res.
+0001c080: 6d32 3120 3d20 6d34 5f72 6573 5b34 5d0a  m21 = m4_res[4].
+0001c090: 2020 2020 2020 2020 7265 732e 6d32 3220          res.m22 
+0001c0a0: 3d20 6d34 5f72 6573 5b35 5d0a 2020 2020  = m4_res[5].    
+0001c0b0: 2020 2020 7265 732e 6d32 3320 3d20 6d34      res.m23 = m4
+0001c0c0: 5f72 6573 5b36 5d0a 2020 2020 2020 2020  _res[6].        
+0001c0d0: 7265 732e 6d32 3420 3d20 6d34 5f72 6573  res.m24 = m4_res
+0001c0e0: 5b37 5d0a 2020 2020 2020 2020 7265 732e  [7].        res.
+0001c0f0: 6d33 3120 3d20 6d34 5f72 6573 5b38 5d0a  m31 = m4_res[8].
+0001c100: 2020 2020 2020 2020 7265 732e 6d33 3220          res.m32 
+0001c110: 3d20 6d34 5f72 6573 5b39 5d0a 2020 2020  = m4_res[9].    
+0001c120: 2020 2020 7265 732e 6d33 3320 3d20 6d34      res.m33 = m4
+0001c130: 5f72 6573 5b31 305d 0a20 2020 2020 2020  _res[10].       
+0001c140: 2072 6573 2e6d 3334 203d 206d 345f 7265   res.m34 = m4_re
+0001c150: 735b 3131 5d0a 2020 2020 2020 2020 7265  s[11].        re
+0001c160: 732e 6d34 3120 3d20 6d34 5f72 6573 5b31  s.m41 = m4_res[1
+0001c170: 325d 0a20 2020 2020 2020 2072 6573 2e6d  2].        res.m
+0001c180: 3432 203d 206d 345f 7265 735b 3133 5d0a  42 = m4_res[13].
+0001c190: 2020 2020 2020 2020 7265 732e 6d34 3320          res.m43 
+0001c1a0: 3d20 6d34 5f72 6573 5b31 345d 0a20 2020  = m4_res[14].   
+0001c1b0: 2020 2020 2072 6573 2e6d 3434 203d 206d       res.m44 = m
+0001c1c0: 345f 7265 735b 3135 5d0a 2020 2020 2020  4_res[15].      
+0001c1d0: 2020 7265 7475 726e 2072 6573 0a0a 0a20    return res... 
+0001c1e0: 2020 2064 6566 2074 7261 6e73 6c61 7469     def translati
+0001c1f0: 6f6e 2873 656c 662c 2074 293a 0a20 2020  on(self, t):.   
+0001c200: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+0001c210: 7261 6e73 6c61 7469 6f6e 206d 6174 7269  ranslation matri
+0001c220: 782e 0a0a 2020 2020 2020 2020 7420 6d75  x...        t mu
+0001c230: 7374 2062 6520 6120 332d 7365 7175 656e  st be a 3-sequen
+0001c240: 6365 2028 652e 672e 2061 2076 6563 3329  ce (e.g. a vec3)
+0001c250: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0001c260: 2020 2020 2020 6364 6566 206d 6174 3420        cdef mat4 
+0001c270: 7265 730a 2020 2020 2020 2020 7265 7320  res.        res 
+0001c280: 3d20 6d61 7434 2829 0a20 2020 2020 2020  = mat4().       
+0001c290: 2072 6573 2e6d 3131 203d 2031 2e30 0a20   res.m11 = 1.0. 
+0001c2a0: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
+0001c2b0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001c2c0: 2e6d 3133 203d 2030 2e30 0a20 2020 2020  .m13 = 0.0.     
+0001c2d0: 2020 2072 6573 2e6d 3134 203d 2074 5b30     res.m14 = t[0
+0001c2e0: 5d0a 2020 2020 2020 2020 7265 732e 6d32  ].        res.m2
+0001c2f0: 3120 3d20 302e 300a 2020 2020 2020 2020  1 = 0.0.        
+0001c300: 7265 732e 6d32 3220 3d20 312e 300a 2020  res.m22 = 1.0.  
+0001c310: 2020 2020 2020 7265 732e 6d32 3320 3d20        res.m23 = 
+0001c320: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
+0001c330: 6d32 3420 3d20 745b 315d 0a20 2020 2020  m24 = t[1].     
+0001c340: 2020 2072 6573 2e6d 3331 203d 2030 2e30     res.m31 = 0.0
+0001c350: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
+0001c360: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
+0001c370: 6573 2e6d 3333 203d 2031 2e30 0a20 2020  es.m33 = 1.0.   
+0001c380: 2020 2020 2072 6573 2e6d 3334 203d 2074       res.m34 = t
+0001c390: 5b32 5d0a 2020 2020 2020 2020 7265 732e  [2].        res.
+0001c3a0: 6d34 3120 3d20 302e 300a 2020 2020 2020  m41 = 0.0.      
+0001c3b0: 2020 7265 732e 6d34 3220 3d20 302e 300a    res.m42 = 0.0.
+0001c3c0: 2020 2020 2020 2020 7265 732e 6d34 3320          res.m43 
+0001c3d0: 3d20 302e 300a 2020 2020 2020 2020 7265  = 0.0.        re
+0001c3e0: 732e 6d34 3420 3d20 312e 300a 2020 2020  s.m44 = 1.0.    
+0001c3f0: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
+0001c400: 2020 2020 6465 6620 7363 616c 696e 6728      def scaling(
+0001c410: 7365 6c66 2c20 7329 3a0a 2020 2020 2020  self, s):.      
+0001c420: 2020 2222 2252 6574 7572 6e20 7363 616c    """Return scal
+0001c430: 696e 6720 6d61 7472 6978 2e0a 0a20 2020  ing matrix...   
+0001c440: 2020 2020 2073 206d 7573 7420 6265 2061       s must be a
+0001c450: 2033 2d73 6571 7565 6e63 6520 2865 2e67   3-sequence (e.g
+0001c460: 2e20 6120 7665 6333 292e 0a20 2020 2020  . a vec3)..     
+0001c470: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+0001c480: 6465 6620 6d61 7434 2072 6573 0a20 2020  def mat4 res.   
+0001c490: 2020 2020 2072 6573 203d 206d 6174 3428       res = mat4(
+0001c4a0: 290a 2020 2020 2020 2020 7265 732e 6d31  ).        res.m1
+0001c4b0: 3120 3d20 735b 305d 0a20 2020 2020 2020  1 = s[0].       
+0001c4c0: 2072 6573 2e6d 3132 203d 2030 2e30 0a20   res.m12 = 0.0. 
+0001c4d0: 2020 2020 2020 2072 6573 2e6d 3133 203d         res.m13 =
+0001c4e0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001c4f0: 2e6d 3134 203d 2030 2e30 0a20 2020 2020  .m14 = 0.0.     
+0001c500: 2020 2072 6573 2e6d 3231 203d 2030 2e30     res.m21 = 0.0
+0001c510: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
+0001c520: 203d 2073 5b31 5d0a 2020 2020 2020 2020   = s[1].        
+0001c530: 7265 732e 6d32 3320 3d20 302e 300a 2020  res.m23 = 0.0.  
+0001c540: 2020 2020 2020 7265 732e 6d32 3420 3d20        res.m24 = 
+0001c550: 302e 300a 2020 2020 2020 2020 7265 732e  0.0.        res.
+0001c560: 6d33 3120 3d20 302e 300a 2020 2020 2020  m31 = 0.0.      
+0001c570: 2020 7265 732e 6d33 3220 3d20 302e 300a    res.m32 = 0.0.
+0001c580: 2020 2020 2020 2020 7265 732e 6d33 3320          res.m33 
+0001c590: 3d20 735b 325d 0a20 2020 2020 2020 2072  = s[2].        r
+0001c5a0: 6573 2e6d 3334 203d 2030 2e30 0a20 2020  es.m34 = 0.0.   
+0001c5b0: 2020 2020 2072 6573 2e6d 3431 203d 2030       res.m41 = 0
+0001c5c0: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
+0001c5d0: 3432 203d 2030 2e30 0a20 2020 2020 2020  42 = 0.0.       
+0001c5e0: 2072 6573 2e6d 3433 203d 2030 2e30 0a20   res.m43 = 0.0. 
+0001c5f0: 2020 2020 2020 2072 6573 2e6d 3434 203d         res.m44 =
+0001c600: 2031 2e30 0a20 2020 2020 2020 2072 6574   1.0.        ret
+0001c610: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
+0001c620: 2072 6f74 6174 696f 6e28 7365 6c66 2c20   rotation(self, 
+0001c630: 616e 676c 652c 2061 7869 7329 3a0a 2020  angle, axis):.  
+0001c640: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+0001c650: 726f 7461 7469 6f6e 206d 6174 7269 782e  rotation matrix.
+0001c660: 0a0a 2020 2020 2020 2020 616e 676c 6520  ..        angle 
+0001c670: 6d75 7374 2062 6520 6769 7665 6e20 696e  must be given in
+0001c680: 2072 6164 6961 6e73 2e20 6178 6973 206d   radians. axis m
+0001c690: 7573 7420 6265 2061 2033 2d73 6571 7565  ust be a 3-seque
+0001c6a0: 6e63 652e 0a20 2020 2020 2020 2022 2222  nce..        """
+0001c6b0: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
+0001c6c0: 7562 6c65 2063 616e 676c 652c 2061 782c  uble cangle, ax,
+0001c6d0: 2061 792c 2061 7a0a 2020 2020 2020 2020   ay, az.        
+0001c6e0: 6364 6566 2064 6f75 626c 6520 7371 725f  cdef double sqr_
+0001c6f0: 612c 2073 7172 5f62 2c20 7371 725f 632c  a, sqr_b, sqr_c,
+0001c700: 206c 656e 320a 2020 2020 2020 2020 6364   len2.        cd
+0001c710: 6566 2064 6f75 626c 6520 6b31 2c20 6b32  ef double k1, k2
+0001c720: 2c20 6b33 2c20 6b31 6162 2c20 6b31 6163  , k3, k1ab, k1ac
+0001c730: 2c20 6b31 6263 2c20 6b33 612c 206b 3362  , k1bc, k3a, k3b
+0001c740: 2c20 6b33 630a 2020 2020 2020 2020 6364  , k3c.        cd
+0001c750: 6566 206d 6174 3420 7265 730a 0a20 2020  ef mat4 res..   
+0001c760: 2020 2020 2063 616e 676c 6520 2020 3d20       cangle   = 
+0001c770: 616e 676c 650a 2020 2020 2020 2020 6178  angle.        ax
+0001c780: 2020 2020 3d20 6178 6973 5b30 5d0a 2020      = axis[0].  
+0001c790: 2020 2020 2020 6179 2020 2020 3d20 6178        ay    = ax
+0001c7a0: 6973 5b31 5d0a 2020 2020 2020 2020 617a  is[1].        az
+0001c7b0: 2020 2020 3d20 6178 6973 5b32 5d0a 2020      = axis[2].  
+0001c7c0: 2020 2020 2020 7371 725f 6120 3d20 6178        sqr_a = ax
+0001c7d0: 2a61 780a 2020 2020 2020 2020 7371 725f  *ax.        sqr_
+0001c7e0: 6220 3d20 6179 2a61 790a 2020 2020 2020  b = ay*ay.      
+0001c7f0: 2020 7371 725f 6320 3d20 617a 2a61 7a0a    sqr_c = az*az.
+0001c800: 2020 2020 2020 2020 6c65 6e32 2020 3d20          len2  = 
+0001c810: 7371 725f 612b 7371 725f 622b 7371 725f  sqr_a+sqr_b+sqr_
+0001c820: 630a 0a20 2020 2020 2020 206b 3220 2020  c..        k2   
+0001c830: 203d 2063 6f73 2863 616e 676c 6529 0a20   = cos(cangle). 
+0001c840: 2020 2020 2020 206b 3120 2020 203d 2028         k1    = (
+0001c850: 312e 302d 6b32 292f 6c65 6e32 0a20 2020  1.0-k2)/len2.   
+0001c860: 2020 2020 206b 3320 2020 203d 2073 696e       k3    = sin
+0001c870: 2863 616e 676c 6529 2f73 7172 7428 6c65  (cangle)/sqrt(le
+0001c880: 6e32 290a 2020 2020 2020 2020 6b31 6162  n2).        k1ab
+0001c890: 2020 3d20 6b31 2a61 782a 6179 0a20 2020    = k1*ax*ay.   
+0001c8a0: 2020 2020 206b 3161 6320 203d 206b 312a       k1ac  = k1*
+0001c8b0: 6178 2a61 7a0a 2020 2020 2020 2020 6b31  ax*az.        k1
+0001c8c0: 6263 2020 3d20 6b31 2a61 792a 617a 0a20  bc  = k1*ay*az. 
+0001c8d0: 2020 2020 2020 206b 3361 2020 203d 206b         k3a   = k
+0001c8e0: 332a 6178 0a20 2020 2020 2020 206b 3362  3*ax.        k3b
+0001c8f0: 2020 203d 206b 332a 6179 0a20 2020 2020     = k3*ay.     
+0001c900: 2020 206b 3363 2020 203d 206b 332a 617a     k3c   = k3*az
+0001c910: 0a0a 2020 2020 2020 2020 7265 7320 3d20  ..        res = 
+0001c920: 6d61 7434 2829 0a20 2020 2020 2020 2072  mat4().        r
+0001c930: 6573 2e6d 3131 203d 206b 312a 7371 725f  es.m11 = k1*sqr_
+0001c940: 612b 6b32 0a20 2020 2020 2020 2072 6573  a+k2.        res
+0001c950: 2e6d 3132 203d 206b 3161 622d 6b33 630a  .m12 = k1ab-k3c.
+0001c960: 2020 2020 2020 2020 7265 732e 6d31 3320          res.m13 
+0001c970: 3d20 6b31 6163 2b6b 3362 0a20 2020 2020  = k1ac+k3b.     
+0001c980: 2020 2072 6573 2e6d 3134 203d 2030 2e30     res.m14 = 0.0
+0001c990: 0a20 2020 2020 2020 2072 6573 2e6d 3231  .        res.m21
+0001c9a0: 203d 206b 3161 622b 6b33 630a 2020 2020   = k1ab+k3c.    
+0001c9b0: 2020 2020 7265 732e 6d32 3220 3d20 6b31      res.m22 = k1
+0001c9c0: 2a73 7172 5f62 2b6b 320a 2020 2020 2020  *sqr_b+k2.      
+0001c9d0: 2020 7265 732e 6d32 3320 3d20 6b31 6263    res.m23 = k1bc
+0001c9e0: 2d6b 3361 0a20 2020 2020 2020 2072 6573  -k3a.        res
+0001c9f0: 2e6d 3234 203d 2030 2e30 0a20 2020 2020  .m24 = 0.0.     
+0001ca00: 2020 2072 6573 2e6d 3331 203d 206b 3161     res.m31 = k1a
+0001ca10: 632d 6b33 620a 2020 2020 2020 2020 7265  c-k3b.        re
+0001ca20: 732e 6d33 3220 3d20 6b31 6263 2b6b 3361  s.m32 = k1bc+k3a
+0001ca30: 0a20 2020 2020 2020 2072 6573 2e6d 3333  .        res.m33
+0001ca40: 203d 206b 312a 7371 725f 632b 6b32 0a20   = k1*sqr_c+k2. 
+0001ca50: 2020 2020 2020 2072 6573 2e6d 3334 203d         res.m34 =
+0001ca60: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001ca70: 2e6d 3431 203d 2030 2e30 0a20 2020 2020  .m41 = 0.0.     
+0001ca80: 2020 2072 6573 2e6d 3432 203d 2030 2e30     res.m42 = 0.0
+0001ca90: 0a20 2020 2020 2020 2072 6573 2e6d 3433  .        res.m43
+0001caa0: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
+0001cab0: 6573 2e6d 3434 203d 2031 2e30 0a20 2020  es.m44 = 1.0.   
+0001cac0: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
+0001cad0: 0a0a 2020 2020 6465 6620 7472 616e 736c  ..    def transl
+0001cae0: 6174 6528 7365 6c66 2c20 7429 3a0a 2020  ate(self, t):.  
+0001caf0: 2020 2020 2020 2222 2243 6f6e 6361 7465        """Concate
+0001cb00: 6e61 7465 2061 2074 7261 6e73 6c61 7469  nate a translati
+0001cb10: 6f6e 2e0a 0a20 2020 2020 2020 2074 206d  on...        t m
+0001cb20: 7573 7420 6265 2061 2033 2d73 6571 7565  ust be a 3-seque
+0001cb30: 6e63 6520 2865 2e67 2e20 6120 7665 6333  nce (e.g. a vec3
+0001cb40: 292e 0a20 2020 2020 2020 2022 2222 0a20  )..        """. 
+0001cb50: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
+0001cb60: 6c65 2074 782c 2074 792c 2074 7a0a 2020  le tx, ty, tz.  
+0001cb70: 2020 2020 2020 7478 203d 2074 5b30 5d0a        tx = t[0].
+0001cb80: 2020 2020 2020 2020 7479 203d 2074 5b31          ty = t[1
+0001cb90: 5d0a 2020 2020 2020 2020 747a 203d 2074  ].        tz = t
+0001cba0: 5b32 5d0a 0a20 2020 2020 2020 2073 656c  [2]..        sel
+0001cbb0: 662e 6d31 3420 3d20 7365 6c66 2e6d 3131  f.m14 = self.m11
+0001cbc0: 2a74 7820 2b20 7365 6c66 2e6d 3132 2a74  *tx + self.m12*t
+0001cbd0: 7920 2b20 7365 6c66 2e6d 3133 2a74 7a20  y + self.m13*tz 
+0001cbe0: 2b20 7365 6c66 2e6d 3134 0a20 2020 2020  + self.m14.     
+0001cbf0: 2020 2073 656c 662e 6d32 3420 3d20 7365     self.m24 = se
+0001cc00: 6c66 2e6d 3231 2a74 7820 2b20 7365 6c66  lf.m21*tx + self
+0001cc10: 2e6d 3232 2a74 7920 2b20 7365 6c66 2e6d  .m22*ty + self.m
+0001cc20: 3233 2a74 7a20 2b20 7365 6c66 2e6d 3234  23*tz + self.m24
+0001cc30: 0a20 2020 2020 2020 2073 656c 662e 6d33  .        self.m3
+0001cc40: 3420 3d20 7365 6c66 2e6d 3331 2a74 7820  4 = self.m31*tx 
+0001cc50: 2b20 7365 6c66 2e6d 3332 2a74 7920 2b20  + self.m32*ty + 
+0001cc60: 7365 6c66 2e6d 3333 2a74 7a20 2b20 7365  self.m33*tz + se
+0001cc70: 6c66 2e6d 3334 0a20 2020 2020 2020 2073  lf.m34.        s
+0001cc80: 656c 662e 6d34 3420 3d20 7365 6c66 2e6d  elf.m44 = self.m
+0001cc90: 3431 2a74 7820 2b20 7365 6c66 2e6d 3432  41*tx + self.m42
+0001cca0: 2a74 7920 2b20 7365 6c66 2e6d 3433 2a74  *ty + self.m43*t
+0001ccb0: 7a20 2b20 7365 6c66 2e6d 3434 0a20 2020  z + self.m44.   
+0001ccc0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001ccd0: 0a0a 2020 2020 6465 6620 7363 616c 6528  ..    def scale(
+0001cce0: 7365 6c66 2c20 7329 3a0a 2020 2020 2020  self, s):.      
+0001ccf0: 2020 2222 2243 6f6e 6361 7465 6e61 7465    """Concatenate
+0001cd00: 2061 2073 6361 6c69 6e67 2e0a 0a20 2020   a scaling...   
+0001cd10: 2020 2020 2073 206d 7573 7420 6265 2061       s must be a
+0001cd20: 2033 2d73 6571 7565 6e63 6520 2865 2e67   3-sequence (e.g
+0001cd30: 2e20 6120 7665 6333 292e 0a20 2020 2020  . a vec3)..     
+0001cd40: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+0001cd50: 6465 6620 646f 7562 6c65 2073 782c 2073  def double sx, s
+0001cd60: 792c 2073 7a0a 2020 2020 2020 2020 7378  y, sz.        sx
+0001cd70: 203d 2073 5b30 5d0a 2020 2020 2020 2020   = s[0].        
+0001cd80: 7379 203d 2073 5b31 5d0a 2020 2020 2020  sy = s[1].      
+0001cd90: 2020 737a 203d 2073 5b32 5d0a 2020 2020    sz = s[2].    
+0001cda0: 2020 2020 7365 6c66 2e6d 3131 203d 2073      self.m11 = s
+0001cdb0: 656c 662e 6d31 312a 7378 0a20 2020 2020  elf.m11*sx.     
+0001cdc0: 2020 2073 656c 662e 6d31 3220 3d20 7365     self.m12 = se
+0001cdd0: 6c66 2e6d 3132 2a73 790a 2020 2020 2020  lf.m12*sy.      
+0001cde0: 2020 7365 6c66 2e6d 3133 203d 2073 656c    self.m13 = sel
+0001cdf0: 662e 6d31 332a 737a 0a20 2020 2020 2020  f.m13*sz.       
+0001ce00: 2073 656c 662e 6d32 3120 3d20 7365 6c66   self.m21 = self
+0001ce10: 2e6d 3231 2a73 780a 2020 2020 2020 2020  .m21*sx.        
+0001ce20: 7365 6c66 2e6d 3232 203d 2073 656c 662e  self.m22 = self.
+0001ce30: 6d32 322a 7379 0a20 2020 2020 2020 2073  m22*sy.        s
+0001ce40: 656c 662e 6d32 3320 3d20 7365 6c66 2e6d  elf.m23 = self.m
+0001ce50: 3233 2a73 7a0a 2020 2020 2020 2020 7365  23*sz.        se
+0001ce60: 6c66 2e6d 3331 203d 2073 656c 662e 6d33  lf.m31 = self.m3
+0001ce70: 312a 7378 0a20 2020 2020 2020 2073 656c  1*sx.        sel
+0001ce80: 662e 6d33 3220 3d20 7365 6c66 2e6d 3332  f.m32 = self.m32
+0001ce90: 2a73 790a 2020 2020 2020 2020 7365 6c66  *sy.        self
+0001cea0: 2e6d 3333 203d 2073 656c 662e 6d33 332a  .m33 = self.m33*
+0001ceb0: 737a 0a20 2020 2020 2020 2073 656c 662e  sz.        self.
+0001cec0: 6d34 3120 3d20 7365 6c66 2e6d 3431 2a73  m41 = self.m41*s
+0001ced0: 780a 2020 2020 2020 2020 7365 6c66 2e6d  x.        self.m
+0001cee0: 3432 203d 2073 656c 662e 6d34 322a 7379  42 = self.m42*sy
+0001cef0: 0a20 2020 2020 2020 2073 656c 662e 6d34  .        self.m4
+0001cf00: 3320 3d20 7365 6c66 2e6d 3433 2a73 7a0a  3 = self.m43*sz.
+0001cf10: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001cf20: 656c 660a 0a20 2020 2064 6566 2072 6f74  elf..    def rot
+0001cf30: 6174 6528 7365 6c66 2c20 616e 676c 652c  ate(self, angle,
+0001cf40: 2061 7869 7329 3a0a 2020 2020 2020 2020   axis):.        
+0001cf50: 2222 2243 6f6e 6361 7465 6e61 7465 2061  """Concatenate a
+0001cf60: 2072 6f74 6174 696f 6e2e 0a0a 2020 2020   rotation...    
+0001cf70: 2020 2020 616e 676c 6520 6d75 7374 2062      angle must b
+0001cf80: 6520 6769 7665 6e20 696e 2072 6164 6961  e given in radia
+0001cf90: 6e73 2e20 6178 6973 206d 7573 7420 6265  ns. axis must be
+0001cfa0: 2061 2033 2d73 6571 7565 6e63 652e 0a20   a 3-sequence.. 
+0001cfb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0001cfc0: 2020 2063 6465 6620 6d61 7434 2052 0a20     cdef mat4 R. 
+0001cfd0: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
+0001cfe0: 6c65 2063 312c 2063 322c 2063 332c 2063  le c1, c2, c3, c
+0001cff0: 340a 2020 2020 2020 2020 523d 7365 6c66  4.        R=self
+0001d000: 2e72 6f74 6174 696f 6e28 616e 676c 652c  .rotation(angle,
+0001d010: 2061 7869 7329 0a0a 2020 2020 2020 2020   axis)..        
+0001d020: 2320 7365 6c66 2a52 2020 2869 6e2d 706c  # self*R  (in-pl
+0001d030: 6163 6529 0a20 2020 2020 2020 2063 3120  ace).        c1 
+0001d040: 3d20 7365 6c66 2e6d 3131 0a20 2020 2020  = self.m11.     
+0001d050: 2020 2063 3220 3d20 7365 6c66 2e6d 3132     c2 = self.m12
+0001d060: 0a20 2020 2020 2020 2063 3320 3d20 7365  .        c3 = se
+0001d070: 6c66 2e6d 3133 0a20 2020 2020 2020 2063  lf.m13.        c
+0001d080: 3420 3d20 7365 6c66 2e6d 3134 0a20 2020  4 = self.m14.   
+0001d090: 2020 2020 2073 656c 662e 6d31 3120 3d20       self.m11 = 
+0001d0a0: 6331 2a52 2e6d 3131 2b63 322a 522e 6d32  c1*R.m11+c2*R.m2
+0001d0b0: 312b 6333 2a52 2e6d 3331 2b63 342a 522e  1+c3*R.m31+c4*R.
+0001d0c0: 6d34 310a 2020 2020 2020 2020 7365 6c66  m41.        self
+0001d0d0: 2e6d 3132 203d 2063 312a 522e 6d31 322b  .m12 = c1*R.m12+
+0001d0e0: 6332 2a52 2e6d 3232 2b63 332a 522e 6d33  c2*R.m22+c3*R.m3
+0001d0f0: 322b 6334 2a52 2e6d 3432 0a20 2020 2020  2+c4*R.m42.     
+0001d100: 2020 2073 656c 662e 6d31 3320 3d20 6331     self.m13 = c1
+0001d110: 2a52 2e6d 3133 2b63 322a 522e 6d32 332b  *R.m13+c2*R.m23+
+0001d120: 6333 2a52 2e6d 3333 2b63 342a 522e 6d34  c3*R.m33+c4*R.m4
+0001d130: 330a 2020 2020 2020 2020 7365 6c66 2e6d  3.        self.m
+0001d140: 3134 203d 2063 312a 522e 6d31 342b 6332  14 = c1*R.m14+c2
+0001d150: 2a52 2e6d 3234 2b63 332a 522e 6d33 342b  *R.m24+c3*R.m34+
+0001d160: 6334 2a52 2e6d 3434 0a0a 2020 2020 2020  c4*R.m44..      
+0001d170: 2020 6331 203d 2073 656c 662e 6d32 310a    c1 = self.m21.
+0001d180: 2020 2020 2020 2020 6332 203d 2073 656c          c2 = sel
+0001d190: 662e 6d32 320a 2020 2020 2020 2020 6333  f.m22.        c3
+0001d1a0: 203d 2073 656c 662e 6d32 330a 2020 2020   = self.m23.    
+0001d1b0: 2020 2020 6334 203d 2073 656c 662e 6d32      c4 = self.m2
+0001d1c0: 340a 2020 2020 2020 2020 7365 6c66 2e6d  4.        self.m
+0001d1d0: 3231 203d 2063 312a 522e 6d31 312b 6332  21 = c1*R.m11+c2
+0001d1e0: 2a52 2e6d 3231 2b63 332a 522e 6d33 312b  *R.m21+c3*R.m31+
+0001d1f0: 6334 2a52 2e6d 3431 0a20 2020 2020 2020  c4*R.m41.       
+0001d200: 2073 656c 662e 6d32 3220 3d20 6331 2a52   self.m22 = c1*R
+0001d210: 2e6d 3132 2b63 322a 522e 6d32 322b 6333  .m12+c2*R.m22+c3
+0001d220: 2a52 2e6d 3332 2b63 342a 522e 6d34 320a  *R.m32+c4*R.m42.
+0001d230: 2020 2020 2020 2020 7365 6c66 2e6d 3233          self.m23
+0001d240: 203d 2063 312a 522e 6d31 332b 6332 2a52   = c1*R.m13+c2*R
+0001d250: 2e6d 3233 2b63 332a 522e 6d33 332b 6334  .m23+c3*R.m33+c4
+0001d260: 2a52 2e6d 3433 0a20 2020 2020 2020 2073  *R.m43.        s
+0001d270: 656c 662e 6d32 3420 3d20 6331 2a52 2e6d  elf.m24 = c1*R.m
+0001d280: 3134 2b63 322a 522e 6d32 342b 6333 2a52  14+c2*R.m24+c3*R
+0001d290: 2e6d 3334 2b63 342a 522e 6d34 340a 0a20  .m34+c4*R.m44.. 
+0001d2a0: 2020 2020 2020 2063 3120 3d20 7365 6c66         c1 = self
+0001d2b0: 2e6d 3331 0a20 2020 2020 2020 2063 3220  .m31.        c2 
+0001d2c0: 3d20 7365 6c66 2e6d 3332 0a20 2020 2020  = self.m32.     
+0001d2d0: 2020 2063 3320 3d20 7365 6c66 2e6d 3333     c3 = self.m33
+0001d2e0: 0a20 2020 2020 2020 2063 3420 3d20 7365  .        c4 = se
+0001d2f0: 6c66 2e6d 3334 0a20 2020 2020 2020 2073  lf.m34.        s
+0001d300: 656c 662e 6d33 3120 3d20 6331 2a52 2e6d  elf.m31 = c1*R.m
+0001d310: 3131 2b63 322a 522e 6d32 312b 6333 2a52  11+c2*R.m21+c3*R
+0001d320: 2e6d 3331 2b63 342a 522e 6d34 310a 2020  .m31+c4*R.m41.  
+0001d330: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
+0001d340: 2063 312a 522e 6d31 322b 6332 2a52 2e6d   c1*R.m12+c2*R.m
+0001d350: 3232 2b63 332a 522e 6d33 322b 6334 2a52  22+c3*R.m32+c4*R
+0001d360: 2e6d 3432 0a20 2020 2020 2020 2073 656c  .m42.        sel
+0001d370: 662e 6d33 3320 3d20 6331 2a52 2e6d 3133  f.m33 = c1*R.m13
+0001d380: 2b63 322a 522e 6d32 332b 6333 2a52 2e6d  +c2*R.m23+c3*R.m
+0001d390: 3333 2b63 342a 522e 6d34 330a 2020 2020  33+c4*R.m43.    
+0001d3a0: 2020 2020 7365 6c66 2e6d 3334 203d 2063      self.m34 = c
+0001d3b0: 312a 522e 6d31 342b 6332 2a52 2e6d 3234  1*R.m14+c2*R.m24
+0001d3c0: 2b63 332a 522e 6d33 342b 6334 2a52 2e6d  +c3*R.m34+c4*R.m
+0001d3d0: 3434 0a0a 2020 2020 2020 2020 6331 203d  44..        c1 =
+0001d3e0: 2073 656c 662e 6d34 310a 2020 2020 2020   self.m41.      
+0001d3f0: 2020 6332 203d 2073 656c 662e 6d34 320a    c2 = self.m42.
+0001d400: 2020 2020 2020 2020 6333 203d 2073 656c          c3 = sel
+0001d410: 662e 6d34 330a 2020 2020 2020 2020 6334  f.m43.        c4
+0001d420: 203d 2073 656c 662e 6d34 340a 2020 2020   = self.m44.    
+0001d430: 2020 2020 7365 6c66 2e6d 3431 203d 2063      self.m41 = c
+0001d440: 312a 522e 6d31 312b 6332 2a52 2e6d 3231  1*R.m11+c2*R.m21
+0001d450: 2b63 332a 522e 6d33 312b 6334 2a52 2e6d  +c3*R.m31+c4*R.m
+0001d460: 3431 0a20 2020 2020 2020 2073 656c 662e  41.        self.
+0001d470: 6d34 3220 3d20 6331 2a52 2e6d 3132 2b63  m42 = c1*R.m12+c
+0001d480: 322a 522e 6d32 322b 6333 2a52 2e6d 3332  2*R.m22+c3*R.m32
+0001d490: 2b63 342a 522e 6d34 320a 2020 2020 2020  +c4*R.m42.      
+0001d4a0: 2020 7365 6c66 2e6d 3433 203d 2063 312a    self.m43 = c1*
+0001d4b0: 522e 6d31 332b 6332 2a52 2e6d 3233 2b63  R.m13+c2*R.m23+c
+0001d4c0: 332a 522e 6d33 332b 6334 2a52 2e6d 3433  3*R.m33+c4*R.m43
+0001d4d0: 0a20 2020 2020 2020 2073 656c 662e 6d34  .        self.m4
+0001d4e0: 3420 3d20 6331 2a52 2e6d 3134 2b63 322a  4 = c1*R.m14+c2*
+0001d4f0: 522e 6d32 342b 6333 2a52 2e6d 3334 2b63  R.m24+c3*R.m34+c
+0001d500: 342a 522e 6d34 340a 0a20 2020 2020 2020  4*R.m44..       
+0001d510: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
+0001d520: 2020 6465 6620 6f72 7468 6f67 7261 7068    def orthograph
+0001d530: 6963 2873 656c 662c 206c 6566 742c 2072  ic(self, left, r
+0001d540: 6967 6874 2c20 626f 7474 6f6d 2c20 746f  ight, bottom, to
+0001d550: 702c 206e 6561 722c 2066 6172 293a 0a20  p, near, far):. 
+0001d560: 2020 2020 2020 2022 2222 6571 7569 7661         """equiva
+0001d570: 6c65 6e74 2074 6f20 7468 6520 4f70 656e  lent to the Open
+0001d580: 474c 2063 6f6d 6d61 6e64 2067 6c4f 7274  GL command glOrt
+0001d590: 686f 2829 2222 220a 2020 2020 2020 2020  ho()""".        
+0001d5a0: 6364 6566 206d 6174 3420 7265 730a 2020  cdef mat4 res.  
+0001d5b0: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
+0001d5c0: 6520 6c2c 722c 622c 742c 6e2c 662c 2072  e l,r,b,t,n,f, r
+0001d5d0: 5f6c 2c20 745f 622c 2066 5f6e 0a0a 2020  _l, t_b, f_n..  
+0001d5e0: 2020 2020 2020 6c20 3d20 6c65 6674 0a20        l = left. 
+0001d5f0: 2020 2020 2020 2072 203d 2072 6967 6874         r = right
+0001d600: 0a20 2020 2020 2020 2062 203d 2062 6f74  .        b = bot
+0001d610: 746f 6d0a 2020 2020 2020 2020 7420 3d20  tom.        t = 
+0001d620: 746f 700a 2020 2020 2020 2020 6e20 3d20  top.        n = 
+0001d630: 6e65 6172 0a20 2020 2020 2020 2066 203d  near.        f =
+0001d640: 2066 6172 0a0a 2020 2020 2020 2020 725f   far..        r_
+0001d650: 6c20 3d20 722d 6c0a 2020 2020 2020 2020  l = r-l.        
+0001d660: 745f 6220 3d20 742d 620a 2020 2020 2020  t_b = t-b.      
+0001d670: 2020 665f 6e20 3d20 662d 6e0a 0a20 2020    f_n = f-n..   
+0001d680: 2020 2020 2069 6620 725f 6c3c 3d65 7073       if r_l<=eps
+0001d690: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001d6a0: 6973 6520 5661 6c75 6545 7272 6f72 2c20  ise ValueError, 
+0001d6b0: 2272 6967 6874 2d76 616c 7565 206d 7573  "right-value mus
+0001d6c0: 7420 6265 2067 7265 6174 6572 2074 6861  t be greater tha
+0001d6d0: 6e20 6c65 6674 2d76 616c 7565 220a 2020  n left-value".  
+0001d6e0: 2020 2020 2020 6966 2074 5f62 3c3d 6570        if t_b<=ep
+0001d6f0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+0001d700: 6169 7365 2056 616c 7565 4572 726f 722c  aise ValueError,
+0001d710: 2022 746f 702d 7661 6c75 6520 6d75 7374   "top-value must
+0001d720: 2062 6520 6772 6561 7465 7220 7468 616e   be greater than
+0001d730: 2062 6f74 746f 6d2d 7661 6c75 6522 0a20   bottom-value". 
+0001d740: 2020 2020 2020 2069 6620 665f 6e3c 3d65         if f_n<=e
+0001d750: 7073 3a0a 2020 2020 2020 2020 2020 2020  ps:.            
+0001d760: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0001d770: 2c20 2266 6172 2d76 616c 7565 206d 7573  , "far-value mus
+0001d780: 7420 6265 2067 7265 6174 6572 2074 6861  t be greater tha
+0001d790: 6e20 6e65 6172 2d76 616c 7565 220a 0a20  n near-value".. 
+0001d7a0: 2020 2020 2020 2072 6573 203d 206d 6174         res = mat
+0001d7b0: 3428 290a 0a20 2020 2020 2020 2072 6573  4()..        res
+0001d7c0: 2e6d 3131 203d 2032 2e30 2f72 5f6c 0a20  .m11 = 2.0/r_l. 
+0001d7d0: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
+0001d7e0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001d7f0: 2e6d 3133 203d 2030 2e30 0a20 2020 2020  .m13 = 0.0.     
+0001d800: 2020 2072 6573 2e6d 3134 203d 202d 2872     res.m14 = -(r
+0001d810: 2b6c 292f 725f 6c0a 2020 2020 2020 2020  +l)/r_l.        
+0001d820: 7265 732e 6d32 3120 3d20 302e 300a 2020  res.m21 = 0.0.  
+0001d830: 2020 2020 2020 7265 732e 6d32 3220 3d20        res.m22 = 
+0001d840: 322e 302f 745f 620a 2020 2020 2020 2020  2.0/t_b.        
+0001d850: 7265 732e 6d32 3320 3d20 302e 300a 2020  res.m23 = 0.0.  
+0001d860: 2020 2020 2020 7265 732e 6d32 3420 3d20        res.m24 = 
+0001d870: 2d28 742b 6229 2f74 5f62 0a20 2020 2020  -(t+b)/t_b.     
+0001d880: 2020 2072 6573 2e6d 3331 203d 2030 2e30     res.m31 = 0.0
+0001d890: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
+0001d8a0: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
+0001d8b0: 6573 2e6d 3333 203d 202d 322e 302f 665f  es.m33 = -2.0/f_
+0001d8c0: 6e0a 2020 2020 2020 2020 7265 732e 6d33  n.        res.m3
+0001d8d0: 3420 3d20 2d28 662b 6e29 2f66 5f6e 0a20  4 = -(f+n)/f_n. 
+0001d8e0: 2020 2020 2020 2072 6573 2e6d 3431 203d         res.m41 =
+0001d8f0: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001d900: 2e6d 3432 203d 2030 2e30 0a20 2020 2020  .m42 = 0.0.     
+0001d910: 2020 2072 6573 2e6d 3433 203d 2030 2e30     res.m43 = 0.0
+0001d920: 0a20 2020 2020 2020 2072 6573 2e6d 3434  .        res.m44
+0001d930: 203d 2031 2e30 0a20 2020 2020 2020 2072   = 1.0.        r
+0001d940: 6574 7572 6e20 7265 730a 0a20 2020 2064  eturn res..    d
+0001d950: 6566 2066 7275 7374 756d 2873 656c 662c  ef frustum(self,
+0001d960: 206c 6566 742c 2072 6967 6874 2c20 626f   left, right, bo
+0001d970: 7474 6f6d 2c20 746f 702c 206e 6561 722c  ttom, top, near,
+0001d980: 2066 6172 293a 0a20 2020 2020 2020 2022   far):.        "
+0001d990: 2222 6571 7569 7661 6c65 6e74 2074 6f20  ""equivalent to 
+0001d9a0: 7468 6520 4f70 656e 474c 2063 6f6d 6d61  the OpenGL comma
+0001d9b0: 6e64 2067 6c46 7275 7374 756d 2829 2222  nd glFrustum()""
+0001d9c0: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
+0001d9d0: 6174 3420 7265 730a 2020 2020 2020 2020  at4 res.        
+0001d9e0: 6364 6566 2064 6f75 626c 6520 6c2c 722c  cdef double l,r,
+0001d9f0: 622c 742c 6e2c 662c 2072 5f6c 2c20 745f  b,t,n,f, r_l, t_
+0001da00: 622c 2066 5f6e 0a0a 2020 2020 2020 2020  b, f_n..        
+0001da10: 6c20 3d20 6c65 6674 0a20 2020 2020 2020  l = left.       
+0001da20: 2072 203d 2072 6967 6874 0a20 2020 2020   r = right.     
+0001da30: 2020 2062 203d 2062 6f74 746f 6d0a 2020     b = bottom.  
+0001da40: 2020 2020 2020 7420 3d20 746f 700a 2020        t = top.  
+0001da50: 2020 2020 2020 6e20 3d20 6e65 6172 0a20        n = near. 
+0001da60: 2020 2020 2020 2066 203d 2066 6172 0a0a         f = far..
+0001da70: 2020 2020 2020 2020 725f 6c20 3d20 722d          r_l = r-
+0001da80: 6c0a 2020 2020 2020 2020 745f 6220 3d20  l.        t_b = 
+0001da90: 742d 620a 2020 2020 2020 2020 665f 6e20  t-b.        f_n 
+0001daa0: 3d20 662d 6e0a 0a20 2020 2020 2020 2069  = f-n..        i
+0001dab0: 6620 725f 6c3c 3d65 7073 3a0a 2020 2020  f r_l<=eps:.    
+0001dac0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001dad0: 6c75 6545 7272 6f72 2c20 2272 6967 6874  lueError, "right
+0001dae0: 2d76 616c 7565 206d 7573 7420 6265 2067  -value must be g
+0001daf0: 7265 6174 6572 2074 6861 6e20 6c65 6674  reater than left
+0001db00: 2d76 616c 7565 220a 2020 2020 2020 2020  -value".        
+0001db10: 6966 2074 5f62 3c3d 6570 733a 0a20 2020  if t_b<=eps:.   
+0001db20: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0001db30: 616c 7565 4572 726f 722c 2022 746f 702d  alueError, "top-
+0001db40: 7661 6c75 6520 6d75 7374 2062 6520 6772  value must be gr
+0001db50: 6561 7465 7220 7468 616e 2062 6f74 746f  eater than botto
+0001db60: 6d2d 7661 6c75 6522 0a20 2020 2020 2020  m-value".       
+0001db70: 2069 6620 665f 6e3c 3d65 7073 3a0a 2020   if f_n<=eps:.  
+0001db80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001db90: 5661 6c75 6545 7272 6f72 2c20 2266 6172  ValueError, "far
+0001dba0: 2d76 616c 7565 206d 7573 7420 6265 2067  -value must be g
+0001dbb0: 7265 6174 6572 2074 6861 6e20 6e65 6172  reater than near
+0001dbc0: 2d76 616c 7565 220a 0a20 2020 2020 2020  -value"..       
+0001dbd0: 2072 6573 203d 206d 6174 3428 290a 0a20   res = mat4().. 
+0001dbe0: 2020 2020 2020 2072 6573 2e6d 3131 203d         res.m11 =
+0001dbf0: 2028 322e 302a 6e29 2f72 5f6c 0a20 2020   (2.0*n)/r_l.   
+0001dc00: 2020 2020 2072 6573 2e6d 3132 203d 2030       res.m12 = 0
+0001dc10: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
+0001dc20: 3133 203d 2028 722b 6c29 2f72 5f6c 0a20  13 = (r+l)/r_l. 
+0001dc30: 2020 2020 2020 2072 6573 2e6d 3134 203d         res.m14 =
+0001dc40: 2030 2e30 0a20 2020 2020 2020 2072 6573   0.0.        res
+0001dc50: 2e6d 3231 203d 2030 2e30 0a20 2020 2020  .m21 = 0.0.     
+0001dc60: 2020 2072 6573 2e6d 3232 203d 2028 322e     res.m22 = (2.
+0001dc70: 302a 6e29 2f74 5f62 0a20 2020 2020 2020  0*n)/t_b.       
+0001dc80: 2072 6573 2e6d 3233 203d 2028 742b 6229   res.m23 = (t+b)
+0001dc90: 2f74 5f62 0a20 2020 2020 2020 2072 6573  /t_b.        res
+0001dca0: 2e6d 3234 203d 2030 2e30 0a20 2020 2020  .m24 = 0.0.     
+0001dcb0: 2020 2072 6573 2e6d 3331 203d 2030 2e30     res.m31 = 0.0
+0001dcc0: 0a20 2020 2020 2020 2072 6573 2e6d 3332  .        res.m32
+0001dcd0: 203d 2030 2e30 0a20 2020 2020 2020 2072   = 0.0.        r
+0001dce0: 6573 2e6d 3333 203d 202d 2866 2b6e 292f  es.m33 = -(f+n)/
+0001dcf0: 665f 6e0a 2020 2020 2020 2020 7265 732e  f_n.        res.
+0001dd00: 6d33 3420 3d20 282d 322e 302a 662a 6e29  m34 = (-2.0*f*n)
+0001dd10: 2f66 5f6e 0a20 2020 2020 2020 2072 6573  /f_n.        res
+0001dd20: 2e6d 3431 203d 2030 2e30 0a20 2020 2020  .m41 = 0.0.     
+0001dd30: 2020 2072 6573 2e6d 3432 203d 2030 2e30     res.m42 = 0.0
+0001dd40: 0a20 2020 2020 2020 2072 6573 2e6d 3433  .        res.m43
+0001dd50: 203d 202d 312e 300a 2020 2020 2020 2020   = -1.0.        
+0001dd60: 7265 732e 6d34 3420 3d20 302e 300a 2020  res.m44 = 0.0.  
+0001dd70: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+0001dd80: 0a0a 2020 2020 6465 6620 7065 7273 7065  ..    def perspe
+0001dd90: 6374 6976 6528 7365 6c66 2c20 666f 7679  ctive(self, fovy
+0001dda0: 2c20 6173 7065 6374 2c20 6e65 6172 2c20  , aspect, near, 
+0001ddb0: 6661 7229 3a0a 2020 2020 2020 2020 2222  far):.        ""
+0001ddc0: 2276 6f6e 204d 6573 6120 c3bc 6265 726e  "von Mesa ..bern
+0001ddd0: 6f6d 6d65 6e20 2867 6c75 2e63 2922 2222  ommen (glu.c)"""
+0001dde0: 0a20 2020 2020 2020 2063 6465 6620 646f  .        cdef do
+0001ddf0: 7562 6c65 2066 2c20 610a 2020 2020 2020  uble f, a.      
+0001de00: 2020 6364 6566 2064 6f75 626c 6520 746f    cdef double to
+0001de10: 702c 2062 6f74 746f 6d2c 206c 6566 742c  p, bottom, left,
+0001de20: 2072 6967 6874 0a0a 2020 2020 2020 2020   right..        
+0001de30: 6620 3d20 666f 7679 0a20 2020 2020 2020  f = fovy.       
+0001de40: 2061 203d 2061 7370 6563 740a 0a20 2020   a = aspect..   
+0001de50: 2020 2020 2074 6f70 2020 2020 3d20 6e65       top    = ne
+0001de60: 6172 202a 2074 616e 2866 202a 2033 2e31  ar * tan(f * 3.1
+0001de70: 3431 3539 3236 3533 3538 3937 3933 3120  415926535897931 
+0001de80: 2f20 3336 302e 3029 0a20 2020 2020 2020  / 360.0).       
+0001de90: 2062 6f74 746f 6d20 3d20 2d74 6f70 0a20   bottom = -top. 
+0001dea0: 2020 2020 2020 206c 6566 7420 2020 3d20         left   = 
+0001deb0: 626f 7474 6f6d 202a 2061 0a20 2020 2020  bottom * a.     
+0001dec0: 2020 2072 6967 6874 2020 3d20 746f 7020     right  = top 
+0001ded0: 2a20 610a 0a20 2020 2020 2020 2072 6574  * a..        ret
+0001dee0: 7572 6e20 7365 6c66 2e66 7275 7374 756d  urn self.frustum
+0001def0: 286c 6566 742c 2072 6967 6874 2c20 626f  (left, right, bo
+0001df00: 7474 6f6d 2c20 746f 702c 206e 6561 722c  ttom, top, near,
+0001df10: 2066 6172 290a 0a20 2020 2064 6566 206c   far)..    def l
+0001df20: 6f6f 6b41 7428 7365 6c66 2c20 706f 732c  ookAt(self, pos,
+0001df30: 2074 6172 6765 742c 2075 703d 2830 2c30   target, up=(0,0
+0001df40: 2c31 2929 3a0a 2020 2020 2020 2020 2222  ,1)):.        ""
+0001df50: 224c 6f6f 6b20 6672 6f6d 2070 6f73 2074  "Look from pos t
+0001df60: 6f20 7461 7267 6574 2e0a 0a20 2020 2020  o target...     
+0001df70: 2020 2054 6865 2072 6573 756c 7469 6e67     The resulting
+0001df80: 2074 7261 6e73 666f 726d 6174 696f 6e20   transformation 
+0001df90: 6d6f 7665 7320 7468 6520 6f72 6967 696e  moves the origin
+0001dfa0: 2074 6f20 706f 7320 616e 640a 2020 2020   to pos and.    
+0001dfb0: 2020 2020 726f 7461 7465 7320 736f 2074      rotates so t
+0001dfc0: 6861 7420 5468 6520 7a2d 6178 6973 2070  hat The z-axis p
+0001dfd0: 6f69 6e74 7320 746f 2074 6172 6765 742e  oints to target.
+0001dfe0: 2054 6865 2079 2d61 7869 7320 6973 0a20   The y-axis is. 
+0001dff0: 2020 2020 2020 2061 7320 636c 6f73 6520         as close 
+0001e000: 6173 2070 6f73 7369 626c 6520 746f 2074  as possible to t
+0001e010: 6865 2075 7020 7665 6374 6f72 2e0a 2020  he up vector..  
+0001e020: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001e030: 2020 6364 6566 206d 6174 3420 7265 730a    cdef mat4 res.
+0001e040: 2020 2020 2020 2020 6364 6566 2076 6563          cdef vec
+0001e050: 3320 7269 6768 742c 7675 702c 6469 720a  3 right,vup,dir.
+0001e060: 0a20 2020 2020 2020 2070 6f73 2020 2020  .        pos    
+0001e070: 3d20 7665 6333 2870 6f73 290a 2020 2020  = vec3(pos).    
+0001e080: 2020 2020 7461 7267 6574 203d 2076 6563      target = vec
+0001e090: 3328 7461 7267 6574 290a 2020 2020 2020  3(target).      
+0001e0a0: 2020 7675 7020 2020 203d 2076 6563 3328    vup    = vec3(
+0001e0b0: 7570 290a 0a20 2020 2020 2020 2064 6972  up)..        dir
+0001e0c0: 203d 2028 7461 7267 6574 202d 2070 6f73   = (target - pos
+0001e0d0: 292e 6e6f 726d 616c 697a 6528 290a 2020  ).normalize().  
+0001e0e0: 2020 2020 2020 7675 7020 3d20 7675 702e        vup = vup.
+0001e0f0: 6e6f 726d 616c 697a 6528 290a 2020 2020  normalize().    
+0001e100: 2020 2020 7675 7020 3d20 7675 7020 2d20      vup = vup - 
+0001e110: 2876 7570 202a 2064 6972 2920 2a20 6469  (vup * dir) * di
+0001e120: 720a 2020 2020 2020 2020 7472 793a 0a20  r.        try:. 
+0001e130: 2020 2020 2020 2020 2020 2076 7570 2020             vup  
+0001e140: 3d20 7675 702e 6e6f 726d 616c 697a 6528  = vup.normalize(
+0001e150: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+0001e160: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0001e170: 5765 2772 6520 6c6f 6f6b 696e 6720 616c  We're looking al
+0001e180: 6f6e 6720 7468 6520 7570 2064 6972 6563  ong the up direc
+0001e190: 7469 6f6e 2c20 736f 2063 686f 6f73 650a  tion, so choose.
+0001e1a0: 2020 2020 2020 2020 2020 2020 2320 616e              # an
+0001e1b0: 2061 7262 6974 7261 7279 2064 6972 6563   arbitrary direc
+0001e1c0: 7469 6f6e 2074 6861 7420 6973 2070 6572  tion that is per
+0001e1d0: 7065 6e64 6963 756c 6172 2074 6f20 6469  pendicular to di
+0001e1e0: 720a 2020 2020 2020 2020 2020 2020 2320  r.            # 
+0001e1f0: 6173 206e 6577 2075 702e 0a20 2020 2020  as new up..     
+0001e200: 2020 2020 2020 2076 7570 203d 2064 6972         vup = dir
+0001e210: 2e6f 7274 686f 2829 0a0a 2020 2020 2020  .ortho()..      
+0001e220: 2020 7269 6768 7420 3d20 7675 702e 6372    right = vup.cr
+0001e230: 6f73 7328 6469 7229 2e6e 6f72 6d61 6c69  oss(dir).normali
+0001e240: 7a65 2829 0a0a 2020 2020 2020 2020 7265  ze()..        re
+0001e250: 7320 3d20 6d61 7434 2829 0a20 2020 2020  s = mat4().     
+0001e260: 2020 2072 6573 2e6d 3131 203d 2072 6967     res.m11 = rig
+0001e270: 6874 2e78 0a20 2020 2020 2020 2072 6573  ht.x.        res
+0001e280: 2e6d 3231 203d 2072 6967 6874 2e79 0a20  .m21 = right.y. 
+0001e290: 2020 2020 2020 2072 6573 2e6d 3331 203d         res.m31 =
+0001e2a0: 2072 6967 6874 2e7a 0a20 2020 2020 2020   right.z.       
+0001e2b0: 2072 6573 2e6d 3431 203d 2030 2e30 0a20   res.m41 = 0.0. 
+0001e2c0: 2020 2020 2020 2072 6573 2e6d 3132 203d         res.m12 =
+0001e2d0: 2076 7570 2e78 0a20 2020 2020 2020 2072   vup.x.        r
+0001e2e0: 6573 2e6d 3232 203d 2076 7570 2e79 0a20  es.m22 = vup.y. 
+0001e2f0: 2020 2020 2020 2072 6573 2e6d 3332 203d         res.m32 =
+0001e300: 2076 7570 2e7a 0a20 2020 2020 2020 2072   vup.z.        r
+0001e310: 6573 2e6d 3432 203d 2030 2e30 0a20 2020  es.m42 = 0.0.   
+0001e320: 2020 2020 2072 6573 2e6d 3133 203d 2064       res.m13 = d
+0001e330: 6972 2e78 0a20 2020 2020 2020 2072 6573  ir.x.        res
+0001e340: 2e6d 3233 203d 2064 6972 2e79 0a20 2020  .m23 = dir.y.   
+0001e350: 2020 2020 2072 6573 2e6d 3333 203d 2064       res.m33 = d
+0001e360: 6972 2e7a 0a20 2020 2020 2020 2072 6573  ir.z.        res
+0001e370: 2e6d 3433 203d 2030 2e30 0a20 2020 2020  .m43 = 0.0.     
+0001e380: 2020 2072 6573 2e6d 3134 203d 2070 6f73     res.m14 = pos
+0001e390: 2e78 0a20 2020 2020 2020 2072 6573 2e6d  .x.        res.m
+0001e3a0: 3234 203d 2070 6f73 2e79 0a20 2020 2020  24 = pos.y.     
+0001e3b0: 2020 2072 6573 2e6d 3334 203d 2070 6f73     res.m34 = pos
+0001e3c0: 2e7a 0a20 2020 2020 2020 2072 6573 2e6d  .z.        res.m
+0001e3d0: 3434 203d 2031 2e30 0a20 2020 2020 2020  44 = 1.0.       
+0001e3e0: 2072 6574 7572 6e20 7265 730a 0a20 2020   return res..   
+0001e3f0: 2064 6566 206f 7274 686f 2873 656c 6629   def ortho(self)
+0001e400: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+0001e410: 7572 6e20 6120 6d61 7472 6978 2077 6974  urn a matrix wit
+0001e420: 6820 6f72 7468 6f67 6f6e 616c 2062 6173  h orthogonal bas
+0001e430: 6520 7665 6374 6f72 732e 0a0a 2020 2020  e vectors...    
+0001e440: 2020 2020 4d61 6b65 7320 7468 6520 782d      Makes the x-
+0001e450: 2c20 792d 2061 6e64 207a 2d61 7869 7320  , y- and z-axis 
+0001e460: 6f72 7468 6f67 6f6e 616c 2e0a 2020 2020  orthogonal..    
+0001e470: 2020 2020 5468 6520 666f 7572 7468 2063      The fourth c
+0001e480: 6f6c 756d 6e20 616e 6420 726f 7720 7265  olumn and row re
+0001e490: 6d61 696e 2075 6e74 6f75 6368 6564 2e0a  main untouched..
+0001e4a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001e4b0: 2020 2020 6364 6566 206d 6174 3420 7265      cdef mat4 re
+0001e4c0: 730a 2020 2020 2020 2020 6364 6566 2076  s.        cdef v
+0001e4d0: 6563 3320 782c 792c 7a0a 0a20 2020 2020  ec3 x,y,z..     
+0001e4e0: 2020 2078 203d 2076 6563 3328 7365 6c66     x = vec3(self
+0001e4f0: 2e6d 3131 2c20 7365 6c66 2e6d 3231 2c20  .m11, self.m21, 
+0001e500: 7365 6c66 2e6d 3331 290a 2020 2020 2020  self.m31).      
+0001e510: 2020 7920 3d20 7665 6333 2873 656c 662e    y = vec3(self.
+0001e520: 6d31 322c 2073 656c 662e 6d32 322c 2073  m12, self.m22, s
+0001e530: 656c 662e 6d33 3229 0a20 2020 2020 2020  elf.m32).       
+0001e540: 207a 203d 2076 6563 3328 7365 6c66 2e6d   z = vec3(self.m
+0001e550: 3133 2c20 7365 6c66 2e6d 3233 2c20 7365  13, self.m23, se
+0001e560: 6c66 2e6d 3333 290a 0a20 2020 2020 2020  lf.m33)..       
+0001e570: 2078 6c20 3d20 782e 6c65 6e67 7468 2829   xl = x.length()
+0001e580: 0a20 2020 2020 2020 2078 6c20 3d20 786c  .        xl = xl
+0001e590: 2a78 6c0a 2020 2020 2020 2020 7920 3d20  *xl.        y = 
+0001e5a0: 7920 2d20 2828 782a 7929 2f78 6c29 2a78  y - ((x*y)/xl)*x
+0001e5b0: 0a20 2020 2020 2020 207a 203d 207a 202d  .        z = z -
+0001e5c0: 2028 2878 2a7a 292f 786c 292a 780a 0a20   ((x*z)/xl)*x.. 
+0001e5d0: 2020 2020 2020 2079 6c20 3d20 792e 6c65         yl = y.le
+0001e5e0: 6e67 7468 2829 0a20 2020 2020 2020 2079  ngth().        y
+0001e5f0: 6c20 3d20 796c 2a79 6c0a 2020 2020 2020  l = yl*yl.      
+0001e600: 2020 7a20 3d20 7a20 2d20 2828 792a 7a29    z = z - ((y*z)
+0001e610: 2f79 6c29 2a79 0a0a 2020 2020 2020 2020  /yl)*y..        
+0001e620: 7265 7320 3d20 6d61 7434 2829 0a20 2020  res = mat4().   
+0001e630: 2020 2020 2072 6573 2e6d 3131 203d 2078       res.m11 = x
+0001e640: 2e78 0a20 2020 2020 2020 2072 6573 2e6d  .x.        res.m
+0001e650: 3132 203d 2079 2e78 0a20 2020 2020 2020  12 = y.x.       
+0001e660: 2072 6573 2e6d 3133 203d 207a 2e78 0a20   res.m13 = z.x. 
+0001e670: 2020 2020 2020 2072 6573 2e6d 3134 203d         res.m14 =
+0001e680: 2073 656c 662e 6d31 340a 2020 2020 2020   self.m14.      
+0001e690: 2020 7265 732e 6d32 3120 3d20 782e 790a    res.m21 = x.y.
+0001e6a0: 2020 2020 2020 2020 7265 732e 6d32 3220          res.m22 
+0001e6b0: 3d20 792e 790a 2020 2020 2020 2020 7265  = y.y.        re
+0001e6c0: 732e 6d32 3320 3d20 7a2e 790a 2020 2020  s.m23 = z.y.    
+0001e6d0: 2020 2020 7265 732e 6d32 3420 3d20 7365      res.m24 = se
+0001e6e0: 6c66 2e6d 3234 0a20 2020 2020 2020 2072  lf.m24.        r
+0001e6f0: 6573 2e6d 3331 203d 2078 2e7a 0a20 2020  es.m31 = x.z.   
+0001e700: 2020 2020 2072 6573 2e6d 3332 203d 2079       res.m32 = y
+0001e710: 2e7a 0a20 2020 2020 2020 2072 6573 2e6d  .z.        res.m
+0001e720: 3333 203d 207a 2e7a 0a20 2020 2020 2020  33 = z.z.       
+0001e730: 2072 6573 2e6d 3334 203d 2073 656c 662e   res.m34 = self.
+0001e740: 6d33 340a 2020 2020 2020 2020 7265 732e  m34.        res.
+0001e750: 6d34 3120 3d20 7365 6c66 2e6d 3431 0a20  m41 = self.m41. 
+0001e760: 2020 2020 2020 2072 6573 2e6d 3432 203d         res.m42 =
+0001e770: 2073 656c 662e 6d34 320a 2020 2020 2020   self.m42.      
+0001e780: 2020 7265 732e 6d34 3320 3d20 7365 6c66    res.m43 = self
+0001e790: 2e6d 3433 0a20 2020 2020 2020 2072 6573  .m43.        res
+0001e7a0: 2e6d 3434 203d 2073 656c 662e 6d34 340a  .m44 = self.m44.
+0001e7b0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0001e7c0: 6573 0a0a 2020 2020 6465 6620 6465 636f  es..    def deco
+0001e7d0: 6d70 6f73 6528 7365 6c66 293a 0a20 2020  mpose(self):.   
+0001e7e0: 2020 2020 2022 2222 4465 636f 6d70 6f73       """Decompos
+0001e7f0: 6573 2074 6865 206d 6174 7269 7820 696e  es the matrix in
+0001e800: 746f 2061 2074 7261 6e73 6c61 7469 6f6e  to a translation
+0001e810: 2c20 726f 7461 7469 6f6e 2061 6e64 2073  , rotation and s
+0001e820: 6361 6c69 6e67 2070 6172 742e 0a0a 2020  caling part...  
+0001e830: 2020 2020 2020 5265 7475 726e 7320 6120        Returns a 
+0001e840: 7475 706c 6520 2874 7261 6e73 6c61 7469  tuple (translati
+0001e850: 6f6e 2c20 726f 7461 7469 6f6e 2c20 7363  on, rotation, sc
+0001e860: 616c 696e 6729 2e20 5468 650a 2020 2020  aling). The.    
+0001e870: 2020 2020 7472 616e 736c 6174 696f 6e20      translation 
+0001e880: 616e 6420 7363 616c 696e 6720 7061 7274  and scaling part
+0001e890: 7320 6172 6520 6769 7665 6e20 6173 2076  s are given as v
+0001e8a0: 6563 3327 732c 2074 6865 2072 6f74 6174  ec3's, the rotat
+0001e8b0: 696f 6e0a 2020 2020 2020 2020 6973 2073  ion.        is s
+0001e8c0: 7469 6c6c 2067 6976 656e 2061 7320 6120  till given as a 
+0001e8d0: 6d61 7434 2e0a 2020 2020 2020 2020 2222  mat4..        ""
+0001e8e0: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
+0001e8f0: 6174 3420 6d0a 2020 2020 2020 2020 6364  at4 m.        cd
+0001e900: 6566 2076 6563 3320 612c 622c 630a 2020  ef vec3 a,b,c.  
+0001e910: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
+0001e920: 6520 616c 2c20 626c 2c20 636c 0a0a 2020  e al, bl, cl..  
+0001e930: 2020 2020 2020 6d20 3d20 7365 6c66 2e6f        m = self.o
+0001e940: 7274 686f 2829 0a20 2020 2020 2020 206d  rtho().        m
+0001e950: 2e6d 3134 203d 2030 2e30 0a20 2020 2020  .m14 = 0.0.     
+0001e960: 2020 206d 2e6d 3234 203d 2030 2e30 0a20     m.m24 = 0.0. 
+0001e970: 2020 2020 2020 206d 2e6d 3334 203d 2030         m.m34 = 0
+0001e980: 2e30 0a20 2020 2020 2020 206d 2e6d 3434  .0.        m.m44
+0001e990: 203d 2031 2e30 0a20 2020 2020 2020 206d   = 1.0.        m
+0001e9a0: 2e6d 3431 203d 2030 2e30 0a20 2020 2020  .m41 = 0.0.     
+0001e9b0: 2020 206d 2e6d 3432 203d 2030 2e30 0a20     m.m42 = 0.0. 
+0001e9c0: 2020 2020 2020 206d 2e6d 3433 203d 2030         m.m43 = 0
+0001e9d0: 2e30 0a0a 2020 2020 2020 2020 2320 612c  .0..        # a,
+0001e9e0: 622c 6320 3d20 436f 6c75 6d6e 2030 2c31  b,c = Column 0,1
+0001e9f0: 2c32 206f 6620 6d0a 2020 2020 2020 2020  ,2 of m.        
+0001ea00: 6120 3d20 7665 6333 2829 0a20 2020 2020  a = vec3().     
+0001ea10: 2020 2062 203d 2076 6563 3328 290a 2020     b = vec3().  
+0001ea20: 2020 2020 2020 6320 3d20 7665 6333 2829        c = vec3()
+0001ea30: 0a20 2020 2020 2020 2061 2e78 203d 206d  .        a.x = m
+0001ea40: 2e6d 3131 0a20 2020 2020 2020 2061 2e79  .m11.        a.y
+0001ea50: 203d 206d 2e6d 3231 0a20 2020 2020 2020   = m.m21.       
+0001ea60: 2061 2e7a 203d 206d 2e6d 3331 0a20 2020   a.z = m.m31.   
+0001ea70: 2020 2020 2062 2e78 203d 206d 2e6d 3132       b.x = m.m12
+0001ea80: 0a20 2020 2020 2020 2062 2e79 203d 206d  .        b.y = m
+0001ea90: 2e6d 3232 0a20 2020 2020 2020 2062 2e7a  .m22.        b.z
+0001eaa0: 203d 206d 2e6d 3332 0a20 2020 2020 2020   = m.m32.       
+0001eab0: 2063 2e78 203d 206d 2e6d 3133 0a20 2020   c.x = m.m13.   
+0001eac0: 2020 2020 2063 2e79 203d 206d 2e6d 3233       c.y = m.m23
+0001ead0: 0a20 2020 2020 2020 2063 2e7a 203d 206d  .        c.z = m
+0001eae0: 2e6d 3333 0a0a 2020 2020 2020 2020 2320  .m33..        # 
+0001eaf0: 616c 2c62 6c2c 636c 203d 206c 656e 6774  al,bl,cl = lengt
+0001eb00: 6820 6f66 2061 2c62 2c63 2028 3d20 7363  h of a,b,c (= sc
+0001eb10: 616c 696e 6720 6661 6374 6f72 7329 0a20  aling factors). 
+0001eb20: 2020 2020 2020 2061 6c20 3d20 7371 7274         al = sqrt
+0001eb30: 2861 2e78 2a61 2e78 202b 2061 2e79 2a61  (a.x*a.x + a.y*a
+0001eb40: 2e79 202b 2061 2e7a 2a61 2e7a 290a 2020  .y + a.z*a.z).  
+0001eb50: 2020 2020 2020 626c 203d 2073 7172 7428        bl = sqrt(
+0001eb60: 622e 782a 622e 7820 2b20 622e 792a 622e  b.x*b.x + b.y*b.
+0001eb70: 7920 2b20 622e 7a2a 622e 7a29 0a20 2020  y + b.z*b.z).   
+0001eb80: 2020 2020 2063 6c20 3d20 7371 7274 2863       cl = sqrt(c
+0001eb90: 2e78 2a63 2e78 202b 2063 2e79 2a63 2e79  .x*c.x + c.y*c.y
+0001eba0: 202b 2063 2e7a 2a63 2e7a 290a 2020 2020   + c.z*c.z).    
+0001ebb0: 2020 2020 6966 2061 6c3c 3d65 7073 206f      if al<=eps o
+0001ebc0: 7220 626c 3c3d 6570 7320 6f72 2063 6c3c  r bl<=eps or cl<
+0001ebd0: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
+0001ebe0: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
+0001ebf0: 7369 6f6e 4572 726f 722c 2274 7261 6e73  sionError,"trans
+0001ec00: 666f 726d 6174 696f 6e20 636f 6e74 6169  formation contai
+0001ec10: 6e73 2061 2030 2073 6361 6c69 6e67 220a  ns a 0 scaling".
+0001ec20: 0a20 2020 2020 2020 2073 6361 6c65 203d  .        scale =
+0001ec30: 2076 6563 3328 616c 2c62 6c2c 636c 290a   vec3(al,bl,cl).
+0001ec40: 0a20 2020 2020 2020 2023 206e 6f72 6d61  .        # norma
+0001ec50: 6c69 7a69 6e67 2061 2c62 2c63 0a23 2020  lizing a,b,c.#  
+0001ec60: 2020 2020 2020 612f 3d61 6c0a 2320 2020        a/=al.#   
+0001ec70: 2020 2020 2062 2f3d 626c 0a23 2020 2020       b/=bl.#    
+0001ec80: 2020 2020 632f 3d63 6c0a 2020 2020 2020      c/=cl.      
+0001ec90: 2020 612e 7820 3d20 612e 782f 616c 0a20    a.x = a.x/al. 
+0001eca0: 2020 2020 2020 2061 2e79 203d 2061 2e79         a.y = a.y
+0001ecb0: 2f61 6c0a 2020 2020 2020 2020 612e 7a20  /al.        a.z 
+0001ecc0: 3d20 612e 7a2f 616c 0a20 2020 2020 2020  = a.z/al.       
+0001ecd0: 2062 2e78 203d 2062 2e78 2f62 6c0a 2020   b.x = b.x/bl.  
+0001ece0: 2020 2020 2020 622e 7920 3d20 622e 792f        b.y = b.y/
+0001ecf0: 626c 0a20 2020 2020 2020 2062 2e7a 203d  bl.        b.z =
+0001ed00: 2062 2e7a 2f62 6c0a 2020 2020 2020 2020   b.z/bl.        
+0001ed10: 632e 7820 3d20 632e 782f 636c 0a20 2020  c.x = c.x/cl.   
+0001ed20: 2020 2020 2063 2e79 203d 2063 2e79 2f63       c.y = c.y/c
+0001ed30: 6c0a 2020 2020 2020 2020 632e 7a20 3d20  l.        c.z = 
+0001ed40: 632e 7a2f 636c 0a0a 2020 2020 2020 2020  c.z/cl..        
+0001ed50: 6d2e 6d31 3120 3d20 612e 780a 2020 2020  m.m11 = a.x.    
+0001ed60: 2020 2020 6d2e 6d32 3120 3d20 612e 790a      m.m21 = a.y.
+0001ed70: 2020 2020 2020 2020 6d2e 6d33 3120 3d20          m.m31 = 
+0001ed80: 612e 7a0a 2020 2020 2020 2020 6d2e 6d31  a.z.        m.m1
+0001ed90: 3220 3d20 622e 780a 2020 2020 2020 2020  2 = b.x.        
+0001eda0: 6d2e 6d32 3220 3d20 622e 790a 2020 2020  m.m22 = b.y.    
+0001edb0: 2020 2020 6d2e 6d33 3220 3d20 622e 7a0a      m.m32 = b.z.
+0001edc0: 2020 2020 2020 2020 6d2e 6d31 3320 3d20          m.m13 = 
+0001edd0: 632e 780a 2020 2020 2020 2020 6d2e 6d32  c.x.        m.m2
+0001ede0: 3320 3d20 632e 790a 2020 2020 2020 2020  3 = c.y.        
+0001edf0: 6d2e 6d33 3320 3d20 632e 7a0a 2020 2020  m.m33 = c.z.    
+0001ee00: 2020 2020 6966 206d 2e64 6574 6572 6d69      if m.determi
+0001ee10: 6e61 6e74 2829 3c30 2e30 3a0a 2020 2020  nant()<0.0:.    
+0001ee20: 2020 2020 2020 2020 6d2e 6d31 3120 3d20          m.m11 = 
+0001ee30: 2d6d 2e6d 3131 0a20 2020 2020 2020 2020  -m.m11.         
+0001ee40: 2020 206d 2e6d 3231 203d 202d 6d2e 6d32     m.m21 = -m.m2
+0001ee50: 310a 2020 2020 2020 2020 2020 2020 6d2e  1.            m.
+0001ee60: 6d33 3120 3d20 2d6d 2e6d 3331 0a20 2020  m31 = -m.m31.   
+0001ee70: 2020 2020 2020 2020 2073 6361 6c65 2e78           scale.x
+0001ee80: 203d 202d 7363 616c 652e 780a 0a20 2020   = -scale.x..   
+0001ee90: 2020 2020 2072 6574 7572 6e20 2876 6563       return (vec
+0001eea0: 3328 7365 6c66 2e6d 3134 2c20 7365 6c66  3(self.m14, self
+0001eeb0: 2e6d 3234 2c20 7365 6c66 2e6d 3334 292c  .m24, self.m34),
+0001eec0: 206d 2c20 7363 616c 6529 0a0a 2020 2020   m, scale)..    
+0001eed0: 6465 6620 6765 744d 6174 3328 7365 6c66  def getMat3(self
+0001eee0: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
+0001eef0: 6e76 6572 7420 746f 206d 6174 3320 6279  nvert to mat3 by
+0001ef00: 2064 6973 6361 7264 696e 6720 3474 6820   discarding 4th 
+0001ef10: 726f 7720 616e 6420 636f 6c75 6d6e 2e0a  row and column..
+0001ef20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001ef30: 2020 2020 6364 6566 206d 6174 3320 7265      cdef mat3 re
+0001ef40: 730a 2020 2020 2020 2020 7265 7320 3d20  s.        res = 
+0001ef50: 6d61 7433 2829 0a20 2020 2020 2020 2072  mat3().        r
+0001ef60: 6573 2e6d 3131 203d 2073 656c 662e 6d31  es.m11 = self.m1
+0001ef70: 310a 2020 2020 2020 2020 7265 732e 6d31  1.        res.m1
+0001ef80: 3220 3d20 7365 6c66 2e6d 3132 0a20 2020  2 = self.m12.   
+0001ef90: 2020 2020 2072 6573 2e6d 3133 203d 2073       res.m13 = s
+0001efa0: 656c 662e 6d31 330a 2020 2020 2020 2020  elf.m13.        
+0001efb0: 7265 732e 6d32 3120 3d20 7365 6c66 2e6d  res.m21 = self.m
+0001efc0: 3231 0a20 2020 2020 2020 2072 6573 2e6d  21.        res.m
+0001efd0: 3232 203d 2073 656c 662e 6d32 320a 2020  22 = self.m22.  
+0001efe0: 2020 2020 2020 7265 732e 6d32 3320 3d20        res.m23 = 
+0001eff0: 7365 6c66 2e6d 3233 0a20 2020 2020 2020  self.m23.       
+0001f000: 2072 6573 2e6d 3331 203d 2073 656c 662e   res.m31 = self.
+0001f010: 6d33 310a 2020 2020 2020 2020 7265 732e  m31.        res.
+0001f020: 6d33 3220 3d20 7365 6c66 2e6d 3332 0a20  m32 = self.m32. 
+0001f030: 2020 2020 2020 2072 6573 2e6d 3333 203d         res.m33 =
+0001f040: 2073 656c 662e 6d33 330a 2020 2020 2020   self.m33.      
+0001f050: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
+0001f060: 2020 6465 6620 7365 744d 6174 3328 7365    def setMat3(se
+0001f070: 6c66 2c20 6d61 7433 206d 293a 0a20 2020  lf, mat3 m):.   
+0001f080: 2020 2020 2022 2222 5365 7420 7468 6520       """Set the 
+0001f090: 6d61 7433 2070 6172 7420 6f66 2073 656c  mat3 part of sel
+0001f0a0: 662e 0a20 2020 2020 2020 2022 2222 0a20  f..        """. 
+0001f0b0: 2020 2020 2020 2073 656c 662e 6d31 3120         self.m11 
+0001f0c0: 3d20 6d2e 6d31 310a 2020 2020 2020 2020  = m.m11.        
+0001f0d0: 7365 6c66 2e6d 3132 203d 206d 2e6d 3132  self.m12 = m.m12
+0001f0e0: 0a20 2020 2020 2020 2073 656c 662e 6d31  .        self.m1
+0001f0f0: 3320 3d20 6d2e 6d31 330a 2020 2020 2020  3 = m.m13.      
+0001f100: 2020 7365 6c66 2e6d 3231 203d 206d 2e6d    self.m21 = m.m
+0001f110: 3231 0a20 2020 2020 2020 2073 656c 662e  21.        self.
+0001f120: 6d32 3220 3d20 6d2e 6d32 320a 2020 2020  m22 = m.m22.    
+0001f130: 2020 2020 7365 6c66 2e6d 3233 203d 206d      self.m23 = m
+0001f140: 2e6d 3233 0a20 2020 2020 2020 2073 656c  .m23.        sel
+0001f150: 662e 6d33 3120 3d20 6d2e 6d33 310a 2020  f.m31 = m.m31.  
+0001f160: 2020 2020 2020 7365 6c66 2e6d 3332 203d        self.m32 =
+0001f170: 206d 2e6d 3332 0a20 2020 2020 2020 2073   m.m32.        s
+0001f180: 656c 662e 6d33 3320 3d20 6d2e 6d33 330a  elf.m33 = m.m33.
+0001f190: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+0001f1a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001f1b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001f1c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0001f1d0: 2323 2323 2323 230a 0a23 2071 7561 740a  #######..# quat.
+0001f1e0: 6364 6566 2063 6c61 7373 2071 7561 743a  cdef class quat:
+0001f1f0: 0a20 2020 2022 2222 5175 6174 6572 6e69  .    """Quaterni
+0001f200: 6f6e 2063 6c61 7373 2e0a 0a20 2020 2051  on class...    Q
+0001f210: 7561 7465 726e 696f 6e73 2061 7265 2061  uaternions are a
+0001f220: 6e20 6578 7465 6e73 696f 6e20 746f 2063  n extension to c
+0001f230: 6f6d 706c 6578 206e 756d 6265 7273 2061  omplex numbers a
+0001f240: 6e64 2063 616e 2062 6520 7573 6564 0a20  nd can be used. 
+0001f250: 2020 2074 6f20 7374 6f72 6520 726f 7461     to store rota
+0001f260: 7469 6f6e 732e 2054 6865 7920 6172 6520  tions. They are 
+0001f270: 636f 6d70 6f73 6564 206f 6620 666f 7572  composed of four
+0001f280: 2066 6c6f 6174 7320 7768 6963 6820 6361   floats which ca
+0001f290: 6e20 6265 0a20 2020 2073 6565 6e20 6173  n be.    seen as
+0001f2a0: 2061 6e20 616e 676c 6520 616e 6420 616e   an angle and an
+0001f2b0: 2061 7869 7320 6f66 2072 6f74 6174 696f   axis of rotatio
+0001f2c0: 6e2e 0a20 2020 2022 2222 0a0a 2020 2020  n..    """..    
+0001f2d0: 6364 6566 2064 6f75 626c 6520 772c 782c  cdef double w,x,
+0001f2e0: 792c 7a0a 0a20 2020 2064 6566 205f 5f63  y,z..    def __c
+0001f2f0: 696e 6974 5f5f 2873 656c 662c 202a 6172  init__(self, *ar
+0001f300: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+0001f310: 436f 6e73 7472 7563 746f 722e 0a0a 2020  Constructor...  
+0001f320: 2020 2020 2020 3020 6172 6775 6d65 6e74        0 argument
+0001f330: 733a 207a 6572 6f65 730a 2020 2020 2020  s: zeroes.      
+0001f340: 2020 3120 666c 6f61 7420 6172 6775 6d65    1 float argume
+0001f350: 6e74 3a20 2077 2063 6f6d 706f 6e65 6e74  nt:  w component
+0001f360: 2c20 782c 792c 7a20 3d20 2830 2c30 2c30  , x,y,z = (0,0,0
+0001f370: 290a 2020 2020 2020 2020 3120 7175 6174  ).        1 quat
+0001f380: 2061 7267 756d 656e 743a 204d 616b 6520   argument: Make 
+0001f390: 6120 636f 7079 0a20 2020 2020 2020 2031  a copy.        1
+0001f3a0: 206d 6174 3320 6172 6775 6d65 6e74 3a20   mat3 argument: 
+0001f3b0: 496e 6974 6961 6c69 7a65 2062 7920 726f  Initialize by ro
+0001f3c0: 7461 7469 6f6e 206d 6174 7269 780a 2020  tation matrix.  
+0001f3d0: 2020 2020 2020 3120 6d61 7434 2061 7267        1 mat4 arg
+0001f3e0: 756d 656e 743a 2049 6e69 7469 616c 697a  ument: Initializ
+0001f3f0: 6520 6279 2072 6f74 6174 696f 6e20 6d61  e by rotation ma
+0001f400: 7472 6978 0a20 2020 2020 2020 2032 2061  trix.        2 a
+0001f410: 7267 756d 656e 7473 3a20 616e 676c 6520  rguments: angle 
+0001f420: 2620 6178 6973 2028 646f 6573 6e27 7420  & axis (doesn't 
+0001f430: 6861 7665 2074 6f20 6265 206f 6620 756e  have to be of un
+0001f440: 6974 206c 656e 6774 6829 0a20 2020 2020  it length).     
+0001f450: 2020 2034 2061 7267 756d 656e 7473 3a20     4 arguments: 
+0001f460: 636f 6d70 6f6e 656e 7473 2077 2c78 2c79  components w,x,y
+0001f470: 2c7a 0a20 2020 2020 2020 2022 2222 0a0a  ,z.        """..
+0001f480: 2020 2020 2020 2020 6364 6566 2069 6e74          cdef int
+0001f490: 2061 7267 6c65 6e2c 2073 6571 6c65 6e0a   arglen, seqlen.
+0001f4a0: 2020 2020 2020 2020 6364 6566 2071 7561          cdef qua
+0001f4b0: 7420 710a 2020 2020 2020 2020 6172 676c  t q.        argl
+0001f4c0: 656e 203d 206c 656e 2861 7267 7329 0a0a  en = len(args)..
+0001f4d0: 2020 2020 2020 2020 2320 3020 6172 6775          # 0 argu
+0001f4e0: 6d65 6e74 730a 2020 2020 2020 2020 6966  ments.        if
+0001f4f0: 2061 7267 6c65 6e3d 3d30 3a0a 2020 2020   arglen==0:.    
+0001f500: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
+0001f510: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
+0001f520: 2073 656c 662e 7820 3d20 302e 300a 2020   self.x = 0.0.  
+0001f530: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
+0001f540: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
+0001f550: 2020 2073 656c 662e 7a20 3d20 302e 300a     self.z = 0.0.
+0001f560: 0a20 2020 2020 2020 2023 2031 2061 7267  .        # 1 arg
+0001f570: 756d 656e 740a 2020 2020 2020 2020 656c  ument.        el
+0001f580: 6966 2061 7267 6c65 6e3d 3d31 3a0a 2020  if arglen==1:.  
+0001f590: 2020 2020 2020 2020 2020 5420 3d20 7479            T = ty
+0001f5a0: 7065 2861 7267 735b 305d 290a 2020 2020  pe(args[0]).    
+0001f5b0: 2020 2020 2020 2020 2320 7363 616c 6172          # scalar
+0001f5c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001f5d0: 5420 6973 2066 6c6f 6174 206f 7220 5420  T is float or T 
+0001f5e0: 6973 2069 6e74 206f 7220 5420 6973 206c  is int or T is l
+0001f5f0: 6f6e 673a 0a20 2020 2020 2020 2020 2020  ong:.           
+0001f600: 2020 2020 2073 656c 662e 7720 3d20 6172       self.w = ar
+0001f610: 6773 5b30 5d0a 2020 2020 2020 2020 2020  gs[0].          
+0001f620: 2020 2020 2020 7365 6c66 2e78 203d 2030        self.x = 0
+0001f630: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
+0001f640: 2020 2073 656c 662e 7920 3d20 302e 300a     self.y = 0.0.
+0001f650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f660: 7365 6c66 2e7a 203d 2030 2e30 0a20 2020  self.z = 0.0.   
+0001f670: 2020 2020 2020 2020 2023 2071 7561 740a           # quat.
+0001f680: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0001f690: 2054 2069 7320 7175 6174 3a0a 2020 2020   T is quat:.    
+0001f6a0: 2020 2020 2020 2020 2020 2020 7120 3d20              q = 
+0001f6b0: 6172 6773 5b30 5d0a 2020 2020 2020 2020  args[0].        
+0001f6c0: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
+0001f6d0: 2071 2e77 0a20 2020 2020 2020 2020 2020   q.w.           
+0001f6e0: 2020 2020 2073 656c 662e 7820 3d20 712e       self.x = q.
+0001f6f0: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
+0001f700: 2020 7365 6c66 2e79 203d 2071 2e79 0a20    self.y = q.y. 
+0001f710: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001f720: 656c 662e 7a20 3d20 712e 7a0a 2020 2020  elf.z = q.z.    
+0001f730: 2020 2020 2020 2020 2320 5374 7269 6e67          # String
+0001f740: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0001f750: 6620 5420 6973 2073 7472 206f 7220 5420  f T is str or T 
+0001f760: 6973 2075 6e69 636f 6465 3a0a 2020 2020  is unicode:.    
+0001f770: 2020 2020 2020 2020 2020 2020 733d 6172              s=ar
+0001f780: 6773 5b30 5d2e 7265 706c 6163 6528 222c  gs[0].replace(",
+0001f790: 222c 2220 2229 2e72 6570 6c61 6365 2822  "," ").replace("
+0001f7a0: 2020 222c 2220 2229 2e73 7472 6970 2829    "," ").strip()
+0001f7b0: 2e73 706c 6974 2822 2022 290a 2020 2020  .split(" ").    
+0001f7c0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001f7d0: 3d3d 5b22 225d 3a0a 2020 2020 2020 2020  ==[""]:.        
+0001f7e0: 2020 2020 2020 2020 2020 2020 733d 5b5d              s=[]
+0001f7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f800: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0001f810: 6c65 6e28 7329 293a 0a20 2020 2020 2020  len(s)):.       
+0001f820: 2020 2020 2020 2020 2020 2020 2074 7279               try
+0001f830: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001f840: 2020 2020 2020 2020 2020 735b 695d 203d            s[i] =
+0001f850: 2066 6c6f 6174 2873 5b69 5d29 0a20 2020   float(s[i]).   
+0001f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f870: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
+0001f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f890: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001f8a0: 722c 2271 7561 7428 2920 6172 6720 6973  r,"quat() arg is
+0001f8b0: 2061 206d 616c 666f 726d 6564 2073 7472   a malformed str
+0001f8c0: 696e 6722 0a20 2020 2020 2020 2020 2020  ing".           
+0001f8d0: 2020 2020 2071 203d 2071 7561 7428 7329       q = quat(s)
+0001f8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f8f0: 2073 656c 662e 7720 3d20 712e 770a 2020   self.w = q.w.  
+0001f900: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001f910: 6c66 2e78 203d 2071 2e78 0a20 2020 2020  lf.x = q.x.     
+0001f920: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001f930: 7920 3d20 712e 790a 2020 2020 2020 2020  y = q.y.        
+0001f940: 2020 2020 2020 2020 7365 6c66 2e7a 203d          self.z =
+0001f950: 2071 2e7a 0a20 2020 2020 2020 2020 2020   q.z.           
+0001f960: 2023 2053 6571 7565 6e63 6520 6f66 2066   # Sequence of f
+0001f970: 6c6f 6174 730a 2020 2020 2020 2020 2020  loats.          
+0001f980: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001f990: 2020 2020 2020 2020 7365 7120 3d20 6172          seq = ar
+0001f9a0: 6773 5b30 5d0a 2020 2020 2020 2020 2020  gs[0].          
+0001f9b0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+0001f9c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001f9d0: 6571 6c65 6e20 3d20 6c65 6e28 7365 7129  eqlen = len(seq)
+0001f9e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f9f0: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
+0001fa00: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0001fa10: 7365 2054 7970 6545 7272 6f72 2c22 7175  se TypeError,"qu
+0001fa20: 6174 2829 2061 7267 2063 616e 2774 2062  at() arg can't b
+0001fa30: 6520 636f 6e76 6572 7465 6420 746f 2071  e converted to q
+0001fa40: 7561 7422 0a0a 2020 2020 2020 2020 2020  uat"..          
+0001fa50: 2020 2020 2020 6966 2073 6571 6c65 6e3d        if seqlen=
+0001fa60: 3d30 3a0a 2020 2020 2020 2020 2020 2020  =0:.            
+0001fa70: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
+0001fa80: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
+0001fa90: 2020 2020 2020 2020 2073 656c 662e 7820           self.x 
+0001faa0: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
+0001fab0: 2020 2020 2020 2020 2020 7365 6c66 2e79            self.y
+0001fac0: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
+0001fad0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001fae0: 7a20 3d20 302e 300a 2020 2020 2020 2020  z = 0.0.        
+0001faf0: 2020 2020 2020 2020 656c 6966 2073 6571          elif seq
+0001fb00: 6c65 6e3d 3d31 3a0a 2020 2020 2020 2020  len==1:.        
+0001fb10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001fb20: 2e77 203d 2073 6571 5b30 5d0a 2020 2020  .w = seq[0].    
+0001fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb40: 7365 6c66 2e78 203d 2030 2e30 0a20 2020  self.x = 0.0.   
+0001fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb60: 2073 656c 662e 7920 3d20 302e 300a 2020   self.y = 0.0.  
+0001fb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb80: 2020 7365 6c66 2e7a 203d 2030 2e30 0a20    self.z = 0.0. 
+0001fb90: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001fba0: 6c69 6620 7365 716c 656e 3d3d 343a 0a20  lif seqlen==4:. 
+0001fbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fbc0: 2020 2073 656c 662e 7720 3d20 7365 715b     self.w = seq[
+0001fbd0: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+0001fbe0: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
+0001fbf0: 7365 715b 315d 0a20 2020 2020 2020 2020  seq[1].         
+0001fc00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001fc10: 7920 3d20 7365 715b 325d 0a20 2020 2020  y = seq[2].     
+0001fc20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001fc30: 656c 662e 7a20 3d20 7365 715b 335d 0a20  elf.z = seq[3]. 
+0001fc40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001fc50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001fc60: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0001fc70: 7970 6545 7272 6f72 2c20 2271 7561 7428  ypeError, "quat(
+0001fc80: 2920 6172 6720 6361 6e27 7420 6265 2063  ) arg can't be c
+0001fc90: 6f6e 7665 7274 6564 2074 6f20 7175 6174  onverted to quat
+0001fca0: 220a 0a20 2020 2020 2020 2023 2032 2061  "..        # 2 a
+0001fcb0: 7267 756d 656e 7473 2028 616e 676c 6520  rguments (angle 
+0001fcc0: 2620 6178 6973 290a 2020 2020 2020 2020  & axis).        
+0001fcd0: 656c 6966 2061 7267 6c65 6e3d 3d32 3a0a  elif arglen==2:.
+0001fce0: 2020 2020 2020 2020 2020 2020 616e 676c              angl
+0001fcf0: 652c 2061 7869 7320 3d20 6172 6773 0a20  e, axis = args. 
+0001fd00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001fd10: 6672 6f6d 416e 676c 6541 7869 7328 616e  fromAngleAxis(an
+0001fd20: 676c 652c 6178 6973 290a 0a20 2020 2020  gle,axis)..     
+0001fd30: 2020 2023 2034 2061 7267 756d 656e 7473     # 4 arguments
+0001fd40: 0a20 2020 2020 2020 2065 6c69 6620 6172  .        elif ar
+0001fd50: 676c 656e 3d3d 343a 0a20 2020 2020 2020  glen==4:.       
+0001fd60: 2020 2020 2073 656c 662e 7720 3d20 6172       self.w = ar
+0001fd70: 6773 5b30 5d0a 2020 2020 2020 2020 2020  gs[0].          
+0001fd80: 2020 7365 6c66 2e78 203d 2061 7267 735b    self.x = args[
+0001fd90: 315d 0a20 2020 2020 2020 2020 2020 2073  1].            s
+0001fda0: 656c 662e 7920 3d20 6172 6773 5b32 5d0a  elf.y = args[2].
+0001fdb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001fdc0: 2e7a 203d 2061 7267 735b 335d 0a0a 2020  .z = args[3]..  
+0001fdd0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001fde0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+0001fdf0: 7065 4572 726f 722c 2022 7175 6174 2829  peError, "quat()
+0001fe00: 2061 7267 2063 616e 2774 2062 6520 636f   arg can't be co
+0001fe10: 6e76 6572 7465 6420 746f 2071 7561 7422  nverted to quat"
+0001fe20: 0a0a 2020 2020 6465 6620 5f5f 7265 6475  ..    def __redu
+0001fe30: 6365 5f5f 2873 656c 6629 3a0a 2020 2020  ce__(self):.    
+0001fe40: 2020 2020 7265 7475 726e 2028 5f71 7561      return (_qua
+0001fe50: 7463 6f6e 7374 7275 6374 2c20 2873 656c  tconstruct, (sel
+0001fe60: 662e 772c 2073 656c 662e 782c 2073 656c  f.w, self.x, sel
+0001fe70: 662e 792c 2073 656c 662e 7a29 290a 0a20  f.y, self.z)).. 
+0001fe80: 2020 2064 6566 205f 5f72 6570 725f 5f28     def __repr__(
+0001fe90: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+0001fea0: 6574 7572 6e20 2771 7561 7428 2573 2c20  eturn 'quat(%s, 
+0001feb0: 2573 2c20 2573 2c20 2573 2927 2528 7265  %s, %s, %s)'%(re
+0001fec0: 7072 2873 656c 662e 7729 2c72 6570 7228  pr(self.w),repr(
+0001fed0: 7365 6c66 2e78 292c 7265 7072 2873 656c  self.x),repr(sel
+0001fee0: 662e 7929 2c72 6570 7228 7365 6c66 2e7a  f.y),repr(self.z
+0001fef0: 2929 0a0a 2020 2020 6465 6620 5f5f 7374  ))..    def __st
+0001ff00: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
+0001ff10: 2020 2072 6574 7572 6e20 2228 2531 2e34     return "(%1.4
+0001ff20: 662c 2025 312e 3466 2c20 2531 2e34 662c  f, %1.4f, %1.4f,
+0001ff30: 2025 312e 3466 2922 2528 7365 6c66 2e77   %1.4f)"%(self.w
+0001ff40: 2c20 7365 6c66 2e78 2c20 7365 6c66 2e79  , self.x, self.y
+0001ff50: 2c20 7365 6c66 2e7a 290a 0a0a 2020 2020  , self.z)...    
+0001ff60: 6465 6620 5f5f 7269 6368 636d 705f 5f28  def __richcmp__(
+0001ff70: 612c 622c 6f70 293a 0a20 2020 2020 2020  a,b,op):.       
+0001ff80: 2063 6465 6620 7175 6174 2076 612c 2076   cdef quat va, v
+0001ff90: 620a 2020 2020 2020 2020 6364 6566 2069  b.        cdef i
+0001ffa0: 6e74 2063 6f70 0a0a 2020 2020 2020 2020  nt cop..        
+0001ffb0: 636f 7020 3d20 6f70 0a0a 2020 2020 2020  cop = op..      
+0001ffc0: 2020 7461 203d 2074 7970 6528 6129 0a20    ta = type(a). 
+0001ffd0: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
+0001ffe0: 2862 290a 2020 2020 2020 2020 6966 2028  (b).        if (
+0001fff0: 7461 213d 7175 6174 206f 7220 7462 213d  ta!=quat or tb!=
+00020000: 7175 6174 293a 0a20 2020 2020 2020 2020  quat):.         
+00020010: 2020 2069 6620 636f 703d 3d33 3a0a 2020     if cop==3:.  
+00020020: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00020030: 7475 726e 2031 0a20 2020 2020 2020 2020  turn 1.         
+00020040: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00020050: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00020060: 300a 0a20 2020 2020 2020 2076 6120 3d20  0..        va = 
+00020070: 610a 2020 2020 2020 2020 7662 203d 2062  a.        vb = b
+00020080: 0a0a 2020 2020 2020 2020 2320 3c0a 2020  ..        # <.  
+00020090: 2020 2020 2020 6966 2063 6f70 3d3d 303a        if cop==0:
+000200a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000200b0: 7572 6e20 300a 2020 2020 2020 2020 2320  urn 0.        # 
+000200c0: 3c3d 0a20 2020 2020 2020 2065 6c69 6620  <=.        elif 
+000200d0: 636f 703d 3d31 3a0a 2020 2020 2020 2020  cop==1:.        
+000200e0: 2020 2020 7265 7475 726e 2030 0a20 2020      return 0.   
+000200f0: 2020 2020 2023 203d 3d0a 2020 2020 2020       # ==.      
+00020100: 2020 656c 6966 2063 6f70 3d3d 323a 0a20    elif cop==2:. 
+00020110: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00020120: 6e20 2866 6162 7328 7661 2e77 2d76 622e  n (fabs(va.w-vb.
+00020130: 7729 3c3d 6570 7320 616e 6420 6661 6273  w)<=eps and fabs
+00020140: 2876 612e 782d 7662 2e78 293c 3d65 7073  (va.x-vb.x)<=eps
+00020150: 2061 6e64 2066 6162 7328 7661 2e79 2d76   and fabs(va.y-v
+00020160: 622e 7929 3c3d 6570 7320 616e 6420 6661  b.y)<=eps and fa
+00020170: 6273 2876 612e 7a2d 7662 2e7a 293c 3d65  bs(va.z-vb.z)<=e
+00020180: 7073 290a 2020 2020 2020 2020 2320 213d  ps).        # !=
+00020190: 0a20 2020 2020 2020 2065 6c69 6620 636f  .        elif co
+000201a0: 703d 3d33 3a0a 2020 2020 2020 2020 2020  p==3:.          
+000201b0: 2020 7265 7475 726e 2028 6661 6273 2876    return (fabs(v
+000201c0: 612e 772d 7662 2e77 293e 6570 7320 6f72  a.w-vb.w)>eps or
+000201d0: 2066 6162 7328 7661 2e78 2d76 622e 7829   fabs(va.x-vb.x)
+000201e0: 3e65 7073 206f 7220 6661 6273 2876 612e  >eps or fabs(va.
+000201f0: 792d 7662 2e79 293e 6570 7320 616e 6420  y-vb.y)>eps and 
+00020200: 6661 6273 2876 612e 7a2d 7662 2e7a 293e  fabs(va.z-vb.z)>
+00020210: 6570 7329 0a20 2020 2020 2020 2023 203e  eps).        # >
+00020220: 0a20 2020 2020 2020 2065 6c69 6620 636f  .        elif co
+00020230: 703d 3d34 3a0a 2020 2020 2020 2020 2020  p==4:.          
+00020240: 2020 7265 7475 726e 2030 0a20 2020 2020    return 0.     
+00020250: 2020 2023 203e 3d0a 2020 2020 2020 2020     # >=.        
+00020260: 656c 6966 2063 6f70 3d3d 353a 0a20 2020  elif cop==5:.   
+00020270: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00020280: 300a 2020 2020 2020 2020 2320 736f 6e73  0.        # sons
+00020290: 7420 2846 6568 6c65 7229 0a20 2020 2020  t (Fehler).     
+000202a0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000202b0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+000202c0: 4572 726f 722c 2269 6e74 6572 6e61 6c20  Error,"internal 
+000202d0: 6572 726f 723a 2069 6c6c 6567 616c 2072  error: illegal r
+000202e0: 6963 6820 636f 6d70 6172 6973 6f6e 206e  ich comparison n
+000202f0: 756d 6265 7222 0a0a 2020 2020 6465 6620  umber"..    def 
+00020300: 5f5f 6164 645f 5f28 7175 6174 2061 2c20  __add__(quat a, 
+00020310: 7175 6174 2062 293a 0a20 2020 2020 2020  quat b):.       
+00020320: 2022 2222 4164 6469 7469 6f6e 2e0a 0a20   """Addition... 
+00020330: 2020 2020 2020 203e 3e3e 2071 3d71 7561         >>> q=qua
+00020340: 7428 302e 3936 3839 2c20 302e 3231 3630  t(0.9689, 0.2160
+00020350: 2c20 302e 3130 3830 2c20 302e 3035 3430  , 0.1080, 0.0540
+00020360: 290a 2020 2020 2020 2020 3e3e 3e20 7072  ).        >>> pr
+00020370: 696e 7420 712b 710a 2020 2020 2020 2020  int q+q.        
+00020380: 2831 2e39 3337 382c 2030 2e34 3332 302c  (1.9378, 0.4320,
+00020390: 2030 2e32 3136 302c 2030 2e31 3038 3029   0.2160, 0.1080)
+000203a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000203b0: 2020 2020 2063 6465 6620 7175 6174 2072       cdef quat r
+000203c0: 6573 0a20 2020 2020 2020 2072 6573 203d  es.        res =
+000203d0: 2071 7561 7428 290a 2020 2020 2020 2020   quat().        
+000203e0: 7265 732e 7720 3d20 612e 772b 622e 770a  res.w = a.w+b.w.
+000203f0: 2020 2020 2020 2020 7265 732e 7820 3d20          res.x = 
+00020400: 612e 782b 622e 780a 2020 2020 2020 2020  a.x+b.x.        
+00020410: 7265 732e 7920 3d20 612e 792b 622e 790a  res.y = a.y+b.y.
+00020420: 2020 2020 2020 2020 7265 732e 7a20 3d20          res.z = 
+00020430: 612e 7a2b 622e 7a0a 2020 2020 2020 2020  a.z+b.z.        
+00020440: 7265 7475 726e 2072 6573 0a0a 2020 2020  return res..    
+00020450: 6465 6620 5f5f 7375 625f 5f28 7175 6174  def __sub__(quat
+00020460: 2061 2c20 7175 6174 2062 293a 0a20 2020   a, quat b):.   
+00020470: 2020 2020 2022 2222 5375 6274 7261 6374       """Subtract
+00020480: 696f 6e2e 0a0a 2020 2020 2020 2020 3e3e  ion...        >>
+00020490: 3e20 713d 7175 6174 2830 2e39 3638 392c  > q=quat(0.9689,
+000204a0: 2030 2e32 3136 302c 2030 2e31 3038 302c   0.2160, 0.1080,
+000204b0: 2030 2e30 3534 3029 0a20 2020 2020 2020   0.0540).       
+000204c0: 203e 3e3e 2070 7269 6e74 2071 2d71 0a20   >>> print q-q. 
+000204d0: 2020 2020 2020 2028 302e 3030 3030 2c20         (0.0000, 
+000204e0: 302e 3030 3030 2c20 302e 3030 3030 2c20  0.0000, 0.0000, 
+000204f0: 302e 3030 3030 290a 2020 2020 2020 2020  0.0000).        
+00020500: 2222 220a 2020 2020 2020 2020 6364 6566  """.        cdef
+00020510: 2071 7561 7420 7265 730a 2020 2020 2020   quat res.      
+00020520: 2020 7265 7320 3d20 7175 6174 2829 0a20    res = quat(). 
+00020530: 2020 2020 2020 2072 6573 2e77 203d 2061         res.w = a
+00020540: 2e77 2d62 2e77 0a20 2020 2020 2020 2072  .w-b.w.        r
+00020550: 6573 2e78 203d 2061 2e78 2d62 2e78 0a20  es.x = a.x-b.x. 
+00020560: 2020 2020 2020 2072 6573 2e79 203d 2061         res.y = a
+00020570: 2e79 2d62 2e79 0a20 2020 2020 2020 2072  .y-b.y.        r
+00020580: 6573 2e7a 203d 2061 2e7a 2d62 2e7a 0a20  es.z = a.z-b.z. 
+00020590: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+000205a0: 730a 0a20 2020 2064 6566 205f 5f6d 756c  s..    def __mul
+000205b0: 5f5f 2861 2c20 6229 3a0a 2020 2020 2020  __(a, b):.      
+000205c0: 2020 2222 224d 756c 7469 706c 6963 6174    """Multiplicat
+000205d0: 696f 6e2e 0a0a 2020 2020 2020 2020 3e3e  ion...        >>
+000205e0: 3e20 713d 7175 6174 2830 2e39 3638 392c  > q=quat(0.9689,
+000205f0: 2030 2e32 3136 302c 2030 2e31 3038 302c   0.2160, 0.1080,
+00020600: 2030 2e30 3534 3029 0a20 2020 2020 2020   0.0540).       
+00020610: 203e 3e3e 2070 7269 6e74 2071 2a32 2e30   >>> print q*2.0
+00020620: 0a20 2020 2020 2020 2028 312e 3933 3738  .        (1.9378
+00020630: 2c20 302e 3433 3230 2c20 302e 3231 3630  , 0.4320, 0.2160
+00020640: 2c20 302e 3130 3830 290a 2020 2020 2020  , 0.1080).      
+00020650: 2020 3e3e 3e20 7072 696e 7420 322e 302a    >>> print 2.0*
+00020660: 710a 2020 2020 2020 2020 2831 2e39 3337  q.        (1.937
+00020670: 382c 2030 2e34 3332 302c 2030 2e32 3136  8, 0.4320, 0.216
+00020680: 302c 2030 2e31 3038 3029 0a20 2020 2020  0, 0.1080).     
+00020690: 2020 203e 3e3e 2070 7269 6e74 2071 2a71     >>> print q*q
+000206a0: 0a20 2020 2020 2020 2028 302e 3837 3735  .        (0.8775
+000206b0: 2c20 302e 3431 3836 2c20 302e 3230 3933  , 0.4186, 0.2093
+000206c0: 2c20 302e 3130 3436 290a 2020 2020 2020  , 0.1046).      
+000206d0: 2020 2222 220a 2020 2020 2020 2020 6364    """.        cd
+000206e0: 6566 2071 7561 7420 7265 732c 2076 612c  ef quat res, va,
+000206f0: 2076 620a 2020 2020 2020 2020 6364 6566   vb.        cdef
+00020700: 2064 6f75 626c 6520 720a 0a20 2020 2020   double r..     
+00020710: 2020 2074 6120 3d20 7479 7065 2861 290a     ta = type(a).
+00020720: 2020 2020 2020 2020 7462 203d 2074 7970          tb = typ
+00020730: 6528 6229 0a0a 2020 2020 2020 2020 6966  e(b)..        if
+00020740: 2074 6120 6973 2071 7561 743a 0a20 2020   ta is quat:.   
+00020750: 2020 2020 2020 2020 2076 6120 3d20 610a           va = a.
+00020760: 2020 2020 2020 2020 2020 2020 6966 2074              if t
+00020770: 6220 6973 2071 7561 743a 0a20 2020 2020  b is quat:.     
+00020780: 2020 2020 2020 2020 2020 2023 2071 7561             # qua
+00020790: 742a 7175 6174 0a20 2020 2020 2020 2020  t*quat.         
+000207a0: 2020 2020 2020 2076 6220 3d20 620a 2020         vb = b.  
+000207b0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000207c0: 7320 3d20 7175 6174 2829 0a20 2020 2020  s = quat().     
+000207d0: 2020 2020 2020 2020 2020 2072 6573 2e77             res.w
+000207e0: 203d 2076 612e 772a 7662 2e77 202d 2076   = va.w*vb.w - v
+000207f0: 612e 782a 7662 2e78 202d 2076 612e 792a  a.x*vb.x - va.y*
+00020800: 7662 2e79 202d 2076 612e 7a2a 7662 2e7a  vb.y - va.z*vb.z
+00020810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020820: 2072 6573 2e78 203d 2076 612e 772a 7662   res.x = va.w*vb
+00020830: 2e78 202b 2076 612e 782a 7662 2e77 202b  .x + va.x*vb.w +
+00020840: 2076 612e 792a 7662 2e7a 202d 2076 612e   va.y*vb.z - va.
+00020850: 7a2a 7662 2e79 0a20 2020 2020 2020 2020  z*vb.y.         
+00020860: 2020 2020 2020 2072 6573 2e79 203d 2076         res.y = v
+00020870: 612e 772a 7662 2e79 202b 2076 612e 792a  a.w*vb.y + va.y*
+00020880: 7662 2e77 202d 2076 612e 782a 7662 2e7a  vb.w - va.x*vb.z
+00020890: 202b 2076 612e 7a2a 7662 2e78 0a20 2020   + va.z*vb.x.   
+000208a0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+000208b0: 2e7a 203d 2076 612e 772a 7662 2e7a 202b  .z = va.w*vb.z +
+000208c0: 2076 612e 7a2a 7662 2e77 202b 2076 612e   va.z*vb.w + va.
+000208d0: 782a 7662 2e79 202d 2076 612e 792a 7662  x*vb.y - va.y*vb
+000208e0: 2e78 0a20 2020 2020 2020 2020 2020 2020  .x.             
+000208f0: 2020 2072 6574 7572 6e20 7265 730a 2020     return res.  
+00020900: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
+00020910: 6220 6973 2066 6c6f 6174 206f 7220 7462  b is float or tb
+00020920: 2069 7320 696e 7420 6f72 2074 6220 6973   is int or tb is
+00020930: 206c 6f6e 673a 0a20 2020 2020 2020 2020   long:.         
+00020940: 2020 2020 2020 2023 2071 7561 742a 7363         # quat*sc
+00020950: 616c 6172 0a20 2020 2020 2020 2020 2020  alar.           
+00020960: 2020 2020 2072 6573 203d 2071 7561 7428       res = quat(
+00020970: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00020980: 2020 7220 2020 3d20 620a 2020 2020 2020    r   = b.      
+00020990: 2020 2020 2020 2020 2020 7265 732e 7720            res.w 
+000209a0: 3d20 7661 2e77 2a72 0a20 2020 2020 2020  = va.w*r.       
+000209b0: 2020 2020 2020 2020 2072 6573 2e78 203d           res.x =
+000209c0: 2076 612e 782a 720a 2020 2020 2020 2020   va.x*r.        
+000209d0: 2020 2020 2020 2020 7265 732e 7920 3d20          res.y = 
+000209e0: 7661 2e79 2a72 0a20 2020 2020 2020 2020  va.y*r.         
+000209f0: 2020 2020 2020 2072 6573 2e7a 203d 2076         res.z = v
+00020a00: 612e 7a2a 720a 2020 2020 2020 2020 2020  a.z*r.          
+00020a10: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00020a20: 0a20 2020 2020 2020 2065 6c69 6620 7461  .        elif ta
+00020a30: 2069 7320 666c 6f61 7420 6f72 2074 6120   is float or ta 
+00020a40: 6973 2069 6e74 206f 7220 7461 2069 7320  is int or ta is 
+00020a50: 6c6f 6e67 3a0a 2020 2020 2020 2020 2020  long:.          
+00020a60: 2020 6966 2074 6220 6973 2071 7561 743a    if tb is quat:
+00020a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020a80: 2023 2073 6361 6c61 722a 7175 6174 0a20   # scalar*quat. 
+00020a90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00020aa0: 6573 203d 2071 7561 7428 290a 2020 2020  es = quat().    
+00020ab0: 2020 2020 2020 2020 2020 2020 7662 2020              vb  
+00020ac0: 3d20 620a 2020 2020 2020 2020 2020 2020  = b.            
+00020ad0: 2020 2020 7220 2020 3d20 610a 2020 2020      r   = a.    
+00020ae0: 2020 2020 2020 2020 2020 2020 7265 732e              res.
+00020af0: 7720 3d20 722a 7662 2e77 0a20 2020 2020  w = r*vb.w.     
+00020b00: 2020 2020 2020 2020 2020 2072 6573 2e78             res.x
+00020b10: 203d 2072 2a76 622e 780a 2020 2020 2020   = r*vb.x.      
+00020b20: 2020 2020 2020 2020 2020 7265 732e 7920            res.y 
+00020b30: 3d20 722a 7662 2e79 0a20 2020 2020 2020  = r*vb.y.       
+00020b40: 2020 2020 2020 2020 2072 6573 2e7a 203d           res.z =
+00020b50: 2072 2a76 622e 7a0a 2020 2020 2020 2020   r*vb.z.        
+00020b60: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+00020b70: 6573 0a0a 2020 2020 2020 2020 7261 6973  es..        rais
+00020b80: 6520 5479 7065 4572 726f 722c 2022 756e  e TypeError, "un
+00020b90: 7375 7070 6f72 7465 6420 6f70 6572 616e  supported operan
+00020ba0: 6420 7479 7065 2066 6f72 202a 220a 0a20  d type for *".. 
+00020bb0: 2020 2064 6566 205f 5f64 6976 5f5f 2871     def __div__(q
+00020bc0: 7561 7420 612c 2062 293a 0a20 2020 2020  uat a, b):.     
+00020bd0: 2020 2023 2050 7974 686f 6e20 320a 2020     # Python 2.  
+00020be0: 2020 2020 2020 7265 7475 726e 2071 7561        return qua
+00020bf0: 742e 5f5f 7472 7565 6469 765f 5f28 612c  t.__truediv__(a,
+00020c00: 6229 0a0a 2020 2020 6465 6620 5f5f 7472  b)..    def __tr
+00020c10: 7565 6469 765f 5f28 7175 6174 2061 2c20  uediv__(quat a, 
+00020c20: 6229 3a0a 2020 2020 2020 2020 2222 2244  b):.        """D
+00020c30: 6976 6973 696f 6e2e 0a0a 2020 2020 2020  ivision...      
+00020c40: 2020 3e3e 3e20 713d 7175 6174 2830 2e39    >>> q=quat(0.9
+00020c50: 3638 392c 2030 2e32 3136 302c 2030 2e31  689, 0.2160, 0.1
+00020c60: 3038 302c 2030 2e30 3534 3029 0a20 2020  080, 0.0540).   
+00020c70: 2020 2020 203e 3e3e 2070 7269 6e74 2071       >>> print q
+00020c80: 2f32 2e30 0a20 2020 2020 2020 2028 302e  /2.0.        (0.
+00020c90: 3438 3434 2c20 302e 3130 3830 2c20 302e  4844, 0.1080, 0.
+00020ca0: 3035 3430 2c20 302e 3032 3730 290a 2020  0540, 0.0270).  
+00020cb0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00020cc0: 2020 6364 6566 2071 7561 7420 7265 730a    cdef quat res.
+00020cd0: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
+00020ce0: 626c 6520 720a 0a20 2020 2020 2020 2074  ble r..        t
+00020cf0: 6220 3d20 7479 7065 2862 290a 0a20 2020  b = type(b)..   
+00020d00: 2020 2020 2069 6620 7462 2069 7320 666c       if tb is fl
+00020d10: 6f61 7420 6f72 2074 6220 6973 2069 6e74  oat or tb is int
+00020d20: 206f 7220 7462 2069 7320 6c6f 6e67 3a0a   or tb is long:.
+00020d30: 2020 2020 2020 2020 2020 2020 2320 7175              # qu
+00020d40: 6174 2f73 6361 6c61 720a 2020 2020 2020  at/scalar.      
+00020d50: 2020 2020 2020 7265 7320 3d20 7175 6174        res = quat
+00020d60: 2829 0a20 2020 2020 2020 2020 2020 2072  ().            r
+00020d70: 203d 2062 0a20 2020 2020 2020 2020 2020   = b.           
+00020d80: 2069 6620 6661 6273 2872 293c 3d65 7073   if fabs(r)<=eps
+00020d90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00020da0: 2020 7261 6973 6520 5a65 726f 4469 7669    raise ZeroDivi
+00020db0: 7369 6f6e 4572 726f 722c 2271 7561 7420  sionError,"quat 
+00020dc0: 6469 7669 7369 6f6e 220a 2020 2020 2020  division".      
+00020dd0: 2020 2020 2020 7265 732e 7720 3d20 612e        res.w = a.
+00020de0: 772f 720a 2020 2020 2020 2020 2020 2020  w/r.            
+00020df0: 7265 732e 7820 3d20 612e 782f 720a 2020  res.x = a.x/r.  
+00020e00: 2020 2020 2020 2020 2020 7265 732e 7920            res.y 
+00020e10: 3d20 612e 792f 720a 2020 2020 2020 2020  = a.y/r.        
+00020e20: 2020 2020 7265 732e 7a20 3d20 612e 7a2f      res.z = a.z/
+00020e30: 720a 2020 2020 2020 2020 2020 2020 7265  r.            re
+00020e40: 7475 726e 2072 6573 0a20 2020 2020 2020  turn res.       
+00020e50: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00020e60: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00020e70: 6f72 2c20 2275 6e73 7570 706f 7274 6564  or, "unsupported
+00020e80: 206f 7065 7261 6e64 2074 7970 6520 666f   operand type fo
+00020e90: 7220 2f22 0a0a 2020 2020 6465 6620 5f5f  r /"..    def __
+00020ea0: 706f 775f 5f28 7175 6174 2073 656c 662c  pow__(quat self,
+00020eb0: 206f 7468 6572 2c20 6d6f 6475 6c6f 293a   other, modulo):
+00020ec0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00020ed0: 726e 2073 656c 662a 2a71 2e22 2222 0a20  rn self**q.""". 
+00020ee0: 2020 2020 2020 2063 6465 6620 7175 6174         cdef quat
+00020ef0: 2071 0a20 2020 2020 2020 2069 6620 6d6f   q.        if mo
+00020f00: 6475 6c6f 213d 4e6f 6e65 3a0a 2020 2020  dulo!=None:.    
+00020f10: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00020f20: 7065 4572 726f 722c 2022 756e 7375 7070  peError, "unsupp
+00020f30: 6f72 7465 6420 6f70 6572 6174 696f 6e22  orted operation"
+00020f40: 0a20 2020 2020 2020 2071 203d 2071 7561  .        q = qua
+00020f50: 7428 6f74 6865 7229 0a20 2020 2020 2020  t(other).       
+00020f60: 2072 6574 7572 6e20 2871 2a73 656c 662e   return (q*self.
+00020f70: 6c6f 6728 2929 2e65 7870 2829 0a0a 2020  log()).exp()..  
+00020f80: 2020 6465 6620 5f5f 6e65 675f 5f28 7365    def __neg__(se
+00020f90: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00020fa0: 4e65 6761 7469 6f6e 2e0a 0a20 2020 2020  Negation...     
+00020fb0: 2020 203e 3e3e 2071 3d71 7561 7428 302e     >>> q=quat(0.
+00020fc0: 3936 3839 2c20 302e 3231 3630 2c20 302e  9689, 0.2160, 0.
+00020fd0: 3130 3830 2c20 302e 3035 3430 290a 2020  1080, 0.0540).  
+00020fe0: 2020 2020 2020 3e3e 3e20 7072 696e 7420        >>> print 
+00020ff0: 2d71 0a20 2020 2020 2020 2028 2d30 2e39  -q.        (-0.9
+00021000: 3638 392c 202d 302e 3231 3630 2c20 2d30  689, -0.2160, -0
+00021010: 2e31 3038 302c 202d 302e 3035 3430 290a  .1080, -0.0540).
+00021020: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00021030: 2020 2020 6364 6566 2071 7561 7420 7265      cdef quat re
+00021040: 730a 2020 2020 2020 2020 7265 7320 3d20  s.        res = 
+00021050: 7175 6174 2829 0a20 2020 2020 2020 2072  quat().        r
+00021060: 6573 2e77 203d 202d 7365 6c66 2e77 0a20  es.w = -self.w. 
+00021070: 2020 2020 2020 2072 6573 2e78 203d 202d         res.x = -
+00021080: 7365 6c66 2e78 0a20 2020 2020 2020 2072  self.x.        r
+00021090: 6573 2e79 203d 202d 7365 6c66 2e79 0a20  es.y = -self.y. 
+000210a0: 2020 2020 2020 2072 6573 2e7a 203d 202d         res.z = -
+000210b0: 7365 6c66 2e7a 0a20 2020 2020 2020 2072  self.z.        r
+000210c0: 6574 7572 6e20 7265 730a 0a20 2020 2064  eturn res..    d
+000210d0: 6566 205f 5f70 6f73 5f5f 2873 656c 6629  ef __pos__(self)
+000210e0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000210f0: 2020 2020 2020 3e3e 3e20 713d 7175 6174        >>> q=quat
+00021100: 2830 2e39 3638 392c 2030 2e32 3136 302c  (0.9689, 0.2160,
+00021110: 2030 2e31 3038 302c 2030 2e30 3534 3029   0.1080, 0.0540)
+00021120: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00021130: 6e74 202b 710a 2020 2020 2020 2020 2830  nt +q.        (0
+00021140: 2e39 3638 392c 2030 2e32 3136 302c 2030  .9689, 0.2160, 0
+00021150: 2e31 3038 302c 2030 2e30 3534 3029 0a20  .1080, 0.0540). 
+00021160: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00021170: 2020 2063 6465 6620 7175 6174 2072 6573     cdef quat res
+00021180: 0a20 2020 2020 2020 2072 6573 203d 2071  .        res = q
+00021190: 7561 7428 290a 2020 2020 2020 2020 7265  uat().        re
+000211a0: 732e 7720 3d20 7365 6c66 2e77 0a20 2020  s.w = self.w.   
+000211b0: 2020 2020 2072 6573 2e78 203d 2073 656c       res.x = sel
+000211c0: 662e 780a 2020 2020 2020 2020 7265 732e  f.x.        res.
+000211d0: 7920 3d20 7365 6c66 2e79 0a20 2020 2020  y = self.y.     
+000211e0: 2020 2072 6573 2e7a 203d 2073 656c 662e     res.z = self.
+000211f0: 7a0a 2020 2020 2020 2020 7265 7475 726e  z.        return
+00021200: 2072 6573 0a0a 2020 2020 6465 6620 5f5f   res..    def __
+00021210: 6961 6464 5f5f 2873 656c 662c 2071 7561  iadd__(self, qua
+00021220: 7420 6f74 6865 7229 3a0a 2020 2020 2020  t other):.      
+00021230: 2020 2222 2249 6e6c 696e 6520 7175 6174    """Inline quat
+00021240: 6572 6e69 6f6e 2061 6464 6974 696f 6e2e  ernion addition.
+00021250: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00021260: 2020 2020 2073 656c 662e 773d 7365 6c66       self.w=self
+00021270: 2e77 2b6f 7468 6572 2e77 0a20 2020 2020  .w+other.w.     
+00021280: 2020 2073 656c 662e 783d 7365 6c66 2e78     self.x=self.x
+00021290: 2b6f 7468 6572 2e78 0a20 2020 2020 2020  +other.x.       
+000212a0: 2073 656c 662e 793d 7365 6c66 2e79 2b6f   self.y=self.y+o
+000212b0: 7468 6572 2e79 0a20 2020 2020 2020 2073  ther.y.        s
+000212c0: 656c 662e 7a3d 7365 6c66 2e7a 2b6f 7468  elf.z=self.z+oth
+000212d0: 6572 2e7a 0a20 2020 2020 2020 2072 6574  er.z.        ret
+000212e0: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
+000212f0: 6620 5f5f 6973 7562 5f5f 2873 656c 662c  f __isub__(self,
+00021300: 2071 7561 7420 6f74 6865 7229 3a0a 2020   quat other):.  
+00021310: 2020 2020 2020 2222 2249 6e6c 696e 6520        """Inline 
+00021320: 7175 6174 6572 6e69 6f6e 2073 7562 7472  quaternion subtr
+00021330: 6163 7469 6f6e 2e0a 2020 2020 2020 2020  action..        
+00021340: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
+00021350: 2e77 3d73 656c 662e 772d 6f74 6865 722e  .w=self.w-other.
+00021360: 770a 2020 2020 2020 2020 7365 6c66 2e78  w.        self.x
+00021370: 3d73 656c 662e 782d 6f74 6865 722e 780a  =self.x-other.x.
+00021380: 2020 2020 2020 2020 7365 6c66 2e79 3d73          self.y=s
+00021390: 656c 662e 792d 6f74 6865 722e 790a 2020  elf.y-other.y.  
+000213a0: 2020 2020 2020 7365 6c66 2e7a 3d73 656c        self.z=sel
+000213b0: 662e 7a2d 6f74 6865 722e 7a0a 2020 2020  f.z-other.z.    
+000213c0: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+000213d0: 0a20 2020 2064 6566 205f 5f69 6d75 6c5f  .    def __imul_
+000213e0: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0a  _(self, other):.
+000213f0: 2020 2020 2020 2020 2222 2249 6e6c 696e          """Inlin
+00021400: 6520 6d75 6c74 6970 6c69 6361 7469 6f6e  e multiplication
+00021410: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00021420: 2020 2020 2020 6364 6566 2071 7561 7420        cdef quat 
+00021430: 7662 0a20 2020 2020 2020 2063 6465 6620  vb.        cdef 
+00021440: 646f 7562 6c65 2072 0a20 2020 2020 2020  double r.       
+00021450: 2063 6465 6620 646f 7562 6c65 2077 2c78   cdef double w,x
+00021460: 2c79 2c7a 0a0a 2020 2020 2020 2020 5420  ,y,z..        T 
+00021470: 3d20 7479 7065 286f 7468 6572 290a 0a20  = type(other).. 
+00021480: 2020 2020 2020 2069 6620 5420 6973 2071         if T is q
+00021490: 7561 743a 0a20 2020 2020 2020 2020 2020  uat:.           
+000214a0: 2023 2071 7561 742a 3d71 7561 740a 2020   # quat*=quat.  
+000214b0: 2020 2020 2020 2020 2020 7662 203d 206f            vb = o
+000214c0: 7468 6572 0a20 2020 2020 2020 2020 2020  ther.           
+000214d0: 2077 203d 2073 656c 662e 772a 7662 2e77   w = self.w*vb.w
+000214e0: 202d 2073 656c 662e 782a 7662 2e78 202d   - self.x*vb.x -
+000214f0: 2073 656c 662e 792a 7662 2e79 202d 2073   self.y*vb.y - s
+00021500: 656c 662e 7a2a 7662 2e7a 0a20 2020 2020  elf.z*vb.z.     
+00021510: 2020 2020 2020 2078 203d 2073 656c 662e         x = self.
+00021520: 772a 7662 2e78 202b 2073 656c 662e 782a  w*vb.x + self.x*
+00021530: 7662 2e77 202b 2073 656c 662e 792a 7662  vb.w + self.y*vb
+00021540: 2e7a 202d 2073 656c 662e 7a2a 7662 2e79  .z - self.z*vb.y
+00021550: 0a20 2020 2020 2020 2020 2020 2079 203d  .            y =
+00021560: 2073 656c 662e 772a 7662 2e79 202b 2073   self.w*vb.y + s
+00021570: 656c 662e 792a 7662 2e77 202d 2073 656c  elf.y*vb.w - sel
+00021580: 662e 782a 7662 2e7a 202b 2073 656c 662e  f.x*vb.z + self.
+00021590: 7a2a 7662 2e78 0a20 2020 2020 2020 2020  z*vb.x.         
+000215a0: 2020 207a 203d 2073 656c 662e 772a 7662     z = self.w*vb
+000215b0: 2e7a 202b 2073 656c 662e 7a2a 7662 2e77  .z + self.z*vb.w
+000215c0: 202b 2073 656c 662e 782a 7662 2e79 202d   + self.x*vb.y -
+000215d0: 2073 656c 662e 792a 7662 2e78 0a20 2020   self.y*vb.x.   
+000215e0: 2020 2020 2020 2020 2073 656c 662e 7720           self.w 
+000215f0: 3d20 770a 2020 2020 2020 2020 2020 2020  = w.            
+00021600: 7365 6c66 2e78 203d 2078 0a20 2020 2020  self.x = x.     
+00021610: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
+00021620: 790a 2020 2020 2020 2020 2020 2020 7365  y.            se
+00021630: 6c66 2e7a 203d 207a 0a20 2020 2020 2020  lf.z = z.       
+00021640: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00021650: 0a0a 2020 2020 2020 2020 656c 6966 2054  ..        elif T
+00021660: 2069 7320 666c 6f61 7420 6f72 2054 2069   is float or T i
+00021670: 7320 696e 7420 6f72 2054 2069 7320 6c6f  s int or T is lo
+00021680: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+00021690: 2320 7175 6174 2a3d 7363 616c 6172 0a20  # quat*=scalar. 
+000216a0: 2020 2020 2020 2020 2020 2072 2020 203d             r   =
+000216b0: 206f 7468 6572 0a20 2020 2020 2020 2020   other.         
+000216c0: 2020 2073 656c 662e 7720 3d20 7365 6c66     self.w = self
+000216d0: 2e77 2a72 0a20 2020 2020 2020 2020 2020  .w*r.           
+000216e0: 2073 656c 662e 7820 3d20 7365 6c66 2e78   self.x = self.x
+000216f0: 2a72 0a20 2020 2020 2020 2020 2020 2073  *r.            s
+00021700: 656c 662e 7920 3d20 7365 6c66 2e79 2a72  elf.y = self.y*r
+00021710: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00021720: 662e 7a20 3d20 7365 6c66 2e7a 2a72 0a20  f.z = self.z*r. 
+00021730: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00021740: 6e20 7365 6c66 0a0a 2020 2020 2020 2020  n self..        
+00021750: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00021760: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00021770: 722c 2022 756e 7375 7070 6f72 7465 6420  r, "unsupported 
+00021780: 6f70 6572 616e 6420 7479 7065 2066 6f72  operand type for
+00021790: 202a 3d22 0a0a 2020 2020 6465 6620 5f5f   *="..    def __
+000217a0: 6964 6976 5f5f 2873 656c 662c 206f 7468  idiv__(self, oth
+000217b0: 6572 293a 0a20 2020 2020 2020 2022 2222  er):.        """
+000217c0: 496e 6c69 6e65 2064 6976 6973 696f 6e20  Inline division 
+000217d0: 7769 7468 2073 6361 6c61 722e 0a20 2020  with scalar..   
+000217e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000217f0: 2063 6465 6620 646f 7562 6c65 2072 0a20   cdef double r. 
+00021800: 2020 2020 2020 2074 6220 3d20 7479 7065         tb = type
+00021810: 286f 7468 6572 290a 2020 2020 2020 2020  (other).        
+00021820: 6966 2074 6220 6973 2066 6c6f 6174 206f  if tb is float o
+00021830: 7220 7462 2069 7320 696e 7420 6f72 2074  r tb is int or t
+00021840: 6220 6973 206c 6f6e 673a 0a20 2020 2020  b is long:.     
+00021850: 2020 2020 2020 2072 3d6f 7468 6572 0a20         r=other. 
+00021860: 2020 2020 2020 2020 2020 2069 6620 6661             if fa
+00021870: 6273 2872 293c 3d65 7073 3a0a 2020 2020  bs(r)<=eps:.    
+00021880: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00021890: 6520 5a65 726f 4469 7669 7369 6f6e 4572  e ZeroDivisionEr
+000218a0: 726f 722c 2271 7561 7420 6469 7669 7369  ror,"quat divisi
+000218b0: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
+000218c0: 7365 6c66 2e77 3d73 656c 662e 772f 720a  self.w=self.w/r.
+000218d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000218e0: 2e78 3d73 656c 662e 782f 720a 2020 2020  .x=self.x/r.    
+000218f0: 2020 2020 2020 2020 7365 6c66 2e79 3d73          self.y=s
+00021900: 656c 662e 792f 720a 2020 2020 2020 2020  elf.y/r.        
+00021910: 2020 2020 7365 6c66 2e7a 3d73 656c 662e      self.z=self.
+00021920: 7a2f 720a 2020 2020 2020 2020 2020 2020  z/r.            
+00021930: 7265 7475 726e 2073 656c 660a 2020 2020  return self.    
+00021940: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00021950: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00021960: 4572 726f 722c 2022 756e 7375 7070 6f72  Error, "unsuppor
+00021970: 7465 6420 6f70 6572 616e 6420 7479 7065  ted operand type
+00021980: 2066 6f72 202f 3d22 0a0a 2020 2020 6465   for /="..    de
+00021990: 6620 5f5f 6765 7461 7474 725f 5f28 7365  f __getattr__(se
+000219a0: 6c66 2c20 6e61 6d65 293a 0a20 2020 2020  lf, name):.     
+000219b0: 2020 2069 6620 6e61 6d65 3d3d 2277 223a     if name=="w":
+000219c0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000219d0: 7572 6e20 7365 6c66 2e77 0a20 2020 2020  urn self.w.     
+000219e0: 2020 2065 6c69 6620 6e61 6d65 3d3d 2278     elif name=="x
+000219f0: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
+00021a00: 6574 7572 6e20 7365 6c66 2e78 0a20 2020  eturn self.x.   
+00021a10: 2020 2020 2065 6c69 6620 6e61 6d65 3d3d       elif name==
+00021a20: 2279 223a 0a20 2020 2020 2020 2020 2020  "y":.           
+00021a30: 2072 6574 7572 6e20 7365 6c66 2e79 0a20   return self.y. 
+00021a40: 2020 2020 2020 2065 6c69 6620 6e61 6d65         elif name
+00021a50: 3d3d 227a 223a 0a20 2020 2020 2020 2020  =="z":.         
+00021a60: 2020 2072 6574 7572 6e20 7365 6c66 2e7a     return self.z
+00021a70: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00021a80: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00021a90: 2041 7474 7269 6275 7465 4572 726f 722c   AttributeError,
+00021aa0: 2271 7561 7420 6861 7320 6e6f 2061 7474  "quat has no att
+00021ab0: 7269 6275 7465 2027 222b 6e61 6d65 2b22  ribute '"+name+"
+00021ac0: 2722 0a0a 2020 2020 6465 6620 5f5f 7365  '"..    def __se
+00021ad0: 7461 7474 725f 5f28 7365 6c66 2c20 6e61  tattr__(self, na
+00021ae0: 6d65 2c20 7661 6c29 3a0a 2020 2020 2020  me, val):.      
+00021af0: 2020 6966 206e 616d 653d 3d22 7722 3a0a    if name=="w":.
+00021b00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00021b10: 2e77 203d 2076 616c 0a20 2020 2020 2020  .w = val.       
+00021b20: 2065 6c69 6620 6e61 6d65 3d3d 2278 223a   elif name=="x":
+00021b30: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00021b40: 662e 7820 3d20 7661 6c0a 2020 2020 2020  f.x = val.      
+00021b50: 2020 656c 6966 206e 616d 653d 3d22 7922    elif name=="y"
+00021b60: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00021b70: 6c66 2e79 203d 2076 616c 0a20 2020 2020  lf.y = val.     
+00021b80: 2020 2065 6c69 6620 6e61 6d65 3d3d 227a     elif name=="z
+00021b90: 223a 0a20 2020 2020 2020 2020 2020 2073  ":.            s
+00021ba0: 656c 662e 7a20 3d20 7661 6c0a 2020 2020  elf.z = val.    
+00021bb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00021bc0: 2020 2020 2020 7261 6973 6520 4174 7472        raise Attr
+00021bd0: 6962 7574 6545 7272 6f72 2c22 7175 6174  ibuteError,"quat
+00021be0: 2068 6173 206e 6f20 7772 6974 6162 6c65   has no writable
+00021bf0: 2061 7474 7269 6275 7465 2027 222b 6e61   attribute '"+na
+00021c00: 6d65 2b22 2722 0a0a 0a20 2020 2064 6566  me+"'"...    def
+00021c10: 205f 5f61 6273 5f5f 2873 656c 6629 3a0a   __abs__(self):.
+00021c20: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00021c30: 6e20 6d61 676e 6974 7564 652e 0a0a 2020  n magnitude...  
+00021c40: 2020 2020 2020 3e3e 3e20 713d 7175 6174        >>> q=quat
+00021c50: 2830 2e39 3638 392c 2030 2e32 3136 302c  (0.9689, 0.2160,
+00021c60: 2030 2e31 3038 302c 2030 2e30 3534 3029   0.1080, 0.0540)
+00021c70: 0a20 2020 2020 2020 203e 3e3e 2070 7269  .        >>> pri
+00021c80: 6e74 2072 6f75 6e64 2861 6273 2871 292c  nt round(abs(q),
+00021c90: 3529 0a20 2020 2020 2020 2031 2e30 0a20  5).        1.0. 
+00021ca0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00021cb0: 2020 2063 6465 6620 646f 7562 6c65 2061     cdef double a
+00021cc0: 0a20 2020 2020 2020 2061 203d 2073 656c  .        a = sel
+00021cd0: 662e 772a 7365 6c66 2e77 202b 2073 656c  f.w*self.w + sel
+00021ce0: 662e 782a 7365 6c66 2e78 202b 2073 656c  f.x*self.x + sel
+00021cf0: 662e 792a 7365 6c66 2e79 202b 2073 656c  f.y*self.y + sel
+00021d00: 662e 7a2a 7365 6c66 2e7a 0a20 2020 2020  f.z*self.z.     
+00021d10: 2020 2072 6574 7572 6e20 7371 7274 2861     return sqrt(a
+00021d20: 290a 0a20 2020 2064 6566 2063 6f6e 6a75  )..    def conju
+00021d30: 6761 7465 2873 656c 6629 3a0a 2020 2020  gate(self):.    
+00021d40: 2020 2020 2222 2252 6574 7572 6e20 636f      """Return co
+00021d50: 6e6a 7567 6174 652e 0a0a 2020 2020 2020  njugate...      
+00021d60: 2020 3e3e 3e20 713d 7175 6174 2830 2e39    >>> q=quat(0.9
+00021d70: 3638 392c 2030 2e32 3136 302c 2030 2e31  689, 0.2160, 0.1
+00021d80: 3038 302c 2030 2e30 3534 3029 0a20 2020  080, 0.0540).   
+00021d90: 2020 2020 203e 3e3e 2070 7269 6e74 2071       >>> print q
+00021da0: 2e63 6f6e 6a75 6761 7465 2829 0a20 2020  .conjugate().   
+00021db0: 2020 2020 2028 302e 3936 3839 2c20 2d30       (0.9689, -0
+00021dc0: 2e32 3136 302c 202d 302e 3130 3830 2c20  .2160, -0.1080, 
+00021dd0: 2d30 2e30 3534 3029 0a20 2020 2020 2020  -0.0540).       
+00021de0: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00021df0: 6620 7175 6174 2072 6573 0a20 2020 2020  f quat res.     
+00021e00: 2020 2072 6573 3d71 7561 7428 290a 2020     res=quat().  
+00021e10: 2020 2020 2020 7265 732e 7720 3d20 7365        res.w = se
+00021e20: 6c66 2e77 0a20 2020 2020 2020 2072 6573  lf.w.        res
+00021e30: 2e78 203d 202d 7365 6c66 2e78 0a20 2020  .x = -self.x.   
+00021e40: 2020 2020 2072 6573 2e79 203d 202d 7365       res.y = -se
+00021e50: 6c66 2e79 0a20 2020 2020 2020 2072 6573  lf.y.        res
+00021e60: 2e7a 203d 202d 7365 6c66 2e7a 0a20 2020  .z = -self.z.   
+00021e70: 2020 2020 2072 6574 7572 6e20 7265 730a       return res.
+00021e80: 0a20 2020 2064 6566 206e 6f72 6d61 6c69  .    def normali
+00021e90: 7a65 2873 656c 6629 3a0a 2020 2020 2020  ze(self):.      
+00021ea0: 2020 2222 2252 6574 7572 6e20 6e6f 726d    """Return norm
+00021eb0: 616c 697a 6564 2071 7561 7465 726e 696f  alized quaternio
+00021ec0: 6e2e 0a0a 2020 2020 2020 2020 3e3e 3e20  n...        >>> 
+00021ed0: 713d 7175 6174 2830 2e39 2c20 302e 352c  q=quat(0.9, 0.5,
+00021ee0: 2030 2e32 2c20 302e 3329 0a20 2020 2020   0.2, 0.3).     
+00021ef0: 2020 203e 3e3e 2071 3d71 2e6e 6f72 6d61     >>> q=q.norma
+00021f00: 6c69 7a65 2829 0a20 2020 2020 2020 203e  lize().        >
+00021f10: 3e3e 2070 7269 6e74 2071 0a20 2020 2020  >> print q.     
+00021f20: 2020 2028 302e 3832 3530 2c20 302e 3435     (0.8250, 0.45
+00021f30: 3833 2c20 302e 3138 3333 2c20 302e 3237  83, 0.1833, 0.27
+00021f40: 3530 290a 2020 2020 2020 2020 3e3e 3e20  50).        >>> 
+00021f50: 7072 696e 7420 6162 7328 7129 0a20 2020  print abs(q).   
+00021f60: 2020 2020 2031 2e30 0a20 2020 2020 2020       1.0.       
+00021f70: 2022 2222 0a20 2020 2020 2020 2063 6465   """.        cde
+00021f80: 6620 7175 6174 2072 6573 0a20 2020 2020  f quat res.     
+00021f90: 2020 2063 6465 6620 646f 7562 6c65 206e     cdef double n
+00021fa0: 6c65 6e0a 0a20 2020 2020 2020 206e 6c65  len..        nle
+00021fb0: 6e20 3d20 7371 7274 2873 656c 662e 772a  n = sqrt(self.w*
+00021fc0: 7365 6c66 2e77 2b73 656c 662e 782a 7365  self.w+self.x*se
+00021fd0: 6c66 2e78 2b73 656c 662e 792a 7365 6c66  lf.x+self.y*self
+00021fe0: 2e79 2b73 656c 662e 7a2a 7365 6c66 2e7a  .y+self.z*self.z
+00021ff0: 290a 2020 2020 2020 2020 6966 206e 6c65  ).        if nle
+00022000: 6e3c 3d65 7073 3a0a 2020 2020 2020 2020  n<=eps:.        
+00022010: 2020 2020 7261 6973 6520 5a65 726f 4469      raise ZeroDi
+00022020: 7669 7369 6f6e 4572 726f 722c 2271 7561  visionError,"qua
+00022030: 7420 6469 7669 7369 6f6e 220a 0a20 2020  t division"..   
+00022040: 2020 2020 206e 6c65 6e20 3d20 312e 302f       nlen = 1.0/
+00022050: 6e6c 656e 0a20 2020 2020 2020 2072 6573  nlen.        res
+00022060: 203d 2071 7561 7428 290a 2020 2020 2020   = quat().      
+00022070: 2020 7265 732e 7720 3d20 7365 6c66 2e77    res.w = self.w
+00022080: 2a6e 6c65 6e0a 2020 2020 2020 2020 7265  *nlen.        re
+00022090: 732e 7820 3d20 7365 6c66 2e78 2a6e 6c65  s.x = self.x*nle
+000220a0: 6e0a 2020 2020 2020 2020 7265 732e 7920  n.        res.y 
+000220b0: 3d20 7365 6c66 2e79 2a6e 6c65 6e0a 2020  = self.y*nlen.  
+000220c0: 2020 2020 2020 7265 732e 7a20 3d20 7365        res.z = se
+000220d0: 6c66 2e7a 2a6e 6c65 6e0a 2020 2020 2020  lf.z*nlen.      
+000220e0: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
+000220f0: 2020 6465 6620 696e 7665 7273 6528 7365    def inverse(se
+00022100: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00022110: 5265 7475 726e 2069 6e76 6572 7365 2e0a  Return inverse..
+00022120: 0a20 2020 2020 2020 203e 3e3e 2071 3d71  .        >>> q=q
+00022130: 7561 7428 302e 392c 2030 2e35 2c20 302e  uat(0.9, 0.5, 0.
+00022140: 322c 2030 2e33 290a 2020 2020 2020 2020  2, 0.3).        
+00022150: 3e3e 3e20 7072 696e 7420 712e 696e 7665  >>> print q.inve
+00022160: 7273 6528 290a 2020 2020 2020 2020 2830  rse().        (0
+00022170: 2e37 3536 332c 202d 302e 3432 3032 2c20  .7563, -0.4202, 
+00022180: 2d30 2e31 3638 312c 202d 302e 3235 3231  -0.1681, -0.2521
+00022190: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
+000221a0: 2020 2020 2020 6364 6566 2071 7561 7420        cdef quat 
+000221b0: 7265 730a 0a20 2020 2020 2020 206c 656e  res..        len
+000221c0: 5f32 203d 2073 656c 662e 772a 7365 6c66  _2 = self.w*self
+000221d0: 2e77 2b73 656c 662e 782a 7365 6c66 2e78  .w+self.x*self.x
+000221e0: 2b73 656c 662e 792a 7365 6c66 2e79 2b73  +self.y*self.y+s
+000221f0: 656c 662e 7a2a 7365 6c66 2e7a 0a20 2020  elf.z*self.z.   
+00022200: 2020 2020 2069 6620 6661 6273 286c 656e       if fabs(len
+00022210: 5f32 293c 3d65 7073 3a0a 2020 2020 2020  _2)<=eps:.      
+00022220: 2020 2020 2020 7261 6973 6520 5a65 726f        raise Zero
+00022230: 4469 7669 7369 6f6e 4572 726f 722c 2271  DivisionError,"q
+00022240: 7561 7420 6973 206e 6f74 2069 6e76 6572  uat is not inver
+00022250: 7469 626c 6522 0a0a 2020 2020 2020 2020  tible"..        
+00022260: 6c65 6e5f 3220 3d20 312e 302f 6c65 6e5f  len_2 = 1.0/len_
+00022270: 320a 2020 2020 2020 2020 7265 7320 3d20  2.        res = 
+00022280: 7175 6174 2829 0a20 2020 2020 2020 2072  quat().        r
+00022290: 6573 2e77 203d 2020 7365 6c66 2e77 2a6c  es.w =  self.w*l
+000222a0: 656e 5f32 0a20 2020 2020 2020 2072 6573  en_2.        res
+000222b0: 2e78 203d 202d 7365 6c66 2e78 2a6c 656e  .x = -self.x*len
+000222c0: 5f32 0a20 2020 2020 2020 2072 6573 2e79  _2.        res.y
+000222d0: 203d 202d 7365 6c66 2e79 2a6c 656e 5f32   = -self.y*len_2
+000222e0: 0a20 2020 2020 2020 2072 6573 2e7a 203d  .        res.z =
+000222f0: 202d 7365 6c66 2e7a 2a6c 656e 5f32 0a20   -self.z*len_2. 
+00022300: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00022310: 730a 0a20 2020 2064 6566 2074 6f41 6e67  s..    def toAng
+00022320: 6c65 4178 6973 2873 656c 6629 3a0a 2020  leAxis(self):.  
+00022330: 2020 2020 2020 2222 2252 6574 7572 6e20        """Return 
+00022340: 616e 676c 6520 2869 6e20 7261 6469 616e  angle (in radian
+00022350: 7329 2061 6e64 2072 6f74 6174 696f 6e20  s) and rotation 
+00022360: 6178 6973 2e0a 0a20 2020 2020 2020 203e  axis...        >
+00022370: 3e3e 2071 3d71 7561 7428 302e 392c 2030  >> q=quat(0.9, 0
+00022380: 2e35 2c20 302e 322c 2030 2e33 290a 2020  .5, 0.2, 0.3).  
+00022390: 2020 2020 2020 3e3e 3e20 616e 676c 652c        >>> angle,
+000223a0: 2061 7869 7320 3d20 712e 746f 416e 676c   axis = q.toAngl
+000223b0: 6541 7869 7328 290a 2020 2020 2020 2020  eAxis().        
+000223c0: 3e3e 3e20 7072 696e 7420 726f 756e 6428  >>> print round(
+000223d0: 616e 676c 652c 3429 0a20 2020 2020 2020  angle,4).       
+000223e0: 2031 2e32 3031 310a 2020 2020 2020 2020   1.2011.        
+000223f0: 3e3e 3e20 7072 696e 7420 6178 6973 0a20  >>> print axis. 
+00022400: 2020 2020 2020 2028 302e 3831 3131 2c20         (0.8111, 
+00022410: 302e 3332 3434 2c20 302e 3438 3637 290a  0.3244, 0.4867).
+00022420: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00022430: 2020 2020 6364 6566 2071 7561 7420 710a      cdef quat q.
+00022440: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
+00022450: 626c 6520 732c 770a 0a20 2020 2020 2020  ble s,w..       
+00022460: 2071 203d 2073 656c 662e 6e6f 726d 616c   q = self.normal
+00022470: 697a 6528 290a 0a20 2020 2020 2020 2023  ize()..        #
+00022480: 2043 6c61 6d70 206e 7365 6c66 2e77 2028   Clamp nself.w (
+00022490: 7369 6e63 6520 7468 6520 7175 6174 2068  since the quat h
+000224a0: 6173 2074 6f20 6265 206e 6f72 6d61 6c69  as to be normali
+000224b0: 7a65 6420 6974 2073 686f 756c 640a 2020  zed it should.  
+000224c0: 2020 2020 2020 2320 6265 2062 6574 7765        # be betwe
+000224d0: 656e 202d 3120 616e 6420 3120 616e 7977  en -1 and 1 anyw
+000224e0: 6179 2c20 6275 7420 6974 206d 6967 6874  ay, but it might
+000224f0: 2062 6520 736c 6967 6874 6c79 206f 6666   be slightly off
+00022500: 2064 7565 0a20 2020 2020 2020 2023 2074   due.        # t
+00022510: 6f20 6e75 6d65 7269 6361 6c20 696e 6163  o numerical inac
+00022520: 6375 7261 6369 6573 290a 2020 2020 2020  curacies).      
+00022530: 2020 6966 2071 2e77 3c2d 312e 303a 0a20    if q.w<-1.0:. 
+00022540: 2020 2020 2020 2020 2020 2077 203d 202d             w = -
+00022550: 312e 300a 2020 2020 2020 2020 656c 6966  1.0.        elif
+00022560: 2071 2e77 3e31 2e30 3a0a 2020 2020 2020   q.w>1.0:.      
+00022570: 2020 2020 2020 7720 3d20 312e 300a 2020        w = 1.0.  
+00022580: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00022590: 2020 2020 2020 2020 7720 3d20 712e 770a          w = q.w.
+000225a0: 0a20 2020 2020 2020 2077 203d 2061 636f  .        w = aco
+000225b0: 7328 7729 0a20 2020 2020 2020 2073 203d  s(w).        s =
+000225c0: 2073 696e 2877 290a 2020 2020 2020 2020   sin(w).        
+000225d0: 6966 2073 3c3d 6570 733a 0a20 2020 2020  if s<=eps:.     
+000225e0: 2020 2020 2020 2072 6574 7572 6e20 2830         return (0
+000225f0: 2e30 2c20 7665 6333 2830 2e30 2c30 2e30  .0, vec3(0.0,0.0
+00022600: 2c30 2e30 2929 0a0a 2020 2020 2020 2020  ,0.0))..        
+00022610: 7265 7475 726e 2028 322e 302a 772c 2076  return (2.0*w, v
+00022620: 6563 3328 712e 782f 732c 2071 2e79 2f73  ec3(q.x/s, q.y/s
+00022630: 2c20 712e 7a2f 7329 290a 0a20 2020 2064  , q.z/s))..    d
+00022640: 6566 2066 726f 6d41 6e67 6c65 4178 6973  ef fromAngleAxis
+00022650: 2873 656c 662c 2061 6e67 6c65 2c20 6178  (self, angle, ax
+00022660: 6973 293a 0a20 2020 2020 2020 2022 2222  is):.        """
+00022670: 496e 6974 6961 6c69 7a65 2073 656c 6620  Initialize self 
+00022680: 6672 6f6d 2061 6e20 616e 676c 6520 2869  from an angle (i
+00022690: 6e20 7261 6469 616e 7329 2061 6e64 2061  n radians) and a
+000226a0: 6e20 6178 6973 2061 6e64 2072 6574 7572  n axis and retur
+000226b0: 6e73 2073 656c 662e 2222 220a 2020 2020  ns self.""".    
+000226c0: 2020 2020 6364 6566 2064 6f75 626c 6520      cdef double 
+000226d0: 612c 6e2c 2078 2c79 2c7a 0a20 2020 2020  a,n, x,y,z.     
+000226e0: 2020 2063 6465 6620 7175 6174 2071 0a0a     cdef quat q..
+000226f0: 2020 2020 2020 2020 6120 3d20 616e 676c          a = angl
+00022700: 652f 322e 300a 2020 2020 2020 2020 7365  e/2.0.        se
+00022710: 6c66 2e77 203d 2063 6f73 2861 290a 0a20  lf.w = cos(a).. 
+00022720: 2020 2020 2020 2078 203d 2061 7869 735b         x = axis[
+00022730: 305d 0a20 2020 2020 2020 2079 203d 2061  0].        y = a
+00022740: 7869 735b 315d 0a20 2020 2020 2020 207a  xis[1].        z
+00022750: 203d 2061 7869 735b 325d 0a20 2020 2020   = axis[2].     
+00022760: 2020 206e 203d 2078 2a78 2b79 2a79 2b7a     n = x*x+y*y+z
+00022770: 2a7a 0a20 2020 2020 2020 2069 6620 6e3c  *z.        if n<
+00022780: 3d65 7073 3a0a 2020 2020 2020 2020 2020  =eps:.          
+00022790: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000227a0: 6f72 2c22 6178 6973 206d 7573 746e 2774  or,"axis mustn't
+000227b0: 2062 6520 7468 6520 6e75 6c6c 2076 6563   be the null vec
+000227c0: 746f 7222 0a0a 2020 2020 2020 2020 7320  tor"..        s 
+000227d0: 3d20 7369 6e28 6129 2f6e 0a20 2020 2020  = sin(a)/n.     
+000227e0: 2020 2073 656c 662e 7820 3d20 782a 730a     self.x = x*s.
+000227f0: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
+00022800: 2079 2a73 0a20 2020 2020 2020 2073 656c   y*s.        sel
+00022810: 662e 7a20 3d20 7a2a 730a 0a20 2020 2020  f.z = z*s..     
+00022820: 2020 2023 204e 6f72 6d61 6c69 7a65 2074     # Normalize t
+00022830: 6865 2071 7561 740a 2020 2020 2020 2020  he quat.        
+00022840: 7120 3d20 7365 6c66 2e6e 6f72 6d61 6c69  q = self.normali
+00022850: 7a65 2829 0a20 2020 2020 2020 2073 656c  ze().        sel
+00022860: 662e 7720 3d20 712e 770a 2020 2020 2020  f.w = q.w.      
+00022870: 2020 7365 6c66 2e78 203d 2071 2e78 0a20    self.x = q.x. 
+00022880: 2020 2020 2020 2073 656c 662e 7920 3d20         self.y = 
+00022890: 712e 790a 2020 2020 2020 2020 7365 6c66  q.y.        self
+000228a0: 2e7a 203d 2071 2e7a 0a20 2020 2020 2020  .z = q.z.       
+000228b0: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
+000228c0: 2020 6465 6620 746f 4d61 7433 2873 656c    def toMat3(sel
+000228d0: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+000228e0: 6574 7572 6e20 726f 7461 7469 6f6e 206d  eturn rotation m
+000228f0: 6174 7269 7820 6173 206d 6174 332e 2222  atrix as mat3.""
+00022900: 220a 2020 2020 2020 2020 6364 6566 206d  ".        cdef m
+00022910: 6174 3320 7265 730a 2020 2020 2020 2020  at3 res.        
+00022920: 6364 6566 2078 782c 7979 2c7a 7a2c 7879  cdef xx,yy,zz,xy
+00022930: 2c7a 772c 787a 2c79 772c 797a 2c78 770a  ,zw,xz,yw,yz,xw.
+00022940: 0a20 2020 2020 2020 2078 7820 3d20 322e  .        xx = 2.
+00022950: 302a 7365 6c66 2e78 2a73 656c 662e 780a  0*self.x*self.x.
+00022960: 2020 2020 2020 2020 7979 203d 2032 2e30          yy = 2.0
+00022970: 2a73 656c 662e 792a 7365 6c66 2e79 0a20  *self.y*self.y. 
+00022980: 2020 2020 2020 207a 7a20 3d20 322e 302a         zz = 2.0*
+00022990: 7365 6c66 2e7a 2a73 656c 662e 7a0a 2020  self.z*self.z.  
+000229a0: 2020 2020 2020 7879 203d 2032 2e30 2a73        xy = 2.0*s
+000229b0: 656c 662e 782a 7365 6c66 2e79 0a20 2020  elf.x*self.y.   
+000229c0: 2020 2020 207a 7720 3d20 322e 302a 7365       zw = 2.0*se
+000229d0: 6c66 2e7a 2a73 656c 662e 770a 2020 2020  lf.z*self.w.    
+000229e0: 2020 2020 787a 203d 2032 2e30 2a73 656c      xz = 2.0*sel
+000229f0: 662e 782a 7365 6c66 2e7a 0a20 2020 2020  f.x*self.z.     
+00022a00: 2020 2079 7720 3d20 322e 302a 7365 6c66     yw = 2.0*self
+00022a10: 2e79 2a73 656c 662e 770a 2020 2020 2020  .y*self.w.      
+00022a20: 2020 797a 203d 2032 2e30 2a73 656c 662e    yz = 2.0*self.
+00022a30: 792a 7365 6c66 2e7a 0a20 2020 2020 2020  y*self.z.       
+00022a40: 2078 7720 3d20 322e 302a 7365 6c66 2e78   xw = 2.0*self.x
+00022a50: 2a73 656c 662e 770a 0a20 2020 2020 2020  *self.w..       
+00022a60: 2072 6573 203d 206d 6174 3328 290a 2020   res = mat3().  
+00022a70: 2020 2020 2020 7265 732e 6d31 3120 3d20        res.m11 = 
+00022a80: 312e 302d 7979 2d7a 7a0a 2020 2020 2020  1.0-yy-zz.      
+00022a90: 2020 7265 732e 6d31 3220 3d20 7879 2d7a    res.m12 = xy-z
+00022aa0: 770a 2020 2020 2020 2020 7265 732e 6d31  w.        res.m1
+00022ab0: 3320 3d20 787a 2b79 770a 2020 2020 2020  3 = xz+yw.      
+00022ac0: 2020 7265 732e 6d32 3120 3d20 7879 2b7a    res.m21 = xy+z
+00022ad0: 770a 2020 2020 2020 2020 7265 732e 6d32  w.        res.m2
+00022ae0: 3220 3d20 312e 302d 7878 2d7a 7a0a 2020  2 = 1.0-xx-zz.  
+00022af0: 2020 2020 2020 7265 732e 6d32 3320 3d20        res.m23 = 
+00022b00: 797a 2d78 770a 2020 2020 2020 2020 7265  yz-xw.        re
+00022b10: 732e 6d33 3120 3d20 787a 2d79 770a 2020  s.m31 = xz-yw.  
+00022b20: 2020 2020 2020 7265 732e 6d33 3220 3d20        res.m32 = 
+00022b30: 797a 2b78 770a 2020 2020 2020 2020 7265  yz+xw.        re
+00022b40: 732e 6d33 3320 3d20 312e 302d 7878 2d79  s.m33 = 1.0-xx-y
+00022b50: 790a 2020 2020 2020 2020 7265 7475 726e  y.        return
+00022b60: 2072 6573 0a0a 2020 2020 6465 6620 746f   res..    def to
+00022b70: 4d61 7434 2873 656c 6629 3a0a 2020 2020  Mat4(self):.    
+00022b80: 2020 2020 2222 2252 6574 7572 6e20 726f      """Return ro
+00022b90: 7461 7469 6f6e 206d 6174 7269 7820 6173  tation matrix as
+00022ba0: 206d 6174 342e 2222 220a 2020 2020 2020   mat4.""".      
+00022bb0: 2020 6364 6566 206d 6174 3420 7265 730a    cdef mat4 res.
+00022bc0: 2020 2020 2020 2020 6364 6566 2078 782c          cdef xx,
+00022bd0: 7979 2c7a 7a2c 7879 2c7a 772c 787a 2c79  yy,zz,xy,zw,xz,y
+00022be0: 772c 797a 2c78 770a 0a20 2020 2020 2020  w,yz,xw..       
+00022bf0: 2078 7820 3d20 322e 302a 7365 6c66 2e78   xx = 2.0*self.x
+00022c00: 2a73 656c 662e 780a 2020 2020 2020 2020  *self.x.        
+00022c10: 7979 203d 2032 2e30 2a73 656c 662e 792a  yy = 2.0*self.y*
+00022c20: 7365 6c66 2e79 0a20 2020 2020 2020 207a  self.y.        z
+00022c30: 7a20 3d20 322e 302a 7365 6c66 2e7a 2a73  z = 2.0*self.z*s
+00022c40: 656c 662e 7a0a 2020 2020 2020 2020 7879  elf.z.        xy
+00022c50: 203d 2032 2e30 2a73 656c 662e 782a 7365   = 2.0*self.x*se
+00022c60: 6c66 2e79 0a20 2020 2020 2020 207a 7720  lf.y.        zw 
+00022c70: 3d20 322e 302a 7365 6c66 2e7a 2a73 656c  = 2.0*self.z*sel
+00022c80: 662e 770a 2020 2020 2020 2020 787a 203d  f.w.        xz =
+00022c90: 2032 2e30 2a73 656c 662e 782a 7365 6c66   2.0*self.x*self
+00022ca0: 2e7a 0a20 2020 2020 2020 2079 7720 3d20  .z.        yw = 
+00022cb0: 322e 302a 7365 6c66 2e79 2a73 656c 662e  2.0*self.y*self.
+00022cc0: 770a 2020 2020 2020 2020 797a 203d 2032  w.        yz = 2
+00022cd0: 2e30 2a73 656c 662e 792a 7365 6c66 2e7a  .0*self.y*self.z
+00022ce0: 0a20 2020 2020 2020 2078 7720 3d20 322e  .        xw = 2.
+00022cf0: 302a 7365 6c66 2e78 2a73 656c 662e 770a  0*self.x*self.w.
+00022d00: 0a20 2020 2020 2020 2072 6573 203d 206d  .        res = m
+00022d10: 6174 3428 290a 0a20 2020 2020 2020 2072  at4()..        r
+00022d20: 6573 2e6d 3131 203d 2031 2e30 2d79 792d  es.m11 = 1.0-yy-
+00022d30: 7a7a 0a20 2020 2020 2020 2072 6573 2e6d  zz.        res.m
+00022d40: 3132 203d 2078 792d 7a77 0a20 2020 2020  12 = xy-zw.     
+00022d50: 2020 2072 6573 2e6d 3133 203d 2078 7a2b     res.m13 = xz+
+00022d60: 7977 0a20 2020 2020 2020 2072 6573 2e6d  yw.        res.m
+00022d70: 3134 203d 2030 2e30 0a20 2020 2020 2020  14 = 0.0.       
+00022d80: 2072 6573 2e6d 3231 203d 2078 792b 7a77   res.m21 = xy+zw
+00022d90: 0a20 2020 2020 2020 2072 6573 2e6d 3232  .        res.m22
+00022da0: 203d 2031 2e30 2d78 782d 7a7a 0a20 2020   = 1.0-xx-zz.   
+00022db0: 2020 2020 2072 6573 2e6d 3233 203d 2079       res.m23 = y
+00022dc0: 7a2d 7877 0a20 2020 2020 2020 2072 6573  z-xw.        res
+00022dd0: 2e6d 3234 203d 2030 2e30 0a20 2020 2020  .m24 = 0.0.     
+00022de0: 2020 2072 6573 2e6d 3331 203d 2078 7a2d     res.m31 = xz-
+00022df0: 7977 0a20 2020 2020 2020 2072 6573 2e6d  yw.        res.m
+00022e00: 3332 203d 2079 7a2b 7877 0a20 2020 2020  32 = yz+xw.     
+00022e10: 2020 2072 6573 2e6d 3333 203d 2031 2e30     res.m33 = 1.0
+00022e20: 2d78 782d 7979 0a20 2020 2020 2020 2072  -xx-yy.        r
+00022e30: 6573 2e6d 3334 203d 2030 2e30 0a20 2020  es.m34 = 0.0.   
+00022e40: 2020 2020 2072 6573 2e6d 3431 203d 2030       res.m41 = 0
+00022e50: 2e30 0a20 2020 2020 2020 2072 6573 2e6d  .0.        res.m
+00022e60: 3432 203d 2030 2e30 0a20 2020 2020 2020  42 = 0.0.       
+00022e70: 2072 6573 2e6d 3433 203d 2030 2e30 0a20   res.m43 = 0.0. 
+00022e80: 2020 2020 2020 2072 6573 2e6d 3434 203d         res.m44 =
+00022e90: 2031 2e30 0a20 2020 2020 2020 2072 6574   1.0.        ret
+00022ea0: 7572 6e20 7265 730a 0a20 2020 2064 6566  urn res..    def
+00022eb0: 2066 726f 6d4d 6174 2873 656c 662c 206d   fromMat(self, m
+00022ec0: 293a 0a20 2020 2020 2020 2022 2222 496e  ):.        """In
+00022ed0: 6974 6961 6c69 7a65 2073 656c 6620 6672  itialize self fr
+00022ee0: 6f6d 2065 6974 6865 7220 6120 6d61 7433  om either a mat3
+00022ef0: 206f 7220 6d61 7434 2061 6e64 2072 6574   or mat4 and ret
+00022f00: 7572 6e73 2073 656c 662e 2222 220a 2020  urns self.""".  
+00022f10: 2020 2020 2020 6364 6566 2064 6f75 626c        cdef doubl
+00022f20: 6520 6431 2c64 322c 6433 2c61 6431 2c61  e d1,d2,d3,ad1,a
+00022f30: 6432 2c61 6433 2c74 2c73 0a0a 2020 2020  d2,ad3,t,s..    
+00022f40: 2020 2020 6431 203d 206d 5b30 2c30 5d0a      d1 = m[0,0].
+00022f50: 2020 2020 2020 2020 6432 203d 206d 5b31          d2 = m[1
+00022f60: 2c31 5d0a 2020 2020 2020 2020 6433 203d  ,1].        d3 =
+00022f70: 206d 5b32 2c32 5d0a 2020 2020 2020 2020   m[2,2].        
+00022f80: 7420 3d20 6431 2b64 322b 6433 2b31 2e30  t = d1+d2+d3+1.0
+00022f90: 0a20 2020 2020 2020 2069 6620 743e 302e  .        if t>0.
+00022fa0: 303a 0a20 2020 2020 2020 2020 2020 2073  0:.            s
+00022fb0: 203d 2030 2e35 2f73 7172 7428 7429 0a20   = 0.5/sqrt(t). 
+00022fc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00022fd0: 7720 3d20 302e 3235 2f73 0a20 2020 2020  w = 0.25/s.     
+00022fe0: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
+00022ff0: 286d 5b32 2c31 5d2d 6d5b 312c 325d 292a  (m[2,1]-m[1,2])*
+00023000: 730a 2020 2020 2020 2020 2020 2020 7365  s.            se
+00023010: 6c66 2e79 203d 2028 6d5b 302c 325d 2d6d  lf.y = (m[0,2]-m
+00023020: 5b32 2c30 5d29 2a73 0a20 2020 2020 2020  [2,0])*s.       
+00023030: 2020 2020 2073 656c 662e 7a20 3d20 286d       self.z = (m
+00023040: 5b31 2c30 5d2d 6d5b 302c 315d 292a 730a  [1,0]-m[0,1])*s.
+00023050: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00023060: 2020 2020 2020 2020 2020 6164 3120 3d20            ad1 = 
+00023070: 6661 6273 2864 3129 0a20 2020 2020 2020  fabs(d1).       
+00023080: 2020 2020 2061 6432 203d 2066 6162 7328       ad2 = fabs(
+00023090: 6432 290a 2020 2020 2020 2020 2020 2020  d2).            
+000230a0: 6164 3320 3d20 6661 6273 2864 3329 0a20  ad3 = fabs(d3). 
+000230b0: 2020 2020 2020 2020 2020 2069 6620 6164             if ad
+000230c0: 313e 3d61 6432 2061 6e64 2061 6431 3e3d  1>=ad2 and ad1>=
+000230d0: 6164 333a 0a20 2020 2020 2020 2020 2020  ad3:.           
+000230e0: 2020 2020 2073 203d 2073 7172 7428 312e       s = sqrt(1.
+000230f0: 302b 6431 2d64 322d 6433 292a 322e 300a  0+d1-d2-d3)*2.0.
+00023100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023110: 7365 6c66 2e78 203d 2030 2e35 2f73 0a20  self.x = 0.5/s. 
+00023120: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00023130: 656c 662e 7920 3d20 286d 5b30 2c31 5d2b  elf.y = (m[0,1]+
+00023140: 6d5b 312c 305d 292f 730a 2020 2020 2020  m[1,0])/s.      
+00023150: 2020 2020 2020 2020 2020 7365 6c66 2e7a            self.z
+00023160: 203d 2028 6d5b 302c 325d 2b6d 5b32 2c30   = (m[0,2]+m[2,0
+00023170: 5d29 2f73 0a20 2020 2020 2020 2020 2020  ])/s.           
+00023180: 2020 2020 2073 656c 662e 7720 3d20 286d       self.w = (m
+00023190: 5b31 2c32 5d2b 6d5b 322c 315d 292f 730a  [1,2]+m[2,1])/s.
+000231a0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000231b0: 2061 6432 3e3d 6164 3120 616e 6420 6164   ad2>=ad1 and ad
+000231c0: 323e 3d61 6433 3a0a 2020 2020 2020 2020  2>=ad3:.        
+000231d0: 2020 2020 2020 2020 7320 3d20 7371 7274          s = sqrt
+000231e0: 2831 2e30 2b64 322d 6431 2d64 3329 2a32  (1.0+d2-d1-d3)*2
+000231f0: 2e30 0a20 2020 2020 2020 2020 2020 2020  .0.             
+00023200: 2020 2073 656c 662e 7820 3d20 286d 5b30     self.x = (m[0
+00023210: 2c31 5d2b 6d5b 312c 305d 292f 730a 2020  ,1]+m[1,0])/s.  
+00023220: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00023230: 6c66 2e79 203d 2030 2e35 2f73 0a20 2020  lf.y = 0.5/s.   
+00023240: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00023250: 662e 7a20 3d20 286d 5b31 2c32 5d2b 6d5b  f.z = (m[1,2]+m[
+00023260: 322c 315d 292f 730a 2020 2020 2020 2020  2,1])/s.        
+00023270: 2020 2020 2020 2020 7365 6c66 2e77 203d          self.w =
+00023280: 2028 6d5b 302c 325d 2b6d 5b32 2c30 5d29   (m[0,2]+m[2,0])
+00023290: 2f73 0a20 2020 2020 2020 2020 2020 2065  /s.            e
+000232a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000232b0: 2020 2020 2073 203d 2073 7172 7428 312e       s = sqrt(1.
+000232c0: 302b 6433 2d64 312d 6432 292a 322e 300a  0+d3-d1-d2)*2.0.
+000232d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000232e0: 7365 6c66 2e78 203d 2028 6d5b 302c 325d  self.x = (m[0,2]
+000232f0: 2b6d 5b32 2c30 5d29 2f73 0a20 2020 2020  +m[2,0])/s.     
+00023300: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00023310: 7920 3d20 286d 5b31 2c32 5d2b 6d5b 322c  y = (m[1,2]+m[2,
+00023320: 315d 292f 730a 2020 2020 2020 2020 2020  1])/s.          
+00023330: 2020 2020 2020 7365 6c66 2e7a 203d 2030        self.z = 0
+00023340: 2e35 2f73 0a20 2020 2020 2020 2020 2020  .5/s.           
+00023350: 2020 2020 2073 656c 662e 7720 3d20 286d       self.w = (m
+00023360: 5b30 2c31 5d2b 6d5b 312c 305d 292f 730a  [0,1]+m[1,0])/s.
+00023370: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00023380: 7365 6c66 0a0a 2020 2020 6465 6620 646f  self..    def do
+00023390: 7428 7365 6c66 2c20 7175 6174 2062 293a  t(self, quat b):
+000233a0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+000233b0: 726e 2074 6865 2064 6f74 2070 726f 6475  rn the dot produ
+000233c0: 6374 206f 6620 7365 6c66 2061 6e64 2062  ct of self and b
+000233d0: 2e22 2222 0a20 2020 2020 2020 2072 6574  .""".        ret
+000233e0: 7572 6e20 7365 6c66 2e77 2a62 2e77 202b  urn self.w*b.w +
+000233f0: 2073 656c 662e 782a 622e 7820 2b20 7365   self.x*b.x + se
+00023400: 6c66 2e79 2a62 2e79 202b 2073 656c 662e  lf.y*b.y + self.
+00023410: 7a2a 622e 7a0a 0a20 2020 2064 6566 206c  z*b.z..    def l
+00023420: 6f67 2873 656c 6629 3a0a 2020 2020 2020  og(self):.      
+00023430: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
+00023440: 6e61 7475 7261 6c20 6c6f 6761 7269 7468  natural logarith
+00023450: 6d20 6f66 2073 656c 662e 2222 220a 0a20  m of self.""".. 
+00023460: 2020 2020 2020 2063 6465 6620 646f 7562         cdef doub
+00023470: 6c65 2062 2c20 742c 2066 2c20 6374 2c20  le b, t, f, ct, 
+00023480: 720a 2020 2020 2020 2020 6364 6566 2071  r.        cdef q
+00023490: 7561 7420 7265 730a 0a20 2020 2020 2020  uat res..       
+000234a0: 2062 203d 2073 7172 7428 7365 6c66 2e78   b = sqrt(self.x
+000234b0: 2a73 656c 662e 7820 2b20 7365 6c66 2e79  *self.x + self.y
+000234c0: 2a73 656c 662e 7920 2b20 7365 6c66 2e7a  *self.y + self.z
+000234d0: 2a73 656c 662e 7a29 0a20 2020 2020 2020  *self.z).       
+000234e0: 2072 6573 203d 2071 7561 7428 290a 2020   res = quat().  
+000234f0: 2020 2020 2020 6966 2066 6162 7328 6229        if fabs(b)
+00023500: 3c3d 6570 733a 0a20 2020 2020 2020 2020  <=eps:.         
+00023510: 2020 2072 6573 2e78 203d 2030 2e30 0a20     res.x = 0.0. 
+00023520: 2020 2020 2020 2020 2020 2072 6573 2e79             res.y
+00023530: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
+00023540: 2020 2072 6573 2e7a 203d 2030 2e30 0a20     res.z = 0.0. 
+00023550: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00023560: 6c66 2e77 3c3d 6570 733a 0a20 2020 2020  lf.w<=eps:.     
+00023570: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00023580: 2056 616c 7565 4572 726f 722c 2022 6d61   ValueError, "ma
+00023590: 7468 2064 6f6d 6169 6e20 6572 726f 7222  th domain error"
+000235a0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+000235b0: 2e77 203d 206c 6f67 2873 656c 662e 7729  .w = log(self.w)
+000235c0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000235d0: 2020 2020 2020 2020 2020 2074 203d 2061             t = a
+000235e0: 7461 6e32 2862 2c20 7365 6c66 2e77 290a  tan2(b, self.w).
+000235f0: 2020 2020 2020 2020 2020 2020 6620 3d20              f = 
+00023600: 742f 620a 2020 2020 2020 2020 2020 2020  t/b.            
+00023610: 7265 732e 7820 3d20 662a 7365 6c66 2e78  res.x = f*self.x
+00023620: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00023630: 2e79 203d 2066 2a73 656c 662e 790a 2020  .y = f*self.y.  
+00023640: 2020 2020 2020 2020 2020 7265 732e 7a20            res.z 
+00023650: 3d20 662a 7365 6c66 2e7a 0a20 2020 2020  = f*self.z.     
+00023660: 2020 2020 2020 2063 7420 3d20 636f 7328         ct = cos(
+00023670: 7429 0a20 2020 2020 2020 2020 2020 2069  t).            i
+00023680: 6620 6661 6273 2863 7429 3c3d 6570 733a  f fabs(ct)<=eps:
+00023690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000236a0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+000236b0: 722c 2022 6d61 7468 2064 6f6d 6169 6e20  r, "math domain 
+000236c0: 6572 726f 7222 0a20 2020 2020 2020 2020  error".         
+000236d0: 2020 2072 203d 2073 656c 662e 772f 6374     r = self.w/ct
+000236e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000236f0: 723c 3d65 7073 3a0a 2020 2020 2020 2020  r<=eps:.        
+00023700: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00023710: 6c75 6545 7272 6f72 2c20 226d 6174 6820  lueError, "math 
+00023720: 646f 6d61 696e 2065 7272 6f72 220a 2020  domain error".  
+00023730: 2020 2020 2020 2020 2020 7265 732e 7720            res.w 
+00023740: 3d20 6c6f 6728 7229 0a0a 2020 2020 2020  = log(r)..      
+00023750: 2020 7265 7475 726e 2072 6573 0a0a 2020    return res..  
+00023760: 2020 6465 6620 6578 7028 7365 6c66 293a    def exp(self):
+00023770: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00023780: 726e 2074 6865 2065 7870 6f6e 656e 7469  rn the exponenti
+00023790: 616c 206f 6620 7365 6c66 2e22 2222 0a0a  al of self."""..
+000237a0: 2020 2020 2020 2020 6364 6566 2064 6f75          cdef dou
+000237b0: 626c 6520 622c 2066 0a20 2020 2020 2020  ble b, f.       
+000237c0: 2063 6465 6620 7175 6174 2072 6573 0a0a   cdef quat res..
+000237d0: 2020 2020 2020 2020 6220 3d20 7371 7274          b = sqrt
+000237e0: 2873 656c 662e 782a 7365 6c66 2e78 202b  (self.x*self.x +
+000237f0: 2073 656c 662e 792a 7365 6c66 2e79 202b   self.y*self.y +
+00023800: 2073 656c 662e 7a2a 7365 6c66 2e7a 290a   self.z*self.z).
+00023810: 2020 2020 2020 2020 7265 7320 3d20 7175          res = qu
+00023820: 6174 2829 0a20 2020 2020 2020 2069 6620  at().        if 
+00023830: 6661 6273 2862 293c 3d65 7073 3a0a 2020  fabs(b)<=eps:.  
+00023840: 2020 2020 2020 2020 2020 7265 732e 7820            res.x 
+00023850: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
+00023860: 2020 7265 732e 7920 3d20 302e 300a 2020    res.y = 0.0.  
+00023870: 2020 2020 2020 2020 2020 7265 732e 7a20            res.z 
+00023880: 3d20 302e 300a 2020 2020 2020 2020 2020  = 0.0.          
+00023890: 2020 7265 732e 7720 3d20 6578 7028 7365    res.w = exp(se
+000238a0: 6c66 2e77 290a 2020 2020 2020 2020 656c  lf.w).        el
+000238b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000238c0: 6620 3d20 7369 6e28 6229 2f62 0a20 2020  f = sin(b)/b.   
+000238d0: 2020 2020 2020 2020 2072 6573 2e78 203d           res.x =
+000238e0: 2066 2a73 656c 662e 780a 2020 2020 2020   f*self.x.      
+000238f0: 2020 2020 2020 7265 732e 7920 3d20 662a        res.y = f*
+00023900: 7365 6c66 2e79 0a20 2020 2020 2020 2020  self.y.         
+00023910: 2020 2072 6573 2e7a 203d 2066 2a73 656c     res.z = f*sel
+00023920: 662e 7a0a 2020 2020 2020 2020 2020 2020  f.z.            
+00023930: 7265 732e 7720 3d20 6578 7028 7365 6c66  res.w = exp(self
+00023940: 2e77 292a 636f 7328 6229 0a0a 2020 2020  .w)*cos(b)..    
+00023950: 2020 2020 7265 7475 726e 2072 6573 0a0a      return res..
+00023960: 0a64 6566 2073 6c65 7270 2864 6f75 626c  .def slerp(doubl
+00023970: 6520 742c 2071 7561 7420 7130 2c20 7175  e t, quat q0, qu
+00023980: 6174 2071 3129 3a0a 2020 2020 2222 2253  at q1):.    """S
+00023990: 7068 6572 6963 616c 206c 696e 6561 7220  pherical linear 
+000239a0: 696e 7465 7270 6f6c 6174 696f 6e20 6265  interpolation be
+000239b0: 7477 6565 6e20 7477 6f20 7175 6174 6572  tween two quater
+000239c0: 6e69 6f6e 732e 0a0a 2020 2020 5468 6520  nions...    The 
+000239d0: 7265 7475 726e 2076 616c 7565 2069 7320  return value is 
+000239e0: 616e 2069 6e74 6572 706f 6c61 7469 6f6e  an interpolation
+000239f0: 2062 6574 7765 656e 2071 3020 616e 6420   between q0 and 
+00023a00: 7131 2e20 466f 7220 743d 302e 300a 2020  q1. For t=0.0.  
+00023a10: 2020 7468 6520 7265 7475 726e 2076 616c    the return val
+00023a20: 7565 2065 7175 616c 7320 7130 2c20 666f  ue equals q0, fo
+00023a30: 7220 743d 312e 3020 6974 2065 7175 616c  r t=1.0 it equal
+00023a40: 7320 7131 2e0a 2020 2020 7130 2061 6e64  s q1..    q0 and
+00023a50: 2071 3120 6d75 7374 2062 6520 756e 6974   q1 must be unit
+00023a60: 2071 7561 7465 726e 696f 6e73 2e0a 2020   quaternions..  
+00023a70: 2020 2222 220a 2020 2020 6364 6566 2064    """.    cdef d
+00023a80: 6f75 626c 6520 6f2c 736f 2c61 2c62 0a0a  ouble o,so,a,b..
+00023a90: 2020 2020 6f20 3d20 6163 6f73 2871 302e      o = acos(q0.
+00023aa0: 646f 7428 7131 2929 0a20 2020 2073 6f20  dot(q1)).    so 
+00023ab0: 3d20 7369 6e28 6f29 0a0a 2020 2020 6966  = sin(o)..    if
+00023ac0: 2028 6661 6273 2873 6f29 3c65 7073 293a   (fabs(so)<eps):
+00023ad0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00023ae0: 7175 6174 2871 3029 0a0a 2020 2020 6120  quat(q0)..    a 
+00023af0: 3d20 7369 6e28 6f2a 2831 2e30 2d74 2929  = sin(o*(1.0-t))
+00023b00: 202f 2073 6f0a 2020 2020 6220 3d20 7369   / so.    b = si
+00023b10: 6e28 6f2a 7429 202f 2073 6f0a 2020 2020  n(o*t) / so.    
+00023b20: 7265 7475 726e 2071 302a 6120 2b20 7131  return q0*a + q1
+00023b30: 2a62 0a0a 6465 6620 7371 7561 6428 646f  *b..def squad(do
+00023b40: 7562 6c65 2074 2c20 7175 6174 2061 2c20  uble t, quat a, 
+00023b50: 7175 6174 2062 2c20 7175 6174 2063 2c20  quat b, quat c, 
+00023b60: 7175 6174 2064 293a 0a20 2020 2022 2222  quat d):.    """
+00023b70: 5370 6865 7269 6361 6c20 6375 6269 6320  Spherical cubic 
+00023b80: 696e 7465 7270 6f6c 6174 696f 6e2e 2222  interpolation.""
+00023b90: 220a 2020 2020 7265 7475 726e 2073 6c65  ".    return sle
+00023ba0: 7270 2832 2a74 2a28 312e 302d 7429 2c20  rp(2*t*(1.0-t), 
+00023bb0: 736c 6572 7028 742c 612c 6429 2c20 736c  slerp(t,a,d), sl
+00023bc0: 6572 7028 742c 622c 6329 290a 0a23 2323  erp(t,b,c))..###
+00023bd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023be0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023c00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00023c10: 2323 230a 0a69 6d70 6f72 7420 7379 730a  ###..import sys.
+00023c20: 6966 2073 7973 2e76 6572 7369 6f6e 5f69  if sys.version_i
+00023c30: 6e66 6f5b 305d 203e 3d20 333a 0a20 2020  nfo[0] >= 3:.   
+00023c40: 2069 6d70 6f72 7420 636f 7079 7265 6720   import copyreg 
+00023c50: 6173 2063 6f70 795f 7265 670a 656c 7365  as copy_reg.else
+00023c60: 3a0a 2020 2020 696d 706f 7274 2063 6f70  :.    import cop
+00023c70: 795f 7265 670a 0a64 6566 205f 7665 6333  y_reg..def _vec3
+00023c80: 636f 6e73 7472 7563 7428 782c 792c 7a29  construct(x,y,z)
+00023c90: 3a0a 2020 2020 7265 7475 726e 2076 6563  :.    return vec
+00023ca0: 3328 782c 792c 7a29 0a0a 6465 6620 5f76  3(x,y,z)..def _v
+00023cb0: 6563 3463 6f6e 7374 7275 6374 2878 2c79  ec4construct(x,y
+00023cc0: 2c7a 2c77 293a 0a20 2020 2072 6574 7572  ,z,w):.    retur
+00023cd0: 6e20 7665 6334 2878 2c79 2c7a 2c77 290a  n vec4(x,y,z,w).
+00023ce0: 0a64 6566 205f 6d61 7433 636f 6e73 7472  .def _mat3constr
+00023cf0: 7563 7428 6231 2c62 322c 6233 293a 0a20  uct(b1,b2,b3):. 
+00023d00: 2020 2072 6574 7572 6e20 6d61 7433 2862     return mat3(b
+00023d10: 312c 6232 2c62 3329 0a0a 6465 6620 5f6d  1,b2,b3)..def _m
+00023d20: 6174 3463 6f6e 7374 7275 6374 2862 312c  at4construct(b1,
+00023d30: 6232 2c62 332c 6234 293a 0a20 2020 2072  b2,b3,b4):.    r
+00023d40: 6574 7572 6e20 6d61 7434 2862 312c 6232  eturn mat4(b1,b2
+00023d50: 2c62 332c 6234 290a 0a64 6566 205f 7175  ,b3,b4)..def _qu
+00023d60: 6174 636f 6e73 7472 7563 7428 772c 782c  atconstruct(w,x,
+00023d70: 792c 7a29 3a0a 2020 2020 7265 7475 726e  y,z):.    return
+00023d80: 2071 7561 7428 772c 782c 792c 7a29 0a0a   quat(w,x,y,z)..
+00023d90: 636f 7079 5f72 6567 2e63 6f6e 7374 7275  copy_reg.constru
+00023da0: 6374 6f72 285f 7665 6333 636f 6e73 7472  ctor(_vec3constr
+00023db0: 7563 7429 0a63 6f70 795f 7265 672e 636f  uct).copy_reg.co
+00023dc0: 6e73 7472 7563 746f 7228 5f76 6563 3463  nstructor(_vec4c
+00023dd0: 6f6e 7374 7275 6374 290a 636f 7079 5f72  onstruct).copy_r
+00023de0: 6567 2e63 6f6e 7374 7275 6374 6f72 285f  eg.constructor(_
+00023df0: 6d61 7433 636f 6e73 7472 7563 7429 0a63  mat3construct).c
+00023e00: 6f70 795f 7265 672e 636f 6e73 7472 7563  opy_reg.construc
+00023e10: 746f 7228 5f6d 6174 3463 6f6e 7374 7275  tor(_mat4constru
+00023e20: 6374 290a 636f 7079 5f72 6567 2e63 6f6e  ct).copy_reg.con
+00023e30: 7374 7275 6374 6f72 285f 7175 6174 636f  structor(_quatco
+00023e40: 6e73 7472 7563 7429 0a                   nstruct).
```

### Comparing `cgkit1-1.2.6/pycgtypes/mat3.py` & `cgkit1-1.2.7/pycgtypes/mat3.py`

 * *Files identical despite different names*

### Comparing `cgkit1-1.2.6/pycgtypes/mat4.py` & `cgkit1-1.2.7/pycgtypes/mat4.py`

 * *Files identical despite different names*

### Comparing `cgkit1-1.2.6/pycgtypes/quat.py` & `cgkit1-1.2.7/pycgtypes/quat.py`

 * *Files identical despite different names*

### Comparing `cgkit1-1.2.6/pycgtypes/vec3.py` & `cgkit1-1.2.7/pycgtypes/vec3.py`

 * *Files identical despite different names*

### Comparing `cgkit1-1.2.6/pycgtypes/vec4.py` & `cgkit1-1.2.7/pycgtypes/vec4.py`

 * *Files identical despite different names*

### Comparing `cgkit1-1.2.6/setup.py` & `cgkit1-1.2.7/setup.py`

 * *Files 8% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 # read the contents of README.md
 this_directory = path.abspath(path.dirname(__file__))
 with open(path.join(this_directory, "README.md"), encoding="utf-8") as f:
     long_description = f.read()
 
 setup(
     name="cgkit1",
-    version="1.2.6",  # also update cgkitinfo.py
+    version="1.2.7", # also update cgkitinfo.py
     description="Python Computer Graphics Kit v1",
     long_description=long_description,
     long_description_content_type="text/markdown",
     maintainer="Andrew Straw",
     maintainer_email="strawman@astraw.com",
     url="https://github.com/strawlab/cgkit1",
     license="BSD license, see license.txt",
```

